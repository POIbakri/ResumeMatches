const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browser-3KROyeyp.js","assets/vendor-DvokrLOH.js","assets/index.es-DdhcYl14.js","assets/analytics-Dy164akG.js"])))=>i.map(i=>d[i]);
import{r as W,a as ty,L as Kn,g as sy,c as Jn,u as G0,R as X0,b as ma,d as ny,e as Xt,N as Rl,B as ry}from"./vendor-DvokrLOH.js";import{a as fc}from"./analytics-Dy164akG.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();var Y0={exports:{}},Fu={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iy=W,ay=Symbol.for("react.element"),oy=Symbol.for("react.fragment"),ly=Object.prototype.hasOwnProperty,cy=iy.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,hy={key:!0,ref:!0,__self:!0,__source:!0};function K0(r,e,t){var s,n={},i=null,a=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(s in e)ly.call(e,s)&&!hy.hasOwnProperty(s)&&(n[s]=e[s]);if(r&&r.defaultProps)for(s in e=r.defaultProps,e)n[s]===void 0&&(n[s]=e[s]);return{$$typeof:ay,type:r,key:i,ref:a,props:n,_owner:cy.current}}Fu.Fragment=oy;Fu.jsx=K0;Fu.jsxs=K0;Y0.exports=Fu;var g=Y0.exports,Of={},ig=ty;Of.createRoot=ig.createRoot,Of.hydrateRoot=ig.hydrateRoot;var uy="@vercel/analytics",dy="1.4.1",fy=()=>{window.va||(window.va=function(...e){(window.vaq=window.vaq||[]).push(e)})};function J0(){return typeof window<"u"}function Z0(){try{const r="production"}catch{}return"production"}function py(r="auto"){if(r==="auto"){window.vam=Z0();return}window.vam=r}function my(){return(J0()?window.vam:Z0())||"production"}function ef(){return my()==="development"}var gy="https://va.vercel-scripts.com/v1/script.debug.js",by="/_vercel/insights/script.js";function vy(r={debug:!0}){var e;if(!J0())return;py(r.mode),fy(),r.beforeSend&&((e=window.va)==null||e.call(window,"beforeSend",r.beforeSend));const t=r.scriptSrc||(ef()?gy:by);if(document.head.querySelector(`script[src*="${t}"]`))return;const s=document.createElement("script");s.src=t,s.defer=!0,s.dataset.sdkn=uy+(r.framework?`/${r.framework}`:""),s.dataset.sdkv=dy,r.disableAutoTrack&&(s.dataset.disableAutoTrack="1"),r.endpoint&&(s.dataset.endpoint=r.endpoint),r.dsn&&(s.dataset.dsn=r.dsn),s.onerror=()=>{const n=ef()?"Please check if any ad blockers are enabled and try again.":"Be sure to enable Web Analytics for your project and deploy again. See https://vercel.com/docs/analytics/quickstart for more information.";console.log(`[Vercel Web Analytics] Failed to load script from ${t}. ${n}`)},ef()&&r.debug===!1&&(s.dataset.debug="false"),document.head.appendChild(s)}function yy({route:r,path:e}){var t;(t=window.va)==null||t.call(window,"pageview",{route:r,path:e})}function wy(r){return W.useEffect(()=>{var e;r.beforeSend&&((e=window.va)==null||e.call(window,"beforeSend",r.beforeSend))},[r.beforeSend]),W.useEffect(()=>{vy({framework:r.framework||"react",...r.route!==void 0&&{disableAutoTrack:!0},...r})},[]),W.useEffect(()=>{r.route&&r.path&&yy({route:r.route,path:r.path})},[r.route,r.path]),null}function xy({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"}))}const _y=W.forwardRef(xy);function Ay({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))}const Sy=W.forwardRef(Ay);function Ny({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"}))}const Q0=W.forwardRef(Ny);function Ey({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18 9 11.25l4.306 4.306a11.95 11.95 0 0 1 5.814-5.518l2.74-1.22m0 0-5.94-2.281m5.94 2.28-2.28 5.941"}))}const ky=W.forwardRef(Ey);function Cy({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"}))}const Py=W.forwardRef(Cy);function Ly({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const Ty=W.forwardRef(Ly);function Iy({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 3.104v5.714a2.25 2.25 0 0 1-.659 1.591L5 14.5M9.75 3.104c-.251.023-.501.05-.75.082m.75-.082a24.301 24.301 0 0 1 4.5 0m0 0v5.714c0 .597.237 1.17.659 1.591L19.8 15.3M14.25 3.104c.251.023.501.05.75.082M19.8 15.3l-1.57.393A9.065 9.065 0 0 1 12 15a9.065 9.065 0 0 0-6.23-.693L5 14.5m14.8.8 1.402 1.402c1.232 1.232.65 3.318-1.067 3.611A48.309 48.309 0 0 1 12 21c-2.773 0-5.491-.235-8.135-.687-1.718-.293-2.3-2.379-1.067-3.61L5 14.5"}))}const jy=W.forwardRef(Iy);function Ry({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"}))}const Oy=W.forwardRef(Ry);function My({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 14.15v4.25c0 1.094-.787 2.036-1.872 2.18-2.087.277-4.216.42-6.378.42s-4.291-.143-6.378-.42c-1.085-.144-1.872-1.086-1.872-2.18v-4.25m16.5 0a2.18 2.18 0 0 0 .75-1.661V8.706c0-1.081-.768-2.015-1.837-2.175a48.114 48.114 0 0 0-3.413-.387m4.5 8.006c-.194.165-.42.295-.673.38A23.978 23.978 0 0 1 12 15.75c-2.648 0-5.195-.429-7.577-1.22a2.016 2.016 0 0 1-.673-.38m0 0A2.18 2.18 0 0 1 3 12.489V8.706c0-1.081.768-2.015 1.837-2.175a48.111 48.111 0 0 1 3.413-.387m7.5 0V5.25A2.25 2.25 0 0 0 13.5 3h-3a2.25 2.25 0 0 0-2.25 2.25v.894m7.5 0a48.667 48.667 0 0 0-7.5 0M12 12.75h.008v.008H12v-.008Z"}))}const kp=W.forwardRef(My);function Fy({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const e1=W.forwardRef(Fy);function Dy({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const By=W.forwardRef(Dy);function $y({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}const yu=W.forwardRef($y);function qy({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))}const Zo=W.forwardRef(qy);function Uy({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"}))}const zy=W.forwardRef(Uy);function Hy({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"}))}const Du=W.forwardRef(Hy);function Wy({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const t1=W.forwardRef(Wy);function Vy({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m6.75 12-3-3m0 0-3 3m3-3v6m-1.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const s1=W.forwardRef(Vy);function Gy({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"}))}const n1=W.forwardRef(Gy);function Xy({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const Bu=W.forwardRef(Xy);function Yy({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const Ky=W.forwardRef(Yy);function Jy({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))}const Zy=W.forwardRef(Jy);function Qy({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"}))}const ew=W.forwardRef(Qy);function tw({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const sw=W.forwardRef(tw);function nw({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113a.375.375 0 0 1-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112Z"}))}const rw=W.forwardRef(nw);function iw({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z"}))}const ag=W.forwardRef(iw);function aw({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z"}))}const ow=W.forwardRef(aw);function lw({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"}))}const Cp=W.forwardRef(lw);function cw({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const r1=W.forwardRef(cw);function hw({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"}))}const i1=W.forwardRef(hw);function uw({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"}))}const dw=W.forwardRef(uw);function fw({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z"}))}const pw=W.forwardRef(fw);function mw({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const gw=W.forwardRef(mw);function bw({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const vw=W.forwardRef(bw);function yw(){const[r,e]=W.useState(!1),t=()=>{window.location.reload()};return g.jsx("nav",{className:"bg-white shadow-sm",children:g.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[g.jsxs("div",{className:"flex justify-between items-center h-16",children:[g.jsx("div",{className:"flex items-center",children:g.jsx(Kn,{to:"/",onClick:t,className:"flex items-center",children:g.jsx("img",{src:"/images/logo.png",alt:"Company Logo",className:"h-8 xs:h-10 sm:h-12 w-auto scale-110 transform hover:scale-105 transition-transform duration-200",style:{marginTop:"-4px",marginBottom:"-4px"}})})}),g.jsxs("div",{className:"hidden md:flex items-center space-x-4 lg:space-x-8",children:[g.jsx("a",{href:"#features",className:"text-sm lg:text-base text-gray-600 hover:text-gray-900 font-medium transition-colors duration-200",children:"Features"}),g.jsx("a",{href:"#pricing",className:"text-sm lg:text-base text-gray-600 hover:text-gray-900 font-medium transition-colors duration-200",children:"Pricing"}),g.jsx(Kn,{to:"/login",className:"inline-flex items-center px-3 lg:px-4 py-1.5 lg:py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-500 hover:bg-blue-600 transition-colors shadow-sm hover:shadow-md",children:"Sign In"})]}),g.jsx("div",{className:"md:hidden",children:g.jsx("button",{onClick:()=>e(!r),className:"inline-flex items-center justify-center p-2 rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500",children:r?g.jsx(vw,{className:"block h-6 w-6"}):g.jsx(Ty,{className:"block h-6 w-6"})})})]}),r&&g.jsx("div",{className:"md:hidden py-3",children:g.jsxs("div",{className:"flex flex-col space-y-3 px-2",children:[g.jsx("a",{href:"#features",className:"text-gray-600 hover:text-gray-900 font-medium px-3 py-2 rounded-md hover:bg-gray-100",children:"Features"}),g.jsx("a",{href:"#pricing",className:"text-gray-600 hover:text-gray-900 font-medium px-3 py-2 rounded-md hover:bg-gray-100",children:"Pricing"}),g.jsx(Kn,{to:"/login",className:"text-center text-white bg-blue-500 hover:bg-blue-600 px-3 py-2 rounded-md font-medium shadow-sm hover:shadow-md",children:"Sign In"})]})})]})})}function ww(){return g.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-gray-900 via-blue-900 to-indigo-900 border border-blue-500/20 rounded-lg",children:[g.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[g.jsx("div",{className:"absolute inset-0 bg-[url('/grid.svg')] opacity-10"}),g.jsx("div",{className:"absolute -top-20 xs:-top-30 sm:-top-40 -right-20 xs:-right-30 sm:-right-40 w-40 xs:w-60 sm:w-80 h-40 xs:h-60 sm:h-80 bg-blue-500 rounded-full blur-3xl opacity-30 animate-pulse"}),g.jsx("div",{className:"absolute -bottom-20 xs:-bottom-30 sm:-bottom-40 -left-20 xs:-left-30 sm:-left-40 w-40 xs:w-60 sm:w-80 h-40 xs:h-60 sm:h-80 bg-indigo-500 rounded-full blur-3xl opacity-30 animate-pulse delay-1000"})]}),g.jsx("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:g.jsxs("div",{className:"py-8 xs:py-12 sm:py-16",children:[g.jsx("div",{className:"inline-flex items-center px-3 xs:px-4 py-1 xs:py-1.5 rounded-full border border-blue-400/30 bg-blue-500/10 backdrop-blur-sm mb-6 xs:mb-8",children:g.jsx("span",{className:"text-xs xs:text-sm text-blue-200 font-medium",children:"✨ AI-Powered Recruitment Solution"})}),g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 xs:gap-8 lg:gap-12 items-center",children:[g.jsxs("div",{className:"order-2 lg:order-1",children:[g.jsxs("h1",{children:[g.jsx("span",{className:"block text-2xl xs:text-3xl sm:text-5xl lg:text-6xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-blue-200 to-indigo-200 leading-tight mb-2 xs:mb-4",children:"Transform Your Hiring Process"}),g.jsx("span",{className:"block text-xl xs:text-2xl sm:text-4xl lg:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-indigo-400",children:"With Intelligent CV Analysis"})]}),g.jsx("p",{className:"mt-4 xs:mt-6 text-sm xs:text-base sm:text-lg text-blue-100/90 max-w-2xl leading-relaxed",children:"Make better hiring decisions faster with our advanced AI technology. Match candidates to jobs with precision and generate tailored interview plans instantly."}),g.jsxs("div",{className:"mt-6 xs:mt-8 flex flex-col xs:flex-row items-stretch xs:items-center gap-3 xs:gap-4 sm:gap-6",children:[g.jsxs(Kn,{to:"/signup",className:"group relative inline-flex items-center justify-center px-4 xs:px-6 sm:px-8 py-2.5 xs:py-3 sm:py-4 text-sm xs:text-base sm:text-lg font-semibold text-blue-900 bg-white rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-200 overflow-hidden",children:[g.jsx("span",{className:"relative z-10",children:"Start Free Trial"}),g.jsx(Q0,{className:"ml-2 h-4 xs:h-5 w-4 xs:w-5 relative z-10 group-hover:translate-x-1 transition-transform"}),g.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-100 to-blue-50 opacity-0 group-hover:opacity-100 transition-opacity"})]}),g.jsxs("a",{href:"#demo",className:"group inline-flex items-center justify-center px-4 xs:px-6 sm:px-8 py-2.5 xs:py-3 sm:py-4 text-sm xs:text-base sm:text-lg font-semibold text-white border-2 border-white/20 rounded-xl backdrop-blur-sm hover:bg-white/10 transition-all duration-200",children:[g.jsx(rw,{className:"mr-2 h-4 xs:h-5 sm:h-6 w-4 xs:w-5 sm:w-6"}),"Watch Demo"]})]})]}),g.jsxs("div",{className:"relative w-full max-w-[280px] xs:max-w-lg mx-auto order-1 lg:order-2 h-[16rem] xs:h-[20rem] sm:h-[24rem]",children:[g.jsx("div",{className:"absolute top-0 left-0 w-56 xs:w-64 sm:w-72 h-[16rem] xs:h-[20rem] sm:h-[24rem] bg-white/10 backdrop-blur-sm rounded-lg border border-white/20 shadow-xl transform -rotate-6 animate-float",children:g.jsxs("div",{className:"p-3 xs:p-4 sm:p-6 space-y-3 xs:space-y-4",children:[g.jsxs("div",{className:"flex items-center space-x-2 xs:space-x-3",children:[g.jsx("div",{className:"w-8 xs:w-10 sm:w-12 h-8 xs:h-10 sm:h-12 rounded-full bg-blue-200/30 animate-pulse"}),g.jsxs("div",{className:"space-y-1.5 xs:space-y-2",children:[g.jsx("div",{className:"h-2 xs:h-3 sm:h-4 w-24 xs:w-28 sm:w-32 bg-blue-200/30 rounded animate-pulse"}),g.jsx("div",{className:"h-1.5 xs:h-2 sm:h-3 w-16 xs:w-20 sm:w-24 bg-blue-200/20 rounded animate-pulse"})]})]}),g.jsxs("div",{className:"space-y-1.5 xs:space-y-2 pt-2 xs:pt-3",children:[g.jsxs("div",{className:"flex items-center space-x-1.5 xs:space-x-2",children:[g.jsx("div",{className:"w-2 xs:w-3 sm:w-4 h-2 xs:h-3 sm:h-4 rounded bg-blue-200/30 animate-pulse"}),g.jsx("div",{className:"h-1.5 xs:h-2 sm:h-3 w-24 xs:w-28 sm:w-32 bg-blue-200/20 rounded animate-pulse"})]}),g.jsxs("div",{className:"flex items-center space-x-1.5 xs:space-x-2",children:[g.jsx("div",{className:"w-2 xs:w-3 sm:w-4 h-2 xs:h-3 sm:h-4 rounded bg-blue-200/30 animate-pulse"}),g.jsx("div",{className:"h-1.5 xs:h-2 sm:h-3 w-32 xs:w-36 sm:w-40 bg-blue-200/20 rounded animate-pulse"})]})]}),g.jsxs("div",{className:"space-y-2 xs:space-y-3 pt-2 xs:pt-3",children:[g.jsx("div",{className:"h-2 xs:h-3 sm:h-4 w-16 xs:w-20 sm:w-24 bg-blue-200/30 rounded"}),[...Array(3)].map((r,e)=>g.jsxs("div",{className:"space-y-1.5 xs:space-y-2",children:[g.jsx("div",{className:"h-1.5 xs:h-2 sm:h-3 bg-blue-200/20 rounded w-full"}),g.jsx("div",{className:"h-1.5 xs:h-2 sm:h-3 bg-blue-200/20 rounded w-5/6"}),g.jsx("div",{className:"h-1.5 xs:h-2 sm:h-3 bg-blue-200/20 rounded w-4/6"})]},e))]})]})}),g.jsx("div",{className:"absolute top-4 right-0 w-56 xs:w-64 sm:w-72 h-[16rem] xs:h-[20rem] sm:h-[24rem] bg-white/10 backdrop-blur-sm rounded-lg border border-white/20 shadow-xl transform rotate-6 animate-float delay-500",children:g.jsxs("div",{className:"p-3 xs:p-4 sm:p-6 space-y-3 xs:space-y-4",children:[g.jsxs("div",{className:"space-y-2 xs:space-y-3",children:[g.jsx("div",{className:"h-3 xs:h-4 sm:h-5 bg-indigo-200/30 rounded w-3/4"}),g.jsx("div",{className:"h-2 xs:h-3 sm:h-4 bg-indigo-200/20 rounded w-1/2"})]}),g.jsxs("div",{className:"flex items-center space-x-2 xs:space-x-3 pt-1.5 xs:pt-2",children:[g.jsx("div",{className:"w-6 xs:w-8 sm:w-10 h-6 xs:h-8 sm:h-10 rounded bg-indigo-200/30"}),g.jsxs("div",{className:"space-y-1.5 xs:space-y-2",children:[g.jsx("div",{className:"h-1.5 xs:h-2 sm:h-3 w-16 xs:w-20 sm:w-24 bg-indigo-200/20 rounded"}),g.jsx("div",{className:"h-1.5 xs:h-2 sm:h-3 w-24 xs:w-28 sm:w-32 bg-indigo-200/20 rounded"})]})]}),g.jsxs("div",{className:"space-y-2 xs:space-y-3 pt-2 xs:pt-3",children:[g.jsx("div",{className:"h-2 xs:h-3 sm:h-4 w-24 xs:w-28 sm:w-32 bg-indigo-200/30 rounded"}),[...Array(4)].map((r,e)=>g.jsxs("div",{className:"flex items-center space-x-1.5 xs:space-x-2",children:[g.jsx("div",{className:"w-1.5 xs:w-2 sm:w-3 h-1.5 xs:h-2 sm:h-3 rounded-full bg-indigo-200/30"}),g.jsx("div",{className:"h-1.5 xs:h-2 sm:h-3 bg-indigo-200/20 rounded w-full"})]},e))]})]})}),g.jsxs("div",{className:"absolute inset-0 flex items-center justify-center",children:[g.jsx("div",{className:"w-12 xs:w-16 sm:w-20 h-12 xs:h-16 sm:h-20 rounded-full bg-blue-500/20 animate-ping"}),g.jsx("div",{className:"absolute w-8 xs:w-12 sm:w-16 h-8 xs:h-12 sm:h-16 rounded-full bg-indigo-400/20 animate-pulse"}),g.jsx("div",{className:"absolute w-6 xs:w-8 sm:w-12 h-6 xs:h-8 sm:h-12 rounded-full bg-blue-400/30 animate-pulse delay-300"})]})]})]})]})})]})}const xw=[{name:"AI-Powered Analysis",description:"Advanced machine learning algorithms analyze CVs against job requirements with unprecedented accuracy.",icon:Cp,color:"bg-blue-400"},{name:"Smart Scoring",description:"Get detailed candidate fit scores and comprehensive breakdowns of qualifications.",icon:e1,color:"bg-blue-400"},{name:"Instant Reports",description:"Generate professional PDF reports with detailed analysis and recommendations.",icon:Bu,color:"bg-blue-400"},{name:"Interview Intelligence",description:"Get AI-generated interview questions tailored to each candidate's profile.",icon:ew,color:"bg-blue-400"},{name:"Technical Assessment",description:"Deep analysis of technical skills and experience levels.",icon:jy,color:"bg-blue-400"},{name:"Bias Prevention",description:"Ensure fair and objective candidate evaluation with our AI system.",icon:ow,color:"bg-blue-400"}];function _w(){return g.jsxs("div",{className:"relative bg-gradient-to-br from-blue-900 via-blue-800 to-indigo-900 py-12 sm:py-16 md:py-20 lg:py-24 overflow-hidden border border-blue-500/20 rounded-lg",id:"features",children:[g.jsxs("div",{className:"absolute inset-0",children:[g.jsx("div",{className:"absolute inset-0 bg-[url('/grid.svg')] opacity-10"}),g.jsx("div",{className:"absolute -top-20 sm:-top-30 md:-top-40 -right-20 sm:-right-30 md:-right-40 w-40 sm:w-60 md:w-80 h-40 sm:h-60 md:h-80 bg-blue-500 rounded-full blur-3xl opacity-30 animate-pulse"}),g.jsx("div",{className:"absolute -bottom-20 sm:-bottom-30 md:-bottom-40 -left-20 sm:-left-30 md:-left-40 w-40 sm:w-60 md:w-80 h-40 sm:h-60 md:h-80 bg-indigo-500 rounded-full blur-3xl opacity-30 animate-pulse delay-1000"})]}),g.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[g.jsxs("div",{className:"text-center mb-8 sm:mb-12 md:mb-16 transform transition-all duration-500 hover:scale-105",children:[g.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-white mb-3 sm:mb-4",children:"Powerful Features for Modern Recruitment"}),g.jsx("p",{className:"text-lg sm:text-xl text-blue-100/90 max-w-3xl mx-auto px-2",children:"Everything you need to streamline your candidate evaluation process and make better hiring decisions."})]}),g.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 lg:gap-8",children:xw.map((r,e)=>g.jsxs("div",{className:"group bg-white/10 backdrop-blur-sm rounded-xl p-4 sm:p-6 lg:p-8 shadow-lg hover:shadow-2xl transition-all duration-300 border border-blue-300/30 hover:border-blue-400/50 transform hover:-translate-y-1",style:{animationDelay:`${e*100}ms`},children:[g.jsx("div",{className:`${r.color} rounded-lg p-2 sm:p-3 w-10 sm:w-12 h-10 sm:h-12 flex items-center justify-center mb-4 sm:mb-6 transform transition-transform group-hover:scale-110 group-hover:rotate-3`,children:g.jsx(r.icon,{className:"h-5 sm:h-6 w-5 sm:w-6 text-white animate-pulse"})}),g.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-white mb-2 sm:mb-3 group-hover:text-blue-200 transition-colors",children:r.name}),g.jsx("p",{className:"text-sm sm:text-base text-blue-100/80 group-hover:text-blue-100 transition-colors",children:r.description}),g.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400/10 to-indigo-400/10 opacity-0 group-hover:opacity-20 transition-opacity rounded-xl"})]},r.name))})]})]})}const Aw=[{label:"Accuracy Rate",value:"95%",icon:Cp,description:"Match accuracy",gradient:"from-blue-400 to-indigo-400"},{label:"Time Saved",value:"75%",icon:t1,description:"Recruitment efficiency",gradient:"from-indigo-400 to-purple-400"},{label:"CVs Analyzed",value:"100K+",icon:Bu,description:"And counting",gradient:"from-purple-400 to-pink-400"},{label:"Happy Recruiters",value:"5000+",icon:i1,description:"Trusted by professionals",gradient:"from-pink-400 to-red-400"}];function Sw(){return g.jsxs("div",{className:"relative bg-gradient-to-br from-blue-900 via-indigo-900 to-purple-900 py-12 xs:py-16 sm:py-20 lg:py-24 overflow-hidden border border-blue-500/20 rounded-lg",children:[g.jsxs("div",{className:"absolute inset-0",children:[g.jsx("div",{className:"absolute inset-0 bg-[url('/grid.svg')] opacity-10"}),g.jsx("div",{className:"absolute -top-20 xs:-top-30 sm:-top-40 -right-20 xs:-right-30 sm:-right-40 w-40 xs:w-60 sm:w-80 h-40 xs:h-60 sm:h-80 bg-blue-500 rounded-full blur-3xl opacity-30 animate-pulse"}),g.jsx("div",{className:"absolute -bottom-20 xs:-bottom-30 sm:-bottom-40 -left-20 xs:-left-30 sm:-left-40 w-40 xs:w-60 sm:w-80 h-40 xs:h-60 sm:h-80 bg-indigo-500 rounded-full blur-3xl opacity-30 animate-pulse delay-1000"})]}),g.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[g.jsxs("div",{className:"text-center mb-8 xs:mb-12 lg:mb-16",children:[g.jsx("h2",{className:"text-2xl xs:text-3xl font-bold text-white mb-2 xs:mb-4",children:"Proven Track Record"}),g.jsx("p",{className:"text-base xs:text-lg sm:text-xl text-blue-100/90 max-w-3xl mx-auto px-2",children:"Our platform delivers measurable results for recruitment teams worldwide"})]}),g.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 xs:gap-6 sm:gap-8",children:Aw.map((r,e)=>g.jsxs("div",{className:"group relative bg-white/10 rounded-xl p-4 xs:p-6 sm:p-8 backdrop-blur-lg border border-white/20 hover:border-white/40 transition-all duration-300 transform hover:-translate-y-1 hover:shadow-2xl",style:{animationDelay:`${e*100}ms`},children:[g.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${r.gradient} opacity-0 group-hover:opacity-10 transition-opacity duration-500 rounded-xl`}),g.jsxs("div",{className:"relative z-10",children:[g.jsxs("div",{className:"flex items-center space-x-2 xs:space-x-3 sm:space-x-4 mb-4 xs:mb-5 sm:mb-6",children:[g.jsx("div",{className:"p-2 xs:p-2.5 sm:p-3 rounded-lg bg-white/10 group-hover:bg-white/20 transition-colors duration-300",children:g.jsx(r.icon,{className:"h-4 xs:h-5 sm:h-6 w-4 xs:w-5 sm:w-6 text-white group-hover:scale-110 transform transition-transform duration-300"})}),g.jsx("h3",{className:"text-base xs:text-lg font-medium text-white group-hover:text-blue-200 transition-colors duration-300",children:r.label})]}),g.jsx("p",{className:"text-3xl xs:text-4xl sm:text-5xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-white to-blue-200 mb-2 xs:mb-3",children:r.value}),g.jsx("p",{className:"text-xs xs:text-sm text-blue-200 group-hover:text-blue-100 transition-colors duration-300",children:r.description})]}),g.jsx("div",{className:"absolute bottom-0 left-0 w-full h-0.5 xs:h-1 bg-gradient-to-r from-transparent via-white/20 to-transparent transform scale-x-0 group-hover:scale-x-100 transition-transform duration-500"}),g.jsx("div",{className:"absolute top-0 right-0 w-12 xs:w-14 sm:w-16 h-12 xs:h-14 sm:h-16 bg-white/5 rounded-full blur-2xl group-hover:bg-white/10 transition-colors duration-300"})]},r.label))})]})]})}const og=[{title:"Upload CV & Job Description",description:"Simply upload a CV and job description to get started.",icon:Py,color:"bg-blue-500",gradient:"from-blue-500/10 to-blue-600/10"},{title:"AI Analysis",description:"Our advanced AI analyzes the match and generates insights.",icon:Cp,color:"bg-purple-500",gradient:"from-purple-500/10 to-purple-600/10"},{title:"Get Detailed Report",description:"Receive a comprehensive analysis with actionable insights.",icon:Bu,color:"bg-green-500",gradient:"from-green-500/10 to-green-600/10"},{title:"Make Better Decisions",description:"Use data-driven insights to make informed hiring decisions.",icon:i1,color:"bg-indigo-500",gradient:"from-indigo-500/10 to-indigo-600/10"}];function Nw(){return g.jsxs("div",{className:"relative bg-white py-12 xs:py-16 sm:py-20 lg:py-24 overflow-hidden border border-blue-500/20 rounded-lg",children:[g.jsxs("div",{className:"absolute inset-0",children:[g.jsx("div",{className:"absolute inset-0 bg-[url('/grid.svg')] opacity-5"}),g.jsx("div",{className:"absolute -top-20 xs:-top-30 sm:-top-40 -right-20 xs:-right-30 sm:-right-40 w-40 xs:w-60 sm:w-80 h-40 xs:h-60 sm:h-80 bg-blue-100 rounded-full blur-3xl opacity-30 animate-pulse"}),g.jsx("div",{className:"absolute -bottom-20 xs:-bottom-30 sm:-bottom-40 -left-20 xs:-left-30 sm:-left-40 w-40 xs:w-60 sm:w-80 h-40 xs:h-60 sm:h-80 bg-indigo-100 rounded-full blur-3xl opacity-30 animate-pulse delay-1000"})]}),g.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[g.jsxs("div",{className:"text-center mb-8 xs:mb-12 lg:mb-16 transform transition-all duration-500 hover:scale-105",children:[g.jsx("h2",{className:"text-2xl xs:text-3xl font-bold text-gray-900 mb-2 xs:mb-4",children:"How It Works"}),g.jsx("p",{className:"text-base xs:text-lg sm:text-xl text-gray-600 max-w-3xl mx-auto px-2",children:"Get started in minutes with our simple, powerful CV analysis process"})]}),g.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 xs:gap-6 sm:gap-8",children:og.map((r,e)=>g.jsxs("div",{className:"relative h-full",children:[e<og.length-1&&g.jsx("div",{className:"hidden lg:block absolute top-1/2 right-0 w-full h-0.5 bg-gray-200 transform translate-x-1/2"}),g.jsxs("div",{className:"group bg-white rounded-xl p-4 xs:p-6 sm:p-8 shadow-lg hover:shadow-2xl transition-all duration-300 border border-gray-200 hover:border-blue-400/50 transform hover:-translate-y-2 relative z-10 h-full flex flex-col",children:[g.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${r.gradient} opacity-0 group-hover:opacity-100 transition-opacity duration-300 rounded-xl`}),g.jsxs("div",{className:"absolute inset-0 overflow-hidden rounded-xl",children:[g.jsx("div",{className:`absolute w-1.5 xs:w-2 h-1.5 xs:h-2 ${r.color} rounded-full top-1/4 left-1/4 animate-float opacity-0 group-hover:opacity-30`}),g.jsx("div",{className:`absolute w-2 xs:w-3 h-2 xs:h-3 ${r.color} rounded-full top-3/4 right-1/4 animate-float-delayed opacity-0 group-hover:opacity-30`}),g.jsx("div",{className:`absolute w-1.5 xs:w-2 h-1.5 xs:h-2 ${r.color} rounded-full bottom-1/4 right-1/3 animate-float-slow opacity-0 group-hover:opacity-30`})]}),g.jsx("div",{className:`${r.color} rounded-full p-2 xs:p-3 w-10 xs:w-12 sm:w-14 h-10 xs:h-12 sm:h-14 flex items-center justify-center mb-4 xs:mb-5 sm:mb-6 transform transition-all duration-300 group-hover:scale-110 group-hover:rotate-6 group-hover:shadow-lg relative z-10`,children:g.jsx(r.icon,{className:"h-5 xs:h-6 sm:h-7 w-5 xs:w-6 sm:w-7 text-white group-hover:animate-pulse"})}),g.jsx("h3",{className:"text-lg xs:text-xl font-semibold text-gray-900 mb-2 xs:mb-3 group-hover:text-blue-600 transition-colors relative z-10",children:r.title}),g.jsx("p",{className:"text-sm xs:text-base text-gray-600 group-hover:text-gray-900 transition-colors flex-grow relative z-10",children:r.description}),g.jsx("div",{className:`absolute bottom-0 left-1/2 transform -translate-x-1/2 w-0 h-0.5 xs:h-1 ${r.color} group-hover:w-1/2 transition-all duration-300 rounded-full`})]})]},r.title))})]})]})}function Ew({title:r,titleId:e,...t},s){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?W.createElement("title",{id:e},r):null,W.createElement("path",{fillRule:"evenodd",d:"M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z",clipRule:"evenodd"}))}const kw=W.forwardRef(Ew),Cw=[{quote:"This tool has revolutionized our hiring process. We're making better decisions faster than ever.",author:"Sarah Johnson",role:"Head of Recruitment",company:"TechCorp Inc.",rating:5},{quote:"The AI analysis is incredibly accurate. It helps us identify the best candidates quickly and efficiently.",author:"Michael Chen",role:"Technical Recruiter",company:"Innovation Labs",rating:5},{quote:"The interview suggestions are spot-on. It's like having an expert recruiter guiding you through the process.",author:"Emma Williams",role:"HR Director",company:"Global Solutions",rating:5}];function Pw(){return g.jsxs("div",{className:"relative bg-white py-12 xs:py-16 sm:py-20 lg:py-24 overflow-hidden border border-blue-500/20 rounded-lg",children:[g.jsxs("div",{className:"absolute inset-0",children:[g.jsx("div",{className:"absolute inset-0 bg-[url('/grid.svg')] opacity-5"}),g.jsx("div",{className:"absolute -top-20 xs:-top-30 sm:-top-40 -right-20 xs:-right-30 sm:-right-40 w-40 xs:w-60 sm:w-80 h-40 xs:h-60 sm:h-80 bg-blue-100 rounded-full blur-3xl opacity-30 animate-pulse"}),g.jsx("div",{className:"absolute -bottom-20 xs:-bottom-30 sm:-bottom-40 -left-20 xs:-left-30 sm:-left-40 w-40 xs:w-60 sm:w-80 h-40 xs:h-60 sm:h-80 bg-indigo-100 rounded-full blur-3xl opacity-30 animate-pulse delay-1000"})]}),g.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[g.jsxs("div",{className:"text-center mb-8 xs:mb-12 lg:mb-16",children:[g.jsx("p",{className:"inline-flex items-center px-3 xs:px-4 py-1 xs:py-1.5 rounded-full border border-blue-400/30 bg-blue-500/10 backdrop-blur-sm text-blue-600 text-xs xs:text-sm font-medium mb-3 xs:mb-4",children:"Client Testimonials"}),g.jsx("h2",{className:"text-2xl xs:text-3xl font-bold text-gray-900 mb-2 xs:mb-4",children:"Loved by Recruiters"}),g.jsx("p",{className:"text-base xs:text-lg sm:text-xl text-gray-600 max-w-3xl mx-auto px-2",children:"See what hiring professionals are saying about our AI-powered CV analyzer"})]}),g.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 xs:gap-6 sm:gap-8",children:Cw.map(r=>g.jsxs("div",{className:"group relative bg-white rounded-xl p-4 xs:p-6 sm:p-8 shadow-lg border border-blue-100 hover:border-blue-300 transition-all duration-300 transform hover:-translate-y-1 hover:shadow-2xl",children:[g.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50 to-indigo-50 opacity-0 group-hover:opacity-100 transition-opacity duration-300 rounded-xl"}),g.jsxs("div",{className:"relative z-10",children:[g.jsx("div",{className:"flex space-x-0.5 xs:space-x-1 mb-3 xs:mb-4",children:[...Array(r.rating)].map((e,t)=>g.jsx(kw,{className:"h-4 xs:h-5 w-4 xs:w-5 text-blue-400 group-hover:text-blue-500 transition-colors duration-300"},t))}),g.jsxs("blockquote",{className:"text-sm xs:text-base text-gray-600 mb-4 xs:mb-6 group-hover:text-gray-700 transition-colors",children:['"',r.quote,'"']}),g.jsxs("div",{children:[g.jsx("p",{className:"font-semibold text-sm xs:text-base text-gray-900 group-hover:text-blue-600 transition-colors",children:r.author}),g.jsx("p",{className:"text-xs xs:text-sm text-gray-500 group-hover:text-gray-600 transition-colors",children:r.role}),g.jsx("p",{className:"text-xs xs:text-sm text-gray-500 group-hover:text-gray-600 transition-colors",children:r.company})]})]}),g.jsx("div",{className:"absolute bottom-0 left-1/2 transform -translate-x-1/2 w-0 h-0.5 xs:h-1 bg-blue-400 group-hover:w-1/2 transition-all duration-300 rounded-full"}),g.jsx("div",{className:"absolute top-4 right-4 w-8 xs:w-12 h-8 xs:h-12 bg-blue-400/5 rounded-full blur group-hover:bg-blue-400/10 transition-colors duration-300"})]},r.author))})]})]})}const Lw={id:"free",name:"Free Trial",price:0,period:"month",analysisLimit:4,features:["Up to 4 CV analyses","Basic interview questions","PDF export functionality","Email support"]},Tw={id:"pro",name:"Pro Plan",price:9.99,period:"month",analysisLimit:1e3,features:["1000 CV analyses per month","Advanced AI matching","Custom interview plans","Technical skill assessment","Team collaboration","Priority support","Analytics dashboard","Bulk analysis - Coming soon","API access - Coming soon"]},Mn={FREE:Lw,PRO:Tw};function Iw(){return g.jsxs("div",{className:"relative bg-white py-12 xs:py-16 sm:py-20 lg:py-24 overflow-hidden border border-blue-500/20 rounded-lg",id:"pricing",children:[g.jsxs("div",{className:"absolute inset-0",children:[g.jsx("div",{className:"absolute inset-0 bg-[url('/grid.svg')] opacity-[0.02]"}),g.jsx("div",{className:"absolute -top-20 xs:-top-30 sm:-top-40 -right-20 xs:-right-30 sm:-right-40 w-40 xs:w-60 sm:w-80 h-40 xs:h-60 sm:h-80 bg-blue-100 rounded-full blur-3xl opacity-30 animate-pulse"}),g.jsx("div",{className:"absolute -bottom-20 xs:-bottom-30 sm:-bottom-40 -left-20 xs:-left-30 sm:-left-40 w-40 xs:w-60 sm:w-80 h-40 xs:h-60 sm:h-80 bg-indigo-100 rounded-full blur-3xl opacity-30 animate-pulse delay-1000"})]}),g.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[g.jsxs("div",{className:"text-center mb-8 xs:mb-12 lg:mb-16",children:[g.jsx("p",{className:"inline-flex items-center px-3 xs:px-4 py-1 xs:py-1.5 rounded-full border border-blue-400/30 bg-blue-500/10 backdrop-blur-sm text-blue-600 text-xs xs:text-sm font-medium mb-3 xs:mb-4",children:"Flexible Plans"}),g.jsx("h2",{className:"text-2xl xs:text-3xl font-bold text-gray-900 mb-2 xs:mb-4",children:"Simple, Transparent Pricing"}),g.jsx("p",{className:"text-base xs:text-lg sm:text-xl text-gray-600 max-w-3xl mx-auto",children:"Choose the plan that's right for your recruitment needs"})]}),g.jsxs("div",{className:"max-w-5xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-4 xs:gap-6 sm:gap-8",children:[g.jsxs("div",{className:"group relative bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-200 hover:border-blue-300 transition-all duration-300 transform hover:-translate-y-1",children:[g.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-50 to-blue-50 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),g.jsxs("div",{className:"relative p-4 xs:p-6 sm:p-8",children:[g.jsx("h3",{className:"text-xl xs:text-2xl font-bold text-gray-900 text-center mb-1 xs:mb-2",children:Mn.FREE.name}),g.jsx("p",{className:"text-sm xs:text-base text-center text-gray-600 mb-4 xs:mb-6",children:"Perfect for trying out our service"}),g.jsxs("div",{className:"text-center mb-6 xs:mb-8",children:[g.jsx("span",{className:"text-4xl xs:text-5xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-gray-900 to-gray-600",children:"$0"}),g.jsx("span",{className:"text-gray-600",children:"/month"}),g.jsxs("p",{className:"text-xs xs:text-sm text-gray-500 mt-1 xs:mt-2",children:["Up to ",Mn.FREE.analysisLimit," CV analyses"]})]}),g.jsx("ul",{className:"space-y-3 xs:space-y-4 mb-6 xs:mb-8",children:Mn.FREE.features.map((r,e)=>g.jsxs("li",{className:"flex items-start group/item",children:[g.jsx(yu,{className:"h-4 xs:h-5 w-4 xs:w-5 text-green-500 flex-shrink-0 mt-0.5 group-hover/item:scale-110 transition-transform"}),g.jsx("span",{className:"ml-2 xs:ml-3 text-sm xs:text-base text-gray-600",children:r})]},e))}),g.jsx(Kn,{to:"/signup",className:"block w-full bg-gray-100 text-gray-800 text-center py-3 xs:py-4 rounded-xl text-sm xs:text-base font-medium hover:bg-gray-200 transition-all duration-300 hover:shadow-lg",children:"Start Free Trial"})]})]}),g.jsxs("div",{className:"group relative bg-gradient-to-br from-blue-600 to-indigo-600 rounded-2xl shadow-xl overflow-hidden transform hover:scale-[1.02] transition-all duration-300",children:[g.jsx("div",{className:"absolute inset-0 bg-[url('/grid.svg')] opacity-10"}),g.jsxs("div",{className:"relative p-4 xs:p-6 sm:p-8",children:[g.jsx("h3",{className:"text-xl xs:text-2xl font-bold text-white text-center mb-1 xs:mb-2",children:Mn.PRO.name}),g.jsx("p",{className:"text-sm xs:text-base text-center text-blue-100 mb-4 xs:mb-6",children:"For serious recruiters"}),g.jsxs("div",{className:"text-center mb-6 xs:mb-8",children:[g.jsxs("span",{className:"text-4xl xs:text-5xl font-bold text-white",children:["$",Mn.PRO.price]}),g.jsx("span",{className:"text-blue-100",children:"/month"}),g.jsxs("p",{className:"text-xs xs:text-sm text-blue-100 mt-1 xs:mt-2",children:[Mn.PRO.analysisLimit," analyses per month"]})]}),g.jsx("ul",{className:"space-y-3 xs:space-y-4 mb-6 xs:mb-8",children:Mn.PRO.features.map((r,e)=>g.jsxs("li",{className:"flex items-start group/item",children:[g.jsx(yu,{className:"h-4 xs:h-5 w-4 xs:w-5 text-white flex-shrink-0 mt-0.5 group-hover/item:scale-110 transition-transform"}),g.jsx("span",{className:"ml-2 xs:ml-3 text-sm xs:text-base text-white",children:r})]},e))}),g.jsx(Kn,{to:"/signup",className:"block w-full bg-white text-blue-600 text-center py-3 xs:py-4 rounded-xl text-sm xs:text-base font-medium hover:bg-blue-50 transition-all duration-300 hover:shadow-lg",children:"Get Started"})]})]})]})]})]})}function jw(){return g.jsxs("div",{className:"relative overflow-hidden bg-white border border-blue-500/20 rounded-lg py-8 xs:py-12 sm:py-16 lg:py-20",children:[g.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[g.jsx("div",{className:"absolute inset-0 bg-[url('/grid.svg')] opacity-[0.02]"}),g.jsx("div",{className:"absolute -top-20 xs:-top-30 sm:-top-40 -right-20 xs:-right-30 sm:-right-40 w-40 xs:w-60 sm:w-80 h-40 xs:h-60 sm:h-80 bg-blue-100 rounded-full blur-3xl opacity-20 animate-pulse"}),g.jsx("div",{className:"absolute -bottom-20 xs:-bottom-30 sm:-bottom-40 -left-20 xs:-left-30 sm:-left-40 w-40 xs:w-60 sm:w-80 h-40 xs:h-60 sm:h-80 bg-indigo-100 rounded-full blur-3xl opacity-20 animate-pulse delay-1000"})]}),g.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[g.jsxs("div",{className:"text-center",children:[g.jsx("p",{className:"inline-flex items-center px-3 xs:px-4 py-1 xs:py-1.5 rounded-full border border-blue-400/30 bg-blue-500/10 backdrop-blur-sm text-blue-600 text-xs xs:text-sm font-medium mb-4 xs:mb-6 sm:mb-8",children:"Trusted by Industry Leaders"}),g.jsx("p",{className:"text-lg xs:text-xl sm:text-2xl font-semibold text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-indigo-600 mb-8 xs:mb-10 sm:mb-12",children:"Powering recruitment at world's leading companies"})]}),g.jsx("div",{className:"grid grid-cols-2 xs:grid-cols-3 md:grid-cols-6 lg:grid-cols-5 gap-4 xs:gap-6 sm:gap-8",children:[{src:"/images/SnapInc.jpg",alt:"Snap Inc"},{src:"/images/Pfizer.png",alt:"Pfizer"},{src:"/images/GS.png",alt:"Goldman Sachs"},{src:"/images/Alphabet.png",alt:"Alphabet"},{src:"/images/Adecco.png",alt:"Adecco"}].map((r,e)=>g.jsx("div",{className:"col-span-1 flex justify-center items-center md:col-span-2 lg:col-span-1",children:g.jsxs("div",{className:"relative group w-full max-w-[120px] xs:max-w-[140px] sm:max-w-[160px]",children:[g.jsx("div",{className:"absolute -inset-2 bg-gradient-to-r from-blue-100/60 to-indigo-100/60 rounded-lg blur opacity-0 group-hover:opacity-100 transition duration-500"}),g.jsx("img",{className:"relative w-full h-8 xs:h-10 sm:h-12 object-contain opacity-50 group-hover:opacity-100 transition-opacity duration-300",src:r.src,alt:r.alt,loading:"lazy"})]})},e))})]})]})}function Rw(){return g.jsxs("div",{className:"relative bg-gradient-to-r from-blue-600 to-indigo-600 py-12 sm:py-16 md:py-20 lg:py-24 overflow-hidden",children:[g.jsxs("div",{className:"absolute inset-0",children:[g.jsx("div",{className:"absolute inset-0 bg-[url('/grid.svg')] opacity-10"}),g.jsx("div",{className:"absolute -top-20 sm:-top-30 md:-top-40 -right-20 sm:-right-30 md:-right-40 w-40 sm:w-60 md:w-80 h-40 sm:h-60 md:h-80 bg-blue-400 rounded-full blur-3xl opacity-20 animate-pulse"}),g.jsx("div",{className:"absolute -bottom-20 sm:-bottom-30 md:-bottom-40 -left-20 sm:-left-30 md:-left-40 w-40 sm:w-60 md:w-80 h-40 sm:h-60 md:h-80 bg-indigo-400 rounded-full blur-3xl opacity-20 animate-pulse delay-1000"})]}),g.jsxs("div",{className:"relative w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[g.jsxs("h2",{className:"text-3xl xs:text-4xl sm:text-5xl font-bold text-white mb-4 sm:mb-6 leading-tight",children:["Ready to Transform Your"," ",g.jsx("span",{className:"inline-block sm:hidden",children:"Hiring Process?"}),g.jsx("br",{className:"hidden sm:block"}),g.jsx("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-blue-200 to-indigo-200 sm:inline",children:g.jsx("span",{className:"hidden sm:inline",children:"Hiring Process?"})})]}),g.jsx("p",{className:"text-lg xs:text-xl sm:text-2xl text-blue-100 mb-8 sm:mb-12 max-w-3xl mx-auto leading-relaxed px-2",children:"Join thousands of recruiters who are making better hiring decisions with AI-powered CV analysis."}),g.jsxs("div",{className:"flex flex-col xs:flex-row justify-center gap-4 sm:gap-6 px-4",children:[g.jsxs(Kn,{to:"/signup",className:"group inline-flex items-center justify-center px-6 sm:px-8 py-3 sm:py-4 border border-transparent text-base sm:text-lg font-medium rounded-xl text-blue-600 bg-white hover:bg-blue-50 transition-all duration-300 transform hover:-translate-y-1 hover:shadow-xl w-full xs:w-auto",children:["Get Started Free",g.jsx(Q0,{className:"ml-2 h-5 w-5 group-hover:translate-x-1 transition-transform"})]}),g.jsx(Kn,{to:"/pricing",className:"inline-flex items-center justify-center px-6 sm:px-8 py-3 sm:py-4 border-2 border-white text-base sm:text-lg font-medium rounded-xl text-white hover:bg-white/10 transition-all duration-300 backdrop-blur-sm transform hover:-translate-y-1 w-full xs:w-auto",children:"View Pricing"})]})]})]})}function Ow(){return g.jsxs("div",{className:"bg-white min-h-screen",children:[g.jsx(yw,{}),g.jsx(ww,{}),g.jsx(jw,{}),g.jsx(_w,{}),g.jsx(Nw,{}),g.jsx(Sw,{}),g.jsx(Pw,{}),g.jsx(Iw,{}),g.jsx(Rw,{}),g.jsx("footer",{className:"bg-gradient-to-b from-gray-50 to-gray-100 border-t border-gray-200",children:g.jsx("div",{className:"max-w-7xl mx-auto py-8 xs:py-10 sm:py-12 px-4 sm:px-6 lg:px-8",children:g.jsxs("div",{className:"flex flex-col xs:flex-row items-center justify-between space-y-4 xs:space-y-0",children:[g.jsxs("div",{className:"flex flex-col items-center xs:items-start space-y-2",children:[g.jsx("div",{className:"flex items-center space-x-2",children:g.jsx("img",{src:"/images/logo.png",alt:"Company Logo",className:"h-10 xs:h-12 sm:h-16 w-auto"})}),g.jsx("p",{className:"text-sm xs:text-base text-gray-600",children:"TopMatchTalent.com"}),g.jsx("a",{href:"mailto:talent@topmatchtalent.com",className:"text-sm xs:text-base text-gray-600 hover:text-blue-600 transition-colors duration-200",children:"talent@topmatchtalent.com"})]}),g.jsxs("p",{className:"text-xs xs:text-sm text-gray-500",children:["© ",new Date().getFullYear()," All rights reserved."]})]})})})]})}const Mw="modulepreload",Fw=function(r){return"/"+r},lg={},vi=function(e,t,s){let n=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");n=Promise.allSettled(t.map(l=>{if(l=Fw(l),l in lg)return;lg[l]=!0;const c=l.endsWith(".css"),h=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${h}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":Mw,c||(d.as="script"),d.crossOrigin="",d.href=l,o&&d.setAttribute("nonce",o),document.head.appendChild(d),c)return new Promise((p,f)=>{d.addEventListener("load",p),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return n.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return e().catch(i)})},Dw=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>vi(async()=>{const{default:s}=await Promise.resolve().then(()=>Qo);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)};class Pp extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class Bw extends Pp{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class $w extends Pp{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class qw extends Pp{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Mf;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(Mf||(Mf={}));var Uw=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(h){try{c(s.next(h))}catch(d){a(d)}}function l(h){try{c(s.throw(h))}catch(d){a(d)}}function c(h){h.done?i(h.value):n(h.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};class zw{constructor(e,{headers:t={},customFetch:s,region:n=Mf.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=Dw(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return Uw(this,void 0,void 0,function*(){try{const{headers:n,method:i,body:a}=t;let o={},{region:l}=t;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let c;a&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",c=a):typeof a=="string"?(o["Content-Type"]="text/plain",c=a):typeof FormData<"u"&&a instanceof FormData?c=a:(o["Content-Type"]="application/json",c=JSON.stringify(a)));const h=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),n),body:c}).catch(y=>{throw new Bw(y)}),d=h.headers.get("x-relay-error");if(d&&d==="true")throw new $w(h);if(!h.ok)throw new qw(h);let p=((s=h.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),f;return p==="application/json"?f=yield h.json():p==="application/octet-stream"?f=yield h.blob():p==="text/event-stream"?f=h:p==="multipart/form-data"?f=yield h.formData():f=yield h.text(),{data:f,error:null}}catch(n){return{data:null,error:n}}})}}var An={},Lp={},$u={},Oc={},qu={},Uu={},Hw=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Wo=Hw();const Ww=Wo.fetch,a1=Wo.fetch.bind(Wo),o1=Wo.Headers,Vw=Wo.Request,Gw=Wo.Response,Qo=Object.freeze(Object.defineProperty({__proto__:null,Headers:o1,Request:Vw,Response:Gw,default:a1,fetch:Ww},Symbol.toStringTag,{value:"Module"})),Xw=sy(Qo);var zu={};Object.defineProperty(zu,"__esModule",{value:!0});let Yw=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};zu.default=Yw;var l1=Jn&&Jn.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Uu,"__esModule",{value:!0});const Kw=l1(Xw),Jw=l1(zu);let Zw=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Kw.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const s=this.fetch;let n=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var a,o,l;let c=null,h=null,d=null,p=i.status,f=i.statusText;if(i.ok){if(this.method!=="HEAD"){const x=await i.text();x===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?h=x:h=JSON.parse(x))}const w=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),A=(o=i.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");w&&A&&A.length>1&&(d=parseInt(A[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(h)&&(h.length>1?(c={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,d=null,p=406,f="Not Acceptable"):h.length===1?h=h[0]:h=null)}else{const w=await i.text();try{c=JSON.parse(w),Array.isArray(c)&&i.status===404&&(h=[],c=null,p=200,f="OK")}catch{i.status===404&&w===""?(p=204,f="No Content"):c={message:w}}if(c&&this.isMaybeSingle&&(!((l=c?.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,p=200,f="OK"),c&&this.shouldThrowOnError)throw new Jw.default(c)}return{error:c,data:h,count:d,status:p,statusText:f}});return this.shouldThrowOnError||(n=n.catch(i=>{var a,o,l;return{error:{message:`${(a=i?.name)!==null&&a!==void 0?a:"FetchError"}: ${i?.message}`,details:`${(o=i?.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=i?.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),n.then(e,t)}};Uu.default=Zw;var Qw=Jn&&Jn.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(qu,"__esModule",{value:!0});const e5=Qw(Uu);let t5=class extends e5.default{select(e){let t=!1;const s=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:n,referencedTable:i=n}={}){const a=i?`${i}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){const n=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:n=s}={}){const i=typeof n>"u"?"offset":`${n}.offset`,a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(a,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:n=!1,wal:i=!1,format:a="text"}={}){var o;const l=[e?"analyze":null,t?"verbose":null,s?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${c}"; options=${l};`,a==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};qu.default=t5;var s5=Jn&&Jn.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Oc,"__esModule",{value:!0});const n5=s5(qu);let r5=class extends n5.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map(n=>typeof n=="string"&&new RegExp("[,()]").test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:n}={}){let i="";n==="plain"?i="pl":n==="phrase"?i="ph":n==="websearch"&&(i="w");const a=s===void 0?"":`(${s})`;return this.url.searchParams.append(e,`${i}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([t,s])=>{this.url.searchParams.append(t,`eq.${s}`)}),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){const n=s?`${s}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}};Oc.default=r5;var i5=Jn&&Jn.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty($u,"__esModule",{value:!0});const Ol=i5(Oc);let a5=class{constructor(e,{headers:t={},schema:s,fetch:n}){this.url=e,this.headers=t,this.schema=s,this.fetch=n}select(e,{head:t=!1,count:s}={}){const n=t?"HEAD":"GET";let i=!1;const a=(e??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",a),s&&(this.headers.Prefer=`count=${s}`),new Ol.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:s=!0}={}){const n="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),s||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const a=e.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(a.length>0){const o=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new Ol.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:n,defaultToNull:i=!0}={}){const a="POST",o=[`resolution=${s?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&o.push(this.headers.Prefer),n&&o.push(`count=${n}`),i||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(e)){const l=e.reduce((c,h)=>c.concat(Object.keys(h)),[]);if(l.length>0){const c=[...new Set(l)].map(h=>`"${h}"`);this.url.searchParams.set("columns",c.join(","))}}return new Ol.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const s="PATCH",n=[];return this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),this.headers.Prefer=n.join(","),new Ol.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",s=[];return e&&s.push(`count=${e}`),this.headers.Prefer&&s.unshift(this.headers.Prefer),this.headers.Prefer=s.join(","),new Ol.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};$u.default=a5;var Hu={},Wu={};Object.defineProperty(Wu,"__esModule",{value:!0});Wu.version=void 0;Wu.version="0.0.0-automated";Object.defineProperty(Hu,"__esModule",{value:!0});Hu.DEFAULT_HEADERS=void 0;const o5=Wu;Hu.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${o5.version}`};var c1=Jn&&Jn.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Lp,"__esModule",{value:!0});const l5=c1($u),c5=c1(Oc),h5=Hu;let u5=class h1{constructor(e,{headers:t={},schema:s,fetch:n}={}){this.url=e,this.headers=Object.assign(Object.assign({},h5.DEFAULT_HEADERS),t),this.schemaName=s,this.fetch=n}from(e){const t=new URL(`${this.url}/${e}`);return new l5.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new h1(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:n=!1,count:i}={}){let a;const o=new URL(`${this.url}/rpc/${e}`);let l;s||n?(a=s?"HEAD":"GET",Object.entries(t).filter(([h,d])=>d!==void 0).map(([h,d])=>[h,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([h,d])=>{o.searchParams.append(h,d)})):(a="POST",l=t);const c=Object.assign({},this.headers);return i&&(c.Prefer=`count=${i}`),new c5.default({method:a,url:o,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};Lp.default=u5;var el=Jn&&Jn.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(An,"__esModule",{value:!0});An.PostgrestError=An.PostgrestBuilder=An.PostgrestTransformBuilder=An.PostgrestFilterBuilder=An.PostgrestQueryBuilder=An.PostgrestClient=void 0;const u1=el(Lp);An.PostgrestClient=u1.default;const d1=el($u);An.PostgrestQueryBuilder=d1.default;const f1=el(Oc);An.PostgrestFilterBuilder=f1.default;const p1=el(qu);An.PostgrestTransformBuilder=p1.default;const m1=el(Uu);An.PostgrestBuilder=m1.default;const g1=el(zu);An.PostgrestError=g1.default;var d5=An.default={PostgrestClient:u1.default,PostgrestQueryBuilder:d1.default,PostgrestFilterBuilder:f1.default,PostgrestTransformBuilder:p1.default,PostgrestBuilder:m1.default,PostgrestError:g1.default};const{PostgrestClient:f5,PostgrestQueryBuilder:uC,PostgrestFilterBuilder:dC,PostgrestTransformBuilder:fC,PostgrestBuilder:pC,PostgrestError:mC}=d5,p5="2.11.2",m5={"X-Client-Info":`realtime-js/${p5}`},g5="1.0.0",b1=1e4,b5=1e3;var Oo;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(Oo||(Oo={}));var jn;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(jn||(jn={}));var gr;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(gr||(gr={}));var Ff;(function(r){r.websocket="websocket"})(Ff||(Ff={}));var ya;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(ya||(ya={}));class v5{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const n=t.getUint8(1),i=t.getUint8(2);let a=this.HEADER_LENGTH+2;const o=s.decode(e.slice(a,a+n));a=a+n;const l=s.decode(e.slice(a,a+i));a=a+i;const c=JSON.parse(s.decode(e.slice(a,e.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class v1{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Zt;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(Zt||(Zt={}));const cg=(r,e,t={})=>{var s;const n=(s=t.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((i,a)=>(i[a]=y5(a,r,e,n),i),{})},y5=(r,e,t,s)=>{const n=e.find(o=>o.name===r),i=n?.type,a=t[r];return i&&!s.includes(i)?y1(i,a):Df(a)},y1=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return A5(e,t)}switch(r){case Zt.bool:return w5(e);case Zt.float4:case Zt.float8:case Zt.int2:case Zt.int4:case Zt.int8:case Zt.numeric:case Zt.oid:return x5(e);case Zt.json:case Zt.jsonb:return _5(e);case Zt.timestamp:return S5(e);case Zt.abstime:case Zt.date:case Zt.daterange:case Zt.int4range:case Zt.int8range:case Zt.money:case Zt.reltime:case Zt.text:case Zt.time:case Zt.timestamptz:case Zt.timetz:case Zt.tsrange:case Zt.tstzrange:return Df(e);default:return Df(e)}},Df=r=>r,w5=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},x5=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},_5=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},A5=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,s=r[t];if(r[0]==="{"&&s==="}"){let i;const a=r.slice(1,t);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(o=>y1(e,o))}return r},S5=r=>typeof r=="string"?r.replace(" ","T"):r,w1=r=>{let e=r;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class tf{constructor(e,t,s={},n=b1){this.channel=e,this.event=t,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var hg;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(hg||(hg={}));class rc{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=rc.syncState(this.state,n,i,a),this.pendingDiffs.forEach(l=>{this.state=rc.syncDiff(this.state,l,i,a)}),this.pendingDiffs=[],o()}),this.channel._on(s.diff,{},n=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=rc.syncDiff(this.state,n,i,a),o())}),this.onJoin((n,i,a)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:a})}),this.onLeave((n,i,a)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,n){const i=this.cloneDeep(e),a=this.transformState(t),o={},l={};return this.map(i,(c,h)=>{a[c]||(l[c]=h)}),this.map(a,(c,h)=>{const d=i[c];if(d){const p=h.map(A=>A.presence_ref),f=d.map(A=>A.presence_ref),y=h.filter(A=>f.indexOf(A.presence_ref)<0),w=d.filter(A=>p.indexOf(A.presence_ref)<0);y.length>0&&(o[c]=y),w.length>0&&(l[c]=w)}else o[c]=h}),this.syncDiff(i,{joins:o,leaves:l},s,n)}static syncDiff(e,t,s,n){const{joins:i,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(i,(o,l)=>{var c;const h=(c=e[o])!==null&&c!==void 0?c:[];if(e[o]=this.cloneDeep(l),h.length>0){const d=e[o].map(f=>f.presence_ref),p=h.filter(f=>d.indexOf(f.presence_ref)<0);e[o].unshift(...p)}s(o,h,l)}),this.map(a,(o,l)=>{let c=e[o];if(!c)return;const h=l.map(d=>d.presence_ref);c=c.filter(d=>h.indexOf(d.presence_ref)<0),e[o]=c,n(o,c,l),c.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const n=e[s];return"metas"in n?t[s]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[s]=n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ug;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(ug||(ug={}));var dg;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(dg||(dg={}));var mi;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(mi||(mi={}));class Tp{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=jn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new tf(this,gr.join,this.params,this.timeout),this.rejoinTimer=new v1(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=jn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=jn.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=jn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=jn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(gr.reply,{},(n,i)=>{this._trigger(this._replyEventName(i),n)}),this.presence=new rc(this),this.broadcastEndpointURL=w1(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,n;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:a,private:o}}=this.params;this._onError(h=>e?.(mi.CHANNEL_ERROR,h)),this._onClose(()=>e?.(mi.CLOSED));const l={},c={broadcast:i,presence:a,postgres_changes:(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(h=>h.filter))!==null&&n!==void 0?n:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:h})=>{var d;if(this.socket.setAuth(),h===void 0){e?.(mi.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,f=(d=p?.length)!==null&&d!==void 0?d:0,y=[];for(let w=0;w<f;w++){const A=p[w],{filter:{event:x,schema:S,table:I,filter:M}}=A,B=h&&h[w];if(B&&B.event===x&&B.schema===S&&B.table===I&&B.filter===M)y.push(Object.assign(Object.assign({},A),{id:B.id}));else{this.unsubscribe(),e?.(mi.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,e&&e(mi.SUBSCRIBED);return}}).receive("error",h=>{e?.(mi.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{e?.(mi.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this._on(e,t,s)}async send(e,t={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:a}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=c.body)===null||n===void 0?void 0:n.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,o,l;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=jn.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(gr.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(s=>{const n=new tf(this,gr.leave,{},e);n.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})})}async _fetchWithTimeout(e,t,s){const n=new AbortController,i=setTimeout(()=>n.abort(),s),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(i),a}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new tf(this,e,t,s);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var n,i;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:c,join:h}=gr;if(s&&[o,l,c,h].indexOf(a)>=0&&s!==this._joinRef())return;let p=this._onMessage(a,t,s);if(t&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(f=>{var y,w,A;return((y=f.filter)===null||y===void 0?void 0:y.event)==="*"||((A=(w=f.filter)===null||w===void 0?void 0:w.event)===null||A===void 0?void 0:A.toLocaleLowerCase())===a}).map(f=>f.callback(p,s)):(i=this.bindings[a])===null||i===void 0||i.filter(f=>{var y,w,A,x,S,I;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in f){const M=f.id,B=(y=f.filter)===null||y===void 0?void 0:y.event;return M&&((w=t.ids)===null||w===void 0?void 0:w.includes(M))&&(B==="*"||B?.toLocaleLowerCase()===((A=t.data)===null||A===void 0?void 0:A.type.toLocaleLowerCase()))}else{const M=(S=(x=f?.filter)===null||x===void 0?void 0:x.event)===null||S===void 0?void 0:S.toLocaleLowerCase();return M==="*"||M===((I=t?.event)===null||I===void 0?void 0:I.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===a}).map(f=>{if(typeof p=="object"&&"ids"in p){const y=p.data,{schema:w,table:A,commit_timestamp:x,type:S,errors:I}=y;p=Object.assign(Object.assign({},{schema:w,table:A,commit_timestamp:x,eventType:S,new:{},old:{},errors:I}),this._getPayloadRecords(y))}f.callback(p,s)})}_isClosed(){return this.state===jn.closed}_isJoined(){return this.state===jn.joined}_isJoining(){return this.state===jn.joining}_isLeaving(){return this.state===jn.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const n=e.toLocaleLowerCase(),i={type:n,filter:t,callback:s};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&Tp.isEqual(n.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(gr.close,{},e)}_onError(e){this._on(gr.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=jn.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=cg(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=cg(e.columns,e.old_record)),t}}const N5=()=>{},E5=typeof WebSocket<"u",k5=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class C5{constructor(e,t){var s;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=m5,this.params={},this.timeout=b1,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=N5,this.conn=null,this.sendBuffer=[],this.serializer=new v5,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let a;return i?a=i:typeof fetch>"u"?a=(...o)=>vi(async()=>{const{default:l}=await Promise.resolve().then(()=>Qo);return{default:l}},void 0).then(({default:l})=>l(...o)):a=fetch,(...o)=>a(...o)},this.endPoint=`${e}/${Ff.websocket}`,this.httpEndpoint=w1(e),t?.transport?this.transport=t.transport:this.transport=null,t?.params&&(this.params=t.params),t?.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t?.timeout&&(this.timeout=t.timeout),t?.logger&&(this.logger=t.logger),t?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const n=(s=t?.params)===null||s===void 0?void 0:s.apikey;if(n&&(this.accessTokenValue=n,this.apiKey=n),this.reconnectAfterMs=t?.reconnectAfterMs?t.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=t?.encode?t.encode:(i,a)=>a(JSON.stringify(i)),this.decode=t?.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new v1(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t?.fetch),t?.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=t?.worker||!1,this.workerUrl=t?.workerUrl}this.accessToken=t?.accessToken||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(E5){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new P5(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),vi(async()=>{const{default:e}=await import("./browser-3KROyeyp.js").then(t=>t.b);return{default:e}},__vite__mapDeps([0,1])).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:g5}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Oo.connecting:return ya.Connecting;case Oo.open:return ya.Open;case Oo.closing:return ya.Closing;default:return ya.Closed}}isConnected(){return this.connectionState()===ya.Open}channel(e,t={config:{}}){const s=new Tp(`realtime:${e}`,t,this);return this.channels.push(s),s}push(e){const{topic:t,event:s,payload:n,ref:i}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${t} ${s} (${i})`,n),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let s=null;try{s=JSON.parse(atob(t.split(".")[1]))}catch{}if(s&&s.exp&&!(Math.floor(Date.now()/1e3)-s.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${s.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${s.exp}`);this.accessTokenValue=t,this.channels.forEach(n=>{t&&n.updateJoinPayload({access_token:t}),n.joinedOnce&&n._isJoined()&&n._push(gr.access_token,{access_token:t})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(b5,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:s,event:n,payload:i,ref:a}=t;a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${s} ${n} ${a&&"("+a+")"||""}`,i),this.channels.filter(o=>o._isMember(s)).forEach(o=>o._trigger(n,i,a)),this.stateChangeCallbacks.message.forEach(o=>o(t))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(gr.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${e}${s}${n}`}_workerObjectUrl(e){let t;if(e)t=e;else{const s=new Blob([k5],{type:"application/javascript"});t=URL.createObjectURL(s)}return t}}class P5{constructor(e,t,s){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Oo.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=s.close}}class Ip extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Bs(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class L5 extends Ip{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Bf extends Ip{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var T5=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(h){try{c(s.next(h))}catch(d){a(d)}}function l(h){try{c(s.throw(h))}catch(d){a(d)}}function c(h){h.done?i(h.value):n(h.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};const x1=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>vi(async()=>{const{default:s}=await Promise.resolve().then(()=>Qo);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},I5=()=>T5(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield vi(()=>Promise.resolve().then(()=>Qo),void 0)).Response:Response}),$f=r=>{if(Array.isArray(r))return r.map(t=>$f(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,s])=>{const n=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[n]=$f(s)}),e};var Ra=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(h){try{c(s.next(h))}catch(d){a(d)}}function l(h){try{c(s.throw(h))}catch(d){a(d)}}function c(h){h.done?i(h.value):n(h.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};const sf=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),j5=(r,e,t)=>Ra(void 0,void 0,void 0,function*(){const s=yield I5();r instanceof s&&!t?.noResolveJson?r.json().then(n=>{e(new L5(sf(n),r.status||500))}).catch(n=>{e(new Bf(sf(n),n))}):e(new Bf(sf(r),r))}),R5=(r,e,t,s)=>{const n={method:r,headers:e?.headers||{}};return r==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json"},e?.headers),s&&(n.body=JSON.stringify(s)),Object.assign(Object.assign({},n),t))};function Mc(r,e,t,s,n,i){return Ra(this,void 0,void 0,function*(){return new Promise((a,o)=>{r(t,R5(e,s,n,i)).then(l=>{if(!l.ok)throw l;return s?.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>j5(l,o,s))})})}function wu(r,e,t,s){return Ra(this,void 0,void 0,function*(){return Mc(r,"GET",e,t,s)})}function qi(r,e,t,s,n){return Ra(this,void 0,void 0,function*(){return Mc(r,"POST",e,s,n,t)})}function O5(r,e,t,s,n){return Ra(this,void 0,void 0,function*(){return Mc(r,"PUT",e,s,n,t)})}function M5(r,e,t,s){return Ra(this,void 0,void 0,function*(){return Mc(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),s)})}function _1(r,e,t,s,n){return Ra(this,void 0,void 0,function*(){return Mc(r,"DELETE",e,s,n,t)})}var yn=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(h){try{c(s.next(h))}catch(d){a(d)}}function l(h){try{c(s.throw(h))}catch(d){a(d)}}function c(h){h.done?i(h.value):n(h.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};const F5={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},fg={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class D5{constructor(e,t={},s,n){this.url=e,this.headers=t,this.bucketId=s,this.fetch=x1(n)}uploadOrUpdate(e,t,s,n){return yn(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},fg),n);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=s,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),n?.headers&&(o=Object.assign(Object.assign({},o),n.headers));const c=this._removeEmptyFolders(t),h=this._getFinalPath(c),d=yield this.fetch(`${this.url}/object/${h}`,Object.assign({method:e,body:i,headers:o},a?.duplex?{duplex:a.duplex}:{})),p=yield d.json();return d.ok?{data:{path:c,id:p.Id,fullPath:p.Key},error:null}:{data:null,error:p}}catch(i){if(Bs(i))return{data:null,error:i};throw i}})}upload(e,t,s){return yn(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,n){return yn(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),a=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",t);try{let l;const c=Object.assign({upsert:fg.upsert},n),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&s instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",s)):typeof FormData<"u"&&s instanceof FormData?(l=s,l.append("cacheControl",c.cacheControl)):(l=s,h["cache-control"]=`max-age=${c.cacheControl}`,h["content-type"]=c.contentType);const d=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:h}),p=yield d.json();return d.ok?{data:{path:i,fullPath:p.Key},error:null}:{data:null,error:p}}catch(l){if(Bs(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return yn(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const n=Object.assign({},this.headers);t?.upsert&&(n["x-upsert"]="true");const i=yield qi(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:n}),a=new URL(this.url+i.url),o=a.searchParams.get("token");if(!o)throw new Ip("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:o},error:null}}catch(s){if(Bs(s))return{data:null,error:s};throw s}})}update(e,t,s){return yn(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return yn(this,void 0,void 0,function*(){try{return{data:yield qi(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s?.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(Bs(n))return{data:null,error:n};throw n}})}copy(e,t,s){return yn(this,void 0,void 0,function*(){try{return{data:{path:(yield qi(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(Bs(n))return{data:null,error:n};throw n}})}createSignedUrl(e,t,s){return yn(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),i=yield qi(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},s?.transform?{transform:s.transform}:{}),{headers:this.headers});const a=s?.download?`&download=${s.download===!0?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(n){if(Bs(n))return{data:null,error:n};throw n}})}createSignedUrls(e,t,s){return yn(this,void 0,void 0,function*(){try{const n=yield qi(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=s?.download?`&download=${s.download===!0?"":s.download}`:"";return{data:n.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(n){if(Bs(n))return{data:null,error:n};throw n}})}download(e,t){return yn(this,void 0,void 0,function*(){const n=typeof t?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(t?.transform||{}),a=i?`?${i}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield wu(this.fetch,`${this.url}/${n}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Bs(o))return{data:null,error:o};throw o}})}info(e){return yn(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const s=yield wu(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:$f(s),error:null}}catch(s){if(Bs(s))return{data:null,error:s};throw s}})}exists(e){return yn(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield M5(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(Bs(s)&&s instanceof Bf){const n=s.originalError;if([400,404].includes(n?.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,t){const s=this._getFinalPath(e),n=[],i=t?.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&n.push(i);const o=typeof t?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(t?.transform||{});l!==""&&n.push(l);let c=n.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${s}${c}`)}}}remove(e){return yn(this,void 0,void 0,function*(){try{return{data:yield _1(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Bs(t))return{data:null,error:t};throw t}})}list(e,t,s){return yn(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},F5),t),{prefix:e||""});return{data:yield qi(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(Bs(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const B5="2.7.1",$5={"X-Client-Info":`storage-js/${B5}`};var go=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(h){try{c(s.next(h))}catch(d){a(d)}}function l(h){try{c(s.throw(h))}catch(d){a(d)}}function c(h){h.done?i(h.value):n(h.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};class q5{constructor(e,t={},s){this.url=e,this.headers=Object.assign(Object.assign({},$5),t),this.fetch=x1(s)}listBuckets(){return go(this,void 0,void 0,function*(){try{return{data:yield wu(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Bs(e))return{data:null,error:e};throw e}})}getBucket(e){return go(this,void 0,void 0,function*(){try{return{data:yield wu(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Bs(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return go(this,void 0,void 0,function*(){try{return{data:yield qi(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Bs(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return go(this,void 0,void 0,function*(){try{return{data:yield O5(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Bs(s))return{data:null,error:s};throw s}})}emptyBucket(e){return go(this,void 0,void 0,function*(){try{return{data:yield qi(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Bs(t))return{data:null,error:t};throw t}})}deleteBucket(e){return go(this,void 0,void 0,function*(){try{return{data:yield _1(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Bs(t))return{data:null,error:t};throw t}})}}class U5 extends q5{constructor(e,t={},s){super(e,t,s)}from(e){return new D5(this.url,this.headers,e,this.fetch)}}const z5="2.47.8";let Gl="";typeof Deno<"u"?Gl="deno":typeof document<"u"?Gl="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Gl="react-native":Gl="node";const H5={"X-Client-Info":`supabase-js-${Gl}/${z5}`},W5={headers:H5},V5={schema:"public"},G5={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},X5={};var Y5=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(h){try{c(s.next(h))}catch(d){a(d)}}function l(h){try{c(s.throw(h))}catch(d){a(d)}}function c(h){h.done?i(h.value):n(h.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};const K5=r=>{let e;return r?e=r:typeof fetch>"u"?e=a1:e=fetch,(...t)=>e(...t)},J5=()=>typeof Headers>"u"?o1:Headers,Z5=(r,e,t)=>{const s=K5(t),n=J5();return(i,a)=>Y5(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:r;let c=new n(a?.headers);return c.has("apikey")||c.set("apikey",r),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),s(i,Object.assign(Object.assign({},a),{headers:c}))})};var Q5=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(h){try{c(s.next(h))}catch(d){a(d)}}function l(h){try{c(s.throw(h))}catch(d){a(d)}}function c(h){h.done?i(h.value):n(h.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};function ex(r){return r.replace(/\/$/,"")}function tx(r,e){const{db:t,auth:s,realtime:n,global:i}=r,{db:a,auth:o,realtime:l,global:c}=e,h={db:Object.assign(Object.assign({},a),t),auth:Object.assign(Object.assign({},o),s),realtime:Object.assign(Object.assign({},l),n),global:Object.assign(Object.assign({},c),i),accessToken:()=>Q5(this,void 0,void 0,function*(){return""})};return r.accessToken?h.accessToken=r.accessToken:delete h.accessToken,h}const A1="2.67.1",sx="http://localhost:9999",nx="supabase.auth.token",rx={"X-Client-Info":`gotrue-js/${A1}`},pg=10,qf="X-Supabase-Api-Version",S1={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function ix(r){return Math.round(Date.now()/1e3)+r}function ax(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const ur=()=>typeof document<"u",pa={tested:!1,writable:!1},ic=()=>{if(!ur())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(pa.tested)return pa.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),pa.tested=!0,pa.writable=!0}catch{pa.tested=!0,pa.writable=!1}return pa.writable};function nf(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((n,i)=>{e[i]=n})}catch{}return t.searchParams.forEach((s,n)=>{e[n]=s}),e}const N1=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>vi(async()=>{const{default:s}=await Promise.resolve().then(()=>Qo);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},ox=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",E1=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},Bh=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},$h=async(r,e)=>{await r.removeItem(e)};function lx(r){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let t="",s,n,i,a,o,l,c,h=0;for(r=r.replace("-","+").replace("_","/");h<r.length;)a=e.indexOf(r.charAt(h++)),o=e.indexOf(r.charAt(h++)),l=e.indexOf(r.charAt(h++)),c=e.indexOf(r.charAt(h++)),s=a<<2|o>>4,n=(o&15)<<4|l>>2,i=(l&3)<<6|c,t=t+String.fromCharCode(s),l!=64&&n!=0&&(t=t+String.fromCharCode(n)),c!=64&&i!=0&&(t=t+String.fromCharCode(i));return t}class Vu{constructor(){this.promise=new Vu.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Vu.promiseConstructor=Promise;function mg(r){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,t=r.split(".");if(t.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const s=t[1];return JSON.parse(lx(s))}async function cx(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function hx(r,e){return new Promise((s,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await r(i);if(!e(i,null,a)){s(a);return}}catch(a){if(!e(i,a)){n(a);return}}})()})}function ux(r){return("0"+r.toString(16)).substr(-2)}function dx(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let n="";for(let i=0;i<56;i++)n+=t.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,ux).join("")}async function fx(r){const t=new TextEncoder().encode(r),s=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(s);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}function px(r){return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function mx(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await fx(r);return px(t)}async function bo(r,e,t=!1){const s=dx();let n=s;t&&(n+="/PASSWORD_RECOVERY"),await E1(r,`${e}-code-verifier`,n);const i=await mx(s);return[i,s===i?"plain":"s256"]}const gx=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function bx(r){const e=r.headers.get(qf);if(!e||!e.match(gx))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class jp extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function mt(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class vx extends jp{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function yx(r){return mt(r)&&r.name==="AuthApiError"}class k1 extends jp{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Oa extends jp{constructor(e,t,s,n){super(e,s,n),this.name=t,this.status=s}}class Bi extends Oa{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function wx(r){return mt(r)&&r.name==="AuthSessionMissingError"}class rf extends Oa{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class qh extends Oa{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Uh extends Oa{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function xx(r){return mt(r)&&r.name==="AuthImplicitGrantRedirectError"}class gg extends Oa{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Uf extends Oa{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function af(r){return mt(r)&&r.name==="AuthRetryableFetchError"}class bg extends Oa{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}var _x=function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(r);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(r,s[n])&&(t[s[n]]=r[s[n]]);return t};const ga=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Ax=[502,503,504];async function vg(r){var e;if(!ox(r))throw new Uf(ga(r),0);if(Ax.includes(r.status))throw new Uf(ga(r),r.status);let t;try{t=await r.json()}catch(i){throw new k1(ga(i),i)}let s;const n=bx(r);if(n&&n.getTime()>=S1["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?s=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(s=t.error_code),s){if(s==="weak_password")throw new bg(ga(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new Bi}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new bg(ga(t),r.status,t.weak_password.reasons);throw new vx(ga(t),r.status||500,s)}const Sx=(r,e,t,s)=>{const n={method:r,headers:e?.headers||{}};return r==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),t))};async function St(r,e,t,s){var n;const i=Object.assign({},s?.headers);i[qf]||(i[qf]=S1["2024-01-01"].name),s?.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const a=(n=s?.query)!==null&&n!==void 0?n:{};s?.redirectTo&&(a.redirect_to=s.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await Nx(r,e,t+o,{headers:i,noResolveJson:s?.noResolveJson},{},s?.body);return s?.xform?s?.xform(l):{data:Object.assign({},l),error:null}}async function Nx(r,e,t,s,n,i){const a=Sx(e,s,n,i);let o;try{o=await r(t,Object.assign({},a))}catch(l){throw console.error(l),new Uf(ga(l),0)}if(o.ok||await vg(o),s?.noResolveJson)return o;try{return await o.json()}catch(l){await vg(l)}}function $i(r){var e;let t=null;Px(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=ix(r.expires_in)));const s=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:s},error:null}}function yg(r){const e=$i(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,s)=>t&&typeof s=="string",!0)&&(e.data.weak_password=r.weak_password),e}function Ui(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function Ex(r){return{data:r,error:null}}function kx(r){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:n,verification_type:i}=r,a=_x(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:s,redirect_to:n,verification_type:i},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function Cx(r){return r}function Px(r){return r.access_token&&r.refresh_token&&r.expires_in}var Lx=function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(r);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(r,s[n])&&(t[s[n]]=r[s[n]]);return t};class Tx{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=N1(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await St(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(mt(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await St(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Ui})}catch(s){if(mt(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=Lx(e,["options"]),n=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(n.new_email=s?.newEmail,delete n.newEmail),await St(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:kx,redirectTo:t?.redirectTo})}catch(t){if(mt(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await St(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ui})}catch(t){if(mt(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,n,i,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},h=await St(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(i=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:Cx});if(h.error)throw h.error;const d=await h.json(),p=(a=h.headers.get("x-total-count"))!==null&&a!==void 0?a:0,f=(l=(o=h.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(y=>{const w=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),A=JSON.parse(y.split(";")[1].split("=")[1]);c[`${A}Page`]=w}),c.total=parseInt(p)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(mt(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){try{return await St(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ui})}catch(t){if(mt(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await St(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Ui})}catch(s){if(mt(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){try{return await St(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Ui})}catch(s){if(mt(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){try{const{data:t,error:s}=await St(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:t,error:s}}catch(t){if(mt(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await St(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(mt(t))return{data:null,error:t};throw t}}}const Ix={getItem:r=>ic()?globalThis.localStorage.getItem(r):null,setItem:(r,e)=>{ic()&&globalThis.localStorage.setItem(r,e)},removeItem:r=>{ic()&&globalThis.localStorage.removeItem(r)}};function wg(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}function jx(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const vo={debug:!!(globalThis&&ic()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class C1 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Rx extends C1{}async function Ox(r,e,t){vo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),vo.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){vo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,n.name);try{return await t()}finally{vo.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,n.name)}}else{if(e===0)throw vo.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new Rx(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(vo.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}jx();const Mx={url:sx,storageKey:nx,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:rx,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},Ml=30*1e3,xg=3;async function _g(r,e,t){return await t()}class pc{constructor(e){var t,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=pc.nextInstanceID,pc.nextInstanceID+=1,this.instanceID>0&&ur()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},Mx),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new Tx({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=N1(n.fetch),this.lock=n.lock||_g,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:ur()&&(!((t=globalThis?.navigator)===null||t===void 0)&&t.locks)?this.lock=Ox:this.lock=_g,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:ic()?this.storage=Ix:(this.memoryStorage={},this.storage=wg(this.memoryStorage)):(this.memoryStorage={},this.storage=wg(this.memoryStorage)),ur()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${A1}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=ur()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",t),t||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:s,error:n}=await this._getSessionFromURL(t);if(n){if(this._debug("#_initialize()","error detecting session from URL",n),xx(n)){const o=(e=n.details)===null||e===void 0?void 0:e.code;if(o==="identity_already_exists"||o==="identity_not_found"||o==="single_identity_not_deletable")return{error:n}}return await this._removeSession(),{error:n}}const{session:i,redirectType:a}=s;return this._debug("#_initialize()","detected session in URL",i,"redirect type",a),await this._saveSession(i),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return mt(t)?{error:t}:{error:new k1("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,n;try{const i=await St(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e?.options)===null||n===void 0?void 0:n.captchaToken}},xform:$i}),{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(mt(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,s,n;try{let i;if("email"in e){const{email:h,password:d,options:p}=e;let f=null,y=null;this.flowType==="pkce"&&([f,y]=await bo(this.storage,this.storageKey)),i=await St(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p?.emailRedirectTo,body:{email:h,password:d,data:(t=p?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:p?.captchaToken},code_challenge:f,code_challenge_method:y},xform:$i})}else if("phone"in e){const{phone:h,password:d,options:p}=e;i=await St(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:d,data:(s=p?.data)!==null&&s!==void 0?s:{},channel:(n=p?.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:p?.captchaToken}},xform:$i})}else throw new qh("You must provide either an email or phone number and a password");const{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(mt(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:a,options:o}=e;t=await St(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:yg})}else if("phone"in e){const{phone:i,password:a,options:o}=e;t=await St(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:yg})}else throw new qh("You must provide either an email or phone number and a password");const{data:s,error:n}=t;return n?{data:{user:null,session:null},error:n}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new rf}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(t){if(mt(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await Bh(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(t??"").split("/");try{const{data:i,error:a}=await St(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:$i});if(await $h(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new rf}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:a})}catch(i){if(mt(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:s,token:n,access_token:i,nonce:a}=e,o=await St(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:$i}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new rf}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(t){if(mt(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,n,i,a;try{if("email"in e){const{email:o,options:l}=e;let c=null,h=null;this.flowType==="pkce"&&([c,h]=await bo(this.storage,this.storageKey));const{error:d}=await St(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=l?.data)!==null&&t!==void 0?t:{},create_user:(s=l?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},code_challenge:c,code_challenge_method:h},redirectTo:l?.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:o,options:l}=e,{data:c,error:h}=await St(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(n=l?.data)!==null&&n!==void 0?n:{},create_user:(i=l?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},channel:(a=l?.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:c?.message_id},error:h}}throw new qh("You must provide either an email or phone number.")}catch(o){if(mt(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,s;try{let n,i;"options"in e&&(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:a,error:o}=await St(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:$i});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,c=a.user;return l?.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(n){if(mt(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var t,s,n;try{let i=null,a=null;return this.flowType==="pkce"&&([i,a]=await bo(this.storage,this.storageKey)),await St(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e?.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:Ex})}catch(i){if(mt(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new Bi;const{error:n}=await St(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(mt(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:i}=e,{error:a}=await St(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:s,type:n,options:i}=e,{data:a,error:o}=await St(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return{data:{user:null,session:null,messageId:a?.message_id},error:o}}throw new qh("You must provide either an email or phone number and a type")}catch(t){if(mt(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Bh(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.storage.isServer){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,h)=>(!a&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,h))})}return{data:{session:e},error:null}}const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await St(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ui}):await this._useSession(async t=>{var s,n,i;const{data:a,error:o}=t;if(o)throw o;return!(!((s=a.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Bi}:await St(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:Ui})})}catch(t){if(mt(t))return wx(t)&&(await this._removeSession(),await $h(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:n,error:i}=s;if(i)throw i;if(!n.session)throw new Bi;const a=n.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await bo(this.storage,this.storageKey));const{data:c,error:h}=await St(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:Ui});if(h)throw h;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(s){if(mt(s))return{data:{user:null},error:s};throw s}}_decodeJWT(e){return mg(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Bi;const t=Date.now()/1e3;let s=t,n=!0,i=null;const a=mg(e.access_token);if(a.exp&&(s=a.exp,n=s<=t),n){const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(mt(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:a,error:o}=t;if(o)throw o;e=(s=a.session)!==null&&s!==void 0?s:void 0}if(!e?.refresh_token)throw new Bi;const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(mt(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e){try{if(!ur())throw new Uh("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new Uh("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new gg("Not a valid PKCE flow url.");const t=nf(window.location.href);if(e){if(!t.code)throw new gg("No code detected.");const{data:S,error:I}=await this._exchangeCodeForSession(t.code);if(I)throw I;const M=new URL(window.location.href);return M.searchParams.delete("code"),window.history.replaceState(window.history.state,"",M.toString()),{data:{session:S.session,redirectType:null},error:null}}if(t.error||t.error_description||t.error_code)throw new Uh(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});const{provider_token:s,provider_refresh_token:n,access_token:i,refresh_token:a,expires_in:o,expires_at:l,token_type:c}=t;if(!i||!o||!a||!c)throw new Uh("No session defined in URL");const h=Math.round(Date.now()/1e3),d=parseInt(o);let p=h+d;l&&(p=parseInt(l));const f=p-h;f*1e3<=Ml&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${d}s`);const y=p-d;h-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,p,h):h-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,p,h);const{data:w,error:A}=await this._getUser(i);if(A)throw A;const x={provider_token:s,provider_refresh_token:n,access_token:i,expires_in:d,expires_at:p,refresh_token:a,token_type:c,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:t.type},error:null}}catch(t){if(mt(t))return{data:{session:null,redirectType:null},error:t};throw t}}_isImplicitGrantFlow(){const e=nf(window.location.href);return!!(ur()&&(e.access_token||e.error_description))}async _isPKCEFlow(){const e=nf(window.location.href),t=await Bh(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:n,error:i}=t;if(i)return{error:i};const a=(s=n.session)===null||s===void 0?void 0:s.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(yx(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await $h(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=ax(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,n;try{const{data:{session:i},error:a}=t;if(a)throw a;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await bo(this.storage,this.storageKey,!0));try{return await St(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(mt(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(mt(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:n}=await this._useSession(async i=>{var a,o,l,c,h;const{data:d,error:p}=i;if(p)throw p;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await St(this.fetch,"GET",f,{headers:this.headers,jwt:(h=(c=d.session)===null||c===void 0?void 0:c.access_token)!==null&&h!==void 0?h:void 0})});if(n)throw n;return ur()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(s?.url),{data:{provider:e.provider,url:s?.url},error:null}}catch(s){if(mt(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,n;const{data:i,error:a}=t;if(a)throw a;return await St(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(t){if(mt(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await hx(async n=>(n>0&&await cx(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await St(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:$i})),(n,i)=>{const a=200*Math.pow(2,n);return i&&af(i)&&Date.now()+a-s<Ml})}catch(s){if(this._debug(t,"error",s),mt(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),ur()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const s=await Bh(this.storage,this.storageKey);if(this._debug(t,"session from storage",s),!this._isValidSession(s)){this._debug(t,"session is not valid"),s!==null&&await this._removeSession();return}const n=Math.round(Date.now()/1e3),i=((e=s.expires_at)!==null&&e!==void 0?e:1/0)<n+pg;if(this._debug(t,`session has${i?"":" not"} expired with margin of ${pg}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:a}=await this._callRefreshToken(s.refresh_token);a&&(console.error(a),af(a)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(t,"error",s),console.error(s);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new Bi;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Vu;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new Bi;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(n,"error",i),mt(i)){const a={session:null,error:i};return af(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(l){i.push(l)}});if(await Promise.all(a),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await E1(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await $h(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&ur()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ml);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/Ml);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Ml}ms, refresh threshold is ${xg} ticks`),n<=xg&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof C1)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ur()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const n=[`provider=${encodeURIComponent(t)}`];if(s?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,a]=await bo(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});n.push(o.toString())}if(s?.queryParams){const i=new URLSearchParams(s.queryParams);n.push(i.toString())}return s?.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:n,error:i}=t;return i?{data:null,error:i}:await St(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(mt(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,n;const{data:i,error:a}=t;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await St(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(s=i?.session)===null||s===void 0?void 0:s.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((n=l?.totp)===null||n===void 0)&&n.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(mt(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:i}=t;if(i)return{data:null,error:i};const{data:a,error:o}=await St(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(t){if(mt(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:i}=t;return i?{data:null,error:i}:await St(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(mt(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=e?.factors||[],n=s.filter(a=>a.factor_type==="totp"&&a.status==="verified"),i=s.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:s,totp:n,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;const{data:{session:n},error:i}=e;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const a=this._decodeJWT(n.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((s=(t=n.user.factors)===null||t===void 0?void 0:t.filter(d=>d.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(l="aal2");const h=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:h},error:null}}))}}pc.nextInstanceID=0;const Fx=pc;class Dx extends Fx{constructor(e){super(e)}}var Bx=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(h){try{c(s.next(h))}catch(d){a(d)}}function l(h){try{c(s.throw(h))}catch(d){a(d)}}function c(h){h.done?i(h.value):n(h.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};class $x{constructor(e,t,s){var n,i,a;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=ex(e);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:V5,realtime:X5,auth:Object.assign(Object.assign({},G5),{storageKey:l}),global:W5},h=tx(s??{},c);this.storageKey=(n=h.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(d,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=h.auth)!==null&&a!==void 0?a:{},this.headers,h.global.fetch),this.fetch=Z5(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new f5(`${o}/rest/v1`,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new zw(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new U5(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Bx(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(t=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,storageKey:i,flowType:a,lock:o,debug:l},c,h){var d;const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Dx({url:this.authUrl,headers:Object.assign(Object.assign({},p),c),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,flowType:a,lock:o,debug:l,fetch:h,hasCustomAuthorizationHeader:(d="Authorization"in this.headers)!==null&&d!==void 0?d:!1})}_initRealtimeClient(e){return new C5(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,s)=>{this._handleTokenChanged(t,"CLIENT",s?.access_token)})}_handleTokenChanged(e,t,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const qx=(r,e,t)=>new $x(r,e,t),Ux="https://your-production-project.supabase.co",zx="your-production-anon-key",lt=qx(Ux,zx,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce"}});function Vr({children:r,isLoading:e,variant:t="primary",...s}){const n="w-full py-2 px-4 rounded-md transition-colors disabled:opacity-50",i={primary:"bg-blue-600 text-white hover:bg-blue-700",secondary:"bg-gray-200 text-gray-800 hover:bg-gray-300"};return g.jsx("button",{...s,className:`${n} ${i[t]}`,disabled:e||s.disabled,children:e?g.jsxs("span",{className:"flex items-center justify-center",children:[g.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2",viewBox:"0 0 24 24",children:[g.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),g.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading..."]}):r})}function Na({label:r,error:e,...t}){return g.jsxs("div",{children:[g.jsx("label",{htmlFor:t.id,className:"block text-sm font-medium text-gray-700",children:r}),g.jsx("input",{...t,className:"mt-1 block w-full rounded-md border p-2 focus:border-blue-500 focus:ring focus:ring-blue-200"}),e&&g.jsx("p",{className:"mt-1 text-sm text-red-600",children:e})]})}function Hx(){const[r,e]=W.useState(""),[t,s]=W.useState(""),[n,i]=W.useState(null),[a,o]=W.useState(!1),[l,c]=W.useState(!1),h=async d=>{if(d.preventDefault(),i(null),o(!0),!r.trim()||!t.trim()){i("Email and password are required"),o(!1);return}const p=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(!p.test(r)){i("Please enter a valid email address"),o(!1);return}try{console.log("Auth attempt with:",{emailLength:r.length,passwordLength:t.length,emailValid:p.test(r)});const{data:f,error:y}=await lt.auth.signInWithPassword({email:r.trim(),password:t.trim()});if(y)throw console.error("Supabase auth error:",{status:y.status,message:y.message,name:y.name}),y.message.includes("Invalid login credentials")?new Error("Invalid email or password"):y;console.log("Login successful",{userId:f.user?.id})}catch(f){console.error("Login error:",f),i(f instanceof Error?f.message:"An error occurred during login")}finally{o(!1)}};return g.jsxs("div",{className:"space-y-6",children:[g.jsxs("form",{onSubmit:h,className:"space-y-5",children:[g.jsx(Na,{id:"email",type:"email",label:"Email",value:r,onChange:d=>e(d.target.value),required:!0,className:"shadow-sm"}),g.jsxs("div",{className:"relative",children:[g.jsx(Na,{id:"password",type:l?"text":"password",label:"Password",value:t,onChange:d=>s(d.target.value),required:!0,className:"shadow-sm"}),g.jsx("button",{type:"button",className:"absolute right-3 top-9 text-gray-500 hover:text-gray-700 p-1 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 rounded",onClick:()=>c(!l),children:l?"Hide":"Show"})]}),n&&g.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-lg border border-red-100",children:n}),g.jsx(Vr,{type:"submit",isLoading:a,className:"w-full py-2.5 text-base font-medium shadow-sm",children:"Sign In"})]}),g.jsx("div",{className:"text-center pt-2",children:g.jsxs("p",{className:"text-sm text-gray-600",children:["Don't have an account?"," ",g.jsx(Kn,{to:"/signup",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Sign up"})]})})]})}function Wx(){return g.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-b from-gray-50 to-gray-100 p-4",children:g.jsxs("div",{className:"max-w-md w-full bg-white p-6 sm:p-8 rounded-xl shadow-lg border border-gray-100",children:[g.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-3 text-center text-gray-800",children:"Welcome Back"}),g.jsx("p",{className:"text-gray-600 text-center mb-8 text-sm sm:text-base",children:"Sign in to continue to Top Match Talent"}),g.jsx(Hx,{})]})})}function Vx(){const[r,e]=W.useState(""),[t,s]=W.useState(""),[n,i]=W.useState(""),[a,o]=W.useState(null),[l,c]=W.useState(null),[h,d]=W.useState(!1),[p,f]=W.useState(!1),y=async w=>{if(w.preventDefault(),o(null),c(null),!r||!t||!n){o("All fields are required");return}if(t.length<6){o("Password must be at least 6 characters long");return}if(t!==n){o("Passwords do not match");return}d(!0);try{console.log("Attempting signup with:",{email:r,redirectTo:`${window.location.origin}/auth/callback`});const{data:A,error:x}=await lt.auth.signUp({email:r,password:t,options:{emailRedirectTo:`${window.location.origin}/auth/callback`}});if(console.log("Signup response:",{data:A,error:x}),x)throw x;A?.user&&c("Please check your emails for confirmation (Check your junk folder)")}catch(A){if(console.error("Signup error:",A),A instanceof Error){const x=A.message.toLowerCase();x.includes("rate limit")?o("Too many signup attempts. Please try again later."):x.includes("already registered")||x.includes("already exists")?o("This email is already registered. Please sign in instead."):x.includes("invalid email")?o("Please enter a valid email address."):x.includes("weak password")?o("Please choose a stronger password."):o(`Signup failed: ${A.message}`)}else o("An unexpected error occurred. Please try again.")}finally{d(!1)}};return g.jsxs("div",{className:"space-y-6",children:[g.jsxs("form",{onSubmit:y,className:"space-y-5",children:[g.jsx(Na,{id:"email",type:"email",label:"Email",value:r,onChange:w=>e(w.target.value),required:!0,className:"shadow-sm"}),g.jsxs("div",{className:"relative",children:[g.jsx(Na,{id:"password",type:p?"text":"password",label:"Password",value:t,onChange:w=>s(w.target.value),required:!0,className:"shadow-sm"}),g.jsx("button",{type:"button",className:"absolute right-3 top-9 text-gray-500 hover:text-gray-700 p-1 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 rounded",onClick:()=>f(!p),children:p?"Hide":"Show"})]}),g.jsxs("div",{className:"relative",children:[g.jsx(Na,{id:"confirmPassword",type:p?"text":"password",label:"Confirm Password",value:n,onChange:w=>i(w.target.value),required:!0,className:"shadow-sm"}),g.jsx("button",{type:"button",className:"absolute right-3 top-9 text-gray-500 hover:text-gray-700 p-1 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 rounded",onClick:()=>f(!p),children:p?"Hide":"Show"})]}),a&&g.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-lg border border-red-100",children:a}),l&&g.jsx("div",{className:"text-green-600 text-sm bg-green-50 p-3 rounded-lg border border-green-100",children:l}),g.jsx(Vr,{type:"submit",isLoading:h,className:"w-full py-2.5 text-base font-medium shadow-sm",children:"Sign Up"})]}),g.jsx("div",{className:"text-center pt-2",children:g.jsxs("p",{className:"text-sm text-gray-600",children:["Already have an account?"," ",g.jsx(Kn,{to:"/login",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Sign in"})]})})]})}function Gx(){return g.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-b from-gray-50 to-gray-100 p-4",children:g.jsxs("div",{className:"max-w-md w-full bg-white p-6 sm:p-8 rounded-xl shadow-lg border border-gray-100",children:[g.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-3 text-center text-gray-800",children:"Create Account"}),g.jsx("p",{className:"text-gray-600 text-center mb-8 text-sm sm:text-base",children:"Join Top Match Talent to start analyzing candidates"}),g.jsx(Vx,{})]})})}const of={AUTH:{INVALID_CREDENTIALS:"Invalid email or password",EMAIL_IN_USE:"This email is already registered",WEAK_PASSWORD:"Password must be at least 8 characters",SESSION_EXPIRED:"Your session has expired. Please sign in again"},API:{GENERAL:"An unexpected error occurred",NETWORK:"Network error. Please check your connection",RATE_LIMIT:"Too many requests. Please try again later"},ANALYSIS:{FAILED:"Failed to analyze CV",NOT_FOUND:"Analysis not found",LIMIT_REACHED:"Analysis limit reached. Please upgrade your plan"}},Xx={VITE_SUPABASE_URL:"https://your-production-project.supabase.co",VITE_SUPABASE_ANON_KEY:"your-production-anon-key",VITE_OPENAI_API_KEY:"your-production-openai-key",VITE_STRIPE_PUBLIC_KEY:"your-production-stripe-key"};Object.entries(Xx).forEach(([r,e])=>{if(!e)throw new Error(`Missing required environment variable: ${r}`)});function Rp(r){return r instanceof Error?r.name==="AuthError"?of.AUTH.INVALID_CREDENTIALS:r.name==="NetworkError"?of.API.NETWORK:r.message:of.API.GENERAL}function Gu(){const[r,e]=W.useState(null),[t,s]=W.useState(!0);return W.useEffect(()=>{lt.auth.getSession().then(({data:{session:a}})=>{e(a),s(!1)});const{data:{subscription:i}}=lt.auth.onAuthStateChange((a,o)=>{e(o),o&&fc.trackEvent("user_signed_in")});return()=>i.unsubscribe()},[]),{session:r,loading:t,signOut:async()=>{try{const{error:i}=await lt.auth.signOut();if(i)throw i;fc.trackEvent("user_signed_out")}catch(i){Rp(i)}}}}function Yx(){const{signOut:r}=Gu(),e=G0(),t=async()=>{try{await r(),e("/",{replace:!0})}catch(s){console.error("Sign out failed:",s)}};return g.jsx("header",{className:"bg-white shadow",children:g.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:g.jsxs("div",{className:"flex justify-between items-center h-16",children:[g.jsx("div",{className:"flex items-center",children:g.jsx(Kn,{to:"/",className:"flex items-center",children:g.jsx("img",{src:"/images/logo.png",alt:"Logo",className:"h-12 w-auto",onError:s=>{s.currentTarget.src="/images/fallback-logo.png"}})})}),g.jsx("div",{className:"flex items-center space-x-4",children:g.jsxs("button",{onClick:t,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200",children:[g.jsx(r1,{className:"h-5 w-5 mr-2"}),"Sign Out"]})})]})})})}function Op({label:r,error:e,...t}){return g.jsxs("div",{children:[g.jsx("label",{htmlFor:t.id,className:"block text-sm font-medium text-gray-700",children:r}),g.jsx("textarea",{...t,className:"mt-1 block w-full rounded-md border p-2 h-32 focus:border-blue-500 focus:ring focus:ring-blue-200"}),e&&g.jsx("p",{className:"mt-1 text-sm text-red-600",children:e})]})}function Fc(r,e){const[t,s]=W.useState(null),[n,i]=W.useState(!0),[a,o]=W.useState(null),l=W.useRef(r);l.current=r;const c=W.useCallback(async()=>{try{i(!0),o(null);const h=await l.current();s(h)}catch(h){o(h instanceof Error?h.message:"An error occurred")}finally{i(!1)}},[]);return W.useEffect(()=>{e?.enabled!==!1&&c()},[c,e?.enabled]),{data:t,isLoading:n,error:a,refetch:c}}class Dt extends Error{constructor(e,t,s){super(e),this.statusCode=t,this.code=s,this.name="ApiError"}}async function Kx(r){const{data:e}=await lt.auth.getUser();if(!e?.user?.id)throw new Dt("User must be authenticated to upload candidates",401);const t={...r,user_id:e.user.id},{data:s,error:n}=await lt.from("candidates").insert([t]).select("id, name, cv_text, created_at").single();if(n)throw n.code==="23505"?new Dt("A candidate with this name already exists",400):new Dt(`Failed to upload candidate: ${n.message}`,500);if(!s)throw new Dt("No data returned after candidate upload",500);return s}async function Jx(){const{data:r}=await lt.auth.getUser();if(!r?.user?.id)throw new Dt("User must be authenticated to list candidates",401);const{data:e,error:t}=await lt.from("candidates").select("id, name, cv_text, created_at").eq("user_id",r.user.id).order("created_at",{ascending:!1});if(t)throw new Dt(`Failed to fetch candidates: ${t.message}`,500);return e||[]}function Mp(){const{data:r,isLoading:e,error:t,refetch:s}=Fc(Jx);return{candidates:r||[],isLoading:e,error:t,refetch:s}}function wi({size:r="md"}){const e={sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"};return g.jsx("div",{className:`animate-spin rounded-full border-2 border-gray-300 border-t-blue-600 ${e[r]}`})}function P1(r,e){W.useEffect(()=>{const t=s=>{!r.current||r.current.contains(s.target)||e()};return document.addEventListener("mousedown",t),document.addEventListener("touchstart",t),()=>{document.removeEventListener("mousedown",t),document.removeEventListener("touchstart",t)}},[r,e])}function Yt(r){const e=Object.prototype.toString.call(r);return r instanceof Date||typeof r=="object"&&e==="[object Date]"?new r.constructor(+r):typeof r=="number"||e==="[object Number]"||typeof r=="string"||e==="[object String]"?new Date(r):new Date(NaN)}function Vi(r,e){return r instanceof Date?new r.constructor(e):new Date(e)}const L1=6048e5,Zx=864e5,zh=43200,Ag=1440;let Qx={};function Dc(){return Qx}function mc(r,e){const t=Dc(),s=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,n=Yt(r),i=n.getDay(),a=(i<s?7:0)+i-s;return n.setDate(n.getDate()-a),n.setHours(0,0,0,0),n}function xu(r){return mc(r,{weekStartsOn:1})}function T1(r){const e=Yt(r),t=e.getFullYear(),s=Vi(r,0);s.setFullYear(t+1,0,4),s.setHours(0,0,0,0);const n=xu(s),i=Vi(r,0);i.setFullYear(t,0,4),i.setHours(0,0,0,0);const a=xu(i);return e.getTime()>=n.getTime()?t+1:e.getTime()>=a.getTime()?t:t-1}function Sg(r){const e=Yt(r);return e.setHours(0,0,0,0),e}function _u(r){const e=Yt(r),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+r-+t}function e_(r,e){const t=Sg(r),s=Sg(e),n=+t-_u(t),i=+s-_u(s);return Math.round((n-i)/Zx)}function t_(r){const e=T1(r),t=Vi(r,0);return t.setFullYear(e,0,4),t.setHours(0,0,0,0),xu(t)}function au(r,e){const t=Yt(r),s=Yt(e),n=t.getTime()-s.getTime();return n<0?-1:n>0?1:n}function s_(r){return Vi(r,Date.now())}function n_(r){return r instanceof Date||typeof r=="object"&&Object.prototype.toString.call(r)==="[object Date]"}function r_(r){if(!n_(r)&&typeof r!="number")return!1;const e=Yt(r);return!isNaN(Number(e))}function i_(r,e){const t=Yt(r),s=Yt(e),n=t.getFullYear()-s.getFullYear(),i=t.getMonth()-s.getMonth();return n*12+i}function a_(r){return e=>{const s=(r?Math[r]:Math.trunc)(e);return s===0?0:s}}function o_(r,e){return+Yt(r)-+Yt(e)}function l_(r){const e=Yt(r);return e.setHours(23,59,59,999),e}function c_(r){const e=Yt(r),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function h_(r){const e=Yt(r);return+l_(e)==+c_(e)}function u_(r,e){const t=Yt(r),s=Yt(e),n=au(t,s),i=Math.abs(i_(t,s));let a;if(i<1)a=0;else{t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-n*i);let o=au(t,s)===-n;h_(Yt(r))&&i===1&&au(r,s)===1&&(o=!1),a=n*(i-Number(o))}return a===0?0:a}function d_(r,e,t){const s=o_(r,e)/1e3;return a_(t?.roundingMethod)(s)}function f_(r){const e=Yt(r),t=Vi(r,0);return t.setFullYear(e.getFullYear(),0,1),t.setHours(0,0,0,0),t}const p_={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},m_=(r,e,t)=>{let s;const n=p_[r];return typeof n=="string"?s=n:e===1?s=n.one:s=n.other.replace("{{count}}",e.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+s:s+" ago":s};function lf(r){return(e={})=>{const t=e.width?String(e.width):r.defaultWidth;return r.formats[t]||r.formats[r.defaultWidth]}}const g_={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},b_={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},v_={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},y_={date:lf({formats:g_,defaultWidth:"full"}),time:lf({formats:b_,defaultWidth:"full"}),dateTime:lf({formats:v_,defaultWidth:"full"})},w_={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},x_=(r,e,t,s)=>w_[r];function Fl(r){return(e,t)=>{const s=t?.context?String(t.context):"standalone";let n;if(s==="formatting"&&r.formattingValues){const a=r.defaultFormattingWidth||r.defaultWidth,o=t?.width?String(t.width):a;n=r.formattingValues[o]||r.formattingValues[a]}else{const a=r.defaultWidth,o=t?.width?String(t.width):r.defaultWidth;n=r.values[o]||r.values[a]}const i=r.argumentCallback?r.argumentCallback(e):e;return n[i]}}const __={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},A_={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},S_={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},N_={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},E_={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},k_={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},C_=(r,e)=>{const t=Number(r),s=t%100;if(s>20||s<10)switch(s%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},P_={ordinalNumber:C_,era:Fl({values:__,defaultWidth:"wide"}),quarter:Fl({values:A_,defaultWidth:"wide",argumentCallback:r=>r-1}),month:Fl({values:S_,defaultWidth:"wide"}),day:Fl({values:N_,defaultWidth:"wide"}),dayPeriod:Fl({values:E_,defaultWidth:"wide",formattingValues:k_,defaultFormattingWidth:"wide"})};function Dl(r){return(e,t={})=>{const s=t.width,n=s&&r.matchPatterns[s]||r.matchPatterns[r.defaultMatchWidth],i=e.match(n);if(!i)return null;const a=i[0],o=s&&r.parsePatterns[s]||r.parsePatterns[r.defaultParseWidth],l=Array.isArray(o)?T_(o,d=>d.test(a)):L_(o,d=>d.test(a));let c;c=r.valueCallback?r.valueCallback(l):l,c=t.valueCallback?t.valueCallback(c):c;const h=e.slice(a.length);return{value:c,rest:h}}}function L_(r,e){for(const t in r)if(Object.prototype.hasOwnProperty.call(r,t)&&e(r[t]))return t}function T_(r,e){for(let t=0;t<r.length;t++)if(e(r[t]))return t}function I_(r){return(e,t={})=>{const s=e.match(r.matchPattern);if(!s)return null;const n=s[0],i=e.match(r.parsePattern);if(!i)return null;let a=r.valueCallback?r.valueCallback(i[0]):i[0];a=t.valueCallback?t.valueCallback(a):a;const o=e.slice(n.length);return{value:a,rest:o}}}const j_=/^(\d+)(th|st|nd|rd)?/i,R_=/\d+/i,O_={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},M_={any:[/^b/i,/^(a|c)/i]},F_={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},D_={any:[/1/i,/2/i,/3/i,/4/i]},B_={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},$_={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},q_={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},U_={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},z_={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},H_={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},W_={ordinalNumber:I_({matchPattern:j_,parsePattern:R_,valueCallback:r=>parseInt(r,10)}),era:Dl({matchPatterns:O_,defaultMatchWidth:"wide",parsePatterns:M_,defaultParseWidth:"any"}),quarter:Dl({matchPatterns:F_,defaultMatchWidth:"wide",parsePatterns:D_,defaultParseWidth:"any",valueCallback:r=>r+1}),month:Dl({matchPatterns:B_,defaultMatchWidth:"wide",parsePatterns:$_,defaultParseWidth:"any"}),day:Dl({matchPatterns:q_,defaultMatchWidth:"wide",parsePatterns:U_,defaultParseWidth:"any"}),dayPeriod:Dl({matchPatterns:z_,defaultMatchWidth:"any",parsePatterns:H_,defaultParseWidth:"any"})},I1={code:"en-US",formatDistance:m_,formatLong:y_,formatRelative:x_,localize:P_,match:W_,options:{weekStartsOn:0,firstWeekContainsDate:1}};function V_(r){const e=Yt(r);return e_(e,f_(e))+1}function G_(r){const e=Yt(r),t=+xu(e)-+t_(e);return Math.round(t/L1)+1}function j1(r,e){const t=Yt(r),s=t.getFullYear(),n=Dc(),i=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,a=Vi(r,0);a.setFullYear(s+1,0,i),a.setHours(0,0,0,0);const o=mc(a,e),l=Vi(r,0);l.setFullYear(s,0,i),l.setHours(0,0,0,0);const c=mc(l,e);return t.getTime()>=o.getTime()?s+1:t.getTime()>=c.getTime()?s:s-1}function X_(r,e){const t=Dc(),s=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,n=j1(r,e),i=Vi(r,0);return i.setFullYear(n,0,s),i.setHours(0,0,0,0),mc(i,e)}function Y_(r,e){const t=Yt(r),s=+mc(t,e)-+X_(t,e);return Math.round(s/L1)+1}function Ft(r,e){const t=r<0?"-":"",s=Math.abs(r).toString().padStart(e,"0");return t+s}const Oi={y(r,e){const t=r.getFullYear(),s=t>0?t:1-t;return Ft(e==="yy"?s%100:s,e.length)},M(r,e){const t=r.getMonth();return e==="M"?String(t+1):Ft(t+1,2)},d(r,e){return Ft(r.getDate(),e.length)},a(r,e){const t=r.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(r,e){return Ft(r.getHours()%12||12,e.length)},H(r,e){return Ft(r.getHours(),e.length)},m(r,e){return Ft(r.getMinutes(),e.length)},s(r,e){return Ft(r.getSeconds(),e.length)},S(r,e){const t=e.length,s=r.getMilliseconds(),n=Math.trunc(s*Math.pow(10,t-3));return Ft(n,e.length)}},yo={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Ng={G:function(r,e,t){const s=r.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(s,{width:"abbreviated"});case"GGGGG":return t.era(s,{width:"narrow"});case"GGGG":default:return t.era(s,{width:"wide"})}},y:function(r,e,t){if(e==="yo"){const s=r.getFullYear(),n=s>0?s:1-s;return t.ordinalNumber(n,{unit:"year"})}return Oi.y(r,e)},Y:function(r,e,t,s){const n=j1(r,s),i=n>0?n:1-n;if(e==="YY"){const a=i%100;return Ft(a,2)}return e==="Yo"?t.ordinalNumber(i,{unit:"year"}):Ft(i,e.length)},R:function(r,e){const t=T1(r);return Ft(t,e.length)},u:function(r,e){const t=r.getFullYear();return Ft(t,e.length)},Q:function(r,e,t){const s=Math.ceil((r.getMonth()+1)/3);switch(e){case"Q":return String(s);case"QQ":return Ft(s,2);case"Qo":return t.ordinalNumber(s,{unit:"quarter"});case"QQQ":return t.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(s,{width:"wide",context:"formatting"})}},q:function(r,e,t){const s=Math.ceil((r.getMonth()+1)/3);switch(e){case"q":return String(s);case"qq":return Ft(s,2);case"qo":return t.ordinalNumber(s,{unit:"quarter"});case"qqq":return t.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(s,{width:"wide",context:"standalone"})}},M:function(r,e,t){const s=r.getMonth();switch(e){case"M":case"MM":return Oi.M(r,e);case"Mo":return t.ordinalNumber(s+1,{unit:"month"});case"MMM":return t.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(s,{width:"wide",context:"formatting"})}},L:function(r,e,t){const s=r.getMonth();switch(e){case"L":return String(s+1);case"LL":return Ft(s+1,2);case"Lo":return t.ordinalNumber(s+1,{unit:"month"});case"LLL":return t.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(s,{width:"wide",context:"standalone"})}},w:function(r,e,t,s){const n=Y_(r,s);return e==="wo"?t.ordinalNumber(n,{unit:"week"}):Ft(n,e.length)},I:function(r,e,t){const s=G_(r);return e==="Io"?t.ordinalNumber(s,{unit:"week"}):Ft(s,e.length)},d:function(r,e,t){return e==="do"?t.ordinalNumber(r.getDate(),{unit:"date"}):Oi.d(r,e)},D:function(r,e,t){const s=V_(r);return e==="Do"?t.ordinalNumber(s,{unit:"dayOfYear"}):Ft(s,e.length)},E:function(r,e,t){const s=r.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(s,{width:"short",context:"formatting"});case"EEEE":default:return t.day(s,{width:"wide",context:"formatting"})}},e:function(r,e,t,s){const n=r.getDay(),i=(n-s.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return Ft(i,2);case"eo":return t.ordinalNumber(i,{unit:"day"});case"eee":return t.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(n,{width:"short",context:"formatting"});case"eeee":default:return t.day(n,{width:"wide",context:"formatting"})}},c:function(r,e,t,s){const n=r.getDay(),i=(n-s.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return Ft(i,e.length);case"co":return t.ordinalNumber(i,{unit:"day"});case"ccc":return t.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(n,{width:"narrow",context:"standalone"});case"cccccc":return t.day(n,{width:"short",context:"standalone"});case"cccc":default:return t.day(n,{width:"wide",context:"standalone"})}},i:function(r,e,t){const s=r.getDay(),n=s===0?7:s;switch(e){case"i":return String(n);case"ii":return Ft(n,e.length);case"io":return t.ordinalNumber(n,{unit:"day"});case"iii":return t.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(s,{width:"short",context:"formatting"});case"iiii":default:return t.day(s,{width:"wide",context:"formatting"})}},a:function(r,e,t){const n=r.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(r,e,t){const s=r.getHours();let n;switch(s===12?n=yo.noon:s===0?n=yo.midnight:n=s/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(r,e,t){const s=r.getHours();let n;switch(s>=17?n=yo.evening:s>=12?n=yo.afternoon:s>=4?n=yo.morning:n=yo.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(r,e,t){if(e==="ho"){let s=r.getHours()%12;return s===0&&(s=12),t.ordinalNumber(s,{unit:"hour"})}return Oi.h(r,e)},H:function(r,e,t){return e==="Ho"?t.ordinalNumber(r.getHours(),{unit:"hour"}):Oi.H(r,e)},K:function(r,e,t){const s=r.getHours()%12;return e==="Ko"?t.ordinalNumber(s,{unit:"hour"}):Ft(s,e.length)},k:function(r,e,t){let s=r.getHours();return s===0&&(s=24),e==="ko"?t.ordinalNumber(s,{unit:"hour"}):Ft(s,e.length)},m:function(r,e,t){return e==="mo"?t.ordinalNumber(r.getMinutes(),{unit:"minute"}):Oi.m(r,e)},s:function(r,e,t){return e==="so"?t.ordinalNumber(r.getSeconds(),{unit:"second"}):Oi.s(r,e)},S:function(r,e){return Oi.S(r,e)},X:function(r,e,t){const s=r.getTimezoneOffset();if(s===0)return"Z";switch(e){case"X":return kg(s);case"XXXX":case"XX":return ba(s);case"XXXXX":case"XXX":default:return ba(s,":")}},x:function(r,e,t){const s=r.getTimezoneOffset();switch(e){case"x":return kg(s);case"xxxx":case"xx":return ba(s);case"xxxxx":case"xxx":default:return ba(s,":")}},O:function(r,e,t){const s=r.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+Eg(s,":");case"OOOO":default:return"GMT"+ba(s,":")}},z:function(r,e,t){const s=r.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+Eg(s,":");case"zzzz":default:return"GMT"+ba(s,":")}},t:function(r,e,t){const s=Math.trunc(r.getTime()/1e3);return Ft(s,e.length)},T:function(r,e,t){const s=r.getTime();return Ft(s,e.length)}};function Eg(r,e=""){const t=r>0?"-":"+",s=Math.abs(r),n=Math.trunc(s/60),i=s%60;return i===0?t+String(n):t+String(n)+e+Ft(i,2)}function kg(r,e){return r%60===0?(r>0?"-":"+")+Ft(Math.abs(r)/60,2):ba(r,e)}function ba(r,e=""){const t=r>0?"-":"+",s=Math.abs(r),n=Ft(Math.trunc(s/60),2),i=Ft(s%60,2);return t+n+e+i}const Cg=(r,e)=>{switch(r){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},R1=(r,e)=>{switch(r){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},K_=(r,e)=>{const t=r.match(/(P+)(p+)?/)||[],s=t[1],n=t[2];if(!n)return Cg(r,e);let i;switch(s){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",Cg(s,e)).replace("{{time}}",R1(n,e))},J_={p:R1,P:K_},Z_=/^D+$/,Q_=/^Y+$/,eA=["D","DD","YY","YYYY"];function tA(r){return Z_.test(r)}function sA(r){return Q_.test(r)}function nA(r,e,t){const s=rA(r,e,t);if(console.warn(s),eA.includes(r))throw new RangeError(s)}function rA(r,e,t){const s=r[0]==="Y"?"years":"days of the month";return`Use \`${r.toLowerCase()}\` instead of \`${r}\` (in \`${e}\`) for formatting ${s} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const iA=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,aA=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,oA=/^'([^]*?)'?$/,lA=/''/g,cA=/[a-zA-Z]/;function hA(r,e,t){const s=Dc(),n=s.locale??I1,i=s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,a=s.weekStartsOn??s.locale?.options?.weekStartsOn??0,o=Yt(r);if(!r_(o))throw new RangeError("Invalid time value");let l=e.match(aA).map(h=>{const d=h[0];if(d==="p"||d==="P"){const p=J_[d];return p(h,n.formatLong)}return h}).join("").match(iA).map(h=>{if(h==="''")return{isToken:!1,value:"'"};const d=h[0];if(d==="'")return{isToken:!1,value:uA(h)};if(Ng[d])return{isToken:!0,value:h};if(d.match(cA))throw new RangeError("Format string contains an unescaped latin alphabet character `"+d+"`");return{isToken:!1,value:h}});n.localize.preprocessor&&(l=n.localize.preprocessor(o,l));const c={firstWeekContainsDate:i,weekStartsOn:a,locale:n};return l.map(h=>{if(!h.isToken)return h.value;const d=h.value;(sA(d)||tA(d))&&nA(d,e,String(r));const p=Ng[d[0]];return p(o,d,n.localize,c)}).join("")}function uA(r){const e=r.match(oA);return e?e[1].replace(lA,"'"):r}function dA(r,e,t){const s=Dc(),n=t?.locale??s.locale??I1,i=2520,a=au(r,e);if(isNaN(a))throw new RangeError("Invalid time value");const o=Object.assign({},t,{addSuffix:t?.addSuffix,comparison:a});let l,c;a>0?(l=Yt(e),c=Yt(r)):(l=Yt(r),c=Yt(e));const h=d_(c,l),d=(_u(c)-_u(l))/1e3,p=Math.round((h-d)/60);let f;if(p<2)return t?.includeSeconds?h<5?n.formatDistance("lessThanXSeconds",5,o):h<10?n.formatDistance("lessThanXSeconds",10,o):h<20?n.formatDistance("lessThanXSeconds",20,o):h<40?n.formatDistance("halfAMinute",0,o):h<60?n.formatDistance("lessThanXMinutes",1,o):n.formatDistance("xMinutes",1,o):p===0?n.formatDistance("lessThanXMinutes",1,o):n.formatDistance("xMinutes",p,o);if(p<45)return n.formatDistance("xMinutes",p,o);if(p<90)return n.formatDistance("aboutXHours",1,o);if(p<Ag){const y=Math.round(p/60);return n.formatDistance("aboutXHours",y,o)}else{if(p<i)return n.formatDistance("xDays",1,o);if(p<zh){const y=Math.round(p/Ag);return n.formatDistance("xDays",y,o)}else if(p<zh*2)return f=Math.round(p/zh),n.formatDistance("aboutXMonths",f,o)}if(f=u_(c,l),f<12){const y=Math.round(p/zh);return n.formatDistance("xMonths",y,o)}else{const y=f%12,w=Math.trunc(f/12);return y<3?n.formatDistance("aboutXYears",w,o):y<9?n.formatDistance("overXYears",w,o):n.formatDistance("almostXYears",w+1,o)}}function fA(r,e){return dA(r,s_(r),e)}function O1(r){return hA(new Date(r),"MMMM d, yyyy")}function pA(r){return fA(new Date(r),{addSuffix:!0})}function mA(r,e){return r.length<=e?r:`${r.slice(0,e)}...`}function gc(r,e,t){return t.some(s=>s.name.toLowerCase().trim()===r.toLowerCase().trim()&&s.cv_text.trim()===e.trim())}function bc(r,e,t){return t.some(s=>s.title.toLowerCase().trim()===r.toLowerCase().trim()&&s.jd_text.trim()===e.trim())}function gA({onSelect:r}){const{candidates:e,isLoading:t}=Mp(),[s,n]=W.useState(!1),i=W.useRef(null);P1(i,()=>n(!1));const a=e.reduce((o,l)=>{const c=o.findIndex(h=>gc(l.name,l.cv_text,[h]));return c>=0?(o[c].duplicateCount+=1,o[c].lastSubmitted=new Date(Math.max(new Date(o[c].lastSubmitted).getTime(),new Date(l.created_at).getTime())).toISOString()):o.push({...l,duplicateCount:1,lastSubmitted:l.created_at}),o},[]);return t?g.jsx(wi,{size:"sm"}):e.length?g.jsxs("div",{className:"relative",ref:i,children:[g.jsxs("button",{type:"button",onClick:()=>n(!s),className:"inline-flex items-center px-3 py-1.5 text-sm font-medium text-blue-600 hover:text-blue-700 bg-blue-50 hover:bg-blue-100 rounded-md transition-colors",children:[g.jsx("span",{children:"Previous CVs"}),g.jsx(Zo,{className:"ml-1 h-4 w-4"})]}),s&&g.jsx("div",{className:"absolute right-0 z-10 mt-2 w-96 rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5",children:g.jsx("div",{className:"max-h-60 overflow-auto py-1",children:a.map(o=>g.jsxs("button",{onClick:()=>{r({name:o.name,cvText:o.cv_text}),n(!1)},className:"w-full px-4 py-3 text-left hover:bg-gray-50 transition-colors border-b border-gray-100 last:border-0",children:[g.jsxs("div",{className:"flex justify-between items-start",children:[g.jsx("p",{className:"font-medium text-gray-900",children:o.name}),o.duplicateCount>1&&g.jsxs("span",{className:"text-xs px-2 py-1 bg-blue-50 text-blue-600 rounded-full",children:["Submitted ",o.duplicateCount," times"]})]}),g.jsx("p",{className:"text-sm text-gray-500 mt-1 line-clamp-2",children:mA(o.cv_text,150)})]},o.id))})})]}):null}var ac={};ac.d=(r,e)=>{for(var t in e)ac.o(e,t)&&!ac.o(r,t)&&Object.defineProperty(r,t,{enumerable:!0,get:e[t]})};ac.o=(r,e)=>Object.prototype.hasOwnProperty.call(r,e);var nt=globalThis.pdfjsLib={};ac.d(nt,{AbortException:()=>Ma,AnnotationEditorLayer:()=>gi,AnnotationEditorParamsType:()=>Nt,AnnotationEditorType:()=>pt,AnnotationEditorUIManager:()=>Gi,AnnotationLayer:()=>u3,AnnotationMode:()=>zi,ColorPicker:()=>Yn,DOMSVGFactory:()=>Xp,DrawLayer:()=>ln,FeatureTest:()=>un,GlobalWorkerOptions:()=>lc,ImageKind:()=>ou,InvalidPDFException:()=>F1,MissingPDFException:()=>Bc,OPS:()=>fr,OutputScale:()=>Vf,PDFDataRangeTransport:()=>tb,PDFDateString:()=>B1,PDFWorker:()=>Ds,PasswordResponses:()=>wA,PermissionFlag:()=>yA,PixelsPerInch:()=>Vo,RenderingCancelledException:()=>Bp,TextLayer:()=>cn,UnexpectedResponseException:()=>Ju,Util:()=>He,VerbosityLevel:()=>Xu,XfaLayer:()=>nb,build:()=>WS,createValidAbsoluteUrl:()=>SA,fetchData:()=>Qu,getDocument:()=>MS,getFilenameFromUrl:()=>jA,getPdfFilenameFromUrl:()=>RA,getXfaPageViewport:()=>OA,isDataScheme:()=>ed,isPdfFile:()=>$p,noContextMenu:()=>_r,normalizeUnicode:()=>LA,setLayerDimensions:()=>Ca,shadow:()=>xt,stopEvent:()=>br,version:()=>HS});const hn=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),M1=[1,0,0,1,0,0],zf=[.001,0,0,.001,0,0],bA=1e7,cf=1.35,On={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},zi={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},vA="pdfjs_internal_editor_",pt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},Nt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},yA={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Qs={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},ou={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Ls={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Bl={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Xu={ERRORS:0,WARNINGS:1,INFOS:5},fr={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},wA={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Yu=Xu.WARNINGS;function xA(r){Number.isInteger(r)&&(Yu=r)}function _A(){return Yu}function Ku(r){Yu>=Xu.INFOS&&console.log(`Info: ${r}`)}function vt(r){Yu>=Xu.WARNINGS&&console.log(`Warning: ${r}`)}function Ht(r){throw new Error(r)}function Ss(r,e){r||Ht(e)}function AA(r){switch(r?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function SA(r,e=null,t=null){if(!r)return null;try{if(t&&typeof r=="string"&&(t.addDefaultProtocol&&r.startsWith("www.")&&r.match(/\./g)?.length>=2&&(r=`http://${r}`),t.tryConvertEncoding))try{r=PA(r)}catch{}const s=e?new URL(r,e):new URL(r);if(AA(s))return s}catch{}return null}function xt(r,e,t,s=!1){return Object.defineProperty(r,e,{value:t,enumerable:!s,configurable:!0,writable:!1}),t}const ea=function(){function e(t,s){this.message=t,this.name=s}return e.prototype=new Error,e.constructor=e,e}();class Hf extends ea{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Wf extends ea{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class F1 extends ea{constructor(e){super(e,"InvalidPDFException")}}class Bc extends ea{constructor(e){super(e,"MissingPDFException")}}class Ju extends ea{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class NA extends ea{constructor(e){super(e,"FormatError")}}class Ma extends ea{constructor(e){super(e,"AbortException")}}function D1(r){(typeof r!="object"||r?.length===void 0)&&Ht("Invalid argument for bytesToString");const e=r.length,t=8192;if(e<t)return String.fromCharCode.apply(null,r);const s=[];for(let n=0;n<e;n+=t){const i=Math.min(n+t,e),a=r.subarray(n,i);s.push(String.fromCharCode.apply(null,a))}return s.join("")}function Zu(r){typeof r!="string"&&Ht("Invalid argument for stringToBytes");const e=r.length,t=new Uint8Array(e);for(let s=0;s<e;++s)t[s]=r.charCodeAt(s)&255;return t}function EA(r){return String.fromCharCode(r>>24&255,r>>16&255,r>>8&255,r&255)}function Fp(r){const e=Object.create(null);for(const[t,s]of r)e[t]=s;return e}function kA(){const r=new Uint8Array(4);return r[0]=1,new Uint32Array(r.buffer,0,1)[0]===1}function CA(){try{return new Function(""),!0}catch{return!1}}class un{static get isLittleEndian(){return xt(this,"isLittleEndian",kA())}static get isEvalSupported(){return xt(this,"isEvalSupported",CA())}static get isOffscreenCanvasSupported(){return xt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return xt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof navigator?.platform=="string"?xt(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof navigator?.userAgent=="string"&&navigator.userAgent.includes("Firefox")}):xt(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){return xt(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const hf=Array.from(Array(256).keys(),r=>r.toString(16).padStart(2,"0"));class He{static makeHexColor(e,t,s){return`#${hf[e]}${hf[t]}${hf[s]}`}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const s=e[0]*t[0]+e[1]*t[2]+t[4],n=e[0]*t[1]+e[1]*t[3]+t[5];return[s,n]}static applyInverseTransform(e,t){const s=t[0]*t[3]-t[1]*t[2],n=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/s,i=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/s;return[n,i]}static getAxialAlignedBoundingBox(e,t){const s=this.applyTransform(e,t),n=this.applyTransform(e.slice(2,4),t),i=this.applyTransform([e[0],e[3]],t),a=this.applyTransform([e[2],e[1]],t);return[Math.min(s[0],n[0],i[0],a[0]),Math.min(s[1],n[1],i[1],a[1]),Math.max(s[0],n[0],i[0],a[0]),Math.max(s[1],n[1],i[1],a[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],s=e[0]*t[0]+e[1]*t[2],n=e[0]*t[1]+e[1]*t[3],i=e[2]*t[0]+e[3]*t[2],a=e[2]*t[1]+e[3]*t[3],o=(s+a)/2,l=Math.sqrt((s+a)**2-4*(s*a-i*n))/2,c=o+l||1,h=o-l||1;return[Math.sqrt(c),Math.sqrt(h)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),n=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>n)return null;const i=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return i>a?null:[s,i,n,a]}static#e(e,t,s,n,i,a,o,l,c,h){if(c<=0||c>=1)return;const d=1-c,p=c*c,f=p*c,y=d*(d*(d*e+3*c*t)+3*p*s)+f*n,w=d*(d*(d*i+3*c*a)+3*p*o)+f*l;h[0]=Math.min(h[0],y),h[1]=Math.min(h[1],w),h[2]=Math.max(h[2],y),h[3]=Math.max(h[3],w)}static#t(e,t,s,n,i,a,o,l,c,h,d,p){if(Math.abs(c)<1e-12){Math.abs(h)>=1e-12&&this.#e(e,t,s,n,i,a,o,l,-d/h,p);return}const f=h**2-4*d*c;if(f<0)return;const y=Math.sqrt(f),w=2*c;this.#e(e,t,s,n,i,a,o,l,(-h+y)/w,p),this.#e(e,t,s,n,i,a,o,l,(-h-y)/w,p)}static bezierBoundingBox(e,t,s,n,i,a,o,l,c){return c?(c[0]=Math.min(c[0],e,o),c[1]=Math.min(c[1],t,l),c[2]=Math.max(c[2],e,o),c[3]=Math.max(c[3],t,l)):c=[Math.min(e,o),Math.min(t,l),Math.max(e,o),Math.max(t,l)],this.#t(e,s,i,o,t,n,a,l,3*(-e+3*(s-i)+o),6*(e-2*s+i),3*(s-e),c),this.#t(e,s,i,o,t,n,a,l,3*(-t+3*(n-a)+l),6*(t-2*n+a),3*(n-t),c),c}}function PA(r){return decodeURIComponent(escape(r))}let uf=null,Pg=null;function LA(r){return uf||(uf=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Pg=new Map([["ﬅ","ſt"]])),r.replaceAll(uf,(e,t,s)=>t?t.normalize("NFKC"):Pg.get(s))}function TA(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const r=new Uint8Array(32);return crypto.getRandomValues(r),D1(r)}const Dp="pdfjs_internal_id_",ci={BEZIER_CURVE_TO:0,MOVE_TO:1,LINE_TO:2,QUADRATIC_CURVE_TO:3,RESTORE:4,SAVE:5,SCALE:6,TRANSFORM:7,TRANSLATE:8};function IA(r){return Uint8Array.prototype.toBase64?r.toBase64():btoa(D1(r))}typeof Promise.try!="function"&&(Promise.try=function(r,...e){return new Promise(t=>{t(r(...e))})});const di="http://www.w3.org/2000/svg";class Vo{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function Qu(r,e="text"){if(Xl(r,document.baseURI)){const t=await fetch(r);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,s)=>{const n=new XMLHttpRequest;n.open("GET",r,!0),n.responseType=e,n.onreadystatechange=()=>{if(n.readyState===XMLHttpRequest.DONE){if(n.status===200||n.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(n.response);return}t(n.responseText);return}s(new Error(n.statusText))}},n.send(null)})}class $c{constructor({viewBox:e,scale:t,rotation:s,offsetX:n=0,offsetY:i=0,dontFlip:a=!1}){this.viewBox=e,this.scale=t,this.rotation=s,this.offsetX=n,this.offsetY=i;const o=(e[2]+e[0])/2,l=(e[3]+e[1])/2;let c,h,d,p;switch(s%=360,s<0&&(s+=360),s){case 180:c=-1,h=0,d=0,p=1;break;case 90:c=0,h=1,d=1,p=0;break;case 270:c=0,h=-1,d=-1,p=0;break;case 0:c=1,h=0,d=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(d=-d,p=-p);let f,y,w,A;c===0?(f=Math.abs(l-e[1])*t+n,y=Math.abs(o-e[0])*t+i,w=(e[3]-e[1])*t,A=(e[2]-e[0])*t):(f=Math.abs(o-e[0])*t+n,y=Math.abs(l-e[1])*t+i,w=(e[2]-e[0])*t,A=(e[3]-e[1])*t),this.transform=[c*t,h*t,d*t,p*t,f-c*t*o-d*t*l,y-h*t*o-p*t*l],this.width=w,this.height=A}get rawDims(){const{viewBox:e}=this;return xt(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:n=this.offsetY,dontFlip:i=!1}={}){return new $c({viewBox:this.viewBox.slice(),scale:e,rotation:t,offsetX:s,offsetY:n,dontFlip:i})}convertToViewportPoint(e,t){return He.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=He.applyTransform([e[0],e[1]],this.transform),s=He.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){return He.applyInverseTransform([e,t],this.transform)}}class Bp extends ea{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function ed(r){const e=r.length;let t=0;for(;t<e&&r[t].trim()==="";)t++;return r.substring(t,t+5).toLowerCase()==="data:"}function $p(r){return typeof r=="string"&&/\.pdf$/i.test(r)}function jA(r){return[r]=r.split(/[#?]/,1),r.substring(r.lastIndexOf("/")+1)}function RA(r,e="document.pdf"){if(typeof r!="string")return e;if(ed(r))return vt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,s=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,n=t.exec(r);let i=s.exec(n[1])||s.exec(n[2])||s.exec(n[3]);if(i&&(i=i[0],i.includes("%")))try{i=s.exec(decodeURIComponent(i))[0]}catch{}return i||e}class Lg{started=Object.create(null);times=[];time(e){e in this.started&&vt(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||vt(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:n,end:i}of this.times)e.push(`${s.padEnd(t)} ${i-n}ms
`);return e.join("")}}function Xl(r,e){try{const{protocol:t}=e?new URL(r,e):new URL(r);return t==="http:"||t==="https:"}catch{return!1}}function _r(r){r.preventDefault()}function br(r){r.preventDefault(),r.stopPropagation()}function Tg(r){console.log("Deprecated API usage: "+r)}class B1{static#e;static toDateObject(e){if(!e||typeof e!="string")return null;this.#e||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=this.#e.exec(e);if(!t)return null;const s=parseInt(t[1],10);let n=parseInt(t[2],10);n=n>=1&&n<=12?n-1:0;let i=parseInt(t[3],10);i=i>=1&&i<=31?i:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const c=t[7]||"Z";let h=parseInt(t[8],10);h=h>=0&&h<=23?h:0;let d=parseInt(t[9],10)||0;return d=d>=0&&d<=59?d:0,c==="-"?(a+=h,o+=d):c==="+"&&(a-=h,o-=d),new Date(Date.UTC(s,n,i,a,o,l))}}function OA(r,{scale:e=1,rotation:t=0}){const{width:s,height:n}=r.attributes.style,i=[0,0,parseInt(s),parseInt(n)];return new $c({viewBox:i,scale:e,rotation:t})}function qp(r){if(r.startsWith("#")){const e=parseInt(r.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return r.startsWith("rgb(")?r.slice(4,-1).split(",").map(e=>parseInt(e)):r.startsWith("rgba(")?r.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(vt(`Not a valid color format: "${r}"`),[0,0,0])}function MA(r){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of r.keys()){e.style.color=t;const s=window.getComputedStyle(e).color;r.set(t,qp(s))}e.remove()}function ts(r){const{a:e,b:t,c:s,d:n,e:i,f:a}=r.getTransform();return[e,t,s,n,i,a]}function Fr(r){const{a:e,b:t,c:s,d:n,e:i,f:a}=r.getTransform().invertSelf();return[e,t,s,n,i,a]}function Ca(r,e,t=!1,s=!0){if(e instanceof $c){const{pageWidth:n,pageHeight:i}=e.rawDims,{style:a}=r,o=un.isCSSRoundSupported,l=`var(--scale-factor) * ${n}px`,c=`var(--scale-factor) * ${i}px`,h=o?`round(down, ${l}, var(--scale-round-x, 1px))`:`calc(${l})`,d=o?`round(down, ${c}, var(--scale-round-y, 1px))`:`calc(${c})`;!t||e.rotation%180===0?(a.width=h,a.height=d):(a.width=d,a.height=h)}s&&r.setAttribute("data-main-rotation",e.rotation)}class Vf{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}class oc{#e=null;#t=null;#s;#n=null;#i=null;static#r=null;constructor(e){this.#s=e,oc.#r||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"})}render(){const e=this.#e=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=this.#s._uiManager._signal;e.addEventListener("contextmenu",_r,{signal:t}),e.addEventListener("pointerdown",oc.#c,{signal:t});const s=this.#n=document.createElement("div");s.className="buttons",e.append(s);const n=this.#s.toolbarPosition;if(n){const{style:i}=e,a=this.#s._uiManager.direction==="ltr"?1-n[0]:n[0];i.insetInlineEnd=`${100*a}%`,i.top=`calc(${100*n[1]}% + var(--editor-toolbar-vert-offset))`}return this.#u(),e}get div(){return this.#e}static#c(e){e.stopPropagation()}#o(e){this.#s._focusEventsAllowed=!1,br(e)}#h(e){this.#s._focusEventsAllowed=!0,br(e)}#l(e){const t=this.#s._uiManager._signal;e.addEventListener("focusin",this.#o.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",_r,{signal:t})}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#i?.shown()}#u(){const{editorType:e,_uiManager:t}=this.#s,s=document.createElement("button");s.className="delete",s.tabIndex=0,s.setAttribute("data-l10n-id",oc.#r[e]),this.#l(s),s.addEventListener("click",n=>{t.delete()},{signal:t._signal}),this.#n.append(s)}get#a(){const e=document.createElement("div");return e.className="divider",e}async addAltText(e){const t=await e.render();this.#l(t),this.#n.prepend(t,this.#a),this.#i=e}addColorPicker(e){this.#t=e;const t=e.renderButton();this.#l(t),this.#n.prepend(t,this.#a)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}}class FA{#e=null;#t=null;#s;constructor(e){this.#s=e}#n(){const e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",_r,{signal:this.#s._signal});const t=this.#e=document.createElement("div");return t.className="buttons",e.append(t),this.#r(),e}#i(e,t){let s=0,n=0;for(const i of e){const a=i.y+i.height;if(a<s)continue;const o=i.x+(t?i.width:0);if(a>s){n=o,s=a;continue}t?o>n&&(n=o):o<n&&(n=o)}return[t?1-n:n,s]}show(e,t,s){const[n,i]=this.#i(t,s),{style:a}=this.#t||=this.#n();e.append(this.#t),a.insetInlineEnd=`${100*n}%`,a.top=`calc(${100*i}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#r(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const s=this.#s._signal;e.addEventListener("contextmenu",_r,{signal:s}),e.addEventListener("click",()=>{this.#s.highlightSelection("floating_button")},{signal:s}),this.#e.append(e)}}function Au(r,e,t){for(const s of t)e.addEventListener(s,r[s].bind(r))}class DA{#e=0;get id(){return`${vA}${this.#e++}`}}class Up{#e=TA();#t=0;#s=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),n=new Image;n.src=e;const i=n.decode().then(()=>(s.drawImage(n,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return xt(this,"_isSVGFittingCanvas",i)}async#n(e,t){this.#s||=new Map;let s=this.#s.get(e);if(s===null)return null;if(s?.bitmap)return s.refCounter+=1,s;try{s||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let n;if(typeof t=="string"?(s.url=t,n=await Qu(t,"blob")):t instanceof File?n=s.file=t:t instanceof Blob&&(n=t),n.type==="image/svg+xml"){const i=Up._isSVGFittingCanvas,a=new FileReader,o=new Image,l=new Promise((c,h)=>{o.onload=()=>{s.bitmap=o,s.isSvg=!0,c()},a.onload=async()=>{const d=s.svgUrl=a.result;o.src=await i?`${d}#svgView(preserveAspectRatio(none))`:d},o.onerror=a.onerror=h});a.readAsDataURL(n),await l}else s.bitmap=await createImageBitmap(n);s.refCounter=1}catch(n){vt(n),s=null}return this.#s.set(e,s),s&&this.#s.set(s.id,s),s}async getFromFile(e){const{lastModified:t,name:s,size:n,type:i}=e;return this.#n(`${t}_${s}_${n}_${i}`,e)}async getFromUrl(e){return this.#n(e,e)}async getFromBlob(e,t){const s=await t;return this.#n(e,s)}async getFromId(e){this.#s||=new Map;const t=this.#s.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:s}=t;return delete t.blobPromise,this.getFromBlob(t.id,s)}return this.getFromUrl(t.url)}getFromCanvas(e,t){this.#s||=new Map;let s=this.#s.get(e);if(s?.bitmap)return s.refCounter+=1,s;const n=new OffscreenCanvas(t.width,t.height);return n.getContext("2d").drawImage(t,0,0),s={bitmap:n.transferToImageBitmap(),id:`image_${this.#e}_${this.#t++}`,refCounter:1,isSvg:!1},this.#s.set(e,s),this.#s.set(s.id,s),s}getSvgUrl(e){const t=this.#s.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#s||=new Map;const t=this.#s.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:s}=t;if(!t.url&&!t.file){const n=new OffscreenCanvas(s.width,s.height);n.getContext("bitmaprenderer").transferFromImageBitmap(s),t.blobPromise=n.convertToBlob()}s.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#e}_`)}}class BA{#e=[];#t=!1;#s;#n=-1;constructor(e=128){this.#s=e}add({cmd:e,undo:t,post:s,mustExec:n,type:i=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(n&&e(),this.#t)return;const l={cmd:e,undo:t,post:s,type:i};if(this.#n===-1){this.#e.length>0&&(this.#e.length=0),this.#n=0,this.#e.push(l);return}if(a&&this.#e[this.#n].type===i){o&&(l.undo=this.#e[this.#n].undo),this.#e[this.#n]=l;return}const c=this.#n+1;c===this.#s?this.#e.splice(0,1):(this.#n=c,c<this.#e.length&&this.#e.splice(c)),this.#e.push(l)}undo(){if(this.#n===-1)return;this.#t=!0;const{undo:e,post:t}=this.#e[this.#n];e(),t?.(),this.#t=!1,this.#n-=1}redo(){if(this.#n<this.#e.length-1){this.#n+=1,this.#t=!0;const{cmd:e,post:t}=this.#e[this.#n];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#e.length-1}cleanType(e){if(this.#n!==-1){for(let t=this.#n;t>=0;t--)if(this.#e[t].type!==e){this.#e.splice(t+1,this.#n-t),this.#n=t;return}this.#e.length=0,this.#n=-1}}destroy(){this.#e=null}}class qc{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=un.platform;for(const[s,n,i={}]of e)for(const a of s){const o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:n,options:i}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:n,options:i}),this.allKeys.add(a.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(this.#e(t));if(!s)return;const{callback:n,options:{bubbles:i=!1,args:a=[],checker:o=null}}=s;o&&!o(e,t)||(n.bind(e,...a,t)(),i||br(t))}}class zp{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return MA(e),xt(this,"_colors",e)}convert(e){const t=qp(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,n]of this._colors)if(n.every((i,a)=>i===t[a]))return zp._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?He.makeHexColor(...t):e}}class Gi{#e=new AbortController;#t=null;#s=new Map;#n=new Map;#i=null;#r=null;#c=null;#o=new BA;#h=null;#l=null;#u=0;#a=new Set;#d=null;#f=null;#p=new Set;_editorUndoBar=null;#g=!1;#m=!1;#b=!1;#v=null;#w=null;#x=null;#S=null;#N=!1;#E=null;#C=new DA;#_=!1;#P=!1;#k=null;#L=null;#R=null;#D=null;#A=pt.NONE;#y=new Set;#j=null;#B=null;#q=null;#U={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#M=[0,0];#I=null;#$=null;#V=null;#O=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=Gi.prototype,t=a=>a.#$.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),s=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},n=this.TRANSLATE_SMALL,i=this.TRANSLATE_BIG;return xt(this,"_keyboardManager",new qc([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&a.#$.contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&a.#$.contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}]]))}constructor(e,t,s,n,i,a,o,l,c,h,d,p){const f=this._signal=this.#e.signal;this.#$=e,this.#V=t,this.#i=s,this._eventBus=n,n._on("editingaction",this.onEditingAction.bind(this),{signal:f}),n._on("pagechanging",this.onPageChanging.bind(this),{signal:f}),n._on("scalechanging",this.onScaleChanging.bind(this),{signal:f}),n._on("rotationchanging",this.onRotationChanging.bind(this),{signal:f}),n._on("setpreference",this.onSetPreference.bind(this),{signal:f}),n._on("switchannotationeditorparams",y=>this.updateParams(y.type,y.value),{signal:f}),this.#te(),this.#ie(),this.#X(),this.#r=i.annotationStorage,this.#v=i.filterFactory,this.#B=a,this.#S=o||null,this.#g=l,this.#m=c,this.#b=h,this.#D=d||null,this.viewParameters={realScale:Vo.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=p||null}destroy(){this.#O?.resolve(),this.#O=null,this.#e?.abort(),this.#e=null,this._signal=null;for(const e of this.#n.values())e.destroy();this.#n.clear(),this.#s.clear(),this.#p.clear(),this.#t=null,this.#y.clear(),this.#o.destroy(),this.#i?.destroy(),this.#E?.hide(),this.#E=null,this.#w&&(clearTimeout(this.#w),this.#w=null),this.#I&&(clearTimeout(this.#I),this.#I=null),this._editorUndoBar?.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return this.#D}get useNewAltTextFlow(){return this.#m}get useNewAltTextWhenAddingImage(){return this.#b}get hcmFilter(){return xt(this,"hcmFilter",this.#B?this.#v.addHCMFilter(this.#B.foreground,this.#B.background):"none")}get direction(){return xt(this,"direction",getComputedStyle(this.#$).direction)}get highlightColors(){return xt(this,"highlightColors",this.#S?new Map(this.#S.split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return xt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#l=e}setMainHighlightColorPicker(e){this.#R=e}editAltText(e,t=!1){this.#i?.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":this.#b=t;break}}onPageChanging({pageNumber:e}){this.#u=e-1}focusMainContainer(){this.#$.focus()}findParent(e,t){for(const s of this.#n.values()){const{x:n,y:i,width:a,height:o}=s.div.getBoundingClientRect();if(e>=n&&e<=n+a&&t>=i&&t<=i+o)return s}return null}disableUserSelect(e=!1){this.#V.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#p.add(e)}removeShouldRescale(e){this.#p.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*Vo.PDF_TO_CSS_UNITS;for(const t of this.#p)t.onScaleChanging();this.#l?.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}#H({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e}#G(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of this.#n.values())if(s.hasTextLayer(e))return s;return null}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:s,anchorOffset:n,focusNode:i,focusOffset:a}=t,o=t.toString(),c=this.#H(t).closest(".textLayer"),h=this.getSelectionBoxes(c);if(!h)return;t.empty();const d=this.#G(c),p=this.#A===pt.NONE,f=()=>{d?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:h,anchorNode:s,anchorOffset:n,focusNode:i,focusOffset:a,text:o}),p&&this.showAllEditors("highlight",!0,!0)};if(p){this.switchToMode(pt.HIGHLIGHT,f);return}f()}#Q(){const e=document.getSelection();if(!e||e.isCollapsed)return;const s=this.#H(e).closest(".textLayer"),n=this.getSelectionBoxes(s);n&&(this.#E||=new FA(this),this.#E.show(s,n,this.direction==="ltr"))}addToAnnotationStorage(e){!e.isEmpty()&&this.#r&&!this.#r.has(e.id)&&this.#r.setValue(e.id,e)}#ee(){const e=document.getSelection();if(!e||e.isCollapsed){this.#j&&(this.#E?.hide(),this.#j=null,this.#T({hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===this.#j)return;const n=this.#H(e).closest(".textLayer");if(!n){this.#j&&(this.#E?.hide(),this.#j=null,this.#T({hasSelectedText:!1}));return}if(this.#E?.hide(),this.#j=t,this.#T({hasSelectedText:!0}),!(this.#A!==pt.HIGHLIGHT&&this.#A!==pt.NONE)&&(this.#A===pt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#N=this.isShiftKeyDown,!this.isShiftKeyDown)){const i=this.#A===pt.HIGHLIGHT?this.#G(n):null;i?.toggleDrawing();const a=new AbortController,o=this.combinedSignal(a),l=c=>{c.type==="pointerup"&&c.button!==0||(a.abort(),i?.toggleDrawing(!0),c.type==="pointerup"&&this.#W("main_toolbar"))};window.addEventListener("pointerup",l,{signal:o}),window.addEventListener("blur",l,{signal:o})}}#W(e=""){this.#A===pt.HIGHLIGHT?this.highlightSelection(e):this.#g&&this.#Q()}#te(){document.addEventListener("selectionchange",this.#ee.bind(this),{signal:this._signal})}#se(){if(this.#x)return;this.#x=new AbortController;const e=this.combinedSignal(this.#x);window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}#ne(){this.#x?.abort(),this.#x=null}blur(){if(this.isShiftKeyDown=!1,this.#N&&(this.#N=!1,this.#W("main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#y)if(t.div.contains(e)){this.#L=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#L)return;const[e,t]=this.#L;this.#L=null,t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}#X(){if(this.#k)return;this.#k=new AbortController;const e=this.combinedSignal(this.#k);window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}#re(){this.#k?.abort(),this.#k=null}#Y(){if(this.#h)return;this.#h=new AbortController;const e=this.combinedSignal(this.#h);document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}#K(){this.#h?.abort(),this.#h=null}#ie(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}addEditListeners(){this.#X(),this.#Y()}removeEditListeners(){this.#re(),this.#K()}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of this.#f)if(s.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const s of this.#f)if(s.isHandlingMimeForPasting(t.type)){s.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const s of this.#y){const n=s.serialize(!0);n&&t.push(n)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const i of t.items)for(const a of this.#f)if(a.isHandlingMimeForPasting(i.type)){a.paste(i,this.currentLayer);return}let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(i){vt(`paste: "${i.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const n=this.currentLayer;try{const i=[];for(const l of s){const c=await n.deserialize(l);if(!c)return;i.push(c)}const a=()=>{for(const l of i)this.#J(l);this.#Z(i)},o=()=>{for(const l of i)l.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(i){vt(`paste: "${i.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),this.#A!==pt.NONE&&!this.isEditorHandlingKeyboard&&Gi._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,this.#N&&(this.#N=!1,this.#W("main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#T(e){Object.entries(e).some(([s,n])=>this.#U[s]!==n)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#U,e)}),this.#A===pt.HIGHLIGHT&&e.hasSelectedEditor===!1&&this.#F([[Nt.HIGHLIGHT_FREE,!0]]))}#F(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#se(),this.#Y(),this.#T({isEditing:this.#A!==pt.NONE,isEmpty:this.#z(),hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:this.#o.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ne(),this.#K(),this.#T({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#f){this.#f=e;for(const t of this.#f)this.#F(t.defaultPropertiesToUpdate)}}getId(){return this.#C.id}get currentLayer(){return this.#n.get(this.#u)}getLayer(e){return this.#n.get(e)}get currentPageIndex(){return this.#u}addLayer(e){this.#n.set(e.pageIndex,e),this.#_?e.enable():e.disable()}removeLayer(e){this.#n.delete(e.pageIndex)}async updateMode(e,t=null,s=!1){if(this.#A!==e&&!(this.#O&&(await this.#O.promise,!this.#O))){if(this.#O=Promise.withResolvers(),this.#A=e,e===pt.NONE){this.setEditingState(!1),this.#oe(),this._editorUndoBar?.hide(),this.#O.resolve();return}this.setEditingState(!0),await this.#ae(),this.unselectAll();for(const n of this.#n.values())n.updateMode(e);if(!t){s&&this.addNewEditorFromKeyboard(),this.#O.resolve();return}for(const n of this.#s.values())n.annotationElementId===t?(this.setSelected(n),n.enterInEditMode()):n.unselect();this.#O.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==this.#A&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){if(this.#f){switch(e){case Nt.CREATE:this.currentLayer.addNewEditor();return;case Nt.HIGHLIGHT_DEFAULT_COLOR:this.#R?.updateColor(t);break;case Nt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#q||=new Map).set(e,t),this.showAllEditors("highlight",t);break}for(const s of this.#y)s.updateParams(e,t);for(const s of this.#f)s.updateDefaultParams(e,t)}}showAllEditors(e,t,s=!1){for(const i of this.#s.values())i.editorType===e&&i.show(t);(this.#q?.get(Nt.HIGHLIGHT_SHOW_ALL)??!0)!==t&&this.#F([[Nt.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(this.#P!==e){this.#P=e;for(const t of this.#n.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}async#ae(){if(!this.#_){this.#_=!0;const e=[];for(const t of this.#n.values())e.push(t.enable());await Promise.all(e);for(const t of this.#s.values())t.enable()}}#oe(){if(this.unselectAll(),this.#_){this.#_=!1;for(const e of this.#n.values())e.disable();for(const e of this.#s.values())e.disable()}}getEditors(e){const t=[];for(const s of this.#s.values())s.pageIndex===e&&t.push(s);return t}getEditor(e){return this.#s.get(e)}addEditor(e){this.#s.set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(this.#w&&clearTimeout(this.#w),this.#w=setTimeout(()=>{this.focusMainContainer(),this.#w=null},0)),this.#s.delete(e.id),this.unselect(e),(!e.annotationElementId||!this.#a.has(e.annotationElementId))&&this.#r?.remove(e.id)}addDeletedAnnotationElement(e){this.#a.add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return this.#a.has(e)}removeDeletedAnnotationElement(e){this.#a.delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}#J(e){const t=this.#n.get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#F(e.propertiesToUpdate))}get#le(){let e=null;for(e of this.#y);return e}updateUI(e){this.#le===e&&this.#F(e.propertiesToUpdate)}updateUIForDefaultProperties(e){this.#F(e.defaultPropertiesToUpdate)}toggleSelected(e){if(this.#y.has(e)){this.#y.delete(e),e.unselect(),this.#T({hasSelectedEditor:this.hasSelection});return}this.#y.add(e),e.select(),this.#F(e.propertiesToUpdate),this.#T({hasSelectedEditor:!0})}setSelected(e){this.#l?.commitOrRemove();for(const t of this.#y)t!==e&&t.unselect();this.#y.clear(),this.#y.add(e),e.select(),this.#F(e.propertiesToUpdate),this.#T({hasSelectedEditor:!0})}isSelected(e){return this.#y.has(e)}get firstSelectedEditor(){return this.#y.values().next().value}unselect(e){e.unselect(),this.#y.delete(e),this.#T({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#y.size!==0}get isEnterHandled(){return this.#y.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#o.undo(),this.#T({hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#z()}),this._editorUndoBar?.hide()}redo(){this.#o.redo(),this.#T({hasSomethingToUndo:!0,hasSomethingToRedo:this.#o.hasSomethingToRedo(),isEmpty:this.#z()})}addCommands(e){this.#o.add(e),this.#T({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#z()})}cleanUndoStack(e){this.#o.cleanType(e)}#z(){if(this.#s.size===0)return!0;if(this.#s.size===1)for(const e of this.#s.values())return e.isEmpty();return!1}delete(){this.commitOrRemove();const e=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...this.#y],s=()=>{this._editorUndoBar?.show(n,t.length===1?t[0].editorType:t.length);for(const i of t)i.remove()},n=()=>{for(const i of t)this.#J(i)};this.addCommands({cmd:s,undo:n,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#Z(e){for(const t of this.#y)t.unselect();this.#y.clear();for(const t of e)t.isEmpty()||(this.#y.add(t),t.select());this.#T({hasSelectedEditor:this.hasSelection})}selectAll(){for(const e of this.#y)e.commit();this.#Z(this.#s.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#A!==pt.NONE))&&!this.#l?.commitOrRemove()&&this.hasSelection){for(const e of this.#y)e.unselect();this.#y.clear(),this.#T({hasSelectedEditor:!1})}}translateSelectedEditors(e,t,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;this.#M[0]+=e,this.#M[1]+=t;const[n,i]=this.#M,a=[...this.#y],o=1e3;this.#I&&clearTimeout(this.#I),this.#I=setTimeout(()=>{this.#I=null,this.#M[0]=this.#M[1]=0,this.addCommands({cmd:()=>{for(const l of a)this.#s.has(l.id)&&l.translateInPage(n,i)},undo:()=>{for(const l of a)this.#s.has(l.id)&&l.translateInPage(-n,-i)},mustExec:!1})},o);for(const l of a)l.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#d=new Map;for(const e of this.#y)this.#d.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#d)return!1;this.disableUserSelect(!1);const e=this.#d;this.#d=null;let t=!1;for(const[{x:n,y:i,pageIndex:a},o]of e)o.newX=n,o.newY=i,o.newPageIndex=a,t||=n!==o.savedX||i!==o.savedY||a!==o.savedPageIndex;if(!t)return!1;const s=(n,i,a,o)=>{if(this.#s.has(n.id)){const l=this.#n.get(o);l?n._setParentAndPosition(l,i,a):(n.pageIndex=o,n.x=i,n.y=a)}};return this.addCommands({cmd:()=>{for(const[n,{newX:i,newY:a,newPageIndex:o}]of e)s(n,i,a,o)},undo:()=>{for(const[n,{savedX:i,savedY:a,savedPageIndex:o}]of e)s(n,i,a,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#d)for(const s of this.#d.keys())s.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#y.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#A}get imageManager(){return xt(this,"imageManager",new Up)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let c=0,h=t.rangeCount;c<h;c++)if(!e.contains(t.getRangeAt(c).commonAncestorContainer))return null;const{x:s,y:n,width:i,height:a}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(c,h,d,p)=>({x:(h-n)/a,y:1-(c+d-s)/i,width:p/a,height:d/i});break;case"180":o=(c,h,d,p)=>({x:1-(c+d-s)/i,y:1-(h+p-n)/a,width:d/i,height:p/a});break;case"270":o=(c,h,d,p)=>({x:1-(h+p-n)/a,y:(c-s)/i,width:p/a,height:d/i});break;default:o=(c,h,d,p)=>({x:(c-s)/i,y:(h-n)/a,width:d/i,height:p/a});break}const l=[];for(let c=0,h=t.rangeCount;c<h;c++){const d=t.getRangeAt(c);if(!d.collapsed)for(const{x:p,y:f,width:y,height:w}of d.getClientRects())y===0||w===0||l.push(o(p,f,y,w))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(this.#c||=new Map).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){this.#c?.delete(e)}renderAnnotationElement(e){const t=this.#c?.get(e.data.id);if(!t)return;const s=this.#r.getRawValue(t);s&&(this.#A===pt.NONE&&!s.hasBeenModified||s.renderAnnotationElement(e))}}class qr{#e=null;#t=!1;#s=null;#n=null;#i=null;#r=null;#c=!1;#o=null;#h=null;#l=null;#u=null;#a=!1;static#d=null;static _l10n=null;constructor(e){this.#h=e,this.#a=e._uiManager.useNewAltTextFlow,qr.#d||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(e){qr._l10n??=e}async render(){const e=this.#s=document.createElement("button");e.className="altText",e.tabIndex="0";const t=this.#n=document.createElement("span");e.append(t),this.#a?(e.classList.add("new"),e.setAttribute("data-l10n-id",qr.#d.missing),t.setAttribute("data-l10n-id",qr.#d["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=this.#h._uiManager._signal;e.addEventListener("contextmenu",_r,{signal:s}),e.addEventListener("pointerdown",i=>i.stopPropagation(),{signal:s});const n=i=>{i.preventDefault(),this.#h._uiManager.editAltText(this.#h),this.#a&&this.#h._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#f}})};return e.addEventListener("click",n,{capture:!0,signal:s}),e.addEventListener("keydown",i=>{i.target===e&&i.key==="Enter"&&(this.#c=!0,n(i))},{signal:s}),await this.#p(),e}get#f(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#s&&(this.#s.focus({focusVisible:this.#c}),this.#c=!1)}isEmpty(){return this.#a?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#a?this.#e!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(e){this.#e===null&&(this.#l=e,this.#u=await qr._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e}),this.#p())}toggleAltTextBadge(e=!1){if(!this.#a||this.#e){this.#o?.remove(),this.#o=null;return}if(!this.#o){const t=this.#o=document.createElement("div");t.className="noAltTextBadge",this.#h.div.append(t)}this.#o.classList.toggle("hidden",!e)}serialize(e){let t=this.#e;return!e&&this.#l===t&&(t=this.#u),{altText:t,decorative:this.#t,guessedText:this.#l,textWithDisclaimer:this.#u}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:e,decorative:t,guessedText:s,textWithDisclaimer:n,cancel:i=!1}){s&&(this.#l=s,this.#u=n),!(this.#e===e&&this.#t===t)&&(i||(this.#e=e,this.#t=t),this.#p())}toggle(e=!1){this.#s&&(!e&&this.#r&&(clearTimeout(this.#r),this.#r=null),this.#s.disabled=!e)}shown(){this.#h._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#f}})}destroy(){this.#s?.remove(),this.#s=null,this.#n=null,this.#i=null,this.#o?.remove(),this.#o=null}async#p(){const e=this.#s;if(!e)return;if(this.#a){if(e.classList.toggle("done",!!this.#e),e.setAttribute("data-l10n-id",qr.#d[this.#f]),this.#n?.setAttribute("data-l10n-id",qr.#d[`${this.#f}-label`]),!this.#e){this.#i?.remove();return}}else{if(!this.#e&&!this.#t){e.classList.remove("done"),this.#i?.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=this.#i;if(!t){this.#i=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${this.#h.id}`;const n=100,i=this.#h._uiManager._signal;i.addEventListener("abort",()=>{clearTimeout(this.#r),this.#r=null},{once:!0}),e.addEventListener("mouseenter",()=>{this.#r=setTimeout(()=>{this.#r=null,this.#i.classList.add("show"),this.#h._reportTelemetry({action:"alt_text_tooltip"})},n)},{signal:i}),e.addEventListener("mouseleave",()=>{this.#r&&(clearTimeout(this.#r),this.#r=null),this.#i?.classList.remove("show")},{signal:i})}this.#t?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=this.#e),t.parentNode||e.append(t),this.#h.getImageForAltText()?.setAttribute("aria-describedby",t.id)}}class bt{#e=null;#t=null;#s=null;#n=!1;#i=null;#r="";#c=!1;#o=null;#h=null;#l=null;#u=null;#a="";#d=!1;#f=null;#p=!1;#g=!1;#m=!1;#b=null;#v=0;#w=0;#x=null;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#S=!1;#N=bt._zIndex++;static _borderLineWidth=-1;static _colorManager=new zp;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const e=bt.prototype._resizeWithKeyboard,t=Gi.TRANSLATE_SMALL,s=Gi.TRANSLATE_BIG;return xt(this,"_resizerKeyboardManager",new qc([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],bt.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:s,pageHeight:n,pageX:i,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,n],this.pageTranslation=[i,a];const[o,l]=this.parentDimensions;this.x=e.x/o,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return xt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new $A({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(bt._l10n??=e,bt._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),bt._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);bt._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Ht("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#S}set _isDraggable(e){this.#S=e,this.div?.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#N}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):this.#I(),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#d?this.#d=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,n){const[i,a]=this.parentDimensions;[s,n]=this.screenToPageTranslation(s,n),this.x=(e+s)/i,this.y=(t+n)/a,this.fixAndSetPosition()}#E([e,t],s,n){[s,n]=this.screenToPageTranslation(s,n),this.x+=s/e,this.y+=n/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(e,t){this.#E(this.parentDimensions,e,t)}translateInPage(e,t){this.#f||=[this.x,this.y,this.width,this.height],this.#E(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){this.#f||=[this.x,this.y,this.width,this.height];const{div:s,parentDimensions:[n,i]}=this;if(this.x+=e/n,this.y+=t/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:d,y:p}=this.div.getBoundingClientRect();this.parent.findNewParent(this,d,p)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[l,c]=this.getBaseTranslation();a+=l,o+=c;const{style:h}=s;h.left=`${(100*a).toFixed(2)}%`,h.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),s.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!this.#f&&(this.#f[0]!==this.x||this.#f[1]!==this.y)}get _hasBeenResized(){return!!this.#f&&(this.#f[2]!==this.width||this.#f[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=bt,n=s/e,i=s/t;switch(this.rotation){case 90:return[-n,i];case 180:return[n,i];case 270:return[n,-i];default:return[-n,-i]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[s,n]}=this;let{x:i,y:a,width:o,height:l}=this;if(o*=s,l*=n,i*=s,a*=n,this._mustFixPosition)switch(e){case 0:i=Math.max(0,Math.min(s-o,i)),a=Math.max(0,Math.min(n-l,a));break;case 90:i=Math.max(0,Math.min(s-l,i)),a=Math.min(n,Math.max(o,a));break;case 180:i=Math.min(s,Math.max(o,i)),a=Math.min(n,Math.max(l,a));break;case 270:i=Math.min(s,Math.max(l,i)),a=Math.max(0,Math.min(n-o,a));break}this.x=i/=s,this.y=a/=n;const[c,h]=this.getBaseTranslation();i+=c,a+=h,t.left=`${(100*i).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}static#C(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return bt.#C(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return bt.#C(e,t,360-this.parentRotation)}#_(e){switch(e){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this;return[t*e,s*e]}setDims(e,t){const[s,n]=this.parentDimensions,{style:i}=this.div;i.width=`${(100*e/s).toFixed(2)}%`,this.#c||(i.height=`${(100*t/n).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:s}=e,n=s.endsWith("%"),i=!this.#c&&t.endsWith("%");if(n&&i)return;const[a,o]=this.parentDimensions;n||(e.width=`${(100*parseFloat(s)/a).toFixed(2)}%`),!this.#c&&!i&&(e.height=`${(100*parseFloat(t)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#P(){if(this.#o)return;this.#o=document.createElement("div"),this.#o.classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const n=document.createElement("div");this.#o.append(n),n.classList.add("resizer",s),n.setAttribute("data-resizer-name",s),n.addEventListener("pointerdown",this.#k.bind(this,s),{signal:t}),n.addEventListener("contextmenu",_r,{signal:t}),n.tabIndex=-1}this.div.prepend(this.#o)}#k(e,t){t.preventDefault();const{isMac:s}=un.platform;if(t.button!==0||t.ctrlKey&&s)return;this.#s?.toggle(!1);const n=this._isDraggable;this._isDraggable=!1,this.#h=[t.screenX,t.screenY];const i=new AbortController,a=this._uiManager.combinedSignal(i);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#D.bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",br,{passive:!1,signal:a}),window.addEventListener("contextmenu",_r,{signal:a}),this.#l={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const o=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const c=()=>{i.abort(),this.parent.togglePointerEvents(!0),this.#s?.toggle(!0),this._isDraggable=n,this.parent.div.style.cursor=o,this.div.style.cursor=l,this.#R()};window.addEventListener("pointerup",c,{signal:a}),window.addEventListener("blur",c,{signal:a})}#L(e,t,s,n){this.width=s,this.height=n,this.x=e,this.y=t;const[i,a]=this.parentDimensions;this.setDims(i*s,a*n),this.fixAndSetPosition(),this._onResized()}_onResized(){}#R(){if(!this.#l)return;const{savedX:e,savedY:t,savedWidth:s,savedHeight:n}=this.#l;this.#l=null;const i=this.x,a=this.y,o=this.width,l=this.height;i===e&&a===t&&o===s&&l===n||this.addCommands({cmd:this.#L.bind(this,i,a,o,l),undo:this.#L.bind(this,e,t,s,n),mustExec:!0})}#D(e,t){const[s,n]=this.parentDimensions,i=this.x,a=this.y,o=this.width,l=this.height,c=bt.MIN_SIZE/s,h=bt.MIN_SIZE/n,d=te=>Math.round(te*1e4)/1e4,p=this.#_(this.rotation),f=(te,K)=>[p[0]*te+p[2]*K,p[1]*te+p[3]*K],y=this.#_(360-this.rotation),w=(te,K)=>[y[0]*te+y[2]*K,y[1]*te+y[3]*K];let A,x,S=!1,I=!1;switch(e){case"topLeft":S=!0,A=(te,K)=>[0,0],x=(te,K)=>[te,K];break;case"topMiddle":A=(te,K)=>[te/2,0],x=(te,K)=>[te/2,K];break;case"topRight":S=!0,A=(te,K)=>[te,0],x=(te,K)=>[0,K];break;case"middleRight":I=!0,A=(te,K)=>[te,K/2],x=(te,K)=>[0,K/2];break;case"bottomRight":S=!0,A=(te,K)=>[te,K],x=(te,K)=>[0,0];break;case"bottomMiddle":A=(te,K)=>[te/2,K],x=(te,K)=>[te/2,0];break;case"bottomLeft":S=!0,A=(te,K)=>[0,K],x=(te,K)=>[te,0];break;case"middleLeft":I=!0,A=(te,K)=>[0,K/2],x=(te,K)=>[te,K/2];break}const M=A(o,l),B=x(o,l);let Q=f(...B);const U=d(i+Q[0]),O=d(a+Q[1]);let G=1,ne=1,L,j;if(t.fromKeyboard)({deltaX:L,deltaY:j}=t);else{const{screenX:te,screenY:K}=t,[fe,me]=this.#h;[L,j]=this.screenToPageTranslation(te-fe,K-me),this.#h[0]=te,this.#h[1]=K}if([L,j]=w(L/s,j/n),S){const te=Math.hypot(o,l);G=ne=Math.max(Math.min(Math.hypot(B[0]-M[0]-L,B[1]-M[1]-j)/te,1/o,1/l),c/o,h/l)}else I?G=Math.max(c,Math.min(1,Math.abs(B[0]-M[0]-L)))/o:ne=Math.max(h,Math.min(1,Math.abs(B[1]-M[1]-j)))/l;const V=d(o*G),q=d(l*ne);Q=f(...x(V,q));const le=U-Q[0],ae=O-Q[1];this.#f||=[this.x,this.y,this.width,this.height],this.width=V,this.height=q,this.x=le,this.y=ae,this.setDims(s*V,n*q),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#s?.finish()}async addEditToolbar(){return this._editToolbar||this.#g?this._editToolbar:(this._editToolbar=new oc(this),this.div.append(this._editToolbar.render()),this.#s&&await this._editToolbar.addAltText(this.#s),this._editToolbar)}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#s?.destroy())}addContainer(e){const t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){this.#s||(qr.initialize(bt._l10n),this.#s=new qr(this),this.#e&&(this.#s.data=this.#e,this.#e=null),await this.addEditToolbar())}get altTextData(){return this.#s?.data}set altTextData(e){this.#s&&(this.#s.data=e)}get guessedAltText(){return this.#s?.guessedText}async setGuessedAltText(e){await this.#s?.setGuessedText(e)}serializeAltText(e){return this.#s?.serialize(e)}hasAltText(){return!!this.#s&&!this.#s.isEmpty()}hasAltTextData(){return this.#s?.hasData()??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=this.#n?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.#j();const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[s,n]=this.getInitialTranslation();return this.translate(s,n),Au(this,this.div,["pointerdown"]),this._uiManager._editorUndoBar?.hide(),this.div}pointerdown(e){const{isMac:t}=un.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#d=!0,this._isDraggable){this.#y(e);return}this.#A(e)}get isSelected(){return this._uiManager.isSelected(this)}#A(e){const{isMac:t}=un.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#y(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();const s=new AbortController,n=this._uiManager.combinedSignal(s),i={capture:!0,passive:!1,signal:n},a=l=>{s.abort(),this.#i=null,this.#d=!1,this._uiManager.endDragSession()||this.#A(l)};t&&(this.#v=e.clientX,this.#w=e.clientY,this.#i=e.pointerId,this.#r=e.pointerType,window.addEventListener("pointermove",l=>{const{clientX:c,clientY:h,pointerId:d}=l;if(d!==this.#i){br(l);return}const[p,f]=this.screenToPageTranslation(c-this.#v,h-this.#w);this.#v=c,this.#w=h,this._uiManager.dragSelectedEditors(p,f)},i),window.addEventListener("touchmove",br,i),window.addEventListener("pointerdown",l=>{l.isPrimary&&l.pointerType===this.#r&&a(l),br(l)},i)),this._onStartDragging();const o=l=>{if(!this.#i||this.#i===l.pointerId){a(l),this._onStopDragging();return}br(l)};window.addEventListener("pointerup",o,{signal:n}),window.addEventListener("blur",o,{signal:n})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#b&&clearTimeout(this.#b),this.#b=setTimeout(()=>{this.#b=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,s=this.rotation){const n=this.parentScale,[i,a]=this.pageDimensions,[o,l]=this.pageTranslation,c=e/n,h=t/n,d=this.x*i,p=this.y*a,f=this.width*i,y=this.height*a;switch(s){case 0:return[d+c+o,a-p-h-y+l,d+c+f+o,a-p-h+l];case 90:return[d+h+o,a-p+c+l,d+h+y+o,a-p+c+f+l];case 180:return[d-c-f+o,a-p+h+l,d-c+o,a-p+h+y+l];case 270:return[d-h-y+o,a-p-c-f+l,d-h+o,a-p-c+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,n,i,a]=e,o=i-s,l=a-n;switch(this.rotation){case 0:return[s,t-a,o,l];case 90:return[s,t-n,l,o];case 180:return[i,t-n,o,l];case 270:return[i,t-a,l,o];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#g=!0}disableEditMode(){this.#g=!1}isInEditMode(){return this.#g}shouldGetKeyboardEvents(){return this.#m}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:s,right:n}=this.getClientDimensions(),{innerHeight:i,innerWidth:a}=window;return t<a&&n>0&&e<i&&s>0}#j(){if(this.#u||!this.div)return;this.#u=new AbortController;const e=this._uiManager.combinedSignal(this.#u);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#j()}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){Ht("An editor must be serializable")}static async deserialize(e,t,s){const n=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s});n.rotation=e.rotation,n.#e=e.accessibilityData;const[i,a]=n.pageDimensions,[o,l,c,h]=n.getRectInCurrentCoords(e.rect,a);return n.x=o/i,n.y=l/a,n.width=c/i,n.height=h/a,n}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#u?.abort(),this.#u=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#b&&(clearTimeout(this.#b),this.#b=null),this.#I(),this.removeEditToolbar(),this.#x){for(const e of this.#x.values())clearTimeout(e);this.#x=null}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#P(),this.#o.classList.remove("hidden"),Au(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#l={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const t=this.#o.children;if(!this.#t){this.#t=Array.from(t);const a=this.#B.bind(this),o=this.#q.bind(this),l=this._uiManager._signal;for(const c of this.#t){const h=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",a,{signal:l}),c.addEventListener("blur",o,{signal:l}),c.addEventListener("focus",this.#U.bind(this,h),{signal:l}),c.setAttribute("data-l10n-id",bt._l10nResizer[h])}}const s=this.#t[0];let n=0;for(const a of t){if(a===s)break;n++}const i=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(i!==n){if(i<n)for(let o=0;o<n-i;o++)this.#o.append(this.#o.firstChild);else if(i>n)for(let o=0;o<i-n;o++)this.#o.firstChild.before(this.#o.lastChild);let a=0;for(const o of t){const c=this.#t[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",bt._l10nResizer[c])}}this.#M(0),this.#m=!0,this.#o.firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#B(e){bt._resizerKeyboardManager.exec(this,e)}#q(e){this.#m&&e.relatedTarget?.parentNode!==this.#o&&this.#I()}#U(e){this.#a=this.#m?e:""}#M(e){if(this.#t)for(const t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#m&&this.#D(this.#a,{deltaX:e,deltaY:t,fromKeyboard:!0})}#I(){this.#m=!1,this.#M(-1),this.#R()}_stopResizingWithKeyboard(){this.#I(),this.div.focus()}select(){if(this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#s?.toggleAltTextBadge(!1)}unselect(){this.#o?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#s?.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(e){this.#p=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){this.#c=!0;const s=e/t,{style:n}=this.div;n.aspectRatio=s,n.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#x||=new Map;const{action:s}=e;let n=this.#x.get(s);n&&clearTimeout(n),n=setTimeout(()=>{this._reportTelemetry(e),this.#x.delete(s),this.#x.size===0&&(this.#x=null)},bt._telemetryTimeout),this.#x.set(s,n);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#n=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#n=!0}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const s=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),s.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}}class $A extends bt{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Ig=3285377520,Gn=4294901760,Dr=65535;class $1{constructor(e){this.h1=e?e&4294967295:Ig,this.h2=e?e&4294967295:Ig}update(e){let t,s;if(typeof e=="string"){t=new Uint8Array(e.length*2),s=0;for(let w=0,A=e.length;w<A;w++){const x=e.charCodeAt(w);x<=255?t[s++]=x:(t[s++]=x>>>8,t[s++]=x&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),s=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const n=s>>2,i=s-n*4,a=new Uint32Array(t.buffer,0,n);let o=0,l=0,c=this.h1,h=this.h2;const d=3432918353,p=461845907,f=d&Dr,y=p&Dr;for(let w=0;w<n;w++)w&1?(o=a[w],o=o*d&Gn|o*f&Dr,o=o<<15|o>>>17,o=o*p&Gn|o*y&Dr,c^=o,c=c<<13|c>>>19,c=c*5+3864292196):(l=a[w],l=l*d&Gn|l*f&Dr,l=l<<15|l>>>17,l=l*p&Gn|l*y&Dr,h^=l,h=h<<13|h>>>19,h=h*5+3864292196);switch(o=0,i){case 3:o^=t[n*4+2]<<16;case 2:o^=t[n*4+1]<<8;case 1:o^=t[n*4],o=o*d&Gn|o*f&Dr,o=o<<15|o>>>17,o=o*p&Gn|o*y&Dr,n&1?c^=o:h^=o}this.h1=c,this.h2=h}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Gn|e*36045&Dr,t=t*4283543511&Gn|((t<<16|e>>>16)*2950163797&Gn)>>>16,e^=t>>>1,e=e*444984403&Gn|e*60499&Dr,t=t*3301882366&Gn|((t<<16|e>>>16)*3120437893&Gn)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const Gf=Object.freeze({map:null,hash:"",transfer:void 0});class Hp{#e=!1;#t=null;#s=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=this.#s.get(e);return s===void 0?t:Object.assign(t,s)}getRawValue(e){return this.#s.get(e)}remove(e){if(this.#s.delete(e),this.#s.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of this.#s.values())if(t instanceof bt)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=this.#s.get(e);let n=!1;if(s!==void 0)for(const[i,a]of Object.entries(t))s[i]!==a&&(n=!0,s[i]=a);else n=!0,this.#s.set(e,t);n&&this.#n(),t instanceof bt&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return this.#s.has(e)}getAll(){return this.#s.size>0?Fp(this.#s):null}setAll(e){for(const[t,s]of Object.entries(e))this.setValue(t,s)}get size(){return this.#s.size}#n(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new q1(this)}get serializable(){if(this.#s.size===0)return Gf;const e=new Map,t=new $1,s=[],n=Object.create(null);let i=!1;for(const[a,o]of this.#s){const l=o instanceof bt?o.serialize(!1,n):o;l&&(e.set(a,l),t.update(`${a}:${JSON.stringify(l)}`),i||=!!l.bitmap)}if(i)for(const a of e.values())a.bitmap&&s.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:Gf}get editorStats(){let e=null;const t=new Map;for(const s of this.#s.values()){if(!(s instanceof bt))continue;const n=s.telemetryFinalData;if(!n)continue;const{type:i}=n;t.has(i)||t.set(i,Object.getPrototypeOf(s).constructor),e||=Object.create(null);const a=e[i]||=new Map;for(const[o,l]of Object.entries(n)){if(o==="type")continue;let c=a.get(o);c||(c=new Map,a.set(o,c));const h=c.get(l)??0;c.set(l,h+1)}}for(const[s,n]of t)e[s]=n.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){this.#t=null}get modifiedIds(){if(this.#t)return this.#t;const e=[];for(const t of this.#s.values())!(t instanceof bt)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}}class q1 extends Hp{#e;constructor(e){super();const{map:t,hash:s,transfer:n}=e.serializable,i=structuredClone(t,n?{transfer:n}:null);this.#e={map:i,hash:s,transfer:n}}get print(){Ht("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return xt(this,"modifiedIds",{ids:new Set,hash:""})}}class qA{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||this.#e.has(e.loadedName))){if(Ss(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:n,style:i}=e,a=new FontFace(s,n,i);this.addNativeFontFace(a);try{await a.load(),this.#e.add(s),t?.(e)}catch{vt(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}Ht("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const s=e.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(n){throw vt(`Failed to load font '${s.family}': '${n}'.`),e.disableFontFace=!0,n}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const n=this._queueLoadingCallback(s);this._prepareFontLoadEvent(e,n)})}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return xt(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(hn||typeof navigator<"u"&&typeof navigator?.userAgent=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),xt(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(Ss(!n.done,"completeRequest() cannot be called twice."),n.done=!0;s.length>0&&s[0].done;){const i=s.shift();setTimeout(i.callback,0)}}const{loadingRequests:s}=this,n={done:!1,complete:t,callback:e};return s.push(n),n}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return xt(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function s(M,B){return M.charCodeAt(B)<<24|M.charCodeAt(B+1)<<16|M.charCodeAt(B+2)<<8|M.charCodeAt(B+3)&255}function n(M,B,Q,U){const O=M.substring(0,B),G=M.substring(B+Q);return O+U+G}let i,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let c=0;function h(M,B){if(++c>30){vt("Load test font never loaded."),B();return}if(l.font="30px "+M,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){B();return}setTimeout(h.bind(null,M,B))}const d=`lt${Date.now()}${this.loadTestFontId++}`;let p=this._loadTestFont;p=n(p,976,d.length,d);const y=16,w=1482184792;let A=s(p,y);for(i=0,a=d.length-3;i<a;i+=4)A=A-w+s(d,i)|0;i<d.length&&(A=A-w+s(d+"XXX",i)|0),p=n(p,y,4,EA(A));const x=`url(data:font/opentype;base64,${btoa(p)});`,S=`@font-face {font-family:"${d}";src:${x}}`;this.insertRule(S);const I=this._document.createElement("div");I.style.visibility="hidden",I.style.width=I.style.height="10px",I.style.position="absolute",I.style.top=I.style.left="0px";for(const M of[e.loadedName,d]){const B=this._document.createElement("span");B.textContent="Hi",B.style.fontFamily=M,I.append(B)}this._document.body.append(I),h(d,()=>{I.remove(),t.complete()})}}class UA{constructor(e,{disableFontFace:t=!1,inspectFont:s=null}){this.compiledGlyphs=Object.create(null);for(const n in e)this[n]=e[n];this.disableFontFace=t===!0,this._inspectFont=s}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${IA(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];let s;try{s=e.get(this.loadedName+"_path_"+t)}catch(i){vt(`getPathGenerator - ignoring character: "${i}".`)}if(!Array.isArray(s)||s.length===0)return this.compiledGlyphs[t]=function(i,a){};const n=[];for(let i=0,a=s.length;i<a;)switch(s[i++]){case ci.BEZIER_CURVE_TO:{const[o,l,c,h,d,p]=s.slice(i,i+6);n.push(f=>f.bezierCurveTo(o,l,c,h,d,p)),i+=6}break;case ci.MOVE_TO:{const[o,l]=s.slice(i,i+2);n.push(c=>c.moveTo(o,l)),i+=2}break;case ci.LINE_TO:{const[o,l]=s.slice(i,i+2);n.push(c=>c.lineTo(o,l)),i+=2}break;case ci.QUADRATIC_CURVE_TO:{const[o,l,c,h]=s.slice(i,i+4);n.push(d=>d.quadraticCurveTo(o,l,c,h)),i+=4}break;case ci.RESTORE:n.push(o=>o.restore());break;case ci.SAVE:n.push(o=>o.save());break;case ci.SCALE:Ss(n.length===2,"Scale command is only valid at the third position.");break;case ci.TRANSFORM:{const[o,l,c,h,d,p]=s.slice(i,i+6);n.push(f=>f.transform(o,l,c,h,d,p)),i+=6}break;case ci.TRANSLATE:{const[o,l]=s.slice(i,i+2);n.push(c=>c.translate(o,l)),i+=2}break}return n.push(i=>i.closePath()),this.compiledGlyphs[t]=function(a,o){n[0](a),n[1](a),a.scale(o,-o);for(let l=2,c=n.length;l<c;l++)n[l](a)}}}class U1{#e=!1;constructor({enableHWA:e=!1}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Ht("Abstract method `_createCanvas` called.")}}class zA extends U1{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}}class z1{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Ht("Abstract method `_fetch` called.")}}class H1 extends z1{async _fetch(e){const t=await Qu(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Zu(t)}}class W1{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,n,i){return"none"}destroy(e=!1){}}class HA extends W1{#e;#t;#s;#n;#i;#r;#c=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#n=e,this.#i=t}get#o(){return this.#t||=new Map}get#h(){return this.#r||=new Map}get#l(){if(!this.#s){const e=this.#i.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const s=this.#i.createElementNS(di,"svg");s.setAttribute("width",0),s.setAttribute("height",0),this.#s=this.#i.createElementNS(di,"defs"),e.append(s),s.append(this.#s),this.#i.body.append(e)}return this.#s}#u(e){if(e.length===1){const l=e[0],c=new Array(256);for(let d=0;d<256;d++)c[d]=l[d]/255;const h=c.join(",");return[h,h,h]}const[t,s,n]=e,i=new Array(256),a=new Array(256),o=new Array(256);for(let l=0;l<256;l++)i[l]=t[l]/255,a[l]=s[l]/255,o[l]=n[l]/255;return[i.join(","),a.join(","),o.join(",")]}#a(e){if(this.#e===void 0){this.#e="";const t=this.#i.URL;t!==this.#i.baseURI&&(ed(t)?vt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=t.split("#",1)[0])}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#o.get(e);if(t)return t;const[s,n,i]=this.#u(e),a=e.length===1?s:`${s}${n}${i}`;if(t=this.#o.get(a),t)return this.#o.set(e,t),t;const o=`g_${this.#n}_transfer_map_${this.#c++}`,l=this.#a(o);this.#o.set(e,l),this.#o.set(a,l);const c=this.#p(o);return this.#m(s,n,i,c),l}addHCMFilter(e,t){const s=`${e}-${t}`,n="base";let i=this.#h.get(n);if(i?.key===s||(i?(i.filter?.remove(),i.key=s,i.url="none",i.filter=null):(i={key:s,url:"none",filter:null},this.#h.set(n,i)),!e||!t))return i.url;const a=this.#v(e);e=He.makeHexColor(...a);const o=this.#v(t);if(t=He.makeHexColor(...o),this.#l.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return i.url;const l=new Array(256);for(let f=0;f<=255;f++){const y=f/255;l[f]=y<=.03928?y/12.92:((y+.055)/1.055)**2.4}const c=l.join(","),h=`g_${this.#n}_hcm_filter`,d=i.filter=this.#p(h);this.#m(c,c,c,d),this.#f(d);const p=(f,y)=>{const w=a[f]/255,A=o[f]/255,x=new Array(y+1);for(let S=0;S<=y;S++)x[S]=w+S/y*(A-w);return x.join(",")};return this.#m(p(0,5),p(1,5),p(2,5),d),i.url=this.#a(h),i.url}addAlphaFilter(e){let t=this.#o.get(e);if(t)return t;const[s]=this.#u([e]),n=`alpha_${s}`;if(t=this.#o.get(n),t)return this.#o.set(e,t),t;const i=`g_${this.#n}_alpha_map_${this.#c++}`,a=this.#a(i);this.#o.set(e,a),this.#o.set(n,a);const o=this.#p(i);return this.#b(s,o),a}addLuminosityFilter(e){let t=this.#o.get(e||"luminosity");if(t)return t;let s,n;if(e?([s]=this.#u([e]),n=`luminosity_${s}`):n="luminosity",t=this.#o.get(n),t)return this.#o.set(e,t),t;const i=`g_${this.#n}_luminosity_map_${this.#c++}`,a=this.#a(i);this.#o.set(e,a),this.#o.set(n,a);const o=this.#p(i);return this.#d(o),e&&this.#b(s,o),a}addHighlightHCMFilter(e,t,s,n,i){const a=`${t}-${s}-${n}-${i}`;let o=this.#h.get(e);if(o?.key===a||(o?(o.filter?.remove(),o.key=a,o.url="none",o.filter=null):(o={key:a,url:"none",filter:null},this.#h.set(e,o)),!t||!s))return o.url;const[l,c]=[t,s].map(this.#v.bind(this));let h=Math.round(.2126*l[0]+.7152*l[1]+.0722*l[2]),d=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),[p,f]=[n,i].map(this.#v.bind(this));d<h&&([h,d,p,f]=[d,h,f,p]),this.#l.style.color="";const y=(x,S,I)=>{const M=new Array(256),B=(d-h)/I,Q=x/255,U=(S-x)/(255*I);let O=0;for(let G=0;G<=I;G++){const ne=Math.round(h+G*B),L=Q+G*U;for(let j=O;j<=ne;j++)M[j]=L;O=ne+1}for(let G=O;G<256;G++)M[G]=M[O-1];return M.join(",")},w=`g_${this.#n}_hcm_${e}_filter`,A=o.filter=this.#p(w);return this.#f(A),this.#m(y(p[0],f[0],5),y(p[1],f[1],5),y(p[2],f[2],5),A),o.url=this.#a(w),o.url}destroy(e=!1){e&&this.#r?.size||(this.#s?.parentNode.parentNode.remove(),this.#s=null,this.#t?.clear(),this.#t=null,this.#r?.clear(),this.#r=null,this.#c=0)}#d(e){const t=this.#i.createElementNS(di,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#f(e){const t=this.#i.createElementNS(di,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#p(e){const t=this.#i.createElementNS(di,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#l.append(t),t}#g(e,t,s){const n=this.#i.createElementNS(di,t);n.setAttribute("type","discrete"),n.setAttribute("tableValues",s),e.append(n)}#m(e,t,s,n){const i=this.#i.createElementNS(di,"feComponentTransfer");n.append(i),this.#g(i,"feFuncR",e),this.#g(i,"feFuncG",t),this.#g(i,"feFuncB",s)}#b(e,t){const s=this.#i.createElementNS(di,"feComponentTransfer");t.append(s),this.#g(s,"feFuncA",e)}#v(e){return this.#l.style.color=e,qp(getComputedStyle(this.#l).getPropertyValue("color"))}}class V1{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Ht("Abstract method `_fetch` called.")}}class G1 extends V1{async _fetch(e){const t=await Qu(e,"arraybuffer");return new Uint8Array(t)}}async function X1(r){const t=await process.getBuiltinModule("fs").promises.readFile(r);return new Uint8Array(t)}class WA extends W1{}class VA extends U1{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class GA extends z1{async _fetch(e){return X1(e)}}class XA extends V1{async _fetch(e){return X1(e)}}const tn={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Xf(r,e){if(!e)return;const t=e[2]-e[0],s=e[3]-e[1],n=new Path2D;n.rect(e[0],e[1],t,s),r.clip(n)}class Wp{getPattern(){Ht("Abstract method `getPattern` called.")}}class YA extends Wp{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)t.addColorStop(s[0],s[1]);return t}getPattern(e,t,s,n){let i;if(n===tn.STROKE||n===tn.FILL){const a=t.current.getClippedPathBoundingBox(n,ts(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,c=t.cachedCanvases.getCanvas("pattern",o,l),h=c.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-a[0],-a[1]),s=He.transform(s,[1,0,0,1,a[0],a[1]]),h.transform(...t.baseTransform),this.matrix&&h.transform(...this.matrix),Xf(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),i=e.createPattern(c.canvas,"no-repeat");const d=new DOMMatrix(s);i.setTransform(d)}else Xf(e,this._bbox),i=this._createGradient(e);return i}}function df(r,e,t,s,n,i,a,o){const l=e.coords,c=e.colors,h=r.data,d=r.width*4;let p;l[t+1]>l[s+1]&&(p=t,t=s,s=p,p=i,i=a,a=p),l[s+1]>l[n+1]&&(p=s,s=n,n=p,p=a,a=o,o=p),l[t+1]>l[s+1]&&(p=t,t=s,s=p,p=i,i=a,a=p);const f=(l[t]+e.offsetX)*e.scaleX,y=(l[t+1]+e.offsetY)*e.scaleY,w=(l[s]+e.offsetX)*e.scaleX,A=(l[s+1]+e.offsetY)*e.scaleY,x=(l[n]+e.offsetX)*e.scaleX,S=(l[n+1]+e.offsetY)*e.scaleY;if(y>=S)return;const I=c[i],M=c[i+1],B=c[i+2],Q=c[a],U=c[a+1],O=c[a+2],G=c[o],ne=c[o+1],L=c[o+2],j=Math.round(y),V=Math.round(S);let q,le,ae,te,K,fe,me,Ae;for(let k=j;k<=V;k++){if(k<A){const ie=k<y?0:(y-k)/(y-A);q=f-(f-w)*ie,le=I-(I-Q)*ie,ae=M-(M-U)*ie,te=B-(B-O)*ie}else{let ie;k>S?ie=1:A===S?ie=0:ie=(A-k)/(A-S),q=w-(w-x)*ie,le=Q-(Q-G)*ie,ae=U-(U-ne)*ie,te=O-(O-L)*ie}let D;k<y?D=0:k>S?D=1:D=(y-k)/(y-S),K=f-(f-x)*D,fe=I-(I-G)*D,me=M-(M-ne)*D,Ae=B-(B-L)*D;const z=Math.round(Math.min(q,K)),X=Math.round(Math.max(q,K));let ee=d*k+z*4;for(let ie=z;ie<=X;ie++)D=(q-ie)/(q-K),D<0?D=0:D>1&&(D=1),h[ee++]=le-(le-fe)*D|0,h[ee++]=ae-(ae-me)*D|0,h[ee++]=te-(te-Ae)*D|0,h[ee++]=255}}function KA(r,e,t){const s=e.coords,n=e.colors;let i,a;switch(e.type){case"lattice":const o=e.verticesPerRow,l=Math.floor(s.length/o)-1,c=o-1;for(i=0;i<l;i++){let h=i*o;for(let d=0;d<c;d++,h++)df(r,t,s[h],s[h+1],s[h+o],n[h],n[h+1],n[h+o]),df(r,t,s[h+o+1],s[h+1],s[h+o],n[h+o+1],n[h+1],n[h+o])}break;case"triangles":for(i=0,a=s.length;i<a;i+=3)df(r,t,s[i],s[i+1],s[i+2],n[i],n[i+1],n[i+2]);break;default:throw new Error("illegal figure")}}class JA extends Wp{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,s){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-o,h=Math.ceil(this._bounds[3])-l,d=Math.min(Math.ceil(Math.abs(c*e[0]*1.1)),3e3),p=Math.min(Math.ceil(Math.abs(h*e[1]*1.1)),3e3),f=c/d,y=h/p,w={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/f,scaleY:1/y},A=d+2*2,x=p+2*2,S=s.getCanvas("mesh",A,x),I=S.context,M=I.createImageData(d,p);if(t){const Q=M.data;for(let U=0,O=Q.length;U<O;U+=4)Q[U]=t[0],Q[U+1]=t[1],Q[U+2]=t[2],Q[U+3]=255}for(const Q of this._figures)KA(M,Q,w);return I.putImageData(M,2,2),{canvas:S.canvas,offsetX:o-2*f,offsetY:l-2*y,scaleX:f,scaleY:y}}getPattern(e,t,s,n){Xf(e,this._bbox);let i;if(n===tn.SHADING)i=He.singularValueDecompose2dScale(ts(e));else if(i=He.singularValueDecompose2dScale(t.baseTransform),this.matrix){const o=He.singularValueDecompose2dScale(this.matrix);i=[i[0]*o[0],i[1]*o[1]]}const a=this._createMeshCanvas(i,n===tn.SHADING?null:this._background,t.cachedCanvases);return n!==tn.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class ZA extends Wp{getPattern(){return"hotpink"}}function QA(r){switch(r[0]){case"RadialAxial":return new YA(r);case"Mesh":return new JA(r);case"Dummy":return new ZA}throw new Error(`Unknown IR type: ${r[0]}`)}const jg={COLORED:1,UNCOLORED:2};class Vp{static MAX_PATTERN_SIZE=3e3;constructor(e,t,s,n,i){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=s,this.canvasGraphicsFactory=n,this.baseTransform=i}createPatternCanvas(e){const{bbox:t,operatorList:s,paintType:n,tilingType:i,color:a,canvasGraphicsFactory:o}=this;let{xstep:l,ystep:c}=this;l=Math.abs(l),c=Math.abs(c),Ku("TilingType: "+i);const h=t[0],d=t[1],p=t[2],f=t[3],y=p-h,w=f-d,A=He.singularValueDecompose2dScale(this.matrix),x=He.singularValueDecompose2dScale(this.baseTransform),S=A[0]*x[0],I=A[1]*x[1];let M=y,B=w,Q=!1,U=!1;const O=Math.ceil(l*S),G=Math.ceil(c*I),ne=Math.ceil(y*S),L=Math.ceil(w*I);O>=ne?M=l:Q=!0,G>=L?B=c:U=!0;const j=this.getSizeAndScale(M,this.ctx.canvas.width,S),V=this.getSizeAndScale(B,this.ctx.canvas.height,I),q=e.cachedCanvases.getCanvas("pattern",j.size,V.size),le=q.context,ae=o.createCanvasGraphics(le);if(ae.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(ae,n,a),le.translate(-j.scale*h,-V.scale*d),ae.transform(j.scale,0,0,V.scale,0,0),le.save(),this.clipBbox(ae,h,d,p,f),ae.baseTransform=ts(ae.ctx),ae.executeOperatorList(s),ae.endDrawing(),le.restore(),Q||U){const te=q.canvas;Q&&(M=l),U&&(B=c);const K=this.getSizeAndScale(M,this.ctx.canvas.width,S),fe=this.getSizeAndScale(B,this.ctx.canvas.height,I),me=K.size,Ae=fe.size,k=e.cachedCanvases.getCanvas("pattern-workaround",me,Ae),D=k.context,z=Q?Math.floor(y/l):0,X=U?Math.floor(w/c):0;for(let ee=0;ee<=z;ee++)for(let ie=0;ie<=X;ie++)D.drawImage(te,me*ee,Ae*ie,me,Ae,0,0,me,Ae);return{canvas:k.canvas,scaleX:K.scale,scaleY:fe.scale,offsetX:h,offsetY:d}}return{canvas:q.canvas,scaleX:j.scale,scaleY:V.scale,offsetX:h,offsetY:d}}getSizeAndScale(e,t,s){const n=Math.max(Vp.MAX_PATTERN_SIZE,t);let i=Math.ceil(e*s);return i>=n?i=n:s=i/e,{scale:s,size:i}}clipBbox(e,t,s,n,i){const a=n-t,o=i-s;e.ctx.rect(t,s,a,o),e.current.updateRectMinMax(ts(e.ctx),[t,s,n,i]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const n=e.ctx,i=e.current;switch(t){case jg.COLORED:const a=this.ctx;n.fillStyle=a.fillStyle,n.strokeStyle=a.strokeStyle,i.fillColor=a.fillStyle,i.strokeColor=a.strokeStyle;break;case jg.UNCOLORED:const o=He.makeHexColor(s[0],s[1],s[2]);n.fillStyle=o,n.strokeStyle=o,i.fillColor=o,i.strokeColor=o;break;default:throw new NA(`Unsupported paint type: ${t}`)}}getPattern(e,t,s,n){let i=s;n!==tn.SHADING&&(i=He.transform(i,t.baseTransform),this.matrix&&(i=He.transform(i,this.matrix)));const a=this.createPatternCanvas(t);let o=new DOMMatrix(i);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const l=e.createPattern(a.canvas,"repeat");return l.setTransform(o),l}}function eS({src:r,srcPos:e=0,dest:t,width:s,height:n,nonBlackColor:i=4294967295,inverseDecode:a=!1}){const o=un.isLittleEndian?4278190080:255,[l,c]=a?[i,o]:[o,i],h=s>>3,d=s&7,p=r.length;t=new Uint32Array(t.buffer);let f=0;for(let y=0;y<n;y++){for(const A=e+h;e<A;e++){const x=e<p?r[e]:255;t[f++]=x&128?c:l,t[f++]=x&64?c:l,t[f++]=x&32?c:l,t[f++]=x&16?c:l,t[f++]=x&8?c:l,t[f++]=x&4?c:l,t[f++]=x&2?c:l,t[f++]=x&1?c:l}if(d===0)continue;const w=e<p?r[e++]:255;for(let A=0;A<d;A++)t[f++]=w&1<<7-A?c:l}return{srcPos:e,destPos:f}}const Rg=16,Og=100,tS=15,Mg=10,Fg=1e3,_n=16;function sS(r,e){if(r._removeMirroring)throw new Error("Context is already forwarding operations.");r.__originalSave=r.save,r.__originalRestore=r.restore,r.__originalRotate=r.rotate,r.__originalScale=r.scale,r.__originalTranslate=r.translate,r.__originalTransform=r.transform,r.__originalSetTransform=r.setTransform,r.__originalResetTransform=r.resetTransform,r.__originalClip=r.clip,r.__originalMoveTo=r.moveTo,r.__originalLineTo=r.lineTo,r.__originalBezierCurveTo=r.bezierCurveTo,r.__originalRect=r.rect,r.__originalClosePath=r.closePath,r.__originalBeginPath=r.beginPath,r._removeMirroring=()=>{r.save=r.__originalSave,r.restore=r.__originalRestore,r.rotate=r.__originalRotate,r.scale=r.__originalScale,r.translate=r.__originalTranslate,r.transform=r.__originalTransform,r.setTransform=r.__originalSetTransform,r.resetTransform=r.__originalResetTransform,r.clip=r.__originalClip,r.moveTo=r.__originalMoveTo,r.lineTo=r.__originalLineTo,r.bezierCurveTo=r.__originalBezierCurveTo,r.rect=r.__originalRect,r.closePath=r.__originalClosePath,r.beginPath=r.__originalBeginPath,delete r._removeMirroring},r.save=function(){e.save(),this.__originalSave()},r.restore=function(){e.restore(),this.__originalRestore()},r.translate=function(s,n){e.translate(s,n),this.__originalTranslate(s,n)},r.scale=function(s,n){e.scale(s,n),this.__originalScale(s,n)},r.transform=function(s,n,i,a,o,l){e.transform(s,n,i,a,o,l),this.__originalTransform(s,n,i,a,o,l)},r.setTransform=function(s,n,i,a,o,l){e.setTransform(s,n,i,a,o,l),this.__originalSetTransform(s,n,i,a,o,l)},r.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},r.rotate=function(s){e.rotate(s),this.__originalRotate(s)},r.clip=function(s){e.clip(s),this.__originalClip(s)},r.moveTo=function(t,s){e.moveTo(t,s),this.__originalMoveTo(t,s)},r.lineTo=function(t,s){e.lineTo(t,s),this.__originalLineTo(t,s)},r.bezierCurveTo=function(t,s,n,i,a,o){e.bezierCurveTo(t,s,n,i,a,o),this.__originalBezierCurveTo(t,s,n,i,a,o)},r.rect=function(t,s,n,i){e.rect(t,s,n,i),this.__originalRect(t,s,n,i)},r.closePath=function(){e.closePath(),this.__originalClosePath()},r.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class nS{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let n;return this.cache[e]!==void 0?(n=this.cache[e],this.canvasFactory.reset(n,t,s)):(n=this.canvasFactory.create(t,s),this.cache[e]=n),n}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Hh(r,e,t,s,n,i,a,o,l,c){const[h,d,p,f,y,w]=ts(r);if(d===0&&p===0){const S=a*h+y,I=Math.round(S),M=o*f+w,B=Math.round(M),Q=(a+l)*h+y,U=Math.abs(Math.round(Q)-I)||1,O=(o+c)*f+w,G=Math.abs(Math.round(O)-B)||1;return r.setTransform(Math.sign(h),0,0,Math.sign(f),I,B),r.drawImage(e,t,s,n,i,0,0,U,G),r.setTransform(h,d,p,f,y,w),[U,G]}if(h===0&&f===0){const S=o*p+y,I=Math.round(S),M=a*d+w,B=Math.round(M),Q=(o+c)*p+y,U=Math.abs(Math.round(Q)-I)||1,O=(a+l)*d+w,G=Math.abs(Math.round(O)-B)||1;return r.setTransform(0,Math.sign(d),Math.sign(p),0,I,B),r.drawImage(e,t,s,n,i,0,0,G,U),r.setTransform(h,d,p,f,y,w),[G,U]}r.drawImage(e,t,s,n,i,a,o,l,c);const A=Math.hypot(h,d),x=Math.hypot(p,f);return[A*l,x*c]}function rS(r){const{width:e,height:t}=r;if(e>Fg||t>Fg)return null;const s=1e3,n=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),i=e+1;let a=new Uint8Array(i*(t+1)),o,l,c;const h=e+7&-8;let d=new Uint8Array(h*t),p=0;for(const x of r.data){let S=128;for(;S>0;)d[p++]=x&S?0:255,S>>=1}let f=0;for(p=0,d[p]!==0&&(a[0]=1,++f),l=1;l<e;l++)d[p]!==d[p+1]&&(a[l]=d[p]?2:1,++f),p++;for(d[p]!==0&&(a[l]=2,++f),o=1;o<t;o++){p=o*h,c=o*i,d[p-h]!==d[p]&&(a[c]=d[p]?1:8,++f);let x=(d[p]?4:0)+(d[p-h]?8:0);for(l=1;l<e;l++)x=(x>>2)+(d[p+1]?4:0)+(d[p-h+1]?8:0),n[x]&&(a[c+l]=n[x],++f),p++;if(d[p-h]!==d[p]&&(a[c+l]=d[p]?2:4,++f),f>s)return null}for(p=h*(t-1),c=o*i,d[p]!==0&&(a[c]=8,++f),l=1;l<e;l++)d[p]!==d[p+1]&&(a[c+l]=d[p]?4:8,++f),p++;if(d[p]!==0&&(a[c+l]=4,++f),f>s)return null;const y=new Int32Array([0,i,-1,0,-i,0,0,0,1]),w=new Path2D;for(o=0;f&&o<=t;o++){let x=o*i;const S=x+e;for(;x<S&&!a[x];)x++;if(x===S)continue;w.moveTo(x%i,o);const I=x;let M=a[x];do{const B=y[M];do x+=B;while(!a[x]);const Q=a[x];Q!==5&&Q!==10?(M=Q,a[x]=0):(M=Q&51*M>>4,a[x]&=M>>2|M<<2),w.lineTo(x%i,x/i|0),a[x]||--f}while(I!==x);--o}return d=null,a=null,function(x){x.save(),x.scale(1/e,-1/t),x.translate(0,-t),x.fill(w),x.beginPath(),x.restore()}}class Dg{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=M1,this.textMatrixScale=1,this.fontMatrix=zf,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=Qs.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,s){[t,s]=He.applyTransform([t,s],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,s),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,s)}updateRectMinMax(e,t){const s=He.applyTransform(t,e),n=He.applyTransform(t.slice(2),e),i=He.applyTransform([t[0],t[3]],e),a=He.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,s[0],n[0],i[0],a[0]),this.minY=Math.min(this.minY,s[1],n[1],i[1],a[1]),this.maxX=Math.max(this.maxX,s[0],n[0],i[0],a[0]),this.maxY=Math.max(this.maxY,s[1],n[1],i[1],a[1])}updateScalingPathMinMax(e,t){He.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,s,n,i,a,o,l,c,h){const d=He.bezierBoundingBox(t,s,n,i,a,o,l,c,h);h||this.updateRectMinMax(e,d)}getPathBoundingBox(e=tn.FILL,t=null){const s=[this.minX,this.minY,this.maxX,this.maxY];if(e===tn.STROKE){t||Ht("Stroke bounding box must include transform.");const n=He.singularValueDecompose2dScale(t),i=n[0]*this.lineWidth/2,a=n[1]*this.lineWidth/2;s[0]-=i,s[1]-=a,s[2]+=i,s[3]+=a}return s}updateClipFromPath(){const e=He.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=tn.FILL,t=null){return He.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function Bg(r,e){if(e instanceof ImageData){r.putImageData(e,0,0);return}const t=e.height,s=e.width,n=t%_n,i=(t-n)/_n,a=n===0?i:i+1,o=r.createImageData(s,_n);let l=0,c;const h=e.data,d=o.data;let p,f,y,w;if(e.kind===ou.GRAYSCALE_1BPP){const A=h.byteLength,x=new Uint32Array(d.buffer,0,d.byteLength>>2),S=x.length,I=s+7>>3,M=4294967295,B=un.isLittleEndian?4278190080:255;for(p=0;p<a;p++){for(y=p<i?_n:n,c=0,f=0;f<y;f++){const Q=A-l;let U=0;const O=Q>I?s:Q*8-7,G=O&-8;let ne=0,L=0;for(;U<G;U+=8)L=h[l++],x[c++]=L&128?M:B,x[c++]=L&64?M:B,x[c++]=L&32?M:B,x[c++]=L&16?M:B,x[c++]=L&8?M:B,x[c++]=L&4?M:B,x[c++]=L&2?M:B,x[c++]=L&1?M:B;for(;U<O;U++)ne===0&&(L=h[l++],ne=128),x[c++]=L&ne?M:B,ne>>=1}for(;c<S;)x[c++]=0;r.putImageData(o,0,p*_n)}}else if(e.kind===ou.RGBA_32BPP){for(f=0,w=s*_n*4,p=0;p<i;p++)d.set(h.subarray(l,l+w)),l+=w,r.putImageData(o,0,f),f+=_n;p<a&&(w=s*n*4,d.set(h.subarray(l,l+w)),r.putImageData(o,0,f))}else if(e.kind===ou.RGB_24BPP)for(y=_n,w=s*y,p=0;p<a;p++){for(p>=i&&(y=n,w=s*y),c=0,f=w;f--;)d[c++]=h[l++],d[c++]=h[l++],d[c++]=h[l++],d[c++]=255;r.putImageData(o,0,p*_n)}else throw new Error(`bad image kind: ${e.kind}`)}function $g(r,e){if(e.bitmap){r.drawImage(e.bitmap,0,0);return}const t=e.height,s=e.width,n=t%_n,i=(t-n)/_n,a=n===0?i:i+1,o=r.createImageData(s,_n);let l=0;const c=e.data,h=o.data;for(let d=0;d<a;d++){const p=d<i?_n:n;({srcPos:l}=eS({src:c,srcPos:l,dest:h,width:s,height:p,nonBlackColor:0})),r.putImageData(o,0,d*_n)}}function $l(r,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of t)r[s]!==void 0&&(e[s]=r[s]);r.setLineDash!==void 0&&(e.setLineDash(r.getLineDash()),e.lineDashOffset=r.lineDashOffset)}function Wh(r){if(r.strokeStyle=r.fillStyle="#000000",r.fillRule="nonzero",r.globalAlpha=1,r.lineWidth=1,r.lineCap="butt",r.lineJoin="miter",r.miterLimit=10,r.globalCompositeOperation="source-over",r.font="10px sans-serif",r.setLineDash!==void 0&&(r.setLineDash([]),r.lineDashOffset=0),!hn){const{filter:e}=r;e!=="none"&&e!==""&&(r.filter="none")}}function qg(r,e){if(e)return!0;const t=He.singularValueDecompose2dScale(r);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const s=Math.fround((globalThis.devicePixelRatio||1)*Vo.PDF_TO_CSS_UNITS);return t[0]<=s&&t[1]<=s}const iS=["butt","round","square"],aS=["miter","round","bevel"],oS={},Ug={};class Mo{constructor(e,t,s,n,i,{optionalContentConfig:a,markedContentStack:o=null},l,c){this.ctx=e,this.current=new Dg(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=n,this.filterFactory=i,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new nS(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:s=!1,background:n=null}){const i=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=n||"#ffffff",this.ctx.fillRect(0,0,i,a),this.ctx.fillStyle=o,s){const l=this.cachedCanvases.getCanvas("transparent",i,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...ts(this.compositeCtx))}this.ctx.save(),Wh(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=ts(this.ctx)}executeOperatorList(e,t,s,n){const i=e.argsArray,a=e.fnArray;let o=t||0;const l=i.length;if(l===o)return o;const c=l-o>Mg&&typeof s=="function",h=c?Date.now()+tS:0;let d=0;const p=this.commonObjs,f=this.objs;let y;for(;;){if(n!==void 0&&o===n.nextBreakPoint)return n.breakIt(o,s),o;if(y=a[o],y!==fr.dependency)this[y].apply(this,i[o]);else for(const w of i[o]){const A=w.startsWith("g_")?p:f;if(!A.has(w))return A.get(w,s),o}if(o++,o===l)return o;if(c&&++d>Mg){if(Date.now()>h)return s(),o;d=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const s=e.width??e.displayWidth,n=e.height??e.displayHeight;let i=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=s,l=n,c="prescale1",h,d;for(;i>2&&o>1||a>2&&l>1;){let p=o,f=l;i>2&&o>1&&(p=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),i/=o/p),a>2&&l>1&&(f=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/f),h=this.cachedCanvases.getCanvas(c,p,f),d=h.context,d.clearRect(0,0,p,f),d.drawImage(e,0,0,o,l,0,0,p,f),e=h.canvas,o=p,l=f,c=c==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:l}}_createMaskCanvas(e){const t=this.ctx,{width:s,height:n}=e,i=this.current.fillColor,a=this.current.patternFill,o=ts(t);let l,c,h,d;if((e.bitmap||e.data)&&e.count>1){const O=e.bitmap||e.data.buffer;c=JSON.stringify(a?o:[o.slice(0,4),i]),l=this._cachedBitmapsMap.get(O),l||(l=new Map,this._cachedBitmapsMap.set(O,l));const G=l.get(c);if(G&&!a){const ne=Math.round(Math.min(o[0],o[2])+o[4]),L=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:G,offsetX:ne,offsetY:L}}h=G}h||(d=this.cachedCanvases.getCanvas("maskCanvas",s,n),$g(d.context,e));let p=He.transform(o,[1/s,0,0,-1/n,0,0]);p=He.transform(p,[1,0,0,1,0,-n]);const[f,y,w,A]=He.getAxialAlignedBoundingBox([0,0,s,n],p),x=Math.round(w-f)||1,S=Math.round(A-y)||1,I=this.cachedCanvases.getCanvas("fillCanvas",x,S),M=I.context,B=f,Q=y;M.translate(-B,-Q),M.transform(...p),h||(h=this._scaleImage(d.canvas,Fr(M)),h=h.img,l&&a&&l.set(c,h)),M.imageSmoothingEnabled=qg(ts(M),e.interpolate),Hh(M,h,0,0,h.width,h.height,0,0,s,n),M.globalCompositeOperation="source-in";const U=He.transform(Fr(M),[1,0,0,1,-B,-Q]);return M.fillStyle=a?i.getPattern(t,this,U,tn.FILL):i,M.fillRect(0,0,s,n),l&&!a&&(this.cachedCanvases.delete("fillCanvas"),l.set(c,I.canvas)),{canvas:I.canvas,offsetX:Math.round(B),offsetY:Math.round(Q)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=iS[e]}setLineJoin(e){this.ctx.lineJoin=aS[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(e),s.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,s]of e)switch(t){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.current.fillAlpha=s,this.ctx.globalAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,n=this.cachedCanvases.getCanvas(s,e,t);this.suspendedCtx=this.ctx,this.ctx=n.context;const i=this.ctx;i.setTransform(...ts(this.suspendedCtx)),$l(this.suspendedCtx,i),sS(i,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),$l(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,n){const i=n[0],a=n[1],o=n[2]-i,l=n[3]-a;o===0||l===0||(this.genericComposeSMask(t.context,s,o,l,t.subtype,t.backdrop,t.transferMap,i,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,n,i,a,o,l,c,h,d){let p=e.canvas,f=l-h,y=c-d;if(a){const A=He.makeHexColor(...a);if(f<0||y<0||f+s>p.width||y+n>p.height){const x=this.cachedCanvases.getCanvas("maskExtension",s,n),S=x.context;S.drawImage(p,-f,-y),S.globalCompositeOperation="destination-atop",S.fillStyle=A,S.fillRect(0,0,s,n),S.globalCompositeOperation="source-over",p=x.canvas,f=y=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const x=new Path2D;x.rect(f,y,s,n),e.clip(x),e.globalCompositeOperation="destination-atop",e.fillStyle=A,e.fillRect(f,y,s,n),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),i==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):i==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const w=new Path2D;w.rect(l,c,s,n),t.clip(w),t.globalCompositeOperation="destination-in",t.drawImage(p,f,y,s,n,l,c,s,n),t.restore()}save(){this.inSMaskMode?($l(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),$l(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,s,n,i,a){this.ctx.transform(e,t,s,n,i,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s){const n=this.ctx,i=this.current;let a=i.x,o=i.y,l,c;const h=ts(n),d=h[0]===0&&h[3]===0||h[1]===0&&h[2]===0,p=d?s.slice(0):null;for(let f=0,y=0,w=e.length;f<w;f++)switch(e[f]|0){case fr.rectangle:a=t[y++],o=t[y++];const A=t[y++],x=t[y++],S=a+A,I=o+x;n.moveTo(a,o),A===0||x===0?n.lineTo(S,I):(n.lineTo(S,o),n.lineTo(S,I),n.lineTo(a,I)),d||i.updateRectMinMax(h,[a,o,S,I]),n.closePath();break;case fr.moveTo:a=t[y++],o=t[y++],n.moveTo(a,o),d||i.updatePathMinMax(h,a,o);break;case fr.lineTo:a=t[y++],o=t[y++],n.lineTo(a,o),d||i.updatePathMinMax(h,a,o);break;case fr.curveTo:l=a,c=o,a=t[y+4],o=t[y+5],n.bezierCurveTo(t[y],t[y+1],t[y+2],t[y+3],a,o),i.updateCurvePathMinMax(h,l,c,t[y],t[y+1],t[y+2],t[y+3],a,o,p),y+=6;break;case fr.curveTo2:l=a,c=o,n.bezierCurveTo(a,o,t[y],t[y+1],t[y+2],t[y+3]),i.updateCurvePathMinMax(h,l,c,a,o,t[y],t[y+1],t[y+2],t[y+3],p),a=t[y+2],o=t[y+3],y+=4;break;case fr.curveTo3:l=a,c=o,a=t[y+2],o=t[y+3],n.bezierCurveTo(t[y],t[y+1],a,o,a,o),i.updateCurvePathMinMax(h,l,c,t[y],t[y+1],a,o,a,o,p),y+=4;break;case fr.closePath:n.closePath();break}d&&i.updateScalingPathMinMax(h,p),i.setCurrentPoint(a,o)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,s=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof s=="object"&&s?.getPattern?(t.save(),t.strokeStyle=s.getPattern(t,this,Fr(t),tn.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,s=this.current.fillColor,n=this.current.patternFill;let i=!1;n&&(t.save(),t.fillStyle=s.getPattern(t,this,Fr(t),tn.FILL),i=!0);const a=this.current.getClippedPathBoundingBox();this.contentVisible&&a!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),i&&t.restore(),e&&this.consumePath(a)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=oS}eoClip(){this.pendingClip=Ug}beginText(){this.current.textMatrix=M1,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}t.save(),t.beginPath();for(const s of e)t.setTransform(...s.transform),t.translate(s.x,s.y),s.addToPath(t,s.fontSize);t.restore(),t.clip(),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){const s=this.commonObjs.get(e),n=this.current;if(!s)throw new Error(`Can't find font for ${e}`);if(n.fontMatrix=s.fontMatrix||zf,(n.fontMatrix[0]===0||n.fontMatrix[3]===0)&&vt("Invalid font matrix for font "+e),t<0?(t=-t,n.fontDirection=-1):n.fontDirection=1,this.current.font=s,this.current.fontSize=t,s.isType3Font)return;const i=s.loadedName||"sans-serif",a=s.systemFontInfo?.css||`"${i}", ${s.fallbackName}`;let o="normal";s.black?o="900":s.bold&&(o="bold");const l=s.italic?"italic":"normal";let c=t;t<Rg?c=Rg:t>Og&&(c=Og),this.current.fontSizeScale=t/c,this.ctx.font=`${l} ${o} ${c}px ${a}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,s,n,i,a){this.current.textMatrix=[e,t,s,n,i,a],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,s,n,i){const a=this.ctx,o=this.current,l=o.font,c=o.textRenderingMode,h=o.fontSize/o.fontSizeScale,d=c&Qs.FILL_STROKE_MASK,p=!!(c&Qs.ADD_TO_PATH_FLAG),f=o.patternFill&&!l.missingFile,y=o.patternStroke&&!l.missingFile;let w;(l.disableFontFace||p||f||y)&&(w=l.getPathGenerator(this.commonObjs,e)),l.disableFontFace||f||y?(a.save(),a.translate(t,s),a.beginPath(),w(a,h),(d===Qs.FILL||d===Qs.FILL_STROKE)&&(n&&a.setTransform(...n),a.fill()),(d===Qs.STROKE||d===Qs.FILL_STROKE)&&(i&&a.setTransform(...i),a.stroke()),a.restore()):((d===Qs.FILL||d===Qs.FILL_STROKE)&&a.fillText(e,t,s),(d===Qs.STROKE||d===Qs.FILL_STROKE)&&a.strokeText(e,t,s)),p&&(this.pendingTextPaths||=[]).push({transform:ts(a),x:t,y:s,fontSize:h,addToPath:w})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let n=3;n<t.length;n+=4)if(t[n]>0&&t[n]<255){s=!0;break}return xt(this,"isFontSubpixelAAEnabled",s)}showText(e){const t=this.current,s=t.font;if(s.isType3Font)return this.showType3Text(e);const n=t.fontSize;if(n===0)return;const i=this.ctx,a=t.fontSizeScale,o=t.charSpacing,l=t.wordSpacing,c=t.fontDirection,h=t.textHScale*c,d=e.length,p=s.vertical,f=p?1:-1,y=s.defaultVMetrics,w=n*t.fontMatrix[0],A=t.textRenderingMode===Qs.FILL&&!s.disableFontFace&&!t.patternFill;i.save(),i.transform(...t.textMatrix),i.translate(t.x,t.y+t.textRise),c>0?i.scale(h,-1):i.scale(h,1);let x,S;if(t.patternFill){i.save();const U=t.fillColor.getPattern(i,this,Fr(i),tn.FILL);x=ts(i),i.restore(),i.fillStyle=U}if(t.patternStroke){i.save();const U=t.strokeColor.getPattern(i,this,Fr(i),tn.STROKE);S=ts(i),i.restore(),i.strokeStyle=U}let I=t.lineWidth;const M=t.textMatrixScale;if(M===0||I===0){const U=t.textRenderingMode&Qs.FILL_STROKE_MASK;(U===Qs.STROKE||U===Qs.FILL_STROKE)&&(I=this.getSinglePixelWidth())}else I/=M;if(a!==1&&(i.scale(a,a),I/=a),i.lineWidth=I,s.isInvalidPDFjsFont){const U=[];let O=0;for(const G of e)U.push(G.unicode),O+=G.width;i.fillText(U.join(""),0,0),t.x+=O*w*h,i.restore(),this.compose();return}let B=0,Q;for(Q=0;Q<d;++Q){const U=e[Q];if(typeof U=="number"){B+=f*U*n/1e3;continue}let O=!1;const G=(U.isSpace?l:0)+o,ne=U.fontChar,L=U.accent;let j,V,q=U.width;if(p){const ae=U.vmetric||y,te=-(U.vmetric?ae[1]:q*.5)*w,K=ae[2]*w;q=ae?-ae[0]:q,j=te/a,V=(B+K)/a}else j=B/a,V=0;if(s.remeasure&&q>0){const ae=i.measureText(ne).width*1e3/n*a;if(q<ae&&this.isFontSubpixelAAEnabled){const te=q/ae;O=!0,i.save(),i.scale(te,1),j/=te}else q!==ae&&(j+=(q-ae)/2e3*n/a)}if(this.contentVisible&&(U.isInFont||s.missingFile)){if(A&&!L)i.fillText(ne,j,V);else if(this.paintChar(ne,j,V,x,S),L){const ae=j+n*L.offset.x/a,te=V-n*L.offset.y/a;this.paintChar(L.fontChar,ae,te,x,S)}}const le=p?q*w-G*c:q*w+G*c;B+=le,O&&i.restore()}p?t.y-=B:t.x+=B*h,i.restore(),this.compose()}showType3Text(e){const t=this.ctx,s=this.current,n=s.font,i=s.fontSize,a=s.fontDirection,o=n.vertical?1:-1,l=s.charSpacing,c=s.wordSpacing,h=s.textHScale*a,d=s.fontMatrix||zf,p=e.length,f=s.textRenderingMode===Qs.INVISIBLE;let y,w,A,x;if(!(f||i===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...s.textMatrix),t.translate(s.x,s.y),t.scale(h,a),y=0;y<p;++y){if(w=e[y],typeof w=="number"){x=o*w*i/1e3,this.ctx.translate(x,0),s.x+=x*h;continue}const S=(w.isSpace?c:0)+l,I=n.charProcOperatorList[w.operatorListId];if(!I){vt(`Type3 character "${w.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=w,this.save(),t.scale(i,i),t.transform(...d),this.executeOperatorList(I),this.restore()),A=He.applyTransform([w.width,0],d)[0]*i+S,t.translate(A,0),s.x+=A*h}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,s,n,i,a){this.ctx.rect(s,n,i-s,a-n),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const s=e[1],n=this.baseTransform||ts(this.ctx),i={createCanvasGraphics:a=>new Mo(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new Vp(e,s,this.ctx,i,n)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,s){this.ctx.strokeStyle=this.current.strokeColor=He.makeHexColor(e,t,s),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,s){this.ctx.fillStyle=this.current.fillColor=He.makeHexColor(e,t,s),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let s;return this.cachedPatterns.has(e)?s=this.cachedPatterns.get(e):(s=QA(this.getObject(e)),this.cachedPatterns.set(e,s)),t&&(s.matrix=t),s}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const s=this._getPattern(e);t.fillStyle=s.getPattern(t,this,Fr(t),tn.SHADING);const n=Fr(t);if(n){const{width:i,height:a}=t.canvas,[o,l,c,h]=He.getAxialAlignedBoundingBox([0,0,i,a],n);this.ctx.fillRect(o,l,c-o,h-l)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Ht("Should not call beginInlineImage")}beginImageData(){Ht("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=ts(this.ctx),t)){const s=t[2]-t[0],n=t[3]-t[1];this.ctx.rect(t[0],t[1],s,n),this.current.updateRectMinMax(ts(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||Ku("TODO: Support non-isolated groups."),e.knockout&&vt("Knockout groups not supported.");const s=ts(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let n=He.getAxialAlignedBoundingBox(e.bbox,ts(t));const i=[0,0,t.canvas.width,t.canvas.height];n=He.intersect(n,i)||[0,0,0,0];const a=Math.floor(n[0]),o=Math.floor(n[1]),l=Math.max(Math.ceil(n[2])-a,1),c=Math.max(Math.ceil(n[3])-o,1);this.current.startNewPathAndClipBox([0,0,l,c]);let h="groupAt"+this.groupLevel;e.smask&&(h+="_smask_"+this.smaskCounter++%2);const d=this.cachedCanvases.getCanvas(h,l,c),p=d.context;p.translate(-a,-o),p.transform(...s),e.smask?this.smaskStack.push({canvas:d.canvas,context:p,offsetX:a,offsetY:o,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,o),t.save()),$l(t,p),this.ctx=p,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const n=ts(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...n);const i=He.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],n);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(i)}}beginAnnotation(e,t,s,n,i){if(this.#e(),Wh(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const a=t[2]-t[0],o=t[3]-t[1];if(i&&this.annotationCanvasMap){s=s.slice(),s[4]-=t[0],s[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=a,t[3]=o;const[l,c]=He.singularValueDecompose2dScale(ts(this.ctx)),{viewportScale:h}=this,d=Math.ceil(a*this.outputScaleX*h),p=Math.ceil(o*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(d,p);const{canvas:f,context:y}=this.annotationCanvas;this.annotationCanvasMap.set(e,f),this.annotationCanvas.savedCtx=this.ctx,this.ctx=y,this.ctx.save(),this.ctx.setTransform(l,0,0,-c,0,o*c),Wh(this.ctx)}else Wh(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],a,o),this.ctx.clip(),this.ctx.beginPath()}this.current=new Dg(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...n)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const s=this.ctx,n=this.processingType3;if(n&&(n.compiled===void 0&&(n.compiled=rS(e)),n.compiled)){n.compiled(s);return}const i=this._createMaskCanvas(e),a=i.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(a,i.offsetX,i.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,s=0,n=0,i,a){if(!this.contentVisible)return;e=this.getObject(e.data,e);const o=this.ctx;o.save();const l=ts(o);o.transform(t,s,n,i,0,0);const c=this._createMaskCanvas(e);o.setTransform(1,0,0,1,c.offsetX-l[4],c.offsetY-l[5]);for(let h=0,d=a.length;h<d;h+=2){const p=He.transform(l,[t,s,n,i,a[h],a[h+1]]),[f,y]=He.applyTransform([0,0],p);o.drawImage(c.canvas,f,y)}o.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,s=this.current.fillColor,n=this.current.patternFill;for(const i of e){const{data:a,width:o,height:l,transform:c}=i,h=this.cachedCanvases.getCanvas("maskCanvas",o,l),d=h.context;d.save();const p=this.getObject(a,i);$g(d,p),d.globalCompositeOperation="source-in",d.fillStyle=n?s.getPattern(d,this,Fr(t),tn.FILL):s,d.fillRect(0,0,o,l),d.restore(),t.save(),t.transform(...c),t.scale(1,-1),Hh(t,h.canvas,0,0,o,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){vt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,s,n){if(!this.contentVisible)return;const i=this.getObject(e);if(!i){vt("Dependent image isn't ready yet");return}const a=i.width,o=i.height,l=[];for(let c=0,h=n.length;c<h;c+=2)l.push({transform:[t,0,0,s,n[c],n[c+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(i,l)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:s,height:n}=e,i=this.cachedCanvases.getCanvas("inlineImage",s,n),a=i.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",i.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,s=e.height,n=this.ctx;if(this.save(),!hn){const{filter:o}=n;o!=="none"&&o!==""&&(n.filter="none")}n.scale(1/t,-1/s);let i;if(e.bitmap)i=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)i=e;else{const l=this.cachedCanvases.getCanvas("inlineImage",t,s).context;Bg(l,e),i=this.applyTransferMapsToCanvas(l)}const a=this._scaleImage(i,Fr(n));n.imageSmoothingEnabled=qg(ts(n),e.interpolate),Hh(n,a.img,0,0,a.paintWidth,a.paintHeight,0,-s,t,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const s=this.ctx;let n;if(e.bitmap)n=e.bitmap;else{const i=e.width,a=e.height,l=this.cachedCanvases.getCanvas("inlineImage",i,a).context;Bg(l,e),n=this.applyTransferMapsToCanvas(l)}for(const i of t)s.save(),s.transform(...i.transform),s.scale(1,-1),Hh(s,n,i.x,i.y,i.w,i.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const s=this.ctx;this.pendingClip&&(t||(this.pendingClip===Ug?s.clip("evenodd"):s.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),s.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=ts(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),n=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,n)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:s,c:n,d:i}=this.ctx.getTransform();let a,o;if(s===0&&n===0){const l=Math.abs(t),c=Math.abs(i);if(l===c)if(e===0)a=o=1/l;else{const h=l*e;a=o=h<1?1/h:1}else if(e===0)a=1/l,o=1/c;else{const h=l*e,d=c*e;a=h<1?1/h:1,o=d<1?1/d:1}}else{const l=Math.abs(t*i-s*n),c=Math.hypot(t,s),h=Math.hypot(n,i);if(e===0)a=h/l,o=c/l;else{const d=e*l;a=h>d?h/d:1,o=c>d?c/d:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:s}=this.current,[n,i]=this.getScaleForStroking();if(t.lineWidth=s||1,n===1&&i===1){t.stroke();return}const a=t.getLineDash();if(e&&t.save(),t.scale(n,i),a.length>0){const o=Math.max(n,i);t.setLineDash(a.map(l=>l/o)),t.lineDashOffset/=o}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}for(const r in fr)Mo.prototype[r]!==void 0&&(Mo.prototype[fr[r]]=Mo.prototype[r]);class lc{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}}const Vh={UNKNOWN:0,DATA:1,ERROR:2},As={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function zg(){}function Xn(r){switch(r instanceof Error||typeof r=="object"&&r!==null||Ht('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),r.name){case"AbortException":return new Ma(r.message);case"MissingPDFException":return new Bc(r.message);case"PasswordException":return new Hf(r.message,r.code);case"UnexpectedResponseException":return new Ju(r.message,r.status);case"UnknownErrorException":return new Wf(r.message,r.details);default:return new Wf(r.message,r.toString())}}class Yl{#e=new AbortController;constructor(e,t,s){this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",this.#t.bind(this),{signal:this.#e.signal})}#t({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#n(e);return}if(e.callback){const s=e.callbackId,n=this.callbackCapabilities[s];if(!n)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],e.callback===Vh.DATA)n.resolve(e.data);else if(e.callback===Vh.ERROR)n.reject(Xn(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const s=this.sourceName,n=e.sourceName,i=this.comObj;Promise.try(t,e.data).then(function(a){i.postMessage({sourceName:s,targetName:n,callback:Vh.DATA,callbackId:e.callbackId,data:a})},function(a){i.postMessage({sourceName:s,targetName:n,callback:Vh.ERROR,callbackId:e.callbackId,reason:Xn(a)})});return}if(e.streamId){this.#s(e);return}t(e.data)}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const n=this.callbackId++,i=Promise.withResolvers();this.callbackCapabilities[n]=i;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:n,data:t},s)}catch(a){i.reject(a)}return i.promise}sendWithStream(e,t,s,n){const i=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{const h=Promise.withResolvers();return this.streamControllers[i]={controller:c,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:e,streamId:i,data:t,desiredSize:c.desiredSize},n),h.promise},pull:c=>{const h=Promise.withResolvers();return this.streamControllers[i].pullCall=h,l.postMessage({sourceName:a,targetName:o,stream:As.PULL,streamId:i,desiredSize:c.desiredSize}),h.promise},cancel:c=>{Ss(c instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[i].cancelCall=h,this.streamControllers[i].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:As.CANCEL,streamId:i,reason:Xn(c)}),h.promise}},s)}#s(e){const t=e.streamId,s=this.sourceName,n=e.sourceName,i=this.comObj,a=this,o=this.actionHandler[e.action],l={enqueue(c,h=1,d){if(this.isCancelled)return;const p=this.desiredSize;this.desiredSize-=h,p>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),i.postMessage({sourceName:s,targetName:n,stream:As.ENQUEUE,streamId:t,chunk:c},d)},close(){this.isCancelled||(this.isCancelled=!0,i.postMessage({sourceName:s,targetName:n,stream:As.CLOSE,streamId:t}),delete a.streamSinks[t])},error(c){Ss(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,i.postMessage({sourceName:s,targetName:n,stream:As.ERROR,streamId:t,reason:Xn(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(o,e.data,l).then(function(){i.postMessage({sourceName:s,targetName:n,stream:As.START_COMPLETE,streamId:t,success:!0})},function(c){i.postMessage({sourceName:s,targetName:n,stream:As.START_COMPLETE,streamId:t,reason:Xn(c)})})}#n(e){const t=e.streamId,s=this.sourceName,n=e.sourceName,i=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case As.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(Xn(e.reason));break;case As.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(Xn(e.reason));break;case As.PULL:if(!o){i.postMessage({sourceName:s,targetName:n,stream:As.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||zg).then(function(){i.postMessage({sourceName:s,targetName:n,stream:As.PULL_COMPLETE,streamId:t,success:!0})},function(c){i.postMessage({sourceName:s,targetName:n,stream:As.PULL_COMPLETE,streamId:t,reason:Xn(c)})});break;case As.ENQUEUE:if(Ss(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case As.CLOSE:if(Ss(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),this.#i(a,t);break;case As.ERROR:Ss(a,"error should have stream controller"),a.controller.error(Xn(e.reason)),this.#i(a,t);break;case As.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(Xn(e.reason)),this.#i(a,t);break;case As.CANCEL:if(!o)break;const l=Xn(e.reason);Promise.try(o.onCancel||zg,l).then(function(){i.postMessage({sourceName:s,targetName:n,stream:As.CANCEL_COMPLETE,streamId:t,success:!0})},function(c){i.postMessage({sourceName:s,targetName:n,stream:As.CANCEL_COMPLETE,streamId:t,reason:Xn(c)})}),o.sinkCapability.reject(l),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#i(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.#e?.abort(),this.#e=null}}class lS{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}getAll(){return Fp(this.#e)}has(e){return this.#e.has(e)}}const So=Symbol("INTERNAL");class cS{#e=!1;#t=!1;#s=!1;#n=!0;constructor(e,{name:t,intent:s,usage:n,rbGroups:i}){this.#e=!!(e&On.DISPLAY),this.#t=!!(e&On.PRINT),this.name=t,this.intent=s,this.usage=n,this.rbGroups=i}get visible(){if(this.#s)return this.#n;if(!this.#n)return!1;const{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,s=!1){e!==So&&Ht("Internal method `_setVisible` called."),this.#s=s,this.#n=t}}class hS{#e=null;#t=new Map;#s=null;#n=null;constructor(e,t=On.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#n=e.order;for(const s of e.groups)this.#t.set(s.id,new cS(t,s));if(e.baseState==="OFF")for(const s of this.#t.values())s._setVisible(So,!1);for(const s of e.on)this.#t.get(s)._setVisible(So,!0);for(const s of e.off)this.#t.get(s)._setVisible(So,!1);this.#s=this.getHash()}}#i(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let n=1;n<t;n++){const i=e[n];let a;if(Array.isArray(i))a=this.#i(i);else if(this.#t.has(i))a=this.#t.get(i).visible;else return vt(`Optional content group not found: ${i}`),!0;switch(s){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return s==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return Ku("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(vt(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#i(e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!this.#t.has(t))return vt(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!this.#t.has(t))return vt(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!this.#t.has(t))return vt(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!this.#t.has(t))return vt(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return vt(`Unknown optional content policy ${e.policy}.`),!0}return vt(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,s=!0){const n=this.#t.get(e);if(!n){vt(`Optional content group not found: ${e}`);return}if(s&&t&&n.rbGroups.length)for(const i of n.rbGroups)for(const a of i)a!==e&&this.#t.get(a)?._setVisible(So,!1,!0);n._setVisible(So,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let s;for(const n of e){switch(n){case"ON":case"OFF":case"Toggle":s=n;continue}const i=this.#t.get(n);if(i)switch(s){case"ON":this.setVisibility(n,!0,t);break;case"OFF":this.setVisibility(n,!1,t);break;case"Toggle":this.setVisibility(n,!i.visible,t);break}}this.#e=null}get hasInitialVisibility(){return this.#s===null||this.getHash()===this.#s}getOrder(){return this.#t.size?this.#n?this.#n.slice():[...this.#t.keys()]:null}getGroups(){return this.#t.size>0?Fp(this.#t):null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;const e=new $1;for(const[t,s]of this.#t)e.update(`${t}:${s.visible}`);return this.#e=e.hexdigest()}}class uS{constructor(e,{disableRange:t=!1,disableStream:s=!1}){Ss(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:n,initialData:i,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,i?.length>0){const l=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!s,this._isRangeSupported=!t,this._contentLength=n,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,c)=>{this._onReceiveData({begin:l,chunk:c})}),e.addProgressListener((l,c)=>{this._onProgress({loaded:l,total:c})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const s=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const n=this._rangeReaders.some(function(i){return i._begin!==e?!1:(i._enqueue(s),!0)});Ss(n,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Ss(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new dS(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new fS(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}}class dS{constructor(e,t,s=!1,n=null){this._stream=e,this._done=s||!1,this._filename=$p(n)?n:null,this._queuedChunks=t||[],this._loaded=0;for(const i of this._queuedChunks)this._loaded+=i.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class fS{constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function pS(r){let e=!0,t=s("filename\\*","i").exec(r);if(t){t=t[1];let h=o(t);return h=unescape(h),h=l(h),h=c(h),i(h)}if(t=a(r),t){const h=c(t);return i(h)}if(t=s("filename","i").exec(r),t){t=t[1];let h=o(t);return h=c(h),i(h)}function s(h,d){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',d)}function n(h,d){if(h){if(!/^[\x00-\xFF]+$/.test(d))return d;try{const p=new TextDecoder(h,{fatal:!0}),f=Zu(d);d=p.decode(f),e=!1}catch{}}return d}function i(h){return e&&/[\x80-\xff]/.test(h)&&(h=n("utf-8",h),e&&(h=n("iso-8859-1",h))),h}function a(h){const d=[];let p;const f=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(p=f.exec(h))!==null;){let[,w,A,x]=p;if(w=parseInt(w,10),w in d){if(w===0)break;continue}d[w]=[A,x]}const y=[];for(let w=0;w<d.length&&w in d;++w){let[A,x]=d[w];x=o(x),A&&(x=unescape(x),w===0&&(x=l(x))),y.push(x)}return y.join("")}function o(h){if(h.startsWith('"')){const d=h.slice(1).split('\\"');for(let p=0;p<d.length;++p){const f=d[p].indexOf('"');f!==-1&&(d[p]=d[p].slice(0,f),d.length=p+1),d[p]=d[p].replaceAll(/\\(.)/g,"$1")}h=d.join('"')}return h}function l(h){const d=h.indexOf("'");if(d===-1)return h;const p=h.slice(0,d),y=h.slice(d+1).replace(/^[^']*'/,"");return n(p,y)}function c(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(d,p,f,y){if(f==="q"||f==="Q")return y=y.replaceAll("_"," "),y=y.replaceAll(/=([0-9a-fA-F]{2})/g,function(w,A){return String.fromCharCode(parseInt(A,16))}),n(p,y);try{y=atob(y)}catch{}return n(p,y)})}return""}function Y1(r,e){const t=new Headers;if(!r||!e||typeof e!="object")return t;for(const s in e){const n=e[s];n!==void 0&&t.append(s,n)}return t}function td(r){try{return new URL(r).origin}catch{}return null}function K1({responseHeaders:r,isHttp:e,rangeChunkSize:t,disableRange:s}){const n={allowRangeRequests:!1,suggestedLength:void 0},i=parseInt(r.get("Content-Length"),10);return!Number.isInteger(i)||(n.suggestedLength=i,i<=2*t)||s||!e||r.get("Accept-Ranges")!=="bytes"||(r.get("Content-Encoding")||"identity")!=="identity"||(n.allowRangeRequests=!0),n}function J1(r){const e=r.get("Content-Disposition");if(e){let t=pS(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if($p(t))return t}return null}function sd(r,e){return r===404||r===0&&e.startsWith("file:")?new Bc('Missing PDF "'+e+'".'):new Ju(`Unexpected server response (${r}) while retrieving PDF "${e}".`,r)}function Z1(r){return r===200||r===206}function Q1(r,e,t){return{method:"GET",headers:r,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function eb(r){return r instanceof Uint8Array?r.buffer:r instanceof ArrayBuffer?r:(vt(`getArrayBuffer - unexpected data format: ${r}`),new Uint8Array(r).buffer)}class Hg{_responseOrigin=null;constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=Y1(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Ss(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new mS(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new gS(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class mS{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const s=new Headers(e.headers),n=t.url;fetch(n,Q1(s,this._withCredentials,this._abortController)).then(i=>{if(e._responseOrigin=td(i.url),!Z1(i.status))throw sd(i.status,n);this._reader=i.body.getReader(),this._headersCapability.resolve();const a=i.headers,{allowRangeRequests:o,suggestedLength:l}=K1({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=J1(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Ma("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:eb(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class gS{constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const n=e.source;this._withCredentials=n.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!n.disableStream,this._abortController=new AbortController;const i=new Headers(e.headers);i.append("Range",`bytes=${t}-${s-1}`);const a=n.url;fetch(a,Q1(i,this._withCredentials,this._abortController)).then(o=>{const l=td(o.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!Z1(o.status))throw sd(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:eb(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}const ff=200,pf=206;function bS(r){const e=r.response;return typeof e!="string"?e:Zu(e).buffer}class vS{_responseOrigin=null;constructor({url:e,httpHeaders:t,withCredentials:s}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=Y1(this.isHttp,t),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(e,t,s){const n={begin:e,end:t};for(const i in s)n[i]=s[i];return this.request(n)}requestFull(e){return this.request(e)}request(e){const t=new XMLHttpRequest,s=this.currXhrId++,n=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[i,a]of this.headers)t.setRequestHeader(i,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),n.expectedStatus=pf):n.expectedStatus=ff,t.responseType="arraybuffer",e.onError&&(t.onerror=function(i){e.onError(t.status)}),t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),n.onHeadersReceived=e.onHeadersReceived,n.onDone=e.onDone,n.onError=e.onError,n.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){const s=this.pendingRequests[e];s&&s.onProgress?.(t)}onStateChange(e,t){const s=this.pendingRequests[e];if(!s)return;const n=s.xhr;if(n.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),n.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],n.status===0&&this.isHttp){s.onError?.(n.status);return}const i=n.status||ff;if(!(i===ff&&s.expectedStatus===pf)&&i!==s.expectedStatus){s.onError?.(n.status);return}const o=bS(n);if(i===pf){const l=n.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);s.onDone({begin:parseInt(c[1],10),chunk:o})}else o?s.onDone({begin:0,chunk:o}):s.onError?.(n.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class yS{constructor(e){this._source=e,this._manager=new vS(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Ss(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new wS(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new xS(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class wS{constructor(e,t){this._manager=e;const s={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._fullRequestId=e.requestFull(s),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=td(t.responseURL);const s=t.getAllResponseHeaders(),n=new Headers(s?s.trim().split(/[\r\n]+/).map(o=>{const[l,...c]=o.split(": ");return[l,c.join(": ")]}):[]),{allowRangeRequests:i,suggestedLength:a}=K1({responseHeaders:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=J1(n),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=sd(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class xS{constructor(e,t,s){this._manager=e;const n={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._requestId=e.requestRange(t,s,n),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const e=td(this._manager.getRequestXhr(this._requestId)?.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??=sd(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const _S=/^[a-z][a-z0-9\-+.]+:/i;function AS(r){if(_S.test(r))return new URL(r);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(r))}class SS{constructor(e){this.source=e,this.url=AS(e.url),Ss(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Ss(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new NS(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new ES(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class NS{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(n=>{this._contentLength=n.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},n=>{n.code==="ENOENT"&&(n=new Bc(`Missing PDF "${this._url}".`)),this._storedError=n,this._headersCapability.reject(n)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Ma("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class ES{constructor(e,t,s){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const n=e.source;this._isStreamingSupported=!n.disableStream;const i=process.getBuiltinModule("fs");this._setReadableStream(i.createReadStream(this._url,{start:t,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const kS=1e5,wn=30,CS=.8;class cn{#e=Promise.withResolvers();#t=null;#s=!1;#n=!!globalThis.FontInspector?.enabled;#i=null;#r=null;#c=0;#o=0;#h=null;#l=null;#u=0;#a=0;#d=Object.create(null);#f=[];#p=null;#g=[];#m=new WeakMap;#b=null;static#v=new Map;static#w=new Map;static#x=new WeakMap;static#S=null;static#N=new Set;constructor({textContentSource:e,container:t,viewport:s}){if(e instanceof ReadableStream)this.#p=e;else if(typeof e=="object")this.#p=new ReadableStream({start(l){l.enqueue(e),l.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#l=t,this.#a=s.scale*(globalThis.devicePixelRatio||1),this.#u=s.rotation,this.#r={div:null,properties:null,ctx:null};const{pageWidth:n,pageHeight:i,pageX:a,pageY:o}=s.rawDims;this.#b=[1,0,0,-1,-a,o+i],this.#o=n,this.#c=i,cn.#L(),Ca(t,s),this.#e.promise.finally(()=>{cn.#N.delete(this),this.#r=null,this.#d=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=un.platform;return xt(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{this.#h.read().then(({value:t,done:s})=>{if(s){this.#e.resolve();return}this.#i??=t.lang,Object.assign(this.#d,t.styles),this.#E(t.items),e()},this.#e.reject)};return this.#h=this.#p.getReader(),cn.#N.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){const s=e.scale*(globalThis.devicePixelRatio||1),n=e.rotation;if(n!==this.#u&&(t?.(),this.#u=n,Ca(this.#l,{rotation:n})),s!==this.#a){t?.(),this.#a=s;const i={div:null,properties:null,ctx:cn.#P(this.#i)};for(const a of this.#g)i.properties=this.#m.get(a),i.div=a,this.#_(i)}}cancel(){const e=new Ma("TextLayer task cancelled.");this.#h?.cancel(e).catch(()=>{}),this.#h=null,this.#e.reject(e)}get textDivs(){return this.#g}get textContentItemsStr(){return this.#f}#E(e){if(this.#s)return;this.#r.ctx??=cn.#P(this.#i);const t=this.#g,s=this.#f;for(const n of e){if(t.length>kS){vt("Ignoring additional textDivs for performance reasons."),this.#s=!0;return}if(n.str===void 0){if(n.type==="beginMarkedContentProps"||n.type==="beginMarkedContent"){const i=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),n.id!==null&&this.#t.setAttribute("id",`${n.id}`),i.append(this.#t)}else n.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}s.push(n.str),this.#C(n)}}#C(e){const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#g.push(t);const n=He.transform(this.#b,e.transform);let i=Math.atan2(n[1],n[0]);const a=this.#d[e.fontName];a.vertical&&(i+=Math.PI/2);let o=this.#n&&a.fontSubstitution||a.fontFamily;o=cn.fontFamilyMap.get(o)||o;const l=Math.hypot(n[2],n[3]),c=l*cn.#R(o,this.#i);let h,d;i===0?(h=n[4],d=n[5]-c):(h=n[4]+c*Math.sin(i),d=n[5]-c*Math.cos(i));const p="calc(var(--scale-factor)*",f=t.style;this.#t===this.#l?(f.left=`${(100*h/this.#o).toFixed(2)}%`,f.top=`${(100*d/this.#c).toFixed(2)}%`):(f.left=`${p}${h.toFixed(2)}px)`,f.top=`${p}${d.toFixed(2)}px)`),f.fontSize=`${p}${(cn.#S*l).toFixed(2)}px)`,f.fontFamily=o,s.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#n&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),i!==0&&(s.angle=i*(180/Math.PI));let y=!1;if(e.str.length>1)y=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const w=Math.abs(e.transform[0]),A=Math.abs(e.transform[3]);w!==A&&Math.max(w,A)/Math.min(w,A)>1.5&&(y=!0)}if(y&&(s.canvasWidth=a.vertical?e.height:e.width),this.#m.set(t,s),this.#r.div=t,this.#r.properties=s,this.#_(this.#r),s.hasText&&this.#t.append(t),s.hasEOL){const w=document.createElement("br");w.setAttribute("role","presentation"),this.#t.append(w)}}#_(e){const{div:t,properties:s,ctx:n}=e,{style:i}=t;let a="";if(cn.#S>1&&(a=`scale(${1/cn.#S})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:o}=i,{canvasWidth:l,fontSize:c}=s;cn.#k(n,c*this.#a,o);const{width:h}=n.measureText(t.textContent);h>0&&(a=`scaleX(${l*this.#a/h}) ${a}`)}s.angle!==0&&(a=`rotate(${s.angle}deg) ${a}`),a.length>0&&(i.transform=a)}static cleanup(){if(!(this.#N.size>0)){this.#v.clear();for(const{canvas:e}of this.#w.values())e.remove();this.#w.clear()}}static#P(e=null){let t=this.#w.get(e||="");if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#w.set(e,t),this.#x.set(t,{size:0,family:""})}return t}static#k(e,t,s){const n=this.#x.get(e);t===n.size&&s===n.family||(e.font=`${t}px ${s}`,n.size=t,n.family=s)}static#L(){if(this.#S!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#S=e.getBoundingClientRect().height,e.remove()}static#R(e,t){const s=this.#v.get(e);if(s)return s;const n=this.#P(t);n.canvas.width=n.canvas.height=wn,this.#k(n,wn,e);const i=n.measureText("");let a=i.fontBoundingBoxAscent,o=Math.abs(i.fontBoundingBoxDescent);if(a){const h=a/(a+o);return this.#v.set(e,h),n.canvas.width=n.canvas.height=0,h}n.strokeStyle="red",n.clearRect(0,0,wn,wn),n.strokeText("g",0,0);let l=n.getImageData(0,0,wn,wn).data;o=0;for(let h=l.length-1-3;h>=0;h-=4)if(l[h]>0){o=Math.ceil(h/4/wn);break}n.clearRect(0,0,wn,wn),n.strokeText("A",0,wn),l=n.getImageData(0,0,wn,wn).data,a=0;for(let h=0,d=l.length;h<d;h+=4)if(l[h]>0){a=wn-Math.floor(h/4/wn);break}n.canvas.width=n.canvas.height=0;const c=a?a/(a+o):CS;return this.#v.set(e,c),c}}class vc{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};function n(i){if(!i)return;let a=null;const o=i.name;if(o==="#text")a=i.value;else if(vc.shouldBuildText(o))i?.attributes?.textContent?a=i.attributes.textContent:i.value&&(a=i.value);else return;if(a!==null&&t.push({str:a}),!!i.children)for(const l of i.children)n(l)}return n(e),s}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const PS=65536,LS=100,TS=5e3,IS=hn?VA:zA,jS=hn?GA:H1,RS=hn?WA:HA,OS=hn?XA:G1;function MS(r={}){typeof r=="string"||r instanceof URL?r={url:r}:(r instanceof ArrayBuffer||ArrayBuffer.isView(r))&&(r={data:r});const e=new Gp,{docId:t}=e,s=r.url?FS(r.url):null,n=r.data?DS(r.data):null,i=r.httpHeaders||null,a=r.withCredentials===!0,o=r.password??null,l=r.range instanceof tb?r.range:null,c=Number.isInteger(r.rangeChunkSize)&&r.rangeChunkSize>0?r.rangeChunkSize:PS;let h=r.worker instanceof Ds?r.worker:null;const d=r.verbosity,p=typeof r.docBaseUrl=="string"&&!ed(r.docBaseUrl)?r.docBaseUrl:null,f=typeof r.cMapUrl=="string"?r.cMapUrl:null,y=r.cMapPacked!==!1,w=r.CMapReaderFactory||jS,A=typeof r.standardFontDataUrl=="string"?r.standardFontDataUrl:null,x=r.StandardFontDataFactory||OS,S=r.stopAtErrors!==!0,I=Number.isInteger(r.maxImageSize)&&r.maxImageSize>-1?r.maxImageSize:-1,M=r.isEvalSupported!==!1,B=typeof r.isOffscreenCanvasSupported=="boolean"?r.isOffscreenCanvasSupported:!hn,Q=typeof r.isImageDecoderSupported=="boolean"?r.isImageDecoderSupported:!hn&&(un.platform.isFirefox||!globalThis.chrome),U=Number.isInteger(r.canvasMaxAreaInBytes)?r.canvasMaxAreaInBytes:-1,O=typeof r.disableFontFace=="boolean"?r.disableFontFace:hn,G=r.fontExtraProperties===!0,ne=r.enableXfa===!0,L=r.ownerDocument||globalThis.document,j=r.disableRange===!0,V=r.disableStream===!0,q=r.disableAutoFetch===!0,le=r.pdfBug===!0,ae=r.CanvasFactory||IS,te=r.FilterFactory||RS,K=r.enableHWA===!0,fe=l?l.length:r.length??NaN,me=typeof r.useSystemFonts=="boolean"?r.useSystemFonts:!hn&&!O,Ae=typeof r.useWorkerFetch=="boolean"?r.useWorkerFetch:w===H1&&x===G1&&f&&A&&Xl(f,document.baseURI)&&Xl(A,document.baseURI);r.canvasFactory&&Tg("`canvasFactory`-instance option, please use `CanvasFactory` instead."),r.filterFactory&&Tg("`filterFactory`-instance option, please use `FilterFactory` instead.");const k=null;xA(d);const D={canvasFactory:new ae({ownerDocument:L,enableHWA:K}),filterFactory:new te({docId:t,ownerDocument:L}),cMapReaderFactory:Ae?null:new w({baseUrl:f,isCompressed:y}),standardFontDataFactory:Ae?null:new x({baseUrl:A})};if(!h){const ee={verbosity:d,port:lc.workerPort};h=ee.port?Ds.fromPort(ee):new Ds(ee),e._worker=h}const z={docId:t,apiVersion:"4.9.155",data:n,password:o,disableAutoFetch:q,rangeChunkSize:c,length:fe,docBaseUrl:p,enableXfa:ne,evaluatorOptions:{maxImageSize:I,disableFontFace:O,ignoreErrors:S,isEvalSupported:M,isOffscreenCanvasSupported:B,isImageDecoderSupported:Q,canvasMaxAreaInBytes:U,fontExtraProperties:G,useSystemFonts:me,cMapUrl:Ae?f:null,standardFontDataUrl:Ae?A:null}},X={disableFontFace:O,fontExtraProperties:G,ownerDocument:L,pdfBug:le,styleElement:k,loadingParams:{disableAutoFetch:q,enableXfa:ne}};return h.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const ee=h.messageHandler.sendWithPromise("GetDocRequest",z,n?[n.buffer]:null);let ie;if(l)ie=new uS(l,{disableRange:j,disableStream:V});else if(!n){if(!s)throw new Error("getDocument - no `url` parameter provided.");let ue;if(hn)if(Xl(s)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");ue=Hg}else ue=SS;else ue=Xl(s)?Hg:yS;ie=new ue({url:s,length:fe,httpHeaders:i,withCredentials:a,rangeChunkSize:c,disableRange:j,disableStream:V})}return ee.then(ue=>{if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const de=new Yl(t,ue,h.port),ke=new US(de,e,ie,X,D);e._transport=ke,de.send("Ready",null)})}).catch(e._capability.reject),e}function FS(r){if(r instanceof URL)return r.href;try{return new URL(r,window.location).href}catch{if(hn&&typeof r=="string")return r}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function DS(r){if(hn&&typeof Buffer<"u"&&r instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength)return r;if(typeof r=="string")return Zu(r);if(r instanceof ArrayBuffer||ArrayBuffer.isView(r)||typeof r=="object"&&!isNaN(r?.length))return new Uint8Array(r);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Wg(r){return typeof r=="object"&&Number.isInteger(r?.num)&&r.num>=0&&Number.isInteger(r?.gen)&&r.gen>=0}class Gp{static#e=0;constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${Gp.#e++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null}}class tb{constructor(e,t,s=!1,n=null){this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=n,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const s of this._rangeListeners)s(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const s of this._progressListeners)s(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){Ht("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class BS{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return xt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class $S{#e=null;#t=!1;constructor(e,t,s,n=!1){this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=n?new Lg:null,this._pdfBug=n,this.commonObjs=s.commonObjs,this.objs=new sb,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:n=0,dontFlip:i=!1}={}){return new $c({viewBox:this.view,scale:e,rotation:t,offsetX:s,offsetY:n,dontFlip:i})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return xt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,viewport:t,intent:s="display",annotationMode:n=zi.ENABLE,transform:i=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:l=null,pageColors:c=null,printAnnotationStorage:h=null,isEditing:d=!1}){this._stats?.time("Overall");const p=this._transport.getRenderingIntent(s,n,h,d),{renderingIntent:f,cacheKey:y}=p;this.#t=!1,this.#n(),o||=this._transport.getOptionalContentConfig(f);let w=this._intentStates.get(y);w||(w=Object.create(null),this._intentStates.set(y,w)),w.streamReaderCancelTimeout&&(clearTimeout(w.streamReaderCancelTimeout),w.streamReaderCancelTimeout=null);const A=!!(f&On.PRINT);w.displayReadyCapability||(w.displayReadyCapability=Promise.withResolvers(),w.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(p));const x=M=>{w.renderTasks.delete(S),(this._maybeCleanupAfterRender||A)&&(this.#t=!0),this.#s(!A),M?(S.capability.reject(M),this._abortOperatorList({intentState:w,reason:M instanceof Error?M:new Error(M)})):S.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},S=new Lo({callback:x,params:{canvasContext:e,viewport:t,transform:i,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:w.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!A,pdfBug:this._pdfBug,pageColors:c});(w.renderTasks||=new Set).add(S);const I=S.task;return Promise.all([w.displayReadyCapability.promise,o]).then(([M,B])=>{if(this.destroyed){x();return}if(this._stats?.time("Rendering"),!(B.renderingIntent&f))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");S.initializeGraphics({transparency:M,optionalContentConfig:B}),S.operatorListChanged()}).catch(x),I}getOperatorList({intent:e="display",annotationMode:t=zi.ENABLE,printAnnotationStorage:s=null,isEditing:n=!1}={}){function i(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}const a=this._transport.getRenderingIntent(e,t,s,n,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=i,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||=new Set).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(n){return n.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>vc.textContent(s));const t=this.streamTextContent(e);return new Promise(function(s,n){function i(){a.read().then(function({value:l,done:c}){if(c){s(o);return}o.lang??=l.lang,Object.assign(o.styles,l.styles),o.items.push(...l.items),i()},n)}const a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};i()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),this.#t=!1,this.#n(),Promise.all(e)}cleanup(e=!1){this.#t=!0;const t=this.#s(!1);return e&&t&&(this._stats&&=new Lg),t}#s(e=!1){if(this.#n(),!this.#t||this.destroyed)return!1;if(e)return this.#e=setTimeout(()=>{this.#e=null,this.#s(!1)},TS),!1;for(const{renderTasks:t,operatorList:s}of this._intentStates.values())if(t.size>0||!s.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}#n(){this.#e&&(clearTimeout(this.#e),this.#e=null)}_startRenderPage(e,t){const s=this._intentStates.get(t);s&&(this._stats?.timeEnd("Page Request"),s.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let s=0,n=e.length;s<n;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&this.#s(!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:s,modifiedIds:n}){const{map:i,transfer:a}=s,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:i,modifiedIds:n},a).getReader(),c=this._intentStates.get(t);c.streamReader=l;const h=()=>{l.read().then(({value:d,done:p})=>{if(p){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(d,c),h())},d=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const p of c.renderTasks)p.operatorListChanged();this.#s(!0)}if(c.displayReadyCapability)c.displayReadyCapability.reject(d);else if(c.opListReadCapability)c.opListReadCapability.reject(d);else throw d}})};h()}_abortOperatorList({intentState:e,reason:t,force:s=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!s){if(e.renderTasks.size>0)return;if(t instanceof Bp){let n=LS;t.extraDelay>0&&t.extraDelay<1e3&&(n+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},n);return}}if(e.streamReader.cancel(new Ma(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[n,i]of this._intentStates)if(i===e){this._intentStates.delete(n);break}this.cleanup()}}}get stats(){return this._stats}}class qS{#e=new Map;#t=Promise.resolve();postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(const[n]of this.#e)n.call(this,s)})}addEventListener(e,t,s=null){let n=null;if(s?.signal instanceof AbortSignal){const{signal:i}=s;if(i.aborted){vt("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);n=()=>i.removeEventListener("abort",a),i.addEventListener("abort",a)}this.#e.set(t,n)}removeEventListener(e,t){this.#e.get(t)?.(),this.#e.delete(t)}terminate(){for(const[,e]of this.#e)e?.();this.#e.clear()}}class Ds{static#e=0;static#t=!1;static#s;static{hn&&(this.#t=!0,lc.workerSrc||="./pdf.worker.mjs"),this._isSameOrigin=(e,t)=>{let s;try{if(s=new URL(e),!s.origin||s.origin==="null")return!1}catch{return!1}const n=new URL(t,s);return s.origin===n.origin},this._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))}}constructor({name:e=null,port:t=null,verbosity:s=_A()}={}){if(this.name=e,this.destroyed=!1,this.verbosity=s,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if(Ds.#s?.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(Ds.#s||=new WeakMap).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}#n(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new Yl("main","worker",e),this._messageHandler.on("ready",function(){}),this.#n()}_initialize(){if(Ds.#t||Ds.#i){this._setupFakeWorker();return}let{workerSrc:e}=Ds;try{Ds._isSameOrigin(window.location.href,e)||(e=Ds._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new Yl("main","worker",t),n=()=>{i.abort(),s.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},i=new AbortController;t.addEventListener("error",()=>{this._webWorker||n()},{signal:i.signal}),s.on("test",o=>{if(i.abort(),this.destroyed||!o){n();return}this._messageHandler=s,this._port=t,this._webWorker=t,this.#n()}),s.on("ready",o=>{if(i.abort(),this.destroyed){n();return}try{a()}catch{this._setupFakeWorker()}});const a=()=>{const o=new Uint8Array;s.send("test",o,[o.buffer])};a();return}catch{Ku("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){Ds.#t||(vt("Setting up fake worker."),Ds.#t=!0),Ds._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new qS;this._port=t;const s=`fake${Ds.#e++}`,n=new Yl(s+"_worker",s,t);e.setup(n,t),this._messageHandler=new Yl(s,s+"_worker",t),this.#n()}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){this.destroyed=!0,this._webWorker?.terminate(),this._webWorker=null,Ds.#s?.delete(this._port),this._port=null,this._messageHandler?.destroy(),this._messageHandler=null}static fromPort(e){if(!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const t=this.#s?.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Ds(e)}static get workerSrc(){if(lc.workerSrc)return lc.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get#i(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){return xt(this,"_setupFakeWorkerGlobal",(async()=>this.#i?this.#i:(await import(this.workerSrc)).WorkerMessageHandler)())}}class US{#e=new Map;#t=new Map;#s=new Map;#n=new Map;#i=null;constructor(e,t,s,n,i){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new sb,this.fontLoader=new qA({ownerDocument:n.ownerDocument,styleElement:n.styleElement}),this.loadingParams=n.loadingParams,this._params=n,this.canvasFactory=i.canvasFactory,this.filterFactory=i.filterFactory,this.cMapReaderFactory=i.cMapReaderFactory,this.standardFontDataFactory=i.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#r(e,t=null){const s=this.#e.get(e);if(s)return s;const n=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,n),n}get annotationStorage(){return xt(this,"annotationStorage",new Hp)}getRenderingIntent(e,t=zi.ENABLE,s=null,n=!1,i=!1){let a=On.DISPLAY,o=Gf;switch(e){case"any":a=On.ANY;break;case"display":break;case"print":a=On.PRINT;break;default:vt(`getRenderingIntent - invalid intent: ${e}`)}const l=a&On.PRINT&&s instanceof q1?s:this.annotationStorage;switch(t){case zi.DISABLE:a+=On.ANNOTATIONS_DISABLE;break;case zi.ENABLE:break;case zi.ENABLE_FORMS:a+=On.ANNOTATIONS_FORMS;break;case zi.ENABLE_STORAGE:a+=On.ANNOTATIONS_STORAGE,o=l.serializable;break;default:vt(`getRenderingIntent - invalid annotationMode: ${t}`)}n&&(a+=On.IS_EDITING),i&&(a+=On.OPLIST);const{ids:c,hash:h}=l.modifiedIds,d=[a,o.hash,h];return{renderingIntent:a,cacheKey:d.join("_"),annotationStorageSerializable:o,modifiedIds:c}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#i?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const s of this.#t.values())e.push(s._destroy());this.#t.clear(),this.#s.clear(),this.#n.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),cn.cleanup(),this._networkStream?.cancelAllRequests(new Ma("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(s,n)=>{Ss(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=i=>{this._lastProgress={loaded:i.loaded,total:i.total}},n.onPull=()=>{this._fullReader.read().then(function({value:i,done:a}){if(a){n.close();return}Ss(i instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(i),1,[i])}).catch(i=>{n.error(i)})},n.onCancel=i=>{this._fullReader.cancel(i),n.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async s=>{await this._fullReader.headersReady;const{isStreamingSupported:n,isRangeSupported:i,contentLength:a}=this._fullReader;return(!n||!i)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=o=>{t.onProgress?.({loaded:o.loaded,total:o.total})}),{isStreamingSupported:n,isRangeSupported:i,contentLength:a}}),e.on("GetRangeReader",(s,n)=>{Ss(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const i=this._networkStream.getRangeReader(s.begin,s.end);if(!i){n.close();return}n.onPull=()=>{i.read().then(function({value:a,done:o}){if(o){n.close();return}Ss(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{n.error(a)})},n.onCancel=a=>{i.cancel(a),n.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new BS(s,this))}),e.on("DocException",function(s){let n;switch(s.name){case"PasswordException":n=new Hf(s.message,s.code);break;case"InvalidPDFException":n=new F1(s.message);break;case"MissingPDFException":n=new Bc(s.message);break;case"UnexpectedResponseException":n=new Ju(s.message,s.status);break;case"UnknownErrorException":n=new Wf(s.message,s.details);break;default:Ht("DocException - expected a valid Error.")}t._capability.reject(n)}),e.on("PasswordRequest",s=>{if(this.#i=Promise.withResolvers(),t.onPassword){const n=i=>{i instanceof Error?this.#i.reject(i):this.#i.resolve({password:i})};try{t.onPassword(n,s.code)}catch(i){this.#i.reject(i)}}else this.#i.reject(new Hf(s.message,s.code));return this.#i.promise}),e.on("DataLoaded",s=>{t.onProgress?.({loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),e.on("StartRenderPage",s=>{if(this.destroyed)return;this.#t.get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),e.on("commonobj",([s,n,i])=>{if(this.destroyed||this.commonObjs.has(s))return null;switch(n){case"Font":const{disableFontFace:a,fontExtraProperties:o,pdfBug:l}=this._params;if("error"in i){const p=i.error;vt(`Error during font loading: ${p}`),this.commonObjs.resolve(s,p);break}const c=l&&globalThis.FontInspector?.enabled?(p,f)=>globalThis.FontInspector.fontAdded(p,f):null,h=new UA(i,{disableFontFace:a,inspectFont:c});this.fontLoader.bind(h).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!o&&h.data&&(h.data=null),this.commonObjs.resolve(s,h)});break;case"CopyLocalImage":const{imageRef:d}=i;Ss(d,"The imageRef must be defined.");for(const p of this.#t.values())for(const[,f]of p.objs)if(f?.ref===d)return f.dataLen?(this.commonObjs.resolve(s,structuredClone(f)),f.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,i);break;default:throw new Error(`Got unknown common object type ${n}`)}return null}),e.on("obj",([s,n,i,a])=>{if(this.destroyed)return;const o=this.#t.get(n);if(!o.objs.has(s)){if(o._intentStates.size===0){a?.bitmap?.close();return}switch(i){case"Image":o.objs.resolve(s,a),a?.dataLen>bA&&(o._maybeCleanupAfterRender=!0);break;case"Pattern":o.objs.resolve(s,a);break;default:throw new Error(`Got unknown object type ${i}`)}}}),e.on("DocProgress",s=>{this.destroyed||t.onProgress?.({loaded:s.loaded,total:s.total})}),e.on("FetchBuiltInCMap",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(s)}),e.on("FetchStandardFontData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&vt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=this.#s.get(t);if(s)return s;const n=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(i=>{if(this.destroyed)throw new Error("Transport destroyed");i.refStr&&this.#n.set(i.refStr,e);const a=new $S(t,i,this,this._params.pdfBug);return this.#t.set(t,a),a});return this.#s.set(t,n),n}getPageIndex(e){return Wg(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#r("GetFieldObjects")}hasJSActions(){return this.#r("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#r("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#r("GetOptionalContentConfig").then(t=>new hS(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#e.get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then(n=>({info:n[0],metadata:n[1]?new lS(n[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),cn.cleanup()}}cachedPageNumber(e){if(!Wg(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#n.get(t)??null}}const Gh=Symbol("INITIAL_DATA");class sb{#e=Object.create(null);#t(e){return this.#e[e]||={...Promise.withResolvers(),data:Gh}}get(e,t=null){if(t){const n=this.#t(e);return n.promise.then(()=>t(n.data)),null}const s=this.#e[e];if(!s||s.data===Gh)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=this.#e[e];return!!t&&t.data!==Gh}resolve(e,t=null){const s=this.#t(e);s.data=t,s.resolve()}clear(){for(const e in this.#e){const{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(const e in this.#e){const{data:t}=this.#e[e];t!==Gh&&(yield[e,t])}}}class zS{#e=null;constructor(e){this.#e=e,this.onContinue=null}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}}class Lo{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:s,commonObjs:n,annotationCanvasMap:i,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:h=!1,pdfBug:d=!1,pageColors:p=null}){this.callback=e,this.params=t,this.objs=s,this.commonObjs=n,this.annotationCanvasMap=i,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=d,this.pageColors=p,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new zS(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(Lo.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Lo.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:s,viewport:n,transform:i,background:a}=this.params;this.gfx=new Mo(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:i,viewport:n,transparency:e,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),Lo.#t.delete(this._canvas),this.callback(e||new Bp(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Lo.#t.delete(this._canvas),this.callback())))}}const HS="4.9.155",WS="a4eb8407c";function Vg(r){return Math.floor(Math.max(0,Math.min(1,r))*255).toString(16).padStart(2,"0")}function ql(r){return Math.max(0,Math.min(255,255*r))}class Gg{static CMYK_G([e,t,s,n]){return["G",1-Math.min(1,.3*e+.59*s+.11*t+n)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=ql(e),[e,e,e]}static G_HTML([e]){const t=Vg(e);return`#${t}${t}${t}`}static RGB_G([e,t,s]){return["G",.3*e+.59*t+.11*s]}static RGB_rgb(e){return e.map(ql)}static RGB_HTML(e){return`#${e.map(Vg).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,s,n]){return["RGB",1-Math.min(1,e+n),1-Math.min(1,s+n),1-Math.min(1,t+n)]}static CMYK_rgb([e,t,s,n]){return[ql(1-Math.min(1,e+n)),ql(1-Math.min(1,s+n)),ql(1-Math.min(1,t+n))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,s]){const n=1-e,i=1-t,a=1-s,o=Math.min(n,i,a);return["CMYK",n,i,a,o]}}class VS{create(e,t,s=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const n=this._createSVG("svg:svg");return n.setAttribute("version","1.1"),s||(n.setAttribute("width",`${e}px`),n.setAttribute("height",`${t}px`)),n.setAttribute("preserveAspectRatio","none"),n.setAttribute("viewBox",`0 0 ${e} ${t}`),n}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Ht("Abstract method `_createSVG` called.")}}class Xp extends VS{_createSVG(e){return document.createElementNS(di,e)}}class nb{static setupStorage(e,t,s,n,i){const a=n.getValue(t,{value:null});switch(s.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),i==="print")break;e.addEventListener("input",o=>{n.setValue(t,{value:o.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(a.value===s.attributes.xfaOn?e.setAttribute("checked",!0):a.value===s.attributes.xfaOff&&e.removeAttribute("checked"),i==="print")break;e.addEventListener("change",o=>{n.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),i==="print")break;e.addEventListener("input",o=>{n.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const o of s.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const l=o.target.options,c=l.selectedIndex===-1?"":l[l.selectedIndex].value;n.setValue(t,{value:c})});break}}static setAttributes({html:e,element:t,storage:s=null,intent:n,linkService:i}){const{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${n}`);for(const[l,c]of Object.entries(a))if(c!=null)switch(l){case"class":c.length&&e.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",c);break;case"style":Object.assign(e.style,c);break;case"textContent":e.textContent=c;break;default:(!o||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,c)}o&&i.addLinkAttributes(e,a.href,a.newWindow),s&&a.dataId&&this.setupStorage(e,a.dataId,t,s)}static render(e){const t=e.annotationStorage,s=e.linkService,n=e.xfaHtml,i=e.intent||"display",a=document.createElement(n.name);n.attributes&&this.setAttributes({html:a,element:n,intent:i,linkService:s});const o=i!=="richText",l=e.div;if(l.append(a),e.viewport){const d=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=d}o&&l.setAttribute("class","xfaLayer xfaFont");const c=[];if(n.children.length===0){if(n.value){const d=document.createTextNode(n.value);a.append(d),o&&vc.shouldBuildText(n.name)&&c.push(d)}return{textDivs:c}}const h=[[n,-1,a]];for(;h.length>0;){const[d,p,f]=h.at(-1);if(p+1===d.children.length){h.pop();continue}const y=d.children[++h.at(-1)[1]];if(y===null)continue;const{name:w}=y;if(w==="#text"){const x=document.createTextNode(y.value);c.push(x),f.append(x);continue}const A=y?.attributes?.xmlns?document.createElementNS(y.attributes.xmlns,w):document.createElement(w);if(f.append(A),y.attributes&&this.setAttributes({html:A,element:y,storage:t,intent:i,linkService:s}),y.children?.length>0)h.push([y,-1,A]);else if(y.value){const x=document.createTextNode(y.value);o&&vc.shouldBuildText(w)&&c.push(x),A.append(x)}}for(const d of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))d.setAttribute("readOnly",!0);return{textDivs:c}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Uc=1e3,GS=9,Pa=new WeakSet;function Wi(r){return{width:r[2]-r[0],height:r[3]-r[1]}}class XS{static create(e){switch(e.data.annotationType){case Ls.LINK:return new rb(e);case Ls.TEXT:return new YS(e);case Ls.WIDGET:switch(e.data.fieldType){case"Tx":return new KS(e);case"Btn":return e.data.radioButton?new ib(e):e.data.checkBox?new ZS(e):new QS(e);case"Ch":return new e3(e);case"Sig":return new JS(e)}return new Fa(e);case Ls.POPUP:return new Yf(e);case Ls.FREETEXT:return new ab(e);case Ls.LINE:return new s3(e);case Ls.SQUARE:return new n3(e);case Ls.CIRCLE:return new r3(e);case Ls.POLYLINE:return new ob(e);case Ls.CARET:return new a3(e);case Ls.INK:return new Yp(e);case Ls.POLYGON:return new i3(e);case Ls.HIGHLIGHT:return new lb(e);case Ls.UNDERLINE:return new o3(e);case Ls.SQUIGGLY:return new l3(e);case Ls.STRIKEOUT:return new c3(e);case Ls.STAMP:return new cb(e);case Ls.FILEATTACHMENT:return new h3(e);default:return new vs(e)}}}class vs{#e=null;#t=!1;#s=null;constructor(e,{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:n=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(s)),n&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:s}){return!!(e?.str||t?.str||s?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return vs._hasPopupData(this.data)}updateEdited(e){if(!this.container)return;this.#e||={rect:this.data.rect.slice(0)};const{rect:t}=e;t&&this.#n(t),this.#s?.popup.updateEdited(e)}resetEdited(){this.#e&&(this.#n(this.#e.rect),this.#s?.popup.resetEdited(),this.#e=null)}#n(e){const{container:{style:t},data:{rect:s,rotation:n},parent:{viewport:{rawDims:{pageWidth:i,pageHeight:a,pageX:o,pageY:l}}}}=this;s?.splice(0,4,...e);const{width:c,height:h}=Wi(e);t.left=`${100*(e[0]-o)/i}%`,t.top=`${100*(a-e[3]+l)/a}%`,n===0?(t.width=`${100*c/i}%`,t.height=`${100*h/a}%`):this.setRotation(n)}_createContainer(e){const{data:t,parent:{page:s,viewport:n}}=this,i=document.createElement("section");i.setAttribute("data-annotation-id",t.id),this instanceof Fa||(i.tabIndex=Uc);const{style:a}=i;if(a.zIndex=this.parent.zIndex++,t.alternativeText&&(i.title=t.alternativeText),t.noRotate&&i.classList.add("norotate"),!t.rect||this instanceof Yf){const{rotation:w}=t;return!t.hasOwnCanvas&&w!==0&&this.setRotation(w,i),i}const{width:o,height:l}=Wi(t.rect);if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const w=t.borderStyle.horizontalCornerRadius,A=t.borderStyle.verticalCornerRadius;if(w>0||A>0){const S=`calc(${w}px * var(--scale-factor)) / calc(${A}px * var(--scale-factor))`;a.borderRadius=S}else if(this instanceof ib){const S=`calc(${o}px * var(--scale-factor)) / calc(${l}px * var(--scale-factor))`;a.borderRadius=S}switch(t.borderStyle.style){case Bl.SOLID:a.borderStyle="solid";break;case Bl.DASHED:a.borderStyle="dashed";break;case Bl.BEVELED:vt("Unimplemented border style: beveled");break;case Bl.INSET:vt("Unimplemented border style: inset");break;case Bl.UNDERLINE:a.borderBottomStyle="solid";break}const x=t.borderColor||null;x?(this.#t=!0,a.borderColor=He.makeHexColor(x[0]|0,x[1]|0,x[2]|0)):a.borderWidth=0}const c=He.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:h,pageHeight:d,pageX:p,pageY:f}=n.rawDims;a.left=`${100*(c[0]-p)/h}%`,a.top=`${100*(c[1]-f)/d}%`;const{rotation:y}=t;return t.hasOwnCanvas||y===0?(a.width=`${100*o/h}%`,a.height=`${100*l/d}%`):this.setRotation(y,i),i}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:n}=this.parent.viewport.rawDims,{width:i,height:a}=Wi(this.data.rect);let o,l;e%180===0?(o=100*i/s,l=100*a/n):(o=100*a/s,l=100*i/n),t.style.width=`${o}%`,t.style.height=`${l}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,s,n)=>{const i=n.detail[t],a=i[0],o=i.slice(1);n.target.style[s]=Gg[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[s]:Gg[`${a}_rgb`](o)})};return xt(this,"_commonActions",{display:t=>{const{display:s}=t.detail,n=s%2===1;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:s===1||s===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:s}=t.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const s=t.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const n of Object.keys(t.detail))(e[n]||s[n])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[n,i]of Object.entries(t)){const a=s[n];if(a){const o={detail:{[n]:i},target:e};a(o),delete t[n]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,n,i]=this.data.rect.map(w=>Math.fround(w));if(e.length===8){const[w,A,x,S]=e.subarray(2,6);if(n===w&&i===A&&t===x&&s===S)return}const{style:a}=this.container;let o;if(this.#t){const{borderColor:w,borderWidth:A}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${w}" stroke-width="${A}">`],this.container.classList.add("hasBorder")}const l=n-t,c=i-s,{svgFactory:h}=this,d=h.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0);const p=h.createElement("defs");d.append(p);const f=h.createElement("clipPath"),y=`clippath_${this.data.id}`;f.setAttribute("id",y),f.setAttribute("clipPathUnits","objectBoundingBox"),p.append(f);for(let w=2,A=e.length;w<A;w+=8){const x=e[w],S=e[w+1],I=e[w+2],M=e[w+3],B=h.createElement("rect"),Q=(I-t)/l,U=(i-S)/c,O=(x-I)/l,G=(S-M)/c;B.setAttribute("x",Q),B.setAttribute("y",U),B.setAttribute("width",O),B.setAttribute("height",G),f.append(B),o?.push(`<rect vector-effect="non-scaling-stroke" x="${Q}" y="${U}" width="${O}" height="${G}"/>`)}this.#t&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(d),this.container.style.clipPath=`url(#${y})`}_createPopup(){const{data:e}=this,t=this.#s=new Yf({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]});this.parent.div.append(t.render())}render(){Ht("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const s=[];if(this._fieldObjects){const n=this._fieldObjects[e];if(n)for(const{page:i,id:a,exportValues:o}of n){if(i===-1||a===t)continue;const l=typeof o=="string"?o:null,c=document.querySelector(`[data-element-id="${a}"]`);if(c&&!Pa.has(c)){vt(`_getElementsByName - element not allowed: ${a}`);continue}s.push({id:a,exportValue:l,domElement:c})}return s}for(const n of document.getElementsByName(e)){const{exportValue:i}=n,a=n.getAttribute("data-element-id");a!==t&&Pa.has(n)&&s.push({id:a,exportValue:i,domElement:n})}return s}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}}class rb extends vs{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,s=document.createElement("a");s.setAttribute("data-element-id",e.id);let n=!1;return e.url?(t.addLinkAttributes(s,e.url,e.newWindow),n=!0):e.action?(this._bindNamedAction(s,e.action),n=!0):e.attachment?(this.#t(s,e.attachment,e.attachmentDest),n=!0):e.setOCGState?(this.#s(s,e.setOCGState),n=!0):e.dest?(this._bindLink(s,e.dest),n=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,e),n=!0),e.resetForm?(this._bindResetFormAction(s,e.resetForm),n=!0):this.isTooltipOnly&&!n&&(this._bindLink(s,""),n=!0)),this.container.classList.add("linkAnnotation"),n&&this.container.append(s),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e()}_bindNamedAction(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),this.#e()}#t(e,t,s=null){e.href=this.linkService.getAnchorUrl(""),t.description&&(e.title=t.description),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,s),!1),this.#e()}#s(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const n of Object.keys(t.actions)){const i=s.get(n);i&&(e[i]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:n}}),!1))}e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){const s=e.onclick;if(s||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){vt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(e.onclick=()=>!1);return}e.onclick=()=>{s?.();const{fields:n,refs:i,include:a}=t,o=[];if(n.length!==0||i.length!==0){const h=new Set(i);for(const d of n){const p=this._fieldObjects[d]||[];for(const{id:f}of p)h.add(f)}for(const d of Object.values(this._fieldObjects))for(const p of d)h.has(p.id)===a&&o.push(p)}else for(const h of Object.values(this._fieldObjects))o.push(...h);const l=this.annotationStorage,c=[];for(const h of o){const{id:d}=h;switch(c.push(d),h.type){case"text":{const f=h.defaultValue||"";l.setValue(d,{value:f});break}case"checkbox":case"radiobutton":{const f=h.defaultValue===h.exportValues;l.setValue(d,{value:f});break}case"combobox":case"listbox":{const f=h.defaultValue||"";l.setValue(d,{value:f});break}default:continue}const p=document.querySelector(`[data-element-id="${d}"]`);if(p){if(!Pa.has(p)){vt(`_bindResetFormAction - element not allowed: ${d}`);continue}}else continue;p.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:c,name:"ResetForm"}}),!1}}}class YS extends vs{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Fa extends vs{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return un.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,n,i){s.includes("mouse")?e.addEventListener(s,a=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:i(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(s,a=>{if(s==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(s==="focus"){if(t.focused)return;t.focused=!0}i&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:i(a)}})})}_setEventListeners(e,t,s,n){for(const[i,a]of s)(a==="Action"||this.data.actions?.[a])&&((a==="Focus"||a==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,i,a,n),a==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):a==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":He.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,n=this.data.defaultAppearanceData.fontSize||GS,i=e.style;let a;const o=2,l=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o),h=Math.round(c/(cf*n))||1,d=c/h;a=Math.min(n,l(d/cf))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(n,l(c/cf))}i.fontSize=`calc(${a}px * var(--scale-factor))`,i.color=He.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(i.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class KS extends Fa{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,s,n){const i=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=s),i.setValue(a.id,{[n]:s})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const n=e.getValue(t,{value:this.data.fieldValue});let i=n.value||"";const a=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;a&&i.length>a&&(i=i.slice(0,a));let o=n.formattedValue||this.data.textContent?.join(`
`)||null;o&&this.data.comb&&(o=o.replaceAll(/\s+/g,""));const l={userValue:i,formattedValue:o,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=o??i,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type="text",s.setAttribute("value",o??i),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),Pa.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=Uc,this._setRequired(s,this.data.required),a&&(s.maxLength=a),s.addEventListener("input",h=>{e.setValue(t,{value:h.target.value}),this.setPropertyOnSiblings(s,"value",h.target.value,"value"),l.formattedValue=null}),s.addEventListener("resetform",h=>{const d=this.data.defaultFieldValue??"";s.value=l.userValue=d,l.formattedValue=null});let c=h=>{const{formattedValue:d}=l;d!=null&&(h.target.value=d),h.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",d=>{if(l.focused)return;const{target:p}=d;l.userValue&&(p.value=l.userValue),l.lastCommittedValue=p.value,l.commitKey=1,this.data.actions?.Focus||(l.focused=!0)}),s.addEventListener("updatefromsandbox",d=>{this.showElementAndHideCanvas(d.target);const p={value(f){l.userValue=f.detail.value??"",e.setValue(t,{value:l.userValue.toString()}),f.target.value=l.userValue},formattedValue(f){const{formattedValue:y}=f.detail;l.formattedValue=y,y!=null&&f.target!==document.activeElement&&(f.target.value=y),e.setValue(t,{formattedValue:y})},selRange(f){f.target.setSelectionRange(...f.detail.selRange)},charLimit:f=>{const{charLimit:y}=f.detail,{target:w}=f;if(y===0){w.removeAttribute("maxLength");return}w.setAttribute("maxLength",y);let A=l.userValue;!A||A.length<=y||(A=A.slice(0,y),w.value=l.userValue=A,e.setValue(t,{value:A}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:A,willCommit:!0,commitKey:1,selStart:w.selectionStart,selEnd:w.selectionEnd}}))}};this._dispatchEventFromSandbox(p,d)}),s.addEventListener("keydown",d=>{l.commitKey=1;let p=-1;if(d.key==="Escape"?p=0:d.key==="Enter"&&!this.data.multiLine?p=2:d.key==="Tab"&&(l.commitKey=3),p===-1)return;const{value:f}=d.target;l.lastCommittedValue!==f&&(l.lastCommittedValue=f,l.userValue=f,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:f,willCommit:!0,commitKey:p,selStart:d.target.selectionStart,selEnd:d.target.selectionEnd}}))});const h=c;c=null,s.addEventListener("blur",d=>{if(!l.focused||!d.relatedTarget)return;this.data.actions?.Blur||(l.focused=!1);const{value:p}=d.target;l.userValue=p,l.lastCommittedValue!==p&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:p,willCommit:!0,commitKey:l.commitKey,selStart:d.target.selectionStart,selEnd:d.target.selectionEnd}}),h(d)}),this.data.actions?.Keystroke&&s.addEventListener("beforeinput",d=>{l.lastCommittedValue=null;const{data:p,target:f}=d,{value:y,selectionStart:w,selectionEnd:A}=f;let x=w,S=A;switch(d.inputType){case"deleteWordBackward":{const I=y.substring(0,w).match(/\w*[^\w]*$/);I&&(x-=I[0].length);break}case"deleteWordForward":{const I=y.substring(w).match(/^[^\w]*\w*/);I&&(S+=I[0].length);break}case"deleteContentBackward":w===A&&(x-=1);break;case"deleteContentForward":w===A&&(S+=1);break}d.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:y,change:p||"",willCommit:!1,selStart:x,selEnd:S}})}),this._setEventListeners(s,l,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],d=>d.target.value)}if(c&&s.addEventListener("blur",c),this.data.comb){const d=(this.data.rect[2]-this.data.rect[0])/a;s.classList.add("comb"),s.style.letterSpacing=`calc(${d}px * var(--scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class JS extends Fa{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class ZS extends Fa{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let n=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;typeof n=="string"&&(n=n!=="Off",e.setValue(s,{value:n})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const i=document.createElement("input");return Pa.add(i),i.setAttribute("data-element-id",s),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="checkbox",i.name=t.fieldName,n&&i.setAttribute("checked",!0),i.setAttribute("exportValue",t.exportValue),i.tabIndex=Uc,i.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,s)){const h=l&&c.exportValue===t.exportValue;c.domElement&&(c.domElement.checked=h),e.setValue(c.id,{value:h})}e.setValue(s,{value:l})}),i.addEventListener("resetform",a=>{const o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(i.addEventListener("updatefromsandbox",a=>{const o={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(s,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class ib extends Fa{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let n=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if(typeof n=="string"&&(n=n!==t.buttonValue,e.setValue(s,{value:n})),n)for(const a of this._getElementsByName(t.fieldName,s))e.setValue(a.id,{value:!1});const i=document.createElement("input");if(Pa.add(i),i.setAttribute("data-element-id",s),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="radio",i.name=t.fieldName,n&&i.setAttribute("checked",!0),i.tabIndex=Uc,i.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,s))e.setValue(c.id,{value:!1});e.setValue(s,{value:l})}),i.addEventListener("resetform",a=>{const o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;i.addEventListener("updatefromsandbox",o=>{const l={value:c=>{const h=a===c.detail.value;for(const d of this._getElementsByName(c.target.name)){const p=h&&d.id===s;d.domElement&&(d.domElement.checked=p),e.setValue(d.id,{value:p})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class QS extends rb{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),e}}class e3 extends Fa{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),n=document.createElement("select");Pa.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,this._setRequired(n,this.data.required),n.name=this.data.fieldName,n.tabIndex=Uc;let i=this.data.combo&&this.data.options.length>0;this.data.combo||(n.size=this.data.options.length,this.data.multiSelect&&(n.multiple=!0)),n.addEventListener("resetform",h=>{const d=this.data.defaultFieldValue;for(const p of n.options)p.selected=p.value===d});for(const h of this.data.options){const d=document.createElement("option");d.textContent=h.displayValue,d.value=h.exportValue,s.value.includes(h.exportValue)&&(d.setAttribute("selected",!0),i=!1),n.append(d)}let a=null;if(i){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),n.prepend(h),a=()=>{h.remove(),n.removeEventListener("input",a),a=null},n.addEventListener("input",a)}const o=h=>{const d=h?"value":"textContent",{options:p,multiple:f}=n;return f?Array.prototype.filter.call(p,y=>y.selected).map(y=>y[d]):p.selectedIndex===-1?null:p[p.selectedIndex][d]};let l=o(!1);const c=h=>{const d=h.target.options;return Array.prototype.map.call(d,p=>({displayValue:p.textContent,exportValue:p.value}))};return this.enableScripting&&this.hasJSActions?(n.addEventListener("updatefromsandbox",h=>{const d={value(p){a?.();const f=p.detail.value,y=new Set(Array.isArray(f)?f:[f]);for(const w of n.options)w.selected=y.has(w.value);e.setValue(t,{value:o(!0)}),l=o(!1)},multipleSelection(p){n.multiple=!0},remove(p){const f=n.options,y=p.detail.remove;f[y].selected=!1,n.remove(y),f.length>0&&Array.prototype.findIndex.call(f,A=>A.selected)===-1&&(f[0].selected=!0),e.setValue(t,{value:o(!0),items:c(p)}),l=o(!1)},clear(p){for(;n.length!==0;)n.remove(0);e.setValue(t,{value:null,items:[]}),l=o(!1)},insert(p){const{index:f,displayValue:y,exportValue:w}=p.detail.insert,A=n.children[f],x=document.createElement("option");x.textContent=y,x.value=w,A?A.before(x):n.append(x),e.setValue(t,{value:o(!0),items:c(p)}),l=o(!1)},items(p){const{items:f}=p.detail;for(;n.length!==0;)n.remove(0);for(const y of f){const{displayValue:w,exportValue:A}=y,x=document.createElement("option");x.textContent=w,x.value=A,n.append(x)}n.options.length>0&&(n.options[0].selected=!0),e.setValue(t,{value:o(!0),items:c(p)}),l=o(!1)},indices(p){const f=new Set(p.detail.indices);for(const y of p.target.options)y.selected=f.has(y.index);e.setValue(t,{value:o(!0)}),l=o(!1)},editable(p){p.target.disabled=!p.detail.editable}};this._dispatchEventFromSandbox(d,h)}),n.addEventListener("input",h=>{const d=o(!0),p=o(!1);e.setValue(t,{value:d}),h.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:p,changeEx:d,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(n,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):n.addEventListener("input",function(h){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class Yf extends vs{constructor(e){const{data:t,elements:s}=e;super(e,{isRenderable:vs._hasPopupData(t)}),this.elements=s,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new t3({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const s of this.elements)s.popup=e,s.container.ariaHasPopup="dialog",t.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(s=>`${Dp}${s}`).join(",")),this.container}}class t3{#e=this.#E.bind(this);#t=this.#k.bind(this);#s=this.#P.bind(this);#n=this.#_.bind(this);#i=null;#r=null;#c=null;#o=null;#h=null;#l=null;#u=null;#a=!1;#d=null;#f=null;#p=null;#g=null;#m=null;#b=null;#v=!1;constructor({container:e,color:t,elements:s,titleObj:n,modificationDate:i,contentsObj:a,richText:o,parent:l,rect:c,parentRect:h,open:d}){this.#r=e,this.#m=n,this.#c=a,this.#g=o,this.#l=l,this.#i=t,this.#p=c,this.#u=h,this.#h=s,this.#o=B1.toDateObject(i),this.trigger=s.flatMap(p=>p.getElementsToTriggerPopup());for(const p of this.trigger)p.addEventListener("click",this.#n),p.addEventListener("mouseenter",this.#s),p.addEventListener("mouseleave",this.#t),p.classList.add("popupTriggerArea");for(const p of s)p.container?.addEventListener("keydown",this.#e);this.#r.hidden=!0,d&&this.#_()}render(){if(this.#d)return;const e=this.#d=document.createElement("div");if(e.className="popup",this.#i){const i=e.style.outlineColor=He.makeHexColor(...this.#i);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`:e.style.backgroundColor=He.makeHexColor(...this.#i.map(o=>Math.floor(.7*(255-o)+o)))}const t=document.createElement("span");t.className="header";const s=document.createElement("h1");if(t.append(s),{dir:s.dir,str:s.textContent}=this.#m,e.append(t),this.#o){const i=document.createElement("span");i.classList.add("popupDate"),i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#o.valueOf()})),t.append(i)}const n=this.#w;if(n)nb.render({xfaHtml:n,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const i=this._formatContents(this.#c);e.append(i)}this.#r.append(e)}get#w(){const e=this.#g,t=this.#c;return e?.str&&(!t?.str||t.str===e.str)&&this.#g.html||null}get#x(){return this.#w?.attributes?.style?.fontSize||0}get#S(){return this.#w?.attributes?.style?.color||null}#N(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},n={style:{color:this.#S,fontSize:this.#x?`calc(${this.#x}px * var(--scale-factor))`:""}};for(const i of e.split(`
`))t.push({name:"span",value:i,attributes:n});return s}_formatContents({str:e,dir:t}){const s=document.createElement("p");s.classList.add("popupContent"),s.dir=t;const n=e.split(/(?:\r\n?|\n)/);for(let i=0,a=n.length;i<a;++i){const o=n[i];s.append(document.createTextNode(o)),i<a-1&&s.append(document.createElement("br"))}return s}#E(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#a)&&this.#_()}updateEdited({rect:e,popupContent:t}){this.#b||={contentsObj:this.#c,richText:this.#g},e&&(this.#f=null),t&&(this.#g=this.#N(t),this.#c=null),this.#d?.remove(),this.#d=null}resetEdited(){this.#b&&({contentsObj:this.#c,richText:this.#g}=this.#b,this.#b=null,this.#d?.remove(),this.#d=null,this.#f=null)}#C(){if(this.#f!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:n,pageY:i}}}=this.#l;let a=!!this.#u,o=a?this.#u:this.#p;for(const y of this.#h)if(!o||He.intersect(y.data.rect,o)!==null){o=y.data.rect,a=!0;break}const l=He.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),h=a?o[2]-o[0]+5:0,d=l[0]+h,p=l[1];this.#f=[100*(d-n)/t,100*(p-i)/s];const{style:f}=this.#r;f.left=`${this.#f[0]}%`,f.top=`${this.#f[1]}%`}#_(){this.#a=!this.#a,this.#a?(this.#P(),this.#r.addEventListener("click",this.#n),this.#r.addEventListener("keydown",this.#e)):(this.#k(),this.#r.removeEventListener("click",this.#n),this.#r.removeEventListener("keydown",this.#e))}#P(){this.#d||this.render(),this.isVisible?this.#a&&this.#r.classList.add("focused"):(this.#C(),this.#r.hidden=!1,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)+1e3)}#k(){this.#r.classList.remove("focused"),!(this.#a||!this.isVisible)&&(this.#r.hidden=!0,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)-1e3)}forceHide(){this.#v=this.isVisible,this.#v&&(this.#r.hidden=!0)}maybeShow(){this.#v&&(this.#d||this.#P(),this.#v=!1,this.#r.hidden=!1)}get isVisible(){return this.#r.hidden===!1}}class ab extends vs{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=pt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class s3 extends vs{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:t,height:s}=Wi(e.rect),n=this.svgFactory.create(t,s,!0),i=this.#e=this.svgFactory.createElement("svg:line");return i.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),i.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),i.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),i.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),i.setAttribute("stroke-width",e.borderStyle.width||1),i.setAttribute("stroke","transparent"),i.setAttribute("fill","transparent"),n.append(i),this.container.append(n),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class n3 extends vs{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:t,height:s}=Wi(e.rect),n=this.svgFactory.create(t,s,!0),i=e.borderStyle.width,a=this.#e=this.svgFactory.createElement("svg:rect");return a.setAttribute("x",i/2),a.setAttribute("y",i/2),a.setAttribute("width",t-i),a.setAttribute("height",s-i),a.setAttribute("stroke-width",i||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),n.append(a),this.container.append(n),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class r3 extends vs{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:t,height:s}=Wi(e.rect),n=this.svgFactory.create(t,s,!0),i=e.borderStyle.width,a=this.#e=this.svgFactory.createElement("svg:ellipse");return a.setAttribute("cx",t/2),a.setAttribute("cy",s/2),a.setAttribute("rx",t/2-i/2),a.setAttribute("ry",s/2-i/2),a.setAttribute("stroke-width",i||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),n.append(a),this.container.append(n),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class ob extends vs{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:s,popupRef:n}}=this;if(!t)return this.container;const{width:i,height:a}=Wi(e),o=this.svgFactory.create(i,a,!0);let l=[];for(let h=0,d=t.length;h<d;h+=2){const p=t[h]-e[0],f=e[3]-t[h+1];l.push(`${p},${f}`)}l=l.join(" ");const c=this.#e=this.svgFactory.createElement(this.svgElementName);return c.setAttribute("points",l),c.setAttribute("stroke-width",s.width||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),o.append(c),this.container.append(o),!n&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class i3 extends ob{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class a3 extends vs{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Yp extends vs{#e=null;#t=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?pt.HIGHLIGHT:pt.INK}#s(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:s,borderStyle:n,popupRef:i}}=this,{transform:a,width:o,height:l}=this.#s(t,e),c=this.svgFactory.create(o,l,!0),h=this.#e=this.svgFactory.createElement("svg:g");c.append(h),h.setAttribute("stroke-width",n.width||1),h.setAttribute("stroke-linecap","round"),h.setAttribute("stroke-linejoin","round"),h.setAttribute("stroke-miterlimit",10),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),h.setAttribute("transform",a);for(let d=0,p=s.length;d<p;d++){const f=this.svgFactory.createElement(this.svgElementName);this.#t.push(f),f.setAttribute("points",s[d].join(",")),h.append(f)}return!i&&this.hasPopupData&&this._createPopup(),this.container.append(c),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:s,rect:n}=e,i=this.#e;if(t>=0&&i.setAttribute("stroke-width",t||1),s)for(let a=0,o=this.#t.length;a<o;a++)this.#t[a].setAttribute("points",s[a].join(","));if(n){const{transform:a,width:o,height:l}=this.#s(this.data.rotation,n);i.parentElement.setAttribute("viewBox",`0 0 ${o} ${l}`),i.setAttribute("transform",a)}}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class lb extends vs{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=pt.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class o3 extends vs{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class l3 extends vs{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class c3 extends vs{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class cb extends vs{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=pt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class h3 extends vs{#e=null;constructor(e){super(e,{isRenderable:!0});const{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...t})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let s;t.hasAppearance||t.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),s.addEventListener("dblclick",this.#t.bind(this)),this.#e=s;const{isMac:n}=un.platform;return e.addEventListener("keydown",i=>{i.key==="Enter"&&(n?i.metaKey:i.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),e.append(s),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class u3{#e=null;#t=null;#s=new Map;#n=null;constructor({div:e,accessibilityManager:t,annotationCanvasMap:s,annotationEditorUIManager:n,page:i,viewport:a,structTreeLayer:o}){this.div=e,this.#e=t,this.#t=s,this.#n=o||null,this.page=i,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=n}hasEditableAnnotations(){return this.#s.size>0}async#i(e,t){const s=e.firstChild||e,n=s.id=`${Dp}${t}`,i=await this.#n?.getAriaAttributes(n);if(i)for(const[a,o]of i)s.setAttribute(a,o);this.div.append(e),this.#e?.moveElementInDOM(this.div,e,s,!1)}async render(e){const{annotations:t}=e,s=this.div;Ca(s,this.viewport);const n=new Map,i={data:null,layer:s,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new Xp,annotationStorage:e.annotationStorage||new Hp,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const a of t){if(a.noHTML)continue;const o=a.annotationType===Ls.POPUP;if(o){const h=n.get(a.id);if(!h)continue;i.elements=h}else{const{width:h,height:d}=Wi(a.rect);if(h<=0||d<=0)continue}i.data=a;const l=XS.create(i);if(!l.isRenderable)continue;if(!o&&a.popupRef){const h=n.get(a.popupRef);h?h.push(l):n.set(a.popupRef,[l])}const c=l.render();a.hidden&&(c.style.visibility="hidden"),await this.#i(c,a.id),l._isEditable&&(this.#s.set(l.data.id,l),this._annotationEditorUIManager?.renderAnnotationElement(l))}this.#r()}update({viewport:e}){const t=this.div;this.viewport=e,Ca(t,{rotation:e.rotation}),this.#r(),t.hidden=!1}#r(){if(!this.#t)return;const e=this.div;for(const[t,s]of this.#t){const n=e.querySelector(`[data-annotation-id="${t}"]`);if(!n)continue;s.className="annotationContent";const{firstChild:i}=n;i?i.nodeName==="CANVAS"?i.replaceWith(s):i.classList.contains("annotationContent")?i.after(s):i.before(s):n.append(s)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#s.values())}getEditableAnnotation(e){return this.#s.get(e)}}const Xh=/\r\n?|\n/g;class Ts extends bt{#e;#t="";#s=`${this.id}-editor`;#n=null;#i;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=Ts.prototype,t=i=>i.isEmpty(),s=Gi.TRANSLATE_SMALL,n=Gi.TRANSLATE_BIG;return xt(this,"_keyboardManager",new qc([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[n,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,n],checker:t}]]))}static _type="freetext";static _editorType=pt.FREETEXT;constructor(e){super({...e,name:"freeTextEditor"}),this.#e=e.color||Ts._defaultColor||bt._defaultLineColor,this.#i=e.fontSize||Ts._defaultFontSize}static initialize(e,t){bt.initialize(e,t);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case Nt.FREETEXT_SIZE:Ts._defaultFontSize=t;break;case Nt.FREETEXT_COLOR:Ts._defaultColor=t;break}}updateParams(e,t){switch(e){case Nt.FREETEXT_SIZE:this.#r(t);break;case Nt.FREETEXT_COLOR:this.#c(t);break}}static get defaultPropertiesToUpdate(){return[[Nt.FREETEXT_SIZE,Ts._defaultFontSize],[Nt.FREETEXT_COLOR,Ts._defaultColor||bt._defaultLineColor]]}get propertiesToUpdate(){return[[Nt.FREETEXT_SIZE,this.#i],[Nt.FREETEXT_COLOR,this.#e]]}#r(e){const t=n=>{this.editorDiv.style.fontSize=`calc(${n}px * var(--scale-factor))`,this.translate(0,-(n-this.#i)*this.parentScale),this.#i=n,this.#h()},s=this.#i;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Nt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#c(e){const t=n=>{this.#e=this.editorDiv.style.color=n},s=this.#e;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Nt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-Ts._internalPadding*e,-(Ts._internalPadding+this.#i)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(pt.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#n=new AbortController;const e=this._uiManager.combinedSignal(this.#n);this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#s),this._isDraggable=!0,this.#n?.abort(),this.#n=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#o(){const e=[];this.editorDiv.normalize();let t=null;for(const s of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&s.nodeName==="BR"||(e.push(Ts.#l(s)),t=s);return e.join(`
`)}#h(){const[e,t]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:n,div:i}=this,a=i.style.display,o=i.classList.contains("hidden");i.classList.remove("hidden"),i.style.display="hidden",n.div.append(this.div),s=i.getBoundingClientRect(),i.remove(),i.style.display=a,i.classList.toggle("hidden",o)}this.rotation%180===this.parentRotation%180?(this.width=s.width/e,this.height=s.height/t):(this.width=s.height/e,this.height=s.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#t,t=this.#t=this.#o().trimEnd();if(e===t)return;const s=n=>{if(this.#t=n,!n){this.remove();return}this.#u(),this._uiManager.rebuild(this),this.#h()};this.addCommands({cmd:()=>{s(t)},undo:()=>{s(e)},mustExec:!1}),this.#h()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){Ts._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#s),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${this.#i}px * var(--scale-factor))`,s.color=this.#e,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Au(this,this.div,["dblclick","keydown"]),this.width){const[n,i]=this.parentDimensions;if(this.annotationElementId){const{position:a}=this._initialData;let[o,l]=this.getInitialTranslation();[o,l]=this.pageTranslationToScreen(o,l);const[c,h]=this.pageDimensions,[d,p]=this.pageTranslation;let f,y;switch(this.rotation){case 0:f=e+(a[0]-d)/c,y=t+this.height-(a[1]-p)/h;break;case 90:f=e+(a[0]-d)/c,y=t-(a[1]-p)/h,[o,l]=[l,-o];break;case 180:f=e-this.width+(a[0]-d)/c,y=t-(a[1]-p)/h,[o,l]=[-o,-l];break;case 270:f=e+(a[0]-d-this.height*h)/c,y=t+(a[1]-p-this.width*c)/h,[o,l]=[-l,o];break}this.setAt(f*n,y*i,o,l)}else this.setAt(e*n,t*i,this.width*n,this.height*i);this.#u(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#l(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(Xh,"")}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:s}=t;if(s.length===1&&s[0]==="text/plain")return;e.preventDefault();const n=Ts.#d(t.getData("text")||"").replaceAll(Xh,`
`);if(!n)return;const i=window.getSelection();if(!i.rangeCount)return;this.editorDiv.normalize(),i.deleteFromDocument();const a=i.getRangeAt(0);if(!n.includes(`
`)){a.insertNode(document.createTextNode(n)),this.editorDiv.normalize(),i.collapseToStart();return}const{startContainer:o,startOffset:l}=a,c=[],h=[];if(o.nodeType===Node.TEXT_NODE){const f=o.parentElement;if(h.push(o.nodeValue.slice(l).replaceAll(Xh,"")),f!==this.editorDiv){let y=c;for(const w of this.editorDiv.childNodes){if(w===f){y=h;continue}y.push(Ts.#l(w))}}c.push(o.nodeValue.slice(0,l).replaceAll(Xh,""))}else if(o===this.editorDiv){let f=c,y=0;for(const w of this.editorDiv.childNodes)y++===l&&(f=h),f.push(Ts.#l(w))}this.#t=`${c.join(`
`)}${n}${h.join(`
`)}`,this.#u();const d=new Range;let p=c.reduce((f,y)=>f+y.length,0);for(const{firstChild:f}of this.editorDiv.childNodes)if(f.nodeType===Node.TEXT_NODE){const y=f.nodeValue.length;if(p<=y){d.setStart(f,p),d.setEnd(f,p);break}p-=y}i.removeAllRanges(),i.addRange(d)}#u(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const e of this.#t.split(`
`)){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#a(){return this.#t.replaceAll(" "," ")}static#d(e){return e.replaceAll(" "," ")}get contentDiv(){return this.editorDiv}static async deserialize(e,t,s){let n=null;if(e instanceof ab){const{data:{defaultAppearanceData:{fontSize:a,fontColor:o},rect:l,rotation:c,id:h,popupRef:d},textContent:p,textPosition:f,parent:{page:{pageNumber:y}}}=e;if(!p||p.length===0)return null;n=e={annotationType:pt.FREETEXT,color:Array.from(o),fontSize:a,value:p.join(`
`),position:f,pageIndex:y-1,rect:l.slice(0),rotation:c,id:h,deleted:!1,popupRef:d}}const i=await super.deserialize(e,t,s);return i.#i=e.fontSize,i.#e=He.makeHexColor(...e.color),i.#t=Ts.#d(e.value),i.annotationElementId=e.id||null,i._initialData=n,i}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=Ts._internalPadding*this.parentScale,s=this.getRect(t,t),n=bt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#e),i={annotationType:pt.FREETEXT,color:n,fontSize:this.#i,value:this.#a(),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?i:this.annotationElementId&&!this.#f(i)?null:(i.id=this.annotationElementId,i)}#f(e){const{value:t,fontSize:s,color:n,pageIndex:i}=this._initialData;return this._hasBeenMoved||e.value!==t||e.fontSize!==s||e.color.some((a,o)=>a!==n[o])||e.pageIndex!==i}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(this.deleted)return t;const{style:s}=t;s.fontSize=`calc(${this.#i}px * var(--scale-factor))`,s.color=this.#e,t.replaceChildren();for(const i of this.#t.split(`
`)){const a=document.createElement("div");a.append(i?document.createTextNode(i):document.createElement("br")),t.append(a)}const n=Ts._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(n,n),popupContent:this.#t}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}class $e{static PRECISION=1e-4;toSVGPath(){Ht("Abstract method `toSVGPath` must be implemented.")}get box(){Ht("Abstract getter `box` must be implemented.")}serialize(e,t){Ht("Abstract method `serialize` must be implemented.")}static _rescale(e,t,s,n,i,a){a||=new Float32Array(e.length);for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o]*n,a[o+1]=s+e[o+1]*i;return a}static _rescaleAndSwap(e,t,s,n,i,a){a||=new Float32Array(e.length);for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o+1]*n,a[o+1]=s+e[o]*i;return a}static _translate(e,t,s,n){n||=new Float32Array(e.length);for(let i=0,a=e.length;i<a;i+=2)n[i]=t+e[i],n[i+1]=s+e[i+1];return n}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,s,n,i){switch(i){case 90:return[1-t/s,e/n];case 180:return[1-e/s,1-t/n];case 270:return[t/s,1-e/n];default:return[e/s,t/n]}}static _normalizePagePoint(e,t,s){switch(s){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,s,n,i,a){return[(e+5*s)/6,(t+5*n)/6,(5*s+i)/6,(5*n+a)/6,(s+i)/2,(n+a)/2]}}class Aa{#e;#t=[];#s;#n;#i=[];#r=new Float32Array(18);#c;#o;#h;#l;#u;#a;#d=[];static#f=8;static#p=2;static#g=Aa.#f+Aa.#p;constructor({x:e,y:t},s,n,i,a,o=0){this.#e=s,this.#a=i*n,this.#n=a,this.#r.set([NaN,NaN,NaN,NaN,e,t],6),this.#s=o,this.#l=Aa.#f*n,this.#h=Aa.#g*n,this.#u=n,this.#d.push(e,t)}isEmpty(){return isNaN(this.#r[8])}#m(){const e=this.#r.subarray(4,6),t=this.#r.subarray(16,18),[s,n,i,a]=this.#e;return[(this.#c+(e[0]-t[0])/2-s)/i,(this.#o+(e[1]-t[1])/2-n)/a,(this.#c+(t[0]-e[0])/2-s)/i,(this.#o+(t[1]-e[1])/2-n)/a]}add({x:e,y:t}){this.#c=e,this.#o=t;const[s,n,i,a]=this.#e;let[o,l,c,h]=this.#r.subarray(8,12);const d=e-c,p=t-h,f=Math.hypot(d,p);if(f<this.#h)return!1;const y=f-this.#l,w=y/f,A=w*d,x=w*p;let S=o,I=l;o=c,l=h,c+=A,h+=x,this.#d?.push(e,t);const M=-x/y,B=A/y,Q=M*this.#a,U=B*this.#a;return this.#r.set(this.#r.subarray(2,8),0),this.#r.set([c+Q,h+U],4),this.#r.set(this.#r.subarray(14,18),12),this.#r.set([c-Q,h-U],16),isNaN(this.#r[6])?(this.#i.length===0&&(this.#r.set([o+Q,l+U],2),this.#i.push(NaN,NaN,NaN,NaN,(o+Q-s)/i,(l+U-n)/a),this.#r.set([o-Q,l-U],14),this.#t.push(NaN,NaN,NaN,NaN,(o-Q-s)/i,(l-U-n)/a)),this.#r.set([S,I,o,l,c,h],6),!this.isEmpty()):(this.#r.set([S,I,o,l,c,h],6),Math.abs(Math.atan2(I-l,S-o)-Math.atan2(x,A))<Math.PI/2?([o,l,c,h]=this.#r.subarray(2,6),this.#i.push(NaN,NaN,NaN,NaN,((o+c)/2-s)/i,((l+h)/2-n)/a),[o,l,S,I]=this.#r.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,((S+o)/2-s)/i,((I+l)/2-n)/a),!0):([S,I,o,l,c,h]=this.#r.subarray(0,6),this.#i.push(((S+5*o)/6-s)/i,((I+5*l)/6-n)/a,((5*o+c)/6-s)/i,((5*l+h)/6-n)/a,((o+c)/2-s)/i,((l+h)/2-n)/a),[c,h,o,l,S,I]=this.#r.subarray(12,18),this.#t.push(((S+5*o)/6-s)/i,((I+5*l)/6-n)/a,((5*o+c)/6-s)/i,((5*l+h)/6-n)/a,((o+c)/2-s)/i,((l+h)/2-n)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=this.#i,t=this.#t;if(isNaN(this.#r[6])&&!this.isEmpty())return this.#b();const s=[];s.push(`M${e[4]} ${e[5]}`);for(let n=6;n<e.length;n+=6)isNaN(e[n])?s.push(`L${e[n+4]} ${e[n+5]}`):s.push(`C${e[n]} ${e[n+1]} ${e[n+2]} ${e[n+3]} ${e[n+4]} ${e[n+5]}`);this.#w(s);for(let n=t.length-6;n>=6;n-=6)isNaN(t[n])?s.push(`L${t[n+4]} ${t[n+5]}`):s.push(`C${t[n]} ${t[n+1]} ${t[n+2]} ${t[n+3]} ${t[n+4]} ${t[n+5]}`);return this.#v(s),s.join(" ")}#b(){const[e,t,s,n]=this.#e,[i,a,o,l]=this.#m();return`M${(this.#r[2]-e)/s} ${(this.#r[3]-t)/n} L${(this.#r[4]-e)/s} ${(this.#r[5]-t)/n} L${i} ${a} L${o} ${l} L${(this.#r[16]-e)/s} ${(this.#r[17]-t)/n} L${(this.#r[14]-e)/s} ${(this.#r[15]-t)/n} Z`}#v(e){const t=this.#t;e.push(`L${t[4]} ${t[5]} Z`)}#w(e){const[t,s,n,i]=this.#e,a=this.#r.subarray(4,6),o=this.#r.subarray(16,18),[l,c,h,d]=this.#m();e.push(`L${(a[0]-t)/n} ${(a[1]-s)/i} L${l} ${c} L${h} ${d} L${(o[0]-t)/n} ${(o[1]-s)/i}`)}newFreeDrawOutline(e,t,s,n,i,a){return new hb(e,t,s,n,i,a)}getOutlines(){const e=this.#i,t=this.#t,s=this.#r,[n,i,a,o]=this.#e,l=new Float32Array((this.#d?.length??0)+2);for(let d=0,p=l.length-2;d<p;d+=2)l[d]=(this.#d[d]-n)/a,l[d+1]=(this.#d[d+1]-i)/o;if(l[l.length-2]=(this.#c-n)/a,l[l.length-1]=(this.#o-i)/o,isNaN(s[6])&&!this.isEmpty())return this.#x(l);const c=new Float32Array(this.#i.length+24+this.#t.length);let h=e.length;for(let d=0;d<h;d+=2){if(isNaN(e[d])){c[d]=c[d+1]=NaN;continue}c[d]=e[d],c[d+1]=e[d+1]}h=this.#N(c,h);for(let d=t.length-6;d>=6;d-=6)for(let p=0;p<6;p+=2){if(isNaN(t[d+p])){c[h]=c[h+1]=NaN,h+=2;continue}c[h]=t[d+p],c[h+1]=t[d+p+1],h+=2}return this.#S(c,h),this.newFreeDrawOutline(c,l,this.#e,this.#u,this.#s,this.#n)}#x(e){const t=this.#r,[s,n,i,a]=this.#e,[o,l,c,h]=this.#m(),d=new Float32Array(36);return d.set([NaN,NaN,NaN,NaN,(t[2]-s)/i,(t[3]-n)/a,NaN,NaN,NaN,NaN,(t[4]-s)/i,(t[5]-n)/a,NaN,NaN,NaN,NaN,o,l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,(t[16]-s)/i,(t[17]-n)/a,NaN,NaN,NaN,NaN,(t[14]-s)/i,(t[15]-n)/a],0),this.newFreeDrawOutline(d,e,this.#e,this.#u,this.#s,this.#n)}#S(e,t){const s=this.#t;return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+=6}#N(e,t){const s=this.#r.subarray(4,6),n=this.#r.subarray(16,18),[i,a,o,l]=this.#e,[c,h,d,p]=this.#m();return e.set([NaN,NaN,NaN,NaN,(s[0]-i)/o,(s[1]-a)/l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,d,p,NaN,NaN,NaN,NaN,(n[0]-i)/o,(n[1]-a)/l],t),t+=24}}class hb extends $e{#e;#t=new Float32Array(4);#s;#n;#i;#r;#c;constructor(e,t,s,n,i,a){super(),this.#c=e,this.#i=t,this.#e=s,this.#r=n,this.#s=i,this.#n=a,this.lastPoint=[NaN,NaN],this.#o(a);const[o,l,c,h]=this.#t;for(let d=0,p=e.length;d<p;d+=2)e[d]=(e[d]-o)/c,e[d+1]=(e[d+1]-l)/h;for(let d=0,p=t.length;d<p;d+=2)t[d]=(t[d]-o)/c,t[d+1]=(t[d+1]-l)/h}toSVGPath(){const e=[`M${this.#c[4]} ${this.#c[5]}`];for(let t=6,s=this.#c.length;t<s;t+=6){if(isNaN(this.#c[t])){e.push(`L${this.#c[t+4]} ${this.#c[t+5]}`);continue}e.push(`C${this.#c[t]} ${this.#c[t+1]} ${this.#c[t+2]} ${this.#c[t+3]} ${this.#c[t+4]} ${this.#c[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,s,n],i){const a=s-e,o=n-t;let l,c;switch(i){case 0:l=$e._rescale(this.#c,e,n,a,-o),c=$e._rescale(this.#i,e,n,a,-o);break;case 90:l=$e._rescaleAndSwap(this.#c,e,t,a,o),c=$e._rescaleAndSwap(this.#i,e,t,a,o);break;case 180:l=$e._rescale(this.#c,s,t,-a,o),c=$e._rescale(this.#i,s,t,-a,o);break;case 270:l=$e._rescaleAndSwap(this.#c,s,n,-a,-o),c=$e._rescaleAndSwap(this.#i,s,n,-a,-o);break}return{outline:Array.from(l),points:[Array.from(c)]}}#o(e){const t=this.#c;let s=t[4],n=t[5],i=s,a=n,o=s,l=n,c=s,h=n;const d=e?Math.max:Math.min;for(let f=6,y=t.length;f<y;f+=6){if(isNaN(t[f]))i=Math.min(i,t[f+4]),a=Math.min(a,t[f+5]),o=Math.max(o,t[f+4]),l=Math.max(l,t[f+5]),h<t[f+5]?(c=t[f+4],h=t[f+5]):h===t[f+5]&&(c=d(c,t[f+4]));else{const w=He.bezierBoundingBox(s,n,...t.slice(f,f+6));i=Math.min(i,w[0]),a=Math.min(a,w[1]),o=Math.max(o,w[2]),l=Math.max(l,w[3]),h<w[3]?(c=w[2],h=w[3]):h===w[3]&&(c=d(c,w[2]))}s=t[f+4],n=t[f+5]}const p=this.#t;p[0]=i-this.#s,p[1]=a-this.#s,p[2]=o-i+2*this.#s,p[3]=l-a+2*this.#s,this.lastPoint=[c,h]}get box(){return this.#t}newOutliner(e,t,s,n,i,a=0){return new Aa(e,t,s,n,i,a)}getNewOutline(e,t){const[s,n,i,a]=this.#t,[o,l,c,h]=this.#e,d=i*c,p=a*h,f=s*c+o,y=n*h+l,w=this.newOutliner({x:this.#i[0]*d+f,y:this.#i[1]*p+y},this.#e,this.#r,e,this.#n,t??this.#s);for(let A=2;A<this.#i.length;A+=2)w.add({x:this.#i[A]*d+f,y:this.#i[A+1]*p+y});return w.getOutlines()}}class Kf{#e;#t;#s=[];#n=[];constructor(e,t=0,s=0,n=!0){let i=1/0,a=-1/0,o=1/0,l=-1/0;const h=10**-4;for(const{x,y:S,width:I,height:M}of e){const B=Math.floor((x-t)/h)*h,Q=Math.ceil((x+I+t)/h)*h,U=Math.floor((S-t)/h)*h,O=Math.ceil((S+M+t)/h)*h,G=[B,U,O,!0],ne=[Q,U,O,!1];this.#s.push(G,ne),i=Math.min(i,B),a=Math.max(a,Q),o=Math.min(o,U),l=Math.max(l,O)}const d=a-i+2*s,p=l-o+2*s,f=i-s,y=o-s,w=this.#s.at(n?-1:-2),A=[w[0],w[2]];for(const x of this.#s){const[S,I,M]=x;x[0]=(S-f)/d,x[1]=(I-y)/p,x[2]=(M-y)/p}this.#e=new Float32Array([f,y,d,p]),this.#t=A}getOutlines(){this.#s.sort((t,s)=>t[0]-s[0]||t[1]-s[1]||t[2]-s[2]);const e=[];for(const t of this.#s)t[3]?(e.push(...this.#h(t)),this.#c(t)):(this.#o(t),e.push(...this.#h(t)));return this.#i(e)}#i(e){const t=[],s=new Set;for(const a of e){const[o,l,c]=a;t.push([o,l,a],[o,c,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){const l=t[a][2],c=t[a+1][2];l.push(c),c.push(l),s.add(l),s.add(c)}const n=[];let i;for(;s.size>0;){const a=s.values().next().value;let[o,l,c,h,d]=a;s.delete(a);let p=o,f=l;for(i=[o,c],n.push(i);;){let y;if(s.has(h))y=h;else if(s.has(d))y=d;else break;s.delete(y),[o,l,c,h,d]=y,p!==o&&(i.push(p,f,o,f===l?l:c),p=o),f=f===l?c:l}i.push(p,f)}return new d3(n,this.#e,this.#t)}#r(e){const t=this.#n;let s=0,n=t.length-1;for(;s<=n;){const i=s+n>>1,a=t[i][0];if(a===e)return i;a<e?s=i+1:n=i-1}return n+1}#c([,e,t]){const s=this.#r(e);this.#n.splice(s,0,[e,t])}#o([,e,t]){const s=this.#r(e);for(let n=s;n<this.#n.length;n++){const[i,a]=this.#n[n];if(i!==e)break;if(i===e&&a===t){this.#n.splice(n,1);return}}for(let n=s-1;n>=0;n--){const[i,a]=this.#n[n];if(i!==e)break;if(i===e&&a===t){this.#n.splice(n,1);return}}}#h(e){const[t,s,n]=e,i=[[t,s,n]],a=this.#r(n);for(let o=0;o<a;o++){const[l,c]=this.#n[o];for(let h=0,d=i.length;h<d;h++){const[,p,f]=i[h];if(!(c<=p||f<=l)){if(p>=l){if(f>c)i[h][1]=c;else{if(d===1)return[];i.splice(h,1),h--,d--}continue}i[h][2]=l,f>c&&i.push([t,c,f])}}}return i}}class d3 extends $e{#e;#t;constructor(e,t,s){super(),this.#t=e,this.#e=t,this.lastPoint=s}toSVGPath(){const e=[];for(const t of this.#t){let[s,n]=t;e.push(`M${s} ${n}`);for(let i=2;i<t.length;i+=2){const a=t[i],o=t[i+1];a===s?(e.push(`V${o}`),n=o):o===n&&(e.push(`H${a}`),s=a)}e.push("Z")}return e.join(" ")}serialize([e,t,s,n],i){const a=[],o=s-e,l=n-t;for(const c of this.#t){const h=new Array(c.length);for(let d=0;d<c.length;d+=2)h[d]=e+c[d]*o,h[d+1]=n-c[d+1]*l;a.push(h)}return a}get box(){return this.#e}get classNamesForOutlining(){return["highlightOutline"]}}class Jf extends Aa{newFreeDrawOutline(e,t,s,n,i,a){return new f3(e,t,s,n,i,a)}}class f3 extends hb{newOutliner(e,t,s,n,i,a=0){return new Jf(e,t,s,n,i,a)}}class Yn{#e=null;#t=null;#s;#n=null;#i=!1;#r=!1;#c=null;#o;#h=null;#l=null;#u;static#a=null;static get _keyboardManager(){return xt(this,"_keyboardManager",new qc([[["Escape","mac+Escape"],Yn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Yn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Yn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Yn.prototype._moveToPrevious],[["Home","mac+Home"],Yn.prototype._moveToBeginning],[["End","mac+End"],Yn.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#r=!1,this.#u=Nt.HIGHLIGHT_COLOR,this.#c=e):(this.#r=!0,this.#u=Nt.HIGHLIGHT_DEFAULT_COLOR),this.#l=e?._uiManager||t,this.#o=this.#l._eventBus,this.#s=e?.color||this.#l?.highlightColors.values().next().value||"#FFFF98",Yn.#a||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const e=this.#e=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=this.#l._signal;e.addEventListener("click",this.#g.bind(this),{signal:t}),e.addEventListener("keydown",this.#p.bind(this),{signal:t});const s=this.#t=document.createElement("span");return s.className="swatch",s.setAttribute("aria-hidden",!0),s.style.backgroundColor=this.#s,e.append(s),e}renderMainDropdown(){const e=this.#n=this.#d();return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}#d(){const e=document.createElement("div"),t=this.#l._signal;e.addEventListener("contextmenu",_r,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[s,n]of this.#l.highlightColors){const i=document.createElement("button");i.tabIndex="0",i.role="option",i.setAttribute("data-color",n),i.title=s,i.setAttribute("data-l10n-id",Yn.#a[s]);const a=document.createElement("span");i.append(a),a.className="swatch",a.style.backgroundColor=n,i.setAttribute("aria-selected",n===this.#s),i.addEventListener("click",this.#f.bind(this,n),{signal:t}),e.append(i)}return e.addEventListener("keydown",this.#p.bind(this),{signal:t}),e}#f(e,t){t.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:this.#u,value:e})}_colorSelectFromKeyboard(e){if(e.target===this.#e){this.#g(e);return}const t=e.target.getAttribute("data-color");t&&this.#f(t,e)}_moveToNext(e){if(!this.#b){this.#g(e);return}if(e.target===this.#e){this.#n.firstChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#n?.firstChild||e.target===this.#e){this.#b&&this._hideDropdownFromKeyboard();return}this.#b||this.#g(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#b){this.#g(e);return}this.#n.firstChild?.focus()}_moveToEnd(e){if(!this.#b){this.#g(e);return}this.#n.lastChild?.focus()}#p(e){Yn._keyboardManager.exec(this,e)}#g(e){if(this.#b){this.hideDropdown();return}if(this.#i=e.detail===0,this.#h||(this.#h=new AbortController,window.addEventListener("pointerdown",this.#m.bind(this),{signal:this.#l.combinedSignal(this.#h)})),this.#n){this.#n.classList.remove("hidden");return}const t=this.#n=this.#d();this.#e.append(t)}#m(e){this.#n?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#n?.classList.add("hidden"),this.#h?.abort(),this.#h=null}get#b(){return this.#n&&!this.#n.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#r){if(!this.#b){this.#c?.unselect();return}this.hideDropdown(),this.#e.focus({preventScroll:!0,focusVisible:this.#i})}}updateColor(e){if(this.#t&&(this.#t.style.backgroundColor=e),!this.#n)return;const t=this.#l.highlightColors.values();for(const s of this.#n.children)s.setAttribute("aria-selected",t.next().value===e)}destroy(){this.#e?.remove(),this.#e=null,this.#t=null,this.#n?.remove(),this.#n=null}}class ps extends bt{#e=null;#t=0;#s;#n=null;#i=null;#r=null;#c=null;#o=0;#h=null;#l=null;#u=null;#a=!1;#d=null;#f;#p=null;#g="";#m;#b="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=pt.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const e=ps.prototype;return xt(this,"_keyboardManager",new qc([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super({...e,name:"highlightEditor"}),this.color=e.color||ps._defaultColor,this.#m=e.thickness||ps._defaultThickness,this.#f=e.opacity||ps._defaultOpacity,this.#s=e.boxes||null,this.#b=e.methodOfCreation||"",this.#g=e.text||"",this._isDraggable=!1,e.highlightId>-1?(this.#a=!0,this.#w(e),this.#C()):this.#s&&(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#c=e.focusNode,this.#o=e.focusOffset,this.#v(),this.#C(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#a?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#m,methodOfCreation:this.#b}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#v(){const e=new Kf(this.#s,.001);this.#l=e.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const t=new Kf(this.#s,.0025,.001,this._uiManager.direction==="ltr");this.#r=t.getOutlines();const{lastPoint:s}=this.#r;this.#d=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height]}#w({highlightOutlines:e,highlightId:t,clipPathId:s}){this.#l=e;const n=1.5;if(this.#r=e.getNewOutline(this.#m/2+n,.0025),t>=0)this.#u=t,this.#n=s,this.parent.drawLayer.finalizeDraw(t,{bbox:e.box,path:{d:e.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},!0);else if(this.parent){const h=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#u,{bbox:ps.#_(this.#l.box,(h-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:ps.#_(this.#r.box,h),path:{d:this.#r.toSVGPath()}})}const[i,a,o,l]=e.box;switch(this.rotation){case 0:this.x=i,this.y=a,this.width=o,this.height=l;break;case 90:{const[h,d]=this.parentDimensions;this.x=a,this.y=1-i,this.width=o*d/h,this.height=l*h/d;break}case 180:this.x=1-i,this.y=1-a,this.width=o,this.height=l;break;case 270:{const[h,d]=this.parentDimensions;this.x=1-a,this.y=i,this.width=o*d/h,this.height=l*h/d;break}}const{lastPoint:c}=this.#r;this.#d=[(c[0]-i)/o,(c[1]-a)/l]}static initialize(e,t){bt.initialize(e,t),ps._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case Nt.HIGHLIGHT_DEFAULT_COLOR:ps._defaultColor=t;break;case Nt.HIGHLIGHT_THICKNESS:ps._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#d}updateParams(e,t){switch(e){case Nt.HIGHLIGHT_COLOR:this.#x(t);break;case Nt.HIGHLIGHT_THICKNESS:this.#S(t);break}}static get defaultPropertiesToUpdate(){return[[Nt.HIGHLIGHT_DEFAULT_COLOR,ps._defaultColor],[Nt.HIGHLIGHT_THICKNESS,ps._defaultThickness]]}get propertiesToUpdate(){return[[Nt.HIGHLIGHT_COLOR,this.color||ps._defaultColor],[Nt.HIGHLIGHT_THICKNESS,this.#m||ps._defaultThickness],[Nt.HIGHLIGHT_FREE,this.#a]]}#x(e){const t=(i,a)=>{this.color=i,this.#f=a,this.parent?.drawLayer.updateProperties(this.#u,{root:{fill:i,"fill-opacity":a}}),this.#i?.updateColor(i)},s=this.color,n=this.#f;this.addCommands({cmd:t.bind(this,e,ps._defaultOpacity),undo:t.bind(this,s,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Nt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)}#S(e){const t=this.#m,s=n=>{this.#m=n,this.#N(n)};this.addCommands({cmd:s.bind(this,e),undo:s.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Nt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(this.#i=new Yn({editor:this}),e.addColorPicker(this.#i)),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#L())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#L())}onceAdded(){this.annotationElementId||this.parent.addUndoableEditor(this),this.div.focus()}remove(){this.#E(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#C(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#E():e&&(this.#C(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#N(e){if(!this.#a)return;this.#w({highlightOutlines:this.#l.getNewOutline(e/2)}),this.fixAndSetPosition();const[t,s]=this.parentDimensions;this.setDims(this.width*t,this.height*s)}#E(){this.#u===null||!this.parent||(this.parent.drawLayer.remove(this.#u),this.#u=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#C(e=this.parent){this.#u===null&&({id:this.#u,clipPathId:this.#n}=e.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#f},rootClass:{highlight:!0,free:this.#a},path:{d:this.#l.toSVGPath()}},!1,!0),this.#p=e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#a},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},this.#a),this.#h&&(this.#h.style.clipPath=this.#n))}static#_([e,t,s,n],i){switch(i){case 90:return[1-t-n,e,n,s];case 180:return[1-e-s,1-t-n,s,n];case 270:return[t,1-e-s,n,s]}return[e,t,s,n]}rotate(e){const{drawLayer:t}=this.parent;let s;this.#a?(e=(e-this.rotation+360)%360,s=ps.#_(this.#l.box,e)):s=ps.#_([this.x,this.y,this.width,this.height],e),t.updateProperties(this.#u,{bbox:s,root:{"data-main-rotation":e}}),t.updateProperties(this.#p,{bbox:ps.#_(this.#r.box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();this.#g&&(e.setAttribute("aria-label",this.#g),e.setAttribute("role","mark")),this.#a?e.classList.add("free"):this.div.addEventListener("keydown",this.#P.bind(this),{signal:this._uiManager._signal});const t=this.#h=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#n;const[s,n]=this.parentDimensions;return this.setDims(this.width*s,this.height*n),Au(this,this.#h,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#P(e){ps._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#k(!0);break;case 1:case 3:this.#k(!1);break}}#k(e){if(!this.#e)return;const t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#c,this.#o)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#a||this.#k(!1))}get _mustFixPosition(){return!this.#a}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(this.#u,{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!e}}))}#L(){return this.#a?this.rotation:0}#R(){if(this.#a)return null;const[e,t]=this.pageDimensions,[s,n]=this.pageTranslation,i=this.#s,a=new Float32Array(i.length*8);let o=0;for(const{x:l,y:c,width:h,height:d}of i){const p=l*e+s,f=(1-c)*t+n;a[o]=a[o+4]=p,a[o+1]=a[o+3]=f,a[o+2]=a[o+6]=p+h*e,a[o+5]=a[o+7]=f-d*t,o+=8}return a}#D(e){return this.#l.serialize(e,this.#L())}static startHighlighting(e,t,{target:s,x:n,y:i}){const{x:a,y:o,width:l,height:c}=s.getBoundingClientRect(),h=new AbortController,d=e.combinedSignal(h),p=f=>{h.abort(),this.#y(e,f)};window.addEventListener("blur",p,{signal:d}),window.addEventListener("pointerup",p,{signal:d}),window.addEventListener("pointerdown",br,{capture:!0,passive:!1,signal:d}),window.addEventListener("contextmenu",_r,{signal:d}),s.addEventListener("pointermove",this.#A.bind(this,e),{signal:d}),this._freeHighlight=new Jf({x:n,y:i},[a,o,l,c],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#A(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#y(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(e,t,s){let n=null;if(e instanceof lb){const{data:{quadPoints:y,rect:w,rotation:A,id:x,color:S,opacity:I,popupRef:M},parent:{page:{pageNumber:B}}}=e;n=e={annotationType:pt.HIGHLIGHT,color:Array.from(S),opacity:I,quadPoints:y,boxes:null,pageIndex:B-1,rect:w.slice(0),rotation:A,id:x,deleted:!1,popupRef:M}}else if(e instanceof Yp){const{data:{inkLists:y,rect:w,rotation:A,id:x,color:S,borderStyle:{rawWidth:I},popupRef:M},parent:{page:{pageNumber:B}}}=e;n=e={annotationType:pt.HIGHLIGHT,color:Array.from(S),thickness:I,inkLists:y,boxes:null,pageIndex:B-1,rect:w.slice(0),rotation:A,id:x,deleted:!1,popupRef:M}}const{color:i,quadPoints:a,inkLists:o,opacity:l}=e,c=await super.deserialize(e,t,s);c.color=He.makeHexColor(...i),c.#f=l||1,o&&(c.#m=e.thickness),c.annotationElementId=e.id||null,c._initialData=n;const[h,d]=c.pageDimensions,[p,f]=c.pageTranslation;if(a){const y=c.#s=[];for(let w=0;w<a.length;w+=8)y.push({x:(a[w]-p)/h,y:1-(a[w+1]-f)/d,width:(a[w+2]-a[w])/h,height:(a[w+1]-a[w+5])/d});c.#v(),c.#C(),c.rotate(c.rotation)}else if(o){c.#a=!0;const y=o[0],w={x:y[0]-p,y:d-(y[1]-f)},A=new Jf(w,[0,0,h,d],1,c.#m/2,!0,.001);for(let I=0,M=y.length;I<M;I+=2)w.x=y[I]-p,w.y=d-(y[I+1]-f),A.add(w);const{id:x,clipPathId:S}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:c.color,"fill-opacity":c._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:A.toSVGPath()}},!0,!0);c.#w({highlightOutlines:A.getOutlines(),highlightId:x,clipPathId:S}),c.#C()}return c}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=this.getRect(0,0),s=bt._colorManager.convert(this.color),n={annotationType:pt.HIGHLIGHT,color:s,opacity:this.#f,thickness:this.#m,quadPoints:this.#R(),outlines:this.#D(t),pageIndex:this.pageIndex,rect:t,rotation:this.#L(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#j(n)?null:(n.id=this.annotationElementId,n)}#j(e){const{color:t}=this._initialData;return e.color.some((s,n)=>s!==t[n])}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class p3{#e=Object.create(null);updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,s]of Object.entries(e))this.updateProperty(t,s)}updateSVGProperty(e,t){this.#e[e]=t}toSVGProperties(){const e=this.#e;return this.#e=Object.create(null),{root:e}}reset(){this.#e=Object.create(null)}updateAll(e=this){this.updateProperties(e)}clone(){Ht("Not implemented")}}class wa extends bt{#e=null;#t;_drawId=null;static _currentDrawId=-1;static _currentDraw=null;static _currentDrawingOptions=null;static _currentParent=null;static _INNER_MARGIN=3;constructor(e){super(e),this.#t=e.mustBeCommitted||!1,e.drawOutlines&&(this.#s(e),this.#r())}#s({drawOutlines:e,drawId:t,drawingOptions:s}){this.#e=e,this._drawingOptions||=s,t>=0?(this._drawId=t,this.parent.drawLayer.finalizeDraw(t,e.defaultProperties)):this._drawId=this.#n(e,this.parent),this.#h(e.box)}#n(e,t){const{id:s}=t.drawLayer.draw(wa._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return s}static _mergeSVGProperties(e,t){const s=new Set(Object.keys(e));for(const[n,i]of Object.entries(t))s.has(n)?Object.assign(e[n],i):e[n]=i;return e}static getDefaultDrawingOptions(e){Ht("Not implemented")}static get typesMap(){Ht("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const s=this.typesMap.get(e);s&&this._defaultDrawingOptions.updateProperty(s,t),this._currentParent&&(this._currentDraw.updateProperty(s,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const s=this.constructor.typesMap.get(e);s&&this._updateProperty(e,s,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[s,n]of this.typesMap)e.push([s,t[n]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[s,n]of this.constructor.typesMap)e.push([s,t[n]]);return e}_updateProperty(e,t,s){const n=this._drawingOptions,i=n[t],a=o=>{n.updateProperty(t,o);const l=this.#e.updateProperty(t,o);l&&this.#h(l),this.parent?.drawLayer.updateProperties(this._drawId,n.toSVGProperties())};this.addCommands({cmd:a.bind(this,s),undo:a.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,wa._mergeSVGProperties(this.#e.getPathResizingSVGProperties(this.#o()),{bbox:this.#l()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,wa._mergeSVGProperties(this.#e.getPathResizedSVGProperties(this.#o()),{bbox:this.#l()}))}_onTranslating(e,t){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#l(e,t)})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,wa._mergeSVGProperties(this.#e.getPathTranslatedSVGProperties(this.#o(),this.parentDimensions),{bbox:this.#l()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#t&&(this.#t=!1,this.commit(),this.parent.setSelected(this),this.isOnScreen&&this.div.focus())}remove(){this.#i(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#r(),this.#h(this.#e.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),this.#i()):e&&(this._uiManager.addShouldRescale(this),this.#r(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),t&&this.select()}#i(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#r(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#n(this.#e,e)}}#c([e,t,s,n]){const{parentDimensions:[i,a],rotation:o}=this;switch(o){case 90:return[t,1-e,s*(a/i),n*(i/a)];case 180:return[1-e,1-t,s,n];case 270:return[1-t,e,s*(a/i),n*(i/a)];default:return[e,t,s,n]}}#o(){const{x:e,y:t,width:s,height:n,parentDimensions:[i,a],rotation:o}=this;switch(o){case 90:return[1-t,e,s*(i/a),n*(a/i)];case 180:return[1-e,1-t,s,n];case 270:return[t,1-e,s*(i/a),n*(a/i)];default:return[e,t,s,n]}}#h(e){if([this.x,this.y,this.width,this.height]=this.#c(e),this.div){this.fixAndSetPosition();const[t,s]=this.parentDimensions;this.setDims(this.width*t,this.height*s)}this._onResized()}#l(){const{x:e,y:t,width:s,height:n,rotation:i,parentRotation:a,parentDimensions:[o,l]}=this;switch((i*4+a)/90){case 1:return[1-t-n,e,n,s];case 2:return[1-e-s,1-t-n,s,n];case 3:return[t,1-e-s,n,s];case 4:return[e,t-s*(o/l),n*(l/o),s*(o/l)];case 5:return[1-t,e,s*(o/l),n*(l/o)];case 6:return[1-e-n*(l/o),1-t,n*(l/o),s*(o/l)];case 7:return[t-s*(o/l),1-e-n*(l/o),s*(o/l),n*(l/o)];case 8:return[e-s,t-n,s,n];case 9:return[1-t,e-s,n,s];case 10:return[1-e,1-t,s,n];case 11:return[t-n,1-e,n,s];case 12:return[e-n*(l/o),t,n*(l/o),s*(o/l)];case 13:return[1-t-s*(o/l),e-n*(l/o),s*(o/l),n*(l/o)];case 14:return[1-e,1-t-s*(o/l),n*(l/o),s*(o/l)];case 15:return[t,1-e,s*(o/l),n*(l/o)];default:return[e,t,s,n]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,wa._mergeSVGProperties({bbox:this.#l()},this.#e.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#e.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const e=super.render();e.classList.add("draw");const t=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal";const[s,n]=this.parentDimensions;return this.setDims(this.width*s,this.height*n),this._uiManager.addShouldRescale(this),this.disableEditing(),e}static createDrawerInstance(e,t,s,n,i){Ht("Not implemented")}static startDrawing(e,t,s,{target:n,offsetX:i,offsetY:a}){const{viewport:{rotation:o}}=e,{width:l,height:c}=n.getBoundingClientRect(),h=new AbortController,d=e.combinedSignal(h);if(window.addEventListener("pointerup",p=>{h.abort(),e.toggleDrawing(!0),this._endDraw(p)},{signal:d}),window.addEventListener("pointerdown",br,{capture:!0,passive:!1,signal:d}),window.addEventListener("contextmenu",_r,{signal:d}),n.addEventListener("pointermove",this._drawMove.bind(this),{signal:d}),e.toggleDrawing(),t._editorUndoBar?.hide(),this._currentDraw){e.drawLayer.updateProperties(this._currentDrawId,this._currentDraw.startNew(i,a,l,c,o));return}t.updateUIForDefaultProperties(this),this._currentDraw=this.createDrawerInstance(i,a,l,c,o),this._currentDrawingOptions=this.getDefaultDrawingOptions(),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(this._currentDrawingOptions.toSVGProperties(),this._currentDraw.defaultSVGProperties),!0,!1)}static _drawMove({offsetX:e,offsetY:t}){this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._currentDraw.add(e,t))}static _endDraw({offsetX:e,offsetY:t}){const s=this._currentParent;if(s.drawLayer.updateProperties(this._currentDrawId,this._currentDraw.end(e,t)),this.supportMultipleDrawings){const n=this._currentDraw,i=this._currentDrawId,a=n.getLastElement();s.addCommands({cmd:()=>{s.drawLayer.updateProperties(i,n.setLastElement(a))},undo:()=>{s.drawLayer.updateProperties(i,n.removeLastElement())},mustExec:!1,type:Nt.DRAW_STEP});return}this.endDrawing(!1)}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack(Nt.DRAW_STEP),!this._currentDraw.isEmpty()){const{pageDimensions:[s,n],scale:i}=t,a=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:this._currentDraw.getOutlines(s*i,n*i,i,this._INNER_MARGIN),drawingOptions:this._currentDrawingOptions,mustBeCommitted:!e});return this._cleanup(),a}return t.drawLayer.remove(this._currentDrawId),this._cleanup(),null}static _cleanup(){this._currentDrawId=-1,this._currentDraw=null,this._currentDrawingOptions=null,this._currentParent=null}createDrawingOptions(e){}static deserializeDraw(e,t,s,n,i,a){Ht("Not implemented")}static async deserialize(e,t,s){const{rawDims:{pageWidth:n,pageHeight:i,pageX:a,pageY:o}}=t.viewport,l=this.deserializeDraw(a,o,n,i,this._INNER_MARGIN,e),c=await super.deserialize(e,t,s);return c.createDrawingOptions(e),c.#s({drawOutlines:l}),c.#r(),c.onScaleChanging(),c.rotate(),c}serializeDraw(e){const[t,s]=this.pageTranslation,[n,i]=this.pageDimensions;return this.#e.serialize([t,s,n,i],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class m3{#e=new Float64Array(6);#t;#s;#n;#i;#r;#c="";#o=0;#h=new nd;#l;#u;constructor(e,t,s,n,i,a){this.#l=s,this.#u=n,this.#n=i,this.#i=a,[e,t]=this.#a(e,t);const o=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#r=[e,t],this.#s=[{line:o,points:this.#r}],this.#e.set(o,0)}updateProperty(e,t){e==="stroke-width"&&(this.#i=t)}#a(e,t){return $e._normalizePoint(e,t,this.#l,this.#u,this.#n)}isEmpty(){return!this.#s||this.#s.length===0}add(e,t){[e,t]=this.#a(e,t);const[s,n,i,a]=this.#e.subarray(2,6),o=e-i,l=t-a;return Math.hypot(this.#l*o,this.#u*l)<=2?null:(this.#r.push(e,t),isNaN(s)?(this.#e.set([i,a,e,t],2),this.#t.push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(this.#e[0])&&this.#t.splice(6,6),this.#e.set([s,n,i,a,e,t],0),this.#t.push(...$e.createBezierPoints(s,n,i,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const s=this.add(e,t);return s||(this.#r.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,s,n,i){this.#l=s,this.#u=n,this.#n=i,[e,t]=this.#a(e,t);const a=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#r=[e,t];const o=this.#s.at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),this.#s.push({line:a,points:this.#r}),this.#e.set(a,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#s.at(-1)}setLastElement(e){return this.#s?(this.#s.push(e),this.#t=e.line,this.#r=e.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#h.setLastElement(e)}removeLastElement(){if(!this.#s)return this.#h.removeLastElement();this.#s.pop(),this.#c="";for(let e=0,t=this.#s.length;e<t;e++){const{line:s,points:n}=this.#s[e];this.#t=s,this.#r=n,this.#o=0,this.toSVGPath()}return{path:{d:this.#c}}}toSVGPath(){const e=$e.svgRound(this.#t[4]),t=$e.svgRound(this.#t[5]);if(this.#r.length===2)return this.#c=`${this.#c} M ${e} ${t} Z`,this.#c;if(this.#r.length<=6){const n=this.#c.lastIndexOf("M");this.#c=`${this.#c.slice(0,n)} M ${e} ${t}`,this.#o=6}if(this.#r.length===4){const n=$e.svgRound(this.#t[10]),i=$e.svgRound(this.#t[11]);return this.#c=`${this.#c} L ${n} ${i}`,this.#o=12,this.#c}const s=[];this.#o===0&&(s.push(`M ${e} ${t}`),this.#o=6);for(let n=this.#o,i=this.#t.length;n<i;n+=6){const[a,o,l,c,h,d]=this.#t.slice(n,n+6).map($e.svgRound);s.push(`C${a} ${o} ${l} ${c} ${h} ${d}`)}return this.#c+=s.join(" "),this.#o=this.#t.length,this.#c}getOutlines(e,t,s,n){const i=this.#s.at(-1);return i.line=new Float32Array(i.line),i.points=new Float32Array(i.points),this.#h.build(this.#s,e,t,s,this.#n,this.#i,n),this.#e=null,this.#t=null,this.#s=null,this.#c=null,this.#h}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class nd extends $e{#e;#t=0;#s;#n;#i;#r;#c;#o;#h;build(e,t,s,n,i,a,o){this.#i=t,this.#r=s,this.#c=n,this.#o=i,this.#h=a,this.#s=o??0,this.#n=e,this.#a()}setLastElement(e){return this.#n.push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#n.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of this.#n){if(e.push(`M${$e.svgRound(t[4])} ${$e.svgRound(t[5])}`),t.length===6){e.push("Z");continue}if(t.length===12){e.push(`L${$e.svgRound(t[10])} ${$e.svgRound(t[11])}`);continue}for(let s=6,n=t.length;s<n;s+=6){const[i,a,o,l,c,h]=t.subarray(s,s+6).map($e.svgRound);e.push(`C${i} ${a} ${o} ${l} ${c} ${h}`)}}return e.join("")}serialize([e,t,s,n],i){const a=[],o=[],[l,c,h,d]=this.#u();let p,f,y,w,A,x,S,I,M;switch(this.#o){case 0:M=$e._rescale,p=e,f=t+n,y=s,w=-n,A=e+l*s,x=t+(1-c-d)*n,S=e+(l+h)*s,I=t+(1-c)*n;break;case 90:M=$e._rescaleAndSwap,p=e,f=t,y=s,w=n,A=e+c*s,x=t+l*n,S=e+(c+d)*s,I=t+(l+h)*n;break;case 180:M=$e._rescale,p=e+s,f=t,y=-s,w=n,A=e+(1-l-h)*s,x=t+c*n,S=e+(1-l)*s,I=t+(c+d)*n;break;case 270:M=$e._rescaleAndSwap,p=e+s,f=t+n,y=-s,w=-n,A=e+(1-c-d)*s,x=t+(1-l-h)*n,S=e+(1-c)*s,I=t+(1-l)*n;break}for(const{line:B,points:Q}of this.#n)a.push(M(B,p,f,y,w,i?new Array(B.length):null)),o.push(M(Q,p,f,y,w,i?new Array(Q.length):null));return{lines:a,points:o,rect:[A,x,S,I]}}static deserialize(e,t,s,n,i,{paths:{lines:a,points:o},rotation:l,thickness:c}){const h=[];let d,p,f,y,w;switch(l){case 0:w=$e._rescale,d=-e/s,p=t/n+1,f=1/s,y=-1/n;break;case 90:w=$e._rescaleAndSwap,d=-t/n,p=-e/s,f=1/n,y=1/s;break;case 180:w=$e._rescale,d=e/s+1,p=-t/n,f=-1/s,y=1/n;break;case 270:w=$e._rescaleAndSwap,d=t/n+1,p=e/s+1,f=-1/n,y=-1/s;break}if(!a){a=[];for(const x of o){const S=x.length;if(S===2){a.push(new Float32Array([NaN,NaN,NaN,NaN,x[0],x[1]]));continue}if(S===4){a.push(new Float32Array([NaN,NaN,NaN,NaN,x[0],x[1],NaN,NaN,NaN,NaN,x[2],x[3]]));continue}const I=new Float32Array(3*(S-2));a.push(I);let[M,B,Q,U]=x.subarray(0,4);I.set([NaN,NaN,NaN,NaN,M,B],0);for(let O=4;O<S;O+=2){const G=x[O],ne=x[O+1];I.set($e.createBezierPoints(M,B,Q,U,G,ne),(O-2)*3),[M,B,Q,U]=[Q,U,G,ne]}}}for(let x=0,S=a.length;x<S;x++)h.push({line:w(a[x].map(I=>I??NaN),d,p,f,y),points:w(o[x].map(I=>I??NaN),d,p,f,y)});const A=new nd;return A.build(h,s,n,1,l,c,i),A}#l(e=this.#h){const t=this.#s+e/2*this.#c;return this.#o%180===0?[t/this.#i,t/this.#r]:[t/this.#r,t/this.#i]}#u(){const[e,t,s,n]=this.#e,[i,a]=this.#l(0);return[e+i,t+a,s-2*i,n-2*a]}#a(){const e=this.#e=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:n}of this.#n){if(n.length<=12){for(let o=4,l=n.length;o<l;o+=6){const[c,h]=n.subarray(o,o+2);e[0]=Math.min(e[0],c),e[1]=Math.min(e[1],h),e[2]=Math.max(e[2],c),e[3]=Math.max(e[3],h)}continue}let i=n[4],a=n[5];for(let o=6,l=n.length;o<l;o+=6){const[c,h,d,p,f,y]=n.subarray(o,o+6);He.bezierBoundingBox(i,a,c,h,d,p,f,y,e),i=f,a=y}}const[t,s]=this.#l();e[0]=Math.min(1,Math.max(0,e[0]-t)),e[1]=Math.min(1,Math.max(0,e[1]-s)),e[2]=Math.min(1,Math.max(0,e[2]+t)),e[3]=Math.min(1,Math.max(0,e[3]+s)),e[2]-=e[0],e[3]-=e[1]}get box(){return this.#e}updateProperty(e,t){return e==="stroke-width"?this.#d(t):null}#d(e){const[t,s]=this.#l();this.#h=e;const[n,i]=this.#l(),[a,o]=[n-t,i-s],l=this.#e;return l[0]-=a,l[1]-=o,l[2]+=2*a,l[3]+=2*o,l}updateParentDimensions([e,t],s){const[n,i]=this.#l();this.#i=e,this.#r=t,this.#c=s;const[a,o]=this.#l(),l=a-n,c=o-i,h=this.#e;return h[0]-=l,h[1]-=c,h[2]+=2*l,h[3]+=2*c,h}updateRotation(e){return this.#t=e,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#e.map($e.svgRound).join(" ")}get defaultProperties(){const[e,t]=this.#e;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${$e.svgRound(e)} ${$e.svgRound(t)}`}}}get rotationTransform(){const[,,e,t]=this.#e;let s=0,n=0,i=0,a=0,o=0,l=0;switch(this.#t){case 90:n=t/e,i=-e/t,o=e;break;case 180:s=-1,a=-1,o=e,l=t;break;case 270:n=-t/e,i=e/t,l=t;break;default:return""}return`matrix(${s} ${n} ${i} ${a} ${$e.svgRound(o)} ${$e.svgRound(l)})`}getPathResizingSVGProperties([e,t,s,n]){const[i,a]=this.#l(),[o,l,c,h]=this.#e;if(Math.abs(c-i)<=$e.PRECISION||Math.abs(h-a)<=$e.PRECISION){const w=e+s/2-(o+c/2),A=t+n/2-(l+h/2);return{path:{"transform-origin":`${$e.svgRound(e)} ${$e.svgRound(t)}`,transform:`${this.rotationTransform} translate(${w} ${A})`}}}const d=(s-2*i)/(c-2*i),p=(n-2*a)/(h-2*a),f=c/s,y=h/n;return{path:{"transform-origin":`${$e.svgRound(o)} ${$e.svgRound(l)}`,transform:`${this.rotationTransform} scale(${f} ${y}) translate(${$e.svgRound(i)} ${$e.svgRound(a)}) scale(${d} ${p}) translate(${$e.svgRound(-i)} ${$e.svgRound(-a)})`}}}getPathResizedSVGProperties([e,t,s,n]){const[i,a]=this.#l(),o=this.#e,[l,c,h,d]=o;if(o[0]=e,o[1]=t,o[2]=s,o[3]=n,Math.abs(h-i)<=$e.PRECISION||Math.abs(d-a)<=$e.PRECISION){const A=e+s/2-(l+h/2),x=t+n/2-(c+d/2);for(const{line:S,points:I}of this.#n)$e._translate(S,A,x,S),$e._translate(I,A,x,I);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${$e.svgRound(e)} ${$e.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const p=(s-2*i)/(h-2*i),f=(n-2*a)/(d-2*a),y=-p*(l+i)+e+i,w=-f*(c+a)+t+a;if(p!==1||f!==1||y!==0||w!==0)for(const{line:A,points:x}of this.#n)$e._rescale(A,y,w,p,f,A),$e._rescale(x,y,w,p,f,x);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${$e.svgRound(e)} ${$e.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,t],s){const[n,i]=s,a=this.#e,o=e-a[0],l=t-a[1];if(this.#i===n&&this.#r===i)for(const{line:c,points:h}of this.#n)$e._translate(c,o,l,c),$e._translate(h,o,l,h);else{const c=this.#i/n,h=this.#r/i;this.#i=n,this.#r=i;for(const{line:d,points:p}of this.#n)$e._rescale(d,o,l,c,h,d),$e._rescale(p,o,l,c,h,p);a[2]*=c,a[3]*=h}return a[0]=e,a[1]=t,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${$e.svgRound(e)} ${$e.svgRound(t)}`}}}get defaultSVGProperties(){const e=this.#e;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${$e.svgRound(e[0])} ${$e.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}class Kp extends p3{#e;constructor(e){super(),this.#e=e,super.updateProperties({fill:"none",stroke:bt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??=this["stroke-width"],t*=this.#e.realScale),super.updateSVGProperty(e,t)}clone(){const e=new Kp(this.#e);return e.updateAll(this),e}}class Jp extends wa{static _type="ink";static _editorType=pt.INK;static _defaultDrawingOptions=null;constructor(e){super({...e,name:"inkEditor"}),this._willKeepAspectRatio=!0}static initialize(e,t){bt.initialize(e,t),this._defaultDrawingOptions=new Kp(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return xt(this,"typesMap",new Map([[Nt.INK_THICKNESS,"stroke-width"],[Nt.INK_COLOR,"stroke"],[Nt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,s,n,i){return new m3(e,t,s,n,i,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,s,n,i,a){return nd.deserialize(e,t,s,n,i,a)}static async deserialize(e,t,s){let n=null;if(e instanceof Yp){const{data:{inkLists:a,rect:o,rotation:l,id:c,color:h,opacity:d,borderStyle:{rawWidth:p},popupRef:f},parent:{page:{pageNumber:y}}}=e;n=e={annotationType:pt.INK,color:Array.from(h),thickness:p,opacity:d,paths:{points:a},boxes:null,pageIndex:y-1,rect:o.slice(0),rotation:l,id:c,deleted:!1,popupRef:f}}const i=await super.deserialize(e,t,s);return i.annotationElementId=e.id||null,i._initialData=n,i}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:s}=this;t.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:t,opacity:s}){this._drawingOptions=Jp.getDefaultDrawingOptions({stroke:He.makeHexColor(...e),"stroke-width":t,"stroke-opacity":s})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:s,rect:n}=this.serializeDraw(e),{_drawingOptions:{stroke:i,"stroke-opacity":a,"stroke-width":o}}=this,l={annotationType:pt.INK,color:bt._colorManager.convert(i),opacity:a,thickness:o,paths:{lines:t,points:s},pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?l:this.annotationElementId&&!this.#e(l)?null:(l.id=this.annotationElementId,l)}#e(e){const{color:t,thickness:s,opacity:n,pageIndex:i}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||e.color.some((a,o)=>a!==t[o])||e.thickness!==s||e.opacity!==n||e.pageIndex!==i}renderAnnotationElement(e){const{points:t,rect:s}=this.serializeDraw(!1);return e.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:t}),null}}class Zp extends bt{#e=null;#t=null;#s=null;#n=null;#i=null;#r="";#c=null;#o=null;#h=null;#l=!1;#u=!1;static _type="stamp";static _editorType=pt.STAMP;constructor(e){super({...e,name:"stampEditor"}),this.#n=e.bitmapUrl,this.#i=e.bitmapFile}static initialize(e,t){bt.initialize(e,t)}static get supportedTypes(){return xt(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(t=>`image/${t}`))}static get supportedTypesStr(){return xt(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,t){t.pasteEditor(pt.STAMP,{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){const t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#a(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#l=e.isSvg),e.file&&(this.#r=e.file.name),this.#p()}#d(){if(this.#s=null,this._uiManager.enableWaiting(!1),!!this.#c){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(e=null,t=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:n,width:i,height:a}=e||this.copyCanvas(null,null,!0).imageData,o=await s.guess({name:"altText",request:{data:n,width:i,height:a,channels:n.length/(i*a)}});if(!o)throw new Error("No response from the AI service.");if(o.error)throw new Error("Error from the AI service.");if(o.cancel)return null;if(!o.output)throw new Error("No valid response from the AI service.");const l=o.output;return await this.setGuessedAltText(l),t&&!this.hasAltTextData()&&(this.altTextData={alt:l,decorative:!1}),l}#f(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(s=>this.#a(s,!0)).finally(()=>this.#d());return}if(this.#n){const s=this.#n;this.#n=null,this._uiManager.enableWaiting(!0),this.#s=this._uiManager.imageManager.getFromUrl(s).then(n=>this.#a(n)).finally(()=>this.#d());return}if(this.#i){const s=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#s=this._uiManager.imageManager.getFromFile(s).then(n=>this.#a(n)).finally(()=>this.#d());return}const e=document.createElement("input");e.type="file",e.accept=Zp.supportedTypesStr;const t=this._uiManager._signal;this.#s=new Promise(s=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const n=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#a(n)}s()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),s()},{signal:t})}).finally(()=>this.#d()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#c?.remove(),this.#c=null,this.#o?.disconnect(),this.#o=null,this.#h&&(clearTimeout(this.#h),this.#h=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#f();return}super.rebuild(),this.div!==null&&(this.#t&&this.#c===null&&this.#f(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(this.#s||this.#e||this.#n||this.#i||this.#t)}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;if(this.width&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),this.#e?this.#p():this.#f(),this.width&&!this.annotationElementId){const[s,n]=this.parentDimensions;this.setAt(e*s,t*n,this.width*s,this.height*n)}return this.div}#p(){const{div:e}=this;let{width:t,height:s}=this.#e;const[n,i]=this.pageDimensions,a=.75;if(this.width)t=this.width*n,s=this.height*i;else if(t>a*n||s>a*i){const h=Math.min(a*n/t,a*i/s);t*=h,s*=h}const[o,l]=this.parentDimensions;this.setDims(t*o/n,s*l/i),this._uiManager.enableWaiting(!1);const c=this.#c=document.createElement("canvas");c.setAttribute("role","img"),this.addContainer(c),(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#b(t,s),this.#w(),this.#u||(this.parent.addUndoableEditor(this),this.#u=!0),this._reportTelemetry({action:"inserted_image"}),this.#r&&c.setAttribute("aria-label",this.#r)}copyCanvas(e,t,s=!1){e||(e=224);const{width:n,height:i}=this.#e,a=new Vf;let o=this.#e,l=n,c=i,h=null;if(t){if(n>t||i>t){const Q=Math.min(t/n,t/i);l=Math.floor(n*Q),c=Math.floor(i*Q)}h=document.createElement("canvas");const p=h.width=Math.ceil(l*a.sx),f=h.height=Math.ceil(c*a.sy);this.#l||(o=this.#m(p,f));const y=h.getContext("2d");y.filter=this._uiManager.hcmFilter;let w="white",A="#cfcfd8";this._uiManager.hcmFilter!=="none"?A="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(w="#8f8f9d",A="#42414d");const x=15,S=x*a.sx,I=x*a.sy,M=new OffscreenCanvas(S*2,I*2),B=M.getContext("2d");B.fillStyle=w,B.fillRect(0,0,S*2,I*2),B.fillStyle=A,B.fillRect(0,0,S,I),B.fillRect(S,I,S,I),y.fillStyle=y.createPattern(M,"repeat"),y.fillRect(0,0,p,f),y.drawImage(o,0,0,o.width,o.height,0,0,p,f)}let d=null;if(s){let p,f;if(a.symmetric&&o.width<e&&o.height<e)p=o.width,f=o.height;else if(o=this.#e,n>e||i>e){const A=Math.min(e/n,e/i);p=Math.floor(n*A),f=Math.floor(i*A),this.#l||(o=this.#m(p,f))}const w=new OffscreenCanvas(p,f).getContext("2d",{willReadFrequently:!0});w.drawImage(o,0,0,o.width,o.height,0,0,p,f),d={width:p,height:f,data:w.getImageData(0,0,p,f).data}}return{canvas:h,width:l,height:c,imageData:d}}#g(e,t){const[s,n]=this.parentDimensions;this.width=e/s,this.height=t/n,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this.#h!==null&&clearTimeout(this.#h);const i=200;this.#h=setTimeout(()=>{this.#h=null,this.#b(e,t)},i)}#m(e,t){const{width:s,height:n}=this.#e;let i=s,a=n,o=this.#e;for(;i>2*e||a>2*t;){const l=i,c=a;i>2*e&&(i=i>=16384?Math.floor(i/2)-1:Math.ceil(i/2)),a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const h=new OffscreenCanvas(i,a);h.getContext("2d").drawImage(o,0,0,l,c,0,0,i,a),o=h.transferToImageBitmap()}return o}#b(e,t){const s=new Vf,n=Math.ceil(e*s.sx),i=Math.ceil(t*s.sy),a=this.#c;if(!a||a.width===n&&a.height===i)return;a.width=n,a.height=i;const o=this.#l?this.#e:this.#m(n,i),l=a.getContext("2d");l.filter=this._uiManager.hcmFilter,l.drawImage(o,0,0,o.width,o.height,0,0,n,i)}getImageForAltText(){return this.#c}#v(e){if(e){if(this.#l){const n=this._uiManager.imageManager.getSvgUrl(this.#t);if(n)return n}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#l){const[t,s]=this.pageDimensions,n=Math.round(this.width*t*Vo.PDF_TO_CSS_UNITS),i=Math.round(this.height*s*Vo.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(n,i);return a.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,n,i),a.transferToImageBitmap()}return structuredClone(this.#e)}#w(){this._uiManager._signal&&(this.#o=new ResizeObserver(e=>{const t=e[0].contentRect;t.width&&t.height&&this.#g(t.width,t.height)}),this.#o.observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{this.#o?.disconnect(),this.#o=null},{once:!0}))}static async deserialize(e,t,s){let n=null;if(e instanceof cb){const{data:{rect:y,rotation:w,id:A,structParent:x,popupRef:S},container:I,parent:{page:{pageNumber:M}}}=e,B=I.querySelector("canvas"),Q=s.imageManager.getFromCanvas(I.id,B);B.remove();const U=(await t._structTree.getAriaAttributes(`${Dp}${A}`))?.get("aria-label")||"";n=e={annotationType:pt.STAMP,bitmapId:Q.id,bitmap:Q.bitmap,pageIndex:M-1,rect:y.slice(0),rotation:w,id:A,deleted:!1,accessibilityData:{decorative:!1,altText:U},isSvg:!1,structParent:x,popupRef:S}}const i=await super.deserialize(e,t,s),{rect:a,bitmap:o,bitmapUrl:l,bitmapId:c,isSvg:h,accessibilityData:d}=e;c&&s.imageManager.isValidId(c)?(i.#t=c,o&&(i.#e=o)):i.#n=l,i.#l=h;const[p,f]=i.pageDimensions;return i.width=(a[2]-a[0])/p,i.height=(a[3]-a[1])/f,i.annotationElementId=e.id||null,d&&(i.altTextData=d),i._initialData=n,i.#u=!!n,i}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s={annotationType:pt.STAMP,bitmapId:this.#t,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#l,structTreeParentId:this._structTreeParentId};if(e)return s.bitmapUrl=this.#v(!0),s.accessibilityData=this.serializeAltText(!0),s;const{decorative:n,altText:i}=this.serializeAltText(!1);if(!n&&i&&(s.accessibilityData={type:"Figure",alt:i}),this.annotationElementId){const o=this.#x(s);if(o.isSame)return null;o.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1}if(s.id=this.annotationElementId,t===null)return s;t.stamps||=new Map;const a=this.#l?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:a,serialized:s}),s.bitmap=this.#v(!1);else if(this.#l){const o=t.stamps.get(this.#t);a>o.area&&(o.area=a,o.serialized.bitmap.close(),o.serialized.bitmap=this.#v(!1))}return s}#x(e){const{pageIndex:t,accessibilityData:{altText:s}}=this._initialData,n=e.pageIndex===t,i=(e.accessibilityData?.alt||"")===s;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&n&&i,isSameAltText:i}}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}}class gi{#e;#t=!1;#s=null;#n=null;#i=null;#r=new Map;#c=!1;#o=!1;#h=null;#l=null;#u=null;#a;static _initialized=!1;static#d=new Map([Ts,Jp,Zp,ps].map(e=>[e._editorType,e]));constructor({uiManager:e,pageIndex:t,div:s,structTreeLayer:n,accessibilityManager:i,annotationLayer:a,drawLayer:o,textLayer:l,viewport:c,l10n:h}){const d=[...gi.#d.values()];if(!gi._initialized){gi._initialized=!0;for(const p of d)p.initialize(h,e)}e.registerEditorTypes(d),this.#a=e,this.pageIndex=t,this.div=s,this.#e=i,this.#s=a,this.viewport=c,this.#l=l,this.drawLayer=o,this._structTree=n,this.#a.addLayer(this)}get isEmpty(){return this.#r.size===0}get isInvisible(){return this.isEmpty&&this.#a.getMode()===pt.NONE}updateToolbar(e){this.#a.updateToolbar(e)}updateMode(e=this.#a.getMode()){switch(this.#b(),e){case pt.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case pt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case pt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const s of gi.#d.values())t.toggle(`${s._type}Editing`,e===s._editorType);this.div.hidden=!1}hasTextLayer(e){return e===this.#l?.div}setEditingState(e){this.#a.setEditingState(e)}addCommands(e){this.#a.addCommands(e)}cleanUndoStack(e){this.#a.cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){this.#s?.div.classList.toggle("disabled",!e)}async enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const s of this.#r.values())s.enableEditing(),s.show(!0),s.annotationElementId&&(this.#a.removeChangedExistingAnnotation(s),e.add(s.annotationElementId));if(!this.#s)return;const t=this.#s.getEditableAnnotations();for(const s of t){if(s.hide(),this.#a.isDeletedAnnotationElement(s.data.id)||e.has(s.data.id))continue;const n=await this.deserialize(s);n&&(this.addOrRebuild(n),n.enableEditing())}}disable(){this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const n of this.#r.values())if(n.disableEditing(),!!n.annotationElementId){if(n.serialize()!==null){e.set(n.annotationElementId,n);continue}else t.set(n.annotationElementId,n);this.getEditableAnnotation(n.annotationElementId)?.show(),n.remove()}if(this.#s){const n=this.#s.getEditableAnnotations();for(const i of n){const{id:a}=i.data;if(this.#a.isDeletedAnnotationElement(a))continue;let o=t.get(a);if(o){o.resetAnnotationElement(i),o.show(!1),i.show();continue}o=e.get(a),o&&(this.#a.addChangedExistingAnnotation(o),o.renderAnnotationElement(i)&&o.show(!1)),i.show()}}this.#b(),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const n of gi.#d.values())s.remove(`${n._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#o=!1}getEditableAnnotation(e){return this.#s?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#a.getActive()!==e&&this.#a.setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,this.#l?.div&&!this.#u){this.#u=new AbortController;const e=this.#a.combinedSignal(this.#u);this.#l.div.addEventListener("pointerdown",this.#f.bind(this),{signal:e}),this.#l.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#l?.div&&this.#u&&(this.#u.abort(),this.#u=null,this.#l.div.classList.remove("highlighting"))}#f(e){this.#a.unselectAll();const{target:t}=e;if(t===this.#l.div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&this.#l.div.contains(t)){const{isMac:s}=un.platform;if(e.button!==0||e.ctrlKey&&s)return;this.#a.showAllEditors("highlight",!0,!0),this.#l.div.classList.add("free"),this.toggleDrawing(),ps.startHighlighting(this,this.#a.direction==="ltr",{target:this.#l.div,x:e.x,y:e.y}),this.#l.div.addEventListener("pointerup",()=>{this.#l.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#a._signal}),e.preventDefault()}}enableClick(){if(this.#n)return;this.#n=new AbortController;const e=this.#a.combinedSignal(this.#n);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e}),this.div.addEventListener("pointerup",this.pointerup.bind(this),{signal:e})}disableClick(){this.#n?.abort(),this.#n=null}attach(e){this.#r.set(e.id,e);const{annotationElementId:t}=e;t&&this.#a.isDeletedAnnotationElement(t)&&this.#a.removeDeletedAnnotationElement(e)}detach(e){this.#r.delete(e.id),this.#e?.removePointerInTextLayer(e.contentDiv),!this.#o&&e.annotationElementId&&this.#a.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#a.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(this.#a.addDeletedAnnotationElement(e.annotationElementId),bt.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),this.#a.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(),this.#a.addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!this.#i&&(e._focusEventsAllowed=!1,this.#i=setTimeout(()=>{this.#i=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this.#a._signal}),t.focus())},0)),e._structTreeParentId=this.#e?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),s=()=>{e.remove()};this.addCommands({cmd:t,undo:s,mustExec:!1})}getNextId(){return this.#a.getId()}get#p(){return gi.#d.get(this.#a.getMode())}combinedSignal(e){return this.#a.combinedSignal(e)}#g(e){const t=this.#p;return t?new t.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#p?.canCreateNewEmptyEditor()}pasteEditor(e,t){this.#a.updateToolbar(e),this.#a.updateMode(e);const{offsetX:s,offsetY:n}=this.#m(),i=this.getNextId(),a=this.#g({parent:this,id:i,x:s,y:n,uiManager:this.#a,isCentered:!0,...t});a&&this.add(a)}async deserialize(e){return await gi.#d.get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,this.#a)||null}createAndAddNewEditor(e,t,s={}){const n=this.getNextId(),i=this.#g({parent:this,id:n,x:e.offsetX,y:e.offsetY,uiManager:this.#a,isCentered:t,...s});return i&&this.add(i),i}#m(){const{x:e,y:t,width:s,height:n}=this.div.getBoundingClientRect(),i=Math.max(0,e),a=Math.max(0,t),o=Math.min(window.innerWidth,e+s),l=Math.min(window.innerHeight,t+n),c=(i+o)/2-e,h=(a+l)/2-t,[d,p]=this.viewport.rotation%180===0?[c,h]:[h,c];return{offsetX:d,offsetY:p}}addNewEditor(){this.createAndAddNewEditor(this.#m(),!0)}setSelected(e){this.#a.setSelected(e)}toggleSelected(e){this.#a.toggleSelected(e)}unselect(e){this.#a.unselect(e)}pointerup(e){const{isMac:t}=un.platform;if(!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&this.#c&&(this.#c=!1,!(this.#p?.isDrawer&&this.#p.supportMultipleDrawings))){if(!this.#t){this.#t=!0;return}if(this.#a.getMode()===pt.STAMP){this.#a.unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){if(this.#a.getMode()===pt.HIGHLIGHT&&this.enableTextSelection(),this.#c){this.#c=!1;return}const{isMac:t}=un.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(this.#c=!0,this.#p?.isDrawer){this.startDrawingSession(e);return}const s=this.#a.getActive();this.#t=!s||s.isEmpty()}startDrawingSession(e){if(this.div.focus(),this.#h){this.#p.startDrawing(this,this.#a,!1,e);return}this.#a.setCurrentDrawingSession(this),this.#h=new AbortController;const t=this.#a.combinedSignal(this.#h);this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&this.commitOrRemove()},{signal:t}),this.#p.startDrawing(this,this.#a,!1,e)}endDrawingSession(e=!1){return this.#h?(this.#a.setCurrentDrawingSession(null),this.#h.abort(),this.#h=null,this.#p.endDrawing(e)):null}findNewParent(e,t,s){const n=this.#a.findParent(t,s);return n===null||n===this?!1:(n.changeParent(e),!0)}commitOrRemove(){return this.#h?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#h&&this.#p.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#a.getActive()?.parent===this&&(this.#a.commitOrRemove(),this.#a.setActiveEditor(null)),this.#i&&(clearTimeout(this.#i),this.#i=null);for(const e of this.#r.values())this.#e?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#r.clear(),this.#a.removeLayer(this)}#b(){for(const e of this.#r.values())e.isEmpty()&&e.remove()}render({viewport:e}){this.viewport=e,Ca(this.div,e);for(const t of this.#a.getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){this.#a.commitOrRemove(),this.#b();const t=this.viewport.rotation,s=e.rotation;if(this.viewport=e,Ca(this.div,{rotation:s}),t!==s)for(const n of this.#r.values())n.rotate(s)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return this.#a.viewParameters.realScale}}class ln{#e=null;#t=0;#s=new Map;#n=new Map;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#s.size>0)for(const t of this.#s.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return xt(this,"_svgFactory",new Xp)}static#i(e,[t,s,n,i]){const{style:a}=e;a.top=`${100*s}%`,a.left=`${100*t}%`,a.width=`${100*n}%`,a.height=`${100*i}%`}#r(){const e=ln._svgFactory.create(1,1,!0);return this.#e.append(e),e.setAttribute("aria-hidden",!0),e}#c(e,t){const s=ln._svgFactory.createElement("clipPath");e.append(s);const n=`clip_${t}`;s.setAttribute("id",n),s.setAttribute("clipPathUnits","objectBoundingBox");const i=ln._svgFactory.createElement("use");return s.append(i),i.setAttribute("href",`#${t}`),i.classList.add("clip"),n}#o(e,t){for(const[s,n]of Object.entries(t))n===null?e.removeAttribute(s):e.setAttribute(s,n)}draw(e,t=!1,s=!1){const n=this.#t++,i=this.#r(),a=ln._svgFactory.createElement("defs");i.append(a);const o=ln._svgFactory.createElement("path");a.append(o);const l=`path_p${this.pageIndex}_${n}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke"),t&&this.#n.set(n,o);const c=s?this.#c(a,l):null,h=ln._svgFactory.createElement("use");return i.append(h),h.setAttribute("href",`#${l}`),this.updateProperties(i,e),this.#s.set(n,i),{id:n,clipPathId:`url(#${c})`}}drawOutline(e,t){const s=this.#t++,n=this.#r(),i=ln._svgFactory.createElement("defs");n.append(i);const a=ln._svgFactory.createElement("path");i.append(a);const o=`path_p${this.pageIndex}_${s}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const d=ln._svgFactory.createElement("mask");i.append(d),l=`mask_p${this.pageIndex}_${s}`,d.setAttribute("id",l),d.setAttribute("maskUnits","objectBoundingBox");const p=ln._svgFactory.createElement("rect");d.append(p),p.setAttribute("width","1"),p.setAttribute("height","1"),p.setAttribute("fill","white");const f=ln._svgFactory.createElement("use");d.append(f),f.setAttribute("href",`#${o}`),f.setAttribute("stroke","none"),f.setAttribute("fill","black"),f.setAttribute("fill-rule","nonzero"),f.classList.add("mask")}const c=ln._svgFactory.createElement("use");n.append(c),c.setAttribute("href",`#${o}`),l&&c.setAttribute("mask",`url(#${l})`);const h=c.cloneNode();return n.append(h),c.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(n,e),this.#s.set(s,n),s}finalizeDraw(e,t){this.#n.delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:s,bbox:n,rootClass:i,path:a}=t,o=typeof e=="number"?this.#s.get(e):e;if(o){if(s&&this.#o(o,s),n&&ln.#i(o,n),i){const{classList:l}=o;for(const[c,h]of Object.entries(i))l.toggle(c,h)}if(a){const c=o.firstChild.firstChild;this.#o(c,a)}}}updateParent(e,t){if(t===this)return;const s=this.#s.get(e);s&&(t.#e.append(s),this.#s.delete(e),t.#s.set(e,s))}remove(e){this.#n.delete(e),this.#e!==null&&(this.#s.get(e).remove(),this.#s.delete(e))}destroy(){this.#e=null;for(const e of this.#s.values())e.remove();this.#s.clear(),this.#n.clear()}}globalThis.pdfjsTestingUtils={HighlightOutliner:Kf};nt.AbortException;nt.AnnotationEditorLayer;nt.AnnotationEditorParamsType;nt.AnnotationEditorType;nt.AnnotationEditorUIManager;nt.AnnotationLayer;nt.AnnotationMode;nt.ColorPicker;nt.DOMSVGFactory;nt.DrawLayer;nt.FeatureTest;var g3=nt.GlobalWorkerOptions;nt.ImageKind;nt.InvalidPDFException;nt.MissingPDFException;nt.OPS;nt.OutputScale;nt.PDFDataRangeTransport;nt.PDFDateString;nt.PDFWorker;nt.PasswordResponses;nt.PermissionFlag;nt.PixelsPerInch;nt.RenderingCancelledException;nt.TextLayer;nt.UnexpectedResponseException;nt.Util;nt.VerbosityLevel;nt.XfaLayer;nt.build;nt.createValidAbsoluteUrl;nt.fetchData;var b3=nt.getDocument;nt.getFilenameFromUrl;nt.getPdfFilenameFromUrl;nt.getXfaPageViewport;nt.isDataScheme;nt.isPdfFile;nt.noContextMenu;nt.normalizeUnicode;nt.setLayerDimensions;nt.shadow;nt.stopEvent;nt.version;g3.workerSrc="/pdfjs/pdf.worker.js";function ub({onFileSelect:r,onTextExtracted:e,onTitleExtracted:t,accept:s=".pdf",label:n,type:i}){const a=W.useRef(null),[o,l]=W.useState(!1),[c,h]=W.useState(null),d=f=>{const y=f.split(`
`).map(w=>w.trim()).filter(Boolean);if(i==="cv")return(y[0]||"").split(" ").slice(0,3).join(" ");{const w=/position|job title|role/i,A=y.find(x=>w.test(x));return A?A.replace(/(position|job title|role)[:|\s]+/i,"").trim():y[0]||""}},p=async f=>{const y=f.target.files?.[0];if(y)try{l(!0),h(null),r(y);const w=await y.arrayBuffer(),x=await b3({data:w}).promise;let S="";for(let B=1;B<=x.numPages;B++){const O=(await(await x.getPage(B)).getTextContent()).items.map(G=>G.str).join(" ");S+=O+`
`}const I=S.trim(),M=d(I);e(I),t&&t(M)}catch(w){console.error("Error reading PDF:",w),h("Failed to process PDF. Please try again.")}finally{l(!1)}};return g.jsx("div",{className:"mt-2",children:g.jsx("div",{onClick:()=>a.current?.click(),className:"flex justify-center rounded-lg border border-dashed border-gray-300 px-6 py-10 cursor-pointer hover:border-gray-400",children:g.jsxs("div",{className:"text-center",children:[g.jsx(s1,{className:"mx-auto h-12 w-12 text-gray-400"}),g.jsxs("div",{className:"mt-4 flex text-sm leading-6 text-gray-600",children:[g.jsxs("label",{className:"relative cursor-pointer rounded-md bg-white font-semibold text-blue-600 focus-within:outline-none focus-within:ring-2 focus-within:ring-blue-600 focus-within:ring-offset-2 hover:text-blue-500",children:[g.jsx("span",{children:o?"Processing...":"Upload a file"}),g.jsx("input",{ref:a,type:"file",className:"sr-only",accept:s,onChange:p,disabled:o})]}),g.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),g.jsx("p",{className:"text-xs leading-5 text-gray-600",children:n}),c&&g.jsx("p",{className:"text-xs text-red-600 mt-2",children:c})]})})})}function v3({candidateName:r,cvText:e,onNameChange:t,onCvTextChange:s,errors:n={}}){const{candidates:i=[]}=Mp(),a=l=>{gc(l,e,i)||t(l)},o=l=>{gc(r,l,i)||s(l)};return g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center space-x-2",children:[g.jsx("h2",{className:"text-lg font-semibold",children:"Candidate Information"}),g.jsx("div",{className:"h-6 w-6 rounded-full bg-blue-100 flex items-center justify-center",children:g.jsx("span",{className:"text-blue-600 text-sm",children:"1"})})]}),g.jsx(gA,{onSelect:({name:l,cvText:c})=>{t(l),s(c)}})]}),g.jsx(Na,{id:"candidateName",label:"Candidate Name",value:r,onChange:l=>a(l.target.value),error:n.name,placeholder:"Enter candidate's full name",required:!0}),g.jsx(ub,{type:"cv",onFileSelect:()=>{},onTextExtracted:l=>o(l),onTitleExtracted:l=>a(l),label:"Upload CV (PDF)"}),g.jsx(Op,{id:"cvText",label:"CV Text",value:e,onChange:l=>o(l.target.value),error:n.cvText,placeholder:"Paste the candidate's CV content here or upload a PDF above",required:!0})]})}async function y3(r,e,t=""){try{const{data:{user:s}}=await lt.auth.getUser();if(!s)throw new Error("Not authenticated");const{data:n,error:i}=await lt.from("jobs").insert([{title:r,jd_text:e,company:t,user_id:s.id}]).select().single();if(i)throw console.error("Upload error:",i),i;return n}catch(s){throw console.error("Upload job error:",s),new Error(`Failed to upload job: ${s instanceof Error?s.message:"Unknown error"}`)}}async function w3(){try{const{data:{user:r}}=await lt.auth.getUser();if(!r)throw new Error("Not authenticated");const{data:e,error:t}=await lt.from("jobs").select("id, title, jd_text, company, created_at").eq("user_id",r.id).order("created_at",{ascending:!1});if(t)throw t;return e||[]}catch(r){throw console.error("Get jobs error:",r),new Error("Failed to fetch jobs")}}function Qp(){const{data:r,isLoading:e,error:t,refetch:s}=Fc(w3);return{jobs:r||[],isLoading:e,error:t,refetch:s}}function x3({onSelect:r}){const{jobs:e,isLoading:t}=Qp(),[s,n]=W.useState(!1),i=W.useRef(null);P1(i,()=>n(!1));const a=e.reduce((o,l)=>{const c=o.findIndex(h=>bc(l.title,l.jd_text,[h]));return c>=0?(o[c].duplicateCount+=1,o[c].lastSubmitted=new Date(Math.max(new Date(o[c].lastSubmitted).getTime(),new Date(l.created_at).getTime())).toISOString()):o.push({...l,duplicateCount:1,lastSubmitted:l.created_at}),o},[]);return t?g.jsx(wi,{size:"sm"}):e.length?g.jsxs("div",{className:"relative",ref:i,children:[g.jsxs("button",{type:"button",onClick:()=>n(!s),"data-action":"select-job",className:"inline-flex items-center px-3 py-1.5 text-sm font-medium text-blue-600 hover:text-blue-700 bg-blue-50 hover:bg-blue-100 rounded-md transition-colors",children:[g.jsx("span",{children:"Previous Jobs"}),g.jsx(Zo,{className:"ml-1 h-4 w-4"})]}),s&&g.jsx("div",{className:"absolute right-0 z-10 mt-2 w-96 rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5",children:g.jsx("div",{className:"max-h-60 overflow-auto py-1",children:a.map(o=>g.jsxs("button",{onClick:()=>{r({title:o.title,description:o.jd_text}),n(!1)},className:"w-full px-4 py-3 text-left hover:bg-gray-50 transition-colors border-b border-gray-100 last:border-0",children:[g.jsxs("div",{className:"flex justify-between items-start",children:[g.jsx("p",{className:"font-medium text-gray-900",children:o.title}),o.duplicateCount>1&&g.jsxs("span",{className:"text-xs px-2 py-1 bg-blue-50 text-blue-600 rounded-full",children:["Submitted ",o.duplicateCount," times"]})]}),g.jsx("p",{className:"text-sm text-gray-500 mt-1 line-clamp-2",children:o.jd_text})]},o.id))})})]}):null}function _3({jobTitle:r,jobDescription:e,onTitleChange:t,onDescriptionChange:s,errors:n={}}){const{jobs:i=[]}=Qp(),a=l=>{bc(l,e,i)||t(l)},o=l=>{bc(r,l,i)||s(l)};return g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center space-x-2",children:[g.jsx("h2",{className:"text-lg font-semibold",children:"Job Information"}),g.jsx("div",{className:"h-6 w-6 rounded-full bg-blue-100 flex items-center justify-center",children:g.jsx("span",{className:"text-blue-600 text-sm",children:"2"})})]}),g.jsx(x3,{onSelect:({title:l,description:c})=>{t(l),s(c)}})]}),g.jsx(Na,{id:"jobTitle",label:"Job Title",value:r,onChange:l=>a(l.target.value),error:n.title,placeholder:"Enter the job position title",required:!0}),g.jsx(ub,{type:"job",onFileSelect:()=>{},onTextExtracted:l=>o(l),onTitleExtracted:l=>a(l),label:"Upload Job Description (PDF)"}),g.jsx(Op,{id:"jobDescription",label:"Job Description",value:e,onChange:l=>o(l.target.value),error:n.description,placeholder:"Paste the job description here or upload a PDF above",required:!0})]})}function A3({score:r,verdict:e}){const t=()=>{switch(e){case"STRONG_FIT":return"text-green-600 bg-green-50 border-green-200";case"POTENTIAL_FIT":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"NEEDS_CONSIDERATION":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"NOT_RECOMMENDED":return"text-red-600 bg-red-50 border-red-200"}},s=()=>{switch(e){case"STRONG_FIT":return"Strong Match";case"POTENTIAL_FIT":return"Potential Match";case"NEEDS_CONSIDERATION":return"Potential Match";case"NOT_RECOMMENDED":return"Not Suitable"}};return g.jsxs("div",{className:`p-6 rounded-lg border ${t()}`,children:[g.jsx("h3",{className:"font-semibold mb-4",children:"Match Score"}),g.jsxs("div",{className:"flex items-baseline space-x-2",children:[g.jsx("span",{className:"text-5xl font-bold",children:r}),g.jsx("span",{className:"text-2xl",children:"/10"})]}),g.jsx("p",{className:"mt-2 text-sm font-medium",children:s()})]})}function S3({analysis:r}){const e=s=>{const n=i=>i>=90?"EXPERT":i>=80?"ADVANCED":i>=60?"INTERMEDIATE":i>=40?"BASIC":"BEGINNER";return{skill:s.name,proficiency:n(parseInt(s.proficiency,10)),evidence:s.assessment,currency:s.currency}},t=(r.technical_skills||[]).map(s=>"skill"in s&&"evidence"in s&&"currency"in s?s:e(s));return t.length?g.jsx("div",{className:"space-y-6",children:t.map((s,n)=>g.jsx("div",{className:"border rounded-lg p-4",children:g.jsxs("div",{className:"space-y-3",children:[g.jsxs("div",{className:"flex items-start justify-between",children:[g.jsx("div",{children:g.jsxs("h4",{className:"font-medium text-gray-900",children:["Skill: ",s.skill]})}),g.jsxs("div",{className:"flex items-center space-x-2",children:[g.jsx("span",{className:"text-sm text-gray-600",children:"Proficiency:"}),g.jsx("span",{className:"font-medium text-blue-600",children:s.proficiency})]})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex items-start",children:[g.jsx("span",{className:"text-gray-600 mr-2",children:"•"}),g.jsxs("div",{children:[g.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"Evidence: "}),g.jsx("span",{className:"text-sm text-gray-600",children:s.evidence})]})]}),g.jsxs("div",{className:"flex items-start",children:[g.jsx("span",{className:"text-gray-600 mr-2",children:"•"}),g.jsxs("div",{children:[g.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"Experience: "}),g.jsx("span",{className:"text-sm text-gray-600",children:s.currency})]})]})]})]})},n))}):g.jsx("p",{className:"text-sm text-gray-500 italic",children:"Technical skills analysis not available"})}function N3({factors:r=[]}){if(!r?.length)return g.jsx("div",{className:"text-sm text-gray-500 italic",children:g.jsx("p",{children:"No significant risk factors identified"})});const e=r.map(s=>{if(typeof s=="string"){const n=s.replace(/^RISK_FACTORS:\s*/i,"").trim(),i=/^-\s*Severity:\s*\[?(HIGH|MEDIUM|LOW)\]?\s*\n\s*\*\s*Description:\s*\[?([^\n\]]+)\]?\s*\n\s*\*\s*Mitigation:\s*\[?([^\n\]]+)\]?/im,a=n.match(i);if(a){const[,h,d,p]=a;return{severity:h.toUpperCase(),description:d.trim(),mitigation:p.trim()}}const o=n.match(/Severity:\s*\[?(HIGH|MEDIUM|LOW)\]?/i),l=n.match(/Description:\s*\[?([^\n\]]+)\]?/i),c=n.match(/Mitigation:\s*\[?([^\n\]]+)\]?/i);if(o)return{severity:o[1].toUpperCase(),description:l?.[1]?.trim()||n,mitigation:c?.[1]?.trim()};try{const h=JSON.parse(n);if(h&&typeof h=="object")return{severity:(h.severity||"MEDIUM").toUpperCase(),description:h.description||"",mitigation:h.mitigation||""}}catch{}return{severity:"MEDIUM",description:n}}return s}),t=s=>{switch(s){case"HIGH":return"text-red-500";case"MEDIUM":return"text-amber-500";case"LOW":return"text-yellow-500";default:return"text-amber-500"}};return g.jsx("div",{className:"space-y-4",children:e.map((s,n)=>g.jsx("div",{className:"rounded-lg bg-gray-50 p-4",children:g.jsxs("div",{className:"flex items-start space-x-3",children:[g.jsx(Ky,{className:`h-5 w-5 flex-shrink-0 mt-0.5 ${t(s.severity)}`}),g.jsxs("div",{className:"flex-1",children:[g.jsx("div",{className:"flex items-center space-x-2",children:g.jsx("span",{className:`text-xs font-medium ${t(s.severity)}`,children:s.severity})}),g.jsx("p",{className:"mt-1 text-sm text-gray-700",children:s.description}),s.mitigation&&g.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:[g.jsx("span",{className:"font-medium",children:"Mitigation: "}),s.mitigation]})]})]})},n))})}function E3({potential:r}){return r?g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{children:[g.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Growth Areas"}),g.jsx("div",{className:"space-y-2",children:r.areas.map((e,t)=>g.jsxs("div",{className:"flex items-start space-x-3",children:[g.jsx(ky,{className:"h-5 w-5 text-green-500 flex-shrink-0 mt-0.5"}),g.jsx("p",{className:"text-sm text-gray-700",children:e})]},t))})]}),r.recommendations.length>0&&g.jsxs("div",{children:[g.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Development Recommendations"}),g.jsx("ul",{className:"list-disc pl-5 space-y-1",children:r.recommendations.map((e,t)=>g.jsx("li",{className:"text-sm text-gray-600",children:e},t))})]})]}):g.jsx("p",{className:"text-sm text-gray-500 italic",children:"Growth potential analysis not available"})}function k3({plan:r}){const[e,t]=W.useState(null),n=(i=>{if(!i)return[];try{return i.replace(/^INTERVIEW_PLAN:\s*/i,"").replace(/\r\n/g,`
`).trim().split(/(?=\d+\.\s*Question Category:)/i).filter(l=>l.trim()).map(l=>{const c=l.match(/Question Category:\s*(.*?)\((\d+)\s*minutes\)/i);if(!c)return null;const[,h,d]=c,p=[],f=[],y=[],w=l.split(`
`).map(x=>x.trim());let A="";return w.forEach(x=>{if(x.startsWith("Primary Question:")){A="primary";const S=x.replace(/^Primary Question:\s*/i,"").trim();S&&p.unshift(S)}else if(x.startsWith("Follow-up Questions:"))A="followup";else if(x.startsWith("Red Flags:"))A="red";else if(x.startsWith("Green Flags:"))A="green";else if(x.startsWith("Expected Answer:")||x.startsWith("Evaluation Criteria:"))A="other";else if(x.startsWith("-")&&x.length>1){const S=x.replace(/^-\s*/,"").trim();switch(A){case"followup":p.push(S);break;case"red":f.push(S);break;case"green":y.push(S);break}}}),{title:h.trim(),duration:`${d} minutes`,questions:p,redFlags:f,greenFlags:y}}).filter(l=>l!==null)}catch(a){return console.error("Error parsing interview plan:",a),[]}})(r);return r?n.length===0?g.jsxs("div",{className:"text-gray-500 italic",children:[g.jsx("p",{children:"No interview plan sections found"}),!1]}):g.jsx("div",{className:"divide-y divide-gray-200",children:n.map((i,a)=>g.jsxs("div",{className:"py-4 first:pt-0 last:pb-0",children:[g.jsxs("button",{onClick:()=>t(e===i.title?null:i.title),className:"w-full flex items-center justify-between text-left",children:[g.jsxs("div",{children:[g.jsx("h4",{className:"text-lg font-medium text-gray-900",children:i.title}),g.jsx("p",{className:"text-sm text-gray-500",children:i.duration})]}),e===i.title?g.jsx(Du,{className:"h-5 w-5 text-gray-400"}):g.jsx(Zo,{className:"h-5 w-5 text-gray-400"})]}),e===i.title&&g.jsxs("div",{className:"mt-4 space-y-4",children:[i.questions.length>0&&g.jsxs("div",{children:[g.jsx("h5",{className:"font-medium text-gray-700 mb-2",children:"Questions:"}),g.jsx("ul",{className:"space-y-2",children:i.questions.map((o,l)=>g.jsxs("li",{className:"flex items-start space-x-2",children:[g.jsx("span",{className:"text-blue-600 mt-1",children:"•"}),g.jsx("span",{className:"text-gray-600",children:o})]},l))})]}),i.redFlags.length>0&&g.jsxs("div",{children:[g.jsx("h5",{className:"font-medium text-red-600 mb-2",children:"Watch out for:"}),g.jsx("ul",{className:"space-y-2",children:i.redFlags.map((o,l)=>g.jsxs("li",{className:"flex items-start space-x-2",children:[g.jsx("span",{className:"text-red-600 mt-1",children:"⚠"}),g.jsx("span",{className:"text-red-600",children:o})]},l))})]}),i.greenFlags.length>0&&g.jsxs("div",{children:[g.jsx("h5",{className:"font-medium text-green-600 mb-2",children:"Positive Indicators:"}),g.jsx("ul",{className:"space-y-2",children:i.greenFlags.map((o,l)=>g.jsxs("li",{className:"flex items-start space-x-2",children:[g.jsx("span",{className:"text-green-600 mt-1",children:"✓"}),g.jsx("span",{className:"text-green-600",children:o})]},l))})]})]})]},a))}):g.jsx("p",{className:"text-sm text-gray-500 italic",children:"Interview plan not available"})}function C3({analysis:r}){const[e,t]=W.useState({name:"",cv_text:""}),[s,n]=W.useState({title:"",company:"",jd_text:""});return W.useEffect(()=>{async function i(){const{data:a}=await lt.from("candidates").select("name, cv_text").eq("id",r.candidate_id).single(),{data:o}=await lt.from("jobs").select("title, company, jd_text").eq("id",r.job_id).single();a&&t(a),o&&n(o)}i()},[r.candidate_id,r.job_id]),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[g.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[g.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[g.jsx(dw,{className:"h-5 w-5 text-blue-600"}),g.jsx("h4",{className:"font-medium",children:"Candidate Profile"})]}),g.jsxs("div",{className:"space-y-3",children:[g.jsxs("div",{children:[g.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Name"}),g.jsx("p",{className:"text-base text-gray-900",children:e.name||"Loading..."})]}),g.jsxs("div",{children:[g.jsx("p",{className:"text-sm font-medium text-gray-500",children:"CV Summary"}),g.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:r.cv_summary})]})]})]}),g.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[g.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[g.jsx(kp,{className:"h-5 w-5 text-blue-600"}),g.jsx("h4",{className:"font-medium",children:"Position Details"})]}),g.jsxs("div",{className:"space-y-3",children:[g.jsxs("div",{children:[g.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Position"}),g.jsx("p",{className:"text-base text-gray-900",children:s.title||"Loading..."})]}),s.company&&g.jsxs("div",{children:[g.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Company"}),g.jsx("p",{className:"text-base text-gray-900",children:s.company})]}),g.jsxs("div",{children:[g.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Requirements"}),g.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:r.job_requirements})]})]})]})]})}function em(){const[r,e]=W.useState([]),t=W.useCallback((n,i="info")=>{e(a=>[...a,{id:Date.now(),message:n,type:i}])},[]),s=W.useCallback(n=>{e(i=>i.filter(a=>a.id!==n))},[]);return{toasts:r,addToast:t,removeToast:s}}async function P3(r){const{data:e,error:t}=await lt.from("analysis").select(`
      *,
      candidates (
        name,
        cv_text
      ),
      jobs (
        title,
        jd_text
      )
    `).eq("id",r).single();if(t)throw new Dt("Analysis not found",404);return{...e,cv_summary:e.candidates?.cv_text||"",job_requirements:e.jobs?.jd_text||""}}async function L3(){const{data:r,error:e}=await lt.from("analysis").select(`
      *,
      candidates (
        name
      ),
      jobs (
        title
      )
    `).order("created_at",{ascending:!1});if(e)throw new Dt("Failed to fetch analyses",500);return r?.map(t=>({...t,cv_summary:"",job_requirements:""}))||[]}async function T3(r,e){const{error:t}=await lt.from("analysis").update({notes:e}).eq("id",r);if(t)throw new Dt("Failed to update notes",500)}function I3(r){const[e,t]=W.useState(!1),{addToast:s}=em();return{isLoading:e,updateNotes:async i=>{t(!0);try{await T3(r,i),s("Notes updated successfully","success")}catch(a){throw s(a instanceof Error?a.message:"Failed to update notes","error"),a}finally{t(!1)}}}}function j3({analysis:r}){const[e,t]=W.useState(!1),{updateNotes:s,isLoading:n}=I3(r.id??""),[i,a]=W.useState(r.notes||""),o=async()=>{try{await s(i),t(!1)}catch{t(!0)}};return g.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[g.jsxs("div",{className:"flex justify-between items-center mb-4",children:[g.jsx("h3",{className:"font-medium",children:"Interview Notes"}),!e&&g.jsx(Vr,{variant:"secondary",onClick:()=>t(!0),children:"Edit Notes"})]}),e?g.jsxs("div",{className:"space-y-4",children:[g.jsx(Op,{label:"Notes",value:i,onChange:l=>a(l.target.value),placeholder:"Add your interview notes here..."}),g.jsxs("div",{className:"flex justify-end space-x-2",children:[g.jsx(Vr,{variant:"secondary",onClick:()=>t(!1),disabled:n,children:"Cancel"}),g.jsx(Vr,{onClick:o,isLoading:n,children:"Save Notes"})]})]}):g.jsx("div",{className:"prose max-w-none",children:r.notes?g.jsx("p",{className:"whitespace-pre-wrap",children:r.notes}):g.jsx("p",{className:"text-gray-500 italic",children:"No notes added yet"})})]})}function Bt(r){"@babel/helpers - typeof";return Bt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bt(r)}var sn=Uint8Array,Fn=Uint16Array,tm=Int32Array,rd=new sn([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),id=new sn([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Zf=new sn([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),db=function(r,e){for(var t=new Fn(31),s=0;s<31;++s)t[s]=e+=1<<r[s-1];for(var n=new tm(t[30]),s=1;s<30;++s)for(var i=t[s];i<t[s+1];++i)n[i]=i-t[s]<<5|s;return{b:t,r:n}},fb=db(rd,2),pb=fb.b,Qf=fb.r;pb[28]=258,Qf[258]=28;var mb=db(id,0),R3=mb.b,Xg=mb.r,ep=new Fn(32768);for(var Qt=0;Qt<32768;++Qt){var Mi=(Qt&43690)>>1|(Qt&21845)<<1;Mi=(Mi&52428)>>2|(Mi&13107)<<2,Mi=(Mi&61680)>>4|(Mi&3855)<<4,ep[Qt]=((Mi&65280)>>8|(Mi&255)<<8)>>1}var Gr=function(r,e,t){for(var s=r.length,n=0,i=new Fn(e);n<s;++n)r[n]&&++i[r[n]-1];var a=new Fn(e);for(n=1;n<e;++n)a[n]=a[n-1]+i[n-1]<<1;var o;if(t){o=new Fn(1<<e);var l=15-e;for(n=0;n<s;++n)if(r[n])for(var c=n<<4|r[n],h=e-r[n],d=a[r[n]-1]++<<h,p=d|(1<<h)-1;d<=p;++d)o[ep[d]>>l]=c}else for(o=new Fn(s),n=0;n<s;++n)r[n]&&(o[n]=ep[a[r[n]-1]++]>>15-r[n]);return o},Xi=new sn(288);for(var Qt=0;Qt<144;++Qt)Xi[Qt]=8;for(var Qt=144;Qt<256;++Qt)Xi[Qt]=9;for(var Qt=256;Qt<280;++Qt)Xi[Qt]=7;for(var Qt=280;Qt<288;++Qt)Xi[Qt]=8;var yc=new sn(32);for(var Qt=0;Qt<32;++Qt)yc[Qt]=5;var O3=Gr(Xi,9,0),M3=Gr(Xi,9,1),F3=Gr(yc,5,0),D3=Gr(yc,5,1),mf=function(r){for(var e=r[0],t=1;t<r.length;++t)r[t]>e&&(e=r[t]);return e},cr=function(r,e,t){var s=e/8|0;return(r[s]|r[s+1]<<8)>>(e&7)&t},gf=function(r,e){var t=e/8|0;return(r[t]|r[t+1]<<8|r[t+2]<<16)>>(e&7)},sm=function(r){return(r+7)/8|0},gb=function(r,e,t){return(t==null||t>r.length)&&(t=r.length),new sn(r.subarray(e,t))},B3=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],pr=function(r,e,t){var s=new Error(e||B3[r]);if(s.code=r,Error.captureStackTrace&&Error.captureStackTrace(s,pr),!t)throw s;return s},$3=function(r,e,t,s){var n=r.length,i=0;if(!n||e.f&&!e.l)return t||new sn(0);var a=!t,o=a||e.i!=2,l=e.i;a&&(t=new sn(n*3));var c=function(Ee){var Re=t.length;if(Ee>Re){var Le=new sn(Math.max(Re*2,Ee));Le.set(t),t=Le}},h=e.f||0,d=e.p||0,p=e.b||0,f=e.l,y=e.d,w=e.m,A=e.n,x=n*8;do{if(!f){h=cr(r,d,1);var S=cr(r,d+1,3);if(d+=3,S)if(S==1)f=M3,y=D3,w=9,A=5;else if(S==2){var Q=cr(r,d,31)+257,U=cr(r,d+10,15)+4,O=Q+cr(r,d+5,31)+1;d+=14;for(var G=new sn(O),ne=new sn(19),L=0;L<U;++L)ne[Zf[L]]=cr(r,d+L*3,7);d+=U*3;for(var j=mf(ne),V=(1<<j)-1,q=Gr(ne,j,1),L=0;L<O;){var le=q[cr(r,d,V)];d+=le&15;var I=le>>4;if(I<16)G[L++]=I;else{var ae=0,te=0;for(I==16?(te=3+cr(r,d,3),d+=2,ae=G[L-1]):I==17?(te=3+cr(r,d,7),d+=3):I==18&&(te=11+cr(r,d,127),d+=7);te--;)G[L++]=ae}}var K=G.subarray(0,Q),fe=G.subarray(Q);w=mf(K),A=mf(fe),f=Gr(K,w,1),y=Gr(fe,A,1)}else pr(1);else{var I=sm(d)+4,M=r[I-4]|r[I-3]<<8,B=I+M;if(B>n){l&&pr(0);break}o&&c(p+M),t.set(r.subarray(I,B),p),e.b=p+=M,e.p=d=B*8,e.f=h;continue}if(d>x){l&&pr(0);break}}o&&c(p+131072);for(var me=(1<<w)-1,Ae=(1<<A)-1,k=d;;k=d){var ae=f[gf(r,d)&me],D=ae>>4;if(d+=ae&15,d>x){l&&pr(0);break}if(ae||pr(2),D<256)t[p++]=D;else if(D==256){k=d,f=null;break}else{var z=D-254;if(D>264){var L=D-257,X=rd[L];z=cr(r,d,(1<<X)-1)+pb[L],d+=X}var ee=y[gf(r,d)&Ae],ie=ee>>4;ee||pr(3),d+=ee&15;var fe=R3[ie];if(ie>3){var X=id[ie];fe+=gf(r,d)&(1<<X)-1,d+=X}if(d>x){l&&pr(0);break}o&&c(p+131072);var ue=p+z;if(p<fe){var de=i-fe,ke=Math.min(fe,ue);for(de+p<0&&pr(3);p<ke;++p)t[p]=s[de+p]}for(;p<ue;++p)t[p]=t[p-fe]}}e.l=f,e.p=k,e.b=p,e.f=h,f&&(h=1,e.m=w,e.d=y,e.n=A)}while(!h);return p!=t.length&&a?gb(t,0,p):t.subarray(0,p)},hi=function(r,e,t){t<<=e&7;var s=e/8|0;r[s]|=t,r[s+1]|=t>>8},Ul=function(r,e,t){t<<=e&7;var s=e/8|0;r[s]|=t,r[s+1]|=t>>8,r[s+2]|=t>>16},bf=function(r,e){for(var t=[],s=0;s<r.length;++s)r[s]&&t.push({s,f:r[s]});var n=t.length,i=t.slice();if(!n)return{t:vb,l:0};if(n==1){var a=new sn(t[0].s+1);return a[t[0].s]=1,{t:a,l:1}}t.sort(function(B,Q){return B.f-Q.f}),t.push({s:-1,f:25001});var o=t[0],l=t[1],c=0,h=1,d=2;for(t[0]={s:-1,f:o.f+l.f,l:o,r:l};h!=n-1;)o=t[t[c].f<t[d].f?c++:d++],l=t[c!=h&&t[c].f<t[d].f?c++:d++],t[h++]={s:-1,f:o.f+l.f,l:o,r:l};for(var p=i[0].s,s=1;s<n;++s)i[s].s>p&&(p=i[s].s);var f=new Fn(p+1),y=tp(t[h-1],f,0);if(y>e){var s=0,w=0,A=y-e,x=1<<A;for(i.sort(function(Q,U){return f[U.s]-f[Q.s]||Q.f-U.f});s<n;++s){var S=i[s].s;if(f[S]>e)w+=x-(1<<y-f[S]),f[S]=e;else break}for(w>>=A;w>0;){var I=i[s].s;f[I]<e?w-=1<<e-f[I]++-1:++s}for(;s>=0&&w;--s){var M=i[s].s;f[M]==e&&(--f[M],++w)}y=e}return{t:new sn(f),l:y}},tp=function(r,e,t){return r.s==-1?Math.max(tp(r.l,e,t+1),tp(r.r,e,t+1)):e[r.s]=t},Yg=function(r){for(var e=r.length;e&&!r[--e];);for(var t=new Fn(++e),s=0,n=r[0],i=1,a=function(l){t[s++]=l},o=1;o<=e;++o)if(r[o]==n&&o!=e)++i;else{if(!n&&i>2){for(;i>138;i-=138)a(32754);i>2&&(a(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(a(n),--i;i>6;i-=6)a(8304);i>2&&(a(i-3<<5|8208),i=0)}for(;i--;)a(n);i=1,n=r[o]}return{c:t.subarray(0,s),n:e}},zl=function(r,e){for(var t=0,s=0;s<e.length;++s)t+=r[s]*e[s];return t},bb=function(r,e,t){var s=t.length,n=sm(e+2);r[n]=s&255,r[n+1]=s>>8,r[n+2]=r[n]^255,r[n+3]=r[n+1]^255;for(var i=0;i<s;++i)r[n+i+4]=t[i];return(n+4+s)*8},Kg=function(r,e,t,s,n,i,a,o,l,c,h){hi(e,h++,t),++n[256];for(var d=bf(n,15),p=d.t,f=d.l,y=bf(i,15),w=y.t,A=y.l,x=Yg(p),S=x.c,I=x.n,M=Yg(w),B=M.c,Q=M.n,U=new Fn(19),O=0;O<S.length;++O)++U[S[O]&31];for(var O=0;O<B.length;++O)++U[B[O]&31];for(var G=bf(U,7),ne=G.t,L=G.l,j=19;j>4&&!ne[Zf[j-1]];--j);var V=c+5<<3,q=zl(n,Xi)+zl(i,yc)+a,le=zl(n,p)+zl(i,w)+a+14+3*j+zl(U,ne)+2*U[16]+3*U[17]+7*U[18];if(l>=0&&V<=q&&V<=le)return bb(e,h,r.subarray(l,l+c));var ae,te,K,fe;if(hi(e,h,1+(le<q)),h+=2,le<q){ae=Gr(p,f,0),te=p,K=Gr(w,A,0),fe=w;var me=Gr(ne,L,0);hi(e,h,I-257),hi(e,h+5,Q-1),hi(e,h+10,j-4),h+=14;for(var O=0;O<j;++O)hi(e,h+3*O,ne[Zf[O]]);h+=3*j;for(var Ae=[S,B],k=0;k<2;++k)for(var D=Ae[k],O=0;O<D.length;++O){var z=D[O]&31;hi(e,h,me[z]),h+=ne[z],z>15&&(hi(e,h,D[O]>>5&127),h+=D[O]>>12)}}else ae=O3,te=Xi,K=F3,fe=yc;for(var O=0;O<o;++O){var X=s[O];if(X>255){var z=X>>18&31;Ul(e,h,ae[z+257]),h+=te[z+257],z>7&&(hi(e,h,X>>23&31),h+=rd[z]);var ee=X&31;Ul(e,h,K[ee]),h+=fe[ee],ee>3&&(Ul(e,h,X>>5&8191),h+=id[ee])}else Ul(e,h,ae[X]),h+=te[X]}return Ul(e,h,ae[256]),h+te[256]},q3=new tm([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),vb=new sn(0),U3=function(r,e,t,s,n,i){var a=i.z||r.length,o=new sn(s+a+5*(1+Math.ceil(a/7e3))+n),l=o.subarray(s,o.length-n),c=i.l,h=(i.r||0)&7;if(e){h&&(l[0]=i.r>>3);for(var d=q3[e-1],p=d>>13,f=d&8191,y=(1<<t)-1,w=i.p||new Fn(32768),A=i.h||new Fn(y+1),x=Math.ceil(t/3),S=2*x,I=function(Ke){return(r[Ke]^r[Ke+1]<<x^r[Ke+2]<<S)&y},M=new tm(25e3),B=new Fn(288),Q=new Fn(32),U=0,O=0,G=i.i||0,ne=0,L=i.w||0,j=0;G+2<a;++G){var V=I(G),q=G&32767,le=A[V];if(w[q]=le,A[V]=q,L<=G){var ae=a-G;if((U>7e3||ne>24576)&&(ae>423||!c)){h=Kg(r,l,0,M,B,Q,O,ne,j,G-j,h),ne=U=O=0,j=G;for(var te=0;te<286;++te)B[te]=0;for(var te=0;te<30;++te)Q[te]=0}var K=2,fe=0,me=f,Ae=q-le&32767;if(ae>2&&V==I(G-Ae))for(var k=Math.min(p,ae)-1,D=Math.min(32767,G),z=Math.min(258,ae);Ae<=D&&--me&&q!=le;){if(r[G+K]==r[G+K-Ae]){for(var X=0;X<z&&r[G+X]==r[G+X-Ae];++X);if(X>K){if(K=X,fe=Ae,X>k)break;for(var ee=Math.min(Ae,X-2),ie=0,te=0;te<ee;++te){var ue=G-Ae+te&32767,de=w[ue],ke=ue-de&32767;ke>ie&&(ie=ke,le=ue)}}}q=le,le=w[q],Ae+=q-le&32767}if(fe){M[ne++]=268435456|Qf[K]<<18|Xg[fe];var Ee=Qf[K]&31,Re=Xg[fe]&31;O+=rd[Ee]+id[Re],++B[257+Ee],++Q[Re],L=G+K,++U}else M[ne++]=r[G],++B[r[G]]}}for(G=Math.max(G,L);G<a;++G)M[ne++]=r[G],++B[r[G]];h=Kg(r,l,c,M,B,Q,O,ne,j,G-j,h),c||(i.r=h&7|l[h/8|0]<<3,h-=7,i.h=A,i.p=w,i.i=G,i.w=L)}else{for(var G=i.w||0;G<a+c;G+=65535){var Le=G+65535;Le>=a&&(l[h/8|0]=c,Le=a),h=bb(l,h+1,r.subarray(G,Le))}i.i=a}return gb(o,0,s+sm(h)+n)},yb=function(){var r=1,e=0;return{p:function(t){for(var s=r,n=e,i=t.length|0,a=0;a!=i;){for(var o=Math.min(a+2655,i);a<o;++a)n+=s+=t[a];s=(s&65535)+15*(s>>16),n=(n&65535)+15*(n>>16)}r=s,e=n},d:function(){return r%=65521,e%=65521,(r&255)<<24|(r&65280)<<8|(e&255)<<8|e>>8}}},z3=function(r,e,t,s,n){if(!n&&(n={l:1},e.dictionary)){var i=e.dictionary.subarray(-32768),a=new sn(i.length+r.length);a.set(i),a.set(r,i.length),r=a,n.w=i.length}return U3(r,e.level==null?6:e.level,e.mem==null?n.l?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):20:12+e.mem,t,s,n)},wb=function(r,e,t){for(;t;++e)r[e]=t,t>>>=8},H3=function(r,e){var t=e.level,s=t==0?0:t<6?1:t==9?3:2;if(r[0]=120,r[1]=s<<6|(e.dictionary&&32),r[1]|=31-(r[0]<<8|r[1])%31,e.dictionary){var n=yb();n.p(e.dictionary),wb(r,2,n.d())}},W3=function(r,e){return((r[0]&15)!=8||r[0]>>4>7||(r[0]<<8|r[1])%31)&&pr(6,"invalid zlib data"),(r[1]>>5&1)==+!e&&pr(6,"invalid zlib data: "+(r[1]&32?"need":"unexpected")+" dictionary"),(r[1]>>3&4)+2};function sp(r,e){e||(e={});var t=yb();t.p(r);var s=z3(r,e,e.dictionary?6:2,4);return H3(s,e),wb(s,s.length-4,t.d()),s}function V3(r,e){return $3(r.subarray(W3(r,e),-4),{i:2},e,e)}var G3=typeof TextDecoder<"u"&&new TextDecoder,X3=0;try{G3.decode(vb,{stream:!0}),X3=1}catch{}var Ze=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function vf(){Ze.console&&typeof Ze.console.log=="function"&&Ze.console.log.apply(Ze.console,arguments)}var Gt={log:vf,warn:function(r){Ze.console&&(typeof Ze.console.warn=="function"?Ze.console.warn.apply(Ze.console,arguments):vf.call(null,arguments))},error:function(r){Ze.console&&(typeof Ze.console.error=="function"?Ze.console.error.apply(Ze.console,arguments):vf(r))}};function yf(r,e,t){var s=new XMLHttpRequest;s.open("GET",r),s.responseType="blob",s.onload=function(){va(s.response,e,t)},s.onerror=function(){Gt.error("could not download file")},s.send()}function Jg(r){var e=new XMLHttpRequest;e.open("HEAD",r,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Yh(r){try{r.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),r.dispatchEvent(e)}}var cc,np,va=Ze.saveAs||((typeof window>"u"?"undefined":Bt(window))!=="object"||window!==Ze?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(r,e,t){var s=Ze.URL||Ze.webkitURL,n=document.createElement("a");e=e||r.name||"download",n.download=e,n.rel="noopener",typeof r=="string"?(n.href=r,n.origin!==location.origin?Jg(n.href)?yf(r,e,t):Yh(n,n.target="_blank"):Yh(n)):(n.href=s.createObjectURL(r),setTimeout(function(){s.revokeObjectURL(n.href)},4e4),setTimeout(function(){Yh(n)},0))}:"msSaveOrOpenBlob"in navigator?function(r,e,t){if(e=e||r.name||"download",typeof r=="string")if(Jg(r))yf(r,e,t);else{var s=document.createElement("a");s.href=r,s.target="_blank",setTimeout(function(){Yh(s)})}else navigator.msSaveOrOpenBlob(function(n,i){return i===void 0?i={autoBom:!1}:Bt(i)!=="object"&&(Gt.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n}(r,t),e)}:function(r,e,t,s){if((s=s||open("","_blank"))&&(s.document.title=s.document.body.innerText="downloading..."),typeof r=="string")return yf(r,e,t);var n=r.type==="application/octet-stream",i=/constructor/i.test(Ze.HTMLElement)||Ze.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||n&&i)&&(typeof FileReader>"u"?"undefined":Bt(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var h=o.result;h=a?h:h.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=h:location=h,s=null},o.readAsDataURL(r)}else{var l=Ze.URL||Ze.webkitURL,c=l.createObjectURL(r);s?s.location=c:location.href=c,s=null,setTimeout(function(){l.revokeObjectURL(c)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function xb(r){var e;r=r||"",this.ok=!1,r.charAt(0)=="#"&&(r=r.substr(1,6)),r={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[r=(r=r.replace(/ /g,"")).toLowerCase()]||r;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],s=0;s<t.length;s++){var n=t[s].re,i=t[s].process,a=n.exec(r);a&&(e=i(a),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),l=this.g.toString(16),c=this.b.toString(16);return o.length==1&&(o="0"+o),l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),"#"+o+l+c}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function wf(r,e){var t=r[0],s=r[1],n=r[2],i=r[3];t=Ys(t,s,n,i,e[0],7,-680876936),i=Ys(i,t,s,n,e[1],12,-389564586),n=Ys(n,i,t,s,e[2],17,606105819),s=Ys(s,n,i,t,e[3],22,-1044525330),t=Ys(t,s,n,i,e[4],7,-176418897),i=Ys(i,t,s,n,e[5],12,1200080426),n=Ys(n,i,t,s,e[6],17,-1473231341),s=Ys(s,n,i,t,e[7],22,-45705983),t=Ys(t,s,n,i,e[8],7,1770035416),i=Ys(i,t,s,n,e[9],12,-1958414417),n=Ys(n,i,t,s,e[10],17,-42063),s=Ys(s,n,i,t,e[11],22,-1990404162),t=Ys(t,s,n,i,e[12],7,1804603682),i=Ys(i,t,s,n,e[13],12,-40341101),n=Ys(n,i,t,s,e[14],17,-1502002290),t=Ks(t,s=Ys(s,n,i,t,e[15],22,1236535329),n,i,e[1],5,-165796510),i=Ks(i,t,s,n,e[6],9,-1069501632),n=Ks(n,i,t,s,e[11],14,643717713),s=Ks(s,n,i,t,e[0],20,-373897302),t=Ks(t,s,n,i,e[5],5,-701558691),i=Ks(i,t,s,n,e[10],9,38016083),n=Ks(n,i,t,s,e[15],14,-660478335),s=Ks(s,n,i,t,e[4],20,-405537848),t=Ks(t,s,n,i,e[9],5,568446438),i=Ks(i,t,s,n,e[14],9,-1019803690),n=Ks(n,i,t,s,e[3],14,-187363961),s=Ks(s,n,i,t,e[8],20,1163531501),t=Ks(t,s,n,i,e[13],5,-1444681467),i=Ks(i,t,s,n,e[2],9,-51403784),n=Ks(n,i,t,s,e[7],14,1735328473),t=Js(t,s=Ks(s,n,i,t,e[12],20,-1926607734),n,i,e[5],4,-378558),i=Js(i,t,s,n,e[8],11,-2022574463),n=Js(n,i,t,s,e[11],16,1839030562),s=Js(s,n,i,t,e[14],23,-35309556),t=Js(t,s,n,i,e[1],4,-1530992060),i=Js(i,t,s,n,e[4],11,1272893353),n=Js(n,i,t,s,e[7],16,-155497632),s=Js(s,n,i,t,e[10],23,-1094730640),t=Js(t,s,n,i,e[13],4,681279174),i=Js(i,t,s,n,e[0],11,-358537222),n=Js(n,i,t,s,e[3],16,-722521979),s=Js(s,n,i,t,e[6],23,76029189),t=Js(t,s,n,i,e[9],4,-640364487),i=Js(i,t,s,n,e[12],11,-421815835),n=Js(n,i,t,s,e[15],16,530742520),t=Zs(t,s=Js(s,n,i,t,e[2],23,-995338651),n,i,e[0],6,-198630844),i=Zs(i,t,s,n,e[7],10,1126891415),n=Zs(n,i,t,s,e[14],15,-1416354905),s=Zs(s,n,i,t,e[5],21,-57434055),t=Zs(t,s,n,i,e[12],6,1700485571),i=Zs(i,t,s,n,e[3],10,-1894986606),n=Zs(n,i,t,s,e[10],15,-1051523),s=Zs(s,n,i,t,e[1],21,-2054922799),t=Zs(t,s,n,i,e[8],6,1873313359),i=Zs(i,t,s,n,e[15],10,-30611744),n=Zs(n,i,t,s,e[6],15,-1560198380),s=Zs(s,n,i,t,e[13],21,1309151649),t=Zs(t,s,n,i,e[4],6,-145523070),i=Zs(i,t,s,n,e[11],10,-1120210379),n=Zs(n,i,t,s,e[2],15,718787259),s=Zs(s,n,i,t,e[9],21,-343485551),r[0]=Hi(t,r[0]),r[1]=Hi(s,r[1]),r[2]=Hi(n,r[2]),r[3]=Hi(i,r[3])}function ad(r,e,t,s,n,i){return e=Hi(Hi(e,r),Hi(s,i)),Hi(e<<n|e>>>32-n,t)}function Ys(r,e,t,s,n,i,a){return ad(e&t|~e&s,r,e,n,i,a)}function Ks(r,e,t,s,n,i,a){return ad(e&s|t&~s,r,e,n,i,a)}function Js(r,e,t,s,n,i,a){return ad(e^t^s,r,e,n,i,a)}function Zs(r,e,t,s,n,i,a){return ad(t^(e|~s),r,e,n,i,a)}function _b(r){var e,t=r.length,s=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=r.length;e+=64)wf(s,Y3(r.substring(e-64,e)));r=r.substring(e-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<r.length;e++)n[e>>2]|=r.charCodeAt(e)<<(e%4<<3);if(n[e>>2]|=128<<(e%4<<3),e>55)for(wf(s,n),e=0;e<16;e++)n[e]=0;return n[14]=8*t,wf(s,n),s}function Y3(r){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=r.charCodeAt(e)+(r.charCodeAt(e+1)<<8)+(r.charCodeAt(e+2)<<16)+(r.charCodeAt(e+3)<<24);return t}cc=Ze.atob.bind(Ze),np=Ze.btoa.bind(Ze);var Zg="0123456789abcdef".split("");function K3(r){for(var e="",t=0;t<4;t++)e+=Zg[r>>8*t+4&15]+Zg[r>>8*t&15];return e}function J3(r){return String.fromCharCode((255&r)>>0,(65280&r)>>8,(16711680&r)>>16,(4278190080&r)>>24)}function rp(r){return _b(r).map(J3).join("")}var Z3=function(r){for(var e=0;e<r.length;e++)r[e]=K3(r[e]);return r.join("")}(_b("hello"))!="5d41402abc4b2a76b9719d911017c592";function Hi(r,e){if(Z3){var t=(65535&r)+(65535&e);return(r>>16)+(e>>16)+(t>>16)<<16|65535&t}return r+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function ip(r,e){var t,s,n,i;if(r!==t){for(var a=(n=r,i=1+(256/r.length>>0),new Array(i+1).join(n)),o=[],l=0;l<256;l++)o[l]=l;var c=0;for(l=0;l<256;l++){var h=o[l];c=(c+h+a.charCodeAt(l))%256,o[l]=o[c],o[c]=h}t=r,s=o}else o=s;var d=e.length,p=0,f=0,y="";for(l=0;l<d;l++)f=(f+(h=o[p=(p+1)%256]))%256,o[p]=o[f],o[f]=h,a=o[(o[p]+o[f])%256],y+=String.fromCharCode(e.charCodeAt(l)^a);return y}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Qg={print:4,modify:8,copy:16,"annot-forms":32};function No(r,e,t,s){this.v=1,this.r=2;var n=192;r.forEach(function(o){if(Qg.perm!==void 0)throw new Error("Invalid permission: "+o);n+=Qg[o]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var i=(e+this.padding).substr(0,32),a=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,a),this.P=-(1+(255^n)),this.encryptionKey=rp(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(s)).substr(0,5),this.U=ip(this.encryptionKey,this.padding)}function Eo(r){if(/[^\u0000-\u00ff]/.test(r))throw new Error("Invalid PDF Name Object: "+r+", Only accept ASCII characters.");for(var e="",t=r.length,s=0;s<t;s++){var n=r.charCodeAt(s);n<33||n===35||n===37||n===40||n===41||n===47||n===60||n===62||n===91||n===93||n===123||n===125||n>126?e+="#"+("0"+n.toString(16)).slice(-2):e+=r[s]}return e}function e0(r){if(Bt(r)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,s,n){if(n=n||!1,typeof t!="string"||typeof s!="function"||typeof n!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var i=Math.random().toString(35);return e[t][i]=[s,!!n],i},this.unsubscribe=function(t){for(var s in e)if(e[s][t])return delete e[s][t],Object.keys(e[s]).length===0&&delete e[s],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var s=Array.prototype.slice.call(arguments,1),n=[];for(var i in e[t]){var a=e[t][i];try{a[0].apply(r,s)}catch(o){Ze.console&&Gt.error("jsPDF PubSub Error",o.message,o)}a[1]&&n.push(i)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Su(r){if(!(this instanceof Su))return new Su(r);var e="opacity,stroke-opacity".split(",");for(var t in r)r.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=r[t]);this.id="",this.objectNumber=-1}function Ab(r,e){this.gState=r,this.matrix=e,this.id="",this.objectNumber=-1}function xa(r,e,t,s,n){if(!(this instanceof xa))return new xa(r,e,t,s,n);this.type=r==="axial"?2:3,this.coords=e,this.colors=t,Ab.call(this,s,n)}function To(r,e,t,s,n){if(!(this instanceof To))return new To(r,e,t,s,n);this.boundingBox=r,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,Ab.call(this,s,n)}function Je(r){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",s=arguments[1],n=arguments[2],i=arguments[3],a=[],o=1,l=16,c="S",h=null;Bt(r=r||{})==="object"&&(t=r.orientation,s=r.unit||s,n=r.format||n,i=r.compress||r.compressPdf||i,(h=r.encryption||null)!==null&&(h.userPassword=h.userPassword||"",h.ownerPassword=h.ownerPassword||"",h.userPermissions=h.userPermissions||[]),o=typeof r.userUnit=="number"?Math.abs(r.userUnit):1,r.precision!==void 0&&(e=r.precision),r.floatPrecision!==void 0&&(l=r.floatPrecision),c=r.defaultPathOperation||"S"),a=r.filters||(i===!0?["FlateEncode"]:a),s=s||"mm",t=(""+(t||"P")).toLowerCase();var d=r.putOnlyUsedFonts||!1,p={},f={internal:{},__private__:{}};f.__private__.PubSub=e0;var y="1.3",w=f.__private__.getPdfVersion=function(){return y};f.__private__.setPdfVersion=function(b){y=b};var A={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};f.__private__.getPageFormats=function(){return A};var x=f.__private__.getPageFormat=function(b){return A[b]};n=n||"a4";var S={COMPAT:"compat",ADVANCED:"advanced"},I=S.COMPAT;function M(){this.saveGraphicsState(),H(new Ye(Me,0,0,-Me,0,Ai()*Me).toString()+" cm"),this.setFontSize(this.getFontSize()/Me),c="n",I=S.ADVANCED}function B(){this.restoreGraphicsState(),c="S",I=S.COMPAT}var Q=f.__private__.combineFontStyleAndFontWeight=function(b,E){if(b=="bold"&&E=="normal"||b=="bold"&&E==400||b=="normal"&&E=="italic"||b=="bold"&&E=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return E&&(b=E==400||E==="normal"?b==="italic"?"italic":"normal":E!=700&&E!=="bold"||b!=="normal"?(E==700?"bold":E)+""+b:"bold"),b};f.advancedAPI=function(b){var E=I===S.COMPAT;return E&&M.call(this),typeof b!="function"||(b(this),E&&B.call(this)),this},f.compatAPI=function(b){var E=I===S.ADVANCED;return E&&B.call(this),typeof b!="function"||(b(this),E&&M.call(this)),this},f.isAdvancedAPI=function(){return I===S.ADVANCED};var U,O=function(b){if(I!==S.ADVANCED)throw new Error(b+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},G=f.roundToPrecision=f.__private__.roundToPrecision=function(b,E){var $=e||E;if(isNaN(b)||isNaN($))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return b.toFixed($).replace(/0+$/,"")};U=f.hpf=f.__private__.hpf=typeof l=="number"?function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.hpf");return G(b,l)}:l==="smart"?function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.hpf");return G(b,b>-1&&b<1?16:5)}:function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.hpf");return G(b,16)};var ne=f.f2=f.__private__.f2=function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.f2");return G(b,2)},L=f.__private__.f3=function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.f3");return G(b,3)},j=f.scale=f.__private__.scale=function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.scale");return I===S.COMPAT?b*Me:I===S.ADVANCED?b:void 0},V=function(b){return I===S.COMPAT?Ai()-b:I===S.ADVANCED?b:void 0},q=function(b){return j(V(b))};f.__private__.setPrecision=f.setPrecision=function(b){typeof parseInt(b,10)=="number"&&(e=parseInt(b,10))};var le,ae="00000000000000000000000000000000",te=f.__private__.getFileId=function(){return ae},K=f.__private__.setFileId=function(b){return ae=b!==void 0&&/^[a-fA-F0-9]{32}$/.test(b)?b.toUpperCase():ae.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),h!==null&&(Gs=new No(h.userPermissions,h.userPassword,h.ownerPassword,ae)),ae};f.setFileId=function(b){return K(b),this},f.getFileId=function(){return te()};var fe=f.__private__.convertDateToPDFDate=function(b){var E=b.getTimezoneOffset(),$=E<0?"+":"-",Y=Math.floor(Math.abs(E/60)),oe=Math.abs(E%60),ge=[$,z(Y),"'",z(oe),"'"].join("");return["D:",b.getFullYear(),z(b.getMonth()+1),z(b.getDate()),z(b.getHours()),z(b.getMinutes()),z(b.getSeconds()),ge].join("")},me=f.__private__.convertPDFDateToDate=function(b){var E=parseInt(b.substr(2,4),10),$=parseInt(b.substr(6,2),10)-1,Y=parseInt(b.substr(8,2),10),oe=parseInt(b.substr(10,2),10),ge=parseInt(b.substr(12,2),10),_e=parseInt(b.substr(14,2),10);return new Date(E,$,Y,oe,ge,_e,0)},Ae=f.__private__.setCreationDate=function(b){var E;if(b===void 0&&(b=new Date),b instanceof Date)E=fe(b);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(b))throw new Error("Invalid argument passed to jsPDF.setCreationDate");E=b}return le=E},k=f.__private__.getCreationDate=function(b){var E=le;return b==="jsDate"&&(E=me(le)),E};f.setCreationDate=function(b){return Ae(b),this},f.getCreationDate=function(b){return k(b)};var D,z=f.__private__.padd2=function(b){return("0"+parseInt(b)).slice(-2)},X=f.__private__.padd2Hex=function(b){return("00"+(b=b.toString())).substr(b.length)},ee=0,ie=[],ue=[],de=0,ke=[],Ee=[],Re=!1,Le=ue,Ke=function(){ee=0,de=0,ue=[],ie=[],ke=[],Qr=ys(),tr=ys()};f.__private__.setCustomOutputDestination=function(b){Re=!0,Le=b};var be=function(b){Re||(Le=b)};f.__private__.resetCustomOutputDestination=function(){Re=!1,Le=ue};var H=f.__private__.out=function(b){return b=b.toString(),de+=b.length+1,Le.push(b),Le},ct=f.__private__.write=function(b){return H(arguments.length===1?b.toString():Array.prototype.join.call(arguments," "))},Ue=f.__private__.getArrayBuffer=function(b){for(var E=b.length,$=new ArrayBuffer(E),Y=new Uint8Array($);E--;)Y[E]=b.charCodeAt(E);return $},Ne=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];f.__private__.getStandardFonts=function(){return Ne};var Ce=r.fontSize||16;f.__private__.setFontSize=f.setFontSize=function(b){return Ce=I===S.ADVANCED?b/Me:b,this};var Oe,Ie=f.__private__.getFontSize=f.getFontSize=function(){return I===S.COMPAT?Ce:Ce*Me},Ve=r.R2L||!1;f.__private__.setR2L=f.setR2L=function(b){return Ve=b,this},f.__private__.getR2L=f.getR2L=function(){return Ve};var rt,ft=f.__private__.setZoomMode=function(b){var E=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(b))Oe=b;else if(isNaN(b)){if(E.indexOf(b)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+b+'" is not recognized.');Oe=b}else Oe=parseInt(b,10)};f.__private__.getZoomMode=function(){return Oe};var yt,Pt=f.__private__.setPageMode=function(b){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(b)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+b+'" is not recognized.');rt=b};f.__private__.getPageMode=function(){return rt};var qt=f.__private__.setLayoutMode=function(b){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(b)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+b+'" is not recognized.');yt=b};f.__private__.getLayoutMode=function(){return yt},f.__private__.setDisplayMode=f.setDisplayMode=function(b,E,$){return ft(b),qt(E),Pt($),this};var tt={title:"",subject:"",author:"",keywords:"",creator:""};f.__private__.getDocumentProperty=function(b){if(Object.keys(tt).indexOf(b)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return tt[b]},f.__private__.getDocumentProperties=function(){return tt},f.__private__.setDocumentProperties=f.setProperties=f.setDocumentProperties=function(b){for(var E in tt)tt.hasOwnProperty(E)&&b[E]&&(tt[E]=b[E]);return this},f.__private__.setDocumentProperty=function(b,E){if(Object.keys(tt).indexOf(b)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return tt[b]=E};var wt,Me,Vs,Tt,Zn,Wt={},es={},kr=[],jt={},ta={},as={},Qn={},Zr=null,os=0,it=[],Rt=new e0(f),sa=r.hotfixes||[],qs={},Cr={},Pr=[],Ye=function b(E,$,Y,oe,ge,_e){if(!(this instanceof b))return new b(E,$,Y,oe,ge,_e);isNaN(E)&&(E=1),isNaN($)&&($=0),isNaN(Y)&&(Y=0),isNaN(oe)&&(oe=1),isNaN(ge)&&(ge=0),isNaN(_e)&&(_e=0),this._matrix=[E,$,Y,oe,ge,_e]};Object.defineProperty(Ye.prototype,"sx",{get:function(){return this._matrix[0]},set:function(b){this._matrix[0]=b}}),Object.defineProperty(Ye.prototype,"shy",{get:function(){return this._matrix[1]},set:function(b){this._matrix[1]=b}}),Object.defineProperty(Ye.prototype,"shx",{get:function(){return this._matrix[2]},set:function(b){this._matrix[2]=b}}),Object.defineProperty(Ye.prototype,"sy",{get:function(){return this._matrix[3]},set:function(b){this._matrix[3]=b}}),Object.defineProperty(Ye.prototype,"tx",{get:function(){return this._matrix[4]},set:function(b){this._matrix[4]=b}}),Object.defineProperty(Ye.prototype,"ty",{get:function(){return this._matrix[5]},set:function(b){this._matrix[5]=b}}),Object.defineProperty(Ye.prototype,"a",{get:function(){return this._matrix[0]},set:function(b){this._matrix[0]=b}}),Object.defineProperty(Ye.prototype,"b",{get:function(){return this._matrix[1]},set:function(b){this._matrix[1]=b}}),Object.defineProperty(Ye.prototype,"c",{get:function(){return this._matrix[2]},set:function(b){this._matrix[2]=b}}),Object.defineProperty(Ye.prototype,"d",{get:function(){return this._matrix[3]},set:function(b){this._matrix[3]=b}}),Object.defineProperty(Ye.prototype,"e",{get:function(){return this._matrix[4]},set:function(b){this._matrix[4]=b}}),Object.defineProperty(Ye.prototype,"f",{get:function(){return this._matrix[5]},set:function(b){this._matrix[5]=b}}),Object.defineProperty(Ye.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Ye.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Ye.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Ye.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Ye.prototype.join=function(b){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(U).join(b)},Ye.prototype.multiply=function(b){var E=b.sx*this.sx+b.shy*this.shx,$=b.sx*this.shy+b.shy*this.sy,Y=b.shx*this.sx+b.sy*this.shx,oe=b.shx*this.shy+b.sy*this.sy,ge=b.tx*this.sx+b.ty*this.shx+this.tx,_e=b.tx*this.shy+b.ty*this.sy+this.ty;return new Ye(E,$,Y,oe,ge,_e)},Ye.prototype.decompose=function(){var b=this.sx,E=this.shy,$=this.shx,Y=this.sy,oe=this.tx,ge=this.ty,_e=Math.sqrt(b*b+E*E),Fe=(b/=_e)*$+(E/=_e)*Y;$-=b*Fe,Y-=E*Fe;var Ge=Math.sqrt($*$+Y*Y);return Fe/=Ge,b*(Y/=Ge)<E*($/=Ge)&&(b=-b,E=-E,Fe=-Fe,_e=-_e),{scale:new Ye(_e,0,0,Ge,0,0),translate:new Ye(1,0,0,1,oe,ge),rotate:new Ye(b,E,-E,b,0,0),skew:new Ye(1,0,Fe,1,0,0)}},Ye.prototype.toString=function(b){return this.join(" ")},Ye.prototype.inversed=function(){var b=this.sx,E=this.shy,$=this.shx,Y=this.sy,oe=this.tx,ge=this.ty,_e=1/(b*Y-E*$),Fe=Y*_e,Ge=-E*_e,ht=-$*_e,at=b*_e;return new Ye(Fe,Ge,ht,at,-Fe*oe-ht*ge,-Ge*oe-at*ge)},Ye.prototype.applyToPoint=function(b){var E=b.x*this.sx+b.y*this.shx+this.tx,$=b.x*this.shy+b.y*this.sy+this.ty;return new Qa(E,$)},Ye.prototype.applyToRectangle=function(b){var E=this.applyToPoint(b),$=this.applyToPoint(new Qa(b.x+b.w,b.y+b.h));return new pl(E.x,E.y,$.x-E.x,$.y-E.y)},Ye.prototype.clone=function(){var b=this.sx,E=this.shy,$=this.shx,Y=this.sy,oe=this.tx,ge=this.ty;return new Ye(b,E,$,Y,oe,ge)},f.Matrix=Ye;var er=f.matrixMult=function(b,E){return E.multiply(b)},Lr=new Ye(1,0,0,1,0,0);f.unitMatrix=f.identityMatrix=Lr;var fn=function(b,E){if(!ta[b]){var $=(E instanceof xa?"Sh":"P")+(Object.keys(jt).length+1).toString(10);E.id=$,ta[b]=$,jt[$]=E,Rt.publish("addPattern",E)}};f.ShadingPattern=xa,f.TilingPattern=To,f.addShadingPattern=function(b,E){return O("addShadingPattern()"),fn(b,E),this},f.beginTilingPattern=function(b){O("beginTilingPattern()"),fh(b.boundingBox[0],b.boundingBox[1],b.boundingBox[2]-b.boundingBox[0],b.boundingBox[3]-b.boundingBox[1],b.matrix)},f.endTilingPattern=function(b,E){O("endTilingPattern()"),E.stream=Ee[D].join(`
`),fn(b,E),Rt.publish("endTilingPattern",E),Pr.pop().restore()};var ks=f.__private__.newObject=function(){var b=ys();return En(b,!0),b},ys=f.__private__.newObjectDeferred=function(){return ee++,ie[ee]=function(){return de},ee},En=function(b,E){return E=typeof E=="boolean"&&E,ie[b]=de,E&&H(b+" 0 obj"),b},$a=f.__private__.newAdditionalObject=function(){var b={objId:ys(),content:""};return ke.push(b),b},Qr=ys(),tr=ys(),sr=f.__private__.decodeColorString=function(b){var E=b.split(" ");if(E.length!==2||E[1]!=="g"&&E[1]!=="G")E.length===5&&(E[4]==="k"||E[4]==="K")&&(E=[(1-E[0])*(1-E[3]),(1-E[1])*(1-E[3]),(1-E[2])*(1-E[3]),"r"]);else{var $=parseFloat(E[0]);E=[$,$,$,"r"]}for(var Y="#",oe=0;oe<3;oe++)Y+=("0"+Math.floor(255*parseFloat(E[oe])).toString(16)).slice(-2);return Y},nr=f.__private__.encodeColorString=function(b){var E;typeof b=="string"&&(b={ch1:b});var $=b.ch1,Y=b.ch2,oe=b.ch3,ge=b.ch4,_e=b.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof $=="string"&&$.charAt(0)!=="#"){var Fe=new xb($);if(Fe.ok)$=Fe.toHex();else if(!/^\d*\.?\d*$/.test($))throw new Error('Invalid color "'+$+'" passed to jsPDF.encodeColorString.')}if(typeof $=="string"&&/^#[0-9A-Fa-f]{3}$/.test($)&&($="#"+$[1]+$[1]+$[2]+$[2]+$[3]+$[3]),typeof $=="string"&&/^#[0-9A-Fa-f]{6}$/.test($)){var Ge=parseInt($.substr(1),16);$=Ge>>16&255,Y=Ge>>8&255,oe=255&Ge}if(Y===void 0||ge===void 0&&$===Y&&Y===oe)if(typeof $=="string")E=$+" "+_e[0];else switch(b.precision){case 2:E=ne($/255)+" "+_e[0];break;case 3:default:E=L($/255)+" "+_e[0]}else if(ge===void 0||Bt(ge)==="object"){if(ge&&!isNaN(ge.a)&&ge.a===0)return E=["1.","1.","1.",_e[1]].join(" ");if(typeof $=="string")E=[$,Y,oe,_e[1]].join(" ");else switch(b.precision){case 2:E=[ne($/255),ne(Y/255),ne(oe/255),_e[1]].join(" ");break;default:case 3:E=[L($/255),L(Y/255),L(oe/255),_e[1]].join(" ")}}else if(typeof $=="string")E=[$,Y,oe,ge,_e[2]].join(" ");else switch(b.precision){case 2:E=[ne($),ne(Y),ne(oe),ne(ge),_e[2]].join(" ");break;case 3:default:E=[L($),L(Y),L(oe),L(ge),_e[2]].join(" ")}return E},Tr=f.__private__.getFilters=function(){return a},Bn=f.__private__.putStream=function(b){var E=(b=b||{}).data||"",$=b.filters||Tr(),Y=b.alreadyAppliedFilters||[],oe=b.addLength1||!1,ge=E.length,_e=b.objectId,Fe=function(Xs){return Xs};if(h!==null&&_e===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");h!==null&&(Fe=Gs.encryptor(_e,0));var Ge={};$===!0&&($=["FlateEncode"]);var ht=b.additionalKeyValues||[],at=(Ge=Je.API.processDataByFilters!==void 0?Je.API.processDataByFilters(E,$):{data:E,reverseChain:[]}).reverseChain+(Array.isArray(Y)?Y.join(" "):Y.toString());if(Ge.data.length!==0&&(ht.push({key:"Length",value:Ge.data.length}),oe===!0&&ht.push({key:"Length1",value:ge})),at.length!=0)if(at.split("/").length-1==1)ht.push({key:"Filter",value:at});else{ht.push({key:"Filter",value:"["+at+"]"});for(var kt=0;kt<ht.length;kt+=1)if(ht[kt].key==="DecodeParms"){for(var ss=[],ls=0;ls<Ge.reverseChain.split("/").length-1;ls+=1)ss.push("null");ss.push(ht[kt].value),ht[kt].value="["+ss.join(" ")+"]"}}H("<<");for(var ws=0;ws<ht.length;ws++)H("/"+ht[ws].key+" "+ht[ws].value);H(">>"),Ge.data.length!==0&&(H("stream"),H(Fe(Ge.data)),H("endstream"))},Ir=f.__private__.putPage=function(b){var E=b.number,$=b.data,Y=b.objId,oe=b.contentsObjId;En(Y,!0),H("<</Type /Page"),H("/Parent "+b.rootDictionaryObjId+" 0 R"),H("/Resources "+b.resourceDictionaryObjId+" 0 R"),H("/MediaBox ["+parseFloat(U(b.mediaBox.bottomLeftX))+" "+parseFloat(U(b.mediaBox.bottomLeftY))+" "+U(b.mediaBox.topRightX)+" "+U(b.mediaBox.topRightY)+"]"),b.cropBox!==null&&H("/CropBox ["+U(b.cropBox.bottomLeftX)+" "+U(b.cropBox.bottomLeftY)+" "+U(b.cropBox.topRightX)+" "+U(b.cropBox.topRightY)+"]"),b.bleedBox!==null&&H("/BleedBox ["+U(b.bleedBox.bottomLeftX)+" "+U(b.bleedBox.bottomLeftY)+" "+U(b.bleedBox.topRightX)+" "+U(b.bleedBox.topRightY)+"]"),b.trimBox!==null&&H("/TrimBox ["+U(b.trimBox.bottomLeftX)+" "+U(b.trimBox.bottomLeftY)+" "+U(b.trimBox.topRightX)+" "+U(b.trimBox.topRightY)+"]"),b.artBox!==null&&H("/ArtBox ["+U(b.artBox.bottomLeftX)+" "+U(b.artBox.bottomLeftY)+" "+U(b.artBox.topRightX)+" "+U(b.artBox.topRightY)+"]"),typeof b.userUnit=="number"&&b.userUnit!==1&&H("/UserUnit "+b.userUnit),Rt.publish("putPage",{objId:Y,pageContext:it[E],pageNumber:E,page:$}),H("/Contents "+oe+" 0 R"),H(">>"),H("endobj");var ge=$.join(`
`);return I===S.ADVANCED&&(ge+=`
Q`),En(oe,!0),Bn({data:ge,filters:Tr(),objectId:oe}),H("endobj"),Y},na=f.__private__.putPages=function(){var b,E,$=[];for(b=1;b<=os;b++)it[b].objId=ys(),it[b].contentsObjId=ys();for(b=1;b<=os;b++)$.push(Ir({number:b,data:Ee[b],objId:it[b].objId,contentsObjId:it[b].contentsObjId,mediaBox:it[b].mediaBox,cropBox:it[b].cropBox,bleedBox:it[b].bleedBox,trimBox:it[b].trimBox,artBox:it[b].artBox,userUnit:it[b].userUnit,rootDictionaryObjId:Qr,resourceDictionaryObjId:tr}));En(Qr,!0),H("<</Type /Pages");var Y="/Kids [";for(E=0;E<os;E++)Y+=$[E]+" 0 R ";H(Y+"]"),H("/Count "+os),H(">>"),H("endobj"),Rt.publish("postPutPages")},qa=function(b){Rt.publish("putFont",{font:b,out:H,newObject:ks,putStream:Bn}),b.isAlreadyPutted!==!0&&(b.objectNumber=ks(),H("<<"),H("/Type /Font"),H("/BaseFont /"+Eo(b.postScriptName)),H("/Subtype /Type1"),typeof b.encoding=="string"&&H("/Encoding /"+b.encoding),H("/FirstChar 32"),H("/LastChar 255"),H(">>"),H("endobj"))},Ua=function(){for(var b in Wt)Wt.hasOwnProperty(b)&&(d===!1||d===!0&&p.hasOwnProperty(b))&&qa(Wt[b])},za=function(b){b.objectNumber=ks();var E=[];E.push({key:"Type",value:"/XObject"}),E.push({key:"Subtype",value:"/Form"}),E.push({key:"BBox",value:"["+[U(b.x),U(b.y),U(b.x+b.width),U(b.y+b.height)].join(" ")+"]"}),E.push({key:"Matrix",value:"["+b.matrix.toString()+"]"});var $=b.pages[1].join(`
`);Bn({data:$,additionalKeyValues:E,objectId:b.objectNumber}),H("endobj")},Ha=function(){for(var b in qs)qs.hasOwnProperty(b)&&za(qs[b])},Yc=function(b,E){var $,Y=[],oe=1/(E-1);for($=0;$<1;$+=oe)Y.push($);if(Y.push(1),b[0].offset!=0){var ge={offset:0,color:b[0].color};b.unshift(ge)}if(b[b.length-1].offset!=1){var _e={offset:1,color:b[b.length-1].color};b.push(_e)}for(var Fe="",Ge=0,ht=0;ht<Y.length;ht++){for($=Y[ht];$>b[Ge+1].offset;)Ge++;var at=b[Ge].offset,kt=($-at)/(b[Ge+1].offset-at),ss=b[Ge].color,ls=b[Ge+1].color;Fe+=X(Math.round((1-kt)*ss[0]+kt*ls[0]).toString(16))+X(Math.round((1-kt)*ss[1]+kt*ls[1]).toString(16))+X(Math.round((1-kt)*ss[2]+kt*ls[2]).toString(16))}return Fe.trim()},dd=function(b,E){E||(E=21);var $=ks(),Y=Yc(b.colors,E),oe=[];oe.push({key:"FunctionType",value:"0"}),oe.push({key:"Domain",value:"[0.0 1.0]"}),oe.push({key:"Size",value:"["+E+"]"}),oe.push({key:"BitsPerSample",value:"8"}),oe.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),oe.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Bn({data:Y,additionalKeyValues:oe,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:$}),H("endobj"),b.objectNumber=ks(),H("<< /ShadingType "+b.type),H("/ColorSpace /DeviceRGB");var ge="/Coords ["+U(parseFloat(b.coords[0]))+" "+U(parseFloat(b.coords[1]))+" ";b.type===2?ge+=U(parseFloat(b.coords[2]))+" "+U(parseFloat(b.coords[3])):ge+=U(parseFloat(b.coords[2]))+" "+U(parseFloat(b.coords[3]))+" "+U(parseFloat(b.coords[4]))+" "+U(parseFloat(b.coords[5])),H(ge+="]"),b.matrix&&H("/Matrix ["+b.matrix.toString()+"]"),H("/Function "+$+" 0 R"),H("/Extend [true true]"),H(">>"),H("endobj")},fd=function(b,E){var $=ys(),Y=ks();E.push({resourcesOid:$,objectOid:Y}),b.objectNumber=Y;var oe=[];oe.push({key:"Type",value:"/Pattern"}),oe.push({key:"PatternType",value:"1"}),oe.push({key:"PaintType",value:"1"}),oe.push({key:"TilingType",value:"1"}),oe.push({key:"BBox",value:"["+b.boundingBox.map(U).join(" ")+"]"}),oe.push({key:"XStep",value:U(b.xStep)}),oe.push({key:"YStep",value:U(b.yStep)}),oe.push({key:"Resources",value:$+" 0 R"}),b.matrix&&oe.push({key:"Matrix",value:"["+b.matrix.toString()+"]"}),Bn({data:b.stream,additionalKeyValues:oe,objectId:b.objectNumber}),H("endobj")},Wa=function(b){var E;for(E in jt)jt.hasOwnProperty(E)&&(jt[E]instanceof xa?dd(jt[E]):jt[E]instanceof To&&fd(jt[E],b))},Kc=function(b){for(var E in b.objectNumber=ks(),H("<<"),b)switch(E){case"opacity":H("/ca "+ne(b[E]));break;case"stroke-opacity":H("/CA "+ne(b[E]))}H(">>"),H("endobj")},pd=function(){var b;for(b in as)as.hasOwnProperty(b)&&Kc(as[b])},rl=function(){for(var b in H("/XObject <<"),qs)qs.hasOwnProperty(b)&&qs[b].objectNumber>=0&&H("/"+b+" "+qs[b].objectNumber+" 0 R");Rt.publish("putXobjectDict"),H(">>")},md=function(){Gs.oid=ks(),H("<<"),H("/Filter /Standard"),H("/V "+Gs.v),H("/R "+Gs.r),H("/U <"+Gs.toHexString(Gs.U)+">"),H("/O <"+Gs.toHexString(Gs.O)+">"),H("/P "+Gs.P),H(">>"),H("endobj")},Jc=function(){for(var b in H("/Font <<"),Wt)Wt.hasOwnProperty(b)&&(d===!1||d===!0&&p.hasOwnProperty(b))&&H("/"+b+" "+Wt[b].objectNumber+" 0 R");H(">>")},gd=function(){if(Object.keys(jt).length>0){for(var b in H("/Shading <<"),jt)jt.hasOwnProperty(b)&&jt[b]instanceof xa&&jt[b].objectNumber>=0&&H("/"+b+" "+jt[b].objectNumber+" 0 R");Rt.publish("putShadingPatternDict"),H(">>")}},Va=function(b){if(Object.keys(jt).length>0){for(var E in H("/Pattern <<"),jt)jt.hasOwnProperty(E)&&jt[E]instanceof f.TilingPattern&&jt[E].objectNumber>=0&&jt[E].objectNumber<b&&H("/"+E+" "+jt[E].objectNumber+" 0 R");Rt.publish("putTilingPatternDict"),H(">>")}},bd=function(){if(Object.keys(as).length>0){var b;for(b in H("/ExtGState <<"),as)as.hasOwnProperty(b)&&as[b].objectNumber>=0&&H("/"+b+" "+as[b].objectNumber+" 0 R");Rt.publish("putGStateDict"),H(">>")}},us=function(b){En(b.resourcesOid,!0),H("<<"),H("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Jc(),gd(),Va(b.objectOid),bd(),rl(),H(">>"),H("endobj")},Zc=function(){var b=[];Ua(),pd(),Ha(),Wa(b),Rt.publish("putResources"),b.forEach(us),us({resourcesOid:tr,objectOid:Number.MAX_SAFE_INTEGER}),Rt.publish("postPutResources")},Qc=function(){Rt.publish("putAdditionalObjects");for(var b=0;b<ke.length;b++){var E=ke[b];En(E.objId,!0),H(E.content),H("endobj")}Rt.publish("postPutAdditionalObjects")},eh=function(b){es[b.fontName]=es[b.fontName]||{},es[b.fontName][b.fontStyle]=b.id},il=function(b,E,$,Y,oe){var ge={id:"F"+(Object.keys(Wt).length+1).toString(10),postScriptName:b,fontName:E,fontStyle:$,encoding:Y,isStandardFont:oe||!1,metadata:{}};return Rt.publish("addFont",{font:ge,instance:this}),Wt[ge.id]=ge,eh(ge),ge.id},vd=function(b){for(var E=0,$=Ne.length;E<$;E++){var Y=il.call(this,b[E][0],b[E][1],b[E][2],Ne[E][3],!0);d===!1&&(p[Y]=!0);var oe=b[E][0].split("-");eh({id:Y,fontName:oe[0],fontStyle:oe[1]||""})}Rt.publish("addFonts",{fonts:Wt,dictionary:es})},rr=function(b){return b.foo=function(){try{return b.apply(this,arguments)}catch(Y){var E=Y.stack||"";~E.indexOf(" at ")&&(E=E.split(" at ")[1]);var $="Error in function "+E.split(`
`)[0].split("<")[0]+": "+Y.message;if(!Ze.console)throw new Error($);Ze.console.error($,Y),Ze.alert&&alert($)}},b.foo.bar=b,b.foo},Ga=function(b,E){var $,Y,oe,ge,_e,Fe,Ge,ht,at;if(oe=(E=E||{}).sourceEncoding||"Unicode",_e=E.outputEncoding,(E.autoencode||_e)&&Wt[wt].metadata&&Wt[wt].metadata[oe]&&Wt[wt].metadata[oe].encoding&&(ge=Wt[wt].metadata[oe].encoding,!_e&&Wt[wt].encoding&&(_e=Wt[wt].encoding),!_e&&ge.codePages&&(_e=ge.codePages[0]),typeof _e=="string"&&(_e=ge[_e]),_e)){for(Ge=!1,Fe=[],$=0,Y=b.length;$<Y;$++)(ht=_e[b.charCodeAt($)])?Fe.push(String.fromCharCode(ht)):Fe.push(b[$]),Fe[$].charCodeAt(0)>>8&&(Ge=!0);b=Fe.join("")}for($=b.length;Ge===void 0&&$!==0;)b.charCodeAt($-1)>>8&&(Ge=!0),$--;if(!Ge)return b;for(Fe=E.noBOM?[]:[254,255],$=0,Y=b.length;$<Y;$++){if((at=(ht=b.charCodeAt($))>>8)>>8)throw new Error("Character at position "+$+" of string '"+b+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Fe.push(at),Fe.push(ht-(at<<8))}return String.fromCharCode.apply(void 0,Fe)},pn=f.__private__.pdfEscape=f.pdfEscape=function(b,E){return Ga(b,E).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},al=f.__private__.beginPage=function(b){Ee[++os]=[],it[os]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(b[0]),topRightY:Number(b[1])}},sh(os),be(Ee[D])},th=function(b,E){var $,Y,oe;switch(t=E||t,typeof b=="string"&&($=x(b.toLowerCase()),Array.isArray($)&&(Y=$[0],oe=$[1])),Array.isArray(b)&&(Y=b[0]*Me,oe=b[1]*Me),isNaN(Y)&&(Y=n[0],oe=n[1]),(Y>14400||oe>14400)&&(Gt.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Y=Math.min(14400,Y),oe=Math.min(14400,oe)),n=[Y,oe],t.substr(0,1)){case"l":oe>Y&&(n=[oe,Y]);break;case"p":Y>oe&&(n=[oe,Y])}al(n),lh(hl),H(ir),dl!==0&&H(dl+" J"),fl!==0&&H(fl+" j"),Rt.publish("addPage",{pageNumber:os})},yd=function(b){b>0&&b<=os&&(Ee.splice(b,1),it.splice(b,1),os--,D>os&&(D=os),this.setPage(D))},sh=function(b){b>0&&b<=os&&(D=b)},wd=f.__private__.getNumberOfPages=f.getNumberOfPages=function(){return Ee.length-1},nh=function(b,E,$){var Y,oe=void 0;return $=$||{},b=b!==void 0?b:Wt[wt].fontName,E=E!==void 0?E:Wt[wt].fontStyle,Y=b.toLowerCase(),es[Y]!==void 0&&es[Y][E]!==void 0?oe=es[Y][E]:es[b]!==void 0&&es[b][E]!==void 0?oe=es[b][E]:$.disableWarning===!1&&Gt.warn("Unable to look up font label for font '"+b+"', '"+E+"'. Refer to getFontList() for available fonts."),oe||$.noFallback||(oe=es.times[E])==null&&(oe=es.times.normal),oe},xd=f.__private__.putInfo=function(){var b=ks(),E=function(Y){return Y};for(var $ in h!==null&&(E=Gs.encryptor(b,0)),H("<<"),H("/Producer ("+pn(E("jsPDF "+Je.version))+")"),tt)tt.hasOwnProperty($)&&tt[$]&&H("/"+$.substr(0,1).toUpperCase()+$.substr(1)+" ("+pn(E(tt[$]))+")");H("/CreationDate ("+pn(E(le))+")"),H(">>"),H("endobj")},ol=f.__private__.putCatalog=function(b){var E=(b=b||{}).rootDictionaryObjId||Qr;switch(ks(),H("<<"),H("/Type /Catalog"),H("/Pages "+E+" 0 R"),Oe||(Oe="fullwidth"),Oe){case"fullwidth":H("/OpenAction [3 0 R /FitH null]");break;case"fullheight":H("/OpenAction [3 0 R /FitV null]");break;case"fullpage":H("/OpenAction [3 0 R /Fit]");break;case"original":H("/OpenAction [3 0 R /XYZ null null 1]");break;default:var $=""+Oe;$.substr($.length-1)==="%"&&(Oe=parseInt(Oe)/100),typeof Oe=="number"&&H("/OpenAction [3 0 R /XYZ null null "+ne(Oe)+"]")}switch(yt||(yt="continuous"),yt){case"continuous":H("/PageLayout /OneColumn");break;case"single":H("/PageLayout /SinglePage");break;case"two":case"twoleft":H("/PageLayout /TwoColumnLeft");break;case"tworight":H("/PageLayout /TwoColumnRight")}rt&&H("/PageMode /"+rt),Rt.publish("putCatalog"),H(">>"),H("endobj")},_d=f.__private__.putTrailer=function(){H("trailer"),H("<<"),H("/Size "+(ee+1)),H("/Root "+ee+" 0 R"),H("/Info "+(ee-1)+" 0 R"),h!==null&&H("/Encrypt "+Gs.oid+" 0 R"),H("/ID [ <"+ae+"> <"+ae+"> ]"),H(">>")},Ad=f.__private__.putHeader=function(){H("%PDF-"+y),H("%ºß¬à")},Sd=f.__private__.putXRef=function(){var b="0000000000";H("xref"),H("0 "+(ee+1)),H("0000000000 65535 f ");for(var E=1;E<=ee;E++)typeof ie[E]=="function"?H((b+ie[E]()).slice(-10)+" 00000 n "):ie[E]!==void 0?H((b+ie[E]).slice(-10)+" 00000 n "):H("0000000000 00000 n ")},ei=f.__private__.buildDocument=function(){Ke(),be(ue),Rt.publish("buildDocument"),Ad(),na(),Qc(),Zc(),h!==null&&md(),xd(),ol();var b=de;return Sd(),_d(),H("startxref"),H(""+b),H("%%EOF"),be(Ee[D]),ue.join(`
`)},Xa=f.__private__.getBlob=function(b){return new Blob([Ue(b)],{type:"application/pdf"})},Ya=f.output=f.__private__.output=rr(function(b,E){switch(typeof(E=E||{})=="string"?E={filename:E}:E.filename=E.filename||"generated.pdf",b){case void 0:return ei();case"save":f.save(E.filename);break;case"arraybuffer":return Ue(ei());case"blob":return Xa(ei());case"bloburi":case"bloburl":if(Ze.URL!==void 0&&typeof Ze.URL.createObjectURL=="function")return Ze.URL&&Ze.URL.createObjectURL(Xa(ei()))||void 0;Gt.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var $="",Y=ei();try{$=np(Y)}catch{$=np(unescape(encodeURIComponent(Y)))}return"data:application/pdf;filename="+E.filename+";base64,"+$;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Ze)==="[object Window]"){var oe="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",ge=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';E.pdfObjectUrl&&(oe=E.pdfObjectUrl,ge="");var _e='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+oe+'"'+ge+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(E)+");<\/script></body></html>",Fe=Ze.open();return Fe!==null&&Fe.document.write(_e),Fe}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Ze)==="[object Window]"){var Ge='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(E.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+E.filename+'" width="500px" height="400px" /></body></html>',ht=Ze.open();if(ht!==null){ht.document.write(Ge);var at=this;ht.document.documentElement.querySelector("#pdfViewer").onload=function(){ht.document.title=E.filename,ht.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(at.output("bloburl"))}}return ht}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Ze)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var kt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",E)+'"></iframe></body></html>',ss=Ze.open();if(ss!==null&&(ss.document.write(kt),ss.document.title=E.filename),ss||typeof safari>"u")return ss;break;case"datauri":case"dataurl":return Ze.document.location.href=this.output("datauristring",E);default:return null}}),rh=function(b){return Array.isArray(sa)===!0&&sa.indexOf(b)>-1};switch(s){case"pt":Me=1;break;case"mm":Me=72/25.4;break;case"cm":Me=72/2.54;break;case"in":Me=72;break;case"px":Me=rh("px_scaling")==1?.75:96/72;break;case"pc":case"em":Me=12;break;case"ex":Me=6;break;default:if(typeof s!="number")throw new Error("Invalid unit: "+s);Me=s}var Gs=null;Ae(),K();var Nd=function(b){return h!==null?Gs.encryptor(b,0):function(E){return E}},ih=f.__private__.getPageInfo=f.getPageInfo=function(b){if(isNaN(b)||b%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:it[b].objId,pageNumber:b,pageContext:it[b]}},st=f.__private__.getPageInfoByObjId=function(b){if(isNaN(b)||b%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var E in it)if(it[E].objId===b)break;return ih(E)},Ed=f.__private__.getCurrentPageInfo=f.getCurrentPageInfo=function(){return{objId:it[D].objId,pageNumber:D,pageContext:it[D]}};f.addPage=function(){return th.apply(this,arguments),this},f.setPage=function(){return sh.apply(this,arguments),be.call(this,Ee[D]),this},f.insertPage=function(b){return this.addPage(),this.movePage(D,b),this},f.movePage=function(b,E){var $,Y;if(b>E){$=Ee[b],Y=it[b];for(var oe=b;oe>E;oe--)Ee[oe]=Ee[oe-1],it[oe]=it[oe-1];Ee[E]=$,it[E]=Y,this.setPage(E)}else if(b<E){$=Ee[b],Y=it[b];for(var ge=b;ge<E;ge++)Ee[ge]=Ee[ge+1],it[ge]=it[ge+1];Ee[E]=$,it[E]=Y,this.setPage(E)}return this},f.deletePage=function(){return yd.apply(this,arguments),this},f.__private__.text=f.text=function(b,E,$,Y,oe){var ge,_e,Fe,Ge,ht,at,kt,ss,ls,ws=(Y=Y||{}).scope||this;if(typeof b=="number"&&typeof E=="number"&&(typeof $=="string"||Array.isArray($))){var Xs=$;$=E,E=b,b=Xs}if(arguments[3]instanceof Ye?(O("The transform parameter of text() with a Matrix value"),ls=oe):(Fe=arguments[4],Ge=arguments[5],Bt(kt=arguments[3])==="object"&&kt!==null||(typeof Fe=="string"&&(Ge=Fe,Fe=null),typeof kt=="string"&&(Ge=kt,kt=null),typeof kt=="number"&&(Fe=kt,kt=null),Y={flags:kt,angle:Fe,align:Ge})),isNaN(E)||isNaN($)||b==null)throw new Error("Invalid arguments passed to jsPDF.text");if(b.length===0)return ws;var Rs="",ar=!1,kn=typeof Y.lineHeightFactor=="number"?Y.lineHeightFactor:ia,Or=ws.internal.scaleFactor;function ph(Kt){return Kt=Kt.split("	").join(Array(Y.TabLen||9).join(" ")),pn(Kt,kt)}function vl(Kt){for(var Jt,fs=Kt.concat(),Cs=[],ii=fs.length;ii--;)typeof(Jt=fs.shift())=="string"?Cs.push(Jt):Array.isArray(Kt)&&(Jt.length===1||Jt[1]===void 0&&Jt[2]===void 0)?Cs.push(Jt[0]):Cs.push([Jt[0],Jt[1],Jt[2]]);return Cs}function yl(Kt,Jt){var fs;if(typeof Kt=="string")fs=Jt(Kt)[0];else if(Array.isArray(Kt)){for(var Cs,ii,kl=Kt.concat(),ho=[],yh=kl.length;yh--;)typeof(Cs=kl.shift())=="string"?ho.push(Jt(Cs)[0]):Array.isArray(Cs)&&typeof Cs[0]=="string"&&(ii=Jt(Cs[0],Cs[1],Cs[2]),ho.push([ii[0],ii[1],ii[2]]));fs=ho}return fs}var to=!1,wl=!0;if(typeof b=="string")to=!0;else if(Array.isArray(b)){var xl=b.concat();_e=[];for(var so,Us=xl.length;Us--;)(typeof(so=xl.shift())!="string"||Array.isArray(so)&&typeof so[0]!="string")&&(wl=!1);to=wl}if(to===!1)throw new Error('Type of text must be string or Array. "'+b+'" is not recognized.');typeof b=="string"&&(b=b.match(/[\r?\n]/)?b.split(/\r\n|\r|\n/g):[b]);var no=Ce/ws.internal.scaleFactor,ro=no*(kn-1);switch(Y.baseline){case"bottom":$-=ro;break;case"top":$+=no-ro;break;case"hanging":$+=no-2*ro;break;case"middle":$+=no/2-ro}if((at=Y.maxWidth||0)>0&&(typeof b=="string"?b=ws.splitTextToSize(b,at):Object.prototype.toString.call(b)==="[object Array]"&&(b=b.reduce(function(Kt,Jt){return Kt.concat(ws.splitTextToSize(Jt,at))},[]))),ge={text:b,x:E,y:$,options:Y,mutex:{pdfEscape:pn,activeFontKey:wt,fonts:Wt,activeFontSize:Ce}},Rt.publish("preProcessText",ge),b=ge.text,Fe=(Y=ge.options).angle,!(ls instanceof Ye)&&Fe&&typeof Fe=="number"){Fe*=Math.PI/180,Y.rotationDirection===0&&(Fe=-Fe),I===S.ADVANCED&&(Fe=-Fe);var io=Math.cos(Fe),_l=Math.sin(Fe);ls=new Ye(io,_l,-_l,io,0,0)}else Fe&&Fe instanceof Ye&&(ls=Fe);I!==S.ADVANCED||ls||(ls=Lr),(ht=Y.charSpace||Za)!==void 0&&(Rs+=U(j(ht))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(ss=Y.horizontalScale)!==void 0&&(Rs+=U(100*ss)+` Tz
`),Y.lang;var mn=-1,Md=Y.renderingMode!==void 0?Y.renderingMode:Y.stroke,Al=ws.internal.getCurrentPageInfo().pageContext;switch(Md){case 0:case!1:case"fill":mn=0;break;case 1:case!0:case"stroke":mn=1;break;case 2:case"fillThenStroke":mn=2;break;case 3:case"invisible":mn=3;break;case 4:case"fillAndAddForClipping":mn=4;break;case 5:case"strokeAndAddPathForClipping":mn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":mn=6;break;case 7:case"addToPathForClipping":mn=7}var mh=Al.usedRenderingMode!==void 0?Al.usedRenderingMode:-1;mn!==-1?Rs+=mn+` Tr
`:mh!==-1&&(Rs+=`0 Tr
`),mn!==-1&&(Al.usedRenderingMode=mn),Ge=Y.align||"left";var $n,ao=Ce*kn,gh=ws.internal.pageSize.getWidth(),bh=Wt[wt];ht=Y.charSpace||Za,at=Y.maxWidth||0,kt=Object.assign({autoencode:!0,noBOM:!0},Y.flags);var Si=[],la=function(Kt){return ws.getStringUnitWidth(Kt,{font:bh,charSpace:ht,fontSize:Ce,doKerning:!1})*Ce/Or};if(Object.prototype.toString.call(b)==="[object Array]"){var gn;_e=vl(b),Ge!=="left"&&($n=_e.map(la));var rn,Ni=0;if(Ge==="right"){E-=$n[0],b=[],Us=_e.length;for(var si=0;si<Us;si++)si===0?(rn=Rr(E),gn=ti($)):(rn=j(Ni-$n[si]),gn=-ao),b.push([_e[si],rn,gn]),Ni=$n[si]}else if(Ge==="center"){E-=$n[0]/2,b=[],Us=_e.length;for(var ni=0;ni<Us;ni++)ni===0?(rn=Rr(E),gn=ti($)):(rn=j((Ni-$n[ni])/2),gn=-ao),b.push([_e[ni],rn,gn]),Ni=$n[ni]}else if(Ge==="left"){b=[],Us=_e.length;for(var oo=0;oo<Us;oo++)b.push(_e[oo])}else if(Ge==="justify"&&bh.encoding==="Identity-H"){b=[],Us=_e.length,at=at!==0?at:gh;for(var ri=0,ds=0;ds<Us;ds++)if(gn=ds===0?ti($):-ao,rn=ds===0?Rr(E):ri,ds<Us-1){var Sl=j((at-$n[ds])/(_e[ds].split(" ").length-1)),an=_e[ds].split(" ");b.push([an[0]+" ",rn,gn]),ri=0;for(var qn=1;qn<an.length;qn++){var lo=(la(an[qn-1]+" "+an[qn])-la(an[qn]))*Or+Sl;qn==an.length-1?b.push([an[qn],lo,0]):b.push([an[qn]+" ",lo,0]),ri-=lo}}else b.push([_e[ds],rn,gn]);b.push(["",ri,0])}else{if(Ge!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(b=[],Us=_e.length,at=at!==0?at:gh,ds=0;ds<Us;ds++)gn=ds===0?ti($):-ao,rn=ds===0?Rr(E):0,ds<Us-1?Si.push(U(j((at-$n[ds])/(_e[ds].split(" ").length-1)))):Si.push(0),b.push([_e[ds],rn,gn])}}var vh=typeof Y.R2L=="boolean"?Y.R2L:Ve;vh===!0&&(b=yl(b,function(Kt,Jt,fs){return[Kt.split("").reverse().join(""),Jt,fs]})),ge={text:b,x:E,y:$,options:Y,mutex:{pdfEscape:pn,activeFontKey:wt,fonts:Wt,activeFontSize:Ce}},Rt.publish("postProcessText",ge),b=ge.text,ar=ge.mutex.isHex||!1;var Nl=Wt[wt].encoding;Nl!=="WinAnsiEncoding"&&Nl!=="StandardEncoding"||(b=yl(b,function(Kt,Jt,fs){return[ph(Kt),Jt,fs]})),_e=vl(b),b=[];for(var ca,ha,Ei,ua=0,co=1,da=Array.isArray(_e[0])?co:ua,ki="",El=function(Kt,Jt,fs){var Cs="";return fs instanceof Ye?(fs=typeof Y.angle=="number"?er(fs,new Ye(1,0,0,1,Kt,Jt)):er(new Ye(1,0,0,1,Kt,Jt),fs),I===S.ADVANCED&&(fs=er(new Ye(1,0,0,-1,0,0),fs)),Cs=fs.join(" ")+` Tm
`):Cs=U(Kt)+" "+U(Jt)+` Td
`,Cs},Un=0;Un<_e.length;Un++){switch(ki="",da){case co:Ei=(ar?"<":"(")+_e[Un][0]+(ar?">":")"),ca=parseFloat(_e[Un][1]),ha=parseFloat(_e[Un][2]);break;case ua:Ei=(ar?"<":"(")+_e[Un]+(ar?">":")"),ca=Rr(E),ha=ti($)}Si!==void 0&&Si[Un]!==void 0&&(ki=Si[Un]+` Tw
`),Un===0?b.push(ki+El(ca,ha,ls)+Ei):da===ua?b.push(ki+Ei):da===co&&b.push(ki+El(ca,ha,ls)+Ei)}b=da===ua?b.join(` Tj
T* `):b.join(` Tj
`),b+=` Tj
`;var zn=`BT
/`;return zn+=wt+" "+Ce+` Tf
`,zn+=U(Ce*kn)+` TL
`,zn+=aa+`
`,zn+=Rs,zn+=b,H(zn+="ET"),p[wt]=!0,ws};var kd=f.__private__.clip=f.clip=function(b){return H(b==="evenodd"?"W*":"W"),this};f.clipEvenOdd=function(){return kd("evenodd")},f.__private__.discardPath=f.discardPath=function(){return H("n"),this};var jr=f.__private__.isValidStyle=function(b){var E=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(b)!==-1&&(E=!0),E};f.__private__.setDefaultPathOperation=f.setDefaultPathOperation=function(b){return jr(b)&&(c=b),this};var ah=f.__private__.getStyle=f.getStyle=function(b){var E=c;switch(b){case"D":case"S":E="S";break;case"F":E="f";break;case"FD":case"DF":E="B";break;case"f":case"f*":case"B":case"B*":E=b}return E},oh=f.close=function(){return H("h"),this};f.stroke=function(){return H("S"),this},f.fill=function(b){return Ka("f",b),this},f.fillEvenOdd=function(b){return Ka("f*",b),this},f.fillStroke=function(b){return Ka("B",b),this},f.fillStrokeEvenOdd=function(b){return Ka("B*",b),this};var Ka=function(b,E){Bt(E)==="object"?Pd(E,b):H(b)},ll=function(b){b===null||I===S.ADVANCED&&b===void 0||(b=ah(b),H(b))};function Cd(b,E,$,Y,oe){var ge=new To(E||this.boundingBox,$||this.xStep,Y||this.yStep,this.gState,oe||this.matrix);ge.stream=this.stream;var _e=b+"$$"+this.cloneIndex+++"$$";return fn(_e,ge),ge}var Pd=function(b,E){var $=ta[b.key],Y=jt[$];if(Y instanceof xa)H("q"),H(Ld(E)),Y.gState&&f.setGState(Y.gState),H(b.matrix.toString()+" cm"),H("/"+$+" sh"),H("Q");else if(Y instanceof To){var oe=new Ye(1,0,0,-1,0,Ai());b.matrix&&(oe=oe.multiply(b.matrix||Lr),$=Cd.call(Y,b.key,b.boundingBox,b.xStep,b.yStep,oe).id),H("q"),H("/Pattern cs"),H("/"+$+" scn"),Y.gState&&f.setGState(Y.gState),H(E),H("Q")}},Ld=function(b){switch(b){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},cl=f.moveTo=function(b,E){return H(U(j(b))+" "+U(q(E))+" m"),this},ra=f.lineTo=function(b,E){return H(U(j(b))+" "+U(q(E))+" l"),this},xi=f.curveTo=function(b,E,$,Y,oe,ge){return H([U(j(b)),U(q(E)),U(j($)),U(q(Y)),U(j(oe)),U(q(ge)),"c"].join(" ")),this};f.__private__.line=f.line=function(b,E,$,Y,oe){if(isNaN(b)||isNaN(E)||isNaN($)||isNaN(Y)||!jr(oe))throw new Error("Invalid arguments passed to jsPDF.line");return I===S.COMPAT?this.lines([[$-b,Y-E]],b,E,[1,1],oe||"S"):this.lines([[$-b,Y-E]],b,E,[1,1]).stroke()},f.__private__.lines=f.lines=function(b,E,$,Y,oe,ge){var _e,Fe,Ge,ht,at,kt,ss,ls,ws,Xs,Rs,ar;if(typeof b=="number"&&(ar=$,$=E,E=b,b=ar),Y=Y||[1,1],ge=ge||!1,isNaN(E)||isNaN($)||!Array.isArray(b)||!Array.isArray(Y)||!jr(oe)||typeof ge!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(cl(E,$),_e=Y[0],Fe=Y[1],ht=b.length,Xs=E,Rs=$,Ge=0;Ge<ht;Ge++)(at=b[Ge]).length===2?(Xs=at[0]*_e+Xs,Rs=at[1]*Fe+Rs,ra(Xs,Rs)):(kt=at[0]*_e+Xs,ss=at[1]*Fe+Rs,ls=at[2]*_e+Xs,ws=at[3]*Fe+Rs,Xs=at[4]*_e+Xs,Rs=at[5]*Fe+Rs,xi(kt,ss,ls,ws,Xs,Rs));return ge&&oh(),ll(oe),this},f.path=function(b){for(var E=0;E<b.length;E++){var $=b[E],Y=$.c;switch($.op){case"m":cl(Y[0],Y[1]);break;case"l":ra(Y[0],Y[1]);break;case"c":xi.apply(this,Y);break;case"h":oh()}}return this},f.__private__.rect=f.rect=function(b,E,$,Y,oe){if(isNaN(b)||isNaN(E)||isNaN($)||isNaN(Y)||!jr(oe))throw new Error("Invalid arguments passed to jsPDF.rect");return I===S.COMPAT&&(Y=-Y),H([U(j(b)),U(q(E)),U(j($)),U(j(Y)),"re"].join(" ")),ll(oe),this},f.__private__.triangle=f.triangle=function(b,E,$,Y,oe,ge,_e){if(isNaN(b)||isNaN(E)||isNaN($)||isNaN(Y)||isNaN(oe)||isNaN(ge)||!jr(_e))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[$-b,Y-E],[oe-$,ge-Y],[b-oe,E-ge]],b,E,[1,1],_e,!0),this},f.__private__.roundedRect=f.roundedRect=function(b,E,$,Y,oe,ge,_e){if(isNaN(b)||isNaN(E)||isNaN($)||isNaN(Y)||isNaN(oe)||isNaN(ge)||!jr(_e))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Fe=4/3*(Math.SQRT2-1);return oe=Math.min(oe,.5*$),ge=Math.min(ge,.5*Y),this.lines([[$-2*oe,0],[oe*Fe,0,oe,ge-ge*Fe,oe,ge],[0,Y-2*ge],[0,ge*Fe,-oe*Fe,ge,-oe,ge],[2*oe-$,0],[-oe*Fe,0,-oe,-ge*Fe,-oe,-ge],[0,2*ge-Y],[0,-ge*Fe,oe*Fe,-ge,oe,-ge]],b+oe,E,[1,1],_e,!0),this},f.__private__.ellipse=f.ellipse=function(b,E,$,Y,oe){if(isNaN(b)||isNaN(E)||isNaN($)||isNaN(Y)||!jr(oe))throw new Error("Invalid arguments passed to jsPDF.ellipse");var ge=4/3*(Math.SQRT2-1)*$,_e=4/3*(Math.SQRT2-1)*Y;return cl(b+$,E),xi(b+$,E-_e,b+ge,E-Y,b,E-Y),xi(b-ge,E-Y,b-$,E-_e,b-$,E),xi(b-$,E+_e,b-ge,E+Y,b,E+Y),xi(b+ge,E+Y,b+$,E+_e,b+$,E),ll(oe),this},f.__private__.circle=f.circle=function(b,E,$,Y){if(isNaN(b)||isNaN(E)||isNaN($)||!jr(Y))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(b,E,$,$,Y)},f.setFont=function(b,E,$){return $&&(E=Q(E,$)),wt=nh(b,E,{disableWarning:!1}),this};var Td=f.__private__.getFont=f.getFont=function(){return Wt[nh.apply(f,arguments)]};f.__private__.getFontList=f.getFontList=function(){var b,E,$={};for(b in es)if(es.hasOwnProperty(b))for(E in $[b]=[],es[b])es[b].hasOwnProperty(E)&&$[b].push(E);return $},f.addFont=function(b,E,$,Y,oe){var ge=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&ge.indexOf(arguments[3])!==-1?oe=arguments[3]:arguments[3]&&ge.indexOf(arguments[3])==-1&&($=Q($,Y)),oe=oe||"Identity-H",il.call(this,b,E,$,oe)};var ia,hl=r.lineWidth||.200025,Ja=f.__private__.getLineWidth=f.getLineWidth=function(){return hl},lh=f.__private__.setLineWidth=f.setLineWidth=function(b){return hl=b,H(U(j(b))+" w"),this};f.__private__.setLineDash=Je.API.setLineDash=Je.API.setLineDashPattern=function(b,E){if(b=b||[],E=E||0,isNaN(E)||!Array.isArray(b))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return b=b.map(function($){return U(j($))}).join(" "),E=U(j(E)),H("["+b+"] "+E+" d"),this};var ch=f.__private__.getLineHeight=f.getLineHeight=function(){return Ce*ia};f.__private__.getLineHeight=f.getLineHeight=function(){return Ce*ia};var hh=f.__private__.setLineHeightFactor=f.setLineHeightFactor=function(b){return typeof(b=b||1.15)=="number"&&(ia=b),this},uh=f.__private__.getLineHeightFactor=f.getLineHeightFactor=function(){return ia};hh(r.lineHeight);var Rr=f.__private__.getHorizontalCoordinate=function(b){return j(b)},ti=f.__private__.getVerticalCoordinate=function(b){return I===S.ADVANCED?b:it[D].mediaBox.topRightY-it[D].mediaBox.bottomLeftY-j(b)},Id=f.__private__.getHorizontalCoordinateString=f.getHorizontalCoordinateString=function(b){return U(Rr(b))},_i=f.__private__.getVerticalCoordinateString=f.getVerticalCoordinateString=function(b){return U(ti(b))},ir=r.strokeColor||"0 G";f.__private__.getStrokeColor=f.getDrawColor=function(){return sr(ir)},f.__private__.setStrokeColor=f.setDrawColor=function(b,E,$,Y){return ir=nr({ch1:b,ch2:E,ch3:$,ch4:Y,pdfColorType:"draw",precision:2}),H(ir),this};var ul=r.fillColor||"0 g";f.__private__.getFillColor=f.getFillColor=function(){return sr(ul)},f.__private__.setFillColor=f.setFillColor=function(b,E,$,Y){return ul=nr({ch1:b,ch2:E,ch3:$,ch4:Y,pdfColorType:"fill",precision:2}),H(ul),this};var aa=r.textColor||"0 g",jd=f.__private__.getTextColor=f.getTextColor=function(){return sr(aa)};f.__private__.setTextColor=f.setTextColor=function(b,E,$,Y){return aa=nr({ch1:b,ch2:E,ch3:$,ch4:Y,pdfColorType:"text",precision:3}),this};var Za=r.charSpace,Rd=f.__private__.getCharSpace=f.getCharSpace=function(){return parseFloat(Za||0)};f.__private__.setCharSpace=f.setCharSpace=function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Za=b,this};var dl=0;f.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},f.__private__.setLineCap=f.setLineCap=function(b){var E=f.CapJoinStyles[b];if(E===void 0)throw new Error("Line cap style of '"+b+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return dl=E,H(E+" J"),this};var fl=0;f.__private__.setLineJoin=f.setLineJoin=function(b){var E=f.CapJoinStyles[b];if(E===void 0)throw new Error("Line join style of '"+b+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return fl=E,H(E+" j"),this},f.__private__.setLineMiterLimit=f.__private__.setMiterLimit=f.setLineMiterLimit=f.setMiterLimit=function(b){if(b=b||0,isNaN(b))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return H(U(j(b))+" M"),this},f.GState=Su,f.setGState=function(b){(b=typeof b=="string"?as[Qn[b]]:dh(null,b)).equals(Zr)||(H("/"+b.id+" gs"),Zr=b)};var dh=function(b,E){if(!b||!Qn[b]){var $=!1;for(var Y in as)if(as.hasOwnProperty(Y)&&as[Y].equals(E)){$=!0;break}if($)E=as[Y];else{var oe="GS"+(Object.keys(as).length+1).toString(10);as[oe]=E,E.id=oe}return b&&(Qn[b]=E.id),Rt.publish("addGState",E),E}};f.addGState=function(b,E){return dh(b,E),this},f.saveGraphicsState=function(){return H("q"),kr.push({key:wt,size:Ce,color:aa}),this},f.restoreGraphicsState=function(){H("Q");var b=kr.pop();return wt=b.key,Ce=b.size,aa=b.color,Zr=null,this},f.setCurrentTransformationMatrix=function(b){return H(b.toString()+" cm"),this},f.comment=function(b){return H("#"+b),this};var Qa=function(b,E){var $=b||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return $},set:function(ge){isNaN(ge)||($=parseFloat(ge))}});var Y=E||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Y},set:function(ge){isNaN(ge)||(Y=parseFloat(ge))}});var oe="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return oe},set:function(ge){oe=ge.toString()}}),this},pl=function(b,E,$,Y){Qa.call(this,b,E),this.type="rect";var oe=$||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return oe},set:function(_e){isNaN(_e)||(oe=parseFloat(_e))}});var ge=Y||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return ge},set:function(_e){isNaN(_e)||(ge=parseFloat(_e))}}),this},ml=function(){this.page=os,this.currentPage=D,this.pages=Ee.slice(0),this.pagesContext=it.slice(0),this.x=Vs,this.y=Tt,this.matrix=Zn,this.width=oa(D),this.height=Ai(D),this.outputDestination=Le,this.id="",this.objectNumber=-1};ml.prototype.restore=function(){os=this.page,D=this.currentPage,it=this.pagesContext,Ee=this.pages,Vs=this.x,Tt=this.y,Zn=this.matrix,gl(D,this.width),bl(D,this.height),Le=this.outputDestination};var fh=function(b,E,$,Y,oe){Pr.push(new ml),os=D=0,Ee=[],Vs=b,Tt=E,Zn=oe,al([$,Y])},Od=function(b){if(Cr[b])Pr.pop().restore();else{var E=new ml,$="Xo"+(Object.keys(qs).length+1).toString(10);E.id=$,Cr[b]=$,qs[$]=E,Rt.publish("addFormObject",E),Pr.pop().restore()}};for(var eo in f.beginFormObject=function(b,E,$,Y,oe){return fh(b,E,$,Y,oe),this},f.endFormObject=function(b){return Od(b),this},f.doFormObject=function(b,E){var $=qs[Cr[b]];return H("q"),H(E.toString()+" cm"),H("/"+$.id+" Do"),H("Q"),this},f.getFormObject=function(b){var E=qs[Cr[b]];return{x:E.x,y:E.y,width:E.width,height:E.height,matrix:E.matrix}},f.save=function(b,E){return b=b||"generated.pdf",(E=E||{}).returnPromise=E.returnPromise||!1,E.returnPromise===!1?(va(Xa(ei()),b),typeof va.unload=="function"&&Ze.setTimeout&&setTimeout(va.unload,911),this):new Promise(function($,Y){try{var oe=va(Xa(ei()),b);typeof va.unload=="function"&&Ze.setTimeout&&setTimeout(va.unload,911),$(oe)}catch(ge){Y(ge.message)}})},Je.API)Je.API.hasOwnProperty(eo)&&(eo==="events"&&Je.API.events.length?function(b,E){var $,Y,oe;for(oe=E.length-1;oe!==-1;oe--)$=E[oe][0],Y=E[oe][1],b.subscribe.apply(b,[$].concat(typeof Y=="function"?[Y]:Y))}(Rt,Je.API.events):f[eo]=Je.API[eo]);var oa=f.getPageWidth=function(b){return(it[b=b||D].mediaBox.topRightX-it[b].mediaBox.bottomLeftX)/Me},gl=f.setPageWidth=function(b,E){it[b].mediaBox.topRightX=E*Me+it[b].mediaBox.bottomLeftX},Ai=f.getPageHeight=function(b){return(it[b=b||D].mediaBox.topRightY-it[b].mediaBox.bottomLeftY)/Me},bl=f.setPageHeight=function(b,E){it[b].mediaBox.topRightY=E*Me+it[b].mediaBox.bottomLeftY};return f.internal={pdfEscape:pn,getStyle:ah,getFont:Td,getFontSize:Ie,getCharSpace:Rd,getTextColor:jd,getLineHeight:ch,getLineHeightFactor:uh,getLineWidth:Ja,write:ct,getHorizontalCoordinate:Rr,getVerticalCoordinate:ti,getCoordinateString:Id,getVerticalCoordinateString:_i,collections:{},newObject:ks,newAdditionalObject:$a,newObjectDeferred:ys,newObjectDeferredBegin:En,getFilters:Tr,putStream:Bn,events:Rt,scaleFactor:Me,pageSize:{getWidth:function(){return oa(D)},setWidth:function(b){gl(D,b)},getHeight:function(){return Ai(D)},setHeight:function(b){bl(D,b)}},encryptionOptions:h,encryption:Gs,getEncryptor:Nd,output:Ya,getNumberOfPages:wd,pages:Ee,out:H,f2:ne,f3:L,getPageInfo:ih,getPageInfoByObjId:st,getCurrentPageInfo:Ed,getPDFVersion:w,Point:Qa,Rectangle:pl,Matrix:Ye,hasHotfix:rh},Object.defineProperty(f.internal.pageSize,"width",{get:function(){return oa(D)},set:function(b){gl(D,b)},enumerable:!0,configurable:!0}),Object.defineProperty(f.internal.pageSize,"height",{get:function(){return Ai(D)},set:function(b){bl(D,b)},enumerable:!0,configurable:!0}),vd.call(f,Ne),wt="F1",th(n,t),Rt.publish("initialized"),f}No.prototype.lsbFirstWord=function(r){return String.fromCharCode(r>>0&255,r>>8&255,r>>16&255,r>>24&255)},No.prototype.toHexString=function(r){return r.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},No.prototype.hexToBytes=function(r){for(var e=[],t=0;t<r.length;t+=2)e.push(String.fromCharCode(parseInt(r.substr(t,2),16)));return e.join("")},No.prototype.processOwnerPassword=function(r,e){return ip(rp(e).substr(0,5),r)},No.prototype.encryptor=function(r,e){var t=rp(this.encryptionKey+String.fromCharCode(255&r,r>>8&255,r>>16&255,255&e,e>>8&255)).substr(0,10);return function(s){return ip(t,s)}},Su.prototype.equals=function(r){var e,t="id,objectNumber,equals";if(!r||Bt(r)!==Bt(this))return!1;var s=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!r.hasOwnProperty(e)||this[e]!==r[e])return!1;s++}for(e in r)r.hasOwnProperty(e)&&t.indexOf(e)<0&&s--;return s===0},Je.API={events:[]},Je.version="2.5.2";var hs=Je.API,nm=1,Da=function(r){return r.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},wo=function(r){return r.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},ot=function(r){return r.toFixed(2)},Fi=function(r){return r.toFixed(5)};hs.__acroform__={};var Nn=function(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r},t0=function(r){return r*nm},$r=function(r){var e=new Nb,t=qe.internal.getHeight(r)||0,s=qe.internal.getWidth(r)||0;return e.BBox=[0,0,Number(ot(s)),Number(ot(t))],e},Q3=hs.__acroform__.setBit=function(r,e){if(r=r||0,e=e||0,isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return r|=1<<e},e4=hs.__acroform__.clearBit=function(r,e){if(r=r||0,e=e||0,isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return r&=~(1<<e)},t4=hs.__acroform__.getBit=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return r&1<<e?1:0},ms=hs.__acroform__.getBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return t4(r,e-1)},gs=hs.__acroform__.setBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Q3(r,e-1)},bs=hs.__acroform__.clearBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return e4(r,e-1)},s4=hs.__acroform__.calculateCoordinates=function(r,e){var t=e.internal.getHorizontalCoordinate,s=e.internal.getVerticalCoordinate,n=r[0],i=r[1],a=r[2],o=r[3],l={};return l.lowerLeft_X=t(n)||0,l.lowerLeft_Y=s(i+o)||0,l.upperRight_X=t(n+a)||0,l.upperRight_Y=s(i)||0,[Number(ot(l.lowerLeft_X)),Number(ot(l.lowerLeft_Y)),Number(ot(l.upperRight_X)),Number(ot(l.upperRight_Y))]},n4=function(r){if(r.appearanceStreamContent)return r.appearanceStreamContent;if(r.V||r.DV){var e=[],t=r._V||r.DV,s=ap(r,t),n=r.scope.internal.getFont(r.fontName,r.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(r.scope.__private__.encodeColorString(r.color)),e.push("/"+n+" "+ot(s.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(s.text),e.push("ET"),e.push("Q"),e.push("EMC");var i=$r(r);return i.scope=r.scope,i.stream=e.join(`
`),i}},ap=function(r,e){var t=r.fontSize===0?r.maxFontSize:r.fontSize,s={text:"",fontSize:""},n=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");n=r.multiline?n.map(function(L){return L.split(`
`)}):n.map(function(L){return[L]});var i=t,a=qe.internal.getHeight(r)||0;a=a<0?-a:a;var o=qe.internal.getWidth(r)||0;o=o<0?-o:o;var l=function(L,j,V){if(L+1<n.length){var q=j+" "+n[L+1][0];return Kh(q,r,V).width<=o-4}return!1};i++;e:for(;i>0;){e="",i--;var c,h,d=Kh("3",r,i).height,p=r.multiline?a-i:(a-d)/2,f=p+=2,y=0,w=0,A=0;if(i<=0){e=`(...) Tj
`,e+="% Width of Text: "+Kh(e,r,i=12).width+", FieldWidth:"+o+`
`;break}for(var x="",S=0,I=0;I<n.length;I++)if(n.hasOwnProperty(I)){var M=!1;if(n[I].length!==1&&A!==n[I].length-1){if((d+2)*(S+2)+2>a)continue e;x+=n[I][A],M=!0,w=I,I--}else{x=(x+=n[I][A]+" ").substr(x.length-1)==" "?x.substr(0,x.length-1):x;var B=parseInt(I),Q=l(B,x,i),U=I>=n.length-1;if(Q&&!U){x+=" ",A=0;continue}if(Q||U){if(U)w=B;else if(r.multiline&&(d+2)*(S+2)+2>a)continue e}else{if(!r.multiline||(d+2)*(S+2)+2>a)continue e;w=B}}for(var O="",G=y;G<=w;G++){var ne=n[G];if(r.multiline){if(G===w){O+=ne[A]+" ",A=(A+1)%ne.length;continue}if(G===y){O+=ne[ne.length-1]+" ";continue}}O+=ne[0]+" "}switch(O=O.substr(O.length-1)==" "?O.substr(0,O.length-1):O,h=Kh(O,r,i).width,r.textAlign){case"right":c=o-h-2;break;case"center":c=(o-h)/2;break;case"left":default:c=2}e+=ot(c)+" "+ot(f)+` Td
`,e+="("+Da(O)+`) Tj
`,e+=-ot(c)+` 0 Td
`,f=-(i+2),h=0,y=M?w:w+1,S++,x=""}break}return s.text=e,s.fontSize=i,s},Kh=function(r,e,t){var s=e.scope.internal.getFont(e.fontName,e.fontStyle),n=e.scope.getStringUnitWidth(r,{font:s,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:s,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:n}},r4={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},i4=function(r,e){var t={type:"reference",object:r};e.internal.getPageInfo(r.page).pageContext.annotations.find(function(s){return s.type===t.type&&s.object===t.object})===void 0&&e.internal.getPageInfo(r.page).pageContext.annotations.push(t)},a4=function(r,e){for(var t in r)if(r.hasOwnProperty(t)){var s=t,n=r[t];e.internal.newObjectDeferredBegin(n.objId,!0),Bt(n)==="object"&&typeof n.putStream=="function"&&n.putStream(),delete r[s]}},o4=function(r,e){if(e.scope=r,r.internal!==void 0&&(r.internal.acroformPlugin===void 0||r.internal.acroformPlugin.isInitialized===!1)){if(Sr.FieldNum=0,r.internal.acroformPlugin=JSON.parse(JSON.stringify(r4)),r.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");nm=r.internal.scaleFactor,r.internal.acroformPlugin.acroFormDictionaryRoot=new Eb,r.internal.acroformPlugin.acroFormDictionaryRoot.scope=r,r.internal.acroformPlugin.acroFormDictionaryRoot._eventID=r.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(r)}),r.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var s=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in s)if(s.hasOwnProperty(n)){var i=s[n];i.objId=void 0,i.hasAnnotation&&i4(i,t)}})(r)}),r.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(r)}),r.internal.events.subscribe("postPutPages",function(t){(function(s,n){var i=!s;for(var a in s||(n.internal.newObjectDeferredBegin(n.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),n.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),s=s||n.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(s.hasOwnProperty(a)){var o=s[a],l=[],c=o.Rect;if(o.Rect&&(o.Rect=s4(o.Rect,n)),n.internal.newObjectDeferredBegin(o.objId,!0),o.DA=qe.createDefaultAppearanceStream(o),Bt(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(l=o.getKeyValueListForStream()),o.Rect=c,o.hasAppearanceStream&&!o.appearanceStreamContent){var h=n4(o);l.push({key:"AP",value:"<</N "+h+">>"}),n.internal.acroformPlugin.xForms.push(h)}if(o.appearanceStreamContent){var d="";for(var p in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(p)){var f=o.appearanceStreamContent[p];if(d+="/"+p+" ",d+="<<",Object.keys(f).length>=1||Array.isArray(f)){for(var a in f)if(f.hasOwnProperty(a)){var y=f[a];typeof y=="function"&&(y=y.call(n,o)),d+="/"+a+" "+y+" ",n.internal.acroformPlugin.xForms.indexOf(y)>=0||n.internal.acroformPlugin.xForms.push(y)}}else typeof(y=f)=="function"&&(y=y.call(n,o)),d+="/"+a+" "+y,n.internal.acroformPlugin.xForms.indexOf(y)>=0||n.internal.acroformPlugin.xForms.push(y);d+=">>"}l.push({key:"AP",value:`<<
`+d+">>"})}n.internal.putStream({additionalKeyValues:l,objectId:o.objId}),n.internal.out("endobj")}i&&a4(n.internal.acroformPlugin.xForms,n)})(t,r)}),r.internal.acroformPlugin.isInitialized=!0}},Sb=hs.__acroform__.arrayToPdfArray=function(r,e,t){var s=function(a){return a};if(Array.isArray(r)){for(var n="[",i=0;i<r.length;i++)switch(i!==0&&(n+=" "),Bt(r[i])){case"boolean":case"number":case"object":n+=r[i].toString();break;case"string":r[i].substr(0,1)!=="/"?(e!==void 0&&t&&(s=t.internal.getEncryptor(e)),n+="("+Da(s(r[i].toString()))+")"):n+=r[i].toString()}return n+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},xf=function(r,e,t){var s=function(n){return n};return e!==void 0&&t&&(s=t.internal.getEncryptor(e)),(r=r||"").toString(),r="("+Da(s(r))+")"},Hr=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(r){this._objId=r}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Hr.prototype.toString=function(){return this.objId+" 0 R"},Hr.prototype.putStream=function(){var r=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:r,objectId:this.objId}),this.scope.internal.out("endobj")},Hr.prototype.getKeyValueListForStream=function(){var r=[],e=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var s=e[t],n=this[s];n&&(Array.isArray(n)?r.push({key:s,value:Sb(n,this.objId,this.scope)}):n instanceof Hr?(n.scope=this.scope,r.push({key:s,value:n.objId+" 0 R"})):typeof n!="function"&&r.push({key:s,value:n}))}return r};var Nb=function(){Hr.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var r,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){r=t.trim()},get:function(){return r||null}})};Nn(Nb,Hr);var Eb=function(){Hr.call(this);var r,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(r){var t=function(s){return s};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+Da(t(r))+")"}},set:function(t){r=t}})};Nn(Eb,Hr);var Sr=function r(){Hr.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute F supplied.');e=x}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!ms(e,3)},set:function(x){x?this.F=gs(e,3):this.F=bs(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute Ff supplied.');t=x}});var s=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(s.length!==0)return s},set:function(x){s=x!==void 0?x:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[0])?0:s[0]},set:function(x){s[0]=x}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[1])?0:s[1]},set:function(x){s[1]=x}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[2])?0:s[2]},set:function(x){s[2]=x}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[3])?0:s[3]},set:function(x){s[3]=x}});var n="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return n},set:function(x){switch(x){case"/Btn":case"/Tx":case"/Ch":case"/Sig":n=x;break;default:throw new Error('Invalid value "'+x+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof Nu)return;i="FieldObject"+r.FieldNum++}var x=function(S){return S};return this.scope&&(x=this.scope.internal.getEncryptor(this.objId)),"("+Da(x(i))+")"},set:function(x){i=x.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(x){i=x}});var a="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return a},set:function(x){a=x}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(x){o=x}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(x){l=x}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return c===void 0?50/nm:c},set:function(x){c=x}});var h="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return h},set:function(x){h=x}});var d="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!d||this instanceof Nu||this instanceof Ea))return xf(d,this.objId,this.scope)},set:function(x){x=x.toString(),d=x}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof $s?p:xf(p,this.objId,this.scope)},set:function(x){x=x.toString(),p=this instanceof $s?x:x.substr(0,1)==="("?wo(x.substr(1,x.length-2)):wo(x)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof $s?wo(p.substr(1,p.length-1)):p},set:function(x){x=x.toString(),p=this instanceof $s?"/"+x:x}});var f=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(f)return f},set:function(x){this.V=x}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof $s?f:xf(f,this.objId,this.scope)},set:function(x){x=x.toString(),f=this instanceof $s?x:x.substr(0,1)==="("?wo(x.substr(1,x.length-2)):wo(x)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof $s?wo(f.substr(1,f.length-1)):f},set:function(x){x=x.toString(),f=this instanceof $s?"/"+x:x}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var y,w=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return w},set:function(x){x=!!x,w=x}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(y)return y},set:function(x){y=x}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!ms(this.Ff,1)},set:function(x){x?this.Ff=gs(this.Ff,1):this.Ff=bs(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!ms(this.Ff,2)},set:function(x){x?this.Ff=gs(this.Ff,2):this.Ff=bs(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!ms(this.Ff,3)},set:function(x){x?this.Ff=gs(this.Ff,3):this.Ff=bs(this.Ff,3)}});var A=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(A!==null)return A},set:function(x){if([0,1,2].indexOf(x)===-1)throw new Error('Invalid value "'+x+'" for attribute Q supplied.');A=x}}),Object.defineProperty(this,"textAlign",{get:function(){var x;switch(A){case 0:default:x="left";break;case 1:x="center";break;case 2:x="right"}return x},configurable:!0,enumerable:!0,set:function(x){switch(x){case"right":case 2:A=2;break;case"center":case 1:A=1;break;case"left":case 0:default:A=0}}})};Nn(Sr,Hr);var Fo=function(){Sr.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var r=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return r},set:function(t){r=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Sb(e,this.objId,this.scope)},set:function(t){var s,n;n=[],typeof(s=t)=="string"&&(n=function(i,a,o){o||(o=1);for(var l,c=[];l=a.exec(i);)c.push(l[o]);return c}(s,/\((.*?)\)/g)),e=n}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,s){for(s=s||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),s!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!ms(this.Ff,18)},set:function(t){t?this.Ff=gs(this.Ff,18):this.Ff=bs(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!ms(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=gs(this.Ff,19):this.Ff=bs(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!ms(this.Ff,20)},set:function(t){t?(this.Ff=gs(this.Ff,20),e.sort()):this.Ff=bs(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!ms(this.Ff,22)},set:function(t){t?this.Ff=gs(this.Ff,22):this.Ff=bs(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!ms(this.Ff,23)},set:function(t){t?this.Ff=gs(this.Ff,23):this.Ff=bs(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!ms(this.Ff,27)},set:function(t){t?this.Ff=gs(this.Ff,27):this.Ff=bs(this.Ff,27)}}),this.hasAppearanceStream=!1};Nn(Fo,Sr);var Do=function(){Fo.call(this),this.fontName="helvetica",this.combo=!1};Nn(Do,Fo);var Bo=function(){Do.call(this),this.combo=!0};Nn(Bo,Do);var lu=function(){Bo.call(this),this.edit=!0};Nn(lu,Bo);var $s=function(){Sr.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!ms(this.Ff,15)},set:function(t){t?this.Ff=gs(this.Ff,15):this.Ff=bs(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!ms(this.Ff,16)},set:function(t){t?this.Ff=gs(this.Ff,16):this.Ff=bs(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!ms(this.Ff,17)},set:function(t){t?this.Ff=gs(this.Ff,17):this.Ff=bs(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!ms(this.Ff,26)},set:function(t){t?this.Ff=gs(this.Ff,26):this.Ff=bs(this.Ff,26)}});var r,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(i){return i};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var s,n=[];for(s in n.push("<<"),e)n.push("/"+s+" ("+Da(t(e[s]))+")");return n.push(">>"),n.join(`
`)}},set:function(t){Bt(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(t){r="/"+t}})};Nn($s,Sr);var cu=function(){$s.call(this),this.pushButton=!0};Nn(cu,$s);var $o=function(){$s.call(this),this.radio=!0,this.pushButton=!1;var r=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){r=e!==void 0?e:[]}})};Nn($o,$s);var Nu=function(){var r,e;Sr.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return r},set:function(n){r=n}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(n){e=n}});var t,s={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(o){return o};this.scope&&(n=this.scope.internal.getEncryptor(this.objId));var i,a=[];for(i in a.push("<<"),s)a.push("/"+i+" ("+Da(n(s[i]))+")");return a.push(">>"),a.join(`
`)},set:function(n){Bt(n)==="object"&&(s=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return s.CA||""},set:function(n){typeof n=="string"&&(s.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(n){t="/"+n}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=qe.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Nn(Nu,Sr),$o.prototype.setAppearance=function(r){if(!("createAppearanceStream"in r)||!("getCA"in r))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=r.createAppearanceStream(t.optionName),t.caption=r.getCA()}},$o.prototype.createOption=function(r){var e=new Nu;return e.Parent=this,e.optionName=r,this.Kids.push(e),l4.call(this.scope,e),e};var hu=function(){$s.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=qe.CheckBox.createAppearanceStream()};Nn(hu,$s);var Ea=function(){Sr.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!ms(this.Ff,13)},set:function(e){e?this.Ff=gs(this.Ff,13):this.Ff=bs(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!ms(this.Ff,21)},set:function(e){e?this.Ff=gs(this.Ff,21):this.Ff=bs(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!ms(this.Ff,23)},set:function(e){e?this.Ff=gs(this.Ff,23):this.Ff=bs(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!ms(this.Ff,24)},set:function(e){e?this.Ff=gs(this.Ff,24):this.Ff=bs(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!ms(this.Ff,25)},set:function(e){e?this.Ff=gs(this.Ff,25):this.Ff=bs(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!ms(this.Ff,26)},set:function(e){e?this.Ff=gs(this.Ff,26):this.Ff=bs(this.Ff,26)}});var r=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return r},set:function(e){Number.isInteger(e)&&(r=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Nn(Ea,Sr);var uu=function(){Ea.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!ms(this.Ff,14)},set:function(r){r?this.Ff=gs(this.Ff,14):this.Ff=bs(this.Ff,14)}}),this.password=!0};Nn(uu,Ea);var qe={CheckBox:{createAppearanceStream:function(){return{N:{On:qe.CheckBox.YesNormal},D:{On:qe.CheckBox.YesPushDown,Off:qe.CheckBox.OffPushDown}}},YesPushDown:function(r){var e=$r(r);e.scope=r.scope;var t=[],s=r.scope.internal.getFont(r.fontName,r.fontStyle).id,n=r.scope.__private__.encodeColorString(r.color),i=ap(r,r.caption);return t.push("0.749023 g"),t.push("0 0 "+ot(qe.internal.getWidth(r))+" "+ot(qe.internal.getHeight(r))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+s+" "+ot(i.fontSize)+" Tf "+n),t.push("BT"),t.push(i.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(r){var e=$r(r);e.scope=r.scope;var t=r.scope.internal.getFont(r.fontName,r.fontStyle).id,s=r.scope.__private__.encodeColorString(r.color),n=[],i=qe.internal.getHeight(r),a=qe.internal.getWidth(r),o=ap(r,r.caption);return n.push("1 g"),n.push("0 0 "+ot(a)+" "+ot(i)+" re"),n.push("f"),n.push("q"),n.push("0 0 1 rg"),n.push("0 0 "+ot(a-1)+" "+ot(i-1)+" re"),n.push("W"),n.push("n"),n.push("0 g"),n.push("BT"),n.push("/"+t+" "+ot(o.fontSize)+" Tf "+s),n.push(o.text),n.push("ET"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(r){var e=$r(r);e.scope=r.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+ot(qe.internal.getWidth(r))+" "+ot(qe.internal.getHeight(r))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(r){var e={D:{Off:qe.RadioButton.Circle.OffPushDown},N:{}};return e.N[r]=qe.RadioButton.Circle.YesNormal,e.D[r]=qe.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(r){var e=$r(r);e.scope=r.scope;var t=[],s=qe.internal.getWidth(r)<=qe.internal.getHeight(r)?qe.internal.getWidth(r)/4:qe.internal.getHeight(r)/4;s=Number((.9*s).toFixed(5));var n=qe.internal.Bezier_C,i=Number((s*n).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+Fi(qe.internal.getWidth(r)/2)+" "+Fi(qe.internal.getHeight(r)/2)+" cm"),t.push(s+" 0 m"),t.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),t.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),t.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),t.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(r){var e=$r(r);e.scope=r.scope;var t=[],s=qe.internal.getWidth(r)<=qe.internal.getHeight(r)?qe.internal.getWidth(r)/4:qe.internal.getHeight(r)/4;s=Number((.9*s).toFixed(5));var n=Number((2*s).toFixed(5)),i=Number((n*qe.internal.Bezier_C).toFixed(5)),a=Number((s*qe.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Fi(qe.internal.getWidth(r)/2)+" "+Fi(qe.internal.getHeight(r)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),t.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),t.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),t.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+Fi(qe.internal.getWidth(r)/2)+" "+Fi(qe.internal.getHeight(r)/2)+" cm"),t.push(s+" 0 m"),t.push(s+" "+a+" "+a+" "+s+" 0 "+s+" c"),t.push("-"+a+" "+s+" -"+s+" "+a+" -"+s+" 0 c"),t.push("-"+s+" -"+a+" -"+a+" -"+s+" 0 -"+s+" c"),t.push(a+" -"+s+" "+s+" -"+a+" "+s+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(r){var e=$r(r);e.scope=r.scope;var t=[],s=qe.internal.getWidth(r)<=qe.internal.getHeight(r)?qe.internal.getWidth(r)/4:qe.internal.getHeight(r)/4;s=Number((.9*s).toFixed(5));var n=Number((2*s).toFixed(5)),i=Number((n*qe.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Fi(qe.internal.getWidth(r)/2)+" "+Fi(qe.internal.getHeight(r)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),t.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),t.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),t.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(r){var e={D:{Off:qe.RadioButton.Cross.OffPushDown},N:{}};return e.N[r]=qe.RadioButton.Cross.YesNormal,e.D[r]=qe.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(r){var e=$r(r);e.scope=r.scope;var t=[],s=qe.internal.calculateCross(r);return t.push("q"),t.push("1 1 "+ot(qe.internal.getWidth(r)-2)+" "+ot(qe.internal.getHeight(r)-2)+" re"),t.push("W"),t.push("n"),t.push(ot(s.x1.x)+" "+ot(s.x1.y)+" m"),t.push(ot(s.x2.x)+" "+ot(s.x2.y)+" l"),t.push(ot(s.x4.x)+" "+ot(s.x4.y)+" m"),t.push(ot(s.x3.x)+" "+ot(s.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(r){var e=$r(r);e.scope=r.scope;var t=qe.internal.calculateCross(r),s=[];return s.push("0.749023 g"),s.push("0 0 "+ot(qe.internal.getWidth(r))+" "+ot(qe.internal.getHeight(r))+" re"),s.push("f"),s.push("q"),s.push("1 1 "+ot(qe.internal.getWidth(r)-2)+" "+ot(qe.internal.getHeight(r)-2)+" re"),s.push("W"),s.push("n"),s.push(ot(t.x1.x)+" "+ot(t.x1.y)+" m"),s.push(ot(t.x2.x)+" "+ot(t.x2.y)+" l"),s.push(ot(t.x4.x)+" "+ot(t.x4.y)+" m"),s.push(ot(t.x3.x)+" "+ot(t.x3.y)+" l"),s.push("s"),s.push("Q"),e.stream=s.join(`
`),e},OffPushDown:function(r){var e=$r(r);e.scope=r.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+ot(qe.internal.getWidth(r))+" "+ot(qe.internal.getHeight(r))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(r){var e=r.scope.internal.getFont(r.fontName,r.fontStyle).id,t=r.scope.__private__.encodeColorString(r.color);return"/"+e+" "+r.fontSize+" Tf "+t}};qe.internal={Bezier_C:.551915024494,calculateCross:function(r){var e=qe.internal.getWidth(r),t=qe.internal.getHeight(r),s=Math.min(e,t);return{x1:{x:(e-s)/2,y:(t-s)/2+s},x2:{x:(e-s)/2+s,y:(t-s)/2},x3:{x:(e-s)/2,y:(t-s)/2},x4:{x:(e-s)/2+s,y:(t-s)/2+s}}}},qe.internal.getWidth=function(r){var e=0;return Bt(r)==="object"&&(e=t0(r.Rect[2])),e},qe.internal.getHeight=function(r){var e=0;return Bt(r)==="object"&&(e=t0(r.Rect[3])),e};var l4=hs.addField=function(r){if(o4(this,r),!(r instanceof Sr))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=r).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),r.page=r.scope.internal.getCurrentPageInfo().pageNumber,this};hs.AcroFormChoiceField=Fo,hs.AcroFormListBox=Do,hs.AcroFormComboBox=Bo,hs.AcroFormEditBox=lu,hs.AcroFormButton=$s,hs.AcroFormPushButton=cu,hs.AcroFormRadioButton=$o,hs.AcroFormCheckBox=hu,hs.AcroFormTextField=Ea,hs.AcroFormPasswordField=uu,hs.AcroFormAppearance=qe,hs.AcroForm={ChoiceField:Fo,ListBox:Do,ComboBox:Bo,EditBox:lu,Button:$s,PushButton:cu,RadioButton:$o,CheckBox:hu,TextField:Ea,PasswordField:uu,Appearance:qe},Je.AcroForm={ChoiceField:Fo,ListBox:Do,ComboBox:Bo,EditBox:lu,Button:$s,PushButton:cu,RadioButton:$o,CheckBox:hu,TextField:Ea,PasswordField:uu,Appearance:qe};function kb(r){return r.reduce(function(e,t,s){return e[t]=s,e},{})}(function(r){r.__addimage__={};var e="UNKNOWN",t={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=r.__addimage__.getImageFileTypeByImageData=function(L,j){var V,q,le,ae,te,K=e;if((j=j||e)==="RGBA"||L.data!==void 0&&L.data instanceof Uint8ClampedArray&&"height"in L&&"width"in L)return"RGBA";if(Q(L))for(te in t)for(le=t[te],V=0;V<le.length;V+=1){for(ae=!0,q=0;q<le[V].length;q+=1)if(le[V][q]!==void 0&&le[V][q]!==L[q]){ae=!1;break}if(ae===!0){K=te;break}}else for(te in t)for(le=t[te],V=0;V<le.length;V+=1){for(ae=!0,q=0;q<le[V].length;q+=1)if(le[V][q]!==void 0&&le[V][q]!==L.charCodeAt(q)){ae=!1;break}if(ae===!0){K=te;break}}return K===e&&j!==e&&(K=j),K},n=function L(j){for(var V=this.internal.write,q=this.internal.putStream,le=(0,this.internal.getFilters)();le.indexOf("FlateEncode")!==-1;)le.splice(le.indexOf("FlateEncode"),1);j.objectId=this.internal.newObject();var ae=[];if(ae.push({key:"Type",value:"/XObject"}),ae.push({key:"Subtype",value:"/Image"}),ae.push({key:"Width",value:j.width}),ae.push({key:"Height",value:j.height}),j.colorSpace===A.INDEXED?ae.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(j.palette.length/3-1)+" "+("sMask"in j&&j.sMask!==void 0?j.objectId+2:j.objectId+1)+" 0 R]"}):(ae.push({key:"ColorSpace",value:"/"+j.colorSpace}),j.colorSpace===A.DEVICE_CMYK&&ae.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ae.push({key:"BitsPerComponent",value:j.bitsPerComponent}),"decodeParameters"in j&&j.decodeParameters!==void 0&&ae.push({key:"DecodeParms",value:"<<"+j.decodeParameters+">>"}),"transparency"in j&&Array.isArray(j.transparency)){for(var te="",K=0,fe=j.transparency.length;K<fe;K++)te+=j.transparency[K]+" "+j.transparency[K]+" ";ae.push({key:"Mask",value:"["+te+"]"})}j.sMask!==void 0&&ae.push({key:"SMask",value:j.objectId+1+" 0 R"});var me=j.filter!==void 0?["/"+j.filter]:void 0;if(q({data:j.data,additionalKeyValues:ae,alreadyAppliedFilters:me,objectId:j.objectId}),V("endobj"),"sMask"in j&&j.sMask!==void 0){var Ae="/Predictor "+j.predictor+" /Colors 1 /BitsPerComponent "+j.bitsPerComponent+" /Columns "+j.width,k={width:j.width,height:j.height,colorSpace:"DeviceGray",bitsPerComponent:j.bitsPerComponent,decodeParameters:Ae,data:j.sMask};"filter"in j&&(k.filter=j.filter),L.call(this,k)}if(j.colorSpace===A.INDEXED){var D=this.internal.newObject();q({data:O(new Uint8Array(j.palette)),objectId:D}),V("endobj")}},i=function(){var L=this.internal.collections.addImage_images;for(var j in L)n.call(this,L[j])},a=function(){var L,j=this.internal.collections.addImage_images,V=this.internal.write;for(var q in j)V("/I"+(L=j[q]).index,L.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",a))},l=function(){var L=this.internal.collections.addImage_images;return o.call(this),L},c=function(){return Object.keys(this.internal.collections.addImage_images).length},h=function(L){return typeof r["process"+L.toUpperCase()]=="function"},d=function(L){return Bt(L)==="object"&&L.nodeType===1},p=function(L,j){if(L.nodeName==="IMG"&&L.hasAttribute("src")){var V=""+L.getAttribute("src");if(V.indexOf("data:image/")===0)return cc(unescape(V).split("base64,").pop());var q=r.loadFile(V,!0);if(q!==void 0)return q}if(L.nodeName==="CANVAS"){if(L.width===0||L.height===0)throw new Error("Given canvas must have data. Canvas width: "+L.width+", height: "+L.height);var le;switch(j){case"PNG":le="image/png";break;case"WEBP":le="image/webp";break;case"JPEG":case"JPG":default:le="image/jpeg"}return cc(L.toDataURL(le,1).split("base64,").pop())}},f=function(L){var j=this.internal.collections.addImage_images;if(j){for(var V in j)if(L===j[V].alias)return j[V]}},y=function(L,j,V){return L||j||(L=-96,j=-96),L<0&&(L=-1*V.width*72/L/this.internal.scaleFactor),j<0&&(j=-1*V.height*72/j/this.internal.scaleFactor),L===0&&(L=j*V.width/V.height),j===0&&(j=L*V.height/V.width),[L,j]},w=function(L,j,V,q,le,ae){var te=y.call(this,V,q,le),K=this.internal.getCoordinateString,fe=this.internal.getVerticalCoordinateString,me=l.call(this);if(V=te[0],q=te[1],me[le.index]=le,ae){ae*=Math.PI/180;var Ae=Math.cos(ae),k=Math.sin(ae),D=function(X){return X.toFixed(4)},z=[D(Ae),D(k),D(-1*k),D(Ae),0,0,"cm"]}this.internal.write("q"),ae?(this.internal.write([1,"0","0",1,K(L),fe(j+q),"cm"].join(" ")),this.internal.write(z.join(" ")),this.internal.write([K(V),"0","0",K(q),"0","0","cm"].join(" "))):this.internal.write([K(V),"0","0",K(q),K(L),fe(j+q),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+le.index+" Do"),this.internal.write("Q")},A=r.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};r.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var x=r.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},S=r.__addimage__.sHashCode=function(L){var j,V,q=0;if(typeof L=="string")for(V=L.length,j=0;j<V;j++)q=(q<<5)-q+L.charCodeAt(j),q|=0;else if(Q(L))for(V=L.byteLength/2,j=0;j<V;j++)q=(q<<5)-q+L[j],q|=0;return q},I=r.__addimage__.validateStringAsBase64=function(L){(L=L||"").toString().trim();var j=!0;return L.length===0&&(j=!1),L.length%4!=0&&(j=!1),/^[A-Za-z0-9+/]+$/.test(L.substr(0,L.length-2))===!1&&(j=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(L.substr(-2))===!1&&(j=!1),j},M=r.__addimage__.extractImageFromDataUrl=function(L){var j=(L=L||"").split("base64,"),V=null;if(j.length===2){var q=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(j[0]);Array.isArray(q)&&(V={mimeType:q[1],charset:q[2],data:j[1]})}return V},B=r.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};r.__addimage__.isArrayBuffer=function(L){return B()&&L instanceof ArrayBuffer};var Q=r.__addimage__.isArrayBufferView=function(L){return B()&&typeof Uint32Array<"u"&&(L instanceof Int8Array||L instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&L instanceof Uint8ClampedArray||L instanceof Int16Array||L instanceof Uint16Array||L instanceof Int32Array||L instanceof Uint32Array||L instanceof Float32Array||L instanceof Float64Array)},U=r.__addimage__.binaryStringToUint8Array=function(L){for(var j=L.length,V=new Uint8Array(j),q=0;q<j;q++)V[q]=L.charCodeAt(q);return V},O=r.__addimage__.arrayBufferToBinaryString=function(L){for(var j="",V=Q(L)?L:new Uint8Array(L),q=0;q<V.length;q+=8192)j+=String.fromCharCode.apply(null,V.subarray(q,q+8192));return j};r.addImage=function(){var L,j,V,q,le,ae,te,K,fe;if(typeof arguments[1]=="number"?(j=e,V=arguments[1],q=arguments[2],le=arguments[3],ae=arguments[4],te=arguments[5],K=arguments[6],fe=arguments[7]):(j=arguments[1],V=arguments[2],q=arguments[3],le=arguments[4],ae=arguments[5],te=arguments[6],K=arguments[7],fe=arguments[8]),Bt(L=arguments[0])==="object"&&!d(L)&&"imageData"in L){var me=L;L=me.imageData,j=me.format||j||e,V=me.x||V||0,q=me.y||q||0,le=me.w||me.width||le,ae=me.h||me.height||ae,te=me.alias||te,K=me.compression||K,fe=me.rotation||me.angle||fe}var Ae=this.internal.getFilters();if(K===void 0&&Ae.indexOf("FlateEncode")!==-1&&(K="SLOW"),isNaN(V)||isNaN(q))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var k=G.call(this,L,j,te,K);return w.call(this,V,q,le,ae,k,fe),this};var G=function(L,j,V,q){var le,ae,te;if(typeof L=="string"&&s(L)===e){L=unescape(L);var K=ne(L,!1);(K!==""||(K=r.loadFile(L,!0))!==void 0)&&(L=K)}if(d(L)&&(L=p(L,j)),j=s(L,j),!h(j))throw new Error("addImage does not support files of type '"+j+"', please ensure that a plugin for '"+j+"' support is added.");if(((te=V)==null||te.length===0)&&(V=function(fe){return typeof fe=="string"||Q(fe)?S(fe):Q(fe.data)?S(fe.data):null}(L)),(le=f.call(this,V))||(B()&&(L instanceof Uint8Array||j==="RGBA"||(ae=L,L=U(L))),le=this["process"+j.toUpperCase()](L,c.call(this),V,function(fe){return fe&&typeof fe=="string"&&(fe=fe.toUpperCase()),fe in r.image_compression?fe:x.NONE}(q),ae)),!le)throw new Error("An unknown error occurred whilst processing the image.");return le},ne=r.__addimage__.convertBase64ToBinaryString=function(L,j){var V;j=typeof j!="boolean"||j;var q,le="";if(typeof L=="string"){q=(V=M(L))!==null?V.data:L;try{le=cc(q)}catch(ae){if(j)throw I(q)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ae.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return le};r.getImageProperties=function(L){var j,V,q="";if(d(L)&&(L=p(L)),typeof L=="string"&&s(L)===e&&((q=ne(L,!1))===""&&(q=r.loadFile(L)||""),L=q),V=s(L),!h(V))throw new Error("addImage does not support files of type '"+V+"', please ensure that a plugin for '"+V+"' support is added.");if(!B()||L instanceof Uint8Array||(L=U(L)),!(j=this["process"+V.toUpperCase()](L)))throw new Error("An unknown error occurred whilst processing the image");return j.fileType=V,j}})(Je.API),function(r){var e=function(t){if(t!==void 0&&t!="")return!0};Je.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),r.events.push(["putPage",function(t){for(var s,n,i,a=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(t.objId),c=t.pageContext.annotations,h=!1,d=0;d<c.length&&!h;d++)switch((s=c[d]).type){case"link":(e(s.options.url)||e(s.options.pageNumber))&&(h=!0);break;case"reference":case"text":case"freetext":h=!0}if(h!=0){this.internal.write("/Annots [");for(var p=0;p<c.length;p++){s=c[p];var f=this.internal.pdfEscape,y=this.internal.getEncryptor(t.objId);switch(s.type){case"reference":this.internal.write(" "+s.object.objId+" 0 R ");break;case"text":var w=this.internal.newAdditionalObject(),A=this.internal.newAdditionalObject(),x=this.internal.getEncryptor(w.objId),S=s.title||"Note";i="<</Type /Annot /Subtype /Text "+(n="/Rect ["+a(s.bounds.x)+" "+o(s.bounds.y+s.bounds.h)+" "+a(s.bounds.x+s.bounds.w)+" "+o(s.bounds.y)+"] ")+"/Contents ("+f(x(s.contents))+")",i+=" /Popup "+A.objId+" 0 R",i+=" /P "+l.objId+" 0 R",i+=" /T ("+f(x(S))+") >>",w.content=i;var I=w.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+a(s.bounds.x+30)+" "+o(s.bounds.y+s.bounds.h)+" "+a(s.bounds.x+s.bounds.w+30)+" "+o(s.bounds.y)+"] ")+" /Parent "+I,s.open&&(i+=" /Open true"),i+=" >>",A.content=i,this.internal.write(w.objId,"0 R",A.objId,"0 R");break;case"freetext":n="/Rect ["+a(s.bounds.x)+" "+o(s.bounds.y)+" "+a(s.bounds.x+s.bounds.w)+" "+o(s.bounds.y+s.bounds.h)+"] ";var M=s.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+f(y(s.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+M+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(s.options.name){var B=this.annotations._nameMap[s.options.name];s.options.pageNumber=B.page,s.options.top=B.y}else s.options.top||(s.options.top=0);if(n="/Rect ["+s.finalBounds.x+" "+s.finalBounds.y+" "+s.finalBounds.w+" "+s.finalBounds.h+"] ",i="",s.options.url)i="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+f(y(s.options.url))+") >>";else if(s.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(s.options.pageNumber).objId+" 0 R",s.options.magFactor=s.options.magFactor||"XYZ",s.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+s.options.top+"]";break;case"FitV":s.options.left=s.options.left||0,i+=" /FitV "+s.options.left+"]";break;case"XYZ":default:var Q=o(s.options.top);s.options.left=s.options.left||0,s.options.zoom===void 0&&(s.options.zoom=0),i+=" /XYZ "+s.options.left+" "+Q+" "+s.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),r.createAnnotation=function(t){var s=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":s.pageContext.annotations.push(t)}},r.link=function(t,s,n,i,a){var o=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:l(t),y:c(s),w:l(t+n),h:c(s+i)},options:a,type:"link"})},r.textWithLink=function(t,s,n,i){var a,o,l=this.getTextWidth(t),c=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){o=i.maxWidth;var h=this.splitTextToSize(t,o).length;a=Math.ceil(c*h)}else o=l,a=c;return this.text(t,s,n,i),n+=.2*c,i.align==="center"&&(s-=l/2),i.align==="right"&&(s-=l),this.link(s,n-c,o,a,i),l},r.getTextWidth=function(t){var s=this.internal.getFontSize();return this.getStringUnitWidth(t)*s/this.internal.scaleFactor}}(Je.API),function(r){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},s={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},n=[1570,1571,1573,1575];r.__arabicParser__={};var i=r.__arabicParser__.isInArabicSubstitutionA=function(w){return e[w.charCodeAt(0)]!==void 0},a=r.__arabicParser__.isArabicLetter=function(w){return typeof w=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(w)},o=r.__arabicParser__.isArabicEndLetter=function(w){return a(w)&&i(w)&&e[w.charCodeAt(0)].length<=2},l=r.__arabicParser__.isArabicAlfLetter=function(w){return a(w)&&n.indexOf(w.charCodeAt(0))>=0};r.__arabicParser__.arabicLetterHasIsolatedForm=function(w){return a(w)&&i(w)&&e[w.charCodeAt(0)].length>=1};var c=r.__arabicParser__.arabicLetterHasFinalForm=function(w){return a(w)&&i(w)&&e[w.charCodeAt(0)].length>=2};r.__arabicParser__.arabicLetterHasInitialForm=function(w){return a(w)&&i(w)&&e[w.charCodeAt(0)].length>=3};var h=r.__arabicParser__.arabicLetterHasMedialForm=function(w){return a(w)&&i(w)&&e[w.charCodeAt(0)].length==4},d=r.__arabicParser__.resolveLigatures=function(w){var A=0,x=t,S="",I=0;for(A=0;A<w.length;A+=1)x[w.charCodeAt(A)]!==void 0?(I++,typeof(x=x[w.charCodeAt(A)])=="number"&&(S+=String.fromCharCode(x),x=t,I=0),A===w.length-1&&(x=t,S+=w.charAt(A-(I-1)),A-=I-1,I=0)):(x=t,S+=w.charAt(A-I),A-=I,I=0);return S};r.__arabicParser__.isArabicDiacritic=function(w){return w!==void 0&&s[w.charCodeAt(0)]!==void 0};var p=r.__arabicParser__.getCorrectForm=function(w,A,x){return a(w)?i(w)===!1?-1:!c(w)||!a(A)&&!a(x)||!a(x)&&o(A)||o(w)&&!a(A)||o(w)&&l(A)||o(w)&&o(A)?0:h(w)&&a(A)&&!o(A)&&a(x)&&c(x)?3:o(w)||!a(x)?1:2:-1},f=function(w){var A=0,x=0,S=0,I="",M="",B="",Q=(w=w||"").split("\\s+"),U=[];for(A=0;A<Q.length;A+=1){for(U.push(""),x=0;x<Q[A].length;x+=1)I=Q[A][x],M=Q[A][x-1],B=Q[A][x+1],a(I)?(S=p(I,M,B),U[A]+=S!==-1?String.fromCharCode(e[I.charCodeAt(0)][S]):I):U[A]+=I;U[A]=d(U[A])}return U.join(" ")},y=r.__arabicParser__.processArabic=r.processArabic=function(){var w,A=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,x=[];if(Array.isArray(A)){var S=0;for(x=[],S=0;S<A.length;S+=1)Array.isArray(A[S])?x.push([f(A[S][0]),A[S][1],A[S][2]]):x.push([f(A[S])]);w=x}else w=f(A);return typeof arguments[0]=="string"?w:(arguments[0].text=w,arguments[0])};r.events.push(["preProcessText",y])}(Je.API),Je.API.autoPrint=function(r){var e;switch((r=r||{}).variant=r.variant||"non-conform",r.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(r){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(o){t=o}});var s=150;Object.defineProperty(this,"width",{get:function(){return s},set:function(o){s=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=s+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(o){i=o}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(o){a=o}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,s){var n;if((t=t||"2d")!=="2d")return null;for(n in s)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=s[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},r.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(Je.API),function(r){var e={left:0,top:0,bottom:0,right:0},t=!1,s=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),n.call(this))},n=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(w){l=w}});var c=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return c},set:function(w){c=w}});var h=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return h},set:function(w){h=w}});var d=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return d},set:function(w){d=w}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(w){p=w}});var f=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return f},set:function(w){f=w}});var y=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return y},set:function(w){y=w}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},r.setHeaderFunction=function(l){return s.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},r.getTextDimensions=function(l,c){s.call(this);var h=(c=c||{}).fontSize||this.getFontSize(),d=c.font||this.getFont(),p=c.scaleFactor||this.internal.scaleFactor,f=0,y=0,w=0,A=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var x=c.maxWidth;x>0?typeof l=="string"?l=this.splitTextToSize(l,x):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(I,M){return I.concat(A.splitTextToSize(M,x))},[])):l=Array.isArray(l)?l:[l];for(var S=0;S<l.length;S++)f<(w=this.getStringUnitWidth(l[S],{font:d})*h)&&(f=w);return f!==0&&(y=l.length),{w:f/=p,h:Math.max((y*h*this.getLineHeightFactor()-h*(this.getLineHeightFactor()-1))/p,0)}},r.cellAddPage=function(){s.call(this),this.addPage();var l=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new i(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var a=r.cell=function(){var l;l=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),s.call(this);var c=this.internal.__cell__.lastCell,h=this.internal.__cell__.padding,d=this.internal.__cell__.margins||e,p=this.internal.__cell__.tableHeaderRow,f=this.internal.__cell__.printHeaders;return c.lineNumber!==void 0&&(c.lineNumber===l.lineNumber?(l.x=(c.x||0)+(c.width||0),l.y=c.y||0):c.y+c.height+l.height+d.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=d.top,f&&p&&(this.printHeaderRow(l.lineNumber,!0),l.y+=p[0].height)):l.y=c.y+c.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,t===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-h,l.y+h,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+h,{align:"center",baseline:"top",maxWidth:l.width-h-h}):this.text(l.text,l.x+h,l.y+h,{align:"left",baseline:"top",maxWidth:l.width-h-h})),this.internal.__cell__.lastCell=l,this};r.table=function(l,c,h,d,p){if(s.call(this),!h)throw new Error("No data for PDF table.");var f,y,w,A,x=[],S=[],I=[],M={},B={},Q=[],U=[],O=(p=p||{}).autoSize||!1,G=p.printHeaders!==!1,ne=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,L=p.margins||Object.assign({width:this.getPageWidth()},e),j=typeof p.padding=="number"?p.padding:3,V=p.headerBackgroundColor||"#c8c8c8",q=p.headerTextColor||"#000";if(n.call(this),this.internal.__cell__.printHeaders=G,this.internal.__cell__.margins=L,this.internal.__cell__.table_font_size=ne,this.internal.__cell__.padding=j,this.internal.__cell__.headerBackgroundColor=V,this.internal.__cell__.headerTextColor=q,this.setFontSize(ne),d==null)S=x=Object.keys(h[0]),I=x.map(function(){return"left"});else if(Array.isArray(d)&&Bt(d[0])==="object")for(x=d.map(function(me){return me.name}),S=d.map(function(me){return me.prompt||me.name||""}),I=d.map(function(me){return me.align||"left"}),f=0;f<d.length;f+=1)B[d[f].name]=d[f].width*(19.049976/25.4);else Array.isArray(d)&&typeof d[0]=="string"&&(S=x=d,I=x.map(function(){return"left"}));if(O||Array.isArray(d)&&typeof d[0]=="string")for(f=0;f<x.length;f+=1){for(M[A=x[f]]=h.map(function(me){return me[A]}),this.setFont(void 0,"bold"),Q.push(this.getTextDimensions(S[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),y=M[A],this.setFont(void 0,"normal"),w=0;w<y.length;w+=1)Q.push(this.getTextDimensions(y[w],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);B[A]=Math.max.apply(null,Q)+j+j,Q=[]}if(G){var le={};for(f=0;f<x.length;f+=1)le[x[f]]={},le[x[f]].text=S[f],le[x[f]].align=I[f];var ae=o.call(this,le,B);U=x.map(function(me){return new i(l,c,B[me],ae,le[me].text,void 0,le[me].align)}),this.setTableHeaderRow(U),this.printHeaderRow(1,!1)}var te=d.reduce(function(me,Ae){return me[Ae.name]=Ae.align,me},{});for(f=0;f<h.length;f+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:f,data:h[f]},this);var K=o.call(this,h[f],B);for(w=0;w<x.length;w+=1){var fe=h[f][x[w]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:f,col:w,data:fe},this),a.call(this,new i(l,c,B[x[w]],K,fe,f+2,te[x[w]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=c,this};var o=function(l,c){var h=this.internal.__cell__.padding,d=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(l).map(function(f){var y=l[f];return this.splitTextToSize(y.hasOwnProperty("text")?y.text:y,c[f]-h-h)},this).map(function(f){return this.getLineHeightFactor()*f.length*d/p+h+h},this).reduce(function(f,y){return Math.max(f,y)},0)};r.setTableHeaderRow=function(l){s.call(this),this.internal.__cell__.tableHeaderRow=l},r.printHeaderRow=function(l,c){if(s.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var h;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var d=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(d[0],d[1],d[2],d[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],f=0;f<this.internal.__cell__.tableHeaderRow.length;f+=1){h=this.internal.__cell__.tableHeaderRow[f].clone(),c&&(h.y=this.internal.__cell__.margins.top||0,p.push(h)),h.lineNumber=l;var y=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),a.call(this,h),this.setTextColor(y)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),t=!1}}(Je.API);var Cb={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Pb=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],op=kb(Pb),Lb=[100,200,300,400,500,600,700,800,900],c4=kb(Lb);function lp(r){var e=r.family.replace(/"|'/g,"").toLowerCase(),t=function(i){return Cb[i=i||"normal"]?i:"normal"}(r.style),s=function(i){if(!i)return 400;if(typeof i=="number")return i>=100&&i<=900&&i%100==0?i:400;if(/^\d00$/.test(i))return parseInt(i);switch(i){case"bold":return 700;case"normal":default:return 400}}(r.weight),n=function(i){return typeof op[i=i||"normal"]=="number"?i:"normal"}(r.stretch);return{family:e,style:t,weight:s,stretch:n,src:r.src||[],ref:r.ref||{name:e,style:[n,t,s].join(" ")}}}function s0(r,e,t,s){var n;for(n=t;n>=0&&n<e.length;n+=s)if(r[e[n]])return r[e[n]];for(n=t;n>=0&&n<e.length;n-=s)if(r[e[n]])return r[e[n]]}var h4={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},n0={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function r0(r){return[r.stretch,r.style,r.weight,r.family].join(" ")}function u4(r,e,t){for(var s=(t=t||{}).defaultFontFamily||"times",n=Object.assign({},h4,t.genericFontFamilies||{}),i=null,a=null,o=0;o<e.length;++o)if(n[(i=lp(e[o])).family]&&(i.family=n[i.family]),r.hasOwnProperty(i.family)){a=r[i.family];break}if(!(a=a||r[s]))throw new Error("Could not find a font-family for the rule '"+r0(i)+"' and default family '"+s+"'.");if(a=function(l,c){if(c[l])return c[l];var h=op[l],d=h<=op.normal?-1:1,p=s0(c,Pb,h,d);if(!p)throw new Error("Could not find a matching font-stretch value for "+l);return p}(i.stretch,a),a=function(l,c){if(c[l])return c[l];for(var h=Cb[l],d=0;d<h.length;++d)if(c[h[d]])return c[h[d]];throw new Error("Could not find a matching font-style for "+l)}(i.style,a),!(a=function(l,c){if(c[l])return c[l];if(l===400&&c[500])return c[500];if(l===500&&c[400])return c[400];var h=c4[l],d=s0(c,Lb,h,l<400?-1:1);if(!d)throw new Error("Could not find a matching font-weight for value "+l);return d}(i.weight,a)))throw new Error("Failed to resolve a font for the rule '"+r0(i)+"'.");return a}function i0(r){return r.trimLeft()}function d4(r,e){for(var t=0;t<r.length;){if(r.charAt(t)===e)return[r.substring(0,t),r.substring(t+1)];t+=1}return null}function f4(r){var e=r.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],r.substring(e[0].length)]}var Jh,a0,o0,_f=["times"];(function(r){var e,t,s,n,i,a,o,l,c,h=function(k){return k=k||{},this.isStrokeTransparent=k.isStrokeTransparent||!1,this.strokeOpacity=k.strokeOpacity||1,this.strokeStyle=k.strokeStyle||"#000000",this.fillStyle=k.fillStyle||"#000000",this.isFillTransparent=k.isFillTransparent||!1,this.fillOpacity=k.fillOpacity||1,this.font=k.font||"10px sans-serif",this.textBaseline=k.textBaseline||"alphabetic",this.textAlign=k.textAlign||"left",this.lineWidth=k.lineWidth||1,this.lineJoin=k.lineJoin||"miter",this.lineCap=k.lineCap||"butt",this.path=k.path||[],this.transform=k.transform!==void 0?k.transform.clone():new l,this.globalCompositeOperation=k.globalCompositeOperation||"normal",this.globalAlpha=k.globalAlpha||1,this.clip_path=k.clip_path||[],this.currentPoint=k.currentPoint||new a,this.miterLimit=k.miterLimit||10,this.lastPoint=k.lastPoint||new a,this.lineDashOffset=k.lineDashOffset||0,this.lineDash=k.lineDash||[],this.margin=k.margin||[0,0,0,0],this.prevPageLastElemOffset=k.prevPageLastElemOffset||0,this.ignoreClearRect=typeof k.ignoreClearRect!="boolean"||k.ignoreClearRect,this};r.events.push(["initialized",function(){this.context2d=new d(this),e=this.internal.f2,t=this.internal.getCoordinateString,s=this.internal.getVerticalCoordinateString,n=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,a=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,c=new h}]);var d=function(k){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var D=k;Object.defineProperty(this,"pdf",{get:function(){return D}});var z=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return z},set:function(be){z=!!be}});var X=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return X},set:function(be){X=!!be}});var ee=0;Object.defineProperty(this,"posX",{get:function(){return ee},set:function(be){isNaN(be)||(ee=be)}});var ie=0;Object.defineProperty(this,"posY",{get:function(){return ie},set:function(be){isNaN(be)||(ie=be)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(be){var H;typeof be=="number"?H=[be,be,be,be]:((H=new Array(4))[0]=be[0],H[1]=be.length>=2?be[1]:H[0],H[2]=be.length>=3?be[2]:H[0],H[3]=be.length>=4?be[3]:H[1]),c.margin=H}});var ue=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ue},set:function(be){ue=be}});var de=0;Object.defineProperty(this,"lastBreak",{get:function(){return de},set:function(be){de=be}});var ke=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ke},set:function(be){ke=be}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(be){be instanceof h&&(c=be)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(be){c.path=be}});var Ee=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ee},set:function(be){Ee=be}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(be){var H;H=p(be),this.ctx.fillStyle=H.style,this.ctx.isFillTransparent=H.a===0,this.ctx.fillOpacity=H.a,this.pdf.setFillColor(H.r,H.g,H.b,{a:H.a}),this.pdf.setTextColor(H.r,H.g,H.b,{a:H.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(be){var H=p(be);this.ctx.strokeStyle=H.style,this.ctx.isStrokeTransparent=H.a===0,this.ctx.strokeOpacity=H.a,H.a===0?this.pdf.setDrawColor(255,255,255):(H.a,this.pdf.setDrawColor(H.r,H.g,H.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(be){["butt","round","square"].indexOf(be)!==-1&&(this.ctx.lineCap=be,this.pdf.setLineCap(be))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(be){isNaN(be)||(this.ctx.lineWidth=be,this.pdf.setLineWidth(be))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(be){["bevel","round","miter"].indexOf(be)!==-1&&(this.ctx.lineJoin=be,this.pdf.setLineJoin(be))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(be){isNaN(be)||(this.ctx.miterLimit=be,this.pdf.setMiterLimit(be))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(be){this.ctx.textBaseline=be}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(be){["right","end","center","left","start"].indexOf(be)!==-1&&(this.ctx.textAlign=be)}});var Re=null;function Le(be,H){if(Re===null){var ct=function(Ue){var Ne=[];return Object.keys(Ue).forEach(function(Ce){Ue[Ce].forEach(function(Oe){var Ie=null;switch(Oe){case"bold":Ie={family:Ce,weight:"bold"};break;case"italic":Ie={family:Ce,style:"italic"};break;case"bolditalic":Ie={family:Ce,weight:"bold",style:"italic"};break;case"":case"normal":Ie={family:Ce}}Ie!==null&&(Ie.ref={name:Ce,style:Oe},Ne.push(Ie))})}),Ne}(be.getFontList());Re=function(Ue){for(var Ne={},Ce=0;Ce<Ue.length;++Ce){var Oe=lp(Ue[Ce]),Ie=Oe.family,Ve=Oe.stretch,rt=Oe.style,ft=Oe.weight;Ne[Ie]=Ne[Ie]||{},Ne[Ie][Ve]=Ne[Ie][Ve]||{},Ne[Ie][Ve][rt]=Ne[Ie][Ve][rt]||{},Ne[Ie][Ve][rt][ft]=Oe}return Ne}(ct.concat(H))}return Re}var Ke=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ke},set:function(be){Re=null,Ke=be}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(be){var H;if(this.ctx.font=be,(H=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(be))!==null){var ct=H[1],Ue=(H[2],H[3]),Ne=H[4],Ce=(H[5],H[6]),Oe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ne)[2];Ne=Math.floor(Oe==="px"?parseFloat(Ne)*this.pdf.internal.scaleFactor:Oe==="em"?parseFloat(Ne)*this.pdf.getFontSize():parseFloat(Ne)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ne);var Ie=function(tt){var wt,Me,Vs=[],Tt=tt.trim();if(Tt==="")return _f;if(Tt in n0)return[n0[Tt]];for(;Tt!=="";){switch(Me=null,wt=(Tt=i0(Tt)).charAt(0)){case'"':case"'":Me=d4(Tt.substring(1),wt);break;default:Me=f4(Tt)}if(Me===null||(Vs.push(Me[0]),(Tt=i0(Me[1]))!==""&&Tt.charAt(0)!==","))return _f;Tt=Tt.replace(/^,/,"")}return Vs}(Ce);if(this.fontFaces){var Ve=u4(Le(this.pdf,this.fontFaces),Ie.map(function(tt){return{family:tt,stretch:"normal",weight:Ue,style:ct}}));this.pdf.setFont(Ve.ref.name,Ve.ref.style)}else{var rt="";(Ue==="bold"||parseInt(Ue,10)>=700||ct==="bold")&&(rt="bold"),ct==="italic"&&(rt+="italic"),rt.length===0&&(rt="normal");for(var ft="",yt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Pt=0;Pt<Ie.length;Pt++){if(this.pdf.internal.getFont(Ie[Pt],rt,{noFallback:!0,disableWarning:!0})!==void 0){ft=Ie[Pt];break}if(rt==="bolditalic"&&this.pdf.internal.getFont(Ie[Pt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)ft=Ie[Pt],rt="bold";else if(this.pdf.internal.getFont(Ie[Pt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){ft=Ie[Pt],rt="normal";break}}if(ft===""){for(var qt=0;qt<Ie.length;qt++)if(yt[Ie[qt]]){ft=yt[Ie[qt]];break}}ft=ft===""?"Times":ft,this.pdf.setFont(ft,rt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(be){this.ctx.globalCompositeOperation=be}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(be){this.ctx.globalAlpha=be}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(be){this.ctx.lineDashOffset=be,Ae.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(be){this.ctx.lineDash=be,Ae.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(be){this.ctx.ignoreClearRect=!!be}})};d.prototype.setLineDash=function(k){this.lineDash=k},d.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},d.prototype.fill=function(){M.call(this,"fill",!1)},d.prototype.stroke=function(){M.call(this,"stroke",!1)},d.prototype.beginPath=function(){this.path=[{type:"begin"}]},d.prototype.moveTo=function(k,D){if(isNaN(k)||isNaN(D))throw Gt.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var z=this.ctx.transform.applyToPoint(new a(k,D));this.path.push({type:"mt",x:z.x,y:z.y}),this.ctx.lastPoint=new a(k,D)},d.prototype.closePath=function(){var k=new a(0,0),D=0;for(D=this.path.length-1;D!==-1;D--)if(this.path[D].type==="begin"&&Bt(this.path[D+1])==="object"&&typeof this.path[D+1].x=="number"){k=new a(this.path[D+1].x,this.path[D+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new a(k.x,k.y)},d.prototype.lineTo=function(k,D){if(isNaN(k)||isNaN(D))throw Gt.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var z=this.ctx.transform.applyToPoint(new a(k,D));this.path.push({type:"lt",x:z.x,y:z.y}),this.ctx.lastPoint=new a(z.x,z.y)},d.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),M.call(this,null,!0)},d.prototype.quadraticCurveTo=function(k,D,z,X){if(isNaN(z)||isNaN(X)||isNaN(k)||isNaN(D))throw Gt.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ee=this.ctx.transform.applyToPoint(new a(z,X)),ie=this.ctx.transform.applyToPoint(new a(k,D));this.path.push({type:"qct",x1:ie.x,y1:ie.y,x:ee.x,y:ee.y}),this.ctx.lastPoint=new a(ee.x,ee.y)},d.prototype.bezierCurveTo=function(k,D,z,X,ee,ie){if(isNaN(ee)||isNaN(ie)||isNaN(k)||isNaN(D)||isNaN(z)||isNaN(X))throw Gt.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ue=this.ctx.transform.applyToPoint(new a(ee,ie)),de=this.ctx.transform.applyToPoint(new a(k,D)),ke=this.ctx.transform.applyToPoint(new a(z,X));this.path.push({type:"bct",x1:de.x,y1:de.y,x2:ke.x,y2:ke.y,x:ue.x,y:ue.y}),this.ctx.lastPoint=new a(ue.x,ue.y)},d.prototype.arc=function(k,D,z,X,ee,ie){if(isNaN(k)||isNaN(D)||isNaN(z)||isNaN(X)||isNaN(ee))throw Gt.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ie=!!ie,!this.ctx.transform.isIdentity){var ue=this.ctx.transform.applyToPoint(new a(k,D));k=ue.x,D=ue.y;var de=this.ctx.transform.applyToPoint(new a(0,z)),ke=this.ctx.transform.applyToPoint(new a(0,0));z=Math.sqrt(Math.pow(de.x-ke.x,2)+Math.pow(de.y-ke.y,2))}Math.abs(ee-X)>=2*Math.PI&&(X=0,ee=2*Math.PI),this.path.push({type:"arc",x:k,y:D,radius:z,startAngle:X,endAngle:ee,counterclockwise:ie})},d.prototype.arcTo=function(k,D,z,X,ee){throw new Error("arcTo not implemented.")},d.prototype.rect=function(k,D,z,X){if(isNaN(k)||isNaN(D)||isNaN(z)||isNaN(X))throw Gt.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(k,D),this.lineTo(k+z,D),this.lineTo(k+z,D+X),this.lineTo(k,D+X),this.lineTo(k,D),this.lineTo(k+z,D),this.lineTo(k,D)},d.prototype.fillRect=function(k,D,z,X){if(isNaN(k)||isNaN(D)||isNaN(z)||isNaN(X))throw Gt.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var ee={};this.lineCap!=="butt"&&(ee.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ee.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(k,D,z,X),this.fill(),ee.hasOwnProperty("lineCap")&&(this.lineCap=ee.lineCap),ee.hasOwnProperty("lineJoin")&&(this.lineJoin=ee.lineJoin)}},d.prototype.strokeRect=function(k,D,z,X){if(isNaN(k)||isNaN(D)||isNaN(z)||isNaN(X))throw Gt.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");y.call(this)||(this.beginPath(),this.rect(k,D,z,X),this.stroke())},d.prototype.clearRect=function(k,D,z,X){if(isNaN(k)||isNaN(D)||isNaN(z)||isNaN(X))throw Gt.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(k,D,z,X))},d.prototype.save=function(k){k=typeof k!="boolean"||k;for(var D=this.pdf.internal.getCurrentPageInfo().pageNumber,z=0;z<this.pdf.internal.getNumberOfPages();z++)this.pdf.setPage(z+1),this.pdf.internal.out("q");if(this.pdf.setPage(D),k){this.ctx.fontSize=this.pdf.internal.getFontSize();var X=new h(this.ctx);this.ctxStack.push(this.ctx),this.ctx=X}},d.prototype.restore=function(k){k=typeof k!="boolean"||k;for(var D=this.pdf.internal.getCurrentPageInfo().pageNumber,z=0;z<this.pdf.internal.getNumberOfPages();z++)this.pdf.setPage(z+1),this.pdf.internal.out("Q");this.pdf.setPage(D),k&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},d.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(k){var D,z,X,ee;if(k.isCanvasGradient===!0&&(k=k.getColor()),!k)return{r:0,g:0,b:0,a:0,style:k};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(k))D=0,z=0,X=0,ee=0;else{var ie=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(k);if(ie!==null)D=parseInt(ie[1]),z=parseInt(ie[2]),X=parseInt(ie[3]),ee=1;else if((ie=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(k))!==null)D=parseInt(ie[1]),z=parseInt(ie[2]),X=parseInt(ie[3]),ee=parseFloat(ie[4]);else{if(ee=1,typeof k=="string"&&k.charAt(0)!=="#"){var ue=new xb(k);k=ue.ok?ue.toHex():"#000000"}k.length===4?(D=k.substring(1,2),D+=D,z=k.substring(2,3),z+=z,X=k.substring(3,4),X+=X):(D=k.substring(1,3),z=k.substring(3,5),X=k.substring(5,7)),D=parseInt(D,16),z=parseInt(z,16),X=parseInt(X,16)}}return{r:D,g:z,b:X,a:ee,style:k}},f=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},y=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};d.prototype.fillText=function(k,D,z,X){if(isNaN(D)||isNaN(z)||typeof k!="string")throw Gt.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(X=isNaN(X)?void 0:X,!f.call(this)){var ee=K(this.ctx.transform.rotation),ie=this.ctx.transform.scaleX;j.call(this,{text:k,x:D,y:z,scale:ie,angle:ee,align:this.textAlign,maxWidth:X})}},d.prototype.strokeText=function(k,D,z,X){if(isNaN(D)||isNaN(z)||typeof k!="string")throw Gt.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!y.call(this)){X=isNaN(X)?void 0:X;var ee=K(this.ctx.transform.rotation),ie=this.ctx.transform.scaleX;j.call(this,{text:k,x:D,y:z,scale:ie,renderingMode:"stroke",angle:ee,align:this.textAlign,maxWidth:X})}},d.prototype.measureText=function(k){if(typeof k!="string")throw Gt.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var D=this.pdf,z=this.pdf.internal.scaleFactor,X=D.internal.getFontSize(),ee=D.getStringUnitWidth(k)*X/D.internal.scaleFactor,ie=function(ue){var de=(ue=ue||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return de}}),this};return new ie({width:ee*=Math.round(96*z/72*1e4)/1e4})},d.prototype.scale=function(k,D){if(isNaN(k)||isNaN(D))throw Gt.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var z=new l(k,0,0,D,0,0);this.ctx.transform=this.ctx.transform.multiply(z)},d.prototype.rotate=function(k){if(isNaN(k))throw Gt.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var D=new l(Math.cos(k),Math.sin(k),-Math.sin(k),Math.cos(k),0,0);this.ctx.transform=this.ctx.transform.multiply(D)},d.prototype.translate=function(k,D){if(isNaN(k)||isNaN(D))throw Gt.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var z=new l(1,0,0,1,k,D);this.ctx.transform=this.ctx.transform.multiply(z)},d.prototype.transform=function(k,D,z,X,ee,ie){if(isNaN(k)||isNaN(D)||isNaN(z)||isNaN(X)||isNaN(ee)||isNaN(ie))throw Gt.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ue=new l(k,D,z,X,ee,ie);this.ctx.transform=this.ctx.transform.multiply(ue)},d.prototype.setTransform=function(k,D,z,X,ee,ie){k=isNaN(k)?1:k,D=isNaN(D)?0:D,z=isNaN(z)?0:z,X=isNaN(X)?1:X,ee=isNaN(ee)?0:ee,ie=isNaN(ie)?0:ie,this.ctx.transform=new l(k,D,z,X,ee,ie)};var w=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};d.prototype.drawImage=function(k,D,z,X,ee,ie,ue,de,ke){var Ee=this.pdf.getImageProperties(k),Re=1,Le=1,Ke=1,be=1;X!==void 0&&de!==void 0&&(Ke=de/X,be=ke/ee,Re=Ee.width/X*de/X,Le=Ee.height/ee*ke/ee),ie===void 0&&(ie=D,ue=z,D=0,z=0),X!==void 0&&de===void 0&&(de=X,ke=ee),X===void 0&&de===void 0&&(de=Ee.width,ke=Ee.height);for(var H,ct=this.ctx.transform.decompose(),Ue=K(ct.rotate.shx),Ne=new l,Ce=(Ne=(Ne=(Ne=Ne.multiply(ct.translate)).multiply(ct.skew)).multiply(ct.scale)).applyToRectangle(new o(ie-D*Ke,ue-z*be,X*Re,ee*Le)),Oe=A.call(this,Ce),Ie=[],Ve=0;Ve<Oe.length;Ve+=1)Ie.indexOf(Oe[Ve])===-1&&Ie.push(Oe[Ve]);if(I(Ie),this.autoPaging)for(var rt=Ie[0],ft=Ie[Ie.length-1],yt=rt;yt<ft+1;yt++){this.pdf.setPage(yt);var Pt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],qt=yt===1?this.posY+this.margin[0]:this.margin[0],tt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],wt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Me=yt===1?0:tt+(yt-2)*wt;if(this.ctx.clip_path.length!==0){var Vs=this.path;H=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(H,this.posX+this.margin[3],-Me+qt+this.ctx.prevPageLastElemOffset),B.call(this,"fill",!0),this.path=Vs}var Tt=JSON.parse(JSON.stringify(Ce));Tt=S([Tt],this.posX+this.margin[3],-Me+qt+this.ctx.prevPageLastElemOffset)[0];var Zn=(yt>rt||yt<ft)&&w.call(this);Zn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Pt,wt,null).clip().discardPath()),this.pdf.addImage(k,"JPEG",Tt.x,Tt.y,Tt.w,Tt.h,null,null,Ue),Zn&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(k,"JPEG",Ce.x,Ce.y,Ce.w,Ce.h,null,null,Ue)};var A=function(k,D,z){var X=[];D=D||this.pdf.internal.pageSize.width,z=z||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ee=this.posY+this.ctx.prevPageLastElemOffset;switch(k.type){default:case"mt":case"lt":X.push(Math.floor((k.y+ee)/z)+1);break;case"arc":X.push(Math.floor((k.y+ee-k.radius)/z)+1),X.push(Math.floor((k.y+ee+k.radius)/z)+1);break;case"qct":var ie=fe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,k.x1,k.y1,k.x,k.y);X.push(Math.floor((ie.y+ee)/z)+1),X.push(Math.floor((ie.y+ie.h+ee)/z)+1);break;case"bct":var ue=me(this.ctx.lastPoint.x,this.ctx.lastPoint.y,k.x1,k.y1,k.x2,k.y2,k.x,k.y);X.push(Math.floor((ue.y+ee)/z)+1),X.push(Math.floor((ue.y+ue.h+ee)/z)+1);break;case"rect":X.push(Math.floor((k.y+ee)/z)+1),X.push(Math.floor((k.y+k.h+ee)/z)+1)}for(var de=0;de<X.length;de+=1)for(;this.pdf.internal.getNumberOfPages()<X[de];)x.call(this);return X},x=function(){var k=this.fillStyle,D=this.strokeStyle,z=this.font,X=this.lineCap,ee=this.lineWidth,ie=this.lineJoin;this.pdf.addPage(),this.fillStyle=k,this.strokeStyle=D,this.font=z,this.lineCap=X,this.lineWidth=ee,this.lineJoin=ie},S=function(k,D,z){for(var X=0;X<k.length;X++)switch(k[X].type){case"bct":k[X].x2+=D,k[X].y2+=z;case"qct":k[X].x1+=D,k[X].y1+=z;case"mt":case"lt":case"arc":default:k[X].x+=D,k[X].y+=z}return k},I=function(k){return k.sort(function(D,z){return D-z})},M=function(k,D){for(var z,X,ee=this.fillStyle,ie=this.strokeStyle,ue=this.lineCap,de=this.lineWidth,ke=Math.abs(de*this.ctx.transform.scaleX),Ee=this.lineJoin,Re=JSON.parse(JSON.stringify(this.path)),Le=JSON.parse(JSON.stringify(this.path)),Ke=[],be=0;be<Le.length;be++)if(Le[be].x!==void 0)for(var H=A.call(this,Le[be]),ct=0;ct<H.length;ct+=1)Ke.indexOf(H[ct])===-1&&Ke.push(H[ct]);for(var Ue=0;Ue<Ke.length;Ue++)for(;this.pdf.internal.getNumberOfPages()<Ke[Ue];)x.call(this);if(I(Ke),this.autoPaging)for(var Ne=Ke[0],Ce=Ke[Ke.length-1],Oe=Ne;Oe<Ce+1;Oe++){this.pdf.setPage(Oe),this.fillStyle=ee,this.strokeStyle=ie,this.lineCap=ue,this.lineWidth=ke,this.lineJoin=Ee;var Ie=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ve=Oe===1?this.posY+this.margin[0]:this.margin[0],rt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ft=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],yt=Oe===1?0:rt+(Oe-2)*ft;if(this.ctx.clip_path.length!==0){var Pt=this.path;z=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(z,this.posX+this.margin[3],-yt+Ve+this.ctx.prevPageLastElemOffset),B.call(this,k,!0),this.path=Pt}if(X=JSON.parse(JSON.stringify(Re)),this.path=S(X,this.posX+this.margin[3],-yt+Ve+this.ctx.prevPageLastElemOffset),D===!1||Oe===0){var qt=(Oe>Ne||Oe<Ce)&&w.call(this);qt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ie,ft,null).clip().discardPath()),B.call(this,k,D),qt&&this.pdf.restoreGraphicsState()}this.lineWidth=de}else this.lineWidth=ke,B.call(this,k,D),this.lineWidth=de;this.path=Re},B=function(k,D){if((k!=="stroke"||D||!y.call(this))&&(k==="stroke"||D||!f.call(this))){for(var z,X,ee=[],ie=this.path,ue=0;ue<ie.length;ue++){var de=ie[ue];switch(de.type){case"begin":ee.push({begin:!0});break;case"close":ee.push({close:!0});break;case"mt":ee.push({start:de,deltas:[],abs:[]});break;case"lt":var ke=ee.length;if(ie[ue-1]&&!isNaN(ie[ue-1].x)&&(z=[de.x-ie[ue-1].x,de.y-ie[ue-1].y],ke>0)){for(;ke>=0;ke--)if(ee[ke-1].close!==!0&&ee[ke-1].begin!==!0){ee[ke-1].deltas.push(z),ee[ke-1].abs.push(de);break}}break;case"bct":z=[de.x1-ie[ue-1].x,de.y1-ie[ue-1].y,de.x2-ie[ue-1].x,de.y2-ie[ue-1].y,de.x-ie[ue-1].x,de.y-ie[ue-1].y],ee[ee.length-1].deltas.push(z);break;case"qct":var Ee=ie[ue-1].x+2/3*(de.x1-ie[ue-1].x),Re=ie[ue-1].y+2/3*(de.y1-ie[ue-1].y),Le=de.x+2/3*(de.x1-de.x),Ke=de.y+2/3*(de.y1-de.y),be=de.x,H=de.y;z=[Ee-ie[ue-1].x,Re-ie[ue-1].y,Le-ie[ue-1].x,Ke-ie[ue-1].y,be-ie[ue-1].x,H-ie[ue-1].y],ee[ee.length-1].deltas.push(z);break;case"arc":ee.push({deltas:[],abs:[],arc:!0}),Array.isArray(ee[ee.length-1].abs)&&ee[ee.length-1].abs.push(de)}}X=D?null:k==="stroke"?"stroke":"fill";for(var ct=!1,Ue=0;Ue<ee.length;Ue++)if(ee[Ue].arc)for(var Ne=ee[Ue].abs,Ce=0;Ce<Ne.length;Ce++){var Oe=Ne[Ce];Oe.type==="arc"?O.call(this,Oe.x,Oe.y,Oe.radius,Oe.startAngle,Oe.endAngle,Oe.counterclockwise,void 0,D,!ct):V.call(this,Oe.x,Oe.y),ct=!0}else if(ee[Ue].close===!0)this.pdf.internal.out("h"),ct=!1;else if(ee[Ue].begin!==!0){var Ie=ee[Ue].start.x,Ve=ee[Ue].start.y;q.call(this,ee[Ue].deltas,Ie,Ve),ct=!0}X&&G.call(this,X),D&&ne.call(this)}},Q=function(k){var D=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,z=D*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return k-z;case"top":return k+D-z;case"hanging":return k+D-2*z;case"middle":return k+D/2-z;case"ideographic":return k;case"alphabetic":default:return k}},U=function(k){return k+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};d.prototype.createLinearGradient=function(){var k=function(){};return k.colorStops=[],k.addColorStop=function(D,z){this.colorStops.push([D,z])},k.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},k.isCanvasGradient=!0,k},d.prototype.createPattern=function(){return this.createLinearGradient()},d.prototype.createRadialGradient=function(){return this.createLinearGradient()};var O=function(k,D,z,X,ee,ie,ue,de,ke){for(var Ee=ae.call(this,z,X,ee,ie),Re=0;Re<Ee.length;Re++){var Le=Ee[Re];Re===0&&(ke?L.call(this,Le.x1+k,Le.y1+D):V.call(this,Le.x1+k,Le.y1+D)),le.call(this,k,D,Le.x2,Le.y2,Le.x3,Le.y3,Le.x4,Le.y4)}de?ne.call(this):G.call(this,ue)},G=function(k){switch(k){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},ne=function(){this.pdf.clip(),this.pdf.discardPath()},L=function(k,D){this.pdf.internal.out(t(k)+" "+s(D)+" m")},j=function(k){var D;switch(k.align){case"right":case"end":D="right";break;case"center":D="center";break;case"left":case"start":default:D="left"}var z=this.pdf.getTextDimensions(k.text),X=Q.call(this,k.y),ee=U.call(this,X)-z.h,ie=this.ctx.transform.applyToPoint(new a(k.x,X)),ue=this.ctx.transform.decompose(),de=new l;de=(de=(de=de.multiply(ue.translate)).multiply(ue.skew)).multiply(ue.scale);for(var ke,Ee,Re,Le=this.ctx.transform.applyToRectangle(new o(k.x,X,z.w,z.h)),Ke=de.applyToRectangle(new o(k.x,ee,z.w,z.h)),be=A.call(this,Ke),H=[],ct=0;ct<be.length;ct+=1)H.indexOf(be[ct])===-1&&H.push(be[ct]);if(I(H),this.autoPaging)for(var Ue=H[0],Ne=H[H.length-1],Ce=Ue;Ce<Ne+1;Ce++){this.pdf.setPage(Ce);var Oe=Ce===1?this.posY+this.margin[0]:this.margin[0],Ie=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ve=this.pdf.internal.pageSize.height-this.margin[2],rt=Ve-this.margin[0],ft=this.pdf.internal.pageSize.width-this.margin[1],yt=ft-this.margin[3],Pt=Ce===1?0:Ie+(Ce-2)*rt;if(this.ctx.clip_path.length!==0){var qt=this.path;ke=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(ke,this.posX+this.margin[3],-1*Pt+Oe),B.call(this,"fill",!0),this.path=qt}var tt=S([JSON.parse(JSON.stringify(Ke))],this.posX+this.margin[3],-Pt+Oe+this.ctx.prevPageLastElemOffset)[0];k.scale>=.01&&(Ee=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ee*k.scale),Re=this.lineWidth,this.lineWidth=Re*k.scale);var wt=this.autoPaging!=="text";if(wt||tt.y+tt.h<=Ve){if(wt||tt.y>=Oe&&tt.x<=ft){var Me=wt?k.text:this.pdf.splitTextToSize(k.text,k.maxWidth||ft-tt.x)[0],Vs=S([JSON.parse(JSON.stringify(Le))],this.posX+this.margin[3],-Pt+Oe+this.ctx.prevPageLastElemOffset)[0],Tt=wt&&(Ce>Ue||Ce<Ne)&&w.call(this);Tt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],yt,rt,null).clip().discardPath()),this.pdf.text(Me,Vs.x,Vs.y,{angle:k.angle,align:D,renderingMode:k.renderingMode}),Tt&&this.pdf.restoreGraphicsState()}}else tt.y<Ve&&(this.ctx.prevPageLastElemOffset+=Ve-tt.y);k.scale>=.01&&(this.pdf.setFontSize(Ee),this.lineWidth=Re)}else k.scale>=.01&&(Ee=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ee*k.scale),Re=this.lineWidth,this.lineWidth=Re*k.scale),this.pdf.text(k.text,ie.x+this.posX,ie.y+this.posY,{angle:k.angle,align:D,renderingMode:k.renderingMode,maxWidth:k.maxWidth}),k.scale>=.01&&(this.pdf.setFontSize(Ee),this.lineWidth=Re)},V=function(k,D,z,X){z=z||0,X=X||0,this.pdf.internal.out(t(k+z)+" "+s(D+X)+" l")},q=function(k,D,z){return this.pdf.lines(k,D,z,null,null)},le=function(k,D,z,X,ee,ie,ue,de){this.pdf.internal.out([e(n(z+k)),e(i(X+D)),e(n(ee+k)),e(i(ie+D)),e(n(ue+k)),e(i(de+D)),"c"].join(" "))},ae=function(k,D,z,X){for(var ee=2*Math.PI,ie=Math.PI/2;D>z;)D-=ee;var ue=Math.abs(z-D);ue<ee&&X&&(ue=ee-ue);for(var de=[],ke=X?-1:1,Ee=D;ue>1e-5;){var Re=Ee+ke*Math.min(ue,ie);de.push(te.call(this,k,Ee,Re)),ue-=Math.abs(Re-Ee),Ee=Re}return de},te=function(k,D,z){var X=(z-D)/2,ee=k*Math.cos(X),ie=k*Math.sin(X),ue=ee,de=-ie,ke=ue*ue+de*de,Ee=ke+ue*ee+de*ie,Re=4/3*(Math.sqrt(2*ke*Ee)-Ee)/(ue*ie-de*ee),Le=ue-Re*de,Ke=de+Re*ue,be=Le,H=-Ke,ct=X+D,Ue=Math.cos(ct),Ne=Math.sin(ct);return{x1:k*Math.cos(D),y1:k*Math.sin(D),x2:Le*Ue-Ke*Ne,y2:Le*Ne+Ke*Ue,x3:be*Ue-H*Ne,y3:be*Ne+H*Ue,x4:k*Math.cos(z),y4:k*Math.sin(z)}},K=function(k){return 180*k/Math.PI},fe=function(k,D,z,X,ee,ie){var ue=k+.5*(z-k),de=D+.5*(X-D),ke=ee+.5*(z-ee),Ee=ie+.5*(X-ie),Re=Math.min(k,ee,ue,ke),Le=Math.max(k,ee,ue,ke),Ke=Math.min(D,ie,de,Ee),be=Math.max(D,ie,de,Ee);return new o(Re,Ke,Le-Re,be-Ke)},me=function(k,D,z,X,ee,ie,ue,de){var ke,Ee,Re,Le,Ke,be,H,ct,Ue,Ne,Ce,Oe,Ie,Ve,rt=z-k,ft=X-D,yt=ee-z,Pt=ie-X,qt=ue-ee,tt=de-ie;for(Ee=0;Ee<41;Ee++)Ue=(H=(Re=k+(ke=Ee/40)*rt)+ke*((Ke=z+ke*yt)-Re))+ke*(Ke+ke*(ee+ke*qt-Ke)-H),Ne=(ct=(Le=D+ke*ft)+ke*((be=X+ke*Pt)-Le))+ke*(be+ke*(ie+ke*tt-be)-ct),Ee==0?(Ce=Ue,Oe=Ne,Ie=Ue,Ve=Ne):(Ce=Math.min(Ce,Ue),Oe=Math.min(Oe,Ne),Ie=Math.max(Ie,Ue),Ve=Math.max(Ve,Ne));return new o(Math.round(Ce),Math.round(Oe),Math.round(Ie-Ce),Math.round(Ve-Oe))},Ae=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var k,D,z=(k=this.ctx.lineDash,D=this.ctx.lineDashOffset,JSON.stringify({lineDash:k,lineDashOffset:D}));this.prevLineDash!==z&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=z)}}})(Je.API),function(r){var e=function(i){var a,o,l,c,h,d,p,f,y,w;for(o=[],l=0,c=(i+=a="\0\0\0\0".slice(i.length%4||4)).length;c>l;l+=4)(h=(i.charCodeAt(l)<<24)+(i.charCodeAt(l+1)<<16)+(i.charCodeAt(l+2)<<8)+i.charCodeAt(l+3))!==0?(d=(h=((h=((h=((h=(h-(w=h%85))/85)-(y=h%85))/85)-(f=h%85))/85)-(p=h%85))/85)%85,o.push(d+33,p+33,f+33,y+33,w+33)):o.push(122);return function(A,x){for(var S=x;S>0;S--)A.pop()}(o,a.length),String.fromCharCode.apply(String,o)+"~>"},t=function(i){var a,o,l,c,h,d=String,p="length",f=255,y="charCodeAt",w="slice",A="replace";for(i[w](-2),i=i[w](0,-2)[A](/\s/g,"")[A]("z","!!!!!"),l=[],c=0,h=(i+=a="uuuuu"[w](i[p]%5||5))[p];h>c;c+=5)o=52200625*(i[y](c)-33)+614125*(i[y](c+1)-33)+7225*(i[y](c+2)-33)+85*(i[y](c+3)-33)+(i[y](c+4)-33),l.push(f&o>>24,f&o>>16,f&o>>8,f&o);return function(x,S){for(var I=S;I>0;I--)x.pop()}(l,a[p]),d.fromCharCode.apply(d,l)},s=function(i){var a=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),a.test(i)===!1)return"";for(var o="",l=0;l<i.length;l+=2)o+=String.fromCharCode("0x"+(i[l]+i[l+1]));return o},n=function(i){for(var a=new Uint8Array(i.length),o=i.length;o--;)a[o]=i.charCodeAt(o);return i=(a=sp(a)).reduce(function(l,c){return l+String.fromCharCode(c)},"")};r.processDataByFilters=function(i,a){var o=0,l=i||"",c=[];for(typeof(a=a||[])=="string"&&(a=[a]),o=0;o<a.length;o+=1)switch(a[o]){case"ASCII85Decode":case"/ASCII85Decode":l=t(l),c.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":l=e(l),c.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":l=s(l),c.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":l=l.split("").map(function(h){return("0"+h.charCodeAt().toString(16)).slice(-2)}).join("")+">",c.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":l=n(l),c.push("/FlateDecode");break;default:throw new Error('The filter: "'+a[o]+'" is not implemented')}return{data:l,reverseChain:c.reverse().join(" ")}}}(Je.API),function(r){r.loadFile=function(e,t,s){return function(n,i,a){i=i!==!1,a=typeof a=="function"?a:function(){};var o=void 0;try{o=function(l,c,h){var d=new XMLHttpRequest,p=0,f=function(y){var w=y.length,A=[],x=String.fromCharCode;for(p=0;p<w;p+=1)A.push(x(255&y.charCodeAt(p)));return A.join("")};if(d.open("GET",l,!c),d.overrideMimeType("text/plain; charset=x-user-defined"),c===!1&&(d.onload=function(){d.status===200?h(f(this.responseText)):h(void 0)}),d.send(null),c&&d.status===200)return f(d.responseText)}(n,i,a)}catch{}return o}(e,t,s)},r.loadImageFile=r.loadFile}(Je.API),function(r){function e(){return(Ze.html2canvas?Promise.resolve(Ze.html2canvas):vi(()=>import("./html2canvas.esm-BfxBtG_O.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load html2canvas: "+a))}).then(function(a){return a.default?a.default:a})}function t(){return(Ze.DOMPurify?Promise.resolve(Ze.DOMPurify):vi(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load dompurify: "+a))}).then(function(a){return a.default?a.default:a})}var s=function(a){var o=Bt(a);return o==="undefined"?"undefined":o==="string"||a instanceof String?"string":o==="number"||a instanceof Number?"number":o==="function"||a instanceof Function?"function":a&&a.constructor===Array?"array":a&&a.nodeType===1?"element":o==="object"?"object":"unknown"},n=function(a,o){var l=document.createElement(a);for(var c in o.className&&(l.className=o.className),o.innerHTML&&o.dompurify&&(l.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)l.style[c]=o.style[c];return l},i=function a(o){var l=Object.assign(a.convert(Promise.resolve()),JSON.parse(JSON.stringify(a.template))),c=a.convert(Promise.resolve(),l);return c=(c=c.setProgress(1,a,1,[a])).set(o)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(a,o){return a.__proto__=o||i.prototype,a},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(a,o){return this.then(function(){switch(o=o||function(l){switch(s(l)){case"string":return"string";case"element":return l.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(a)){case"string":return this.then(t).then(function(l){return this.set({src:n("div",{innerHTML:a,dompurify:l})})});case"element":return this.set({src:a});case"canvas":return this.set({canvas:a});case"img":return this.set({img:a});default:return this.error("Unknown source type.")}})},i.prototype.to=function(a){switch(a){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var a={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=function l(c,h){for(var d=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),p=c.firstChild;p;p=p.nextSibling)h!==!0&&p.nodeType===1&&p.nodeName==="SCRIPT"||d.appendChild(l(p,h));return c.nodeType===1&&(c.nodeName==="CANVAS"?(d.width=c.width,d.height=c.height,d.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(d.value=c.value),d.addEventListener("load",function(){d.scrollTop=c.scrollTop,d.scrollLeft=c.scrollLeft},!0)),d}(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(a.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=n("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=n("div",{className:"html2pdf__container",style:a}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(n("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(e).then(function(o){var l=Object.assign({},this.opt.html2canvas);return delete l.onrendered,o(this.prop.container,l)}).then(function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(e).then(function(o){var l=this.opt.jsPDF,c=this.opt.fontFaces,h=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,d=Object.assign({async:!0,allowTaint:!0,scale:h,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete d.onrendered,l.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,l.context2d.posX=this.opt.x,l.context2d.posY=this.opt.y,l.context2d.margin=this.opt.margin,l.context2d.fontFaces=c,c)for(var p=0;p<c.length;++p){var f=c[p],y=f.src.find(function(w){return w.format==="truetype"});y&&l.addFont(y.url,f.ref.name,f.ref.style)}return d.windowHeight=d.windowHeight||0,d.windowHeight=d.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):d.windowHeight,l.context2d.save(!0),o(this.prop.container,d)}).then(function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var a=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=a})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(a,o,l){return(l=l||"pdf").toLowerCase()==="img"||l.toLowerCase()==="image"?this.outputImg(a,o):this.outputPdf(a,o)},i.prototype.outputPdf=function(a,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(a,o)})},i.prototype.outputImg=function(a){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(a){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+a+'" is not supported.'}})},i.prototype.save=function(a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(a?{filename:a}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(a){if(s(a)!=="object")return this;var o=Object.keys(a||{}).map(function(l){if(l in i.template.prop)return function(){this.prop[l]=a[l]};switch(l){case"margin":return this.setMargin.bind(this,a.margin);case"jsPDF":return function(){return this.opt.jsPDF=a.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,a.pageSize);default:return function(){this.opt[l]=a[l]}}},this);return this.then(function(){return this.thenList(o)})},i.prototype.get=function(a,o){return this.then(function(){var l=a in i.template.prop?this.prop[a]:this.opt[a];return o?o(l):l})},i.prototype.setMargin=function(a){return this.then(function(){switch(s(a)){case"number":a=[a,a,a,a];case"array":if(a.length===2&&(a=[a[0],a[1],a[0],a[1]]),a.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=a}).then(this.setPageSize)},i.prototype.setPageSize=function(a){function o(l,c){return Math.floor(l*c/72*96)}return this.then(function(){(a=a||Je.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(a.inner={width:a.width-this.opt.margin[1]-this.opt.margin[3],height:a.height-this.opt.margin[0]-this.opt.margin[2]},a.inner.px={width:o(a.inner.width,a.k),height:o(a.inner.height,a.k)},a.inner.ratio=a.inner.height/a.inner.width),this.prop.pageSize=a})},i.prototype.setProgress=function(a,o,l,c){return a!=null&&(this.progress.val=a),o!=null&&(this.progress.state=o),l!=null&&(this.progress.n=l),c!=null&&(this.progress.stack=c),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(a,o,l,c){return this.setProgress(a?this.progress.val+a:null,o||null,l?this.progress.n+l:null,c?this.progress.stack.concat(c):null)},i.prototype.then=function(a,o){var l=this;return this.thenCore(a,o,function(c,h){return l.updateProgress(null,null,1,[c]),Promise.prototype.then.call(this,function(d){return l.updateProgress(null,c),d}).then(c,h).then(function(d){return l.updateProgress(1),d})})},i.prototype.thenCore=function(a,o,l){l=l||Promise.prototype.then,a&&(a=a.bind(this)),o&&(o=o.bind(this));var c=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:i.convert(Object.assign({},this),Promise.prototype),h=l.call(c,a,o);return i.convert(h,this.__proto__)},i.prototype.thenExternal=function(a,o){return Promise.prototype.then.call(this,a,o)},i.prototype.thenList=function(a){var o=this;return a.forEach(function(l){o=o.thenCore(l)}),o},i.prototype.catch=function(a){a&&(a=a.bind(this));var o=Promise.prototype.catch.call(this,a);return i.convert(o,this)},i.prototype.catchExternal=function(a){return Promise.prototype.catch.call(this,a)},i.prototype.error=function(a){return this.then(function(){throw new Error(a)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,Je.getPageSize=function(a,o,l){if(Bt(a)==="object"){var c=a;a=c.orientation,o=c.unit||o,l=c.format||l}o=o||"mm",l=l||"a4",a=(""+(a||"P")).toLowerCase();var h,d=(""+l).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":h=1;break;case"mm":h=72/25.4;break;case"cm":h=72/2.54;break;case"in":h=72;break;case"px":h=.75;break;case"pc":case"em":h=12;break;case"ex":h=6;break;default:throw"Invalid unit: "+o}var f,y=0,w=0;if(p.hasOwnProperty(d))y=p[d][1]/h,w=p[d][0]/h;else try{y=l[1],w=l[0]}catch{throw new Error("Invalid format: "+l)}if(a==="p"||a==="portrait")a="p",w>y&&(f=w,w=y,y=f);else{if(a!=="l"&&a!=="landscape")throw"Invalid orientation: "+a;a="l",y>w&&(f=w,w=y,y=f)}return{width:w,height:y,unit:o,k:h,orientation:a}},r.html=function(a,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(lp):null;var l=new i(o);return o.worker?l:l.from(a).doCallback()}}(Je.API),Je.API.addJS=function(r){return o0=r,this.internal.events.subscribe("postPutResources",function(){Jh=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Jh+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),a0=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+o0+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Jh!==void 0&&a0!==void 0&&this.internal.out("/Names <</JavaScript "+Jh+" 0 R>>")}),this},function(r){var e;r.events.push(["postPutResources",function(){var t=this,s=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var n=t.outline.render().split(/\r\n/),i=0;i<n.length;i++){var a=n[i],o=s.exec(a);if(o!=null){var l=o[1];t.internal.newObjectDeferredBegin(l,!1)}t.internal.write(a)}if(this.outline.createNamedDestinations){var c=this.internal.pages.length,h=[];for(i=0;i<c;i++){var d=t.internal.newObject();h.push(d);var p=t.internal.getPageInfo(i+1);t.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var f=t.internal.newObject();for(t.internal.write("<< /Names [ "),i=0;i<h.length;i++)t.internal.write("(page_"+(i+1)+")"+h[i]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+f+" 0 R"),t.internal.write(">>","endobj")}}]),r.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),r.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(s,n,i){var a={title:n,options:i,children:[]};return s==null&&(s=this.root),s.children.push(a),a},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(s){s.id=t.internal.newObjectDeferred();for(var n=0;n<s.children.length;n++)this.genIds_r(s.children[n])},t.outline.renderRoot=function(s){this.objStart(s),this.line("/Type /Outlines"),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1]))),this.line("/Count "+this.count_r({count:0},s)),this.objEnd()},t.outline.renderItems=function(s){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<s.children.length;i++){var a=s.children[i];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(s)),i>0&&this.line("/Prev "+this.makeRef(s.children[i-1])),i<s.children.length-1&&this.line("/Next "+this.makeRef(s.children[i+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var o=this.count=this.count_r({count:0},a);if(o>0&&this.line("/Count "+o),a.options&&a.options.pageNumber){var l=t.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var c=0;c<s.children.length;c++)this.renderItems(s.children[c])},t.outline.line=function(s){this.ctx.val+=s+`\r
`},t.outline.makeRef=function(s){return s.id+" 0 R"},t.outline.makeString=function(s){return"("+t.internal.pdfEscape(s)+")"},t.outline.objStart=function(s){this.ctx.val+=`\r
`+s.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(s,n){for(var i=0;i<n.children.length;i++)s.count++,this.count_r(s,n.children[i]);return s.count}}])}(Je.API),function(r){var e=[192,193,194,195,196,197,198,199];r.processJPEG=function(t,s,n,i,a,o){var l,c=this.decode.DCT_DECODE,h=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=a||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,(l=function(d){for(var p,f=256*d.charCodeAt(4)+d.charCodeAt(5),y=d.length,w={width:0,height:0,numcomponents:1},A=4;A<y;A+=2){if(A+=f,e.indexOf(d.charCodeAt(A+1))!==-1){p=256*d.charCodeAt(A+5)+d.charCodeAt(A+6),w={width:256*d.charCodeAt(A+7)+d.charCodeAt(A+8),height:p,numcomponents:d.charCodeAt(A+9)};break}f=256*d.charCodeAt(A+2)+d.charCodeAt(A+3)}return w}(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}h={data:t,width:l.width,height:l.height,colorSpace:o,bitsPerComponent:8,filter:c,index:s,alias:n}}return h}}(Je.API);var xo,Zh,l0,c0,h0,p4=function(){var r,e,t;function s(i){var a,o,l,c,h,d,p,f,y,w,A,x,S,I;for(this.data=i,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},d=null;;){switch(a=this.readUInt32(),y=function(){var M,B;for(B=[],M=0;M<4;++M)B.push(String.fromCharCode(this.data[this.pos++]));return B}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(a);break;case"fcTL":d&&this.animation.frames.push(d),this.pos+=4,d={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},h=this.readUInt16(),c=this.readUInt16()||100,d.delay=1e3*h/c,d.disposeOp=this.data[this.pos++],d.blendOp=this.data[this.pos++],d.data=[];break;case"IDAT":case"fdAT":for(y==="fdAT"&&(this.pos+=4,a-=4),i=d?.data||this.imgData,x=0;0<=a?x<a:x>a;0<=a?++x:--x)i.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(l=this.palette.length/3,this.transparency.indexed=this.read(a),this.transparency.indexed.length>l)throw new Error("More transparent colors than palette size");if((w=l-this.transparency.indexed.length)>0)for(S=0;0<=w?S<w:S>w;0<=w?++S:--S)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(a)[0];break;case 2:this.transparency.rgb=this.read(a)}break;case"tEXt":p=(A=this.read(a)).indexOf(0),f=String.fromCharCode.apply(String,A.slice(0,p)),this.text[f]=String.fromCharCode.apply(String,A.slice(p+1));break;case"IEND":return d&&this.animation.frames.push(d),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=(I=this.colorType)===4||I===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=a}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}s.prototype.read=function(i){var a,o;for(o=[],a=0;0<=i?a<i:a>i;0<=i?++a:--a)o.push(this.data[this.pos++]);return o},s.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},s.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},s.prototype.decodePixels=function(i){var a=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*a),l=0,c=this;if(i==null&&(i=this.imgData),i.length===0)return new Uint8Array(0);function h(d,p,f,y){var w,A,x,S,I,M,B,Q,U,O,G,ne,L,j,V,q,le,ae,te,K,fe,me=Math.ceil((c.width-d)/f),Ae=Math.ceil((c.height-p)/y),k=c.width==me&&c.height==Ae;for(j=a*me,ne=k?o:new Uint8Array(j*Ae),M=i.length,L=0,A=0;L<Ae&&l<M;){switch(i[l++]){case 0:for(S=le=0;le<j;S=le+=1)ne[A++]=i[l++];break;case 1:for(S=ae=0;ae<j;S=ae+=1)w=i[l++],I=S<a?0:ne[A-a],ne[A++]=(w+I)%256;break;case 2:for(S=te=0;te<j;S=te+=1)w=i[l++],x=(S-S%a)/a,V=L&&ne[(L-1)*j+x*a+S%a],ne[A++]=(V+w)%256;break;case 3:for(S=K=0;K<j;S=K+=1)w=i[l++],x=(S-S%a)/a,I=S<a?0:ne[A-a],V=L&&ne[(L-1)*j+x*a+S%a],ne[A++]=(w+Math.floor((I+V)/2))%256;break;case 4:for(S=fe=0;fe<j;S=fe+=1)w=i[l++],x=(S-S%a)/a,I=S<a?0:ne[A-a],L===0?V=q=0:(V=ne[(L-1)*j+x*a+S%a],q=x&&ne[(L-1)*j+(x-1)*a+S%a]),B=I+V-q,Q=Math.abs(B-I),O=Math.abs(B-V),G=Math.abs(B-q),U=Q<=O&&Q<=G?I:O<=G?V:q,ne[A++]=(w+U)%256;break;default:throw new Error("Invalid filter algorithm: "+i[l-1])}if(!k){var D=((p+L*y)*c.width+d)*a,z=L*j;for(S=0;S<me;S+=1){for(var X=0;X<a;X+=1)o[D++]=ne[z++];D+=(f-1)*a}}L++}}return i=V3(i),c.interlaceMethod==1?(h(0,0,8,8),h(4,0,8,8),h(0,4,4,8),h(2,0,4,4),h(0,2,2,4),h(1,0,2,2),h(0,1,1,2)):h(0,0,1,1),o},s.prototype.decodePalette=function(){var i,a,o,l,c,h,d,p,f;for(o=this.palette,h=this.transparency.indexed||[],c=new Uint8Array((h.length||0)+o.length),l=0,i=0,a=d=0,p=o.length;d<p;a=d+=3)c[l++]=o[a],c[l++]=o[a+1],c[l++]=o[a+2],c[l++]=(f=h[i++])!=null?f:255;return c},s.prototype.copyToImageData=function(i,a){var o,l,c,h,d,p,f,y,w,A,x;if(l=this.colors,w=null,o=this.hasAlphaChannel,this.palette.length&&(w=(x=this._decodedPalette)!=null?x:this._decodedPalette=this.decodePalette(),l=4,o=!0),y=(c=i.data||i).length,d=w||a,h=p=0,l===1)for(;h<y;)f=w?4*a[h/4]:p,A=d[f++],c[h++]=A,c[h++]=A,c[h++]=A,c[h++]=o?d[f++]:255,p=f;else for(;h<y;)f=w?4*a[h/4]:p,c[h++]=d[f++],c[h++]=d[f++],c[h++]=d[f++],c[h++]=o?d[f++]:255,p=f},s.prototype.decode=function(){var i;return i=new Uint8Array(this.width*this.height*4),this.copyToImageData(i,this.decodePixels()),i};var n=function(){if(Object.prototype.toString.call(Ze)==="[object Window]"){try{e=Ze.document.createElement("canvas"),t=e.getContext("2d")}catch{return!1}return!0}return!1};return n(),r=function(i){var a;if(n()===!0)return t.width=i.width,t.height=i.height,t.clearRect(0,0,i.width,i.height),t.putImageData(i,0,0),(a=new Image).src=e.toDataURL(),a;throw new Error("This method requires a Browser with Canvas-capability.")},s.prototype.decodeFrames=function(i){var a,o,l,c,h,d,p,f;if(this.animation){for(f=[],o=h=0,d=(p=this.animation.frames).length;h<d;o=++h)a=p[o],l=i.createImageData(a.width,a.height),c=this.decodePixels(new Uint8Array(a.data)),this.copyToImageData(l,c),a.imageData=l,f.push(a.image=r(l));return f}},s.prototype.renderFrame=function(i,a){var o,l,c;return o=(l=this.animation.frames)[a],c=l[a-1],a===0&&i.clearRect(0,0,this.width,this.height),c?.disposeOp===1?i.clearRect(c.xOffset,c.yOffset,c.width,c.height):c?.disposeOp===2&&i.putImageData(c.imageData,c.xOffset,c.yOffset),o.blendOp===0&&i.clearRect(o.xOffset,o.yOffset,o.width,o.height),i.drawImage(o.image,o.xOffset,o.yOffset)},s.prototype.animate=function(i){var a,o,l,c,h,d,p=this;return o=0,d=this.animation,c=d.numFrames,l=d.frames,h=d.numPlays,(a=function(){var f,y;if(f=o++%c,y=l[f],p.renderFrame(i,f),c>1&&o/c<h)return p.animation._timeout=setTimeout(a,y.delay)})()},s.prototype.stopAnimation=function(){var i;return clearTimeout((i=this.animation)!=null?i._timeout:void 0)},s.prototype.render=function(i){var a,o;return i._png&&i._png.stopAnimation(),i._png=this,i.width=this.width,i.height=this.height,a=i.getContext("2d"),this.animation?(this.decodeFrames(a),this.animate(a)):(o=a.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),a.putImageData(o,0,0))},s}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function m4(r){var e=0;if(r[e++]!==71||r[e++]!==73||r[e++]!==70||r[e++]!==56||(r[e++]+1&253)!=56||r[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=r[e++]|r[e++]<<8,s=r[e++]|r[e++]<<8,n=r[e++],i=n>>7,a=1<<(7&n)+1;r[e++],r[e++];var o=null,l=null;i&&(o=e,l=a,e+=3*a);var c=!0,h=[],d=0,p=null,f=0,y=null;for(this.width=t,this.height=s;c&&e<r.length;)switch(r[e++]){case 33:switch(r[e++]){case 255:if(r[e]!==11||r[e+1]==78&&r[e+2]==69&&r[e+3]==84&&r[e+4]==83&&r[e+5]==67&&r[e+6]==65&&r[e+7]==80&&r[e+8]==69&&r[e+9]==50&&r[e+10]==46&&r[e+11]==48&&r[e+12]==3&&r[e+13]==1&&r[e+16]==0)e+=14,y=r[e++]|r[e++]<<8,e++;else for(e+=12;;){if(!((L=r[e++])>=0))throw Error("Invalid block size");if(L===0)break;e+=L}break;case 249:if(r[e++]!==4||r[e+4]!==0)throw new Error("Invalid graphics extension block.");var w=r[e++];d=r[e++]|r[e++]<<8,p=r[e++],!(1&w)&&(p=null),f=w>>2&7,e++;break;case 254:for(;;){if(!((L=r[e++])>=0))throw Error("Invalid block size");if(L===0)break;e+=L}break;default:throw new Error("Unknown graphic control label: 0x"+r[e-1].toString(16))}break;case 44:var A=r[e++]|r[e++]<<8,x=r[e++]|r[e++]<<8,S=r[e++]|r[e++]<<8,I=r[e++]|r[e++]<<8,M=r[e++],B=M>>6&1,Q=1<<(7&M)+1,U=o,O=l,G=!1;M>>7&&(G=!0,U=e,O=Q,e+=3*Q);var ne=e;for(e++;;){var L;if(!((L=r[e++])>=0))throw Error("Invalid block size");if(L===0)break;e+=L}h.push({x:A,y:x,width:S,height:I,has_local_palette:G,palette_offset:U,palette_size:O,data_offset:ne,data_length:e-ne,transparent_index:p,interlaced:!!B,delay:d,disposal:f});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+r[e-1].toString(16))}this.numFrames=function(){return h.length},this.loopCount=function(){return y},this.frameInfo=function(j){if(j<0||j>=h.length)throw new Error("Frame index out of range.");return h[j]},this.decodeAndBlitFrameBGRA=function(j,V){var q=this.frameInfo(j),le=q.width*q.height,ae=new Uint8Array(le);u0(r,q.data_offset,ae,le);var te=q.palette_offset,K=q.transparent_index;K===null&&(K=256);var fe=q.width,me=t-fe,Ae=fe,k=4*(q.y*t+q.x),D=4*((q.y+q.height)*t+q.x),z=k,X=4*me;q.interlaced===!0&&(X+=4*t*7);for(var ee=8,ie=0,ue=ae.length;ie<ue;++ie){var de=ae[ie];if(Ae===0&&(Ae=fe,(z+=X)>=D&&(X=4*me+4*t*(ee-1),z=k+(fe+me)*(ee<<1),ee>>=1)),de===K)z+=4;else{var ke=r[te+3*de],Ee=r[te+3*de+1],Re=r[te+3*de+2];V[z++]=Re,V[z++]=Ee,V[z++]=ke,V[z++]=255}--Ae}},this.decodeAndBlitFrameRGBA=function(j,V){var q=this.frameInfo(j),le=q.width*q.height,ae=new Uint8Array(le);u0(r,q.data_offset,ae,le);var te=q.palette_offset,K=q.transparent_index;K===null&&(K=256);var fe=q.width,me=t-fe,Ae=fe,k=4*(q.y*t+q.x),D=4*((q.y+q.height)*t+q.x),z=k,X=4*me;q.interlaced===!0&&(X+=4*t*7);for(var ee=8,ie=0,ue=ae.length;ie<ue;++ie){var de=ae[ie];if(Ae===0&&(Ae=fe,(z+=X)>=D&&(X=4*me+4*t*(ee-1),z=k+(fe+me)*(ee<<1),ee>>=1)),de===K)z+=4;else{var ke=r[te+3*de],Ee=r[te+3*de+1],Re=r[te+3*de+2];V[z++]=ke,V[z++]=Ee,V[z++]=Re,V[z++]=255}--Ae}}}function u0(r,e,t,s){for(var n=r[e++],i=1<<n,a=i+1,o=a+1,l=n+1,c=(1<<l)-1,h=0,d=0,p=0,f=r[e++],y=new Int32Array(4096),w=null;;){for(;h<16&&f!==0;)d|=r[e++]<<h,h+=8,f===1?f=r[e++]:--f;if(h<l)break;var A=d&c;if(d>>=l,h-=l,A!==i){if(A===a)break;for(var x=A<o?A:w,S=0,I=x;I>i;)I=y[I]>>8,++S;var M=I;if(p+S+(x!==A?1:0)>s)return void Gt.log("Warning, gif stream longer than expected.");t[p++]=M;var B=p+=S;for(x!==A&&(t[p++]=M),I=x;S--;)I=y[I],t[--B]=255&I,I>>=8;w!==null&&o<4096&&(y[o++]=w<<8|M,o>=c+1&&l<12&&(++l,c=c<<1|1)),w=A}else o=a+1,c=(1<<(l=n+1))-1,w=null}return p!==s&&Gt.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Af(r){var e,t,s,n,i,a=Math.floor,o=new Array(64),l=new Array(64),c=new Array(64),h=new Array(64),d=new Array(65535),p=new Array(65535),f=new Array(64),y=new Array(64),w=[],A=0,x=7,S=new Array(64),I=new Array(64),M=new Array(64),B=new Array(256),Q=new Array(2048),U=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],O=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],G=[0,1,2,3,4,5,6,7,8,9,10,11],ne=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],L=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],j=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],V=[0,1,2,3,4,5,6,7,8,9,10,11],q=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],le=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ae(k,D){for(var z=0,X=0,ee=new Array,ie=1;ie<=16;ie++){for(var ue=1;ue<=k[ie];ue++)ee[D[X]]=[],ee[D[X]][0]=z,ee[D[X]][1]=ie,X++,z++;z*=2}return ee}function te(k){for(var D=k[0],z=k[1]-1;z>=0;)D&1<<z&&(A|=1<<x),z--,--x<0&&(A==255?(K(255),K(0)):K(A),x=7,A=0)}function K(k){w.push(k)}function fe(k){K(k>>8&255),K(255&k)}function me(k,D,z,X,ee){for(var ie,ue=ee[0],de=ee[240],ke=function(Ne,Ce){var Oe,Ie,Ve,rt,ft,yt,Pt,qt,tt,wt,Me=0;for(tt=0;tt<8;++tt){Oe=Ne[Me],Ie=Ne[Me+1],Ve=Ne[Me+2],rt=Ne[Me+3],ft=Ne[Me+4],yt=Ne[Me+5],Pt=Ne[Me+6];var Vs=Oe+(qt=Ne[Me+7]),Tt=Oe-qt,Zn=Ie+Pt,Wt=Ie-Pt,es=Ve+yt,kr=Ve-yt,jt=rt+ft,ta=rt-ft,as=Vs+jt,Qn=Vs-jt,Zr=Zn+es,os=Zn-es;Ne[Me]=as+Zr,Ne[Me+4]=as-Zr;var it=.707106781*(os+Qn);Ne[Me+2]=Qn+it,Ne[Me+6]=Qn-it;var Rt=.382683433*((as=ta+kr)-(os=Wt+Tt)),sa=.5411961*as+Rt,qs=1.306562965*os+Rt,Cr=.707106781*(Zr=kr+Wt),Pr=Tt+Cr,Ye=Tt-Cr;Ne[Me+5]=Ye+sa,Ne[Me+3]=Ye-sa,Ne[Me+1]=Pr+qs,Ne[Me+7]=Pr-qs,Me+=8}for(Me=0,tt=0;tt<8;++tt){Oe=Ne[Me],Ie=Ne[Me+8],Ve=Ne[Me+16],rt=Ne[Me+24],ft=Ne[Me+32],yt=Ne[Me+40],Pt=Ne[Me+48];var er=Oe+(qt=Ne[Me+56]),Lr=Oe-qt,fn=Ie+Pt,ks=Ie-Pt,ys=Ve+yt,En=Ve-yt,$a=rt+ft,Qr=rt-ft,tr=er+$a,sr=er-$a,nr=fn+ys,Tr=fn-ys;Ne[Me]=tr+nr,Ne[Me+32]=tr-nr;var Bn=.707106781*(Tr+sr);Ne[Me+16]=sr+Bn,Ne[Me+48]=sr-Bn;var Ir=.382683433*((tr=Qr+En)-(Tr=ks+Lr)),na=.5411961*tr+Ir,qa=1.306562965*Tr+Ir,Ua=.707106781*(nr=En+ks),za=Lr+Ua,Ha=Lr-Ua;Ne[Me+40]=Ha+na,Ne[Me+24]=Ha-na,Ne[Me+8]=za+qa,Ne[Me+56]=za-qa,Me++}for(tt=0;tt<64;++tt)wt=Ne[tt]*Ce[tt],f[tt]=wt>0?wt+.5|0:wt-.5|0;return f}(k,D),Ee=0;Ee<64;++Ee)y[U[Ee]]=ke[Ee];var Re=y[0]-z;z=y[0],Re==0?te(X[0]):(te(X[p[ie=32767+Re]]),te(d[ie]));for(var Le=63;Le>0&&y[Le]==0;)Le--;if(Le==0)return te(ue),z;for(var Ke,be=1;be<=Le;){for(var H=be;y[be]==0&&be<=Le;)++be;var ct=be-H;if(ct>=16){Ke=ct>>4;for(var Ue=1;Ue<=Ke;++Ue)te(de);ct&=15}ie=32767+y[be],te(ee[(ct<<4)+p[ie]]),te(d[ie]),be++}return Le!=63&&te(ue),z}function Ae(k){k=Math.min(Math.max(k,1),100),i!=k&&(function(D){for(var z=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],X=0;X<64;X++){var ee=a((z[X]*D+50)/100);ee=Math.min(Math.max(ee,1),255),o[U[X]]=ee}for(var ie=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ue=0;ue<64;ue++){var de=a((ie[ue]*D+50)/100);de=Math.min(Math.max(de,1),255),l[U[ue]]=de}for(var ke=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ee=0,Re=0;Re<8;Re++)for(var Le=0;Le<8;Le++)c[Ee]=1/(o[U[Ee]]*ke[Re]*ke[Le]*8),h[Ee]=1/(l[U[Ee]]*ke[Re]*ke[Le]*8),Ee++}(k<50?Math.floor(5e3/k):Math.floor(200-2*k)),i=k)}this.encode=function(k,D){D&&Ae(D),w=new Array,A=0,x=7,fe(65496),fe(65504),fe(16),K(74),K(70),K(73),K(70),K(0),K(1),K(1),K(0),fe(1),fe(1),K(0),K(0),function(){fe(65499),fe(132),K(0);for(var Ie=0;Ie<64;Ie++)K(o[Ie]);K(1);for(var Ve=0;Ve<64;Ve++)K(l[Ve])}(),function(Ie,Ve){fe(65472),fe(17),K(8),fe(Ve),fe(Ie),K(3),K(1),K(17),K(0),K(2),K(17),K(1),K(3),K(17),K(1)}(k.width,k.height),function(){fe(65476),fe(418),K(0);for(var Ie=0;Ie<16;Ie++)K(O[Ie+1]);for(var Ve=0;Ve<=11;Ve++)K(G[Ve]);K(16);for(var rt=0;rt<16;rt++)K(ne[rt+1]);for(var ft=0;ft<=161;ft++)K(L[ft]);K(1);for(var yt=0;yt<16;yt++)K(j[yt+1]);for(var Pt=0;Pt<=11;Pt++)K(V[Pt]);K(17);for(var qt=0;qt<16;qt++)K(q[qt+1]);for(var tt=0;tt<=161;tt++)K(le[tt])}(),fe(65498),fe(12),K(3),K(1),K(0),K(2),K(17),K(3),K(17),K(0),K(63),K(0);var z=0,X=0,ee=0;A=0,x=7,this.encode.displayName="_encode_";for(var ie,ue,de,ke,Ee,Re,Le,Ke,be,H=k.data,ct=k.width,Ue=k.height,Ne=4*ct,Ce=0;Ce<Ue;){for(ie=0;ie<Ne;){for(Ee=Ne*Ce+ie,Le=-1,Ke=0,be=0;be<64;be++)Re=Ee+(Ke=be>>3)*Ne+(Le=4*(7&be)),Ce+Ke>=Ue&&(Re-=Ne*(Ce+1+Ke-Ue)),ie+Le>=Ne&&(Re-=ie+Le-Ne+4),ue=H[Re++],de=H[Re++],ke=H[Re++],S[be]=(Q[ue]+Q[de+256>>0]+Q[ke+512>>0]>>16)-128,I[be]=(Q[ue+768>>0]+Q[de+1024>>0]+Q[ke+1280>>0]>>16)-128,M[be]=(Q[ue+1280>>0]+Q[de+1536>>0]+Q[ke+1792>>0]>>16)-128;z=me(S,c,z,e,s),X=me(I,h,X,t,n),ee=me(M,h,ee,t,n),ie+=32}Ce+=8}if(x>=0){var Oe=[];Oe[1]=x+1,Oe[0]=(1<<x+1)-1,te(Oe)}return fe(65497),new Uint8Array(w)},r=r||50,function(){for(var k=String.fromCharCode,D=0;D<256;D++)B[D]=k(D)}(),e=ae(O,G),t=ae(j,V),s=ae(ne,L),n=ae(q,le),function(){for(var k=1,D=2,z=1;z<=15;z++){for(var X=k;X<D;X++)p[32767+X]=z,d[32767+X]=[],d[32767+X][1]=z,d[32767+X][0]=X;for(var ee=-(D-1);ee<=-k;ee++)p[32767+ee]=z,d[32767+ee]=[],d[32767+ee][1]=z,d[32767+ee][0]=D-1+ee;k<<=1,D<<=1}}(),function(){for(var k=0;k<256;k++)Q[k]=19595*k,Q[k+256>>0]=38470*k,Q[k+512>>0]=7471*k+32768,Q[k+768>>0]=-11059*k,Q[k+1024>>0]=-21709*k,Q[k+1280>>0]=32768*k+8421375,Q[k+1536>>0]=-27439*k,Q[k+1792>>0]=-5329*k}(),Ae(r)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function hr(r,e){if(this.pos=0,this.buffer=r,this.datav=new DataView(r.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function d0(r){function e(O){if(!O)throw Error("assert :P")}function t(O,G,ne){for(var L=0;4>L;L++)if(O[G+L]!=ne.charCodeAt(L))return!0;return!1}function s(O,G,ne,L,j){for(var V=0;V<j;V++)O[G+V]=ne[L+V]}function n(O,G,ne,L){for(var j=0;j<L;j++)O[G+j]=ne}function i(O){return new Int32Array(O)}function a(O,G){for(var ne=[],L=0;L<O;L++)ne.push(new G);return ne}function o(O,G){var ne=[];return function L(j,V,q){for(var le=q[V],ae=0;ae<le&&(j.push(q.length>V+1?[]:new G),!(q.length<V+1));ae++)L(j[ae],V+1,q)}(ne,0,O),ne}var l=function(){var O=this;function G(u,m){for(var v=1<<m-1>>>0;u&v;)v>>>=1;return v?(u&v-1)+v:u}function ne(u,m,v,_,N){e(!(_%v));do u[m+(_-=v)]=N;while(0<_)}function L(u,m,v,_,N){if(e(2328>=N),512>=N)var C=i(512);else if((C=i(N))==null)return 0;return function(P,T,R,F,J,ce){var he,re,we=T,pe=1<<R,Z=i(16),se=i(16);for(e(J!=0),e(F!=null),e(P!=null),e(0<R),re=0;re<J;++re){if(15<F[re])return 0;++Z[F[re]]}if(Z[0]==J)return 0;for(se[1]=0,he=1;15>he;++he){if(Z[he]>1<<he)return 0;se[he+1]=se[he]+Z[he]}for(re=0;re<J;++re)he=F[re],0<F[re]&&(ce[se[he]++]=re);if(se[15]==1)return(F=new j).g=0,F.value=ce[0],ne(P,we,1,pe,F),pe;var ve,xe=-1,ye=pe-1,De=0,Pe=1,Xe=1,Te=1<<R;for(re=0,he=1,J=2;he<=R;++he,J<<=1){if(Pe+=Xe<<=1,0>(Xe-=Z[he]))return 0;for(;0<Z[he];--Z[he])(F=new j).g=he,F.value=ce[re++],ne(P,we+De,J,Te,F),De=G(De,he)}for(he=R+1,J=2;15>=he;++he,J<<=1){if(Pe+=Xe<<=1,0>(Xe-=Z[he]))return 0;for(;0<Z[he];--Z[he]){if(F=new j,(De&ye)!=xe){for(we+=Te,ve=1<<(xe=he)-R;15>xe&&!(0>=(ve-=Z[xe]));)++xe,ve<<=1;pe+=Te=1<<(ve=xe-R),P[T+(xe=De&ye)].g=ve+R,P[T+xe].value=we-T-xe}F.g=he-R,F.value=ce[re++],ne(P,we+(De>>R),J,Te,F),De=G(De,he)}}return Pe!=2*se[15]-1?0:pe}(u,m,v,_,N,C)}function j(){this.value=this.g=0}function V(){this.value=this.g=0}function q(){this.G=a(5,j),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=a(Us,V)}function le(u,m,v,_){e(u!=null),e(m!=null),e(2147483648>_),u.Ca=254,u.I=0,u.b=-8,u.Ka=0,u.oa=m,u.pa=v,u.Jd=m,u.Yc=v+_,u.Zc=4<=_?v+_-4+1:v,ie(u)}function ae(u,m){for(var v=0;0<m--;)v|=de(u,128)<<m;return v}function te(u,m){var v=ae(u,m);return ue(u)?-v:v}function K(u,m,v,_){var N,C=0;for(e(u!=null),e(m!=null),e(4294967288>_),u.Sb=_,u.Ra=0,u.u=0,u.h=0,4<_&&(_=4),N=0;N<_;++N)C+=m[v+N]<<8*N;u.Ra=C,u.bb=_,u.oa=m,u.pa=v}function fe(u){for(;8<=u.u&&u.bb<u.Sb;)u.Ra>>>=8,u.Ra+=u.oa[u.pa+u.bb]<<io-8>>>0,++u.bb,u.u-=8;z(u)&&(u.h=1,u.u=0)}function me(u,m){if(e(0<=m),!u.h&&m<=ro){var v=D(u)&no[m];return u.u+=m,fe(u),v}return u.h=1,u.u=0}function Ae(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function k(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function D(u){return u.Ra>>>(u.u&io-1)>>>0}function z(u){return e(u.bb<=u.Sb),u.h||u.bb==u.Sb&&u.u>io}function X(u,m){u.u=m,u.h=z(u)}function ee(u){u.u>=_l&&(e(u.u>=_l),fe(u))}function ie(u){e(u!=null&&u.oa!=null),u.pa<u.Zc?(u.I=(u.oa[u.pa++]|u.I<<8)>>>0,u.b+=8):(e(u!=null&&u.oa!=null),u.pa<u.Yc?(u.b+=8,u.I=u.oa[u.pa++]|u.I<<8):u.Ka?u.b=0:(u.I<<=8,u.b+=8,u.Ka=1))}function ue(u){return ae(u,1)}function de(u,m){var v=u.Ca;0>u.b&&ie(u);var _=u.b,N=v*m>>>8,C=(u.I>>>_>N)+0;for(C?(v-=N,u.I-=N+1<<_>>>0):v=N+1,_=v,N=0;256<=_;)N+=8,_>>=8;return _=7^N+mn[_],u.b-=_,u.Ca=(v<<_)-1,C}function ke(u,m,v){u[m+0]=v>>24&255,u[m+1]=v>>16&255,u[m+2]=v>>8&255,u[m+3]=v>>0&255}function Ee(u,m){return u[m+0]<<0|u[m+1]<<8}function Re(u,m){return Ee(u,m)|u[m+2]<<16}function Le(u,m){return Ee(u,m)|Ee(u,m+2)<<16}function Ke(u,m){var v=1<<m;return e(u!=null),e(0<m),u.X=i(v),u.X==null?0:(u.Mb=32-m,u.Xa=m,1)}function be(u,m){e(u!=null),e(m!=null),e(u.Xa==m.Xa),s(m.X,0,u.X,0,1<<m.Xa)}function H(){this.X=[],this.Xa=this.Mb=0}function ct(u,m,v,_){e(v!=null),e(_!=null);var N=v[0],C=_[0];return N==0&&(N=(u*C+m/2)/m),C==0&&(C=(m*N+u/2)/u),0>=N||0>=C?0:(v[0]=N,_[0]=C,1)}function Ue(u,m){return u+(1<<m)-1>>>m}function Ne(u,m){return((4278255360&u)+(4278255360&m)>>>0&4278255360)+((16711935&u)+(16711935&m)>>>0&16711935)>>>0}function Ce(u,m){O[m]=function(v,_,N,C,P,T,R){var F;for(F=0;F<P;++F){var J=O[u](T[R+F-1],N,C+F);T[R+F]=Ne(v[_+F],J)}}}function Oe(){this.ud=this.hd=this.jd=0}function Ie(u,m){return((4278124286&(u^m))>>>1)+(u&m)>>>0}function Ve(u){return 0<=u&&256>u?u:0>u?0:255<u?255:void 0}function rt(u,m){return Ve(u+(u-m+.5>>1))}function ft(u,m,v){return Math.abs(m-v)-Math.abs(u-v)}function yt(u,m,v,_,N,C,P){for(_=C[P-1],v=0;v<N;++v)C[P+v]=_=Ne(u[m+v],_)}function Pt(u,m,v,_,N){var C;for(C=0;C<v;++C){var P=u[m+C],T=P>>8&255,R=16711935&(R=(R=16711935&P)+((T<<16)+T));_[N+C]=(4278255360&P)+R>>>0}}function qt(u,m){m.jd=u>>0&255,m.hd=u>>8&255,m.ud=u>>16&255}function tt(u,m,v,_,N,C){var P;for(P=0;P<_;++P){var T=m[v+P],R=T>>>8,F=T,J=255&(J=(J=T>>>16)+((u.jd<<24>>24)*(R<<24>>24)>>>5));F=255&(F=(F=F+((u.hd<<24>>24)*(R<<24>>24)>>>5))+((u.ud<<24>>24)*(J<<24>>24)>>>5)),N[C+P]=(4278255360&T)+(J<<16)+F}}function wt(u,m,v,_,N){O[m]=function(C,P,T,R,F,J,ce,he,re){for(R=ce;R<he;++R)for(ce=0;ce<re;++ce)F[J++]=N(T[_(C[P++])])},O[u]=function(C,P,T,R,F,J,ce){var he=8>>C.b,re=C.Ea,we=C.K[0],pe=C.w;if(8>he)for(C=(1<<C.b)-1,pe=(1<<he)-1;P<T;++P){var Z,se=0;for(Z=0;Z<re;++Z)Z&C||(se=_(R[F++])),J[ce++]=N(we[se&pe]),se>>=he}else O["VP8LMapColor"+v](R,F,we,pe,J,ce,P,T,re)}}function Me(u,m,v,_,N){for(v=m+v;m<v;){var C=u[m++];_[N++]=C>>16&255,_[N++]=C>>8&255,_[N++]=C>>0&255}}function Vs(u,m,v,_,N){for(v=m+v;m<v;){var C=u[m++];_[N++]=C>>16&255,_[N++]=C>>8&255,_[N++]=C>>0&255,_[N++]=C>>24&255}}function Tt(u,m,v,_,N){for(v=m+v;m<v;){var C=(P=u[m++])>>16&240|P>>12&15,P=P>>0&240|P>>28&15;_[N++]=C,_[N++]=P}}function Zn(u,m,v,_,N){for(v=m+v;m<v;){var C=(P=u[m++])>>16&248|P>>13&7,P=P>>5&224|P>>3&31;_[N++]=C,_[N++]=P}}function Wt(u,m,v,_,N){for(v=m+v;m<v;){var C=u[m++];_[N++]=C>>0&255,_[N++]=C>>8&255,_[N++]=C>>16&255}}function es(u,m,v,_,N,C){if(C==0)for(v=m+v;m<v;)ke(_,((C=u[m++])[0]>>24|C[1]>>8&65280|C[2]<<8&16711680|C[3]<<24)>>>0),N+=32;else s(_,N,u,m,v)}function kr(u,m){O[m][0]=O[u+"0"],O[m][1]=O[u+"1"],O[m][2]=O[u+"2"],O[m][3]=O[u+"3"],O[m][4]=O[u+"4"],O[m][5]=O[u+"5"],O[m][6]=O[u+"6"],O[m][7]=O[u+"7"],O[m][8]=O[u+"8"],O[m][9]=O[u+"9"],O[m][10]=O[u+"10"],O[m][11]=O[u+"11"],O[m][12]=O[u+"12"],O[m][13]=O[u+"13"],O[m][14]=O[u+"0"],O[m][15]=O[u+"0"]}function jt(u){return u==Bd||u==$d||u==Nh||u==qd}function ta(){this.eb=[],this.size=this.A=this.fb=0}function as(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Qn(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ta,this.f.kb=new as,this.sd=null}function Zr(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function os(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function it(u){return alert("todo:WebPSamplerProcessPlane"),u.T}function Rt(u,m){var v=u.T,_=m.ba.f.RGBA,N=_.eb,C=_.fb+u.ka*_.A,P=Wn[m.ba.S],T=u.y,R=u.O,F=u.f,J=u.N,ce=u.ea,he=u.W,re=m.cc,we=m.dc,pe=m.Mc,Z=m.Nc,se=u.ka,ve=u.ka+u.T,xe=u.U,ye=xe+1>>1;for(se==0?P(T,R,null,null,F,J,ce,he,F,J,ce,he,N,C,null,null,xe):(P(m.ec,m.fc,T,R,re,we,pe,Z,F,J,ce,he,N,C-_.A,N,C,xe),++v);se+2<ve;se+=2)re=F,we=J,pe=ce,Z=he,J+=u.Rc,he+=u.Rc,C+=2*_.A,P(T,(R+=2*u.fa)-u.fa,T,R,re,we,pe,Z,F,J,ce,he,N,C-_.A,N,C,xe);return R+=u.fa,u.j+ve<u.o?(s(m.ec,m.fc,T,R,xe),s(m.cc,m.dc,F,J,ye),s(m.Mc,m.Nc,ce,he,ye),v--):1&ve||P(T,R,null,null,F,J,ce,he,F,J,ce,he,N,C+_.A,null,null,xe),v}function sa(u,m,v){var _=u.F,N=[u.J];if(_!=null){var C=u.U,P=m.ba.S,T=P==Sh||P==Nh;m=m.ba.f.RGBA;var R=[0],F=u.ka;R[0]=u.T,u.Kb&&(F==0?--R[0]:(--F,N[0]-=u.width),u.j+u.ka+u.T==u.o&&(R[0]=u.o-u.j-F));var J=m.eb;F=m.fb+F*m.A,u=Jt(_,N[0],u.width,C,R,J,F+(T?0:3),m.A),e(v==R),u&&jt(P)&&zn(J,F,T,C,R,m.A)}return 0}function qs(u){var m=u.ma,v=m.ba.S,_=11>v,N=v==_h||v==Ah||v==Sh||v==Dd||v==12||jt(v);if(m.memory=null,m.Ib=null,m.Jb=null,m.Nd=null,!wl(m.Oa,u,N?11:12))return 0;if(N&&jt(v)&&_e(),u.da)alert("todo:use_scaling");else{if(_){if(m.Ib=it,u.Kb){if(v=u.U+1>>1,m.memory=i(u.U+2*v),m.memory==null)return 0;m.ec=m.memory,m.fc=0,m.cc=m.ec,m.dc=m.fc+u.U,m.Mc=m.cc,m.Nc=m.dc+v,m.Ib=Rt,_e()}}else alert("todo:EmitYUV");N&&(m.Jb=sa,_&&oe())}if(_&&!qm){for(u=0;256>u;++u)Mv[u]=89858*(u-128)+kh>>Eh,Bv[u]=-22014*(u-128)+kh,Dv[u]=-45773*(u-128),Fv[u]=113618*(u-128)+kh>>Eh;for(u=Pl;u<Hd;++u)m=76283*(u-16)+kh>>Eh,$v[u-Pl]=kn(m,255),qv[u-Pl]=kn(m+8>>4,15);qm=1}return 1}function Cr(u){var m=u.ma,v=u.U,_=u.T;return e(!(1&u.ka)),0>=v||0>=_?0:(v=m.Ib(u,m),m.Jb!=null&&m.Jb(u,m,v),m.Dc+=v,1)}function Pr(u){u.ma.memory=null}function Ye(u,m,v,_){return me(u,8)!=47?0:(m[0]=me(u,14)+1,v[0]=me(u,14)+1,_[0]=me(u,1),me(u,3)!=0?0:!u.h)}function er(u,m){if(4>u)return u+1;var v=u-2>>1;return(2+(1&u)<<v)+me(m,v)+1}function Lr(u,m){return 120<m?m-120:1<=(v=((v=_v[m-1])>>4)*u+(8-(15&v)))?v:1;var v}function fn(u,m,v){var _=D(v),N=u[m+=255&_].g-8;return 0<N&&(X(v,v.u+8),_=D(v),m+=u[m].value,m+=_&(1<<N)-1),X(v,v.u+u[m].g),u[m].value}function ks(u,m,v){return v.g+=u.g,v.value+=u.value<<m>>>0,e(8>=v.g),u.g}function ys(u,m,v){var _=u.xc;return e((m=_==0?0:u.vc[u.md*(v>>_)+(m>>_)])<u.Wb),u.Ya[m]}function En(u,m,v,_){var N=u.ab,C=u.c*m,P=u.C;m=P+m;var T=v,R=_;for(_=u.Ta,v=u.Ua;0<N--;){var F=u.gc[N],J=P,ce=m,he=T,re=R,we=(R=_,T=v,F.Ea);switch(e(J<ce),e(ce<=F.nc),F.hc){case 2:mh(he,re,(ce-J)*we,R,T);break;case 0:var pe=J,Z=ce,se=R,ve=T,xe=(Te=F).Ea;pe==0&&(Md(he,re,null,null,1,se,ve),yt(he,re+1,0,0,xe-1,se,ve+1),re+=xe,ve+=xe,++pe);for(var ye=1<<Te.b,De=ye-1,Pe=Ue(xe,Te.b),Xe=Te.K,Te=Te.w+(pe>>Te.b)*Pe;pe<Z;){var It=Xe,Ot=Te,Lt=1;for(Al(he,re,se,ve-xe,1,se,ve);Lt<xe;){var _t=(Lt&~De)+ye;_t>xe&&(_t=xe),(0,Si[It[Ot++]>>8&15])(he,re+ +Lt,se,ve+Lt-xe,_t-Lt,se,ve+Lt),Lt=_t}re+=xe,ve+=xe,++pe&De||(Te+=Pe)}ce!=F.nc&&s(R,T-we,R,T+(ce-J-1)*we,we);break;case 1:for(we=he,Z=re,xe=(he=F.Ea)-(ve=he&~(se=(re=1<<F.b)-1)),pe=Ue(he,F.b),ye=F.K,F=F.w+(J>>F.b)*pe;J<ce;){for(De=ye,Pe=F,Xe=new Oe,Te=Z+ve,It=Z+he;Z<Te;)qt(De[Pe++],Xe),la(Xe,we,Z,re,R,T),Z+=re,T+=re;Z<It&&(qt(De[Pe++],Xe),la(Xe,we,Z,xe,R,T),Z+=xe,T+=xe),++J&se||(F+=pe)}break;case 3:if(he==R&&re==T&&0<F.b){for(Z=R,he=we=T+(ce-J)*we-(ve=(ce-J)*Ue(F.Ea,F.b)),re=R,se=T,pe=[],ve=(xe=ve)-1;0<=ve;--ve)pe[ve]=re[se+ve];for(ve=xe-1;0<=ve;--ve)Z[he+ve]=pe[ve];$n(F,J,ce,R,we,R,T)}else $n(F,J,ce,he,re,R,T)}T=_,R=v}R!=v&&s(_,v,T,R,C)}function $a(u,m){var v=u.V,_=u.Ba+u.c*u.C,N=m-u.C;if(e(m<=u.l.o),e(16>=N),0<N){var C=u.l,P=u.Ta,T=u.Ua,R=C.width;if(En(u,N,v,_),N=T=[T],e((v=u.C)<(_=m)),e(C.v<C.va),_>C.o&&(_=C.o),v<C.j){var F=C.j-v;v=C.j,N[0]+=F*R}if(v>=_?v=0:(N[0]+=4*C.v,C.ka=v-C.j,C.U=C.va-C.v,C.T=_-v,v=1),v){if(T=T[0],11>(v=u.ca).S){var J=v.f.RGBA,ce=(_=v.S,N=C.U,C=C.T,F=J.eb,J.A),he=C;for(J=J.fb+u.Ma*J.A;0<he--;){var re=P,we=T,pe=N,Z=F,se=J;switch(_){case xh:gn(re,we,pe,Z,se);break;case _h:rn(re,we,pe,Z,se);break;case Bd:rn(re,we,pe,Z,se),zn(Z,se,0,pe,1,0);break;case Tm:ni(re,we,pe,Z,se);break;case Ah:es(re,we,pe,Z,se,1);break;case $d:es(re,we,pe,Z,se,1),zn(Z,se,0,pe,1,0);break;case Sh:es(re,we,pe,Z,se,0);break;case Nh:es(re,we,pe,Z,se,0),zn(Z,se,1,pe,1,0);break;case Dd:Ni(re,we,pe,Z,se);break;case qd:Ni(re,we,pe,Z,se),Kt(Z,se,pe,1,0);break;case Im:si(re,we,pe,Z,se);break;default:e(0)}T+=R,J+=ce}u.Ma+=C}else alert("todo:EmitRescaledRowsYUVA");e(u.Ma<=v.height)}}u.C=m,e(u.C<=u.i)}function Qr(u){var m;if(0<u.ua)return 0;for(m=0;m<u.Wb;++m){var v=u.Ya[m].G,_=u.Ya[m].H;if(0<v[1][_[1]+0].g||0<v[2][_[2]+0].g||0<v[3][_[3]+0].g)return 0}return 1}function tr(u,m,v,_,N,C){if(u.Z!=0){var P=u.qd,T=u.rd;for(e(Pi[u.Z]!=null);m<v;++m)Pi[u.Z](P,T,_,N,_,N,C),P=_,T=N,N+=C;u.qd=P,u.rd=T}}function sr(u,m){var v=u.l.ma,_=v.Z==0||v.Z==1?u.l.j:u.C;if(_=u.C<_?_:u.C,e(m<=u.l.o),m>_){var N=u.l.width,C=v.ca,P=v.tb+N*_,T=u.V,R=u.Ba+u.c*_,F=u.gc;e(u.ab==1),e(F[0].hc==3),gh(F[0],_,m,T,R,C,P),tr(v,_,m,C,P,N)}u.C=u.Ma=m}function nr(u,m,v,_,N,C,P){var T=u.$/_,R=u.$%_,F=u.m,J=u.s,ce=v+u.$,he=ce;N=v+_*N;var re=v+_*C,we=280+J.ua,pe=u.Pb?T:16777216,Z=0<J.ua?J.Wa:null,se=J.wc,ve=ce<re?ys(J,R,T):null;e(u.C<C),e(re<=N);var xe=!1;e:for(;;){for(;xe||ce<re;){var ye=0;if(T>=pe){var De=ce-v;e((pe=u).Pb),pe.wd=pe.m,pe.xd=De,0<pe.s.ua&&be(pe.s.Wa,pe.s.vb),pe=T+Sv}if(R&se||(ve=ys(J,R,T)),e(ve!=null),ve.Qb&&(m[ce]=ve.qb,xe=!0),!xe)if(ee(F),ve.jc){ye=F,De=m;var Pe=ce,Xe=ve.pd[D(ye)&Us-1];e(ve.jc),256>Xe.g?(X(ye,ye.u+Xe.g),De[Pe]=Xe.value,ye=0):(X(ye,ye.u+Xe.g-256),e(256<=Xe.value),ye=Xe.value),ye==0&&(xe=!0)}else ye=fn(ve.G[0],ve.H[0],F);if(F.h)break;if(xe||256>ye){if(!xe)if(ve.nd)m[ce]=(ve.qb|ye<<8)>>>0;else{if(ee(F),xe=fn(ve.G[1],ve.H[1],F),ee(F),De=fn(ve.G[2],ve.H[2],F),Pe=fn(ve.G[3],ve.H[3],F),F.h)break;m[ce]=(Pe<<24|xe<<16|ye<<8|De)>>>0}if(xe=!1,++ce,++R>=_&&(R=0,++T,P!=null&&T<=C&&!(T%16)&&P(u,T),Z!=null))for(;he<ce;)ye=m[he++],Z.X[(506832829*ye&4294967295)>>>Z.Mb]=ye}else if(280>ye){if(ye=er(ye-256,F),De=fn(ve.G[4],ve.H[4],F),ee(F),De=Lr(_,De=er(De,F)),F.h)break;if(ce-v<De||N-ce<ye)break e;for(Pe=0;Pe<ye;++Pe)m[ce+Pe]=m[ce+Pe-De];for(ce+=ye,R+=ye;R>=_;)R-=_,++T,P!=null&&T<=C&&!(T%16)&&P(u,T);if(e(ce<=N),R&se&&(ve=ys(J,R,T)),Z!=null)for(;he<ce;)ye=m[he++],Z.X[(506832829*ye&4294967295)>>>Z.Mb]=ye}else{if(!(ye<we))break e;for(xe=ye-280,e(Z!=null);he<ce;)ye=m[he++],Z.X[(506832829*ye&4294967295)>>>Z.Mb]=ye;ye=ce,e(!(xe>>>(De=Z).Xa)),m[ye]=De.X[xe],xe=!0}xe||e(F.h==z(F))}if(u.Pb&&F.h&&ce<N)e(u.m.h),u.a=5,u.m=u.wd,u.$=u.xd,0<u.s.ua&&be(u.s.vb,u.s.Wa);else{if(F.h)break e;P?.(u,T>C?C:T),u.a=0,u.$=ce-v}return 1}return u.a=3,0}function Tr(u){e(u!=null),u.vc=null,u.yc=null,u.Ya=null;var m=u.Wa;m!=null&&(m.X=null),u.vb=null,e(u!=null)}function Bn(){var u=new Od;return u==null?null:(u.a=0,u.xb=Om,kr("Predictor","VP8LPredictors"),kr("Predictor","VP8LPredictors_C"),kr("PredictorAdd","VP8LPredictorsAdd"),kr("PredictorAdd","VP8LPredictorsAdd_C"),mh=Pt,la=tt,gn=Me,rn=Vs,Ni=Tt,si=Zn,ni=Wt,O.VP8LMapColor32b=ao,O.VP8LMapColor8b=bh,u)}function Ir(u,m,v,_,N){var C=1,P=[u],T=[m],R=_.m,F=_.s,J=null,ce=0;e:for(;;){if(v)for(;C&&me(R,1);){var he=P,re=T,we=_,pe=1,Z=we.m,se=we.gc[we.ab],ve=me(Z,2);if(we.Oc&1<<ve)C=0;else{switch(we.Oc|=1<<ve,se.hc=ve,se.Ea=he[0],se.nc=re[0],se.K=[null],++we.ab,e(4>=we.ab),ve){case 0:case 1:se.b=me(Z,3)+2,pe=Ir(Ue(se.Ea,se.b),Ue(se.nc,se.b),0,we,se.K),se.K=se.K[0];break;case 3:var xe,ye=me(Z,8)+1,De=16<ye?0:4<ye?1:2<ye?2:3;if(he[0]=Ue(se.Ea,De),se.b=De,xe=pe=Ir(ye,1,0,we,se.K)){var Pe,Xe=ye,Te=se,It=1<<(8>>Te.b),Ot=i(It);if(Ot==null)xe=0;else{var Lt=Te.K[0],_t=Te.w;for(Ot[0]=Te.K[0][0],Pe=1;Pe<1*Xe;++Pe)Ot[Pe]=Ne(Lt[_t+Pe],Ot[Pe-1]);for(;Pe<4*It;++Pe)Ot[Pe]=0;Te.K[0]=null,Te.K[0]=Ot,xe=1}}pe=xe;break;case 2:break;default:e(0)}C=pe}}if(P=P[0],T=T[0],C&&me(R,1)&&!(C=1<=(ce=me(R,4))&&11>=ce)){_.a=3;break e}var Vt;if(Vt=C)t:{var Ut,ut,xs,bn=_,_s=P,vn=T,Mt=ce,Pn=v,Ln=bn.m,Os=bn.s,zs=[null],on=1,Vn=0,Mr=Av[Mt];s:for(;;){if(Pn&&me(Ln,1)){var Ms=me(Ln,3)+2,oi=Ue(_s,Ms),fa=Ue(vn,Ms),uo=oi*fa;if(!Ir(oi,fa,0,bn,zs))break s;for(zs=zs[0],Os.xc=Ms,Ut=0;Ut<uo;++Ut){var Li=zs[Ut]>>8&65535;zs[Ut]=Li,Li>=on&&(on=Li+1)}}if(Ln.h)break s;for(ut=0;5>ut;++ut){var cs=jm[ut];!ut&&0<Mt&&(cs+=1<<Mt),Vn<cs&&(Vn=cs)}var Wd=a(on*Mr,j),Hm=on,Wm=a(Hm,q);if(Wm==null)var Ph=null;else e(65536>=Hm),Ph=Wm;var Ll=i(Vn);if(Ph==null||Ll==null||Wd==null){bn.a=1;break s}var Lh=Wd;for(Ut=xs=0;Ut<on;++Ut){var lr=Ph[Ut],fo=lr.G,po=lr.H,Vm=0,Th=1,Gm=0;for(ut=0;5>ut;++ut){cs=jm[ut],fo[ut]=Lh,po[ut]=xs,!ut&&0<Mt&&(cs+=1<<Mt);r:{var Ih,Vd=cs,jh=bn,Tl=Ll,Hv=Lh,Wv=xs,Gd=0,Ti=jh.m,Vv=me(Ti,1);if(n(Tl,0,0,Vd),Vv){var Gv=me(Ti,1)+1,Xv=me(Ti,1),Xm=me(Ti,Xv==0?1:8);Tl[Xm]=1,Gv==2&&(Tl[Xm=me(Ti,8)]=1);var Rh=1}else{var Ym=i(19),Km=me(Ti,4)+4;if(19<Km){jh.a=3;var Oh=0;break r}for(Ih=0;Ih<Km;++Ih)Ym[xv[Ih]]=me(Ti,3);var Xd=void 0,Il=void 0,Jm=jh,Yv=Ym,Mh=Vd,Zm=Tl,Yd=0,Ii=Jm.m,Qm=8,eg=a(128,j);n:for(;L(eg,0,7,Yv,19);){if(me(Ii,1)){var Kv=2+2*me(Ii,3);if((Xd=2+me(Ii,Kv))>Mh)break n}else Xd=Mh;for(Il=0;Il<Mh&&Xd--;){ee(Ii);var tg=eg[0+(127&D(Ii))];X(Ii,Ii.u+tg.g);var mo=tg.value;if(16>mo)Zm[Il++]=mo,mo!=0&&(Qm=mo);else{var Jv=mo==16,sg=mo-16,Zv=yv[sg],ng=me(Ii,vv[sg])+Zv;if(Il+ng>Mh)break n;for(var Qv=Jv?Qm:0;0<ng--;)Zm[Il++]=Qv}}Yd=1;break n}Yd||(Jm.a=3),Rh=Yd}(Rh=Rh&&!Ti.h)&&(Gd=L(Hv,Wv,8,Tl,Vd)),Rh&&Gd!=0?Oh=Gd:(jh.a=3,Oh=0)}if(Oh==0)break s;if(Th&&wv[ut]==1&&(Th=Lh[xs].g==0),Vm+=Lh[xs].g,xs+=Oh,3>=ut){var jl,Kd=Ll[0];for(jl=1;jl<cs;++jl)Ll[jl]>Kd&&(Kd=Ll[jl]);Gm+=Kd}}if(lr.nd=Th,lr.Qb=0,Th&&(lr.qb=(fo[3][po[3]+0].value<<24|fo[1][po[1]+0].value<<16|fo[2][po[2]+0].value)>>>0,Vm==0&&256>fo[0][po[0]+0].value&&(lr.Qb=1,lr.qb+=fo[0][po[0]+0].value<<8)),lr.jc=!lr.Qb&&6>Gm,lr.jc){var Fh,li=lr;for(Fh=0;Fh<Us;++Fh){var ji=Fh,Ri=li.pd[ji],Dh=li.G[0][li.H[0]+ji];256<=Dh.value?(Ri.g=Dh.g+256,Ri.value=Dh.value):(Ri.g=0,Ri.value=0,ji>>=ks(Dh,8,Ri),ji>>=ks(li.G[1][li.H[1]+ji],16,Ri),ji>>=ks(li.G[2][li.H[2]+ji],0,Ri),ks(li.G[3][li.H[3]+ji],24,Ri))}}}Os.vc=zs,Os.Wb=on,Os.Ya=Ph,Os.yc=Wd,Vt=1;break t}Vt=0}if(!(C=Vt)){_.a=3;break e}if(0<ce){if(F.ua=1<<ce,!Ke(F.Wa,ce)){_.a=1,C=0;break e}}else F.ua=0;var Jd=_,rg=P,ey=T,Zd=Jd.s,Qd=Zd.xc;if(Jd.c=rg,Jd.i=ey,Zd.md=Ue(rg,Qd),Zd.wc=Qd==0?-1:(1<<Qd)-1,v){_.xb=Tv;break e}if((J=i(P*T))==null){_.a=1,C=0;break e}C=(C=nr(_,J,0,P,T,T,null))&&!R.h;break e}return C?(N!=null?N[0]=J:(e(J==null),e(v)),_.$=0,v||Tr(F)):Tr(F),C}function na(u,m){var v=u.c*u.i,_=v+m+16*m;return e(u.c<=m),u.V=i(_),u.V==null?(u.Ta=null,u.Ua=0,u.a=1,0):(u.Ta=u.V,u.Ua=u.Ba+v+m,1)}function qa(u,m){var v=u.C,_=m-v,N=u.V,C=u.Ba+u.c*v;for(e(m<=u.l.o);0<_;){var P=16<_?16:_,T=u.l.ma,R=u.l.width,F=R*P,J=T.ca,ce=T.tb+R*v,he=u.Ta,re=u.Ua;En(u,P,N,C),fs(he,re,J,ce,F),tr(T,v,v+P,J,ce,R),_-=P,N+=P*u.c,v+=P}e(v==m),u.C=u.Ma=m}function Ua(){this.ub=this.yd=this.td=this.Rb=0}function za(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ha(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function Yc(){this.Yb=function(){var u=[];return function m(v,_,N){for(var C=N[_],P=0;P<C&&(v.push(N.length>_+1?[]:0),!(N.length<_+1));P++)m(v[P],_+1,N)}(u,0,[3,11]),u}()}function dd(){this.jb=i(3),this.Wc=o([4,8],Yc),this.Xc=o([4,17],Yc)}function fd(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function Wa(){this.ld=this.La=this.dd=this.tc=0}function Kc(){this.Na=this.la=0}function pd(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function rl(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function md(){this.uc=this.M=this.Nb=0,this.wa=Array(new Wa),this.Y=0,this.ya=Array(new rl),this.aa=0,this.l=new Va}function Jc(){this.y=i(16),this.f=i(8),this.ea=i(8)}function gd(){this.cb=this.a=0,this.sc="",this.m=new Ae,this.Od=new Ua,this.Kc=new za,this.ed=new fd,this.Qa=new Ha,this.Ic=this.$c=this.Aa=0,this.D=new md,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=a(8,Ae),this.ia=0,this.pb=a(4,pd),this.Pa=new dd,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Jc),this.Hd=0,this.rb=Array(new Kc),this.sb=0,this.wa=Array(new Wa),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new rl),this.L=this.aa=0,this.gd=o([4,2],Wa),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Va(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function bd(){var u=new gd;return u!=null&&(u.a=0,u.sc="OK",u.cb=0,u.Xb=0,Cl||(Cl=eh)),u}function us(u,m,v){return u.a==0&&(u.a=m,u.sc=v,u.cb=0),0}function Zc(u,m,v){return 3<=v&&u[m+0]==157&&u[m+1]==1&&u[m+2]==42}function Qc(u,m){if(u==null)return 0;if(u.a=0,u.sc="OK",m==null)return us(u,2,"null VP8Io passed to VP8GetHeaders()");var v=m.data,_=m.w,N=m.ha;if(4>N)return us(u,7,"Truncated header.");var C=v[_+0]|v[_+1]<<8|v[_+2]<<16,P=u.Od;if(P.Rb=!(1&C),P.td=C>>1&7,P.yd=C>>4&1,P.ub=C>>5,3<P.td)return us(u,3,"Incorrect keyframe parameters.");if(!P.yd)return us(u,4,"Frame not displayable.");_+=3,N-=3;var T=u.Kc;if(P.Rb){if(7>N)return us(u,7,"cannot parse picture header");if(!Zc(v,_,N))return us(u,3,"Bad code word");T.c=16383&(v[_+4]<<8|v[_+3]),T.Td=v[_+4]>>6,T.i=16383&(v[_+6]<<8|v[_+5]),T.Ud=v[_+6]>>6,_+=7,N-=7,u.za=T.c+15>>4,u.Ub=T.i+15>>4,m.width=T.c,m.height=T.i,m.Da=0,m.j=0,m.v=0,m.va=m.width,m.o=m.height,m.da=0,m.ib=m.width,m.hb=m.height,m.U=m.width,m.T=m.height,n((C=u.Pa).jb,0,255,C.jb.length),e((C=u.Qa)!=null),C.Cb=0,C.Bb=0,C.Fb=1,n(C.Zb,0,0,C.Zb.length),n(C.Lb,0,0,C.Lb)}if(P.ub>N)return us(u,7,"bad partition length");le(C=u.m,v,_,P.ub),_+=P.ub,N-=P.ub,P.Rb&&(T.Ld=ue(C),T.Kd=ue(C)),T=u.Qa;var R,F=u.Pa;if(e(C!=null),e(T!=null),T.Cb=ue(C),T.Cb){if(T.Bb=ue(C),ue(C)){for(T.Fb=ue(C),R=0;4>R;++R)T.Zb[R]=ue(C)?te(C,7):0;for(R=0;4>R;++R)T.Lb[R]=ue(C)?te(C,6):0}if(T.Bb)for(R=0;3>R;++R)F.jb[R]=ue(C)?ae(C,8):255}else T.Bb=0;if(C.Ka)return us(u,3,"cannot parse segment header");if((T=u.ed).zd=ue(C),T.Tb=ae(C,6),T.wb=ae(C,3),T.Pc=ue(C),T.Pc&&ue(C)){for(F=0;4>F;++F)ue(C)&&(T.vd[F]=te(C,6));for(F=0;4>F;++F)ue(C)&&(T.od[F]=te(C,6))}if(u.L=T.Tb==0?0:T.zd?1:2,C.Ka)return us(u,3,"cannot parse filter header");var J=N;if(N=R=_,_=R+J,T=J,u.Xb=(1<<ae(u.m,2))-1,J<3*(F=u.Xb))v=7;else{for(R+=3*F,T-=3*F,J=0;J<F;++J){var ce=v[N+0]|v[N+1]<<8|v[N+2]<<16;ce>T&&(ce=T),le(u.Jc[+J],v,R,ce),R+=ce,T-=ce,N+=3}le(u.Jc[+F],v,R,T),v=R<_?0:5}if(v!=0)return us(u,v,"cannot parse partitions");for(v=ae(R=u.m,7),N=ue(R)?te(R,4):0,_=ue(R)?te(R,4):0,T=ue(R)?te(R,4):0,F=ue(R)?te(R,4):0,R=ue(R)?te(R,4):0,J=u.Qa,ce=0;4>ce;++ce){if(J.Cb){var he=J.Zb[ce];J.Fb||(he+=v)}else{if(0<ce){u.pb[ce]=u.pb[0];continue}he=v}var re=u.pb[ce];re.Sc[0]=Ud[kn(he+N,127)],re.Sc[1]=zd[kn(he+0,127)],re.Eb[0]=2*Ud[kn(he+_,127)],re.Eb[1]=101581*zd[kn(he+T,127)]>>16,8>re.Eb[1]&&(re.Eb[1]=8),re.Qc[0]=Ud[kn(he+F,117)],re.Qc[1]=zd[kn(he+R,127)],re.lc=he+R}if(!P.Rb)return us(u,4,"Not a key frame.");for(ue(C),P=u.Pa,v=0;4>v;++v){for(N=0;8>N;++N)for(_=0;3>_;++_)for(T=0;11>T;++T)F=de(C,Pv[v][N][_][T])?ae(C,8):kv[v][N][_][T],P.Wc[v][N].Yb[_][T]=F;for(N=0;17>N;++N)P.Xc[v][N]=P.Wc[v][Lv[N]]}return u.kc=ue(C),u.kc&&(u.Bd=ae(C,8)),u.cb=1}function eh(u,m,v,_,N,C,P){var T=m[N].Yb[v];for(v=0;16>N;++N){if(!de(u,T[v+0]))return N;for(;!de(u,T[v+1]);)if(T=m[++N].Yb[0],v=0,N==16)return 16;var R=m[N+1].Yb;if(de(u,T[v+2])){var F=u,J=0;if(de(F,(he=T)[(ce=v)+3]))if(de(F,he[ce+6])){for(T=0,ce=2*(J=de(F,he[ce+8]))+(he=de(F,he[ce+9+J])),J=0,he=Nv[ce];he[T];++T)J+=J+de(F,he[T]);J+=3+(8<<ce)}else de(F,he[ce+7])?(J=7+2*de(F,165),J+=de(F,145)):J=5+de(F,159);else J=de(F,he[ce+4])?3+de(F,he[ce+5]):2;T=R[2]}else J=1,T=R[1];R=P+Ev[N],0>(F=u).b&&ie(F);var ce,he=F.b,re=(ce=F.Ca>>1)-(F.I>>he)>>31;--F.b,F.Ca+=re,F.Ca|=1,F.I-=(ce+1&re)<<he,C[R]=((J^re)-re)*_[(0<N)+0]}return 16}function il(u){var m=u.rb[u.sb-1];m.la=0,m.Na=0,n(u.zc,0,0,u.zc.length),u.ja=0}function vd(u,m){if(u==null)return 0;if(m==null)return us(u,2,"NULL VP8Io parameter in VP8Decode().");if(!u.cb&&!Qc(u,m))return 0;if(e(u.cb),m.ac==null||m.ac(m)){m.ob&&(u.L=0);var v=Ch[u.L];if(u.L==2?(u.yb=0,u.zb=0):(u.yb=m.v-v>>4,u.zb=m.j-v>>4,0>u.yb&&(u.yb=0),0>u.zb&&(u.zb=0)),u.Va=m.o+15+v>>4,u.Hb=m.va+15+v>>4,u.Hb>u.za&&(u.Hb=u.za),u.Va>u.Ub&&(u.Va=u.Ub),0<u.L){var _=u.ed;for(v=0;4>v;++v){var N;if(u.Qa.Cb){var C=u.Qa.Lb[v];u.Qa.Fb||(C+=_.Tb)}else C=_.Tb;for(N=0;1>=N;++N){var P=u.gd[v][N],T=C;if(_.Pc&&(T+=_.vd[0],N&&(T+=_.od[0])),0<(T=0>T?0:63<T?63:T)){var R=T;0<_.wb&&(R=4<_.wb?R>>2:R>>1)>9-_.wb&&(R=9-_.wb),1>R&&(R=1),P.dd=R,P.tc=2*T+R,P.ld=40<=T?2:15<=T?1:0}else P.tc=0;P.La=N}}}v=0}else us(u,6,"Frame setup failed"),v=u.a;if(v=v==0){if(v){u.$c=0,0<u.Aa||(u.Ic=zv);e:{v=u.Ic,_=4*(R=u.za);var F=32*R,J=R+1,ce=0<u.L?R*(0<u.Aa?2:1):0,he=(u.Aa==2?2:1)*R;if((P=_+832+(N=3*(16*v+Ch[u.L])/2*F)+(C=u.Fa!=null&&0<u.Fa.length?u.Kc.c*u.Kc.i:0))!=P)v=0;else{if(P>u.Vb){if(u.Vb=0,u.Ec=i(P),u.Fc=0,u.Ec==null){v=us(u,1,"no memory during frame initialization.");break e}u.Vb=P}P=u.Ec,T=u.Fc,u.Ac=P,u.Bc=T,T+=_,u.Gd=a(F,Jc),u.Hd=0,u.rb=a(J+1,Kc),u.sb=1,u.wa=ce?a(ce,Wa):null,u.Y=0,u.D.Nb=0,u.D.wa=u.wa,u.D.Y=u.Y,0<u.Aa&&(u.D.Y+=R),e(!0),u.oc=P,u.pc=T,T+=832,u.ya=a(he,rl),u.aa=0,u.D.ya=u.ya,u.D.aa=u.aa,u.Aa==2&&(u.D.aa+=R),u.R=16*R,u.B=8*R,R=(F=Ch[u.L])*u.R,F=F/2*u.B,u.sa=P,u.ta=T+R,u.qa=u.sa,u.ra=u.ta+16*v*u.R+F,u.Ha=u.qa,u.Ia=u.ra+8*v*u.B+F,u.$c=0,T+=N,u.mb=C?P:null,u.nb=C?T:null,e(T+C<=u.Fc+u.Vb),il(u),n(u.Ac,u.Bc,0,_),v=1}}if(v){if(m.ka=0,m.y=u.sa,m.O=u.ta,m.f=u.qa,m.N=u.ra,m.ea=u.Ha,m.Vd=u.Ia,m.fa=u.R,m.Rc=u.B,m.F=null,m.J=0,!yh){for(v=-255;255>=v;++v)Cs[255+v]=0>v?-v:v;for(v=-1020;1020>=v;++v)ii[1020+v]=-128>v?-128:127<v?127:v;for(v=-112;112>=v;++v)kl[112+v]=-16>v?-16:15<v?15:v;for(v=-255;510>=v;++v)ho[255+v]=0>v?0:255<v?255:v;yh=1}oo=xd,ri=yd,Sl=sh,an=wd,qn=nh,ds=th,lo=ul,vh=aa,Nl=Rd,ca=dl,ha=jd,Ei=Za,ua=fl,co=dh,da=uh,ki=Rr,El=ti,Un=Id,or[0]=jr,or[1]=_d,or[2]=Ed,or[3]=kd,or[4]=ah,or[5]=Ka,or[6]=oh,or[7]=ll,or[8]=Pd,or[9]=Cd,Ci[0]=rh,Ci[1]=Sd,Ci[2]=ei,Ci[3]=Xa,Ci[4]=Gs,Ci[5]=Nd,Ci[6]=ih,ai[0]=xi,ai[1]=Ad,ai[2]=Ld,ai[3]=cl,ai[4]=ia,ai[5]=Td,ai[6]=hl,v=1}else v=0}v&&(v=function(re,we){for(re.M=0;re.M<re.Va;++re.M){var pe,Z=re.Jc[re.M&re.Xb],se=re.m,ve=re;for(pe=0;pe<ve.za;++pe){var xe=se,ye=ve,De=ye.Ac,Pe=ye.Bc+4*pe,Xe=ye.zc,Te=ye.ya[ye.aa+pe];if(ye.Qa.Bb?Te.$b=de(xe,ye.Pa.jb[0])?2+de(xe,ye.Pa.jb[2]):de(xe,ye.Pa.jb[1]):Te.$b=0,ye.kc&&(Te.Ad=de(xe,ye.Bd)),Te.Za=!de(xe,145)+0,Te.Za){var It=Te.Ob,Ot=0;for(ye=0;4>ye;++ye){var Lt,_t=Xe[0+ye];for(Lt=0;4>Lt;++Lt){_t=Cv[De[Pe+Lt]][_t];for(var Vt=Rm[de(xe,_t[0])];0<Vt;)Vt=Rm[2*Vt+de(xe,_t[Vt])];_t=-Vt,De[Pe+Lt]=_t}s(It,Ot,De,Pe,4),Ot+=4,Xe[0+ye]=_t}}else _t=de(xe,156)?de(xe,128)?1:3:de(xe,163)?2:0,Te.Ob[0]=_t,n(De,Pe,_t,4),n(Xe,0,_t,4);Te.Dd=de(xe,142)?de(xe,114)?de(xe,183)?1:3:2:0}if(ve.m.Ka)return us(re,7,"Premature end-of-partition0 encountered.");for(;re.ja<re.za;++re.ja){if(ve=Z,xe=(se=re).rb[se.sb-1],De=se.rb[se.sb+se.ja],pe=se.ya[se.aa+se.ja],Pe=se.kc?pe.Ad:0)xe.la=De.la=0,pe.Za||(xe.Na=De.Na=0),pe.Hc=0,pe.Gc=0,pe.ia=0;else{var Ut,ut;if(xe=De,De=ve,Pe=se.Pa.Xc,Xe=se.ya[se.aa+se.ja],Te=se.pb[Xe.$b],ye=Xe.ad,It=0,Ot=se.rb[se.sb-1],_t=Lt=0,n(ye,It,0,384),Xe.Za)var xs=0,bn=Pe[3];else{Vt=i(16);var _s=xe.Na+Ot.Na;if(_s=Cl(De,Pe[1],_s,Te.Eb,0,Vt,0),xe.Na=Ot.Na=(0<_s)+0,1<_s)oo(Vt,0,ye,It);else{var vn=Vt[0]+3>>3;for(Vt=0;256>Vt;Vt+=16)ye[It+Vt]=vn}xs=1,bn=Pe[0]}var Mt=15&xe.la,Pn=15&Ot.la;for(Vt=0;4>Vt;++Vt){var Ln=1&Pn;for(vn=ut=0;4>vn;++vn)Mt=Mt>>1|(Ln=(_s=Cl(De,bn,_s=Ln+(1&Mt),Te.Sc,xs,ye,It))>xs)<<7,ut=ut<<2|(3<_s?3:1<_s?2:ye[It+0]!=0),It+=16;Mt>>=4,Pn=Pn>>1|Ln<<7,Lt=(Lt<<8|ut)>>>0}for(bn=Mt,xs=Pn>>4,Ut=0;4>Ut;Ut+=2){for(ut=0,Mt=xe.la>>4+Ut,Pn=Ot.la>>4+Ut,Vt=0;2>Vt;++Vt){for(Ln=1&Pn,vn=0;2>vn;++vn)_s=Ln+(1&Mt),Mt=Mt>>1|(Ln=0<(_s=Cl(De,Pe[2],_s,Te.Qc,0,ye,It)))<<3,ut=ut<<2|(3<_s?3:1<_s?2:ye[It+0]!=0),It+=16;Mt>>=2,Pn=Pn>>1|Ln<<5}_t|=ut<<4*Ut,bn|=Mt<<4<<Ut,xs|=(240&Pn)<<Ut}xe.la=bn,Ot.la=xs,Xe.Hc=Lt,Xe.Gc=_t,Xe.ia=43690&_t?0:Te.ia,Pe=!(Lt|_t)}if(0<se.L&&(se.wa[se.Y+se.ja]=se.gd[pe.$b][pe.Za],se.wa[se.Y+se.ja].La|=!Pe),ve.Ka)return us(re,7,"Premature end-of-file encountered.")}if(il(re),se=we,ve=1,pe=(Z=re).D,xe=0<Z.L&&Z.M>=Z.zb&&Z.M<=Z.Va,Z.Aa==0)e:{if(pe.M=Z.M,pe.uc=xe,yl(Z,pe),ve=1,pe=(ut=Z.D).Nb,xe=(_t=Ch[Z.L])*Z.R,De=_t/2*Z.B,Vt=16*pe*Z.R,vn=8*pe*Z.B,Pe=Z.sa,Xe=Z.ta-xe+Vt,Te=Z.qa,ye=Z.ra-De+vn,It=Z.Ha,Ot=Z.Ia-De+vn,Pn=(Mt=ut.M)==0,Lt=Mt>=Z.Va-1,Z.Aa==2&&yl(Z,ut),ut.uc)for(Ln=(_s=Z).D.M,e(_s.D.uc),ut=_s.yb;ut<_s.Hb;++ut){xs=ut,bn=Ln;var Os=(zs=(cs=_s).D).Nb;Ut=cs.R;var zs=zs.wa[zs.Y+xs],on=cs.sa,Vn=cs.ta+16*Os*Ut+16*xs,Mr=zs.dd,Ms=zs.tc;if(Ms!=0)if(e(3<=Ms),cs.L==1)0<xs&&ki(on,Vn,Ut,Ms+4),zs.La&&Un(on,Vn,Ut,Ms),0<bn&&da(on,Vn,Ut,Ms+4),zs.La&&El(on,Vn,Ut,Ms);else{var oi=cs.B,fa=cs.qa,uo=cs.ra+8*Os*oi+8*xs,Li=cs.Ha,cs=cs.Ia+8*Os*oi+8*xs;Os=zs.ld,0<xs&&(vh(on,Vn,Ut,Ms+4,Mr,Os),ca(fa,uo,Li,cs,oi,Ms+4,Mr,Os)),zs.La&&(Ei(on,Vn,Ut,Ms,Mr,Os),co(fa,uo,Li,cs,oi,Ms,Mr,Os)),0<bn&&(lo(on,Vn,Ut,Ms+4,Mr,Os),Nl(fa,uo,Li,cs,oi,Ms+4,Mr,Os)),zs.La&&(ha(on,Vn,Ut,Ms,Mr,Os),ua(fa,uo,Li,cs,oi,Ms,Mr,Os))}}if(Z.ia&&alert("todo:DitherRow"),se.put!=null){if(ut=16*Mt,Mt=16*(Mt+1),Pn?(se.y=Z.sa,se.O=Z.ta+Vt,se.f=Z.qa,se.N=Z.ra+vn,se.ea=Z.Ha,se.W=Z.Ia+vn):(ut-=_t,se.y=Pe,se.O=Xe,se.f=Te,se.N=ye,se.ea=It,se.W=Ot),Lt||(Mt-=_t),Mt>se.o&&(Mt=se.o),se.F=null,se.J=null,Z.Fa!=null&&0<Z.Fa.length&&ut<Mt&&(se.J=bl(Z,se,ut,Mt-ut),se.F=Z.mb,se.F==null&&se.F.length==0)){ve=us(Z,3,"Could not decode alpha data.");break e}ut<se.j&&(_t=se.j-ut,ut=se.j,e(!(1&_t)),se.O+=Z.R*_t,se.N+=Z.B*(_t>>1),se.W+=Z.B*(_t>>1),se.F!=null&&(se.J+=se.width*_t)),ut<Mt&&(se.O+=se.v,se.N+=se.v>>1,se.W+=se.v>>1,se.F!=null&&(se.J+=se.v),se.ka=ut-se.j,se.U=se.va-se.v,se.T=Mt-ut,ve=se.put(se))}pe+1!=Z.Ic||Lt||(s(Z.sa,Z.ta-xe,Pe,Xe+16*Z.R,xe),s(Z.qa,Z.ra-De,Te,ye+8*Z.B,De),s(Z.Ha,Z.Ia-De,It,Ot+8*Z.B,De))}if(!ve)return us(re,6,"Output aborted.")}return 1}(u,m)),m.bc!=null&&m.bc(m),v&=1}return v?(u.cb=0,v):0}function rr(u,m,v,_,N){N=u[m+v+32*_]+(N>>3),u[m+v+32*_]=-256&N?0>N?0:255:N}function Ga(u,m,v,_,N,C){rr(u,m,0,v,_+N),rr(u,m,1,v,_+C),rr(u,m,2,v,_-C),rr(u,m,3,v,_-N)}function pn(u){return(20091*u>>16)+u}function al(u,m,v,_){var N,C=0,P=i(16);for(N=0;4>N;++N){var T=u[m+0]+u[m+8],R=u[m+0]-u[m+8],F=(35468*u[m+4]>>16)-pn(u[m+12]),J=pn(u[m+4])+(35468*u[m+12]>>16);P[C+0]=T+J,P[C+1]=R+F,P[C+2]=R-F,P[C+3]=T-J,C+=4,m++}for(N=C=0;4>N;++N)T=(u=P[C+0]+4)+P[C+8],R=u-P[C+8],F=(35468*P[C+4]>>16)-pn(P[C+12]),rr(v,_,0,0,T+(J=pn(P[C+4])+(35468*P[C+12]>>16))),rr(v,_,1,0,R+F),rr(v,_,2,0,R-F),rr(v,_,3,0,T-J),C++,_+=32}function th(u,m,v,_){var N=u[m+0]+4,C=35468*u[m+4]>>16,P=pn(u[m+4]),T=35468*u[m+1]>>16;Ga(v,_,0,N+P,u=pn(u[m+1]),T),Ga(v,_,1,N+C,u,T),Ga(v,_,2,N-C,u,T),Ga(v,_,3,N-P,u,T)}function yd(u,m,v,_,N){al(u,m,v,_),N&&al(u,m+16,v,_+4)}function sh(u,m,v,_){ri(u,m+0,v,_,1),ri(u,m+32,v,_+128,1)}function wd(u,m,v,_){var N;for(u=u[m+0]+4,N=0;4>N;++N)for(m=0;4>m;++m)rr(v,_,m,N,u)}function nh(u,m,v,_){u[m+0]&&an(u,m+0,v,_),u[m+16]&&an(u,m+16,v,_+4),u[m+32]&&an(u,m+32,v,_+128),u[m+48]&&an(u,m+48,v,_+128+4)}function xd(u,m,v,_){var N,C=i(16);for(N=0;4>N;++N){var P=u[m+0+N]+u[m+12+N],T=u[m+4+N]+u[m+8+N],R=u[m+4+N]-u[m+8+N],F=u[m+0+N]-u[m+12+N];C[0+N]=P+T,C[8+N]=P-T,C[4+N]=F+R,C[12+N]=F-R}for(N=0;4>N;++N)P=(u=C[0+4*N]+3)+C[3+4*N],T=C[1+4*N]+C[2+4*N],R=C[1+4*N]-C[2+4*N],F=u-C[3+4*N],v[_+0]=P+T>>3,v[_+16]=F+R>>3,v[_+32]=P-T>>3,v[_+48]=F-R>>3,_+=64}function ol(u,m,v){var _,N=m-32,C=Cn,P=255-u[N-1];for(_=0;_<v;++_){var T,R=C,F=P+u[m-1];for(T=0;T<v;++T)u[m+T]=R[F+u[N+T]];m+=32}}function _d(u,m){ol(u,m,4)}function Ad(u,m){ol(u,m,8)}function Sd(u,m){ol(u,m,16)}function ei(u,m){var v;for(v=0;16>v;++v)s(u,m+32*v,u,m-32,16)}function Xa(u,m){var v;for(v=16;0<v;--v)n(u,m,u[m-1],16),m+=32}function Ya(u,m,v){var _;for(_=0;16>_;++_)n(m,v+32*_,u,16)}function rh(u,m){var v,_=16;for(v=0;16>v;++v)_+=u[m-1+32*v]+u[m+v-32];Ya(_>>5,u,m)}function Gs(u,m){var v,_=8;for(v=0;16>v;++v)_+=u[m-1+32*v];Ya(_>>4,u,m)}function Nd(u,m){var v,_=8;for(v=0;16>v;++v)_+=u[m+v-32];Ya(_>>4,u,m)}function ih(u,m){Ya(128,u,m)}function st(u,m,v){return u+2*m+v+2>>2}function Ed(u,m){var v,_=m-32;for(_=new Uint8Array([st(u[_-1],u[_+0],u[_+1]),st(u[_+0],u[_+1],u[_+2]),st(u[_+1],u[_+2],u[_+3]),st(u[_+2],u[_+3],u[_+4])]),v=0;4>v;++v)s(u,m+32*v,_,0,_.length)}function kd(u,m){var v=u[m-1],_=u[m-1+32],N=u[m-1+64],C=u[m-1+96];ke(u,m+0,16843009*st(u[m-1-32],v,_)),ke(u,m+32,16843009*st(v,_,N)),ke(u,m+64,16843009*st(_,N,C)),ke(u,m+96,16843009*st(N,C,C))}function jr(u,m){var v,_=4;for(v=0;4>v;++v)_+=u[m+v-32]+u[m-1+32*v];for(_>>=3,v=0;4>v;++v)n(u,m+32*v,_,4)}function ah(u,m){var v=u[m-1+0],_=u[m-1+32],N=u[m-1+64],C=u[m-1-32],P=u[m+0-32],T=u[m+1-32],R=u[m+2-32],F=u[m+3-32];u[m+0+96]=st(_,N,u[m-1+96]),u[m+1+96]=u[m+0+64]=st(v,_,N),u[m+2+96]=u[m+1+64]=u[m+0+32]=st(C,v,_),u[m+3+96]=u[m+2+64]=u[m+1+32]=u[m+0+0]=st(P,C,v),u[m+3+64]=u[m+2+32]=u[m+1+0]=st(T,P,C),u[m+3+32]=u[m+2+0]=st(R,T,P),u[m+3+0]=st(F,R,T)}function oh(u,m){var v=u[m+1-32],_=u[m+2-32],N=u[m+3-32],C=u[m+4-32],P=u[m+5-32],T=u[m+6-32],R=u[m+7-32];u[m+0+0]=st(u[m+0-32],v,_),u[m+1+0]=u[m+0+32]=st(v,_,N),u[m+2+0]=u[m+1+32]=u[m+0+64]=st(_,N,C),u[m+3+0]=u[m+2+32]=u[m+1+64]=u[m+0+96]=st(N,C,P),u[m+3+32]=u[m+2+64]=u[m+1+96]=st(C,P,T),u[m+3+64]=u[m+2+96]=st(P,T,R),u[m+3+96]=st(T,R,R)}function Ka(u,m){var v=u[m-1+0],_=u[m-1+32],N=u[m-1+64],C=u[m-1-32],P=u[m+0-32],T=u[m+1-32],R=u[m+2-32],F=u[m+3-32];u[m+0+0]=u[m+1+64]=C+P+1>>1,u[m+1+0]=u[m+2+64]=P+T+1>>1,u[m+2+0]=u[m+3+64]=T+R+1>>1,u[m+3+0]=R+F+1>>1,u[m+0+96]=st(N,_,v),u[m+0+64]=st(_,v,C),u[m+0+32]=u[m+1+96]=st(v,C,P),u[m+1+32]=u[m+2+96]=st(C,P,T),u[m+2+32]=u[m+3+96]=st(P,T,R),u[m+3+32]=st(T,R,F)}function ll(u,m){var v=u[m+0-32],_=u[m+1-32],N=u[m+2-32],C=u[m+3-32],P=u[m+4-32],T=u[m+5-32],R=u[m+6-32],F=u[m+7-32];u[m+0+0]=v+_+1>>1,u[m+1+0]=u[m+0+64]=_+N+1>>1,u[m+2+0]=u[m+1+64]=N+C+1>>1,u[m+3+0]=u[m+2+64]=C+P+1>>1,u[m+0+32]=st(v,_,N),u[m+1+32]=u[m+0+96]=st(_,N,C),u[m+2+32]=u[m+1+96]=st(N,C,P),u[m+3+32]=u[m+2+96]=st(C,P,T),u[m+3+64]=st(P,T,R),u[m+3+96]=st(T,R,F)}function Cd(u,m){var v=u[m-1+0],_=u[m-1+32],N=u[m-1+64],C=u[m-1+96];u[m+0+0]=v+_+1>>1,u[m+2+0]=u[m+0+32]=_+N+1>>1,u[m+2+32]=u[m+0+64]=N+C+1>>1,u[m+1+0]=st(v,_,N),u[m+3+0]=u[m+1+32]=st(_,N,C),u[m+3+32]=u[m+1+64]=st(N,C,C),u[m+3+64]=u[m+2+64]=u[m+0+96]=u[m+1+96]=u[m+2+96]=u[m+3+96]=C}function Pd(u,m){var v=u[m-1+0],_=u[m-1+32],N=u[m-1+64],C=u[m-1+96],P=u[m-1-32],T=u[m+0-32],R=u[m+1-32],F=u[m+2-32];u[m+0+0]=u[m+2+32]=v+P+1>>1,u[m+0+32]=u[m+2+64]=_+v+1>>1,u[m+0+64]=u[m+2+96]=N+_+1>>1,u[m+0+96]=C+N+1>>1,u[m+3+0]=st(T,R,F),u[m+2+0]=st(P,T,R),u[m+1+0]=u[m+3+32]=st(v,P,T),u[m+1+32]=u[m+3+64]=st(_,v,P),u[m+1+64]=u[m+3+96]=st(N,_,v),u[m+1+96]=st(C,N,_)}function Ld(u,m){var v;for(v=0;8>v;++v)s(u,m+32*v,u,m-32,8)}function cl(u,m){var v;for(v=0;8>v;++v)n(u,m,u[m-1],8),m+=32}function ra(u,m,v){var _;for(_=0;8>_;++_)n(m,v+32*_,u,8)}function xi(u,m){var v,_=8;for(v=0;8>v;++v)_+=u[m+v-32]+u[m-1+32*v];ra(_>>4,u,m)}function Td(u,m){var v,_=4;for(v=0;8>v;++v)_+=u[m+v-32];ra(_>>3,u,m)}function ia(u,m){var v,_=4;for(v=0;8>v;++v)_+=u[m-1+32*v];ra(_>>3,u,m)}function hl(u,m){ra(128,u,m)}function Ja(u,m,v){var _=u[m-v],N=u[m+0],C=3*(N-_)+Fd[1020+u[m-2*v]-u[m+v]],P=wh[112+(C+4>>3)];u[m-v]=Cn[255+_+wh[112+(C+3>>3)]],u[m+0]=Cn[255+N-P]}function lh(u,m,v,_){var N=u[m+0],C=u[m+v];return Hn[255+u[m-2*v]-u[m-v]]>_||Hn[255+C-N]>_}function ch(u,m,v,_){return 4*Hn[255+u[m-v]-u[m+0]]+Hn[255+u[m-2*v]-u[m+v]]<=_}function hh(u,m,v,_,N){var C=u[m-3*v],P=u[m-2*v],T=u[m-v],R=u[m+0],F=u[m+v],J=u[m+2*v],ce=u[m+3*v];return 4*Hn[255+T-R]+Hn[255+P-F]>_?0:Hn[255+u[m-4*v]-C]<=N&&Hn[255+C-P]<=N&&Hn[255+P-T]<=N&&Hn[255+ce-J]<=N&&Hn[255+J-F]<=N&&Hn[255+F-R]<=N}function uh(u,m,v,_){var N=2*_+1;for(_=0;16>_;++_)ch(u,m+_,v,N)&&Ja(u,m+_,v)}function Rr(u,m,v,_){var N=2*_+1;for(_=0;16>_;++_)ch(u,m+_*v,1,N)&&Ja(u,m+_*v,1)}function ti(u,m,v,_){var N;for(N=3;0<N;--N)uh(u,m+=4*v,v,_)}function Id(u,m,v,_){var N;for(N=3;0<N;--N)Rr(u,m+=4,v,_)}function _i(u,m,v,_,N,C,P,T){for(C=2*C+1;0<N--;){if(hh(u,m,v,C,P))if(lh(u,m,v,T))Ja(u,m,v);else{var R=u,F=m,J=v,ce=R[F-2*J],he=R[F-J],re=R[F+0],we=R[F+J],pe=R[F+2*J],Z=27*(ve=Fd[1020+3*(re-he)+Fd[1020+ce-we]])+63>>7,se=18*ve+63>>7,ve=9*ve+63>>7;R[F-3*J]=Cn[255+R[F-3*J]+ve],R[F-2*J]=Cn[255+ce+se],R[F-J]=Cn[255+he+Z],R[F+0]=Cn[255+re-Z],R[F+J]=Cn[255+we-se],R[F+2*J]=Cn[255+pe-ve]}m+=_}}function ir(u,m,v,_,N,C,P,T){for(C=2*C+1;0<N--;){if(hh(u,m,v,C,P))if(lh(u,m,v,T))Ja(u,m,v);else{var R=u,F=m,J=v,ce=R[F-J],he=R[F+0],re=R[F+J],we=wh[112+((pe=3*(he-ce))+4>>3)],pe=wh[112+(pe+3>>3)],Z=we+1>>1;R[F-2*J]=Cn[255+R[F-2*J]+Z],R[F-J]=Cn[255+ce+pe],R[F+0]=Cn[255+he-we],R[F+J]=Cn[255+re-Z]}m+=_}}function ul(u,m,v,_,N,C){_i(u,m,v,1,16,_,N,C)}function aa(u,m,v,_,N,C){_i(u,m,1,v,16,_,N,C)}function jd(u,m,v,_,N,C){var P;for(P=3;0<P;--P)ir(u,m+=4*v,v,1,16,_,N,C)}function Za(u,m,v,_,N,C){var P;for(P=3;0<P;--P)ir(u,m+=4,1,v,16,_,N,C)}function Rd(u,m,v,_,N,C,P,T){_i(u,m,N,1,8,C,P,T),_i(v,_,N,1,8,C,P,T)}function dl(u,m,v,_,N,C,P,T){_i(u,m,1,N,8,C,P,T),_i(v,_,1,N,8,C,P,T)}function fl(u,m,v,_,N,C,P,T){ir(u,m+4*N,N,1,8,C,P,T),ir(v,_+4*N,N,1,8,C,P,T)}function dh(u,m,v,_,N,C,P,T){ir(u,m+4,1,N,8,C,P,T),ir(v,_+4,1,N,8,C,P,T)}function Qa(){this.ba=new Qn,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new os,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function pl(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function ml(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function fh(){this.ua=0,this.Wa=new H,this.vb=new H,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new q,this.yc=new j}function Od(){this.xb=this.a=0,this.l=new Va,this.ca=new Qn,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new k,this.Pb=0,this.wd=new k,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new fh,this.ab=0,this.gc=a(4,ml),this.Oc=0}function eo(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Va,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function oa(u,m,v,_,N,C,P){for(u=u==null?0:u[m+0],m=0;m<P;++m)N[C+m]=u+v[_+m]&255,u=N[C+m]}function gl(u,m,v,_,N,C,P){var T;if(u==null)oa(null,null,v,_,N,C,P);else for(T=0;T<P;++T)N[C+T]=u[m+T]+v[_+T]&255}function Ai(u,m,v,_,N,C,P){if(u==null)oa(null,null,v,_,N,C,P);else{var T,R=u[m+0],F=R,J=R;for(T=0;T<P;++T)F=J+(R=u[m+T])-F,J=v[_+T]+(-256&F?0>F?0:255:F)&255,F=R,N[C+T]=J}}function bl(u,m,v,_){var N=m.width,C=m.o;if(e(u!=null&&m!=null),0>v||0>=_||v+_>C)return null;if(!u.Cc){if(u.ga==null){var P;if(u.ga=new eo,(P=u.ga==null)||(P=m.width*m.o,e(u.Gb.length==0),u.Gb=i(P),u.Uc=0,u.Gb==null?P=0:(u.mb=u.Gb,u.nb=u.Uc,u.rc=null,P=1),P=!P),!P){P=u.ga;var T=u.Fa,R=u.P,F=u.qc,J=u.mb,ce=u.nb,he=R+1,re=F-1,we=P.l;if(e(T!=null&&J!=null&&m!=null),Pi[0]=null,Pi[1]=oa,Pi[2]=gl,Pi[3]=Ai,P.ca=J,P.tb=ce,P.c=m.width,P.i=m.height,e(0<P.c&&0<P.i),1>=F)m=0;else if(P.$a=T[R+0]>>0&3,P.Z=T[R+0]>>2&3,P.Lc=T[R+0]>>4&3,R=T[R+0]>>6&3,0>P.$a||1<P.$a||4<=P.Z||1<P.Lc||R)m=0;else if(we.put=Cr,we.ac=qs,we.bc=Pr,we.ma=P,we.width=m.width,we.height=m.height,we.Da=m.Da,we.v=m.v,we.va=m.va,we.j=m.j,we.o=m.o,P.$a)e:{e(P.$a==1),m=Bn();t:for(;;){if(m==null){m=0;break e}if(e(P!=null),P.mc=m,m.c=P.c,m.i=P.i,m.l=P.l,m.l.ma=P,m.l.width=P.c,m.l.height=P.i,m.a=0,K(m.m,T,he,re),!Ir(P.c,P.i,1,m,null)||(m.ab==1&&m.gc[0].hc==3&&Qr(m.s)?(P.ic=1,T=m.c*m.i,m.Ta=null,m.Ua=0,m.V=i(T),m.Ba=0,m.V==null?(m.a=1,m=0):m=1):(P.ic=0,m=na(m,P.c)),!m))break t;m=1;break e}P.mc=null,m=0}else m=re>=P.c*P.i;P=!m}if(P)return null;u.ga.Lc!=1?u.Ga=0:_=C-v}e(u.ga!=null),e(v+_<=C);e:{if(m=(T=u.ga).c,C=T.l.o,T.$a==0){if(he=u.rc,re=u.Vc,we=u.Fa,R=u.P+1+v*m,F=u.mb,J=u.nb+v*m,e(R<=u.P+u.qc),T.Z!=0)for(e(Pi[T.Z]!=null),P=0;P<_;++P)Pi[T.Z](he,re,we,R,F,J,m),he=F,re=J,J+=m,R+=m;else for(P=0;P<_;++P)s(F,J,we,R,m),he=F,re=J,J+=m,R+=m;u.rc=he,u.Vc=re}else{if(e(T.mc!=null),m=v+_,e((P=T.mc)!=null),e(m<=P.i),P.C>=m)m=1;else if(T.ic||oe(),T.ic){T=P.V,he=P.Ba,re=P.c;var pe=P.i,Z=(we=1,R=P.$/re,F=P.$%re,J=P.m,ce=P.s,P.$),se=re*pe,ve=re*m,xe=ce.wc,ye=Z<ve?ys(ce,F,R):null;e(Z<=se),e(m<=pe),e(Qr(ce));t:for(;;){for(;!J.h&&Z<ve;){if(F&xe||(ye=ys(ce,F,R)),e(ye!=null),ee(J),256>(pe=fn(ye.G[0],ye.H[0],J)))T[he+Z]=pe,++Z,++F>=re&&(F=0,++R<=m&&!(R%16)&&sr(P,R));else{if(!(280>pe)){we=0;break t}pe=er(pe-256,J);var De,Pe=fn(ye.G[4],ye.H[4],J);if(ee(J),!(Z>=(Pe=Lr(re,Pe=er(Pe,J)))&&se-Z>=pe)){we=0;break t}for(De=0;De<pe;++De)T[he+Z+De]=T[he+Z+De-Pe];for(Z+=pe,F+=pe;F>=re;)F-=re,++R<=m&&!(R%16)&&sr(P,R);Z<ve&&F&xe&&(ye=ys(ce,F,R))}e(J.h==z(J))}sr(P,R>m?m:R);break t}!we||J.h&&Z<se?(we=0,P.a=J.h?5:3):P.$=Z,m=we}else m=nr(P,P.V,P.Ba,P.c,P.i,m,qa);if(!m){_=0;break e}}v+_>=C&&(u.Cc=1),_=1}if(!_)return null;if(u.Cc&&((_=u.ga)!=null&&(_.mc=null),u.ga=null,0<u.Ga))return alert("todo:WebPDequantizeLevels"),null}return u.nb+v*N}function b(u,m,v,_,N,C){for(;0<N--;){var P,T=u,R=m+(v?1:0),F=u,J=m+(v?0:3);for(P=0;P<_;++P){var ce=F[J+4*P];ce!=255&&(ce*=32897,T[R+4*P+0]=T[R+4*P+0]*ce>>23,T[R+4*P+1]=T[R+4*P+1]*ce>>23,T[R+4*P+2]=T[R+4*P+2]*ce>>23)}m+=C}}function E(u,m,v,_,N){for(;0<_--;){var C;for(C=0;C<v;++C){var P=u[m+2*C+0],T=15&(F=u[m+2*C+1]),R=4369*T,F=(240&F|F>>4)*R>>16;u[m+2*C+0]=(240&P|P>>4)*R>>16&240|(15&P|P<<4)*R>>16>>4&15,u[m+2*C+1]=240&F|T}m+=N}}function $(u,m,v,_,N,C,P,T){var R,F,J=255;for(F=0;F<N;++F){for(R=0;R<_;++R){var ce=u[m+R];C[P+4*R]=ce,J&=ce}m+=v,P+=T}return J!=255}function Y(u,m,v,_,N){var C;for(C=0;C<N;++C)v[_+C]=u[m+C]>>8}function oe(){zn=b,Kt=E,Jt=$,fs=Y}function ge(u,m,v){O[u]=function(_,N,C,P,T,R,F,J,ce,he,re,we,pe,Z,se,ve,xe){var ye,De=xe-1>>1,Pe=T[R+0]|F[J+0]<<16,Xe=ce[he+0]|re[we+0]<<16;e(_!=null);var Te=3*Pe+Xe+131074>>2;for(m(_[N+0],255&Te,Te>>16,pe,Z),C!=null&&(Te=3*Xe+Pe+131074>>2,m(C[P+0],255&Te,Te>>16,se,ve)),ye=1;ye<=De;++ye){var It=T[R+ye]|F[J+ye]<<16,Ot=ce[he+ye]|re[we+ye]<<16,Lt=Pe+It+Xe+Ot+524296,_t=Lt+2*(It+Xe)>>3;Te=_t+Pe>>1,Pe=(Lt=Lt+2*(Pe+Ot)>>3)+It>>1,m(_[N+2*ye-1],255&Te,Te>>16,pe,Z+(2*ye-1)*v),m(_[N+2*ye-0],255&Pe,Pe>>16,pe,Z+(2*ye-0)*v),C!=null&&(Te=Lt+Xe>>1,Pe=_t+Ot>>1,m(C[P+2*ye-1],255&Te,Te>>16,se,ve+(2*ye-1)*v),m(C[P+2*ye+0],255&Pe,Pe>>16,se,ve+(2*ye+0)*v)),Pe=It,Xe=Ot}1&xe||(Te=3*Pe+Xe+131074>>2,m(_[N+xe-1],255&Te,Te>>16,pe,Z+(xe-1)*v),C!=null&&(Te=3*Xe+Pe+131074>>2,m(C[P+xe-1],255&Te,Te>>16,se,ve+(xe-1)*v)))}}function _e(){Wn[xh]=Iv,Wn[_h]=Mm,Wn[Tm]=jv,Wn[Ah]=Fm,Wn[Sh]=Dm,Wn[Dd]=Bm,Wn[Im]=Rv,Wn[Bd]=Mm,Wn[$d]=Fm,Wn[Nh]=Dm,Wn[qd]=Bm}function Fe(u){return u&~Ov?0>u?0:255:u>>$m}function Ge(u,m){return Fe((19077*u>>8)+(26149*m>>8)-14234)}function ht(u,m,v){return Fe((19077*u>>8)-(6419*m>>8)-(13320*v>>8)+8708)}function at(u,m){return Fe((19077*u>>8)+(33050*m>>8)-17685)}function kt(u,m,v,_,N){_[N+0]=Ge(u,v),_[N+1]=ht(u,m,v),_[N+2]=at(u,m)}function ss(u,m,v,_,N){_[N+0]=at(u,m),_[N+1]=ht(u,m,v),_[N+2]=Ge(u,v)}function ls(u,m,v,_,N){var C=ht(u,m,v);m=C<<3&224|at(u,m)>>3,_[N+0]=248&Ge(u,v)|C>>5,_[N+1]=m}function ws(u,m,v,_,N){var C=240&at(u,m)|15;_[N+0]=240&Ge(u,v)|ht(u,m,v)>>4,_[N+1]=C}function Xs(u,m,v,_,N){_[N+0]=255,kt(u,m,v,_,N+1)}function Rs(u,m,v,_,N){ss(u,m,v,_,N),_[N+3]=255}function ar(u,m,v,_,N){kt(u,m,v,_,N),_[N+3]=255}function kn(u,m){return 0>u?0:u>m?m:u}function Or(u,m,v){O[u]=function(_,N,C,P,T,R,F,J,ce){for(var he=J+(-2&ce)*v;J!=he;)m(_[N+0],C[P+0],T[R+0],F,J),m(_[N+1],C[P+0],T[R+0],F,J+v),N+=2,++P,++R,J+=2*v;1&ce&&m(_[N+0],C[P+0],T[R+0],F,J)}}function ph(u,m,v){return v==0?u==0?m==0?6:5:m==0?4:0:v}function vl(u,m,v,_,N){switch(u>>>30){case 3:ri(m,v,_,N,0);break;case 2:ds(m,v,_,N);break;case 1:an(m,v,_,N)}}function yl(u,m){var v,_,N=m.M,C=m.Nb,P=u.oc,T=u.pc+40,R=u.oc,F=u.pc+584,J=u.oc,ce=u.pc+600;for(v=0;16>v;++v)P[T+32*v-1]=129;for(v=0;8>v;++v)R[F+32*v-1]=129,J[ce+32*v-1]=129;for(0<N?P[T-1-32]=R[F-1-32]=J[ce-1-32]=129:(n(P,T-32-1,127,21),n(R,F-32-1,127,9),n(J,ce-32-1,127,9)),_=0;_<u.za;++_){var he=m.ya[m.aa+_];if(0<_){for(v=-1;16>v;++v)s(P,T+32*v-4,P,T+32*v+12,4);for(v=-1;8>v;++v)s(R,F+32*v-4,R,F+32*v+4,4),s(J,ce+32*v-4,J,ce+32*v+4,4)}var re=u.Gd,we=u.Hd+_,pe=he.ad,Z=he.Hc;if(0<N&&(s(P,T-32,re[we].y,0,16),s(R,F-32,re[we].f,0,8),s(J,ce-32,re[we].ea,0,8)),he.Za){var se=P,ve=T-32+16;for(0<N&&(_>=u.za-1?n(se,ve,re[we].y[15],4):s(se,ve,re[we+1].y,0,4)),v=0;4>v;v++)se[ve+128+v]=se[ve+256+v]=se[ve+384+v]=se[ve+0+v];for(v=0;16>v;++v,Z<<=2)se=P,ve=T+Um[v],or[he.Ob[v]](se,ve),vl(Z,pe,16*+v,se,ve)}else if(se=ph(_,N,he.Ob[0]),Ci[se](P,T),Z!=0)for(v=0;16>v;++v,Z<<=2)vl(Z,pe,16*+v,P,T+Um[v]);for(v=he.Gc,se=ph(_,N,he.Dd),ai[se](R,F),ai[se](J,ce),Z=pe,se=R,ve=F,255&(he=v>>0)&&(170&he?Sl(Z,256,se,ve):qn(Z,256,se,ve)),he=J,Z=ce,255&(v>>=8)&&(170&v?Sl(pe,320,he,Z):qn(pe,320,he,Z)),N<u.Ub-1&&(s(re[we].y,0,P,T+480,16),s(re[we].f,0,R,F+224,8),s(re[we].ea,0,J,ce+224,8)),v=8*C*u.B,re=u.sa,we=u.ta+16*_+16*C*u.R,pe=u.qa,he=u.ra+8*_+v,Z=u.Ha,se=u.Ia+8*_+v,v=0;16>v;++v)s(re,we+v*u.R,P,T+32*v,16);for(v=0;8>v;++v)s(pe,he+v*u.B,R,F+32*v,8),s(Z,se+v*u.B,J,ce+32*v,8)}}function to(u,m,v,_,N,C,P,T,R){var F=[0],J=[0],ce=0,he=R!=null?R.kd:0,re=R??new pl;if(u==null||12>v)return 7;re.data=u,re.w=m,re.ha=v,m=[m],v=[v],re.gb=[re.gb];e:{var we=m,pe=v,Z=re.gb;if(e(u!=null),e(pe!=null),e(Z!=null),Z[0]=0,12<=pe[0]&&!t(u,we[0],"RIFF")){if(t(u,we[0]+8,"WEBP")){Z=3;break e}var se=Le(u,we[0]+4);if(12>se||4294967286<se){Z=3;break e}if(he&&se>pe[0]-8){Z=7;break e}Z[0]=se,we[0]+=12,pe[0]-=12}Z=0}if(Z!=0)return Z;for(se=0<re.gb[0],v=v[0];;){e:{var ve=u;pe=m,Z=v;var xe=F,ye=J,De=we=[0];if((Te=ce=[ce])[0]=0,8>Z[0])Z=7;else{if(!t(ve,pe[0],"VP8X")){if(Le(ve,pe[0]+4)!=10){Z=3;break e}if(18>Z[0]){Z=7;break e}var Pe=Le(ve,pe[0]+8),Xe=1+Re(ve,pe[0]+12);if(2147483648<=Xe*(ve=1+Re(ve,pe[0]+15))){Z=3;break e}De!=null&&(De[0]=Pe),xe!=null&&(xe[0]=Xe),ye!=null&&(ye[0]=ve),pe[0]+=18,Z[0]-=18,Te[0]=1}Z=0}}if(ce=ce[0],we=we[0],Z!=0)return Z;if(pe=!!(2&we),!se&&ce)return 3;if(C!=null&&(C[0]=!!(16&we)),P!=null&&(P[0]=pe),T!=null&&(T[0]=0),P=F[0],we=J[0],ce&&pe&&R==null){Z=0;break}if(4>v){Z=7;break}if(se&&ce||!se&&!ce&&!t(u,m[0],"ALPH")){v=[v],re.na=[re.na],re.P=[re.P],re.Sa=[re.Sa];e:{Pe=u,Z=m,se=v;var Te=re.gb;xe=re.na,ye=re.P,De=re.Sa,Xe=22,e(Pe!=null),e(se!=null),ve=Z[0];var It=se[0];for(e(xe!=null),e(De!=null),xe[0]=null,ye[0]=null,De[0]=0;;){if(Z[0]=ve,se[0]=It,8>It){Z=7;break e}var Ot=Le(Pe,ve+4);if(4294967286<Ot){Z=3;break e}var Lt=8+Ot+1&-2;if(Xe+=Lt,0<Te&&Xe>Te){Z=3;break e}if(!t(Pe,ve,"VP8 ")||!t(Pe,ve,"VP8L")){Z=0;break e}if(It[0]<Lt){Z=7;break e}t(Pe,ve,"ALPH")||(xe[0]=Pe,ye[0]=ve+8,De[0]=Ot),ve+=Lt,It-=Lt}}if(v=v[0],re.na=re.na[0],re.P=re.P[0],re.Sa=re.Sa[0],Z!=0)break}v=[v],re.Ja=[re.Ja],re.xa=[re.xa];e:if(Te=u,Z=m,se=v,xe=re.gb[0],ye=re.Ja,De=re.xa,Pe=Z[0],ve=!t(Te,Pe,"VP8 "),Xe=!t(Te,Pe,"VP8L"),e(Te!=null),e(se!=null),e(ye!=null),e(De!=null),8>se[0])Z=7;else{if(ve||Xe){if(Te=Le(Te,Pe+4),12<=xe&&Te>xe-12){Z=3;break e}if(he&&Te>se[0]-8){Z=7;break e}ye[0]=Te,Z[0]+=8,se[0]-=8,De[0]=Xe}else De[0]=5<=se[0]&&Te[Pe+0]==47&&!(Te[Pe+4]>>5),ye[0]=se[0];Z=0}if(v=v[0],re.Ja=re.Ja[0],re.xa=re.xa[0],m=m[0],Z!=0)break;if(4294967286<re.Ja)return 3;if(T==null||pe||(T[0]=re.xa?2:1),P=[P],we=[we],re.xa){if(5>v){Z=7;break}T=P,he=we,pe=C,u==null||5>v?u=0:5<=v&&u[m+0]==47&&!(u[m+4]>>5)?(se=[0],Te=[0],xe=[0],K(ye=new k,u,m,v),Ye(ye,se,Te,xe)?(T!=null&&(T[0]=se[0]),he!=null&&(he[0]=Te[0]),pe!=null&&(pe[0]=xe[0]),u=1):u=0):u=0}else{if(10>v){Z=7;break}T=we,u==null||10>v||!Zc(u,m+3,v-3)?u=0:(he=u[m+0]|u[m+1]<<8|u[m+2]<<16,pe=16383&(u[m+7]<<8|u[m+6]),u=16383&(u[m+9]<<8|u[m+8]),1&he||3<(he>>1&7)||!(he>>4&1)||he>>5>=re.Ja||!pe||!u?u=0:(P&&(P[0]=pe),T&&(T[0]=u),u=1))}if(!u||(P=P[0],we=we[0],ce&&(F[0]!=P||J[0]!=we)))return 3;R!=null&&(R[0]=re,R.offset=m-R.w,e(4294967286>m-R.w),e(R.offset==R.ha-v));break}return Z==0||Z==7&&ce&&R==null?(C!=null&&(C[0]|=re.na!=null&&0<re.na.length),_!=null&&(_[0]=P),N!=null&&(N[0]=we),0):Z}function wl(u,m,v){var _=m.width,N=m.height,C=0,P=0,T=_,R=N;if(m.Da=u!=null&&0<u.Da,m.Da&&(T=u.cd,R=u.bd,C=u.v,P=u.j,11>v||(C&=-2,P&=-2),0>C||0>P||0>=T||0>=R||C+T>_||P+R>N))return 0;if(m.v=C,m.j=P,m.va=C+T,m.o=P+R,m.U=T,m.T=R,m.da=u!=null&&0<u.da,m.da){if(!ct(T,R,v=[u.ib],C=[u.hb]))return 0;m.ib=v[0],m.hb=C[0]}return m.ob=u!=null&&u.ob,m.Kb=u==null||!u.Sd,m.da&&(m.ob=m.ib<3*_/4&&m.hb<3*N/4,m.Kb=0),1}function xl(u){if(u==null)return 2;if(11>u.S){var m=u.f.RGBA;m.fb+=(u.height-1)*m.A,m.A=-m.A}else m=u.f.kb,u=u.height,m.O+=(u-1)*m.fa,m.fa=-m.fa,m.N+=(u-1>>1)*m.Ab,m.Ab=-m.Ab,m.W+=(u-1>>1)*m.Db,m.Db=-m.Db,m.F!=null&&(m.J+=(u-1)*m.lb,m.lb=-m.lb);return 0}function so(u,m,v,_){if(_==null||0>=u||0>=m)return 2;if(v!=null){if(v.Da){var N=v.cd,C=v.bd,P=-2&v.v,T=-2&v.j;if(0>P||0>T||0>=N||0>=C||P+N>u||T+C>m)return 2;u=N,m=C}if(v.da){if(!ct(u,m,N=[v.ib],C=[v.hb]))return 2;u=N[0],m=C[0]}}_.width=u,_.height=m;e:{var R=_.width,F=_.height;if(u=_.S,0>=R||0>=F||!(u>=xh&&13>u))u=2;else{if(0>=_.Rd&&_.sd==null){P=C=N=m=0;var J=(T=R*zm[u])*F;if(11>u||(C=(F+1)/2*(m=(R+1)/2),u==12&&(P=(N=R)*F)),(F=i(J+2*C+P))==null){u=1;break e}_.sd=F,11>u?((R=_.f.RGBA).eb=F,R.fb=0,R.A=T,R.size=J):((R=_.f.kb).y=F,R.O=0,R.fa=T,R.Fd=J,R.f=F,R.N=0+J,R.Ab=m,R.Cd=C,R.ea=F,R.W=0+J+C,R.Db=m,R.Ed=C,u==12&&(R.F=F,R.J=0+J+2*C),R.Tc=P,R.lb=N)}if(m=1,N=_.S,C=_.width,P=_.height,N>=xh&&13>N)if(11>N)u=_.f.RGBA,m&=(T=Math.abs(u.A))*(P-1)+C<=u.size,m&=T>=C*zm[N],m&=u.eb!=null;else{u=_.f.kb,T=(C+1)/2,J=(P+1)/2,R=Math.abs(u.fa),F=Math.abs(u.Ab);var ce=Math.abs(u.Db),he=Math.abs(u.lb),re=he*(P-1)+C;m&=R*(P-1)+C<=u.Fd,m&=F*(J-1)+T<=u.Cd,m=(m&=ce*(J-1)+T<=u.Ed)&R>=C&F>=T&ce>=T,m&=u.y!=null,m&=u.f!=null,m&=u.ea!=null,N==12&&(m&=he>=C,m&=re<=u.Tc,m&=u.F!=null)}else m=0;u=m?0:2}}return u!=0||v!=null&&v.fd&&(u=xl(_)),u}var Us=64,no=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ro=24,io=32,_l=8,mn=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ce("Predictor0","PredictorAdd0"),O.Predictor0=function(){return 4278190080},O.Predictor1=function(u){return u},O.Predictor2=function(u,m,v){return m[v+0]},O.Predictor3=function(u,m,v){return m[v+1]},O.Predictor4=function(u,m,v){return m[v-1]},O.Predictor5=function(u,m,v){return Ie(Ie(u,m[v+1]),m[v+0])},O.Predictor6=function(u,m,v){return Ie(u,m[v-1])},O.Predictor7=function(u,m,v){return Ie(u,m[v+0])},O.Predictor8=function(u,m,v){return Ie(m[v-1],m[v+0])},O.Predictor9=function(u,m,v){return Ie(m[v+0],m[v+1])},O.Predictor10=function(u,m,v){return Ie(Ie(u,m[v-1]),Ie(m[v+0],m[v+1]))},O.Predictor11=function(u,m,v){var _=m[v+0];return 0>=ft(_>>24&255,u>>24&255,(m=m[v-1])>>24&255)+ft(_>>16&255,u>>16&255,m>>16&255)+ft(_>>8&255,u>>8&255,m>>8&255)+ft(255&_,255&u,255&m)?_:u},O.Predictor12=function(u,m,v){var _=m[v+0];return(Ve((u>>24&255)+(_>>24&255)-((m=m[v-1])>>24&255))<<24|Ve((u>>16&255)+(_>>16&255)-(m>>16&255))<<16|Ve((u>>8&255)+(_>>8&255)-(m>>8&255))<<8|Ve((255&u)+(255&_)-(255&m)))>>>0},O.Predictor13=function(u,m,v){var _=m[v-1];return(rt((u=Ie(u,m[v+0]))>>24&255,_>>24&255)<<24|rt(u>>16&255,_>>16&255)<<16|rt(u>>8&255,_>>8&255)<<8|rt(u>>0&255,_>>0&255))>>>0};var Md=O.PredictorAdd0;O.PredictorAdd1=yt,Ce("Predictor2","PredictorAdd2"),Ce("Predictor3","PredictorAdd3"),Ce("Predictor4","PredictorAdd4"),Ce("Predictor5","PredictorAdd5"),Ce("Predictor6","PredictorAdd6"),Ce("Predictor7","PredictorAdd7"),Ce("Predictor8","PredictorAdd8"),Ce("Predictor9","PredictorAdd9"),Ce("Predictor10","PredictorAdd10"),Ce("Predictor11","PredictorAdd11"),Ce("Predictor12","PredictorAdd12"),Ce("Predictor13","PredictorAdd13");var Al=O.PredictorAdd2;wt("ColorIndexInverseTransform","MapARGB","32b",function(u){return u>>8&255},function(u){return u}),wt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(u){return u},function(u){return u>>8&255});var mh,$n=O.ColorIndexInverseTransform,ao=O.MapARGB,gh=O.VP8LColorIndexInverseTransformAlpha,bh=O.MapAlpha,Si=O.VP8LPredictorsAdd=[];Si.length=16,(O.VP8LPredictors=[]).length=16,(O.VP8LPredictorsAdd_C=[]).length=16,(O.VP8LPredictors_C=[]).length=16;var la,gn,rn,Ni,si,ni,oo,ri,ds,Sl,an,qn,lo,vh,Nl,ca,ha,Ei,ua,co,da,ki,El,Un,zn,Kt,Jt,fs,Cs=i(511),ii=i(2041),kl=i(225),ho=i(767),yh=0,Fd=ii,wh=kl,Cn=ho,Hn=Cs,xh=0,_h=1,Tm=2,Ah=3,Sh=4,Dd=5,Im=6,Bd=7,$d=8,Nh=9,qd=10,vv=[2,3,7],yv=[3,3,11],jm=[280,256,256,256,40],wv=[0,1,1,1,0],xv=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],_v=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Av=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Sv=8,Ud=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],zd=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Cl=null,Nv=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Ev=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Rm=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],kv=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Cv=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Pv=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Lv=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Ci=[],or=[],ai=[],Tv=1,Om=2,Pi=[],Wn=[];ge("UpsampleRgbLinePair",kt,3),ge("UpsampleBgrLinePair",ss,3),ge("UpsampleRgbaLinePair",ar,4),ge("UpsampleBgraLinePair",Rs,4),ge("UpsampleArgbLinePair",Xs,4),ge("UpsampleRgba4444LinePair",ws,2),ge("UpsampleRgb565LinePair",ls,2);var Iv=O.UpsampleRgbLinePair,jv=O.UpsampleBgrLinePair,Mm=O.UpsampleRgbaLinePair,Fm=O.UpsampleBgraLinePair,Dm=O.UpsampleArgbLinePair,Bm=O.UpsampleRgba4444LinePair,Rv=O.UpsampleRgb565LinePair,Eh=16,kh=1<<Eh-1,Pl=-227,Hd=482,$m=6,Ov=(256<<$m)-1,qm=0,Mv=i(256),Fv=i(256),Dv=i(256),Bv=i(256),$v=i(Hd-Pl),qv=i(Hd-Pl);Or("YuvToRgbRow",kt,3),Or("YuvToBgrRow",ss,3),Or("YuvToRgbaRow",ar,4),Or("YuvToBgraRow",Rs,4),Or("YuvToArgbRow",Xs,4),Or("YuvToRgba4444Row",ws,2),Or("YuvToRgb565Row",ls,2);var Um=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Ch=[0,2,8],Uv=[8,7,6,4,4,2,2,2,1,1,1,1],zv=1;this.WebPDecodeRGBA=function(u,m,v,_,N){var C=_h,P=new Qa,T=new Qn;P.ba=T,T.S=C,T.width=[T.width],T.height=[T.height];var R=T.width,F=T.height,J=new Zr;if(J==null||u==null)var ce=2;else e(J!=null),ce=to(u,m,v,J.width,J.height,J.Pd,J.Qd,J.format,null);if(ce!=0?R=0:(R!=null&&(R[0]=J.width[0]),F!=null&&(F[0]=J.height[0]),R=1),R){T.width=T.width[0],T.height=T.height[0],_!=null&&(_[0]=T.width),N!=null&&(N[0]=T.height);e:{if(_=new Va,(N=new pl).data=u,N.w=m,N.ha=v,N.kd=1,m=[0],e(N!=null),((u=to(N.data,N.w,N.ha,null,null,null,m,null,N))==0||u==7)&&m[0]&&(u=4),(m=u)==0){if(e(P!=null),_.data=N.data,_.w=N.w+N.offset,_.ha=N.ha-N.offset,_.put=Cr,_.ac=qs,_.bc=Pr,_.ma=P,N.xa){if((u=Bn())==null){P=1;break e}if(function(he,re){var we=[0],pe=[0],Z=[0];t:for(;;){if(he==null)return 0;if(re==null)return he.a=2,0;if(he.l=re,he.a=0,K(he.m,re.data,re.w,re.ha),!Ye(he.m,we,pe,Z)){he.a=3;break t}if(he.xb=Om,re.width=we[0],re.height=pe[0],!Ir(we[0],pe[0],1,he,null))break t;return 1}return e(he.a!=0),0}(u,_)){if(_=(m=so(_.width,_.height,P.Oa,P.ba))==0){t:{_=u;s:for(;;){if(_==null){_=0;break t}if(e(_.s.yc!=null),e(_.s.Ya!=null),e(0<_.s.Wb),e((v=_.l)!=null),e((N=v.ma)!=null),_.xb!=0){if(_.ca=N.ba,_.tb=N.tb,e(_.ca!=null),!wl(N.Oa,v,Ah)){_.a=2;break s}if(!na(_,v.width)||v.da)break s;if((v.da||jt(_.ca.S))&&oe(),11>_.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),_.ca.f.kb.F!=null&&oe()),_.Pb&&0<_.s.ua&&_.s.vb.X==null&&!Ke(_.s.vb,_.s.Wa.Xa)){_.a=1;break s}_.xb=0}if(!nr(_,_.V,_.Ba,_.c,_.i,v.o,$a))break s;N.Dc=_.Ma,_=1;break t}e(_.a!=0),_=0}_=!_}_&&(m=u.a)}else m=u.a}else{if((u=new bd)==null){P=1;break e}if(u.Fa=N.na,u.P=N.P,u.qc=N.Sa,Qc(u,_)){if((m=so(_.width,_.height,P.Oa,P.ba))==0){if(u.Aa=0,v=P.Oa,e((N=u)!=null),v!=null){if(0<(R=0>(R=v.Md)?0:100<R?255:255*R/100)){for(F=J=0;4>F;++F)12>(ce=N.pb[F]).lc&&(ce.ia=R*Uv[0>ce.lc?0:ce.lc]>>3),J|=ce.ia;J&&(alert("todo:VP8InitRandom"),N.ia=1)}N.Ga=v.Id,100<N.Ga?N.Ga=100:0>N.Ga&&(N.Ga=0)}vd(u,_)||(m=u.a)}}else m=u.a}m==0&&P.Oa!=null&&P.Oa.fd&&(m=xl(P.ba))}P=m}C=P!=0?null:11>C?T.f.RGBA.eb:T.f.kb.y}else C=null;return C};var zm=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(O,G){for(var ne="",L=0;L<4;L++)ne+=String.fromCharCode(O[G++]);return ne}function h(O,G){return(O[G+0]<<0|O[G+1]<<8|O[G+2]<<16)>>>0}function d(O,G){return(O[G+0]<<0|O[G+1]<<8|O[G+2]<<16|O[G+3]<<24)>>>0}new l;var p=[0],f=[0],y=[],w=new l,A=r,x=function(O,G){var ne={},L=0,j=!1,V=0,q=0;if(ne.frames=[],!function(D,z,X,ee){for(var ie=0;ie<ee;ie++)if(D[z+ie]!=X.charCodeAt(ie))return!0;return!1}(O,G,"RIFF",4)){var le,ae;for(d(O,G+=4),G+=8;G<O.length;){var te=c(O,G),K=d(O,G+=4);G+=4;var fe=K+(1&K);switch(te){case"VP8 ":case"VP8L":ne.frames[L]===void 0&&(ne.frames[L]={}),(k=ne.frames[L]).src_off=j?q:G-8,k.src_size=V+K+8,L++,j&&(j=!1,V=0,q=0);break;case"VP8X":(k=ne.header={}).feature_flags=O[G];var me=G+4;k.canvas_width=1+h(O,me),me+=3,k.canvas_height=1+h(O,me),me+=3;break;case"ALPH":j=!0,V=fe+8,q=G-8;break;case"ANIM":(k=ne.header).bgcolor=d(O,G),me=G+4,k.loop_count=(le=O)[(ae=me)+0]<<0|le[ae+1]<<8,me+=2;break;case"ANMF":var Ae,k;(k=ne.frames[L]={}).offset_x=2*h(O,G),G+=3,k.offset_y=2*h(O,G),G+=3,k.width=1+h(O,G),G+=3,k.height=1+h(O,G),G+=3,k.duration=h(O,G),G+=3,Ae=O[G++],k.dispose=1&Ae,k.blend=Ae>>1&1}te!="ANMF"&&(G+=fe)}return ne}}(A,0);x.response=A,x.rgbaoutput=!0,x.dataurl=!1;var S=x.header?x.header:null,I=x.frames?x.frames:null;if(S){S.loop_counter=S.loop_count,p=[S.canvas_height],f=[S.canvas_width];for(var M=0;M<I.length&&I[M].blend!=0;M++);}var B=I[0],Q=w.WebPDecodeRGBA(A,B.src_off,B.src_size,f,p);B.rgba=Q,B.imgwidth=f[0],B.imgheight=p[0];for(var U=0;U<f[0]*p[0]*4;U++)y[U]=Q[U];return this.width=f,this.height=p,this.data=y,this}(function(r){var e=function(){return typeof sp=="function"},t=function(p,f,y,w){var A=4,x=a;switch(w){case r.image_compression.FAST:A=1,x=i;break;case r.image_compression.MEDIUM:A=6,x=o;break;case r.image_compression.SLOW:A=9,x=l}p=s(p,f,y,x);var S=sp(p,{level:A});return r.__addimage__.arrayBufferToBinaryString(S)},s=function(p,f,y,w){for(var A,x,S,I=p.length/f,M=new Uint8Array(p.length+I),B=h(),Q=0;Q<I;Q+=1){if(S=Q*f,A=p.subarray(S,S+f),w)M.set(w(A,y,x),S+Q);else{for(var U,O=B.length,G=[];U<O;U+=1)G[U]=B[U](A,y,x);var ne=d(G.concat());M.set(G[ne],S+Q)}x=A}return M},n=function(p){var f=Array.apply([],p);return f.unshift(0),f},i=function(p,f){var y,w=[],A=p.length;w[0]=1;for(var x=0;x<A;x+=1)y=p[x-f]||0,w[x+1]=p[x]-y+256&255;return w},a=function(p,f,y){var w,A=[],x=p.length;A[0]=2;for(var S=0;S<x;S+=1)w=y&&y[S]||0,A[S+1]=p[S]-w+256&255;return A},o=function(p,f,y){var w,A,x=[],S=p.length;x[0]=3;for(var I=0;I<S;I+=1)w=p[I-f]||0,A=y&&y[I]||0,x[I+1]=p[I]+256-(w+A>>>1)&255;return x},l=function(p,f,y){var w,A,x,S,I=[],M=p.length;I[0]=4;for(var B=0;B<M;B+=1)w=p[B-f]||0,A=y&&y[B]||0,x=y&&y[B-f]||0,S=c(w,A,x),I[B+1]=p[B]-S+256&255;return I},c=function(p,f,y){if(p===f&&f===y)return p;var w=Math.abs(f-y),A=Math.abs(p-y),x=Math.abs(p+f-y-y);return w<=A&&w<=x?p:A<=x?f:y},h=function(){return[n,i,a,o,l]},d=function(p){var f=p.map(function(y){return y.reduce(function(w,A){return w+Math.abs(A)},0)});return f.indexOf(Math.min.apply(null,f))};r.processPNG=function(p,f,y,w){var A,x,S,I,M,B,Q,U,O,G,ne,L,j,V,q,le=this.decode.FLATE_DECODE,ae="";if(this.__addimage__.isArrayBuffer(p)&&(p=new Uint8Array(p)),this.__addimage__.isArrayBufferView(p)){if(p=(S=new p4(p)).imgData,x=S.bits,A=S.colorSpace,M=S.colors,[4,6].indexOf(S.colorType)!==-1){if(S.bits===8){O=(U=S.pixelBitlength==32?new Uint32Array(S.decodePixels().buffer):S.pixelBitlength==16?new Uint16Array(S.decodePixels().buffer):new Uint8Array(S.decodePixels().buffer)).length,ne=new Uint8Array(O*S.colors),G=new Uint8Array(O);var te,K=S.pixelBitlength-S.bits;for(V=0,q=0;V<O;V++){for(j=U[V],te=0;te<K;)ne[q++]=j>>>te&255,te+=S.bits;G[V]=j>>>te&255}}if(S.bits===16){O=(U=new Uint32Array(S.decodePixels().buffer)).length,ne=new Uint8Array(O*(32/S.pixelBitlength)*S.colors),G=new Uint8Array(O*(32/S.pixelBitlength)),L=S.colors>1,V=0,q=0;for(var fe=0;V<O;)j=U[V++],ne[q++]=j>>>0&255,L&&(ne[q++]=j>>>16&255,j=U[V++],ne[q++]=j>>>0&255),G[fe++]=j>>>16&255;x=8}w!==r.image_compression.NONE&&e()?(p=t(ne,S.width*S.colors,S.colors,w),Q=t(G,S.width,1,w)):(p=ne,Q=G,le=void 0)}if(S.colorType===3&&(A=this.color_spaces.INDEXED,B=S.palette,S.transparency.indexed)){var me=S.transparency.indexed,Ae=0;for(V=0,O=me.length;V<O;++V)Ae+=me[V];if((Ae/=255)===O-1&&me.indexOf(0)!==-1)I=[me.indexOf(0)];else if(Ae!==O){for(U=S.decodePixels(),G=new Uint8Array(U.length),V=0,O=U.length;V<O;V++)G[V]=me[U[V]];Q=t(G,S.width,1)}}var k=function(D){var z;switch(D){case r.image_compression.FAST:z=11;break;case r.image_compression.MEDIUM:z=13;break;case r.image_compression.SLOW:z=14;break;default:z=12}return z}(w);return le===this.decode.FLATE_DECODE&&(ae="/Predictor "+k+" "),ae+="/Colors "+M+" /BitsPerComponent "+x+" /Columns "+S.width,(this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),(Q&&this.__addimage__.isArrayBuffer(Q)||this.__addimage__.isArrayBufferView(Q))&&(Q=this.__addimage__.arrayBufferToBinaryString(Q)),{alias:y,data:p,index:f,filter:le,decodeParameters:ae,transparency:I,palette:B,sMask:Q,predictor:k,width:S.width,height:S.height,bitsPerComponent:x,colorSpace:A}}}})(Je.API),function(r){r.processGIF89A=function(e,t,s,n){var i=new m4(e),a=i.width,o=i.height,l=[];i.decodeAndBlitFrameRGBA(0,l);var c={data:l,width:a,height:o},h=new Af(100).encode(c,100);return r.processJPEG.call(this,h,t,s,n)},r.processGIF87A=r.processGIF89A}(Je.API),hr.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var r=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(r);for(var e=0;e<r;e++){var t=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:n,green:s,blue:t,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},hr.prototype.parseBGR=function(){this.pos=this.offset;try{var r="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[r]()}catch(t){Gt.log("bit decode error:"+t)}},hr.prototype.bit1=function(){var r,e=Math.ceil(this.width/8),t=e%4;for(r=this.height-1;r>=0;r--){for(var s=this.bottom_up?r:this.height-1-r,n=0;n<e;n++)for(var i=this.datav.getUint8(this.pos++,!0),a=s*this.width*4+8*n*4,o=0;o<8&&8*n+o<this.width;o++){var l=this.palette[i>>7-o&1];this.data[a+4*o]=l.blue,this.data[a+4*o+1]=l.green,this.data[a+4*o+2]=l.red,this.data[a+4*o+3]=255}t!==0&&(this.pos+=4-t)}},hr.prototype.bit4=function(){for(var r=Math.ceil(this.width/2),e=r%4,t=this.height-1;t>=0;t--){for(var s=this.bottom_up?t:this.height-1-t,n=0;n<r;n++){var i=this.datav.getUint8(this.pos++,!0),a=s*this.width*4+2*n*4,o=i>>4,l=15&i,c=this.palette[o];if(this.data[a]=c.blue,this.data[a+1]=c.green,this.data[a+2]=c.red,this.data[a+3]=255,2*n+1>=this.width)break;c=this.palette[l],this.data[a+4]=c.blue,this.data[a+4+1]=c.green,this.data[a+4+2]=c.red,this.data[a+4+3]=255}e!==0&&(this.pos+=4-e)}},hr.prototype.bit8=function(){for(var r=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,s=0;s<this.width;s++){var n=this.datav.getUint8(this.pos++,!0),i=t*this.width*4+4*s;if(n<this.palette.length){var a=this.palette[n];this.data[i]=a.red,this.data[i+1]=a.green,this.data[i+2]=a.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}r!==0&&(this.pos+=4-r)}},hr.prototype.bit15=function(){for(var r=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var s=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(i&e)/e*255|0,o=(i>>5&e)/e*255|0,l=(i>>10&e)/e*255|0,c=i>>15?255:0,h=s*this.width*4+4*n;this.data[h]=l,this.data[h+1]=o,this.data[h+2]=a,this.data[h+3]=c}this.pos+=r}},hr.prototype.bit16=function(){for(var r=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),s=this.height-1;s>=0;s--){for(var n=this.bottom_up?s:this.height-1-s,i=0;i<this.width;i++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&e)/e*255|0,l=(a>>5&t)/t*255|0,c=(a>>11)/e*255|0,h=n*this.width*4+4*i;this.data[h]=c,this.data[h+1]=l,this.data[h+2]=o,this.data[h+3]=255}this.pos+=r}},hr.prototype.bit24=function(){for(var r=this.height-1;r>=0;r--){for(var e=this.bottom_up?r:this.height-1-r,t=0;t<this.width;t++){var s=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*t;this.data[a]=i,this.data[a+1]=n,this.data[a+2]=s,this.data[a+3]=255}this.pos+=this.width%4}},hr.prototype.bit32=function(){for(var r=this.height-1;r>=0;r--)for(var e=this.bottom_up?r:this.height-1-r,t=0;t<this.width;t++){var s=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*t;this.data[o]=i,this.data[o+1]=n,this.data[o+2]=s,this.data[o+3]=a}},hr.prototype.getData=function(){return this.data},function(r){r.processBMP=function(e,t,s,n){var i=new hr(e,!1),a=i.width,o=i.height,l={data:i.getData(),width:a,height:o},c=new Af(100).encode(l,100);return r.processJPEG.call(this,c,t,s,n)}}(Je.API),d0.prototype.getData=function(){return this.data},function(r){r.processWEBP=function(e,t,s,n){var i=new d0(e),a=i.width,o=i.height,l={data:i.getData(),width:a,height:o},c=new Af(100).encode(l,100);return r.processJPEG.call(this,c,t,s,n)}}(Je.API),Je.API.processRGBA=function(r,e,t){for(var s=r.data,n=s.length,i=new Uint8Array(n/4*3),a=new Uint8Array(n/4),o=0,l=0,c=0;c<n;c+=4){var h=s[c],d=s[c+1],p=s[c+2],f=s[c+3];i[o++]=h,i[o++]=d,i[o++]=p,a[l++]=f}var y=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(a),data:y,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:r.width,height:r.height}},Je.API.setLanguage=function(r){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[r]!==void 0&&(this.internal.languageSettings.languageCode=r,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},xo=Je.API,Zh=xo.getCharWidthsArray=function(r,e){var t,s,n=(e=e||{}).font||this.internal.getFont(),i=e.fontSize||this.internal.getFontSize(),a=e.charSpace||this.internal.getCharSpace(),o=e.widths?e.widths:n.metadata.Unicode.widths,l=o.fof?o.fof:1,c=e.kerning?e.kerning:n.metadata.Unicode.kerning,h=c.fof?c.fof:1,d=e.doKerning!==!1,p=0,f=r.length,y=0,w=o[0]||l,A=[];for(t=0;t<f;t++)s=r.charCodeAt(t),typeof n.metadata.widthOfString=="function"?A.push((n.metadata.widthOfGlyph(n.metadata.characterToGlyph(s))+a*(1e3/i)||0)/1e3):(p=d&&Bt(c[s])==="object"&&!isNaN(parseInt(c[s][y],10))?c[s][y]/h:0,A.push((o[s]||w)/l+p)),y=s;return A},l0=xo.getStringUnitWidth=function(r,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),s=e.font||this.internal.getFont(),n=e.charSpace||this.internal.getCharSpace();return xo.processArabic&&(r=xo.processArabic(r)),typeof s.metadata.widthOfString=="function"?s.metadata.widthOfString(r,t,n)/t:Zh.apply(this,arguments).reduce(function(i,a){return i+a},0)},c0=function(r,e,t,s){for(var n=[],i=0,a=r.length,o=0;i!==a&&o+e[i]<t;)o+=e[i],i++;n.push(r.slice(0,i));var l=i;for(o=0;i!==a;)o+e[i]>s&&(n.push(r.slice(l,i)),o=0,l=i),o+=e[i],i++;return l!==i&&n.push(r.slice(l,i)),n},h0=function(r,e,t){t||(t={});var s,n,i,a,o,l,c,h=[],d=[h],p=t.textIndent||0,f=0,y=0,w=r.split(" "),A=Zh.apply(this,[" ",t])[0];if(l=t.lineIndent===-1?w[0].length+2:t.lineIndent||0){var x=Array(l).join(" "),S=[];w.map(function(M){(M=M.split(/\s*\n/)).length>1?S=S.concat(M.map(function(B,Q){return(Q&&B.length?`
`:"")+B})):S.push(M[0])}),w=S,l=l0.apply(this,[x,t])}for(i=0,a=w.length;i<a;i++){var I=0;if(s=w[i],l&&s[0]==`
`&&(s=s.substr(1),I=1),p+f+(y=(n=Zh.apply(this,[s,t])).reduce(function(M,B){return M+B},0))>e||I){if(y>e){for(o=c0.apply(this,[s,n,e-(p+f),e]),h.push(o.shift()),h=[o.pop()];o.length;)d.push([o.shift()]);y=n.slice(s.length-(h[0]?h[0].length:0)).reduce(function(M,B){return M+B},0)}else h=[s];d.push(h),p=y+l,f=A}else h.push(s),p+=f+y,f=A}return c=l?function(M,B){return(B?x:"")+M.join(" ")}:function(M){return M.join(" ")},d.map(c)},xo.splitTextToSize=function(r,e,t){var s,n=(t=t||{}).fontSize||this.internal.getFontSize(),i=function(h){if(h.widths&&h.kerning)return{widths:h.widths,kerning:h.kerning};var d=this.internal.getFont(h.fontName,h.fontStyle);return d.metadata.Unicode?{widths:d.metadata.Unicode.widths||{0:1},kerning:d.metadata.Unicode.kerning||{}}:{font:d.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,t);s=Array.isArray(r)?r:String(r).split(/\r?\n/);var a=1*this.internal.scaleFactor*e/n;i.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/n:0,i.lineIndent=t.lineIndent;var o,l,c=[];for(o=0,l=s.length;o<l;o++)c=c.concat(h0.apply(this,[s[o],a,i]));return c},function(r){r.__fontmetrics__=r.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",t={},s={},n=0;n<e.length;n++)t[e[n]]="0123456789abcdef"[n],s["0123456789abcdef"[n]]=e[n];var i=function(d){return"0x"+parseInt(d,10).toString(16)},a=r.__fontmetrics__.compress=function(d){var p,f,y,w,A=["{"];for(var x in d){if(p=d[x],isNaN(parseInt(x,10))?f="'"+x+"'":(x=parseInt(x,10),f=(f=i(x).slice(2)).slice(0,-1)+s[f.slice(-1)]),typeof p=="number")p<0?(y=i(p).slice(3),w="-"):(y=i(p).slice(2),w=""),y=w+y.slice(0,-1)+s[y.slice(-1)];else{if(Bt(p)!=="object")throw new Error("Don't know what to do with value type "+Bt(p)+".");y=a(p)}A.push(f+y)}return A.push("}"),A.join("")},o=r.__fontmetrics__.uncompress=function(d){if(typeof d!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,f,y,w,A={},x=1,S=A,I=[],M="",B="",Q=d.length-1,U=1;U<Q;U+=1)(w=d[U])=="'"?p?(y=p.join(""),p=void 0):p=[]:p?p.push(w):w=="{"?(I.push([S,y]),S={},y=void 0):w=="}"?((f=I.pop())[0][f[1]]=S,y=void 0,S=f[0]):w=="-"?x=-1:y===void 0?t.hasOwnProperty(w)?(M+=t[w],y=parseInt(M,16)*x,x=1,M=""):M+=w:t.hasOwnProperty(w)?(B+=t[w],S[y]=parseInt(B,16)*x,x=1,y=void 0,B=""):B+=w;return A},l={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},c={Unicode:{Courier:l,"Courier-Bold":l,"Courier-BoldOblique":l,"Courier-Oblique":l,Helvetica:l,"Helvetica-Bold":l,"Helvetica-BoldOblique":l,"Helvetica-Oblique":l,"Times-Roman":l,"Times-Bold":l,"Times-BoldItalic":l,"Times-Italic":l}},h={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};r.events.push(["addFont",function(d){var p=d.font,f=h.Unicode[p.postScriptName];f&&(p.metadata.Unicode={},p.metadata.Unicode.widths=f.widths,p.metadata.Unicode.kerning=f.kerning);var y=c.Unicode[p.postScriptName];y&&(p.metadata.Unicode.encoding=y,p.encoding=y.codePages[0])}])}(Je.API),function(r){var e=function(t){for(var s=t.length,n=new Uint8Array(s),i=0;i<s;i++)n[i]=t.charCodeAt(i);return n};r.API.events.push(["addFont",function(t){var s=void 0,n=t.font,i=t.instance;if(!n.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");if(typeof(s=i.existsFileInVFS(n.postScriptName)===!1?i.loadFile(n.postScriptName):i.getFileFromVFS(n.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");(function(a,o){o=/^\x00\x01\x00\x00/.test(o)?e(o):e(cc(o)),a.metadata=r.API.TTFFont.open(o),a.metadata.Unicode=a.metadata.Unicode||{encoding:{},kerning:{},widths:[]},a.metadata.glyIdsUsed=[0]})(n,s)}}])}(Je),function(r){function e(){return(Ze.canvg?Promise.resolve(Ze.canvg):vi(()=>import("./index.es-DdhcYl14.js"),__vite__mapDeps([2,1,3]))).catch(function(t){return Promise.reject(new Error("Could not load canvg: "+t))}).then(function(t){return t.default?t.default:t})}Je.API.addSvgAsImage=function(t,s,n,i,a,o,l,c){if(isNaN(s)||isNaN(n))throw Gt.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(a))throw Gt.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var h=document.createElement("canvas");h.width=i,h.height=a;var d=h.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,h.width,h.height);var p={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return e().then(function(y){return y.fromString(d,t,p)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(y){return y.render(p)}).then(function(){f.addImage(h.toDataURL("image/jpeg",1),s,n,i,a,l,c)})}}(),Je.API.putTotalPages=function(r){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(r,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(r,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var s=1;s<=this.internal.getNumberOfPages();s++)for(var n=0;n<this.internal.pages[s].length;n++)this.internal.pages[s][n]=this.internal.pages[s][n].replace(e,t);return this},Je.API.viewerPreferences=function(r,e){var t;r=r||{},e=e||!1;var s,n,i,a={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(a),l=[],c=0,h=0,d=0;function p(y,w){var A,x=!1;for(A=0;A<y.length;A+=1)y[A]===w&&(x=!0);return x}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(a)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,r==="reset"||e===!0){var f=o.length;for(d=0;d<f;d+=1)t[o[d]].value=t[o[d]].defaultValue,t[o[d]].explicitSet=!1}if(Bt(r)==="object"){for(n in r)if(i=r[n],p(o,n)&&i!==void 0){if(t[n].type==="boolean"&&typeof i=="boolean")t[n].value=i;else if(t[n].type==="name"&&p(t[n].valueSet,i))t[n].value=i;else if(t[n].type==="integer"&&Number.isInteger(i))t[n].value=i;else if(t[n].type==="array"){for(c=0;c<i.length;c+=1)if(s=!0,i[c].length===1&&typeof i[c][0]=="number")l.push(String(i[c]-1));else if(i[c].length>1){for(h=0;h<i[c].length;h+=1)typeof i[c][h]!="number"&&(s=!1);s===!0&&l.push([i[c][0]-1,i[c][1]-1].join(" "))}t[n].value="["+l.join(" ")+"]"}else t[n].value=t[n].defaultValue;t[n].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var y,w=[];for(y in t)t[y].explicitSet===!0&&(t[y].type==="name"?w.push("/"+y+" /"+t[y].value):w.push("/"+y+" "+t[y].value));w.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+w.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},function(r){var e=function(){var s='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',n=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(s)),a=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),c=i.length+a.length+o.length+n.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+c+" >>"),this.internal.write("stream"),this.internal.write(n+i+a+o+l),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};r.addMetadata=function(s,n){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:s,namespaceuri:n||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}}(Je.API),function(r){var e=r.API,t=e.pdfEscape16=function(i,a){for(var o,l=a.metadata.Unicode.widths,c=["","0","00","000","0000"],h=[""],d=0,p=i.length;d<p;++d){if(o=a.metadata.characterToGlyph(i.charCodeAt(d)),a.metadata.glyIdsUsed.push(o),a.metadata.toUnicode[o]=i.charCodeAt(d),l.indexOf(o)==-1&&(l.push(o),l.push([parseInt(a.metadata.widthOfGlyph(o),10)])),o=="0")return h.join("");o=o.toString(16),h.push(c[4-o.length],o)}return h.join("")},s=function(i){var a,o,l,c,h,d,p;for(h=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],d=0,p=(o=Object.keys(i).sort(function(f,y){return f-y})).length;d<p;d++)a=o[d],l.length>=100&&(h+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),i[a]!==void 0&&i[a]!==null&&typeof i[a].toString=="function"&&(c=("0000"+i[a].toString(16)).slice(-4),a=("0000"+(+a).toString(16)).slice(-4),l.push("<"+a+"><"+c+">"));return l.length&&(h+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),h+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(i){(function(a){var o=a.font,l=a.out,c=a.newObject,h=a.putStream;if(o.metadata instanceof r.API.TTFFont&&o.encoding==="Identity-H"){for(var d=o.metadata.Unicode.widths,p=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),f="",y=0;y<p.length;y++)f+=String.fromCharCode(p[y]);var w=c();h({data:f,addLength1:!0,objectId:w}),l("endobj");var A=c();h({data:s(o.metadata.toUnicode),addLength1:!0,objectId:A}),l("endobj");var x=c();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+Eo(o.fontName)),l("/FontFile2 "+w+" 0 R"),l("/FontBBox "+r.API.PDFObject.convert(o.metadata.bbox)),l("/Flags "+o.metadata.flags),l("/StemV "+o.metadata.stemV),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l(">>"),l("endobj");var S=c();l("<<"),l("/Type /Font"),l("/BaseFont /"+Eo(o.fontName)),l("/FontDescriptor "+x+" 0 R"),l("/W "+r.API.PDFObject.convert(d)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+o.encoding+")"),l(">>"),l(">>"),l("endobj"),o.objectNumber=c(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+A+" 0 R"),l("/BaseFont /"+Eo(o.fontName)),l("/Encoding /"+o.encoding),l("/DescendantFonts ["+S+" 0 R]"),l(">>"),l("endobj"),o.isAlreadyPutted=!0}})(i)}]),e.events.push(["putFont",function(i){(function(a){var o=a.font,l=a.out,c=a.newObject,h=a.putStream;if(o.metadata instanceof r.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var d=o.metadata.rawData,p="",f=0;f<d.length;f++)p+=String.fromCharCode(d[f]);var y=c();h({data:p,addLength1:!0,objectId:y}),l("endobj");var w=c();h({data:s(o.metadata.toUnicode),addLength1:!0,objectId:w}),l("endobj");var A=c();l("<<"),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l("/StemV "+o.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+y+" 0 R"),l("/Flags 96"),l("/FontBBox "+r.API.PDFObject.convert(o.metadata.bbox)),l("/FontName /"+Eo(o.fontName)),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l(">>"),l("endobj"),o.objectNumber=c();for(var x=0;x<o.metadata.hmtx.widths.length;x++)o.metadata.hmtx.widths[x]=parseInt(o.metadata.hmtx.widths[x]*(1e3/o.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+w+" 0 R/BaseFont/"+Eo(o.fontName)+"/FontDescriptor "+A+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+r.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),l("endobj"),o.isAlreadyPutted=!0}})(i)}]);var n=function(i){var a,o=i.text||"",l=i.x,c=i.y,h=i.options||{},d=i.mutex||{},p=d.pdfEscape,f=d.activeFontKey,y=d.fonts,w=f,A="",x=0,S="",I=y[w].encoding;if(y[w].encoding!=="Identity-H")return{text:o,x:l,y:c,options:h,mutex:d};for(S=o,w=f,Array.isArray(o)&&(S=o[0]),x=0;x<S.length;x+=1)y[w].metadata.hasOwnProperty("cmap")&&(a=y[w].metadata.cmap.unicode.codeMap[S[x].charCodeAt(0)]),a||S[x].charCodeAt(0)<256&&y[w].metadata.hasOwnProperty("Unicode")?A+=S[x]:A+="";var M="";return parseInt(w.slice(1))<14||I==="WinAnsiEncoding"?M=p(A,w).split("").map(function(B){return B.charCodeAt(0).toString(16)}).join(""):I==="Identity-H"&&(M=t(A,y[w])),d.isHex=!0,{text:M,x:l,y:c,options:h,mutex:d}};e.events.push(["postProcessText",function(i){var a=i.text||"",o=[],l={text:a,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(a)){var c=0;for(c=0;c<a.length;c+=1)Array.isArray(a[c])&&a[c].length===3?o.push([n(Object.assign({},l,{text:a[c][0]})).text,a[c][1],a[c][2]]):o.push(n(Object.assign({},l,{text:a[c]})).text);i.text=o}else i.text=n(Object.assign({},l,{text:a})).text}])}(Je),function(r){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};r.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},r.addFileToVFS=function(t,s){return e.call(this),this.internal.vFS[t]=s,this},r.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}}(Je.API),function(r){r.__bidiEngine__=r.prototype.__bidiEngine__=function(s){var n,i,a,o,l,c,h,d=e,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],f=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],y={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},w={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},A=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],x=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),S=!1,I=0;this.__bidiEngine__={};var M=function(L){var j=L.charCodeAt(),V=j>>8,q=w[V];return q!==void 0?d[256*q+(255&j)]:V===252||V===253?"AL":x.test(V)?"L":V===8?"R":"N"},B=function(L){for(var j,V=0;V<L.length;V++){if((j=M(L.charAt(V)))==="L")return!1;if(j==="R")return!0}return!1},Q=function(L,j,V,q){var le,ae,te,K,fe=j[q];switch(fe){case"L":case"R":S=!1;break;case"N":case"AN":break;case"EN":S&&(fe="AN");break;case"AL":S=!0,fe="R";break;case"WS":fe="N";break;case"CS":q<1||q+1>=j.length||(le=V[q-1])!=="EN"&&le!=="AN"||(ae=j[q+1])!=="EN"&&ae!=="AN"?fe="N":S&&(ae="AN"),fe=ae===le?ae:"N";break;case"ES":fe=(le=q>0?V[q-1]:"B")==="EN"&&q+1<j.length&&j[q+1]==="EN"?"EN":"N";break;case"ET":if(q>0&&V[q-1]==="EN"){fe="EN";break}if(S){fe="N";break}for(te=q+1,K=j.length;te<K&&j[te]==="ET";)te++;fe=te<K&&j[te]==="EN"?"EN":"N";break;case"NSM":if(a&&!o){for(K=j.length,te=q+1;te<K&&j[te]==="NSM";)te++;if(te<K){var me=L[q],Ae=me>=1425&&me<=2303||me===64286;if(le=j[te],Ae&&(le==="R"||le==="AL")){fe="R";break}}}fe=q<1||(le=j[q-1])==="B"?"N":V[q-1];break;case"B":S=!1,n=!0,fe=I;break;case"S":i=!0,fe="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":S=!1;break;case"BN":fe="N"}return fe},U=function(L,j,V){var q=L.split("");return V&&O(q,V,{hiLevel:I}),q.reverse(),j&&j.reverse(),q.join("")},O=function(L,j,V){var q,le,ae,te,K,fe=-1,me=L.length,Ae=0,k=[],D=I?f:p,z=[];for(S=!1,n=!1,i=!1,le=0;le<me;le++)z[le]=M(L[le]);for(ae=0;ae<me;ae++){if(K=Ae,k[ae]=Q(L,z,k,ae),q=240&(Ae=D[K][y[k[ae]]]),Ae&=15,j[ae]=te=D[Ae][5],q>0)if(q===16){for(le=fe;le<ae;le++)j[le]=1;fe=-1}else fe=-1;if(D[Ae][6])fe===-1&&(fe=ae);else if(fe>-1){for(le=fe;le<ae;le++)j[le]=te;fe=-1}z[ae]==="B"&&(j[ae]=0),V.hiLevel|=te}i&&function(X,ee,ie){for(var ue=0;ue<ie;ue++)if(X[ue]==="S"){ee[ue]=I;for(var de=ue-1;de>=0&&X[de]==="WS";de--)ee[de]=I}}(z,j,me)},G=function(L,j,V,q,le){if(!(le.hiLevel<L)){if(L===1&&I===1&&!n)return j.reverse(),void(V&&V.reverse());for(var ae,te,K,fe,me=j.length,Ae=0;Ae<me;){if(q[Ae]>=L){for(K=Ae+1;K<me&&q[K]>=L;)K++;for(fe=Ae,te=K-1;fe<te;fe++,te--)ae=j[fe],j[fe]=j[te],j[te]=ae,V&&(ae=V[fe],V[fe]=V[te],V[te]=ae);Ae=K}Ae++}}},ne=function(L,j,V){var q=L.split(""),le={hiLevel:I};return V||(V=[]),O(q,V,le),function(ae,te,K){if(K.hiLevel!==0&&h)for(var fe,me=0;me<ae.length;me++)te[me]===1&&(fe=A.indexOf(ae[me]))>=0&&(ae[me]=A[fe+1])}(q,V,le),G(2,q,j,V,le),G(1,q,j,V,le),q.join("")};return this.__bidiEngine__.doBidiReorder=function(L,j,V){if(function(le,ae){if(ae)for(var te=0;te<le.length;te++)ae[te]=te;o===void 0&&(o=B(le)),c===void 0&&(c=B(le))}(L,j),a||!l||c)if(a&&l&&o^c)I=o?1:0,L=U(L,j,V);else if(!a&&l&&c)I=o?1:0,L=ne(L,j,V),L=U(L,j);else if(!a||o||l||c){if(a&&!l&&o^c)L=U(L,j),o?(I=0,L=ne(L,j,V)):(I=1,L=ne(L,j,V),L=U(L,j));else if(a&&o&&!l&&c)I=1,L=ne(L,j,V),L=U(L,j);else if(!a&&!l&&o^c){var q=h;o?(I=1,L=ne(L,j,V),I=0,h=!1,L=ne(L,j,V),h=q):(I=0,L=ne(L,j,V),L=U(L,j),I=1,h=!1,L=ne(L,j,V),h=q,L=U(L,j))}}else I=0,L=ne(L,j,V);else I=o?1:0,L=ne(L,j,V);return L},this.__bidiEngine__.setOptions=function(L){L&&(a=L.isInputVisual,l=L.isOutputVisual,o=L.isInputRtl,c=L.isOutputRtl,h=L.isSymmetricSwapping)},this.__bidiEngine__.setOptions(s),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new r.__bidiEngine__({isInputVisual:!0});r.API.events.push(["postProcessText",function(s){var n=s.text,i=(s.x,s.y,s.options||{}),a=(s.mutex,i.lang,[]);if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,t.setOptions(i),Object.prototype.toString.call(n)==="[object Array]"){var o=0;for(a=[],o=0;o<n.length;o+=1)Object.prototype.toString.call(n[o])==="[object Array]"?a.push([t.doBidiReorder(n[o][0]),n[o][1],n[o][2]]):a.push([t.doBidiReorder(n[o])]);s.text=a}else s.text=t.doBidiReorder(n);t.setOptions({isInputVisual:!0})}])}(Je),Je.API.TTFFont=function(){function r(e){var t;if(this.rawData=e,t=this.contents=new Yi(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new L4(this),this.registerTTF()}return r.open=function(e){return new r(e)},r.prototype.parse=function(){return this.directory=new g4(this.contents),this.head=new v4(this),this.name=new A4(this),this.cmap=new Tb(this),this.toUnicode={},this.hhea=new y4(this),this.maxp=new S4(this),this.hmtx=new N4(this),this.post=new x4(this),this.os2=new w4(this),this.loca=new P4(this),this.glyf=new E4(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},r.prototype.registerTTF=function(){var e,t,s,n,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var a,o,l,c;for(c=[],a=0,o=(l=this.bbox).length;a<o;a++)e=l[a],c.push(Math.round(e*this.scaleFactor));return c}.call(this),this.stemV=0,this.post.exists?(s=255&(n=this.post.italic_angle),32768&(t=n>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+s)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},r.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},r.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},r.prototype.widthOfString=function(e,t,s){var n,i,a,o;for(a=0,i=0,o=(e=""+e).length;0<=o?i<o:i>o;i=0<=o?++i:--i)n=e.charCodeAt(i),a+=this.widthOfGlyph(this.characterToGlyph(n))+s*(1e3/t)||0;return a*(t/1e3)},r.prototype.lineHeight=function(e,t){var s;return t==null&&(t=!1),s=t?this.lineGap:0,(this.ascender+s-this.decender)/1e3*e},r}();var Nr,Yi=function(){function r(e){this.data=e??[],this.pos=0,this.length=this.data.length}return r.prototype.readByte=function(){return this.data[this.pos++]},r.prototype.writeByte=function(e){return this.data[this.pos++]=e},r.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},r.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},r.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},r.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},r.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},r.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},r.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},r.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},r.prototype.readString=function(e){var t,s;for(s=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)s[t]=String.fromCharCode(this.readByte());return s.join("")},r.prototype.writeString=function(e){var t,s,n;for(n=[],t=0,s=e.length;0<=s?t<s:t>s;t=0<=s?++t:--t)n.push(this.writeByte(e.charCodeAt(t)));return n},r.prototype.readShort=function(){return this.readInt16()},r.prototype.writeShort=function(e){return this.writeInt16(e)},r.prototype.readLongLong=function(){var e,t,s,n,i,a,o,l;return e=this.readByte(),t=this.readByte(),s=this.readByte(),n=this.readByte(),i=this.readByte(),a=this.readByte(),o=this.readByte(),l=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^s)+4294967296*(255^n)+16777216*(255^i)+65536*(255^a)+256*(255^o)+(255^l)+1):72057594037927940*e+281474976710656*t+1099511627776*s+4294967296*n+16777216*i+65536*a+256*o+l},r.prototype.writeLongLong=function(e){var t,s;return t=Math.floor(e/4294967296),s=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(s>>24&255),this.writeByte(s>>16&255),this.writeByte(s>>8&255),this.writeByte(255&s)},r.prototype.readInt=function(){return this.readInt32()},r.prototype.writeInt=function(e){return this.writeInt32(e)},r.prototype.read=function(e){var t,s;for(t=[],s=0;0<=e?s<e:s>e;s=0<=e?++s:--s)t.push(this.readByte());return t},r.prototype.write=function(e){var t,s,n,i;for(i=[],s=0,n=e.length;s<n;s++)t=e[s],i.push(this.writeByte(t));return i},r}(),g4=function(){var r;function e(t){var s,n,i;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},n=0,i=this.tableCount;0<=i?n<i:n>i;n=0<=i?++n:--n)s={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[s.tag]=s}return e.prototype.encode=function(t){var s,n,i,a,o,l,c,h,d,p,f,y,w;for(w in f=Object.keys(t).length,l=Math.log(2),d=16*Math.floor(Math.log(f)/l),a=Math.floor(d/l),h=16*f-d,(n=new Yi).writeInt(this.scalarType),n.writeShort(f),n.writeShort(d),n.writeShort(a),n.writeShort(h),i=16*f,c=n.pos+i,o=null,y=[],t)for(p=t[w],n.writeString(w),n.writeInt(r(p)),n.writeInt(c),n.writeInt(p.length),y=y.concat(p),w==="head"&&(o=c),c+=p.length;c%4;)y.push(0),c++;return n.write(y),s=2981146554-r(n.data),n.pos=o+8,n.writeUInt32(s),n.data},r=function(t){var s,n,i,a;for(t=Ib.call(t);t.length%4;)t.push(0);for(i=new Yi(t),n=0,s=0,a=t.length;s<a;s=s+=4)n+=i.readUInt32();return 4294967295&n},e}(),b4={}.hasOwnProperty,Jr=function(r,e){for(var t in e)b4.call(e,t)&&(r[t]=e[t]);function s(){this.constructor=r}return s.prototype=e.prototype,r.prototype=new s,r.__super__=e.prototype,r};Nr=function(){function r(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return r.prototype.parse=function(){},r.prototype.encode=function(){},r.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},r}();var v4=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Jr(e,Nr),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var s;return(s=new Yi).writeInt(this.version),s.writeInt(this.revision),s.writeInt(this.checkSumAdjustment),s.writeInt(this.magicNumber),s.writeShort(this.flags),s.writeShort(this.unitsPerEm),s.writeLongLong(this.created),s.writeLongLong(this.modified),s.writeShort(this.xMin),s.writeShort(this.yMin),s.writeShort(this.xMax),s.writeShort(this.yMax),s.writeShort(this.macStyle),s.writeShort(this.lowestRecPPEM),s.writeShort(this.fontDirectionHint),s.writeShort(t),s.writeShort(this.glyphDataFormat),s.data},e}(),f0=function(){function r(e,t){var s,n,i,a,o,l,c,h,d,p,f,y,w,A,x,S,I;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),d=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=e.readByte();break;case 4:for(f=e.readUInt16(),p=f/2,e.pos+=6,i=function(){var M,B;for(B=[],l=M=0;0<=p?M<p:M>p;l=0<=p?++M:--M)B.push(e.readUInt16());return B}(),e.pos+=2,w=function(){var M,B;for(B=[],l=M=0;0<=p?M<p:M>p;l=0<=p?++M:--M)B.push(e.readUInt16());return B}(),c=function(){var M,B;for(B=[],l=M=0;0<=p?M<p:M>p;l=0<=p?++M:--M)B.push(e.readUInt16());return B}(),h=function(){var M,B;for(B=[],l=M=0;0<=p?M<p:M>p;l=0<=p?++M:--M)B.push(e.readUInt16());return B}(),n=(this.length-e.pos+this.offset)/2,o=function(){var M,B;for(B=[],l=M=0;0<=n?M<n:M>n;l=0<=n?++M:--M)B.push(e.readUInt16());return B}(),l=x=0,I=i.length;x<I;l=++x)for(A=i[l],s=S=y=w[l];y<=A?S<=A:S>=A;s=y<=A?++S:--S)h[l]===0?a=s+c[l]:(a=o[h[l]/2+(s-y)-(p-l)]||0)!==0&&(a+=c[l]),this.codeMap[s]=65535&a}e.pos=d}return r.encode=function(e,t){var s,n,i,a,o,l,c,h,d,p,f,y,w,A,x,S,I,M,B,Q,U,O,G,ne,L,j,V,q,le,ae,te,K,fe,me,Ae,k,D,z,X,ee,ie,ue,de,ke,Ee,Re;switch(q=new Yi,a=Object.keys(e).sort(function(Le,Ke){return Le-Ke}),t){case"macroman":for(w=0,A=function(){var Le=[];for(y=0;y<256;++y)Le.push(0);return Le}(),S={0:0},i={},le=0,fe=a.length;le<fe;le++)S[de=e[n=a[le]]]==null&&(S[de]=++w),i[n]={old:e[n],new:S[e[n]]},A[n]=S[e[n]];return q.writeUInt16(1),q.writeUInt16(0),q.writeUInt32(12),q.writeUInt16(0),q.writeUInt16(262),q.writeUInt16(0),q.write(A),{charMap:i,subtable:q.data,maxGlyphID:w+1};case"unicode":for(j=[],d=[],I=0,S={},s={},x=c=null,ae=0,me=a.length;ae<me;ae++)S[B=e[n=a[ae]]]==null&&(S[B]=++I),s[n]={old:B,new:S[B]},o=S[B]-n,x!=null&&o===c||(x&&d.push(x),j.push(n),c=o),x=n;for(x&&d.push(x),d.push(65535),j.push(65535),ne=2*(G=j.length),O=2*Math.pow(Math.log(G)/Math.LN2,2),p=Math.log(O/2)/Math.LN2,U=2*G-O,l=[],Q=[],f=[],y=te=0,Ae=j.length;te<Ae;y=++te){if(L=j[y],h=d[y],L===65535){l.push(0),Q.push(0);break}if(L-(V=s[L].new)>=32768)for(l.push(0),Q.push(2*(f.length+G-y)),n=K=L;L<=h?K<=h:K>=h;n=L<=h?++K:--K)f.push(s[n].new);else l.push(V-L),Q.push(0)}for(q.writeUInt16(3),q.writeUInt16(1),q.writeUInt32(12),q.writeUInt16(4),q.writeUInt16(16+8*G+2*f.length),q.writeUInt16(0),q.writeUInt16(ne),q.writeUInt16(O),q.writeUInt16(p),q.writeUInt16(U),ie=0,k=d.length;ie<k;ie++)n=d[ie],q.writeUInt16(n);for(q.writeUInt16(0),ue=0,D=j.length;ue<D;ue++)n=j[ue],q.writeUInt16(n);for(ke=0,z=l.length;ke<z;ke++)o=l[ke],q.writeUInt16(o);for(Ee=0,X=Q.length;Ee<X;Ee++)M=Q[Ee],q.writeUInt16(M);for(Re=0,ee=f.length;Re<ee;Re++)w=f[Re],q.writeUInt16(w);return{charMap:s,subtable:q.data,maxGlyphID:I+1}}},r}(),Tb=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Jr(e,Nr),e.prototype.tag="cmap",e.prototype.parse=function(t){var s,n,i;for(t.pos=this.offset,this.version=t.readUInt16(),i=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=i?n<i:n>i;n=0<=i?++n:--n)s=new f0(t,this.offset),this.tables.push(s),s.isUnicode&&this.unicode==null&&(this.unicode=s);return!0},e.encode=function(t,s){var n,i;return s==null&&(s="macroman"),n=f0.encode(t,s),(i=new Yi).writeUInt16(0),i.writeUInt16(1),n.table=i.data.concat(n.subtable),n},e}(),y4=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Jr(e,Nr),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),w4=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Jr(e,Nr),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var s,n;for(n=[],s=0;s<10;++s)n.push(t.readByte());return n}(),this.charRange=function(){var s,n;for(n=[],s=0;s<4;++s)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var s,n;for(n=[],s=0;s<2;s=++s)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),x4=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Jr(e,Nr),e.prototype.tag="post",e.prototype.parse=function(t){var s,n,i;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:break;case 131072:var a;for(n=t.readUInt16(),this.glyphNameIndex=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],i=[];t.pos<this.offset+this.length;)s=t.readByte(),i.push(this.names.push(t.readString(s)));return i;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 196608:break;case 262144:return this.map=function(){var o,l,c;for(c=[],a=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;a=0<=l?++o:--o)c.push(t.readUInt32());return c}.call(this)}},e}(),_4=function(r,e){this.raw=r,this.length=r.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},A4=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Jr(e,Nr),e.prototype.tag="name",e.prototype.parse=function(t){var s,n,i,a,o,l,c,h,d,p,f;for(t.pos=this.offset,t.readShort(),s=t.readShort(),l=t.readShort(),n=[],a=0;0<=s?a<s:a>s;a=0<=s?++a:--a)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+l+t.readShort()});for(c={},a=d=0,p=n.length;d<p;a=++d)i=n[a],t.pos=i.offset,h=t.readString(i.length),o=new _4(h,i),c[f=i.nameID]==null&&(c[f]=[]),c[i.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},e}(),S4=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Jr(e,Nr),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),N4=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Jr(e,Nr),e.prototype.tag="hmtx",e.prototype.parse=function(t){var s,n,i,a,o,l,c;for(t.pos=this.offset,this.metrics=[],s=0,l=this.file.hhea.numberOfMetrics;0<=l?s<l:s>l;s=0<=l?++s:--s)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var h,d;for(d=[],s=h=0;0<=i?h<i:h>i;s=0<=i?++h:--h)d.push(t.readInt16());return d}(),this.widths=function(){var h,d,p,f;for(f=[],h=0,d=(p=this.metrics).length;h<d;h++)a=p[h],f.push(a.advance);return f}.call(this),n=this.widths[this.widths.length-1],c=[],s=o=0;0<=i?o<i:o>i;s=0<=i?++o:--o)c.push(this.widths.push(n));return c},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),Ib=[].slice,E4=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Jr(e,Nr),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var s,n,i,a,o,l,c,h,d,p;return t in this.cache?this.cache[t]:(a=this.file.loca,s=this.file.contents,n=a.indexOf(t),(i=a.lengthOf(t))===0?this.cache[t]=null:(s.pos=this.offset+n,o=(l=new Yi(s.read(i))).readShort(),h=l.readShort(),p=l.readShort(),c=l.readShort(),d=l.readShort(),this.cache[t]=o===-1?new C4(l,h,p,c,d):new k4(l,o,h,p,c,d),this.cache[t]))},e.prototype.encode=function(t,s,n){var i,a,o,l,c;for(o=[],a=[],l=0,c=s.length;l<c;l++)i=t[s[l]],a.push(o.length),i&&(o=o.concat(i.encode(n)));return a.push(o.length),{table:o,offsets:a}},e}(),k4=function(){function r(e,t,s,n,i,a){this.raw=e,this.numberOfContours=t,this.xMin=s,this.yMin=n,this.xMax=i,this.yMax=a,this.compound=!1}return r.prototype.encode=function(){return this.raw.data},r}(),C4=function(){function r(e,t,s,n,i){var a,o;for(this.raw=e,this.xMin=t,this.yMin=s,this.xMax=n,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],a=this.raw;o=a.readShort(),this.glyphOffsets.push(a.pos),this.glyphIDs.push(a.readUInt16()),32&o;)a.pos+=1&o?4:2,128&o?a.pos+=8:64&o?a.pos+=4:8&o&&(a.pos+=2)}return r.prototype.encode=function(){var e,t,s;for(t=new Yi(Ib.call(this.raw.data)),e=0,s=this.glyphIDs.length;e<s;++e)t.pos=this.glyphOffsets[e];return t.data},r}(),P4=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Jr(e,Nr),e.prototype.tag="loca",e.prototype.parse=function(t){var s,n;return t.pos=this.offset,s=this.file.head.indexToLocFormat,this.offsets=s===0?function(){var i,a;for(a=[],n=0,i=this.length;n<i;n+=2)a.push(2*t.readUInt16());return a}.call(this):function(){var i,a;for(a=[],n=0,i=this.length;n<i;n+=4)a.push(t.readUInt32());return a}.call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,s){for(var n=new Uint32Array(this.offsets.length),i=0,a=0,o=0;o<n.length;++o)if(n[o]=i,a<s.length&&s[a]==o){++a,n[o]=i;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(i+=c)}for(var h=new Array(4*n.length),d=0;d<n.length;++d)h[4*d+3]=255&n[d],h[4*d+2]=(65280&n[d])>>8,h[4*d+1]=(16711680&n[d])>>16,h[4*d]=(4278190080&n[d])>>24;return h},e}(),L4=function(){function r(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return r.prototype.generateCmap=function(){var e,t,s,n,i;for(t in n=this.font.cmap.tables[0].codeMap,e={},i=this.subset)s=i[t],e[t]=n[s];return e},r.prototype.glyphsFor=function(e){var t,s,n,i,a,o,l;for(n={},a=0,o=e.length;a<o;a++)n[i=e[a]]=this.font.glyf.glyphFor(i);for(i in t=[],n)(s=n[i])!=null&&s.compound&&t.push.apply(t,s.glyphIDs);if(t.length>0)for(i in l=this.glyphsFor(t))s=l[i],n[i]=s;return n},r.prototype.encode=function(e,t){var s,n,i,a,o,l,c,h,d,p,f,y,w,A,x;for(n in s=Tb.encode(this.generateCmap(),"unicode"),a=this.glyphsFor(e),f={0:0},x=s.charMap)f[(l=x[n]).old]=l.new;for(y in p=s.maxGlyphID,a)y in f||(f[y]=p++);return h=function(S){var I,M;for(I in M={},S)M[S[I]]=I;return M}(f),d=Object.keys(h).sort(function(S,I){return S-I}),w=function(){var S,I,M;for(M=[],S=0,I=d.length;S<I;S++)o=d[S],M.push(h[o]);return M}(),i=this.font.glyf.encode(a,w,f),c=this.font.loca.encode(i.offsets,w),A={cmap:this.font.cmap.raw(),glyf:i.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(A["OS/2"]=this.font.os2.raw()),this.font.directory.encode(A)},r}();Je.API.PDFObject=function(){var r;function e(){}return r=function(t,s){return(Array(s+1).join("0")+t).slice(-s)},e.convert=function(t){var s,n,i,a;if(Array.isArray(t))return"["+function(){var o,l,c;for(c=[],o=0,l=t.length;o<l;o++)s=t[o],c.push(e.convert(s));return c}().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t?.isString)return"("+t+")";if(t instanceof Date)return"(D:"+r(t.getUTCFullYear(),4)+r(t.getUTCMonth(),2)+r(t.getUTCDate(),2)+r(t.getUTCHours(),2)+r(t.getUTCMinutes(),2)+r(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(n in i=["<<"],t)a=t[n],i.push("/"+n+" "+e.convert(a));return i.push(">>"),i.join(`
`)}return""+t},e}();async function T4(r){const{data:e}=await lt.from("candidates").select("name").eq("id",r.candidate_id).single(),{data:t}=await lt.from("jobs").select("title").eq("id",r.job_id).single(),s=new Je,n=s.internal.pageSize.getWidth(),i=s.internal.pageSize.getHeight();let a=30;const o=25,l=8;let c=1;const h={title:24,subTitle:18,heading:16,subHeading:14,normal:12,small:10},d=(U,O=!1)=>{s.setFontSize(U),s.setTextColor(0,0,0),s.setFont("helvetica",O?"bold":"normal")},p=(U,O,G=n-2*o)=>{const ne=s.splitTextToSize(U,G);let L=O;for(let j=0;j<ne.length;j++)L>i-40&&(y(c),s.addPage(),c++,f(),d(h.normal),L=30),s.text(ne[j],o,L),L+=l;return L},f=()=>{s.setTextColor(220,220,220),s.setFontSize(50),s.text("TopMatchTalent.com",n/2,i/2,{align:"center",angle:45}),d(h.normal)},y=U=>{s.setFontSize(h.small),s.setTextColor(128,128,128),s.text(`Page ${U}`,n/2,i-15,{align:"center"}),d(h.normal)},w=U=>{if(typeof U=="string"){const O=U.replace(/^RISK_FACTORS:\s*/i,"").trim();try{const q=JSON.parse(O);if(q&&typeof q=="object")return{severity:(q.severity||"MEDIUM").toUpperCase(),description:q.description||"",mitigation:q.mitigation||void 0}}catch{}const G=/^-\s*Severity:\s*\[?(HIGH|MEDIUM|LOW)\]?\s*\n\s*\*\s*Description:\s*\[?([^\n\]]+)\]?\s*\n\s*\*\s*Mitigation:\s*\[?([^\n\]]+)\]?/im,ne=O.match(G);if(ne){const[,q,le,ae]=ne;return{severity:q.toUpperCase(),description:le.trim(),mitigation:ae?.trim()}}const L=O.match(/Severity:\s*\[?(HIGH|MEDIUM|LOW)\]?/i),j=O.match(/Description:\s*\[?([^\n\]]+)\]?/i),V=O.match(/Mitigation:\s*\[?([^\n\]]+)\]?/i);return L||j?{severity:L?.[1]?.toUpperCase()||"MEDIUM",description:j?.[1]?.trim()||O,mitigation:V?.[1]?.trim()}:{severity:"MEDIUM",description:O}}return U};f(),d(h.title,!0),s.text("Analysis Report",o,a),a+=20,d(h.subTitle,!0);const A=e?.name||`Candidate ID: ${r.candidate_id}`;s.text(`Candidate: ${A}`,o,a),a+=10;const x=t?.title||`Job ID: ${r.job_id}`;if(s.text(`Position: ${x}`,o,a),a+=20,d(h.normal),s.text("Date: "+new Date(r.created_at??"").toLocaleDateString(),o,a),a+=25,d(h.subHeading,!0),s.text("Fit Score:",o,a),d(h.subTitle),s.text(r.fit_score+"/10",o+70,a),a+=15,d(h.subHeading,!0),s.text("Verdict:",o,a),d(h.subTitle),s.text(r.verdict.replace(/_/g," "),o+70,a),a+=25,d(h.heading,!0),s.text("Key Findings",o,a),a+=10,d(h.normal),r.reasoning.forEach(U=>{a=p("• "+U,a),a+=5}),a+=15,d(h.heading,!0),s.text("Risk Factors",o,a),a+=10,d(h.normal),!r.risk_factors||r.risk_factors.length===0)a=p("No significant risk factors identified.",a);else{const U=r.risk_factors.map(O=>w(O)).filter(O=>O!==null);U.length===0?a=p("No significant risk factors identified.",a):U.forEach(O=>{d(h.normal,!0),a=p(`• ${O.severity}:`,a),d(h.normal),a=p(O.description,a),O.mitigation&&(a=p(`  Mitigation: ${O.mitigation}`,a)),a+=5})}a+=15,d(h.heading,!0),s.text("Interview Plan",o,a),a+=10,d(h.normal),a=p(r.interview_plan,a),y(c),s.setFontSize(h.small),s.setTextColor(100,100,100),s.text("Generated by TopMatchTalent.com",n/2,i-25,{align:"center"});const I=new Date().toISOString().split("T")[0],M=e?.name?.replace(/[^a-z0-9]/gi,"_").toLowerCase()||"unnamed",B=t?.title?.replace(/[^a-z0-9]/gi,"_").toLowerCase()||"no_position",Q=`analysis_report_${M}_x_${B}_${I}.pdf`;s.save(Q)}function jb({analysis:r}){const[e,t]=W.useState(!1),s=async()=>{try{t(!0),await T4(r)}catch(n){console.error("Failed to export PDF:",n)}finally{t(!1)}};return g.jsxs("button",{onClick:s,disabled:e,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[g.jsx(_y,{className:`h-5 w-5 mr-2 ${e?"animate-bounce":"text-gray-500"}`}),e?"Exporting...":"Export PDF"]})}function I4({verdict:r,reasoning:e}){const s={STRONG_FIT:{border:"border-green-200",bg:"bg-green-50",icon:By,iconColor:"text-green-600",title:"Strong Fit",titleColor:"text-green-800",textColor:"text-green-700",dotColor:"bg-green-600"},POTENTIAL_FIT:{border:"border-yellow-200",bg:"bg-yellow-50",icon:ag,iconColor:"text-yellow-600",title:"Potential Fit",titleColor:"text-yellow-800",textColor:"text-yellow-700",dotColor:"bg-yellow-600"},NEEDS_CONSIDERATION:{border:"border-yellow-200",bg:"bg-yellow-50",icon:ag,iconColor:"text-yellow-600",title:"Needs Consideration",titleColor:"text-yellow-800",textColor:"text-yellow-700",dotColor:"bg-yellow-600"},NOT_RECOMMENDED:{border:"border-red-200",bg:"bg-red-50",icon:gw,iconColor:"text-red-600",title:"Not Recommended",titleColor:"text-red-800",textColor:"text-red-700",dotColor:"bg-red-600"}}[r],n=s.icon;return g.jsxs("div",{className:`p-6 rounded-lg border ${s.border} ${s.bg}`,children:[g.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[g.jsx(n,{className:`h-6 w-6 ${s.iconColor}`}),g.jsx("h3",{className:`font-semibold ${s.titleColor}`,children:s.title})]}),g.jsx("div",{className:"space-y-2",children:e.map((i,a)=>g.jsxs("div",{className:"flex items-start space-x-2",children:[g.jsx("span",{className:`mt-1.5 h-1.5 w-1.5 rounded-full ${s.dotColor}`}),g.jsx("p",{className:`text-sm ${s.textColor}`,children:i})]},a))})]})}function Hl({title:r,children:e,defaultExpanded:t=!1}){const[s,n]=W.useState(t),[i,a]=W.useState(!1);return g.jsxs("div",{className:`bg-white rounded-xl border border-gray-200 shadow-sm 
        ${s?"ring-2 ring-blue-100":""} 
        ${i?"border-blue-200":""}
        transition-all duration-200 ease-in-out hover:shadow-md`,onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),children:[g.jsxs("button",{onClick:()=>n(!s),className:"w-full flex justify-between items-center text-left p-6",children:[g.jsxs("div",{className:"flex items-center space-x-3",children:[s?g.jsx(Du,{className:`h-5 w-5 ${i?"text-blue-500":"text-gray-400"} transition-colors`}):g.jsx(Zo,{className:`h-5 w-5 ${i?"text-blue-500":"text-gray-400"} transition-colors`}),g.jsx("h3",{className:`text-lg font-semibold ${i?"text-blue-600":"text-gray-900"} transition-colors`,children:r})]}),g.jsx("div",{className:`text-xs font-medium px-2 py-1 rounded-full 
          ${s?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-600"} 
          transition-colors`,children:s?"Hide":"Show"})]}),g.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out
          ${s?"max-h-[2000px] opacity-100":"max-h-0 opacity-0"}`,children:g.jsx("div",{className:`px-6 pb-6 border-t border-gray-100 
          ${s?"pt-4":""}`,children:e})})]})}function Rb({analysis:r}){return g.jsxs("div",{className:"space-y-6",children:[g.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50 rounded-xl p-6 shadow-sm",children:[g.jsx(A3,{score:r.fit_score,verdict:r.verdict}),g.jsx("div",{className:"mt-6",children:g.jsx(I4,{verdict:r.verdict,reasoning:r.reasoning})})]}),g.jsxs("div",{className:"space-y-4",children:[g.jsx(Hl,{title:"Candidate X Position",defaultExpanded:!1,children:g.jsx(C3,{analysis:r})}),g.jsx(Hl,{title:"Technical Analysis",defaultExpanded:!1,children:g.jsx(S3,{analysis:r})}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[g.jsx(Hl,{title:"Risk Factors",defaultExpanded:!1,children:g.jsx(N3,{factors:r.risk_factors})}),g.jsx(Hl,{title:"Growth Potential",defaultExpanded:!1,children:g.jsx(E3,{potential:r.growth_potential})})]}),g.jsx(Hl,{title:"Interview Plan",defaultExpanded:!1,children:g.jsx(k3,{plan:r.interview_plan})})]}),g.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50 rounded-xl p-6 shadow-sm",children:[g.jsx(j3,{analysis:r}),g.jsx("div",{className:"mt-6",children:g.jsx(jb,{analysis:r})})]})]})}var Ct;(function(r){r.assertEqual=n=>n;function e(n){}r.assertIs=e;function t(n){throw new Error}r.assertNever=t,r.arrayToEnum=n=>{const i={};for(const a of n)i[a]=a;return i},r.getValidEnumValues=n=>{const i=r.objectKeys(n).filter(o=>typeof n[n[o]]!="number"),a={};for(const o of i)a[o]=n[o];return r.objectValues(a)},r.objectValues=n=>r.objectKeys(n).map(function(i){return n[i]}),r.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{const i=[];for(const a in n)Object.prototype.hasOwnProperty.call(n,a)&&i.push(a);return i},r.find=(n,i)=>{for(const a of n)if(i(a))return a},r.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function s(n,i=" | "){return n.map(a=>typeof a=="string"?`'${a}'`:a).join(i)}r.joinValues=s,r.jsonStringifyReplacer=(n,i)=>typeof i=="bigint"?i.toString():i})(Ct||(Ct={}));var cp;(function(r){r.mergeShapes=(e,t)=>({...e,...t})})(cp||(cp={}));const Be=Ct.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),bi=r=>{switch(typeof r){case"undefined":return Be.undefined;case"string":return Be.string;case"number":return isNaN(r)?Be.nan:Be.number;case"boolean":return Be.boolean;case"function":return Be.function;case"bigint":return Be.bigint;case"symbol":return Be.symbol;case"object":return Array.isArray(r)?Be.array:r===null?Be.null:r.then&&typeof r.then=="function"&&r.catch&&typeof r.catch=="function"?Be.promise:typeof Map<"u"&&r instanceof Map?Be.map:typeof Set<"u"&&r instanceof Set?Be.set:typeof Date<"u"&&r instanceof Date?Be.date:Be.object;default:return Be.unknown}},Se=Ct.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),j4=r=>JSON.stringify(r,null,2).replace(/"([^"]+)":/g,"$1:");class Dn extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(i){return i.message},s={_errors:[]},n=i=>{for(const a of i.issues)if(a.code==="invalid_union")a.unionErrors.map(n);else if(a.code==="invalid_return_type")n(a.returnTypeError);else if(a.code==="invalid_arguments")n(a.argumentsError);else if(a.path.length===0)s._errors.push(t(a));else{let o=s,l=0;for(;l<a.path.length;){const c=a.path[l];l===a.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(t(a))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return n(this),s}static assert(e){if(!(e instanceof Dn))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ct.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},s=[];for(const n of this.issues)n.path.length>0?(t[n.path[0]]=t[n.path[0]]||[],t[n.path[0]].push(e(n))):s.push(e(n));return{formErrors:s,fieldErrors:t}}get formErrors(){return this.flatten()}}Dn.create=r=>new Dn(r);const Go=(r,e)=>{let t;switch(r.code){case Se.invalid_type:r.received===Be.undefined?t="Required":t=`Expected ${r.expected}, received ${r.received}`;break;case Se.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(r.expected,Ct.jsonStringifyReplacer)}`;break;case Se.unrecognized_keys:t=`Unrecognized key(s) in object: ${Ct.joinValues(r.keys,", ")}`;break;case Se.invalid_union:t="Invalid input";break;case Se.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${Ct.joinValues(r.options)}`;break;case Se.invalid_enum_value:t=`Invalid enum value. Expected ${Ct.joinValues(r.options)}, received '${r.received}'`;break;case Se.invalid_arguments:t="Invalid function arguments";break;case Se.invalid_return_type:t="Invalid function return type";break;case Se.invalid_date:t="Invalid date";break;case Se.invalid_string:typeof r.validation=="object"?"includes"in r.validation?(t=`Invalid input: must include "${r.validation.includes}"`,typeof r.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${r.validation.position}`)):"startsWith"in r.validation?t=`Invalid input: must start with "${r.validation.startsWith}"`:"endsWith"in r.validation?t=`Invalid input: must end with "${r.validation.endsWith}"`:Ct.assertNever(r.validation):r.validation!=="regex"?t=`Invalid ${r.validation}`:t="Invalid";break;case Se.too_small:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at least":"more than"} ${r.minimum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at least":"over"} ${r.minimum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(r.minimum))}`:t="Invalid input";break;case Se.too_big:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at most":"less than"} ${r.maximum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at most":"under"} ${r.maximum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="bigint"?t=`BigInt must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly":r.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(r.maximum))}`:t="Invalid input";break;case Se.custom:t="Invalid input";break;case Se.invalid_intersection_types:t="Intersection results could not be merged";break;case Se.not_multiple_of:t=`Number must be a multiple of ${r.multipleOf}`;break;case Se.not_finite:t="Number must be finite";break;default:t=e.defaultError,Ct.assertNever(r)}return{message:t}};let Ob=Go;function R4(r){Ob=r}function Eu(){return Ob}const ku=r=>{const{data:e,path:t,errorMaps:s,issueData:n}=r,i=[...t,...n.path||[]],a={...n,path:i};if(n.message!==void 0)return{...n,path:i,message:n.message};let o="";const l=s.filter(c=>!!c).slice().reverse();for(const c of l)o=c(a,{data:e,defaultError:o}).message;return{...n,path:i,message:o}},O4=[];function je(r,e){const t=Eu(),s=ku({issueData:e,data:r.data,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,t,t===Go?void 0:Go].filter(n=>!!n)});r.common.issues.push(s)}class nn{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const s=[];for(const n of t){if(n.status==="aborted")return et;n.status==="dirty"&&e.dirty(),s.push(n.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,t){const s=[];for(const n of t){const i=await n.key,a=await n.value;s.push({key:i,value:a})}return nn.mergeObjectSync(e,s)}static mergeObjectSync(e,t){const s={};for(const n of t){const{key:i,value:a}=n;if(i.status==="aborted"||a.status==="aborted")return et;i.status==="dirty"&&e.dirty(),a.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof a.value<"u"||n.alwaysSet)&&(s[i.value]=a.value)}return{status:e.value,value:s}}}const et=Object.freeze({status:"aborted"}),Io=r=>({status:"dirty",value:r}),dn=r=>({status:"valid",value:r}),hp=r=>r.status==="aborted",up=r=>r.status==="dirty",La=r=>r.status==="valid",wc=r=>typeof Promise<"u"&&r instanceof Promise;function Cu(r,e,t,s){if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(r)}function Mb(r,e,t,s,n){if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(r,t),t}var ze;(function(r){r.errToObj=e=>typeof e=="string"?{message:e}:e||{},r.toString=e=>typeof e=="string"?e:e?.message})(ze||(ze={}));var Kl,Jl;class Yr{constructor(e,t,s,n){this._cachedPath=[],this.parent=e,this.data=t,this._path=s,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const p0=(r,e)=>{if(La(e))return{success:!0,data:e.value};if(!r.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new Dn(r.common.issues);return this._error=t,this._error}}};function dt(r){if(!r)return{};const{errorMap:e,invalid_type_error:t,required_error:s,description:n}=r;if(e&&(t||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:(a,o)=>{var l,c;const{message:h}=r;return a.code==="invalid_enum_value"?{message:h??o.defaultError}:typeof o.data>"u"?{message:(l=h??s)!==null&&l!==void 0?l:o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:(c=h??t)!==null&&c!==void 0?c:o.defaultError}},description:n}}class gt{get description(){return this._def.description}_getType(e){return bi(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:bi(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new nn,ctx:{common:e.parent.common,data:e.data,parsedType:bi(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(wc(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const s=this.safeParse(e,t);if(s.success)return s.data;throw s.error}safeParse(e,t){var s;const n={common:{issues:[],async:(s=t?.async)!==null&&s!==void 0?s:!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:bi(e)},i=this._parseSync({data:e,path:n.path,parent:n});return p0(n,i)}"~validate"(e){var t,s;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:bi(e)};if(!this["~standard"].async)try{const i=this._parseSync({data:e,path:[],parent:n});return La(i)?{value:i.value}:{issues:n.common.issues}}catch(i){!((s=(t=i?.message)===null||t===void 0?void 0:t.toLowerCase())===null||s===void 0)&&s.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(i=>La(i)?{value:i.value}:{issues:n.common.issues})}async parseAsync(e,t){const s=await this.safeParseAsync(e,t);if(s.success)return s.data;throw s.error}async safeParseAsync(e,t){const s={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:bi(e)},n=this._parse({data:e,path:s.path,parent:s}),i=await(wc(n)?n:Promise.resolve(n));return p0(s,i)}refine(e,t){const s=n=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(n):t;return this._refinement((n,i)=>{const a=e(n),o=()=>i.addIssue({code:Se.custom,...s(n)});return typeof Promise<"u"&&a instanceof Promise?a.then(l=>l?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(e,t){return this._refinement((s,n)=>e(s)?!0:(n.addIssue(typeof t=="function"?t(s,n):t),!1))}_refinement(e){return new Ar({schema:this,typeName:Qe.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return Xr.create(this,this._def)}nullable(){return Qi.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return xr.create(this)}promise(){return Yo.create(this,this._def)}or(e){return Sc.create([this,e],this._def)}and(e){return Nc.create(this,e,this._def)}transform(e){return new Ar({...dt(this._def),schema:this,typeName:Qe.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new Lc({...dt(this._def),innerType:this,defaultValue:t,typeName:Qe.ZodDefault})}brand(){return new rm({typeName:Qe.ZodBranded,type:this,...dt(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new Tc({...dt(this._def),innerType:this,catchValue:t,typeName:Qe.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return zc.create(this,e)}readonly(){return Ic.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const M4=/^c[^\s-]{8,}$/i,F4=/^[0-9a-z]+$/,D4=/^[0-9A-HJKMNP-TV-Z]{26}$/i,B4=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,$4=/^[a-z0-9_-]{21}$/i,q4=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,U4=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,z4=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,H4="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Sf;const W4=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,V4=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,G4=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,X4=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Y4=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,K4=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Fb="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",J4=new RegExp(`^${Fb}$`);function Db(r){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return r.precision?e=`${e}\\.\\d{${r.precision}}`:r.precision==null&&(e=`${e}(\\.\\d+)?`),e}function Z4(r){return new RegExp(`^${Db(r)}$`)}function Bb(r){let e=`${Fb}T${Db(r)}`;const t=[];return t.push(r.local?"Z?":"Z"),r.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function Q4(r,e){return!!((e==="v4"||!e)&&W4.test(r)||(e==="v6"||!e)&&G4.test(r))}function eN(r,e){if(!q4.test(r))return!1;try{const[t]=r.split("."),s=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),n=JSON.parse(atob(s));return!(typeof n!="object"||n===null||!n.typ||!n.alg||e&&n.alg!==e)}catch{return!1}}function tN(r,e){return!!((e==="v4"||!e)&&V4.test(r)||(e==="v6"||!e)&&X4.test(r))}class vr extends gt{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==Be.string){const i=this._getOrReturnCtx(e);return je(i,{code:Se.invalid_type,expected:Be.string,received:i.parsedType}),et}const s=new nn;let n;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(n=this._getOrReturnCtx(e,n),je(n,{code:Se.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),s.dirty());else if(i.kind==="max")e.data.length>i.value&&(n=this._getOrReturnCtx(e,n),je(n,{code:Se.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),s.dirty());else if(i.kind==="length"){const a=e.data.length>i.value,o=e.data.length<i.value;(a||o)&&(n=this._getOrReturnCtx(e,n),a?je(n,{code:Se.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&je(n,{code:Se.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),s.dirty())}else if(i.kind==="email")z4.test(e.data)||(n=this._getOrReturnCtx(e,n),je(n,{validation:"email",code:Se.invalid_string,message:i.message}),s.dirty());else if(i.kind==="emoji")Sf||(Sf=new RegExp(H4,"u")),Sf.test(e.data)||(n=this._getOrReturnCtx(e,n),je(n,{validation:"emoji",code:Se.invalid_string,message:i.message}),s.dirty());else if(i.kind==="uuid")B4.test(e.data)||(n=this._getOrReturnCtx(e,n),je(n,{validation:"uuid",code:Se.invalid_string,message:i.message}),s.dirty());else if(i.kind==="nanoid")$4.test(e.data)||(n=this._getOrReturnCtx(e,n),je(n,{validation:"nanoid",code:Se.invalid_string,message:i.message}),s.dirty());else if(i.kind==="cuid")M4.test(e.data)||(n=this._getOrReturnCtx(e,n),je(n,{validation:"cuid",code:Se.invalid_string,message:i.message}),s.dirty());else if(i.kind==="cuid2")F4.test(e.data)||(n=this._getOrReturnCtx(e,n),je(n,{validation:"cuid2",code:Se.invalid_string,message:i.message}),s.dirty());else if(i.kind==="ulid")D4.test(e.data)||(n=this._getOrReturnCtx(e,n),je(n,{validation:"ulid",code:Se.invalid_string,message:i.message}),s.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{n=this._getOrReturnCtx(e,n),je(n,{validation:"url",code:Se.invalid_string,message:i.message}),s.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),je(n,{validation:"regex",code:Se.invalid_string,message:i.message}),s.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(n=this._getOrReturnCtx(e,n),je(n,{code:Se.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),s.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(n=this._getOrReturnCtx(e,n),je(n,{code:Se.invalid_string,validation:{startsWith:i.value},message:i.message}),s.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(n=this._getOrReturnCtx(e,n),je(n,{code:Se.invalid_string,validation:{endsWith:i.value},message:i.message}),s.dirty()):i.kind==="datetime"?Bb(i).test(e.data)||(n=this._getOrReturnCtx(e,n),je(n,{code:Se.invalid_string,validation:"datetime",message:i.message}),s.dirty()):i.kind==="date"?J4.test(e.data)||(n=this._getOrReturnCtx(e,n),je(n,{code:Se.invalid_string,validation:"date",message:i.message}),s.dirty()):i.kind==="time"?Z4(i).test(e.data)||(n=this._getOrReturnCtx(e,n),je(n,{code:Se.invalid_string,validation:"time",message:i.message}),s.dirty()):i.kind==="duration"?U4.test(e.data)||(n=this._getOrReturnCtx(e,n),je(n,{validation:"duration",code:Se.invalid_string,message:i.message}),s.dirty()):i.kind==="ip"?Q4(e.data,i.version)||(n=this._getOrReturnCtx(e,n),je(n,{validation:"ip",code:Se.invalid_string,message:i.message}),s.dirty()):i.kind==="jwt"?eN(e.data,i.alg)||(n=this._getOrReturnCtx(e,n),je(n,{validation:"jwt",code:Se.invalid_string,message:i.message}),s.dirty()):i.kind==="cidr"?tN(e.data,i.version)||(n=this._getOrReturnCtx(e,n),je(n,{validation:"cidr",code:Se.invalid_string,message:i.message}),s.dirty()):i.kind==="base64"?Y4.test(e.data)||(n=this._getOrReturnCtx(e,n),je(n,{validation:"base64",code:Se.invalid_string,message:i.message}),s.dirty()):i.kind==="base64url"?K4.test(e.data)||(n=this._getOrReturnCtx(e,n),je(n,{validation:"base64url",code:Se.invalid_string,message:i.message}),s.dirty()):Ct.assertNever(i);return{status:s.value,value:e.data}}_regex(e,t,s){return this.refinement(n=>e.test(n),{validation:t,code:Se.invalid_string,...ze.errToObj(s)})}_addCheck(e){return new vr({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...ze.errToObj(e)})}url(e){return this._addCheck({kind:"url",...ze.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...ze.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...ze.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...ze.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...ze.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...ze.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...ze.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...ze.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...ze.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...ze.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...ze.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...ze.errToObj(e)})}datetime(e){var t,s;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(t=e?.offset)!==null&&t!==void 0?t:!1,local:(s=e?.local)!==null&&s!==void 0?s:!1,...ze.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...ze.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...ze.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...ze.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...ze.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...ze.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...ze.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...ze.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...ze.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...ze.errToObj(t)})}nonempty(e){return this.min(1,ze.errToObj(e))}trim(){return new vr({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new vr({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new vr({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}vr.create=r=>{var e;return new vr({checks:[],typeName:Qe.ZodString,coerce:(e=r?.coerce)!==null&&e!==void 0?e:!1,...dt(r)})};function sN(r,e){const t=(r.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,n=t>s?t:s,i=parseInt(r.toFixed(n).replace(".","")),a=parseInt(e.toFixed(n).replace(".",""));return i%a/Math.pow(10,n)}class Ki extends gt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==Be.number){const i=this._getOrReturnCtx(e);return je(i,{code:Se.invalid_type,expected:Be.number,received:i.parsedType}),et}let s;const n=new nn;for(const i of this._def.checks)i.kind==="int"?Ct.isInteger(e.data)||(s=this._getOrReturnCtx(e,s),je(s,{code:Se.invalid_type,expected:"integer",received:"float",message:i.message}),n.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(s=this._getOrReturnCtx(e,s),je(s,{code:Se.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(s=this._getOrReturnCtx(e,s),je(s,{code:Se.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):i.kind==="multipleOf"?sN(e.data,i.value)!==0&&(s=this._getOrReturnCtx(e,s),je(s,{code:Se.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(s=this._getOrReturnCtx(e,s),je(s,{code:Se.not_finite,message:i.message}),n.dirty()):Ct.assertNever(i);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,ze.toString(t))}gt(e,t){return this.setLimit("min",e,!1,ze.toString(t))}lte(e,t){return this.setLimit("max",e,!0,ze.toString(t))}lt(e,t){return this.setLimit("max",e,!1,ze.toString(t))}setLimit(e,t,s,n){return new Ki({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:s,message:ze.toString(n)}]})}_addCheck(e){return new Ki({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:ze.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ze.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ze.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ze.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ze.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:ze.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:ze.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ze.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ze.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Ct.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(t===null||s.value>t)&&(t=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(t)&&Number.isFinite(e)}}Ki.create=r=>new Ki({checks:[],typeName:Qe.ZodNumber,coerce:r?.coerce||!1,...dt(r)});class Ji extends gt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==Be.bigint)return this._getInvalidInput(e);let s;const n=new nn;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(s=this._getOrReturnCtx(e,s),je(s,{code:Se.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(s=this._getOrReturnCtx(e,s),je(s,{code:Se.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(s=this._getOrReturnCtx(e,s),je(s,{code:Se.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):Ct.assertNever(i);return{status:n.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return je(t,{code:Se.invalid_type,expected:Be.bigint,received:t.parsedType}),et}gte(e,t){return this.setLimit("min",e,!0,ze.toString(t))}gt(e,t){return this.setLimit("min",e,!1,ze.toString(t))}lte(e,t){return this.setLimit("max",e,!0,ze.toString(t))}lt(e,t){return this.setLimit("max",e,!1,ze.toString(t))}setLimit(e,t,s,n){return new Ji({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:s,message:ze.toString(n)}]})}_addCheck(e){return new Ji({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ze.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ze.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ze.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ze.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:ze.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Ji.create=r=>{var e;return new Ji({checks:[],typeName:Qe.ZodBigInt,coerce:(e=r?.coerce)!==null&&e!==void 0?e:!1,...dt(r)})};class xc extends gt{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Be.boolean){const s=this._getOrReturnCtx(e);return je(s,{code:Se.invalid_type,expected:Be.boolean,received:s.parsedType}),et}return dn(e.data)}}xc.create=r=>new xc({typeName:Qe.ZodBoolean,coerce:r?.coerce||!1,...dt(r)});class Ta extends gt{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==Be.date){const i=this._getOrReturnCtx(e);return je(i,{code:Se.invalid_type,expected:Be.date,received:i.parsedType}),et}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return je(i,{code:Se.invalid_date}),et}const s=new nn;let n;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(n=this._getOrReturnCtx(e,n),je(n,{code:Se.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),s.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(n=this._getOrReturnCtx(e,n),je(n,{code:Se.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),s.dirty()):Ct.assertNever(i);return{status:s.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Ta({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:ze.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:ze.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}Ta.create=r=>new Ta({checks:[],coerce:r?.coerce||!1,typeName:Qe.ZodDate,...dt(r)});class Pu extends gt{_parse(e){if(this._getType(e)!==Be.symbol){const s=this._getOrReturnCtx(e);return je(s,{code:Se.invalid_type,expected:Be.symbol,received:s.parsedType}),et}return dn(e.data)}}Pu.create=r=>new Pu({typeName:Qe.ZodSymbol,...dt(r)});class _c extends gt{_parse(e){if(this._getType(e)!==Be.undefined){const s=this._getOrReturnCtx(e);return je(s,{code:Se.invalid_type,expected:Be.undefined,received:s.parsedType}),et}return dn(e.data)}}_c.create=r=>new _c({typeName:Qe.ZodUndefined,...dt(r)});class Ac extends gt{_parse(e){if(this._getType(e)!==Be.null){const s=this._getOrReturnCtx(e);return je(s,{code:Se.invalid_type,expected:Be.null,received:s.parsedType}),et}return dn(e.data)}}Ac.create=r=>new Ac({typeName:Qe.ZodNull,...dt(r)});class Xo extends gt{constructor(){super(...arguments),this._any=!0}_parse(e){return dn(e.data)}}Xo.create=r=>new Xo({typeName:Qe.ZodAny,...dt(r)});class ka extends gt{constructor(){super(...arguments),this._unknown=!0}_parse(e){return dn(e.data)}}ka.create=r=>new ka({typeName:Qe.ZodUnknown,...dt(r)});class yi extends gt{_parse(e){const t=this._getOrReturnCtx(e);return je(t,{code:Se.invalid_type,expected:Be.never,received:t.parsedType}),et}}yi.create=r=>new yi({typeName:Qe.ZodNever,...dt(r)});class Lu extends gt{_parse(e){if(this._getType(e)!==Be.undefined){const s=this._getOrReturnCtx(e);return je(s,{code:Se.invalid_type,expected:Be.void,received:s.parsedType}),et}return dn(e.data)}}Lu.create=r=>new Lu({typeName:Qe.ZodVoid,...dt(r)});class xr extends gt{_parse(e){const{ctx:t,status:s}=this._processInputParams(e),n=this._def;if(t.parsedType!==Be.array)return je(t,{code:Se.invalid_type,expected:Be.array,received:t.parsedType}),et;if(n.exactLength!==null){const a=t.data.length>n.exactLength.value,o=t.data.length<n.exactLength.value;(a||o)&&(je(t,{code:a?Se.too_big:Se.too_small,minimum:o?n.exactLength.value:void 0,maximum:a?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),s.dirty())}if(n.minLength!==null&&t.data.length<n.minLength.value&&(je(t,{code:Se.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),s.dirty()),n.maxLength!==null&&t.data.length>n.maxLength.value&&(je(t,{code:Se.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),s.dirty()),t.common.async)return Promise.all([...t.data].map((a,o)=>n.type._parseAsync(new Yr(t,a,t.path,o)))).then(a=>nn.mergeArray(s,a));const i=[...t.data].map((a,o)=>n.type._parseSync(new Yr(t,a,t.path,o)));return nn.mergeArray(s,i)}get element(){return this._def.type}min(e,t){return new xr({...this._def,minLength:{value:e,message:ze.toString(t)}})}max(e,t){return new xr({...this._def,maxLength:{value:e,message:ze.toString(t)}})}length(e,t){return new xr({...this._def,exactLength:{value:e,message:ze.toString(t)}})}nonempty(e){return this.min(1,e)}}xr.create=(r,e)=>new xr({type:r,minLength:null,maxLength:null,exactLength:null,typeName:Qe.ZodArray,...dt(e)});function ko(r){if(r instanceof is){const e={};for(const t in r.shape){const s=r.shape[t];e[t]=Xr.create(ko(s))}return new is({...r._def,shape:()=>e})}else return r instanceof xr?new xr({...r._def,type:ko(r.element)}):r instanceof Xr?Xr.create(ko(r.unwrap())):r instanceof Qi?Qi.create(ko(r.unwrap())):r instanceof Kr?Kr.create(r.items.map(e=>ko(e))):r}class is extends gt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=Ct.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==Be.object){const c=this._getOrReturnCtx(e);return je(c,{code:Se.invalid_type,expected:Be.object,received:c.parsedType}),et}const{status:s,ctx:n}=this._processInputParams(e),{shape:i,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof yi&&this._def.unknownKeys==="strip"))for(const c in n.data)a.includes(c)||o.push(c);const l=[];for(const c of a){const h=i[c],d=n.data[c];l.push({key:{status:"valid",value:c},value:h._parse(new Yr(n,d,n.path,c)),alwaysSet:c in n.data})}if(this._def.catchall instanceof yi){const c=this._def.unknownKeys;if(c==="passthrough")for(const h of o)l.push({key:{status:"valid",value:h},value:{status:"valid",value:n.data[h]}});else if(c==="strict")o.length>0&&(je(n,{code:Se.unrecognized_keys,keys:o}),s.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const h of o){const d=n.data[h];l.push({key:{status:"valid",value:h},value:c._parse(new Yr(n,d,n.path,h)),alwaysSet:h in n.data})}}return n.common.async?Promise.resolve().then(async()=>{const c=[];for(const h of l){const d=await h.key,p=await h.value;c.push({key:d,value:p,alwaysSet:h.alwaysSet})}return c}).then(c=>nn.mergeObjectSync(s,c)):nn.mergeObjectSync(s,l)}get shape(){return this._def.shape()}strict(e){return ze.errToObj,new is({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,s)=>{var n,i,a,o;const l=(a=(i=(n=this._def).errorMap)===null||i===void 0?void 0:i.call(n,t,s).message)!==null&&a!==void 0?a:s.defaultError;return t.code==="unrecognized_keys"?{message:(o=ze.errToObj(e).message)!==null&&o!==void 0?o:l}:{message:l}}}:{}})}strip(){return new is({...this._def,unknownKeys:"strip"})}passthrough(){return new is({...this._def,unknownKeys:"passthrough"})}extend(e){return new is({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new is({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Qe.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new is({...this._def,catchall:e})}pick(e){const t={};return Ct.objectKeys(e).forEach(s=>{e[s]&&this.shape[s]&&(t[s]=this.shape[s])}),new is({...this._def,shape:()=>t})}omit(e){const t={};return Ct.objectKeys(this.shape).forEach(s=>{e[s]||(t[s]=this.shape[s])}),new is({...this._def,shape:()=>t})}deepPartial(){return ko(this)}partial(e){const t={};return Ct.objectKeys(this.shape).forEach(s=>{const n=this.shape[s];e&&!e[s]?t[s]=n:t[s]=n.optional()}),new is({...this._def,shape:()=>t})}required(e){const t={};return Ct.objectKeys(this.shape).forEach(s=>{if(e&&!e[s])t[s]=this.shape[s];else{let i=this.shape[s];for(;i instanceof Xr;)i=i._def.innerType;t[s]=i}}),new is({...this._def,shape:()=>t})}keyof(){return $b(Ct.objectKeys(this.shape))}}is.create=(r,e)=>new is({shape:()=>r,unknownKeys:"strip",catchall:yi.create(),typeName:Qe.ZodObject,...dt(e)});is.strictCreate=(r,e)=>new is({shape:()=>r,unknownKeys:"strict",catchall:yi.create(),typeName:Qe.ZodObject,...dt(e)});is.lazycreate=(r,e)=>new is({shape:r,unknownKeys:"strip",catchall:yi.create(),typeName:Qe.ZodObject,...dt(e)});class Sc extends gt{_parse(e){const{ctx:t}=this._processInputParams(e),s=this._def.options;function n(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return t.common.issues.push(...o.ctx.common.issues),o.result;const a=i.map(o=>new Dn(o.ctx.common.issues));return je(t,{code:Se.invalid_union,unionErrors:a}),et}if(t.common.async)return Promise.all(s.map(async i=>{const a={...t,common:{...t.common,issues:[]},parent:null};return{result:await i._parseAsync({data:t.data,path:t.path,parent:a}),ctx:a}})).then(n);{let i;const a=[];for(const l of s){const c={...t,common:{...t.common,issues:[]},parent:null},h=l._parseSync({data:t.data,path:t.path,parent:c});if(h.status==="valid")return h;h.status==="dirty"&&!i&&(i={result:h,ctx:c}),c.common.issues.length&&a.push(c.common.issues)}if(i)return t.common.issues.push(...i.ctx.common.issues),i.result;const o=a.map(l=>new Dn(l));return je(t,{code:Se.invalid_union,unionErrors:o}),et}}get options(){return this._def.options}}Sc.create=(r,e)=>new Sc({options:r,typeName:Qe.ZodUnion,...dt(e)});const fi=r=>r instanceof kc?fi(r.schema):r instanceof Ar?fi(r.innerType()):r instanceof Cc?[r.value]:r instanceof Zi?r.options:r instanceof Pc?Ct.objectValues(r.enum):r instanceof Lc?fi(r._def.innerType):r instanceof _c?[void 0]:r instanceof Ac?[null]:r instanceof Xr?[void 0,...fi(r.unwrap())]:r instanceof Qi?[null,...fi(r.unwrap())]:r instanceof rm||r instanceof Ic?fi(r.unwrap()):r instanceof Tc?fi(r._def.innerType):[];class od extends gt{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Be.object)return je(t,{code:Se.invalid_type,expected:Be.object,received:t.parsedType}),et;const s=this.discriminator,n=t.data[s],i=this.optionsMap.get(n);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):(je(t,{code:Se.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),et)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,s){const n=new Map;for(const i of t){const a=fi(i.shape[e]);if(!a.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of a){if(n.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);n.set(o,i)}}return new od({typeName:Qe.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:n,...dt(s)})}}function dp(r,e){const t=bi(r),s=bi(e);if(r===e)return{valid:!0,data:r};if(t===Be.object&&s===Be.object){const n=Ct.objectKeys(e),i=Ct.objectKeys(r).filter(o=>n.indexOf(o)!==-1),a={...r,...e};for(const o of i){const l=dp(r[o],e[o]);if(!l.valid)return{valid:!1};a[o]=l.data}return{valid:!0,data:a}}else if(t===Be.array&&s===Be.array){if(r.length!==e.length)return{valid:!1};const n=[];for(let i=0;i<r.length;i++){const a=r[i],o=e[i],l=dp(a,o);if(!l.valid)return{valid:!1};n.push(l.data)}return{valid:!0,data:n}}else return t===Be.date&&s===Be.date&&+r==+e?{valid:!0,data:r}:{valid:!1}}class Nc extends gt{_parse(e){const{status:t,ctx:s}=this._processInputParams(e),n=(i,a)=>{if(hp(i)||hp(a))return et;const o=dp(i.value,a.value);return o.valid?((up(i)||up(a))&&t.dirty(),{status:t.value,value:o.data}):(je(s,{code:Se.invalid_intersection_types}),et)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([i,a])=>n(i,a)):n(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}}Nc.create=(r,e,t)=>new Nc({left:r,right:e,typeName:Qe.ZodIntersection,...dt(t)});class Kr extends gt{_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==Be.array)return je(s,{code:Se.invalid_type,expected:Be.array,received:s.parsedType}),et;if(s.data.length<this._def.items.length)return je(s,{code:Se.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),et;!this._def.rest&&s.data.length>this._def.items.length&&(je(s,{code:Se.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const i=[...s.data].map((a,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new Yr(s,a,s.path,o)):null}).filter(a=>!!a);return s.common.async?Promise.all(i).then(a=>nn.mergeArray(t,a)):nn.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new Kr({...this._def,rest:e})}}Kr.create=(r,e)=>{if(!Array.isArray(r))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Kr({items:r,typeName:Qe.ZodTuple,rest:null,...dt(e)})};class Ec extends gt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==Be.object)return je(s,{code:Se.invalid_type,expected:Be.object,received:s.parsedType}),et;const n=[],i=this._def.keyType,a=this._def.valueType;for(const o in s.data)n.push({key:i._parse(new Yr(s,o,s.path,o)),value:a._parse(new Yr(s,s.data[o],s.path,o)),alwaysSet:o in s.data});return s.common.async?nn.mergeObjectAsync(t,n):nn.mergeObjectSync(t,n)}get element(){return this._def.valueType}static create(e,t,s){return t instanceof gt?new Ec({keyType:e,valueType:t,typeName:Qe.ZodRecord,...dt(s)}):new Ec({keyType:vr.create(),valueType:e,typeName:Qe.ZodRecord,...dt(t)})}}class Tu extends gt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==Be.map)return je(s,{code:Se.invalid_type,expected:Be.map,received:s.parsedType}),et;const n=this._def.keyType,i=this._def.valueType,a=[...s.data.entries()].map(([o,l],c)=>({key:n._parse(new Yr(s,o,s.path,[c,"key"])),value:i._parse(new Yr(s,l,s.path,[c,"value"]))}));if(s.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of a){const c=await l.key,h=await l.value;if(c.status==="aborted"||h.status==="aborted")return et;(c.status==="dirty"||h.status==="dirty")&&t.dirty(),o.set(c.value,h.value)}return{status:t.value,value:o}})}else{const o=new Map;for(const l of a){const c=l.key,h=l.value;if(c.status==="aborted"||h.status==="aborted")return et;(c.status==="dirty"||h.status==="dirty")&&t.dirty(),o.set(c.value,h.value)}return{status:t.value,value:o}}}}Tu.create=(r,e,t)=>new Tu({valueType:e,keyType:r,typeName:Qe.ZodMap,...dt(t)});class Ia extends gt{_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==Be.set)return je(s,{code:Se.invalid_type,expected:Be.set,received:s.parsedType}),et;const n=this._def;n.minSize!==null&&s.data.size<n.minSize.value&&(je(s,{code:Se.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),t.dirty()),n.maxSize!==null&&s.data.size>n.maxSize.value&&(je(s,{code:Se.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),t.dirty());const i=this._def.valueType;function a(l){const c=new Set;for(const h of l){if(h.status==="aborted")return et;h.status==="dirty"&&t.dirty(),c.add(h.value)}return{status:t.value,value:c}}const o=[...s.data.values()].map((l,c)=>i._parse(new Yr(s,l,s.path,c)));return s.common.async?Promise.all(o).then(l=>a(l)):a(o)}min(e,t){return new Ia({...this._def,minSize:{value:e,message:ze.toString(t)}})}max(e,t){return new Ia({...this._def,maxSize:{value:e,message:ze.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}Ia.create=(r,e)=>new Ia({valueType:r,minSize:null,maxSize:null,typeName:Qe.ZodSet,...dt(e)});class qo extends gt{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Be.function)return je(t,{code:Se.invalid_type,expected:Be.function,received:t.parsedType}),et;function s(o,l){return ku({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Eu(),Go].filter(c=>!!c),issueData:{code:Se.invalid_arguments,argumentsError:l}})}function n(o,l){return ku({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Eu(),Go].filter(c=>!!c),issueData:{code:Se.invalid_return_type,returnTypeError:l}})}const i={errorMap:t.common.contextualErrorMap},a=t.data;if(this._def.returns instanceof Yo){const o=this;return dn(async function(...l){const c=new Dn([]),h=await o._def.args.parseAsync(l,i).catch(f=>{throw c.addIssue(s(l,f)),c}),d=await Reflect.apply(a,this,h);return await o._def.returns._def.type.parseAsync(d,i).catch(f=>{throw c.addIssue(n(d,f)),c})})}else{const o=this;return dn(function(...l){const c=o._def.args.safeParse(l,i);if(!c.success)throw new Dn([s(l,c.error)]);const h=Reflect.apply(a,this,c.data),d=o._def.returns.safeParse(h,i);if(!d.success)throw new Dn([n(h,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new qo({...this._def,args:Kr.create(e).rest(ka.create())})}returns(e){return new qo({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,s){return new qo({args:e||Kr.create([]).rest(ka.create()),returns:t||ka.create(),typeName:Qe.ZodFunction,...dt(s)})}}class kc extends gt{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}kc.create=(r,e)=>new kc({getter:r,typeName:Qe.ZodLazy,...dt(e)});class Cc extends gt{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return je(t,{received:t.data,code:Se.invalid_literal,expected:this._def.value}),et}return{status:"valid",value:e.data}}get value(){return this._def.value}}Cc.create=(r,e)=>new Cc({value:r,typeName:Qe.ZodLiteral,...dt(e)});function $b(r,e){return new Zi({values:r,typeName:Qe.ZodEnum,...dt(e)})}class Zi extends gt{constructor(){super(...arguments),Kl.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),s=this._def.values;return je(t,{expected:Ct.joinValues(s),received:t.parsedType,code:Se.invalid_type}),et}if(Cu(this,Kl)||Mb(this,Kl,new Set(this._def.values)),!Cu(this,Kl).has(e.data)){const t=this._getOrReturnCtx(e),s=this._def.values;return je(t,{received:t.data,code:Se.invalid_enum_value,options:s}),et}return dn(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Zi.create(e,{...this._def,...t})}exclude(e,t=this._def){return Zi.create(this.options.filter(s=>!e.includes(s)),{...this._def,...t})}}Kl=new WeakMap;Zi.create=$b;class Pc extends gt{constructor(){super(...arguments),Jl.set(this,void 0)}_parse(e){const t=Ct.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==Be.string&&s.parsedType!==Be.number){const n=Ct.objectValues(t);return je(s,{expected:Ct.joinValues(n),received:s.parsedType,code:Se.invalid_type}),et}if(Cu(this,Jl)||Mb(this,Jl,new Set(Ct.getValidEnumValues(this._def.values))),!Cu(this,Jl).has(e.data)){const n=Ct.objectValues(t);return je(s,{received:s.data,code:Se.invalid_enum_value,options:n}),et}return dn(e.data)}get enum(){return this._def.values}}Jl=new WeakMap;Pc.create=(r,e)=>new Pc({values:r,typeName:Qe.ZodNativeEnum,...dt(e)});class Yo extends gt{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Be.promise&&t.common.async===!1)return je(t,{code:Se.invalid_type,expected:Be.promise,received:t.parsedType}),et;const s=t.parsedType===Be.promise?t.data:Promise.resolve(t.data);return dn(s.then(n=>this._def.type.parseAsync(n,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Yo.create=(r,e)=>new Yo({type:r,typeName:Qe.ZodPromise,...dt(e)});class Ar extends gt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Qe.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:s}=this._processInputParams(e),n=this._def.effect||null,i={addIssue:a=>{je(s,a),a.fatal?t.abort():t.dirty()},get path(){return s.path}};if(i.addIssue=i.addIssue.bind(i),n.type==="preprocess"){const a=n.transform(s.data,i);if(s.common.async)return Promise.resolve(a).then(async o=>{if(t.value==="aborted")return et;const l=await this._def.schema._parseAsync({data:o,path:s.path,parent:s});return l.status==="aborted"?et:l.status==="dirty"||t.value==="dirty"?Io(l.value):l});{if(t.value==="aborted")return et;const o=this._def.schema._parseSync({data:a,path:s.path,parent:s});return o.status==="aborted"?et:o.status==="dirty"||t.value==="dirty"?Io(o.value):o}}if(n.type==="refinement"){const a=o=>{const l=n.refinement(o,i);if(s.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(s.common.async===!1){const o=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return o.status==="aborted"?et:(o.status==="dirty"&&t.dirty(),a(o.value),{status:t.value,value:o.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(o=>o.status==="aborted"?et:(o.status==="dirty"&&t.dirty(),a(o.value).then(()=>({status:t.value,value:o.value}))))}if(n.type==="transform")if(s.common.async===!1){const a=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!La(a))return a;const o=n.transform(a.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:o}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(a=>La(a)?Promise.resolve(n.transform(a.value,i)).then(o=>({status:t.value,value:o})):a);Ct.assertNever(n)}}Ar.create=(r,e,t)=>new Ar({schema:r,typeName:Qe.ZodEffects,effect:e,...dt(t)});Ar.createWithPreprocess=(r,e,t)=>new Ar({schema:e,effect:{type:"preprocess",transform:r},typeName:Qe.ZodEffects,...dt(t)});class Xr extends gt{_parse(e){return this._getType(e)===Be.undefined?dn(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Xr.create=(r,e)=>new Xr({innerType:r,typeName:Qe.ZodOptional,...dt(e)});class Qi extends gt{_parse(e){return this._getType(e)===Be.null?dn(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Qi.create=(r,e)=>new Qi({innerType:r,typeName:Qe.ZodNullable,...dt(e)});class Lc extends gt{_parse(e){const{ctx:t}=this._processInputParams(e);let s=t.data;return t.parsedType===Be.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Lc.create=(r,e)=>new Lc({innerType:r,typeName:Qe.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...dt(e)});class Tc extends gt{_parse(e){const{ctx:t}=this._processInputParams(e),s={...t,common:{...t.common,issues:[]}},n=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return wc(n)?n.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Dn(s.common.issues)},input:s.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new Dn(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}}Tc.create=(r,e)=>new Tc({innerType:r,typeName:Qe.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...dt(e)});class Iu extends gt{_parse(e){if(this._getType(e)!==Be.nan){const s=this._getOrReturnCtx(e);return je(s,{code:Se.invalid_type,expected:Be.nan,received:s.parsedType}),et}return{status:"valid",value:e.data}}}Iu.create=r=>new Iu({typeName:Qe.ZodNaN,...dt(r)});const nN=Symbol("zod_brand");class rm extends gt{_parse(e){const{ctx:t}=this._processInputParams(e),s=t.data;return this._def.type._parse({data:s,path:t.path,parent:t})}unwrap(){return this._def.type}}class zc extends gt{_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return i.status==="aborted"?et:i.status==="dirty"?(t.dirty(),Io(i.value)):this._def.out._parseAsync({data:i.value,path:s.path,parent:s})})();{const n=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?et:n.status==="dirty"?(t.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:s.path,parent:s})}}static create(e,t){return new zc({in:e,out:t,typeName:Qe.ZodPipeline})}}class Ic extends gt{_parse(e){const t=this._def.innerType._parse(e),s=n=>(La(n)&&(n.value=Object.freeze(n.value)),n);return wc(t)?t.then(n=>s(n)):s(t)}unwrap(){return this._def.innerType}}Ic.create=(r,e)=>new Ic({innerType:r,typeName:Qe.ZodReadonly,...dt(e)});function qb(r,e={},t){return r?Xo.create().superRefine((s,n)=>{var i,a;if(!r(s)){const o=typeof e=="function"?e(s):typeof e=="string"?{message:e}:e,l=(a=(i=o.fatal)!==null&&i!==void 0?i:t)!==null&&a!==void 0?a:!0,c=typeof o=="string"?{message:o}:o;n.addIssue({code:"custom",...c,fatal:l})}}):Xo.create()}const rN={object:is.lazycreate};var Qe;(function(r){r.ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodSymbol="ZodSymbol",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodCatch="ZodCatch",r.ZodPromise="ZodPromise",r.ZodBranded="ZodBranded",r.ZodPipeline="ZodPipeline",r.ZodReadonly="ZodReadonly"})(Qe||(Qe={}));const iN=(r,e={message:`Input not instance of ${r.name}`})=>qb(t=>t instanceof r,e),Ub=vr.create,zb=Ki.create,aN=Iu.create,oN=Ji.create,Hb=xc.create,lN=Ta.create,cN=Pu.create,hN=_c.create,uN=Ac.create,dN=Xo.create,fN=ka.create,pN=yi.create,mN=Lu.create,gN=xr.create,bN=is.create,vN=is.strictCreate,yN=Sc.create,wN=od.create,xN=Nc.create,_N=Kr.create,AN=Ec.create,SN=Tu.create,NN=Ia.create,EN=qo.create,kN=kc.create,CN=Cc.create,PN=Zi.create,LN=Pc.create,TN=Yo.create,m0=Ar.create,IN=Xr.create,jN=Qi.create,RN=Ar.createWithPreprocess,ON=zc.create,MN=()=>Ub().optional(),FN=()=>zb().optional(),DN=()=>Hb().optional(),BN={string:r=>vr.create({...r,coerce:!0}),number:r=>Ki.create({...r,coerce:!0}),boolean:r=>xc.create({...r,coerce:!0}),bigint:r=>Ji.create({...r,coerce:!0}),date:r=>Ta.create({...r,coerce:!0})},$N=et;var js=Object.freeze({__proto__:null,defaultErrorMap:Go,setErrorMap:R4,getErrorMap:Eu,makeIssue:ku,EMPTY_PATH:O4,addIssueToContext:je,ParseStatus:nn,INVALID:et,DIRTY:Io,OK:dn,isAborted:hp,isDirty:up,isValid:La,isAsync:wc,get util(){return Ct},get objectUtil(){return cp},ZodParsedType:Be,getParsedType:bi,ZodType:gt,datetimeRegex:Bb,ZodString:vr,ZodNumber:Ki,ZodBigInt:Ji,ZodBoolean:xc,ZodDate:Ta,ZodSymbol:Pu,ZodUndefined:_c,ZodNull:Ac,ZodAny:Xo,ZodUnknown:ka,ZodNever:yi,ZodVoid:Lu,ZodArray:xr,ZodObject:is,ZodUnion:Sc,ZodDiscriminatedUnion:od,ZodIntersection:Nc,ZodTuple:Kr,ZodRecord:Ec,ZodMap:Tu,ZodSet:Ia,ZodFunction:qo,ZodLazy:kc,ZodLiteral:Cc,ZodEnum:Zi,ZodNativeEnum:Pc,ZodPromise:Yo,ZodEffects:Ar,ZodTransformer:Ar,ZodOptional:Xr,ZodNullable:Qi,ZodDefault:Lc,ZodCatch:Tc,ZodNaN:Iu,BRAND:nN,ZodBranded:rm,ZodPipeline:zc,ZodReadonly:Ic,custom:qb,Schema:gt,ZodSchema:gt,late:rN,get ZodFirstPartyTypeKind(){return Qe},coerce:BN,any:dN,array:gN,bigint:oN,boolean:Hb,date:lN,discriminatedUnion:wN,effect:m0,enum:PN,function:EN,instanceof:iN,intersection:xN,lazy:kN,literal:CN,map:SN,nan:aN,nativeEnum:LN,never:pN,null:uN,nullable:jN,number:zb,object:bN,oboolean:DN,onumber:FN,optional:IN,ostring:MN,pipeline:ON,preprocess:RN,promise:TN,record:AN,set:NN,strictObject:vN,string:Ub,symbol:cN,transformer:m0,tuple:_N,undefined:hN,union:yN,unknown:fN,void:mN,NEVER:$N,ZodIssueCode:Se,quotelessJson:j4,ZodError:Dn});function qN({initialValues:r,validationSchema:e,onSubmit:t}){const[s,n]=W.useState({values:r,errors:{},touched:{}}),i=W.useCallback((l,c)=>{n(h=>({...h,values:{...h.values,[l]:c},touched:{...h.touched,[l]:!0}}))},[]),a=W.useCallback((l,c)=>{if(!e)return"";try{return js.object({[l]:e._def.shape[l]}).parse({[l]:c}),""}catch(h){return h instanceof js.ZodError&&h.errors[0]?.message||""}},[e]),o=W.useCallback(async l=>{if(l.preventDefault(),e)try{e.parse(s.values)}catch(c){if(c instanceof js.ZodError){const h={};c.errors.forEach(d=>{d.path[0]&&(h[d.path[0]]=d.message)}),n(d=>({...d,errors:h}));return}}await t(s.values)},[s.values,e,t]);return{values:s.values,errors:s.errors,touched:s.touched,setFieldValue:i,validateField:a,handleSubmit:o}}function UN(r=!1){const[e,t]=W.useState(r),[s,n]=W.useState(null),i=W.useCallback(async a=>{t(!0),n(null);try{return await a}catch(o){const l=o instanceof Error?o.message:"An unexpected error occurred";throw n(l),o}finally{t(!1)}},[]);return{isLoading:e,error:s,withLoading:i}}const fp="RFC3986",pp={RFC1738:r=>String(r).replace(/%20/g,"+"),RFC3986:r=>String(r)},zN="RFC1738",HN=Array.isArray,Br=(()=>{const r=[];for(let e=0;e<256;++e)r.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return r})(),Nf=1024,WN=(r,e,t,s,n)=>{if(r.length===0)return r;let i=r;if(typeof r=="symbol"?i=Symbol.prototype.toString.call(r):typeof r!="string"&&(i=String(r)),t==="iso-8859-1")return escape(i).replace(/%u[0-9a-f]{4}/gi,function(o){return"%26%23"+parseInt(o.slice(2),16)+"%3B"});let a="";for(let o=0;o<i.length;o+=Nf){const l=i.length>=Nf?i.slice(o,o+Nf):i,c=[];for(let h=0;h<l.length;++h){let d=l.charCodeAt(h);if(d===45||d===46||d===95||d===126||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||n===zN&&(d===40||d===41)){c[c.length]=l.charAt(h);continue}if(d<128){c[c.length]=Br[d];continue}if(d<2048){c[c.length]=Br[192|d>>6]+Br[128|d&63];continue}if(d<55296||d>=57344){c[c.length]=Br[224|d>>12]+Br[128|d>>6&63]+Br[128|d&63];continue}h+=1,d=65536+((d&1023)<<10|l.charCodeAt(h)&1023),c[c.length]=Br[240|d>>18]+Br[128|d>>12&63]+Br[128|d>>6&63]+Br[128|d&63]}a+=c.join("")}return a};function VN(r){return!r||typeof r!="object"?!1:!!(r.constructor&&r.constructor.isBuffer&&r.constructor.isBuffer(r))}function g0(r,e){if(HN(r)){const t=[];for(let s=0;s<r.length;s+=1)t.push(e(r[s]));return t}return e(r)}const GN=Object.prototype.hasOwnProperty,Wb={brackets(r){return String(r)+"[]"},comma:"comma",indices(r,e){return String(r)+"["+e+"]"},repeat(r){return String(r)}},Ur=Array.isArray,XN=Array.prototype.push,Vb=function(r,e){XN.apply(r,Ur(e)?e:[e])},YN=Date.prototype.toISOString,Is={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:WN,encodeValuesOnly:!1,format:fp,formatter:pp[fp],indices:!1,serializeDate(r){return YN.call(r)},skipNulls:!1,strictNullHandling:!1};function KN(r){return typeof r=="string"||typeof r=="number"||typeof r=="boolean"||typeof r=="symbol"||typeof r=="bigint"}const Ef={};function Gb(r,e,t,s,n,i,a,o,l,c,h,d,p,f,y,w,A,x){let S=r,I=x,M=0,B=!1;for(;(I=I.get(Ef))!==void 0&&!B;){const ne=I.get(r);if(M+=1,typeof ne<"u"){if(ne===M)throw new RangeError("Cyclic object value");B=!0}typeof I.get(Ef)>"u"&&(M=0)}if(typeof c=="function"?S=c(e,S):S instanceof Date?S=p?.(S):t==="comma"&&Ur(S)&&(S=g0(S,function(ne){return ne instanceof Date?p?.(ne):ne})),S===null){if(i)return l&&!w?l(e,Is.encoder,A,"key",f):e;S=""}if(KN(S)||VN(S)){if(l){const ne=w?e:l(e,Is.encoder,A,"key",f);return[y?.(ne)+"="+y?.(l(S,Is.encoder,A,"value",f))]}return[y?.(e)+"="+y?.(String(S))]}const Q=[];if(typeof S>"u")return Q;let U;if(t==="comma"&&Ur(S))w&&l&&(S=g0(S,l)),U=[{value:S.length>0?S.join(",")||null:void 0}];else if(Ur(c))U=c;else{const ne=Object.keys(S);U=h?ne.sort(h):ne}const O=o?String(e).replace(/\./g,"%2E"):String(e),G=s&&Ur(S)&&S.length===1?O+"[]":O;if(n&&Ur(S)&&S.length===0)return G+"[]";for(let ne=0;ne<U.length;++ne){const L=U[ne],j=typeof L=="object"&&typeof L.value<"u"?L.value:S[L];if(a&&j===null)continue;const V=d&&o?L.replace(/\./g,"%2E"):L,q=Ur(S)?typeof t=="function"?t(G,V):G:G+(d?"."+V:"["+V+"]");x.set(r,M);const le=new WeakMap;le.set(Ef,x),Vb(Q,Gb(j,q,t,s,n,i,a,o,t==="comma"&&w&&Ur(S)?null:l,c,h,d,p,f,y,w,A,le))}return Q}function JN(r=Is){if(typeof r.allowEmptyArrays<"u"&&typeof r.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof r.encodeDotInKeys<"u"&&typeof r.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(r.encoder!==null&&typeof r.encoder<"u"&&typeof r.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=r.charset||Is.charset;if(typeof r.charset<"u"&&r.charset!=="utf-8"&&r.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=fp;if(typeof r.format<"u"){if(!GN.call(pp,r.format))throw new TypeError("Unknown format option provided.");t=r.format}const s=pp[t];let n=Is.filter;(typeof r.filter=="function"||Ur(r.filter))&&(n=r.filter);let i;if(r.arrayFormat&&r.arrayFormat in Wb?i=r.arrayFormat:"indices"in r?i=r.indices?"indices":"repeat":i=Is.arrayFormat,"commaRoundTrip"in r&&typeof r.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const a=typeof r.allowDots>"u"?r.encodeDotInKeys?!0:Is.allowDots:!!r.allowDots;return{addQueryPrefix:typeof r.addQueryPrefix=="boolean"?r.addQueryPrefix:Is.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof r.allowEmptyArrays=="boolean"?!!r.allowEmptyArrays:Is.allowEmptyArrays,arrayFormat:i,charset:e,charsetSentinel:typeof r.charsetSentinel=="boolean"?r.charsetSentinel:Is.charsetSentinel,commaRoundTrip:!!r.commaRoundTrip,delimiter:typeof r.delimiter>"u"?Is.delimiter:r.delimiter,encode:typeof r.encode=="boolean"?r.encode:Is.encode,encodeDotInKeys:typeof r.encodeDotInKeys=="boolean"?r.encodeDotInKeys:Is.encodeDotInKeys,encoder:typeof r.encoder=="function"?r.encoder:Is.encoder,encodeValuesOnly:typeof r.encodeValuesOnly=="boolean"?r.encodeValuesOnly:Is.encodeValuesOnly,filter:n,format:t,formatter:s,serializeDate:typeof r.serializeDate=="function"?r.serializeDate:Is.serializeDate,skipNulls:typeof r.skipNulls=="boolean"?r.skipNulls:Is.skipNulls,sort:typeof r.sort=="function"?r.sort:null,strictNullHandling:typeof r.strictNullHandling=="boolean"?r.strictNullHandling:Is.strictNullHandling}}function ZN(r,e={}){let t=r;const s=JN(e);let n,i;typeof s.filter=="function"?(i=s.filter,t=i("",t)):Ur(s.filter)&&(i=s.filter,n=i);const a=[];if(typeof t!="object"||t===null)return"";const o=Wb[s.arrayFormat],l=o==="comma"&&s.commaRoundTrip;n||(n=Object.keys(t)),s.sort&&n.sort(s.sort);const c=new WeakMap;for(let p=0;p<n.length;++p){const f=n[p];s.skipNulls&&t[f]===null||Vb(a,Gb(t[f],f,o,l,s.allowEmptyArrays,s.strictNullHandling,s.skipNulls,s.encodeDotInKeys,s.encode?s.encoder:null,s.filter,s.sort,s.allowDots,s.serializeDate,s.format,s.formatter,s.encodeValuesOnly,s.charset,c))}const h=a.join(s.delimiter);let d=s.addQueryPrefix===!0?"?":"";return s.charsetSentinel&&(s.charset==="iso-8859-1"?d+="utf8=%26%2310003%3B&":d+="utf8=%E2%9C%93&"),h.length>0?d+h:""}const Co="4.76.3";let b0=!1,hc,Xb,Yb,mp,Kb,Jb,Zb,Qb,e2;function QN(r,e={auto:!1}){if(b0)throw new Error(`you must \`import 'openai/shims/${r.kind}'\` before importing anything else from openai`);if(hc)throw new Error(`can't \`import 'openai/shims/${r.kind}'\` after \`import 'openai/shims/${hc}'\``);b0=e.auto,hc=r.kind,Xb=r.fetch,Yb=r.FormData,mp=r.File,Kb=r.ReadableStream,Jb=r.getMultipartRequestOptions,Zb=r.getDefaultAgent,Qb=r.fileFromPath,e2=r.isFsReadStream}class eE{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function tE({manuallyImported:r}={}){const e=r?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let t,s,n,i;try{t=fetch,s=Request,n=Response,i=Headers}catch(a){throw new Error(`this environment is missing the following Web Fetch API type: ${a.message}. ${e}`)}return{kind:"web",fetch:t,Request:s,Response:n,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(a,o)=>({...o,body:new eE(a)}),getDefaultAgent:a=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:a=>!1}}hc||QN(tE(),{auto:!0});class At extends Error{}class Ws extends At{constructor(e,t,s,n){super(`${Ws.makeMessage(e,t,s)}`),this.status=e,this.headers=n,this.request_id=n?.["x-request-id"],this.error=t;const i=t;this.code=i?.code,this.param=i?.param,this.type=i?.type}static makeMessage(e,t,s){const n=t?.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):s;return e&&n?`${e} ${n}`:e?`${e} status code (no body)`:n||"(no status code or body)"}static generate(e,t,s,n){if(!e||!n)return new ld({message:s,cause:bp(t)});const i=t?.error;return e===400?new t2(e,i,s,n):e===401?new s2(e,i,s,n):e===403?new n2(e,i,s,n):e===404?new r2(e,i,s,n):e===409?new i2(e,i,s,n):e===422?new a2(e,i,s,n):e===429?new o2(e,i,s,n):e>=500?new l2(e,i,s,n):new Ws(e,i,s,n)}}class yr extends Ws{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class ld extends Ws{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class im extends ld{constructor({message:e}={}){super({message:e??"Request timed out."})}}class t2 extends Ws{}class s2 extends Ws{}class n2 extends Ws{}class r2 extends Ws{}class i2 extends Ws{}class a2 extends Ws{}class o2 extends Ws{}class l2 extends Ws{}class c2 extends At{constructor(){super("Could not parse response content as the length limit was reached")}}class h2 extends At{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class ja{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];const s=ja.NEWLINE_CHARS.has(t[t.length-1]||"");let n=t.split(ja.NEWLINE_REGEXP);return s&&n.pop(),n.length===1&&!s?(this.buffer.push(n[0]),[]):(this.buffer.length>0&&(n=[this.buffer.join("")+n[0],...n.slice(1)],this.buffer=[]),s||(this.buffer=[n.pop()||""]),n)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new At(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new At(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new At("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}ja.NEWLINE_CHARS=new Set([`
`,"\r"]);ja.NEWLINE_REGEXP=/\r\n|[\n\r]/g;class Wr{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let s=!1;async function*n(){if(s)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let i=!1;try{for await(const a of sE(e,t))if(!i){if(a.data.startsWith("[DONE]")){i=!0;continue}if(a.event===null){let o;try{o=JSON.parse(a.data)}catch(l){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),l}if(o&&o.error)throw new Ws(void 0,o.error,void 0,void 0);yield o}else{let o;try{o=JSON.parse(a.data)}catch(l){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),l}if(a.event=="error")throw new Ws(void 0,o.error,o.message,void 0);yield{event:a.event,data:o}}}i=!0}catch(a){if(a instanceof Error&&a.name==="AbortError")return;throw a}finally{i||t.abort()}}return new Wr(n,t)}static fromReadableStream(e,t){let s=!1;async function*n(){const a=new ja,o=u2(e);for await(const l of o)for(const c of a.decode(l))yield c;for(const l of a.flush())yield l}async function*i(){if(s)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let a=!1;try{for await(const o of n())a||o&&(yield JSON.parse(o));a=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{a||t.abort()}}return new Wr(i,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],s=this.iterator(),n=i=>({next:()=>{if(i.length===0){const a=s.next();e.push(a),t.push(a)}return i.shift()}});return[new Wr(()=>n(e),this.controller),new Wr(()=>n(t),this.controller)]}toReadableStream(){const e=this;let t;const s=new TextEncoder;return new Kb({async start(){t=e[Symbol.asyncIterator]()},async pull(n){try{const{value:i,done:a}=await t.next();if(a)return n.close();const o=s.encode(JSON.stringify(i)+`
`);n.enqueue(o)}catch(i){n.error(i)}},async cancel(){await t.return?.()}})}}async function*sE(r,e){if(!r.body)throw e.abort(),new At("Attempted to iterate over a response with no body");const t=new iE,s=new ja,n=u2(r.body);for await(const i of nE(n))for(const a of s.decode(i)){const o=t.decode(a);o&&(yield o)}for(const i of s.flush()){const a=t.decode(i);a&&(yield a)}}async function*nE(r){let e=new Uint8Array;for await(const t of r){if(t==null)continue;const s=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let n=new Uint8Array(e.length+s.length);n.set(e),n.set(s,e.length),e=n;let i;for(;(i=rE(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}function rE(r){for(let s=0;s<r.length-2;s++){if(r[s]===10&&r[s+1]===10||r[s]===13&&r[s+1]===13)return s+2;if(r[s]===13&&r[s+1]===10&&s+3<r.length&&r[s+2]===13&&r[s+3]===10)return s+4}return-1}class iE{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,s,n]=aE(e,":");return n.startsWith(" ")&&(n=n.substring(1)),t==="event"?this.event=n:t==="data"&&this.data.push(n),null}}function aE(r,e){const t=r.indexOf(e);return t!==-1?[r.substring(0,t),e,r.substring(t+e.length)]:[r,"",""]}function u2(r){if(r[Symbol.asyncIterator])return r;const e=r.getReader();return{async next(){try{const t=await e.read();return t?.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const d2=r=>r!=null&&typeof r=="object"&&typeof r.url=="string"&&typeof r.blob=="function",f2=r=>r!=null&&typeof r=="object"&&typeof r.name=="string"&&typeof r.lastModified=="number"&&cd(r),cd=r=>r!=null&&typeof r=="object"&&typeof r.size=="number"&&typeof r.type=="string"&&typeof r.text=="function"&&typeof r.slice=="function"&&typeof r.arrayBuffer=="function",oE=r=>f2(r)||d2(r)||e2(r);async function p2(r,e,t){if(r=await r,f2(r))return r;if(d2(r)){const n=await r.blob();e||(e=new URL(r.url).pathname.split(/[\\/]/).pop()??"unknown_file");const i=cd(n)?[await n.arrayBuffer()]:[n];return new mp(i,e,t)}const s=await lE(r);if(e||(e=hE(r)??"unknown_file"),!t?.type){const n=s[0]?.type;typeof n=="string"&&(t={...t,type:n})}return new mp(s,e,t)}async function lE(r){let e=[];if(typeof r=="string"||ArrayBuffer.isView(r)||r instanceof ArrayBuffer)e.push(r);else if(cd(r))e.push(await r.arrayBuffer());else if(uE(r))for await(const t of r)e.push(t);else throw new Error(`Unexpected data type: ${typeof r}; constructor: ${r?.constructor?.name}; props: ${cE(r)}`);return e}function cE(r){return`[${Object.getOwnPropertyNames(r).map(t=>`"${t}"`).join(", ")}]`}function hE(r){return kf(r.name)||kf(r.filename)||kf(r.path)?.split(/[\\/]/).pop()}const kf=r=>{if(typeof r=="string")return r;if(typeof Buffer<"u"&&r instanceof Buffer)return String(r)},uE=r=>r!=null&&typeof r=="object"&&typeof r[Symbol.asyncIterator]=="function",v0=r=>r&&typeof r=="object"&&r.body&&r[Symbol.toStringTag]==="MultipartBody",Ko=async r=>{const e=await dE(r.body);return Jb(e,r)},dE=async r=>{const e=new Yb;return await Promise.all(Object.entries(r||{}).map(([t,s])=>gp(e,t,s))),e},gp=async(r,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")r.append(e,String(t));else if(oE(t)){const s=await p2(t);r.append(e,s)}else if(Array.isArray(t))await Promise.all(t.map(s=>gp(r,e+"[]",s)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([s,n])=>gp(r,`${e}[${s}]`,n)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}};var m2={},fE=function(r,e,t,s,n){if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(r,t),t},pE=function(r,e,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(r):s?s.value:e.get(r)},Qh;async function g2(r){const{response:e}=r;if(r.options.stream)return Uo("response",e.status,e.url,e.headers,e.body),r.options.__streamClass?r.options.__streamClass.fromSSEResponse(e,r.controller):Wr.fromSSEResponse(e,r.controller);if(e.status===204)return null;if(r.options.__binaryResponse)return e;const t=e.headers.get("content-type");if(t?.includes("application/json")||t?.includes("application/vnd.api+json")){const i=await e.json();return Uo("response",e.status,e.url,e.headers,i),b2(i,e)}const n=await e.text();return Uo("response",e.status,e.url,e.headers,n),n}function b2(r,e){return!r||typeof r!="object"||Array.isArray(r)?r:Object.defineProperty(r,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class hd extends Promise{constructor(e,t=g2){super(s=>{s(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new hd(this.responsePromise,async t=>b2(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class mE{constructor({baseURL:e,maxRetries:t=2,timeout:s=6e5,httpAgent:n,fetch:i}){this.baseURL=e,this.maxRetries=Cf("maxRetries",t),this.timeout=Cf("timeout",s),this.httpAgent=n,this.fetch=i??Xb}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...xE(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${NE()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,s){return this.request(Promise.resolve(s).then(async n=>{const i=n&&cd(n?.body)?new DataView(await n.body.arrayBuffer()):n?.body instanceof DataView?n.body:n?.body instanceof ArrayBuffer?new DataView(n.body):n&&ArrayBuffer.isView(n?.body)?new DataView(n.body.buffer):n?.body;return{method:e,path:t,...n,body:i}}))}getAPIList(e,t,s){return this.requestAPIList(t,{method:"get",path:e,...s})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){const{method:s,path:n,query:i,headers:a={}}=e,o=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:v0(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,l=this.calculateContentLength(o),c=this.buildURL(n,i);"timeout"in e&&Cf("timeout",e.timeout);const h=e.timeout??this.timeout,d=e.httpAgent??this.httpAgent??Zb(c),p=h+1e3;typeof d?.options?.timeout=="number"&&p>(d.options.timeout??0)&&(d.options.timeout=p),this.idempotencyHeader&&s!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const f=this.buildHeaders({options:e,headers:a,contentLength:l,retryCount:t});return{req:{method:s,...o&&{body:o},headers:f,...d&&{agent:d},signal:e.signal??null},url:c,timeout:h}}buildHeaders({options:e,headers:t,contentLength:s,retryCount:n}){const i={};s&&(i["content-length"]=s);const a=this.defaultHeaders(e);return _0(i,a),_0(i,t),v0(e.body)&&hc!=="node"&&delete i["content-type"],A0(a,"x-stainless-retry-count")===void 0&&A0(t,"x-stainless-retry-count")===void 0&&(i["x-stainless-retry-count"]=String(n)),this.validateHeaders(i,t),i}async prepareOptions(e){}async prepareRequest(e,{url:t,options:s}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,s,n){return Ws.generate(e,t,s,n)}request(e,t=null){return new hd(this.makeRequest(e,t))}async makeRequest(e,t){const s=await e,n=s.maxRetries??this.maxRetries;t==null&&(t=n),await this.prepareOptions(s);const{req:i,url:a,timeout:o}=this.buildRequest(s,{retryCount:n-t});if(await this.prepareRequest(i,{url:a,options:s}),Uo("request",a,s,i.headers),s.signal?.aborted)throw new yr;const l=new AbortController,c=await this.fetchWithTimeout(a,i,o,l).catch(bp);if(c instanceof Error){if(s.signal?.aborted)throw new yr;if(t)return this.retryRequest(s,t);throw c.name==="AbortError"?new im:new ld({cause:c})}const h=bE(c.headers);if(!c.ok){if(t&&this.shouldRetry(c)){const A=`retrying, ${t} attempts remaining`;return Uo(`response (error; ${A})`,c.status,a,h),this.retryRequest(s,t,h)}const d=await c.text().catch(A=>bp(A).message),p=_E(d),f=p?void 0:d;throw Uo(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,c.status,a,h,f),this.makeStatusError(c.status,p,f,h)}return{response:c,options:s,controller:l}}requestAPIList(e,t){const s=this.makeRequest(t,null);return new gE(this,s,e)}buildURL(e,t){const s=SE(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),n=this.defaultQuery();return y2(n)||(t={...n,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(s.search=this.stringifyQuery(t)),s.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,s])=>typeof s<"u").map(([t,s])=>{if(typeof s=="string"||typeof s=="number"||typeof s=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(s)}`;if(s===null)return`${encodeURIComponent(t)}=`;throw new At(`Cannot stringify type ${typeof s}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,s,n){const{signal:i,...a}=t||{};i&&i.addEventListener("abort",()=>n.abort());const o=setTimeout(()=>n.abort(),s);return this.fetch.call(void 0,e,{signal:n.signal,...a}).finally(()=>{clearTimeout(o)})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,s){let n;const i=s?.["retry-after-ms"];if(i){const o=parseFloat(i);Number.isNaN(o)||(n=o)}const a=s?.["retry-after"];if(a&&!n){const o=parseFloat(a);Number.isNaN(o)?n=Date.parse(a)-Date.now():n=o*1e3}if(!(n&&0<=n&&n<60*1e3)){const o=e.maxRetries??this.maxRetries;n=this.calculateDefaultRetryTimeoutMillis(t,o)}return await Hc(n),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const i=t-e,a=Math.min(.5*Math.pow(2,i),8),o=1-Math.random()*.25;return a*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Co}`}}class v2{constructor(e,t,s,n){Qh.set(this,void 0),fE(this,Qh,e),this.options=n,this.response=t,this.body=s}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new At("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&typeof t.query=="object")t.query={...t.query,...e.params};else if("url"in e){const s=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[n,i]of s)e.url.searchParams.set(n,i);t.query=void 0,t.path=e.url.toString()}return await pE(this,Qh,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Qh=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class gE extends hd{constructor(e,t,s){super(t,async n=>new s(e,n.response,await g2(n),n.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}}const bE=r=>new Proxy(Object.fromEntries(r.entries()),{get(e,t){const s=t.toString();return e[s.toLowerCase()]||e[s]}}),vE={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},Sn=r=>typeof r=="object"&&r!==null&&!y2(r)&&Object.keys(r).every(e=>w2(vE,e)),yE=()=>{if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Co,"X-Stainless-OS":w0(Deno.build.os),"X-Stainless-Arch":y0(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:Deno.version?.deno??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Co,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Co,"X-Stainless-OS":w0(process.platform),"X-Stainless-Arch":y0(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const r=wE();return r?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Co,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${r.browser}`,"X-Stainless-Runtime-Version":r.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Co,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function wE(){if(typeof navigator>"u"||!navigator)return null;const r=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of r){const s=t.exec(navigator.userAgent);if(s){const n=s[1]||0,i=s[2]||0,a=s[3]||0;return{browser:e,version:`${n}.${i}.${a}`}}}return null}const y0=r=>r==="x32"?"x32":r==="x86_64"||r==="x64"?"x64":r==="arm"?"arm":r==="aarch64"||r==="arm64"?"arm64":r?`other:${r}`:"unknown",w0=r=>(r=r.toLowerCase(),r.includes("ios")?"iOS":r==="android"?"Android":r==="darwin"?"MacOS":r==="win32"?"Windows":r==="freebsd"?"FreeBSD":r==="openbsd"?"OpenBSD":r==="linux"?"Linux":r?`Other:${r}`:"Unknown");let x0;const xE=()=>x0??(x0=yE()),_E=r=>{try{return JSON.parse(r)}catch{return}},AE=/^[a-z][a-z0-9+.-]*:/i,SE=r=>AE.test(r),Hc=r=>new Promise(e=>setTimeout(e,r)),Cf=(r,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new At(`${r} must be an integer`);if(e<0)throw new At(`${r} must be a positive integer`);return e},bp=r=>{if(r instanceof Error)return r;if(typeof r=="object"&&r!==null)try{return new Error(JSON.stringify(r))}catch{}return new Error(r)},eu=r=>{if(typeof process<"u")return m2?.[r]?.trim()??void 0;if(typeof Deno<"u")return Deno.env?.get?.(r)?.trim()};function y2(r){if(!r)return!0;for(const e in r)return!1;return!0}function w2(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function _0(r,e){for(const t in e){if(!w2(e,t))continue;const s=t.toLowerCase();if(!s)continue;const n=e[t];n===null?delete r[s]:n!==void 0&&(r[s]=n)}}function Uo(r,...e){typeof process<"u"&&m2?.DEBUG==="true"&&console.log(`OpenAI:DEBUG:${r}`,...e)}const NE=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)}),EE=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",kE=r=>typeof r?.get=="function",A0=(r,e)=>{const t=e.toLowerCase();if(kE(r)){const s=e[0]?.toUpperCase()+e.substring(1).replace(/([^\w])(\w)/g,(n,i,a)=>i+a.toUpperCase());for(const n of[e,t,e.toUpperCase(),s]){const i=r.get(n);if(i)return i}}for(const[s,n]of Object.entries(r))if(s.toLowerCase()===t)return Array.isArray(n)?(n.length<=1||console.warn(`Received ${n.length} entries for the ${e} header, using the first entry.`),n[0]):n};function Pf(r){return r!=null&&typeof r=="object"&&!Array.isArray(r)}class CE extends v2{constructor(e,t,s,n){super(e,t,s,n),this.data=s.data||[],this.object=s.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Er extends v2{constructor(e,t,s,n){super(e,t,s,n),this.data=s.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){const e=this.getPaginatedItems();if(!e.length)return null;const t=e[e.length-1]?.id;return t?{params:{after:t}}:null}}class $t{constructor(e){this._client=e}}let x2=class extends $t{create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}},am=class extends $t{constructor(){super(...arguments),this.completions=new x2(this._client)}};am.Completions=x2;class _2 extends $t{create(e,t){return this._client.post("/audio/speech",{body:e,...t,__binaryResponse:!0})}}class A2 extends $t{create(e,t){return this._client.post("/audio/transcriptions",Ko({body:e,...t}))}}class S2 extends $t{create(e,t){return this._client.post("/audio/translations",Ko({body:e,...t}))}}class Wc extends $t{constructor(){super(...arguments),this.transcriptions=new A2(this._client),this.translations=new S2(this._client),this.speech=new _2(this._client)}}Wc.Transcriptions=A2;Wc.Translations=S2;Wc.Speech=_2;class om extends $t{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return Sn(e)?this.list({},e):this._client.getAPIList("/batches",lm,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}}class lm extends Er{}om.BatchesPage=lm;class cm extends $t{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,s){return this._client.post(`/assistants/${e}`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}list(e={},t){return Sn(e)?this.list({},e):this._client.getAPIList("/assistants",hm,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class hm extends Er{}cm.AssistantsPage=hm;function S0(r){return typeof r.parse=="function"}const zo=r=>r?.role==="assistant",N2=r=>r?.role==="function",E2=r=>r?.role==="tool";var dr=function(r,e,t,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(r,t):n?n.value=t:e.set(r,t),t},ns=function(r,e,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(r):s?s.value:e.get(r)},vp,du,fu,Zl,Ql,pu,ec,pi,tc,ju,Ru,Po,k2;class C2{constructor(){vp.add(this),this.controller=new AbortController,du.set(this,void 0),fu.set(this,()=>{}),Zl.set(this,()=>{}),Ql.set(this,void 0),pu.set(this,()=>{}),ec.set(this,()=>{}),pi.set(this,{}),tc.set(this,!1),ju.set(this,!1),Ru.set(this,!1),Po.set(this,!1),dr(this,du,new Promise((e,t)=>{dr(this,fu,e,"f"),dr(this,Zl,t,"f")}),"f"),dr(this,Ql,new Promise((e,t)=>{dr(this,pu,e,"f"),dr(this,ec,t,"f")}),"f"),ns(this,du,"f").catch(()=>{}),ns(this,Ql,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},ns(this,vp,"m",k2).bind(this))},0)}_connected(){this.ended||(ns(this,fu,"f").call(this),this._emit("connect"))}get ended(){return ns(this,tc,"f")}get errored(){return ns(this,ju,"f")}get aborted(){return ns(this,Ru,"f")}abort(){this.controller.abort()}on(e,t){return(ns(this,pi,"f")[e]||(ns(this,pi,"f")[e]=[])).push({listener:t}),this}off(e,t){const s=ns(this,pi,"f")[e];if(!s)return this;const n=s.findIndex(i=>i.listener===t);return n>=0&&s.splice(n,1),this}once(e,t){return(ns(this,pi,"f")[e]||(ns(this,pi,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,s)=>{dr(this,Po,!0,"f"),e!=="error"&&this.once("error",s),this.once(e,t)})}async done(){dr(this,Po,!0,"f"),await ns(this,Ql,"f")}_emit(e,...t){if(ns(this,tc,"f"))return;e==="end"&&(dr(this,tc,!0,"f"),ns(this,pu,"f").call(this));const s=ns(this,pi,"f")[e];if(s&&(ns(this,pi,"f")[e]=s.filter(n=>!n.once),s.forEach(({listener:n})=>n(...t))),e==="abort"){const n=t[0];!ns(this,Po,"f")&&!s?.length&&Promise.reject(n),ns(this,Zl,"f").call(this,n),ns(this,ec,"f").call(this,n),this._emit("end");return}if(e==="error"){const n=t[0];!ns(this,Po,"f")&&!s?.length&&Promise.reject(n),ns(this,Zl,"f").call(this,n),ns(this,ec,"f").call(this,n),this._emit("end")}}_emitFinal(){}}du=new WeakMap,fu=new WeakMap,Zl=new WeakMap,Ql=new WeakMap,pu=new WeakMap,ec=new WeakMap,pi=new WeakMap,tc=new WeakMap,ju=new WeakMap,Ru=new WeakMap,Po=new WeakMap,vp=new WeakSet,k2=function(e){if(dr(this,ju,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new yr),e instanceof yr)return dr(this,Ru,!0,"f"),this._emit("abort",e);if(e instanceof At)return this._emit("error",e);if(e instanceof Error){const t=new At(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new At(String(e)))};function P2(r){return r?.$brand==="auto-parseable-response-format"}function Vc(r){return r?.$brand==="auto-parseable-tool"}function PE(r,e){return!e||!L2(e)?{...r,choices:r.choices.map(t=>({...t,message:{...t.message,parsed:null,tool_calls:t.message.tool_calls??[]}}))}:um(r,e)}function um(r,e){const t=r.choices.map(s=>{if(s.finish_reason==="length")throw new c2;if(s.finish_reason==="content_filter")throw new h2;return{...s,message:{...s.message,tool_calls:s.message.tool_calls?.map(n=>TE(e,n))??[],parsed:s.message.content&&!s.message.refusal?LE(e,s.message.content):null}}});return{...r,choices:t}}function LE(r,e){return r.response_format?.type!=="json_schema"?null:r.response_format?.type==="json_schema"?"$parseRaw"in r.response_format?r.response_format.$parseRaw(e):JSON.parse(e):null}function TE(r,e){const t=r.tools?.find(s=>s.function?.name===e.function.name);return{...e,function:{...e.function,parsed_arguments:Vc(t)?t.$parseRaw(e.function.arguments):t?.function.strict?JSON.parse(e.function.arguments):null}}}function IE(r,e){if(!r)return!1;const t=r.tools?.find(s=>s.function?.name===e.function.name);return Vc(t)||t?.function.strict||!1}function L2(r){return P2(r.response_format)?!0:r.tools?.some(e=>Vc(e)||e.type==="function"&&e.function.strict===!0)??!1}function jE(r){for(const e of r??[]){if(e.type!=="function")throw new At(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new At(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var xn=function(r,e,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(r):s?s.value:e.get(r)},en,yp,Ou,wp,xp,_p,T2,Ap;const N0=10;class I2 extends C2{constructor(){super(...arguments),en.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=e.choices[0]?.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),(N2(e)||E2(e))&&e.content)this._emit("functionCallResult",e.content);else if(zo(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(zo(e)&&e.tool_calls)for(const s of e.tool_calls)s.type==="function"&&this._emit("functionCall",s.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new At("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),xn(this,en,"m",yp).call(this)}async finalMessage(){return await this.done(),xn(this,en,"m",Ou).call(this)}async finalFunctionCall(){return await this.done(),xn(this,en,"m",wp).call(this)}async finalFunctionCallResult(){return await this.done(),xn(this,en,"m",xp).call(this)}async totalUsage(){return await this.done(),xn(this,en,"m",_p).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=xn(this,en,"m",Ou).call(this);t&&this._emit("finalMessage",t);const s=xn(this,en,"m",yp).call(this);s&&this._emit("finalContent",s);const n=xn(this,en,"m",wp).call(this);n&&this._emit("finalFunctionCall",n);const i=xn(this,en,"m",xp).call(this);i!=null&&this._emit("finalFunctionCallResult",i),this._chatCompletions.some(a=>a.usage)&&this._emit("totalUsage",xn(this,en,"m",_p).call(this))}async _createChatCompletion(e,t,s){const n=s?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),xn(this,en,"m",T2).call(this,t);const i=await e.chat.completions.create({...t,stream:!1},{...s,signal:this.controller.signal});return this._connected(),this._addChatCompletion(um(i,t))}async _runChatCompletion(e,t,s){for(const n of t.messages)this._addMessage(n,!1);return await this._createChatCompletion(e,t,s)}async _runFunctions(e,t,s){const n="function",{function_call:i="auto",stream:a,...o}=t,l=typeof i!="string"&&i?.name,{maxChatCompletions:c=N0}=s||{},h={};for(const p of t.functions)h[p.name||p.function.name]=p;const d=t.functions.map(p=>({name:p.name||p.function.name,parameters:p.parameters,description:p.description}));for(const p of t.messages)this._addMessage(p,!1);for(let p=0;p<c;++p){const y=(await this._createChatCompletion(e,{...o,function_call:i,functions:d,messages:[...this.messages]},s)).choices[0]?.message;if(!y)throw new At("missing message in ChatCompletion response");if(!y.function_call)return;const{name:w,arguments:A}=y.function_call,x=h[w];if(x){if(l&&l!==w){const B=`Invalid function_call: ${JSON.stringify(w)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:n,name:w,content:B});continue}}else{const B=`Invalid function_call: ${JSON.stringify(w)}. Available options are: ${d.map(Q=>JSON.stringify(Q.name)).join(", ")}. Please try again`;this._addMessage({role:n,name:w,content:B});continue}let S;try{S=S0(x)?await x.parse(A):A}catch(B){this._addMessage({role:n,name:w,content:B instanceof Error?B.message:String(B)});continue}const I=await x.function(S,this),M=xn(this,en,"m",Ap).call(this,I);if(this._addMessage({role:n,name:w,content:M}),l)return}}async _runTools(e,t,s){const n="tool",{tool_choice:i="auto",stream:a,...o}=t,l=typeof i!="string"&&i?.function?.name,{maxChatCompletions:c=N0}=s||{},h=t.tools.map(f=>{if(Vc(f)){if(!f.$callback)throw new At("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:f.$callback,name:f.function.name,description:f.function.description||"",parameters:f.function.parameters,parse:f.$parseRaw,strict:!0}}}return f}),d={};for(const f of h)f.type==="function"&&(d[f.function.name||f.function.function.name]=f.function);const p="tools"in t?h.map(f=>f.type==="function"?{type:"function",function:{name:f.function.name||f.function.function.name,parameters:f.function.parameters,description:f.function.description,strict:f.function.strict}}:f):void 0;for(const f of t.messages)this._addMessage(f,!1);for(let f=0;f<c;++f){const w=(await this._createChatCompletion(e,{...o,tool_choice:i,tools:p,messages:[...this.messages]},s)).choices[0]?.message;if(!w)throw new At("missing message in ChatCompletion response");if(!w.tool_calls?.length)return;for(const A of w.tool_calls){if(A.type!=="function")continue;const x=A.id,{name:S,arguments:I}=A.function,M=d[S];if(M){if(l&&l!==S){const O=`Invalid tool_call: ${JSON.stringify(S)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:n,tool_call_id:x,content:O});continue}}else{const O=`Invalid tool_call: ${JSON.stringify(S)}. Available options are: ${Object.keys(d).map(G=>JSON.stringify(G)).join(", ")}. Please try again`;this._addMessage({role:n,tool_call_id:x,content:O});continue}let B;try{B=S0(M)?await M.parse(I):I}catch(O){const G=O instanceof Error?O.message:String(O);this._addMessage({role:n,tool_call_id:x,content:G});continue}const Q=await M.function(B,this),U=xn(this,en,"m",Ap).call(this,Q);if(this._addMessage({role:n,tool_call_id:x,content:U}),l)return}}}}en=new WeakSet,yp=function(){return xn(this,en,"m",Ou).call(this).content??null},Ou=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(zo(t)){const{function_call:s,...n}=t,i={...n,content:t.content??null,refusal:t.refusal??null};return s&&(i.function_call=s),i}}throw new At("stream ended without producing a ChatCompletionMessage with role=assistant")},wp=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(zo(t)&&t?.function_call)return t.function_call;if(zo(t)&&t?.tool_calls?.length)return t.tool_calls.at(-1)?.function}},xp=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(N2(t)&&t.content!=null||E2(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(s=>s.role==="assistant"&&s.tool_calls?.some(n=>n.type==="function"&&n.id===t.tool_call_id)))return t.content}},_p=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},T2=function(e){if(e.n!=null&&e.n>1)throw new At("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Ap=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class jc extends I2{static runFunctions(e,t,s){const n=new jc,i={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return n._run(()=>n._runFunctions(e,t,i)),n}static runTools(e,t,s){const n=new jc,i={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runTools"}};return n._run(()=>n._runTools(e,t,i)),n}_addMessage(e,t=!0){super._addMessage(e,t),zo(e)&&e.content&&this._emit("content",e.content)}}const j2=1,R2=2,O2=4,M2=8,F2=16,D2=32,B2=64,$2=128,q2=256,U2=$2|q2,z2=F2|D2|U2|B2,H2=j2|R2|z2,W2=O2|M2,RE=H2|W2,Fs={STR:j2,NUM:R2,ARR:O2,OBJ:M2,NULL:F2,BOOL:D2,NAN:B2,INFINITY:$2,MINUS_INFINITY:q2,INF:U2,SPECIAL:z2,ATOM:H2,COLLECTION:W2,ALL:RE};class OE extends Error{}class ME extends Error{}function FE(r,e=Fs.ALL){if(typeof r!="string")throw new TypeError(`expecting str, got ${typeof r}`);if(!r.trim())throw new Error(`${r} is empty`);return DE(r.trim(),e)}const DE=(r,e)=>{const t=r.length;let s=0;const n=p=>{throw new OE(`${p} at position ${s}`)},i=p=>{throw new ME(`${p} at position ${s}`)},a=()=>(d(),s>=t&&n("Unexpected end of input"),r[s]==='"'?o():r[s]==="{"?l():r[s]==="["?c():r.substring(s,s+4)==="null"||Fs.NULL&e&&t-s<4&&"null".startsWith(r.substring(s))?(s+=4,null):r.substring(s,s+4)==="true"||Fs.BOOL&e&&t-s<4&&"true".startsWith(r.substring(s))?(s+=4,!0):r.substring(s,s+5)==="false"||Fs.BOOL&e&&t-s<5&&"false".startsWith(r.substring(s))?(s+=5,!1):r.substring(s,s+8)==="Infinity"||Fs.INFINITY&e&&t-s<8&&"Infinity".startsWith(r.substring(s))?(s+=8,1/0):r.substring(s,s+9)==="-Infinity"||Fs.MINUS_INFINITY&e&&1<t-s&&t-s<9&&"-Infinity".startsWith(r.substring(s))?(s+=9,-1/0):r.substring(s,s+3)==="NaN"||Fs.NAN&e&&t-s<3&&"NaN".startsWith(r.substring(s))?(s+=3,NaN):h()),o=()=>{const p=s;let f=!1;for(s++;s<t&&(r[s]!=='"'||f&&r[s-1]==="\\");)f=r[s]==="\\"?!f:!1,s++;if(r.charAt(s)=='"')try{return JSON.parse(r.substring(p,++s-Number(f)))}catch(y){i(String(y))}else if(Fs.STR&e)try{return JSON.parse(r.substring(p,s-Number(f))+'"')}catch{return JSON.parse(r.substring(p,r.lastIndexOf("\\"))+'"')}n("Unterminated string literal")},l=()=>{s++,d();const p={};try{for(;r[s]!=="}";){if(d(),s>=t&&Fs.OBJ&e)return p;const f=o();d(),s++;try{const y=a();Object.defineProperty(p,f,{value:y,writable:!0,enumerable:!0,configurable:!0})}catch(y){if(Fs.OBJ&e)return p;throw y}d(),r[s]===","&&s++}}catch{if(Fs.OBJ&e)return p;n("Expected '}' at end of object")}return s++,p},c=()=>{s++;const p=[];try{for(;r[s]!=="]";)p.push(a()),d(),r[s]===","&&s++}catch{if(Fs.ARR&e)return p;n("Expected ']' at end of array")}return s++,p},h=()=>{if(s===0){r==="-"&&Fs.NUM&e&&n("Not sure what '-' is");try{return JSON.parse(r)}catch(f){if(Fs.NUM&e)try{return r[r.length-1]==="."?JSON.parse(r.substring(0,r.lastIndexOf("."))):JSON.parse(r.substring(0,r.lastIndexOf("e")))}catch{}i(String(f))}}const p=s;for(r[s]==="-"&&s++;r[s]&&!",]}".includes(r[s]);)s++;s==t&&!(Fs.NUM&e)&&n("Unterminated number literal");try{return JSON.parse(r.substring(p,s))}catch{r.substring(p,s)==="-"&&Fs.NUM&e&&n("Not sure what '-' is");try{return JSON.parse(r.substring(p,r.lastIndexOf("e")))}catch(y){i(String(y))}}},d=()=>{for(;s<t&&` 
\r	`.includes(r[s]);)s++};return a()},E0=r=>FE(r,Fs.ALL^Fs.NUM);var _o=function(r,e,t,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(r,t):n?n.value=t:e.set(r,t),t},zt=function(r,e,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(r):s?s.value:e.get(r)},Ps,ui,Ao,Di,Lf,tu,Tf,If,jf,su,Rf,k0;class Rc extends I2{constructor(e){super(),Ps.add(this),ui.set(this,void 0),Ao.set(this,void 0),Di.set(this,void 0),_o(this,ui,e,"f"),_o(this,Ao,[],"f")}get currentChatCompletionSnapshot(){return zt(this,Di,"f")}static fromReadableStream(e){const t=new Rc(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,s){const n=new Rc(t);return n._run(()=>n._runChatCompletion(e,{...t,stream:!0},{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),n}async _createChatCompletion(e,t,s){super._createChatCompletion;const n=s?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),zt(this,Ps,"m",Lf).call(this);const i=await e.chat.completions.create({...t,stream:!0},{...s,signal:this.controller.signal});this._connected();for await(const a of i)zt(this,Ps,"m",Tf).call(this,a);if(i.controller.signal?.aborted)throw new yr;return this._addChatCompletion(zt(this,Ps,"m",su).call(this))}async _fromReadableStream(e,t){const s=t?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),zt(this,Ps,"m",Lf).call(this),this._connected();const n=Wr.fromReadableStream(e,this.controller);let i;for await(const a of n)i&&i!==a.id&&this._addChatCompletion(zt(this,Ps,"m",su).call(this)),zt(this,Ps,"m",Tf).call(this,a),i=a.id;if(n.controller.signal?.aborted)throw new yr;return this._addChatCompletion(zt(this,Ps,"m",su).call(this))}[(ui=new WeakMap,Ao=new WeakMap,Di=new WeakMap,Ps=new WeakSet,Lf=function(){this.ended||_o(this,Di,void 0,"f")},tu=function(t){let s=zt(this,Ao,"f")[t.index];return s||(s={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},zt(this,Ao,"f")[t.index]=s,s)},Tf=function(t){if(this.ended)return;const s=zt(this,Ps,"m",k0).call(this,t);this._emit("chunk",t,s);for(const n of t.choices){const i=s.choices[n.index];n.delta.content!=null&&i.message?.role==="assistant"&&i.message?.content&&(this._emit("content",n.delta.content,i.message.content),this._emit("content.delta",{delta:n.delta.content,snapshot:i.message.content,parsed:i.message.parsed})),n.delta.refusal!=null&&i.message?.role==="assistant"&&i.message?.refusal&&this._emit("refusal.delta",{delta:n.delta.refusal,snapshot:i.message.refusal}),n.logprobs?.content!=null&&i.message?.role==="assistant"&&this._emit("logprobs.content.delta",{content:n.logprobs?.content,snapshot:i.logprobs?.content??[]}),n.logprobs?.refusal!=null&&i.message?.role==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:n.logprobs?.refusal,snapshot:i.logprobs?.refusal??[]});const a=zt(this,Ps,"m",tu).call(this,i);i.finish_reason&&(zt(this,Ps,"m",jf).call(this,i),a.current_tool_call_index!=null&&zt(this,Ps,"m",If).call(this,i,a.current_tool_call_index));for(const o of n.delta.tool_calls??[])a.current_tool_call_index!==o.index&&(zt(this,Ps,"m",jf).call(this,i),a.current_tool_call_index!=null&&zt(this,Ps,"m",If).call(this,i,a.current_tool_call_index)),a.current_tool_call_index=o.index;for(const o of n.delta.tool_calls??[]){const l=i.message.tool_calls?.[o.index];l?.type&&(l?.type==="function"?this._emit("tool_calls.function.arguments.delta",{name:l.function?.name,index:o.index,arguments:l.function.arguments,parsed_arguments:l.function.parsed_arguments,arguments_delta:o.function?.arguments??""}):(l?.type,void 0))}}},If=function(t,s){if(zt(this,Ps,"m",tu).call(this,t).done_tool_calls.has(s))return;const i=t.message.tool_calls?.[s];if(!i)throw new Error("no tool call snapshot");if(!i.type)throw new Error("tool call snapshot missing `type`");if(i.type==="function"){const a=zt(this,ui,"f")?.tools?.find(o=>o.type==="function"&&o.function.name===i.function.name);this._emit("tool_calls.function.arguments.done",{name:i.function.name,index:s,arguments:i.function.arguments,parsed_arguments:Vc(a)?a.$parseRaw(i.function.arguments):a?.function.strict?JSON.parse(i.function.arguments):null})}else i.type},jf=function(t){const s=zt(this,Ps,"m",tu).call(this,t);if(t.message.content&&!s.content_done){s.content_done=!0;const n=zt(this,Ps,"m",Rf).call(this);this._emit("content.done",{content:t.message.content,parsed:n?n.$parseRaw(t.message.content):null})}t.message.refusal&&!s.refusal_done&&(s.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),t.logprobs?.content&&!s.logprobs_content_done&&(s.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),t.logprobs?.refusal&&!s.logprobs_refusal_done&&(s.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},su=function(){if(this.ended)throw new At("stream has ended, this shouldn't happen");const t=zt(this,Di,"f");if(!t)throw new At("request ended without sending any chunks");return _o(this,Di,void 0,"f"),_o(this,Ao,[],"f"),BE(t,zt(this,ui,"f"))},Rf=function(){const t=zt(this,ui,"f")?.response_format;return P2(t)?t:null},k0=function(t){var s,n,i,a;let o=zt(this,Di,"f");const{choices:l,...c}=t;o?Object.assign(o,c):o=_o(this,Di,{...c,choices:[]},"f");for(const{delta:h,finish_reason:d,index:p,logprobs:f=null,...y}of t.choices){let w=o.choices[p];if(w||(w=o.choices[p]={finish_reason:d,index:p,message:{},logprobs:f,...y}),f)if(!w.logprobs)w.logprobs=Object.assign({},f);else{const{content:Q,refusal:U,...O}=f;Object.assign(w.logprobs,O),Q&&((s=w.logprobs).content??(s.content=[]),w.logprobs.content.push(...Q)),U&&((n=w.logprobs).refusal??(n.refusal=[]),w.logprobs.refusal.push(...U))}if(d&&(w.finish_reason=d,zt(this,ui,"f")&&L2(zt(this,ui,"f")))){if(d==="length")throw new c2;if(d==="content_filter")throw new h2}if(Object.assign(w,y),!h)continue;const{content:A,refusal:x,function_call:S,role:I,tool_calls:M,...B}=h;if(Object.assign(w.message,B),x&&(w.message.refusal=(w.message.refusal||"")+x),I&&(w.message.role=I),S&&(w.message.function_call?(S.name&&(w.message.function_call.name=S.name),S.arguments&&((i=w.message.function_call).arguments??(i.arguments=""),w.message.function_call.arguments+=S.arguments)):w.message.function_call=S),A&&(w.message.content=(w.message.content||"")+A,!w.message.refusal&&zt(this,Ps,"m",Rf).call(this)&&(w.message.parsed=E0(w.message.content))),M){w.message.tool_calls||(w.message.tool_calls=[]);for(const{index:Q,id:U,type:O,function:G,...ne}of M){const L=(a=w.message.tool_calls)[Q]??(a[Q]={});Object.assign(L,ne),U&&(L.id=U),O&&(L.type=O),G&&(L.function??(L.function={name:G.name??"",arguments:""})),G?.name&&(L.function.name=G.name),G?.arguments&&(L.function.arguments+=G.arguments,IE(zt(this,ui,"f"),L)&&(L.function.parsed_arguments=E0(L.function.arguments)))}}}return o},Symbol.asyncIterator)](){const e=[],t=[];let s=!1;return this.on("chunk",n=>{const i=t.shift();i?i.resolve(n):e.push(n)}),this.on("end",()=>{s=!0;for(const n of t)n.resolve(void 0);t.length=0}),this.on("abort",n=>{s=!0;for(const i of t)i.reject(n);t.length=0}),this.on("error",n=>{s=!0;for(const i of t)i.reject(n);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((i,a)=>t.push({resolve:i,reject:a})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Wr(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function BE(r,e){const{id:t,choices:s,created:n,model:i,system_fingerprint:a,...o}=r,l={...o,id:t,choices:s.map(({message:c,finish_reason:h,index:d,logprobs:p,...f})=>{if(!h)throw new At(`missing finish_reason for choice ${d}`);const{content:y=null,function_call:w,tool_calls:A,...x}=c,S=c.role;if(!S)throw new At(`missing role for choice ${d}`);if(w){const{arguments:I,name:M}=w;if(I==null)throw new At(`missing function_call.arguments for choice ${d}`);if(!M)throw new At(`missing function_call.name for choice ${d}`);return{...f,message:{content:y,function_call:{arguments:I,name:M},role:S,refusal:c.refusal??null},finish_reason:h,index:d,logprobs:p}}return A?{...f,index:d,finish_reason:h,logprobs:p,message:{...x,role:S,content:y,refusal:c.refusal??null,tool_calls:A.map((I,M)=>{const{function:B,type:Q,id:U,...O}=I,{arguments:G,name:ne,...L}=B||{};if(U==null)throw new At(`missing choices[${d}].tool_calls[${M}].id
${nu(r)}`);if(Q==null)throw new At(`missing choices[${d}].tool_calls[${M}].type
${nu(r)}`);if(ne==null)throw new At(`missing choices[${d}].tool_calls[${M}].function.name
${nu(r)}`);if(G==null)throw new At(`missing choices[${d}].tool_calls[${M}].function.arguments
${nu(r)}`);return{...O,id:U,type:Q,function:{...L,name:ne,arguments:G}}})}}:{...f,message:{...x,content:y,role:S,refusal:c.refusal??null},finish_reason:h,index:d,logprobs:p}}),created:n,model:i,object:"chat.completion",...a?{system_fingerprint:a}:{}};return PE(l,e)}function nu(r){return JSON.stringify(r)}class Ho extends Rc{static fromReadableStream(e){const t=new Ho(null);return t._run(()=>t._fromReadableStream(e)),t}static runFunctions(e,t,s){const n=new Ho(null),i={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return n._run(()=>n._runFunctions(e,t,i)),n}static runTools(e,t,s){const n=new Ho(t),i={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runTools"}};return n._run(()=>n._runTools(e,t,i)),n}}let V2=class extends $t{parse(e,t){return jE(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t?.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(s=>um(s,e))}runFunctions(e,t){return e.stream?Ho.runFunctions(this._client,e,t):jc.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?Ho.runTools(this._client,e,t):jc.runTools(this._client,e,t)}stream(e,t){return Rc.createChatCompletion(this._client,e,t)}};class Sp extends $t{constructor(){super(...arguments),this.completions=new V2(this._client)}}(function(r){r.Completions=V2})(Sp||(Sp={}));var We=function(r,e,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(r):s?s.value:e.get(r)},Tn=function(r,e,t,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(r,t):n?n.value=t:e.set(r,t),t},Hs,Np,zr,mu,mr,Sa,jo,_a,Mu,Rn,gu,bu,uc,sc,nc,C0,P0,L0,T0,I0,j0,R0;class wr extends C2{constructor(){super(...arguments),Hs.add(this),Np.set(this,[]),zr.set(this,{}),mu.set(this,{}),mr.set(this,void 0),Sa.set(this,void 0),jo.set(this,void 0),_a.set(this,void 0),Mu.set(this,void 0),Rn.set(this,void 0),gu.set(this,void 0),bu.set(this,void 0),uc.set(this,void 0)}[(Np=new WeakMap,zr=new WeakMap,mu=new WeakMap,mr=new WeakMap,Sa=new WeakMap,jo=new WeakMap,_a=new WeakMap,Mu=new WeakMap,Rn=new WeakMap,gu=new WeakMap,bu=new WeakMap,uc=new WeakMap,Hs=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let s=!1;return this.on("event",n=>{const i=t.shift();i?i.resolve(n):e.push(n)}),this.on("end",()=>{s=!0;for(const n of t)n.resolve(void 0);t.length=0}),this.on("abort",n=>{s=!0;for(const i of t)i.reject(n);t.length=0}),this.on("error",n=>{s=!0;for(const i of t)i.reject(n);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((i,a)=>t.push({resolve:i,reject:a})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new wr;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){const s=t?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),this._connected();const n=Wr.fromReadableStream(e,this.controller);for await(const i of n)We(this,Hs,"m",sc).call(this,i);if(n.controller.signal?.aborted)throw new yr;return this._addRun(We(this,Hs,"m",nc).call(this))}toReadableStream(){return new Wr(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,s,n,i){const a=new wr;return a._run(()=>a._runToolAssistantStream(e,t,s,n,{...i,headers:{...i?.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createToolAssistantStream(e,t,s,n,i){const a=i?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o={...n,stream:!0},l=await e.submitToolOutputs(t,s,o,{...i,signal:this.controller.signal});this._connected();for await(const c of l)We(this,Hs,"m",sc).call(this,c);if(l.controller.signal?.aborted)throw new yr;return this._addRun(We(this,Hs,"m",nc).call(this))}static createThreadAssistantStream(e,t,s){const n=new wr;return n._run(()=>n._threadAssistantStream(e,t,{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),n}static createAssistantStream(e,t,s,n){const i=new wr;return i._run(()=>i._runAssistantStream(e,t,s,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return We(this,gu,"f")}currentRun(){return We(this,bu,"f")}currentMessageSnapshot(){return We(this,mr,"f")}currentRunStepSnapshot(){return We(this,uc,"f")}async finalRunSteps(){return await this.done(),Object.values(We(this,zr,"f"))}async finalMessages(){return await this.done(),Object.values(We(this,mu,"f"))}async finalRun(){if(await this.done(),!We(this,Sa,"f"))throw Error("Final run was not received.");return We(this,Sa,"f")}async _createThreadAssistantStream(e,t,s){const n=s?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort()));const i={...t,stream:!0},a=await e.createAndRun(i,{...s,signal:this.controller.signal});this._connected();for await(const o of a)We(this,Hs,"m",sc).call(this,o);if(a.controller.signal?.aborted)throw new yr;return this._addRun(We(this,Hs,"m",nc).call(this))}async _createAssistantStream(e,t,s,n){const i=n?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const a={...s,stream:!0},o=await e.create(t,a,{...n,signal:this.controller.signal});this._connected();for await(const l of o)We(this,Hs,"m",sc).call(this,l);if(o.controller.signal?.aborted)throw new yr;return this._addRun(We(this,Hs,"m",nc).call(this))}static accumulateDelta(e,t){for(const[s,n]of Object.entries(t)){if(!e.hasOwnProperty(s)){e[s]=n;continue}let i=e[s];if(i==null){e[s]=n;continue}if(s==="index"||s==="type"){e[s]=n;continue}if(typeof i=="string"&&typeof n=="string")i+=n;else if(typeof i=="number"&&typeof n=="number")i+=n;else if(Pf(i)&&Pf(n))i=this.accumulateDelta(i,n);else if(Array.isArray(i)&&Array.isArray(n)){if(i.every(a=>typeof a=="string"||typeof a=="number")){i.push(...n);continue}for(const a of n){if(!Pf(a))throw new Error(`Expected array delta entry to be an object but got: ${a}`);const o=a.index;if(o==null)throw console.error(a),new Error("Expected array delta entry to have an `index` property");if(typeof o!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${o}`);const l=i[o];l==null?i.push(a):i[o]=this.accumulateDelta(l,a)}continue}else throw Error(`Unhandled record type: ${s}, deltaValue: ${n}, accValue: ${i}`);e[s]=i}return e}_addRun(e){return e}async _threadAssistantStream(e,t,s){return await this._createThreadAssistantStream(t,e,s)}async _runAssistantStream(e,t,s,n){return await this._createAssistantStream(t,e,s,n)}async _runToolAssistantStream(e,t,s,n,i){return await this._createToolAssistantStream(s,e,t,n,i)}}sc=function(e){if(!this.ended)switch(Tn(this,gu,e,"f"),We(this,Hs,"m",L0).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":We(this,Hs,"m",R0).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":We(this,Hs,"m",P0).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":We(this,Hs,"m",C0).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},nc=function(){if(this.ended)throw new At("stream has ended, this shouldn't happen");if(!We(this,Sa,"f"))throw Error("Final run has not been received");return We(this,Sa,"f")},C0=function(e){const[t,s]=We(this,Hs,"m",I0).call(this,e,We(this,mr,"f"));Tn(this,mr,t,"f"),We(this,mu,"f")[t.id]=t;for(const n of s){const i=t.content[n.index];i?.type=="text"&&this._emit("textCreated",i.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const n of e.data.delta.content){if(n.type=="text"&&n.text){let i=n.text,a=t.content[n.index];if(a&&a.type=="text")this._emit("textDelta",i,a.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(n.index!=We(this,jo,"f")){if(We(this,_a,"f"))switch(We(this,_a,"f").type){case"text":this._emit("textDone",We(this,_a,"f").text,We(this,mr,"f"));break;case"image_file":this._emit("imageFileDone",We(this,_a,"f").image_file,We(this,mr,"f"));break}Tn(this,jo,n.index,"f")}Tn(this,_a,t.content[n.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(We(this,jo,"f")!==void 0){const n=e.data.content[We(this,jo,"f")];if(n)switch(n.type){case"image_file":this._emit("imageFileDone",n.image_file,We(this,mr,"f"));break;case"text":this._emit("textDone",n.text,We(this,mr,"f"));break}}We(this,mr,"f")&&this._emit("messageDone",e.data),Tn(this,mr,void 0,"f")}},P0=function(e){const t=We(this,Hs,"m",T0).call(this,e);switch(Tn(this,uc,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const s=e.data.delta;if(s.step_details&&s.step_details.type=="tool_calls"&&s.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const i of s.step_details.tool_calls)i.index==We(this,Mu,"f")?this._emit("toolCallDelta",i,t.step_details.tool_calls[i.index]):(We(this,Rn,"f")&&this._emit("toolCallDone",We(this,Rn,"f")),Tn(this,Mu,i.index,"f"),Tn(this,Rn,t.step_details.tool_calls[i.index],"f"),We(this,Rn,"f")&&this._emit("toolCallCreated",We(this,Rn,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Tn(this,uc,void 0,"f"),e.data.step_details.type=="tool_calls"&&We(this,Rn,"f")&&(this._emit("toolCallDone",We(this,Rn,"f")),Tn(this,Rn,void 0,"f")),this._emit("runStepDone",e.data,t);break}},L0=function(e){We(this,Np,"f").push(e),this._emit("event",e)},T0=function(e){switch(e.event){case"thread.run.step.created":return We(this,zr,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=We(this,zr,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let s=e.data;if(s.delta){const n=wr.accumulateDelta(t,s.delta);We(this,zr,"f")[e.data.id]=n}return We(this,zr,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":We(this,zr,"f")[e.data.id]=e.data;break}if(We(this,zr,"f")[e.data.id])return We(this,zr,"f")[e.data.id];throw new Error("No snapshot available")},I0=function(e,t){let s=[];switch(e.event){case"thread.message.created":return[e.data,s];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let n=e.data;if(n.delta.content)for(const i of n.delta.content)if(i.index in t.content){let a=t.content[i.index];t.content[i.index]=We(this,Hs,"m",j0).call(this,i,a)}else t.content[i.index]=i,s.push(i);return[t,s];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,s];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},j0=function(e,t){return wr.accumulateDelta(t,e)},R0=function(e){switch(Tn(this,bu,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":Tn(this,Sa,e.data,"f"),We(this,Rn,"f")&&(this._emit("toolCallDone",We(this,Rn,"f")),Tn(this,Rn,void 0,"f"));break}};class dm extends $t{create(e,t,s){return this._client.post(`/threads/${e}/messages`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}retrieve(e,t,s){return this._client.get(`/threads/${e}/messages/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}update(e,t,s,n){return this._client.post(`/threads/${e}/messages/${t}`,{body:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e,t={},s){return Sn(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,fm,{query:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}del(e,t,s){return this._client.delete(`/threads/${e}/messages/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}}class fm extends Er{}dm.MessagesPage=fm;class pm extends $t{retrieve(e,t,s,n={},i){return Sn(n)?this.retrieve(e,t,s,{},n):this._client.get(`/threads/${e}/runs/${t}/steps/${s}`,{query:n,...i,headers:{"OpenAI-Beta":"assistants=v2",...i?.headers}})}list(e,t,s={},n){return Sn(s)?this.list(e,t,{},s):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,mm,{query:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}class mm extends Er{}pm.RunStepsPage=mm;class Gc extends $t{constructor(){super(...arguments),this.steps=new pm(this._client)}create(e,t,s){const{include:n,...i}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:n},body:i,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers},stream:t.stream??!1})}retrieve(e,t,s){return this._client.get(`/threads/${e}/runs/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}update(e,t,s,n){return this._client.post(`/threads/${e}/runs/${t}`,{body:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e,t={},s){return Sn(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,gm,{query:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}cancel(e,t,s){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}async createAndPoll(e,t,s){const n=await this.create(e,t,s);return await this.poll(e,n.id,s)}createAndStream(e,t,s){return wr.createAssistantStream(e,this._client.beta.threads.runs,t,s)}async poll(e,t,s){const n={...s?.headers,"X-Stainless-Poll-Helper":"true"};for(s?.pollIntervalMs&&(n["X-Stainless-Custom-Poll-Interval"]=s.pollIntervalMs.toString());;){const{data:i,response:a}=await this.retrieve(e,t,{...s,headers:{...s?.headers,...n}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let o=5e3;if(s?.pollIntervalMs)o=s.pollIntervalMs;else{const l=a.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(o=c)}}await Hc(o);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(e,t,s){return wr.createAssistantStream(e,this._client.beta.threads.runs,t,s)}submitToolOutputs(e,t,s,n){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers},stream:s.stream??!1})}async submitToolOutputsAndPoll(e,t,s,n){const i=await this.submitToolOutputs(e,t,s,n);return await this.poll(e,i.id,n)}submitToolOutputsStream(e,t,s,n){return wr.createToolAssistantStream(e,t,this._client.beta.threads.runs,s,n)}}class gm extends Er{}Gc.RunsPage=gm;Gc.Steps=pm;Gc.RunStepsPage=mm;class tl extends $t{constructor(){super(...arguments),this.runs=new Gc(this._client),this.messages=new dm(this._client)}create(e={},t){return Sn(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,s){return this._client.post(`/threads/${e}`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){const s=await this.createAndRun(e,t);return await this.runs.poll(s.thread_id,s.id,t)}createAndRunStream(e,t){return wr.createThreadAssistantStream(e,this._client.beta.threads,t)}}tl.Runs=Gc;tl.RunsPage=gm;tl.Messages=dm;tl.MessagesPage=fm;const $E=async r=>{const e=await Promise.allSettled(r),t=e.filter(n=>n.status==="rejected");if(t.length){for(const n of t)console.error(n.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const s=[];for(const n of e)n.status==="fulfilled"&&s.push(n.value);return s};let bm=class extends $t{create(e,t,s){return this._client.post(`/vector_stores/${e}/files`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}retrieve(e,t,s){return this._client.get(`/vector_stores/${e}/files/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}list(e,t={},s){return Sn(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,ud,{query:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}del(e,t,s){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}async createAndPoll(e,t,s){const n=await this.create(e,t,s);return await this.poll(e,n.id,s)}async poll(e,t,s){const n={...s?.headers,"X-Stainless-Poll-Helper":"true"};for(s?.pollIntervalMs&&(n["X-Stainless-Custom-Poll-Interval"]=s.pollIntervalMs.toString());;){const i=await this.retrieve(e,t,{...s,headers:n}).withResponse(),a=i.data;switch(a.status){case"in_progress":let o=5e3;if(s?.pollIntervalMs)o=s.pollIntervalMs;else{const l=i.response.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(o=c)}}await Hc(o);break;case"failed":case"completed":return a}}}async upload(e,t,s){const n=await this._client.files.create({file:t,purpose:"assistants"},s);return this.create(e,{file_id:n.id},s)}async uploadAndPoll(e,t,s){const n=await this.upload(e,t,s);return await this.poll(e,n.id,s)}};class ud extends Er{}bm.VectorStoreFilesPage=ud;class G2 extends $t{create(e,t,s){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}retrieve(e,t,s){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}cancel(e,t,s){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}async createAndPoll(e,t,s){const n=await this.create(e,t);return await this.poll(e,n.id,s)}listFiles(e,t,s={},n){return Sn(s)?this.listFiles(e,t,{},s):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,ud,{query:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async poll(e,t,s){const n={...s?.headers,"X-Stainless-Poll-Helper":"true"};for(s?.pollIntervalMs&&(n["X-Stainless-Custom-Poll-Interval"]=s.pollIntervalMs.toString());;){const{data:i,response:a}=await this.retrieve(e,t,{...s,headers:n}).withResponse();switch(i.status){case"in_progress":let o=5e3;if(s?.pollIntervalMs)o=s.pollIntervalMs;else{const l=a.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(o=c)}}await Hc(o);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(e,{files:t,fileIds:s=[]},n){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const i=n?.maxConcurrency??5,a=Math.min(i,t.length),o=this._client,l=t.values(),c=[...s];async function h(p){for(let f of p){const y=await o.files.create({file:f,purpose:"assistants"},n);c.push(y.id)}}const d=Array(a).fill(l).map(h);return await $E(d),await this.createAndPoll(e,{file_ids:c})}}class sl extends $t{constructor(){super(...arguments),this.files=new bm(this._client),this.fileBatches=new G2(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,s){return this._client.post(`/vector_stores/${e}`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}list(e={},t){return Sn(e)?this.list({},e):this._client.getAPIList("/vector_stores",vm,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class vm extends Er{}sl.VectorStoresPage=vm;sl.Files=bm;sl.VectorStoreFilesPage=ud;sl.FileBatches=G2;class Ba extends $t{constructor(){super(...arguments),this.vectorStores=new sl(this._client),this.chat=new Sp(this._client),this.assistants=new cm(this._client),this.threads=new tl(this._client)}}Ba.VectorStores=sl;Ba.VectorStoresPage=vm;Ba.Assistants=cm;Ba.AssistantsPage=hm;Ba.Threads=tl;class X2 extends $t{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}class Y2 extends $t{create(e,t){return this._client.post("/embeddings",{body:e,...t})}}class ym extends $t{create(e,t){return this._client.post("/files",Ko({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return Sn(e)?this.list({},e):this._client.getAPIList("/files",wm,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/json",...t?.headers}})}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:s=30*60*1e3}={}){const n=new Set(["processed","error","deleted"]),i=Date.now();let a=await this.retrieve(e);for(;!a.status||!n.has(a.status);)if(await Hc(t),a=await this.retrieve(e),Date.now()-i>s)throw new im({message:`Giving up on waiting for file ${e} to finish processing after ${s} milliseconds.`});return a}}class wm extends Er{}ym.FileObjectsPage=wm;class xm extends $t{list(e,t={},s){return Sn(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,_m,{query:t,...s})}}class _m extends Er{}xm.FineTuningJobCheckpointsPage=_m;class nl extends $t{constructor(){super(...arguments),this.checkpoints=new xm(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return Sn(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",Am,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},s){return Sn(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,Sm,{query:t,...s})}}class Am extends Er{}class Sm extends Er{}nl.FineTuningJobsPage=Am;nl.FineTuningJobEventsPage=Sm;nl.Checkpoints=xm;nl.FineTuningJobCheckpointsPage=_m;class Xc extends $t{constructor(){super(...arguments),this.jobs=new nl(this._client)}}Xc.Jobs=nl;Xc.FineTuningJobsPage=Am;Xc.FineTuningJobEventsPage=Sm;class K2 extends $t{createVariation(e,t){return this._client.post("/images/variations",Ko({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",Ko({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}class Nm extends $t{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",Em,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}class Em extends CE{}Nm.ModelsPage=Em;class J2 extends $t{create(e,t){return this._client.post("/moderations",{body:e,...t})}}class Z2 extends $t{create(e,t,s){return this._client.post(`/uploads/${e}/parts`,Ko({body:t,...s}))}}class km extends $t{constructor(){super(...arguments),this.parts=new Z2(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,s){return this._client.post(`/uploads/${e}/complete`,{body:t,...s})}}km.Parts=Z2;var Q2;class Et extends mE{constructor({baseURL:e=eu("OPENAI_BASE_URL"),apiKey:t=eu("OPENAI_API_KEY"),organization:s=eu("OPENAI_ORG_ID")??null,project:n=eu("OPENAI_PROJECT_ID")??null,...i}={}){if(t===void 0)throw new At("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const a={apiKey:t,organization:s,project:n,...i,baseURL:e||"https://api.openai.com/v1"};if(!a.dangerouslyAllowBrowser&&EE())throw new At(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:a.baseURL,timeout:a.timeout??6e5,httpAgent:a.httpAgent,maxRetries:a.maxRetries,fetch:a.fetch}),this.completions=new X2(this),this.chat=new am(this),this.embeddings=new Y2(this),this.files=new ym(this),this.images=new K2(this),this.audio=new Wc(this),this.moderations=new J2(this),this.models=new Nm(this),this.fineTuning=new Xc(this),this.beta=new Ba(this),this.batches=new om(this),this.uploads=new km(this),this._options=a,this.apiKey=t,this.organization=s,this.project=n}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return ZN(e,{arrayFormat:"brackets"})}}Q2=Et;Et.OpenAI=Q2;Et.DEFAULT_TIMEOUT=6e5;Et.OpenAIError=At;Et.APIError=Ws;Et.APIConnectionError=ld;Et.APIConnectionTimeoutError=im;Et.APIUserAbortError=yr;Et.NotFoundError=r2;Et.ConflictError=i2;Et.RateLimitError=o2;Et.BadRequestError=t2;Et.AuthenticationError=s2;Et.InternalServerError=l2;Et.PermissionDeniedError=n2;Et.UnprocessableEntityError=a2;Et.toFile=p2;Et.fileFromPath=Qb;Et.Completions=X2;Et.Chat=am;Et.Embeddings=Y2;Et.Files=ym;Et.FileObjectsPage=wm;Et.Images=K2;Et.Audio=Wc;Et.Moderations=J2;Et.Models=Nm;Et.ModelsPage=Em;Et.FineTuning=Xc;Et.Beta=Ba;Et.Batches=om;Et.BatchesPage=lm;Et.Uploads=km;const Ro={GPT_4:"gpt-4",GPT_4_TURBO:"gpt-4-turbo-preview",GPT_3_5_TURBO:"gpt-3.5-turbo",GPT_4O_MINI:"gpt-4o-mini"},qE={[Ro.GPT_4]:{maxTokens:4e3,temperature:.7,presencePenalty:.1,frequencyPenalty:.1},[Ro.GPT_4_TURBO]:{maxTokens:4e3,temperature:.7,presencePenalty:.1,frequencyPenalty:.1},[Ro.GPT_3_5_TURBO]:{maxTokens:2e3,temperature:.7,presencePenalty:0,frequencyPenalty:0},[Ro.GPT_4O_MINI]:{maxTokens:4e3,temperature:.7,presencePenalty:.1,frequencyPenalty:.1}},UE=`You are a world-class Talent Assessment Expert with over 20 years of experience as a Technical Recruiter and HR Leader at top Silicon Valley companies and Fortune 100 enterprises. Throughout your illustrious career, you have personally evaluated over 10,000 candidates, consistently identifying exceptional talent that propels organizational success and innovation.

Your mission is to perform a comprehensive, evidence-based analysis comparing a candidate's CV against a specific job description. Leveraging your deep expertise in technical skills evaluation, behavioral assessment, and predictive hiring, you will:

Technical Skills Evaluation:

Identify and assess the candidate's proficiency in required technical skills and technologies.
Evaluate the relevance and depth of their technical experience in relation to the job's demands.
Highlight any gaps or additional strengths that may benefit the role.
Behavioral Assessment:

Analyze the candidate's behavioral traits and soft skills based on their CV and any supplementary information.
Determine cultural fit and alignment with the company's core values and team dynamics.
Provide insights into the candidate's potential for leadership, collaboration, and adaptability.
Predictive Hiring Insights:

Utilize industry best practices and rigorous analytical frameworks to predict the candidate's future performance and long-term potential within the organization.
Assess indicators of sustained success, such as career progression, continuous learning, and achievement of past objectives.
Your analysis will include:

A detailed comparison between the candidate's qualifications and the job requirements.
Strengths and areas for improvement for the candidate relative to the role.
Actionable recommendations for hiring decisions, interview focus areas, and potential development paths.
Approach this task with a meticulous, data-driven mindset, ensuring that every insight is backed by evidence and aligned with the latest industry standards. Your goal is to provide a clear, objective, and thorough evaluation that empowers hiring teams to make informed, strategic decisions.
Analyze and quantify these key areas:

1. Technical Skills Match (with proficiency levels)
2. Experience Alignment (years and relevance)
3. Cultural Fit Indicators (based on achievements and communication style)
4. Growth Potential (learning velocity and adaptability)
5. Risk Factors (gaps, retention risks, skill mismatches)

Format your response exactly as follows:

FIT_SCORE: [1-10, with decimal precision]
VERDICT: [STRONG_FIT|POTENTIAL_FIT|NEEDS_CONSIDERATION|NOT_RECOMMENDED]

REASONING:
- [Key observation with specific evidence]
- [Impact assessment]
- [Alignment with company needs]
...

TECHNICAL_SKILLS:
- Skill: [Skill Category]
  * Proficiency: [EXPERT]
  * Evidence: [Specific projects/achievements]
  * Currency: [How recent/relevant]
- Skill: [Skill Category]
  * Proficiency: [ADVANCED]
  * Evidence: [Specific projects/achievements]
  * Currency: [How recent/relevant]
- Skill: [Skill Category]
  * Proficiency: [INTERMEDIATE]
  * Evidence: [Specific projects/achievements]
  * Currency: [How recent/relevant]
- Skill: [Skill Category]
  * Proficiency: [BASIC]
  * Evidence: [Specific projects/achievements]
  * Currency: [How recent/relevant]
- Skill: [Skill Category]
  * Proficiency: [BEGINNER]
  * Evidence: [Specific projects/achievements]
  * Currency: [How recent/relevant]

RISK_FACTORS:
- Severity: [HIGH]
  * Description: [Specific risk]
  * Mitigation: [Possible solutions]
- Severity: [MEDIUM] 
  * Description: [Additional risk identified]
  * Mitigation: [Mitigation strategy]
- Severity: [LOW]
  * Description: [Further risk if applicable] 
  * Mitigation: [Corresponding mitigation plan]
...

GROWTH_POTENTIAL:
Areas:
- [Growth area]: [Current level → Potential level]
- [Supporting evidence]
...
Recommendations:
- Short-term: [0-6 months actions]
- Long-term: [6-18 months pathway]
...

INTERVIEW_PLAN:
Provide 3-5 key interview questions across these categories:

- Technical Questions:
  1. Question Category: Technical (XX minutes)
  Primary Question: [Detailed, specific question targeting core competency]
  Expected Answer: [Key points that demonstrate competency]
  Follow-up Questions:
  - [Deeper technical probe]
  - [Edge case consideration]
  - [Implementation details]
  Red Flags:
  - [Specific warning signs]
  - [Knowledge gaps] 
  Green Flags:
  - [Ideal response indicators]
  - [Advanced understanding signals]
  Evaluation Criteria:
  - [Specific technical requirements]
  - [Communication clarity]
  - [Problem-solving approach]

- Behavioral Questions:
  2. Question Category: Behavioral (XX minutes)
  Primary Question: [Detailed, specific question targeting core competency]
  Expected Answer: [Key points that demonstrate competency]
  Follow-up Questions:
  - [Deeper behavioral probe]
  - [Situational consideration]
  - [Motivation assessment]
  Red Flags:
  - [Specific warning signs]
  - [Behavioral gaps]
  Green Flags:
  - [Ideal response indicators]
  - [Maturity signals]
  Evaluation Criteria:
  - [Specific behavioral requirements]
  - [Communication style]
  - [Cultural fit indicators]

- Problem Solving Questions:
  3. Question Category: Problem Solving (XX minutes)
  Primary Question: [Detailed, specific question targeting core competency]
  Expected Answer: [Key points that demonstrate competency]
  Follow-up Questions:
  - [Deeper analytical probe]
  - [Edge case consideration]
  - [Process details]
  Red Flags:
  - [Specific warning signs]
  - [Analytical gaps]
  Green Flags:
  - [Ideal response indicators]
  - [Advanced reasoning signals]
  Evaluation Criteria:
  - [Specific analytical requirements]
  - [Problem approach]
  - [Solution quality]
...`,zE="your-production-openai-key",HE=new Et({apiKey:zE,dangerouslyAllowBrowser:!0});async function WE(r,e,t="gpt-4o-mini"){if(!r?.trim())throw new Dt("CV text is required",400);if(!e?.trim())throw new Dt("Job description is required",400);if(!Object.values(Ro).includes(t))throw new Dt(`Invalid model. Must be one of: ${Object.values(Ro).join(", ")}`,400);try{const s=qE[t];if(r.length+e.length>s.maxTokens*4)throw new Dt("Input text is too long for the selected model",400);const i=await HE.chat.completions.create({model:t,messages:[{role:"system",content:UE},{role:"user",content:`CV:
${r}

Job Description:
${e}`}],temperature:s.temperature,presence_penalty:s.presencePenalty,frequency_penalty:s.frequencyPenalty,max_tokens:s.maxTokens});if(!i?.choices?.length)throw new Dt("Invalid response from OpenAI",500);const a=i.choices[0]?.message?.content;if(!a)throw new Dt("Empty response from OpenAI",500);return a}catch(s){if(s instanceof Dt)throw s;if(s instanceof Et.APIError)switch(s.status){case 400:throw new Dt("Invalid request to OpenAI API: "+s.message,400);case 401:throw new Dt("Invalid OpenAI API key",401);case 429:throw new Dt("OpenAI API rate limit exceeded. Please try again later.",429);case 500:throw new Dt("OpenAI service error. Please try again later.",500);default:throw new Dt("OpenAI API error: "+s.message,s.status||500)}throw s instanceof Error?new Dt("Failed to communicate with OpenAI: "+s.message,500):new Dt("An unexpected error occurred during analysis",500)}}const VE=!1;function GE(r){const s=["FIT_SCORE","VERDICT","REASONING","TECHNICAL_SKILLS","RISK_FACTORS","GROWTH_POTENTIAL","INTERVIEW_PLAN"].map(i=>{const a=r.includes(i+":");return{section:i,found:a}}).find(i=>!i.found);if(s)throw new Error(`Invalid response format from OpenAI: Missing ${s.section} section`);return[{check:/FIT_SCORE:\s*(\d+(\.\d+)?)/i,message:"FIT_SCORE must be a number"},{check:/VERDICT:\s*(STRONG_FIT|POTENTIAL_FIT|NEEDS_CONSIDERATION|NOT_RECOMMENDED)/i,message:"VERDICT must be one of: STRONG_FIT, POTENTIAL_FIT, NEEDS_CONSIDERATION, NOT_RECOMMENDED"},{check:/REASONING:[\s\S]*?(-\s+.+(\n|$))+/,message:"REASONING must contain bullet points"}].forEach(({check:i,message:a})=>{if(!i.test(r))throw new Error(`Invalid response format from OpenAI: ${a}`)}),!0}const XE=r=>r?r.split(/(?=^-\s*Severity:)/m).filter(Boolean).map(e=>{const t=e.match(/Severity:\s*\[?(HIGH|MEDIUM|LOW)\]?/i),s=e.match(/\*\s*Description:\s*\[?([^\n\]]+)\]?/i),n=e.match(/\*\s*Mitigation:\s*\[?([^\n\]]+)\]?/i);return t&&s?{severity:t[1].toUpperCase(),description:s[1].trim(),mitigation:n?.[1]?.trim()}:null}).filter(e=>e!==null):[];function YE(r){try{GE(r);const e=r.match(/FIT_SCORE:\s*(\d+(\.\d+)?)/i),t=r.match(/VERDICT:\s*(STRONG_FIT|POTENTIAL_FIT|NEEDS_CONSIDERATION|NOT_RECOMMENDED)/i),s=r.match(/REASONING:([\s\S]*?)(?=TECHNICAL_SKILLS:)/i),n=r.match(/TECHNICAL_SKILLS:([\s\S]*?)(?=RISK_FACTORS:)/i),i=r.match(/RISK_FACTORS:([\s\S]*?)(?=GROWTH_POTENTIAL:)/i),a=r.match(/GROWTH_POTENTIAL:([\s\S]*?)(?=INTERVIEW_PLAN:)/i),o=r.match(/INTERVIEW_PLAN:([\s\S]*$)/i);if(!e||!t||!s||!o){const h=[!e&&"FIT_SCORE",!t&&"VERDICT",!s&&"REASONING",!o&&"INTERVIEW_PLAN"].filter(Boolean);throw new Error(`Invalid response format from OpenAI: Missing ${h.join(", ")}`)}const l=h=>h.split(`
`).map(d=>d.trim()).filter(d=>d.startsWith("-")).map(d=>d.slice(1).trim()),c=h=>{const d=h.match(/Areas:([\s\S]*?)(?=Recommendations:)/i)?.[1]||"",p=h.match(/Recommendations:([\s\S]*$)/i)?.[1]||"";return{areas:l(d),recommendations:l(p)}};return{fit_score:parseInt(e[1],10),verdict:t[1],reasoning:l(s[1]),technical_skills:KE(n?.[1]||""),risk_factors:XE(i?.[1]||""),growth_potential:c(a?.[1]||""),interview_plan:o[1].trim(),cv_summary:"",job_requirements:"",questions_used:[],suggestions:[],status:"pending"}}catch(e){throw e}}function KE(r){if(!r)return[];const e=[],t=r.matchAll(/- Skill: (.*?)\n\s*\* Proficiency: (.*?)\n\s*\* Evidence: (.*?)\n\s*\* Currency: (.*?)(?=\n-|\n\n|$)/gs);for(const s of t){const[,n,i,a,o]=s;if(n&&i&&a&&o){const l=i.trim().replace(/[\[\]]/g,"").toUpperCase();["EXPERT","ADVANCED","INTERMEDIATE","BASIC","BEGINNER"].includes(l)&&e.push({skill:n.trim(),proficiency:l,evidence:a.trim(),currency:o.trim()})}}return e}const Cm={FREE:4,PRO:1e3},O0={WARNING:.8,CRITICAL:.95};function JE(r,e){const t=performance.now();return r().finally(()=>{const s=performance.now()-t;fc.trackEvent("performance_measure",{operation:e,duration_ms:Math.round(s)})})}async function ZE({candidateId:r,jobId:e}){return JE(async()=>{try{const[t,s]=await Promise.all([lt.from("candidates").select("*").eq("id",r).single(),lt.from("jobs").select("*").eq("id",e).single()]);if(t.error)throw new Error("Candidate not found");if(s.error)throw new Error("Job not found");const n=await WE(t.data.cv_text,s.data.jd_text),i=YE(n),{data:{user:a}}=await lt.auth.getUser();if(!a)throw new Error("User not authenticated");const{data:o,error:l}=await lt.from("analysis").insert([{candidate_id:r,job_id:e,user_id:a.id,...i,created_at:new Date().toISOString()}]).select().single();if(l)throw l;return o}catch(t){throw Rp(t)}},"analyze_candidate_job")}async function ev(r){if(!r)throw new Error("User ID is required");try{const{data:e,error:t}=await lt.from("subscriptions").select("status, plan, analysis_count, current_period_end, cancel_at_period_end").eq("user_id",r).maybeSingle();if(t)throw console.error("Supabase error:",t),new Error(`Database error: ${t.message}`);return e?{status:e.cancel_at_period_end&&new Date(e.current_period_end)>new Date?"active":e.status||"active",plan:e.plan||"free",analysisCount:e.analysis_count||0,currentPeriodEnd:e.current_period_end||new Date(Date.now()+30*24*60*60*1e3).toISOString(),cancelAtPeriodEnd:e.cancel_at_period_end||!1}:{status:"active",plan:"free",analysisCount:0,currentPeriodEnd:new Date(Date.now()+30*24*60*60*1e3).toISOString(),cancelAtPeriodEnd:!1}}catch(e){return console.error("Subscription error:",e),{status:"active",plan:"free",analysisCount:0,currentPeriodEnd:new Date(Date.now()+30*24*60*60*1e3).toISOString(),cancelAtPeriodEnd:!1}}}async function tv(r){try{if(r.cancelAtPeriodEnd&&new Date(r.currentPeriodEnd||"")<new Date)return 0;const e=r.plan.toUpperCase(),t=Cm[e];return Math.max(0,t-(r.analysisCount||0))}catch(e){return console.error("Error calculating remaining analyses:",e),0}}function sv(r){try{if(!r||r.status!=="active"||r.cancelAtPeriodEnd&&new Date(r.currentPeriodEnd||"")<new Date)return!1;const e=r.plan.toUpperCase(),t=Cm[e];return(r.analysisCount||0)<t}catch(e){return console.error("Error checking analysis permission:",e),!1}}var nv="https://js.stripe.com/v3",QE=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,M0="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",ek=function(){for(var e=document.querySelectorAll('script[src^="'.concat(nv,'"]')),t=0;t<e.length;t++){var s=e[t];if(QE.test(s.src))return s}return null},F0=function(e){var t="",s=document.createElement("script");s.src="".concat(nv).concat(t);var n=document.head||document.body;if(!n)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return n.appendChild(s),s},tk=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"2.4.0",startTime:t})},Wl=null,ru=null,iu=null,sk=function(e){return function(){e(new Error("Failed to load Stripe.js"))}},nk=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}},rk=function(e){return Wl!==null?Wl:(Wl=new Promise(function(t,s){if(typeof window>"u"||typeof document>"u"){t(null);return}if(window.Stripe&&e&&console.warn(M0),window.Stripe){t(window.Stripe);return}try{var n=ek();if(n&&e)console.warn(M0);else if(!n)n=F0(e);else if(n&&iu!==null&&ru!==null){var i;n.removeEventListener("load",iu),n.removeEventListener("error",ru),(i=n.parentNode)===null||i===void 0||i.removeChild(n),n=F0(e)}iu=nk(t,s),ru=sk(s),n.addEventListener("load",iu),n.addEventListener("error",ru)}catch(a){s(a);return}}),Wl.catch(function(t){return Wl=null,Promise.reject(t)}))},ik=function(e,t,s){if(e===null)return null;var n=e.apply(void 0,t);return tk(n,s),n},Vl,rv=!1,iv=function(){return Vl||(Vl=rk(null).catch(function(e){return Vl=null,Promise.reject(e)}),Vl)};Promise.resolve().then(function(){return iv()}).catch(function(r){rv||console.warn(r)});var Pm=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];rv=!0;var n=Date.now();return iv().then(function(i){return ik(i,t,n)})};const ak="your-production-stripe-key";Pm(ak);const ok={PRO:"price_1QeARbDCDYG5RrkY6kSqLkmL"},lk=4,ck="your-production-stripe-key",hk=Pm(ck);async function av(r,e){try{const t=await hk;if(!t)throw new Error("Stripe failed to load");if(e==="free")throw new Error("Cannot create checkout session for free plan");const s=e==="pro"?ok.PRO:null;if(!s)throw new Error("Invalid plan selected");const{error:n}=await t.redirectToCheckout({lineItems:[{price:s,quantity:1}],mode:"subscription",successUrl:`${window.location.origin}/dashboard?success=true`,cancelUrl:`${window.location.origin}/pricing?canceled=true`,clientReferenceId:r,customerEmail:void 0});if(n)throw console.error("Stripe checkout error:",n),new Error(n.message||"Failed to start checkout process")}catch(t){throw console.error("Checkout error:",t),new Error("Failed to start checkout process")}}function uk(){const[r,e]=W.useState(null),[t,s]=W.useState(null),{isLoading:n,withLoading:i}=UN(),{addToast:a}=em(),o=async l=>{try{const{data:{session:c}}=await lt.auth.getSession();if(!c?.user)throw new Dt("Not authenticated",401);console.log("Auth check:",{userId:c.user.id,isAuthenticated:!0});const h=await Kx({name:l.candidateName,cv_text:l.cvText,created_at:new Date().toISOString()}),d=await y3(l.jobTitle,l.jobDescription);console.log("Starting analysis with:",{candidateId:h.id,jobId:d.id});const p=await ZE({candidateId:h.id,jobId:d.id});return console.log("Analysis completed:",p),e(p),s(null),a("Analysis completed successfully","success"),p}catch(c){console.error("Analysis error:",{error:c,type:c instanceof Dt?"ApiError":typeof c,message:c.message,status:c.status,details:c.details});const h=c instanceof Dt?c.message:"An unexpected error occurred. Please try again.";throw s(h),a(h,"error"),c}};return{analysis:r,error:t,isLoading:n,analyze:l=>i(o(l))}}js.string().email("Invalid email address");js.string().min(8,"Password must be at least 8 characters");const D0=js.object({name:js.string().min(1,"Name is required"),cv_text:js.string().min(100,"CV text must be at least 100 characters")}),B0=js.object({title:js.string().min(1,"Job title is required"),jd_text:js.string().min(100,"Job description must be at least 100 characters")});js.object({cvText:js.string().min(100,"CV text must be at least 100 characters"),jobDescription:js.string().min(100,"Job description must be at least 100 characters")});js.object({plan:js.enum(["free","pro"]),status:js.enum(["active","trialing","past_due","canceled"]),analysisCount:js.number().min(0)});const dk=js.object({candidateName:D0.shape.name,cvText:D0.shape.cv_text,jobTitle:B0.shape.title,jobDescription:B0.shape.jd_text}),fk={candidateName:"",cvText:"",jobTitle:"",jobDescription:""};function pk(){const{analyze:r,analysis:e,isLoading:t}=uk();return{...qN({initialValues:fk,validationSchema:dk,onSubmit:async n=>{await r({candidateName:n.candidateName,cvText:n.cvText,jobTitle:n.jobTitle,jobDescription:n.jobDescription})}}),analysis:e,isLoading:t}}function ov(){const[r,e]=W.useState(null),[t,s]=W.useState(!0);return W.useEffect(()=>{lt.auth.getSession().then(({data:{session:a}})=>{e(a),s(!1)});const{data:{subscription:i}}=lt.auth.onAuthStateChange((a,o)=>{e(o),o&&fc.trackEvent("user_signed_in")});return()=>i.unsubscribe()},[]),{session:r,loading:t,signOut:async()=>{try{const{error:i}=await lt.auth.signOut();if(i)throw i;fc.trackEvent("user_signed_out")}catch(i){Rp(i)}}}}function mk(){const{session:r}=ov(),[e,t]=W.useState(null),[s,n]=W.useState(!0),[i,a]=W.useState(null);return W.useEffect(()=>{let o=!0;async function l(){if(!r?.user){o&&(t({status:"active",plan:"free",analysisCount:0,currentPeriodEnd:new Date(Date.now()+30*24*60*60*1e3).toISOString(),cancelAtPeriodEnd:!1}),n(!1));return}try{await new Promise(d=>setTimeout(d,100));const h=await ev(r.user.id);if(o){if(!h||!["active","inactive","trialing"].includes(h.status))throw new Error("Invalid subscription data received");t(h),a(null)}}catch(h){console.error("Subscription fetch error:",h),o&&(a(h instanceof Error?h:new Error("Failed to fetch subscription")),t({status:"active",plan:"free",analysisCount:0,currentPeriodEnd:new Date(Date.now()+30*24*60*60*1e3).toISOString()}))}finally{o&&n(!1)}}l();const c=setInterval(l,6e4);return()=>{o=!1,clearInterval(c)}},[r]),{subscription:e,loading:s,error:i,canAnalyze:e?sv(e):!1,remainingAnalyses:e?tv(e):0,isPro:e?.plan==="pro"}}function gk(){const{session:r}=ov(),[e,t]=W.useState(null),[s,n]=W.useState(!0),[i,a]=W.useState(null);return W.useEffect(()=>{async function o(){if(!r?.user){t(null),n(!1);return}try{const l=await ev(r.user.id);if(typeof l=="object"&&l!==null)t(l),a(null);else throw new Error("Invalid subscription response format")}catch(l){const c=l instanceof Error?l.message:"Failed to fetch subscription";a(new Error(c)),console.error("Error fetching subscription:",l),t(null)}finally{n(!1)}}o()},[r]),{subscription:e,loading:s,error:i,canAnalyze:e?sv(e):!1,remainingAnalyses:e?tv(e):0}}function bk(r){const e=Cm[r.plan.toUpperCase()],t=r.analysisCount,s=Math.max(0,e-t),n=t/e*100;return{limit:e,used:t,remaining:s,usagePercentage:n,isWarning:n>=O0.WARNING*100,isCritical:n>=O0.CRITICAL*100}}function vk(){const{subscription:r}=gk();if(!r)return null;const e=bk(r),t=e.isCritical?"bg-red-600":e.isWarning?"bg-yellow-500":"bg-green-600";return g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex justify-between text-sm",children:[g.jsxs("span",{className:"text-gray-600",children:[e.used," / ",e.limit," analyses used"]}),g.jsxs("span",{className:"text-gray-600",children:[e.remaining," remaining"]})]}),g.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:g.jsx("div",{className:`h-full ${t} transition-all duration-500`,style:{width:`${Math.min(100,e.usagePercentage)}%`}})}),(e.isWarning||e.isCritical)&&g.jsx("p",{className:`text-sm ${e.isCritical?"text-red-600":"text-yellow-600"}`,children:e.isCritical?"You're almost out of analyses. Upgrade to continue analyzing.":"You're approaching your analysis limit. Consider upgrading soon."})]})}function yk(){const{values:r,errors:e,setFieldValue:t,handleSubmit:s,analysis:n,isLoading:i}=pk(),{canAnalyze:a}=mk();return a?g.jsxs("div",{className:"space-y-8",children:[g.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 sm:gap-0 bg-gradient-to-r from-blue-50 to-blue-100/50 rounded-xl p-6 border border-blue-100",children:[g.jsxs("div",{children:[g.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[g.jsx(s1,{className:"w-6 h-6 text-blue-600"}),"New Analysis"]}),g.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Upload a CV and Job Description to get started"})]}),g.jsx(vk,{})]}),g.jsxs("form",{onSubmit:s,className:"space-y-8",children:[g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[g.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:g.jsx(v3,{candidateName:r.candidateName,cvText:r.cvText,onNameChange:o=>t("candidateName",o),onCvTextChange:o=>t("cvText",o),errors:{name:e.candidateName,cvText:e.cvText}})}),g.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:g.jsx(_3,{jobTitle:r.jobTitle,jobDescription:r.jobDescription,onTitleChange:o=>t("jobTitle",o),onDescriptionChange:o=>t("jobDescription",o),errors:{title:e.jobTitle,description:e.jobDescription}})})]}),g.jsxs("div",{className:"flex justify-end space-x-4 sticky bottom-6 bg-white/80 backdrop-blur-sm p-4 rounded-xl border border-gray-100 shadow-sm",children:[g.jsxs(Vr,{type:"button",variant:"secondary",onClick:()=>{t("candidateName",""),t("cvText",""),t("jobTitle",""),t("jobDescription","")},disabled:i,className:"flex items-center gap-2",children:[g.jsx(Sy,{className:"w-4 h-4"}),"Clear Form"]}),g.jsx(Vr,{type:"submit",isLoading:i,className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800",children:i?"Analyzing...":"Analyze CV"})]})]}),n&&g.jsx("div",{className:"mt-8",children:g.jsx(Rb,{analysis:n})})]}):g.jsx("div",{className:"text-center py-16 px-4",children:g.jsxs("div",{className:"max-w-md mx-auto bg-white rounded-2xl shadow-sm p-8 border border-gray-100",children:[g.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-6",children:g.jsx("svg",{className:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),g.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Upgrade Your Plan"}),g.jsx("p",{className:"text-gray-600 mb-8 leading-relaxed",children:"You've reached the limit of your free analyses. Upgrade to Pro for unlimited analyses and advanced features."}),g.jsx(Kn,{to:"/pricing",className:"inline-flex items-center px-6 py-3 border border-transparent rounded-xl shadow-sm text-base font-medium text-white bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 transition-all duration-200",children:"View Pricing Plans"})]})})}function lv(){const{data:r,isLoading:e,error:t,refetch:s}=Fc(L3);return{analyses:r||[],isLoading:e,error:t,refetch:s}}function wk({analysis:r,onClick:e}){const[t,s]=W.useState(""),[n,i]=W.useState("");W.useEffect(()=>{async function o(){const{data:l}=await lt.from("candidates").select("name").eq("id",r.candidate_id).single(),{data:c}=await lt.from("jobs").select("title").eq("id",r.job_id).single();s(l?.name||"Unknown Candidate"),i(c?.title||"Unknown Position")}o()},[r.candidate_id,r.job_id]);const a=o=>o>=8?"bg-green-100 text-green-800":o>=6?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800";return g.jsx("div",{onClick:e,className:`p-4 border rounded-lg ${e?"hover:bg-gray-50 cursor-pointer":""} transition-colors`,children:g.jsxs("div",{className:"flex justify-between items-start",children:[g.jsxs("div",{children:[g.jsx("h3",{className:"font-medium",children:`${t} × ${n} Report`}),g.jsx("p",{className:"text-sm text-gray-500",children:new Date(r.created_at??"").toLocaleDateString()})]}),g.jsxs("div",{className:`px-2 py-1 rounded text-sm ${a(r.fit_score)}`,children:["Score: ",r.fit_score,"/10"]})]})})}function xk(r){const[e,t]=W.useState(!1),{data:s,isLoading:n,error:i,refetch:a}=Fc(()=>P3(r),{enabled:!!r});return{analysis:s,isLoading:n,error:i,refetch:a,isExpanded:e,toggleExpanded:()=>t(o=>!o)}}function _k({analysisId:r,onClose:e}){const{analysis:t,isLoading:s,error:n}=xk(r),[i,a]=W.useState(""),[o,l]=W.useState("");return W.useEffect(()=>{async function c(){if(!t)return;const{data:h}=await lt.from("candidates").select("name").eq("id",t.candidate_id).single(),{data:d}=await lt.from("jobs").select("title").eq("id",t.job_id).single();a(h?.name||"Unknown Candidate"),l(d?.title||"Unknown Position")}c()},[t]),s?g.jsx("div",{className:"flex justify-center py-12",children:g.jsx(wi,{size:"lg"})}):n||!t?g.jsxs("div",{className:"text-center py-12",children:[g.jsx("p",{className:"text-red-600 mb-4",children:n||"Analysis not found"}),g.jsx(Vr,{variant:"secondary",onClick:e,children:"Go Back"})]}):g.jsxs("div",{className:"space-y-6",children:[g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("h2",{className:"text-xl font-semibold",children:`${i} × ${o} Report`}),g.jsxs("div",{className:"flex gap-3",children:[g.jsx(jb,{analysis:t}),g.jsx(Vr,{variant:"secondary",onClick:e,children:"Close"})]})]}),g.jsx(Rb,{analysis:t})]})}function dc({title:r,description:e,action:t}){return g.jsxs("div",{className:"text-center py-12",children:[g.jsx("div",{className:"rounded-full bg-blue-100 p-3 mx-auto w-12 h-12 flex items-center justify-center",children:g.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),g.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:r}),g.jsx("p",{className:"mt-2 text-sm text-gray-500",children:e}),t&&g.jsx("div",{className:"mt-6",children:t})]})}const Ak=[{label:"All Time",value:"all"},{label:"Last 7 Days",value:"7days"},{label:"Last 30 Days",value:"30days"},{label:"Last 90 Days",value:"90days"}];function Sk(){const{isLoading:r,error:e}=lv(),[t,s]=W.useState(null),[n,i]=W.useState([]),[a,o]=W.useState(""),[l,c]=W.useState("all"),h=async()=>{try{const{data:{user:p}}=await lt.auth.getUser();if(!p)throw new Dt("User not authenticated",401);const{data:f,error:y}=await lt.from("analysis").select("*, candidates(name), jobs(title)").eq("user_id",p.id).order("created_at",{ascending:!1});if(y)throw y;i(f||[])}catch(p){console.error("Error fetching user analyses:",p)}};W.useEffect(()=>{h()},[]);const d=W.useMemo(()=>n.filter(p=>{const f=a.toLowerCase(),y=p.candidates?.name?.toLowerCase()||"",w=p.jobs?.title?.toLowerCase()||"",A=!a||y.includes(f)||w.includes(f),x=new Date(p.created_at),I=Math.floor((new Date().getTime()-x.getTime())/(1e3*60*60*24));let M=!0;return l==="7days"&&(M=I<=7),l==="30days"&&(M=I<=30),l==="90days"&&(M=I<=90),A&&M}),[n,a,l]);return r?g.jsx("div",{className:"flex justify-center items-center min-h-[400px]",children:g.jsx(wi,{size:"lg"})}):e?g.jsx(dc,{title:"Error loading analyses",description:e}):n.length?t?g.jsxs("div",{className:"space-y-6",children:[g.jsxs("button",{onClick:()=>s(null),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors duration-200",children:[g.jsx(zy,{className:"w-5 h-5"}),g.jsx("span",{children:"Back to History"})]}),g.jsx(_k,{analysisId:t,onClose:()=>s(null)})]}):g.jsxs("div",{className:"space-y-6",children:[g.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-purple-100/50 rounded-xl p-6 border border-purple-100",children:[g.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[g.jsx(t1,{className:"w-6 h-6 text-purple-600"}),"Analysis History"]}),g.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"View and compare your previous analyses"})]}),g.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center bg-white p-4 rounded-xl shadow-sm border border-gray-100",children:[g.jsxs("div",{className:"relative flex-1",children:[g.jsx(sw,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),g.jsx("input",{type:"text",placeholder:"Search by candidate name or position...",value:a,onChange:p=>o(p.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),g.jsxs("div",{className:"flex items-center gap-2 min-w-[200px]",children:[g.jsx(Zy,{className:"w-5 h-5 text-gray-400"}),g.jsx("select",{value:l,onChange:p=>c(p.target.value),className:"flex-1 border border-gray-200 rounded-lg py-2 px-3 focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:Ak.map(p=>g.jsx("option",{value:p.value,children:p.label},p.value))})]})]}),d.length===0?g.jsx(dc,{title:"No matching analyses",description:"Try adjusting your search or filter criteria"}):g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:d.map(p=>g.jsx("div",{className:"transform transition-all duration-200 hover:scale-[1.02]",children:g.jsx(wk,{analysis:p,onClick:()=>s(p.id??null)})},p.id))})]}):g.jsx(dc,{title:"No analyses yet",description:"Start by analyzing a candidate's CV against a job description."})}function Nk(){const{candidates:r,isLoading:e}=Mp(),[t,s]=W.useState(null),n=r.reduce((a,o)=>{const l=a.findIndex(c=>gc(o.name,o.cv_text,[c]));return l>=0?(a[l].duplicateCount+=1,a[l].lastSubmitted=new Date(Math.max(new Date(a[l].lastSubmitted).getTime(),new Date(o.created_at).getTime())).toISOString()):a.push({...o,duplicateCount:1,lastSubmitted:o.created_at}),a},[]),i=a=>a.split(/\n\s*\n/).map(o=>o.trim()).filter(o=>o.length>0).map(o=>o.replace(/\s+/g," ")).join(`

`);return e?g.jsx("div",{className:"flex justify-center items-center min-h-[400px] bg-white/50 rounded-xl backdrop-blur-sm",children:g.jsx(wi,{size:"lg"})}):r.length?g.jsxs("div",{className:"space-y-6",children:[g.jsx("div",{className:"bg-gradient-to-r from-emerald-50 to-emerald-100/50 rounded-xl p-6 border border-emerald-100",children:g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx(pw,{className:"w-6 h-6 text-emerald-600"}),g.jsxs("div",{children:[g.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Candidate History"}),g.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[n.length," unique candidate",n.length!==1?"s":""," found"]})]})]})}),g.jsx("div",{className:"grid gap-4",children:n.map((a,o)=>g.jsx("div",{className:"group bg-white rounded-xl border border-gray-200 hover:border-emerald-200 shadow-sm hover:shadow-md transition-all duration-200",style:{animationDelay:`${o*50}ms`,animation:"fadeInUp 0.5s ease-out forwards"},children:g.jsxs("div",{className:"p-6 cursor-pointer",onClick:()=>s(t===a.id?null:a.id),role:"button",tabIndex:0,onKeyDown:l=>{(l.key==="Enter"||l.key===" ")&&(l.preventDefault(),s(t===a.id?null:a.id))},children:[g.jsxs("div",{className:"flex justify-between items-start",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:a.name}),a.duplicateCount>1&&g.jsxs("span",{className:"flex items-center gap-1 text-xs px-3 py-1 bg-emerald-50 text-emerald-700 rounded-full",children:[g.jsx(n1,{className:"w-3 h-3"}),a.duplicateCount,"x"]})]}),t===a.id?g.jsx(Du,{className:"w-5 h-5 text-gray-400 group-hover:text-emerald-500 transition-colors"}):g.jsx(Zo,{className:"w-5 h-5 text-gray-400 group-hover:text-emerald-500 transition-colors"})]}),g.jsxs("p",{className:"text-sm text-gray-500 mt-2 flex items-center gap-2",children:[g.jsx("span",{className:"inline-block w-2 h-2 rounded-full bg-emerald-400"}),"Last submitted ",O1(a.lastSubmitted)]}),g.jsx("div",{className:`mt-4 text-sm text-gray-600 space-y-3
                  ${t===a.id?"":"line-clamp-2"}`,children:i(a.cv_text).split(`

`).map((l,c)=>g.jsx("p",{className:"leading-relaxed",children:l},c))}),g.jsx("div",{className:"mt-4 text-sm text-emerald-600 font-medium",children:t===a.id?"Show less":"Show more"})]})},a.id))}),g.jsx("style",{children:`
        @keyframes fadeInUp {
          from {
            opacity: 0;
            transform: translateY(10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
      `})]}):g.jsx(dc,{title:"No candidates yet",description:"Previous candidates will appear here once you analyze their CVs."})}function Ek(){const{jobs:r,isLoading:e}=Qp(),[t,s]=W.useState(null),n=r.reduce((a,o)=>{const l=a.findIndex(c=>bc(o.title,o.jd_text,[c]));return l>=0?(a[l].duplicateCount+=1,a[l].lastSubmitted=new Date(Math.max(new Date(a[l].lastSubmitted).getTime(),new Date(o.created_at).getTime())).toISOString()):a.push({...o,duplicateCount:1,lastSubmitted:o.created_at}),a},[]),i=a=>a.split(/\n\s*\n/).map(o=>o.trim()).filter(o=>o.length>0).map(o=>o.replace(/\s+/g," ")).join(`

`);return e?g.jsx("div",{className:"flex justify-center items-center min-h-[400px] bg-white/50 rounded-xl backdrop-blur-sm",children:g.jsx(wi,{size:"lg"})}):r.length?g.jsxs("div",{className:"space-y-6",children:[g.jsx("div",{className:"bg-gradient-to-r from-amber-50 to-amber-100/50 rounded-xl p-6 border border-amber-100",children:g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx(kp,{className:"w-6 h-6 text-amber-600"}),g.jsxs("div",{children:[g.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Job History"}),g.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[n.length," unique position",n.length!==1?"s":""," found"]})]})]})}),g.jsx("div",{className:"grid gap-4",children:n.map((a,o)=>g.jsx("div",{className:"group bg-white rounded-xl border border-gray-200 hover:border-amber-200 shadow-sm hover:shadow-md transition-all duration-200",style:{animationDelay:`${o*50}ms`,animation:"fadeInUp 0.5s ease-out forwards"},children:g.jsxs("div",{className:"p-6 cursor-pointer",onClick:()=>s(t===a.id?null:a.id),role:"button",tabIndex:0,onKeyDown:l=>{(l.key==="Enter"||l.key===" ")&&(l.preventDefault(),s(t===a.id?null:a.id))},children:[g.jsxs("div",{className:"flex justify-between items-start",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:a.title}),a.duplicateCount>1&&g.jsxs("span",{className:"flex items-center gap-1 text-xs px-3 py-1 bg-amber-50 text-amber-700 rounded-full",children:[g.jsx(n1,{className:"w-3 h-3"}),a.duplicateCount,"x"]})]}),t===a.id?g.jsx(Du,{className:"w-5 h-5 text-gray-400 group-hover:text-amber-500 transition-colors"}):g.jsx(Zo,{className:"w-5 h-5 text-gray-400 group-hover:text-amber-500 transition-colors"})]}),g.jsxs("p",{className:"text-sm text-gray-500 mt-2 flex items-center gap-2",children:[g.jsx("span",{className:"inline-block w-2 h-2 rounded-full bg-amber-400"}),"Last submitted ",O1(a.lastSubmitted)]}),g.jsx("div",{className:`mt-4 text-sm text-gray-600 space-y-3
                  ${t===a.id?"":"line-clamp-2"}`,children:i(a.jd_text).split(`

`).map((l,c)=>g.jsx("p",{className:"leading-relaxed",children:l},c))}),g.jsx("div",{className:"mt-4 text-sm text-amber-600 font-medium",children:t===a.id?"Show less":"Show more"})]})},a.id))}),g.jsx("style",{children:`
        @keyframes fadeInUp {
          from {
            opacity: 0;
            transform: translateY(10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
      `})]}):g.jsx(dc,{title:"No jobs yet",description:"Previous job descriptions will appear here once you analyze them."})}function kk({tabs:r,activeTab:e,onChange:t}){return g.jsx("div",{className:"relative",children:g.jsxs("div",{className:"flex items-center",children:[g.jsx("div",{className:"flex space-x-1 rounded-xl bg-gray-100/60 p-1",children:r.map(s=>{const n=e===s.id;return g.jsxs("button",{onClick:()=>t(s.id),"data-tab":s.id,className:`
                  relative px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200
                  ${n?"text-white shadow-sm":"text-gray-600 hover:text-gray-900 hover:bg-white/60"}
                `,children:[n&&g.jsx("span",{className:"absolute inset-0 rounded-lg bg-gradient-to-r from-blue-600 to-blue-700 shadow-sm transition-all duration-200",style:{zIndex:0}}),g.jsx("span",{className:"relative z-10",children:s.label}),n&&g.jsx("span",{className:"absolute -bottom-px left-0 right-0 h-px bg-gradient-to-r from-blue-400/0 via-blue-400/70 to-blue-400/0"})]},s.id)})}),g.jsx("div",{className:"hidden md:block ml-6 h-px flex-1 bg-gradient-to-r from-gray-200 to-transparent"})]})})}async function Ck(){try{const r=new Date;r.setDate(r.getDate()-7);const{data:{user:e}}=await lt.auth.getUser();if(!e)throw new Dt("User not authenticated",401);const[{count:t},{data:s},{data:n},{count:i}]=await Promise.all([lt.from("analysis").select("*",{count:"exact",head:!0}).eq("user_id",e.id),lt.from("candidates").select("id, name, cv_text").eq("user_id",e.id),lt.from("jobs").select("id, title, jd_text").eq("user_id",e.id),lt.from("analysis").select("*",{count:"exact",head:!0}).eq("user_id",e.id).gte("created_at",r.toISOString())]),a=s?.reduce((l,c)=>(l.some(d=>gc(c.name,c.cv_text,[d]))||l.push(c),l),[])||[],o=n?.reduce((l,c)=>(l.some(d=>bc(c.title,c.jd_text,[d]))||l.push(c),l),[])||[];return{totalAnalyses:t||0,uniqueCandidates:a.length,uniqueJobs:o.length,recentAnalyses:i||0,totalCandidates:a.length,totalJobs:o.length}}catch(r){throw console.error("Dashboard stats error:",r),new Dt("Failed to fetch dashboard stats",500)}}function Pk(){const{data:r,isLoading:e,error:t,refetch:s}=Fc(Ck);return{stats:r||{totalAnalyses:0,totalCandidates:0,totalJobs:0,recentAnalyses:0},isLoading:e,error:t,refetch:s}}function Lk(){const{stats:r,isLoading:e}=Pk();if(e)return g.jsx("div",{className:"flex justify-center py-8",children:g.jsx(wi,{})});const t=[{label:"Total Analyses",value:r.totalAnalyses,icon:e1,color:"from-blue-500 to-indigo-600",textColor:"text-blue-600"},{label:"Candidates",value:r.totalCandidates,icon:Bu,color:"from-emerald-500 to-teal-600",textColor:"text-emerald-600"},{label:"Job Descriptions",value:r.totalJobs,icon:kp,color:"from-violet-500 to-purple-600",textColor:"text-violet-600"}];return g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(s=>g.jsxs("div",{className:"relative bg-white rounded-xl shadow-sm hover:shadow-xl transition-all duration-300 overflow-hidden group",children:[g.jsx("div",{className:"absolute inset-0 bg-gradient-to-br opacity-5 from-gray-100 to-gray-200"}),g.jsxs("div",{className:"relative p-6",children:[g.jsx("div",{className:`bg-gradient-to-br ${s.color} w-16 h-16 rounded-xl flex items-center justify-center shadow-lg mb-6 group-hover:scale-110 transition-transform duration-300`,children:g.jsx(s.icon,{className:"h-8 w-8 text-white"})}),g.jsxs("div",{className:"space-y-2",children:[g.jsx("p",{className:`text-4xl font-bold ${s.textColor} tracking-tight transition-colors duration-300`,children:s.value.toLocaleString()}),g.jsx("p",{className:"text-sm font-medium text-gray-600",children:s.label})]}),g.jsx("div",{className:`absolute top-0 right-0 w-32 h-32 -mr-16 -mt-16 bg-gradient-to-br ${s.color} opacity-10 rounded-full transform rotate-45`})]})]},s.label))})}function Tk({user:r,subscription:e,onSubscriptionUpdate:t}){const[s,n]=W.useState(!1),[i,a]=W.useState(!1),o=W.useRef(null);W.useEffect(()=>{function p(f){o.current&&!o.current.contains(f.target)&&n(!1)}return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[]);const l=async()=>{try{if(a(!0),!r?.id)throw new Error("User ID is required");await av(r.id,"pro")}catch(p){console.error("Error upgrading:",p)}finally{a(!1)}},c=async()=>{try{a(!0);const{error:p}=await lt.functions.invoke("cancel-subscription",{body:{subscriptionId:e?.stripeSubscriptionId}});if(p)throw p;t&&t()}catch(p){console.error("Error cancelling subscription:",p)}finally{a(!1),n(!1)}},h=r?.email?.split("@")[0],d=r?.email;return r?g.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-800 rounded-xl shadow-lg p-8",children:g.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 sm:gap-0",children:[g.jsxs("div",{className:"text-white",children:[g.jsxs("h1",{className:"text-3xl font-bold",children:["Welcome back, ",h,"! 👋"]}),g.jsx("p",{className:"mt-2 text-blue-100 font-medium",children:"Here's your recruitment analysis overview"})]}),g.jsxs("div",{className:"flex items-center space-x-6",children:[g.jsxs("button",{className:"relative p-2 text-blue-100 hover:text-white transition-colors duration-200","aria-label":"Notifications",children:[g.jsx(Oy,{className:"h-6 w-6"}),g.jsx("span",{className:"absolute top-0 right-0 block h-3 w-3 rounded-full bg-red-500 ring-2 ring-blue-600"})]}),g.jsxs("div",{className:"relative",ref:o,children:[g.jsxs("button",{onClick:()=>n(!s),className:"flex items-center bg-white/10 rounded-lg p-2 backdrop-blur-sm hover:bg-white/20 transition-colors duration-200",children:[r.user_metadata?.avatar_url?g.jsx("img",{src:r.user_metadata.avatar_url,alt:"Profile",className:"h-10 w-10 rounded-lg shadow-sm"}):g.jsx(r1,{className:"h-10 w-10 text-blue-100"}),g.jsxs("div",{className:"ml-3",children:[g.jsx("p",{className:"text-sm font-medium text-white",children:d}),g.jsx("p",{className:"text-xs text-blue-100",children:"View Profile"})]})]}),s&&g.jsx("div",{className:"absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-50",children:g.jsxs("div",{className:"py-1",role:"menu",children:[g.jsxs("div",{className:"px-4 py-2 text-sm text-gray-700 border-b",children:["Current Plan: ",g.jsx("span",{className:"font-semibold capitalize",children:e?.plan||"Free"})]}),(!e||e?.plan==="free")&&g.jsx("button",{onClick:l,disabled:i,className:"w-full text-left px-4 py-2 text-sm text-blue-600 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",role:"menuitem",children:i?"Processing...":"Upgrade to Pro"}),e?.plan==="pro"&&g.jsx("button",{onClick:c,disabled:i,className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",role:"menuitem",children:i?"Processing...":"Cancel Subscription"}),g.jsx("button",{onClick:()=>lt.auth.signOut(),className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",role:"menuitem",children:"Sign Out"})]})})]})]})]})}):null}function Ik(){const{analyses:r,isLoading:e}=lv(),[t,s]=W.useState([]),[n,i]=W.useState(!0);return W.useEffect(()=>{async function a(){if(!r.length){i(!1);return}const o=await Promise.all(r.slice(0,10).map(async l=>{const{data:c}=await lt.from("candidates").select("name").eq("id",l.candidate_id).single(),{data:h}=await lt.from("jobs").select("title").eq("id",l.job_id).single();return{...l,candidateName:c?.name||"Unknown Candidate",jobTitle:h?.title||"Unknown Position"}}));s(o),i(!1)}r.length&&a()},[r]),g.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 h-[400px] flex flex-col",children:[g.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center flex-shrink-0",children:[g.jsx("span",{className:"w-2 h-6 bg-blue-600 rounded-full mr-3"}),"Recent Activity"]}),e||n?g.jsx("div",{className:"flex-1 flex justify-center items-center",children:g.jsx(wi,{})}):g.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-200 scrollbar-track-gray-50 pr-2 -mr-2",children:g.jsx("div",{className:"space-y-4",children:t.length>0?t.map(a=>g.jsxs("div",{className:"flex items-start space-x-4 p-4 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:[g.jsx("div",{className:"flex-shrink-0",children:g.jsx("div",{className:"h-10 w-10 rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center shadow-sm",children:g.jsxs("span",{className:"text-sm font-semibold text-white",children:[a.fit_score,"/10"]})})}),g.jsxs("div",{className:"min-w-0 flex-1",children:[g.jsxs("p",{className:"text-sm font-semibold text-gray-900 truncate",children:[a.candidateName," → ",a.jobTitle]}),g.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Analysis completed ",pA(a.created_at??"")]})]})]},a.id)):g.jsx("div",{className:"text-center text-gray-500 py-4",children:"No recent activity"})})})]})}const jk=[{id:"new",label:"New Analysis"},{id:"history",label:"Analysis History"},{id:"candidates",label:"Previous Candidates"},{id:"jobs",label:"Previous Jobs"}];function Rk(){const[r,e]=W.useState("new"),{session:t}=Gu();return g.jsxs("div",{className:"space-y-8",children:[g.jsx(Tk,{user:t?.user}),g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[g.jsx("div",{className:"lg:col-span-2",children:g.jsx(Lk,{})}),g.jsx("div",{className:"lg:col-span-1",children:g.jsx(Ik,{})})]}),g.jsx("div",{className:"bg-white rounded-xl shadow-sm",children:g.jsxs("div",{className:"p-6",children:[g.jsx(kk,{tabs:jk,activeTab:r,onChange:e}),g.jsxs("div",{className:"mt-8",children:[r==="new"&&g.jsx(yk,{}),r==="history"&&g.jsx(Sk,{}),r==="candidates"&&g.jsx(Nk,{}),r==="jobs"&&g.jsx(Ek,{})]})]})})]})}class Ok extends W.Component{state={hasError:!1};static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Uncaught error:",e,t)}render(){return this.state.hasError?this.props.fallback||g.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:g.jsxs("div",{className:"max-w-md w-full bg-white p-8 rounded-lg shadow-md",children:[g.jsx("h2",{className:"text-2xl font-bold text-red-600 mb-4",children:"Something went wrong"}),g.jsx("p",{className:"text-gray-600 mb-4",children:this.state.error?.message||"An unexpected error occurred"}),g.jsx("button",{onClick:()=>this.setState({hasError:!1}),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"Try again"})]})}):this.props.children}}function Mk(){return g.jsxs("div",{className:"min-h-screen bg-gray-50",children:[g.jsx(Yx,{}),g.jsx("main",{className:"py-8",children:g.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:g.jsx(Ok,{children:g.jsx(X0,{children:g.jsx(ma,{path:"/",element:g.jsx(Rk,{})})})})})})]})}function $0({plan:r}){const[e,t]=W.useState(!1),{session:s}=Gu(),{addToast:n}=em(),i=G0(),a=async()=>{if(!s){i("/login");return}if(r==="free"){i("/dashboard");return}t(!0);try{await av(s.user.id,r)}catch(o){n("Failed to start subscription process","error"),console.error("Subscription error:",o)}finally{t(!1)}};return g.jsx(Vr,{onClick:a,isLoading:e,variant:r==="pro"?"primary":"secondary",className:"w-full",children:r==="free"?"Start Free Trial":"Subscribe Now"})}function Fk(){return g.jsxs("div",{className:"relative bg-white py-24 overflow-hidden border border-blue-500/20 rounded-lg",children:[g.jsxs("div",{className:"absolute inset-0",children:[g.jsx("div",{className:"absolute inset-0 bg-[url('/grid.svg')] opacity-[0.02]"}),g.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-blue-100 rounded-full blur-3xl opacity-30 animate-pulse"}),g.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-indigo-100 rounded-full blur-3xl opacity-30 animate-pulse delay-1000"})]}),g.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[g.jsxs("div",{className:"text-center mb-16",children:[g.jsx("p",{className:"inline-flex items-center px-4 py-1.5 rounded-full border border-blue-400/30 bg-blue-500/10 backdrop-blur-sm text-blue-600 text-sm font-medium mb-4",children:"Flexible Plans"}),g.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Simple, Transparent Pricing"}),g.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Choose the plan that's right for your recruitment needs"})]}),g.jsxs("div",{className:"max-w-5xl mx-auto grid md:grid-cols-2 gap-8",children:[g.jsxs("div",{className:"group relative bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-200 hover:border-blue-300 transition-all duration-300 transform hover:-translate-y-1",children:[g.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-50 to-blue-50 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),g.jsxs("div",{className:"relative p-8",children:[g.jsx("h3",{className:"text-2xl font-bold text-gray-900 text-center mb-2",children:Mn.FREE.name}),g.jsx("p",{className:"text-center text-gray-600 mb-6",children:"Perfect for trying out our service"}),g.jsxs("div",{className:"text-center mb-8",children:[g.jsx("span",{className:"text-5xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-gray-900 to-gray-600",children:"$0"}),g.jsx("span",{className:"text-gray-600",children:"/month"}),g.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Up to ",lk," CV analyses"]})]}),g.jsx("ul",{className:"space-y-4 mb-8",children:Mn.FREE.features.map((r,e)=>g.jsxs("li",{className:"flex items-start group/item",children:[g.jsx(yu,{className:"h-5 w-5 text-green-500 flex-shrink-0 mt-0.5 group-hover/item:scale-110 transition-transform"}),g.jsx("span",{className:"ml-3 text-gray-600",children:r})]},e))}),g.jsx($0,{plan:"free"})]})]}),g.jsxs("div",{className:"group relative bg-gradient-to-br from-blue-600 to-indigo-600 rounded-2xl shadow-xl overflow-hidden transform hover:scale-[1.02] transition-all duration-300",children:[g.jsx("div",{className:"absolute inset-0 bg-[url('/grid.svg')] opacity-10"}),g.jsxs("div",{className:"relative p-8",children:[g.jsx("h3",{className:"text-2xl font-bold text-white text-center mb-2",children:Mn.PRO.name}),g.jsx("p",{className:"text-center text-blue-100 mb-6",children:"For serious recruiters"}),g.jsxs("div",{className:"text-center mb-8",children:[g.jsxs("span",{className:"text-5xl font-bold text-white",children:["$",Mn.PRO.price]}),g.jsx("span",{className:"text-blue-100",children:"/month"}),g.jsxs("p",{className:"text-sm text-blue-100 mt-2",children:[Mn.PRO.analysisLimit," analyses per month"]})]}),g.jsx("ul",{className:"space-y-4 mb-8",children:Mn.PRO.features.map((r,e)=>g.jsxs("li",{className:"flex items-start group/item",children:[g.jsx(yu,{className:"h-5 w-5 text-white flex-shrink-0 mt-0.5 group-hover/item:scale-110 transition-transform"}),g.jsx("span",{className:"ml-3 text-white",children:r})]},e))}),g.jsx($0,{plan:"pro"})]})]})]})]})]})}var cv={exports:{}},Dk="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Bk=Dk,$k=Bk;function hv(){}function uv(){}uv.resetWarningCache=hv;var qk=function(){function r(s,n,i,a,o,l){if(l!==$k){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}r.isRequired=r;function e(){return r}var t={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:e,element:r,elementType:r,instanceOf:e,node:r,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:uv,resetWarningCache:hv};return t.PropTypes=t,t};cv.exports=qk();var Uk=cv.exports;const rs=ny(Uk);function q0(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),t.push.apply(t,s)}return t}function U0(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?q0(Object(t),!0).forEach(function(s){dv(r,s,t[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):q0(Object(t)).forEach(function(s){Object.defineProperty(r,s,Object.getOwnPropertyDescriptor(t,s))})}return r}function vu(r){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?vu=function(e){return typeof e}:vu=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vu(r)}function dv(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function fv(r,e){return zk(r)||Hk(r,e)||Wk(r,e)||Vk()}function zk(r){if(Array.isArray(r))return r}function Hk(r,e){var t=r&&(typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"]);if(t!=null){var s=[],n=!0,i=!1,a,o;try{for(t=t.call(r);!(n=(a=t.next()).done)&&(s.push(a.value),!(e&&s.length===e));n=!0);}catch(l){i=!0,o=l}finally{try{!n&&t.return!=null&&t.return()}finally{if(i)throw o}}return s}}function Wk(r,e){if(r){if(typeof r=="string")return z0(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return z0(r,e)}}function z0(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,s=new Array(e);t<e;t++)s[t]=r[t];return s}function Vk(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var In=function(e,t,s){var n=!!s,i=Xt.useRef(s);Xt.useEffect(function(){i.current=s},[s]),Xt.useEffect(function(){if(!n||!e)return function(){};var a=function(){i.current&&i.current.apply(i,arguments)};return e.on(t,a),function(){e.off(t,a)}},[n,t,e,i])},Ep=function(e){var t=Xt.useRef(e);return Xt.useEffect(function(){t.current=e},[e]),t.current},Jo=function(e){return e!==null&&vu(e)==="object"},Gk=function(e){return Jo(e)&&typeof e.then=="function"},Xk=function(e){return Jo(e)&&typeof e.elements=="function"&&typeof e.createToken=="function"&&typeof e.createPaymentMethod=="function"&&typeof e.confirmCardPayment=="function"},H0="[object Object]",Yk=function r(e,t){if(!Jo(e)||!Jo(t))return e===t;var s=Array.isArray(e),n=Array.isArray(t);if(s!==n)return!1;var i=Object.prototype.toString.call(e)===H0,a=Object.prototype.toString.call(t)===H0;if(i!==a)return!1;if(!i&&!s)return e===t;var o=Object.keys(e),l=Object.keys(t);if(o.length!==l.length)return!1;for(var c={},h=0;h<o.length;h+=1)c[o[h]]=!0;for(var d=0;d<l.length;d+=1)c[l[d]]=!0;var p=Object.keys(c);if(p.length!==o.length)return!1;var f=e,y=t,w=function(x){return r(f[x],y[x])};return p.every(w)},pv=function(e,t,s){return Jo(e)?Object.keys(e).reduce(function(n,i){var a=!Jo(t)||!Yk(e[i],t[i]);return s.includes(i)?(a&&console.warn("Unsupported prop change: options.".concat(i," is not a mutable property.")),n):a?U0(U0({},n||{}),{},dv({},i,e[i])):n},null):null},mv="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",W0=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:mv;if(e===null||Xk(e))return e;throw new Error(t)},Kk=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:mv;if(Gk(e))return{tag:"async",stripePromise:Promise.resolve(e).then(function(n){return W0(n,t)})};var s=W0(e,t);return s===null?{tag:"empty"}:{tag:"sync",stripe:s}},Jk=function(e){!e||!e._registerWrapper||!e.registerAppInfo||(e._registerWrapper({name:"react-stripe-js",version:"3.1.0"}),e.registerAppInfo({name:"react-stripe-js",version:"3.1.0",url:"https://stripe.com/docs/stripe-js/react"}))},Lm=Xt.createContext(null);Lm.displayName="ElementsContext";var Zk=function(e,t){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e},gv=function(e){var t=e.stripe,s=e.options,n=e.children,i=Xt.useMemo(function(){return Kk(t)},[t]),a=Xt.useState(function(){return{stripe:i.tag==="sync"?i.stripe:null,elements:i.tag==="sync"?i.stripe.elements(s):null}}),o=fv(a,2),l=o[0],c=o[1];Xt.useEffect(function(){var p=!0,f=function(w){c(function(A){return A.stripe?A:{stripe:w,elements:w.elements(s)}})};return i.tag==="async"&&!l.stripe?i.stripePromise.then(function(y){y&&p&&f(y)}):i.tag==="sync"&&!l.stripe&&f(i.stripe),function(){p=!1}},[i,l,s]);var h=Ep(t);Xt.useEffect(function(){h!==null&&h!==t&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[h,t]);var d=Ep(s);return Xt.useEffect(function(){if(l.elements){var p=pv(s,d,["clientSecret","fonts"]);p&&l.elements.update(p)}},[s,d,l.elements]),Xt.useEffect(function(){Jk(l.stripe)},[l.stripe]),Xt.createElement(Lm.Provider,{value:l},n)};gv.propTypes={stripe:rs.any,options:rs.object};rs.func.isRequired;var bv=Xt.createContext(null);bv.displayName="CheckoutSdkContext";var Qk=function(e,t){if(!e)throw new Error("Could not find CheckoutProvider context; You need to wrap the part of your app that ".concat(t," in an <CheckoutProvider> provider."));return e},eC=Xt.createContext(null);eC.displayName="CheckoutContext";rs.any,rs.shape({clientSecret:rs.string.isRequired,elementsOptions:rs.object}).isRequired;var V0=function(e){var t=Xt.useContext(bv),s=Xt.useContext(Lm);if(t&&s)throw new Error("You cannot wrap the part of your app that ".concat(e," in both <CheckoutProvider> and <Elements> providers."));return t?Qk(t,e):Zk(s,e)},tC=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},Ns=function(e,t){var s="".concat(tC(e),"Element"),n=function(l){var c=l.id,h=l.className,d=l.options,p=d===void 0?{}:d,f=l.onBlur,y=l.onFocus,w=l.onReady,A=l.onChange,x=l.onEscape,S=l.onClick,I=l.onLoadError,M=l.onLoaderStart,B=l.onNetworksChange,Q=l.onConfirm,U=l.onCancel,O=l.onShippingAddressChange,G=l.onShippingRateChange,ne=V0("mounts <".concat(s,">")),L="elements"in ne?ne.elements:null,j="checkoutSdk"in ne?ne.checkoutSdk:null,V=Xt.useState(null),q=fv(V,2),le=q[0],ae=q[1],te=Xt.useRef(null),K=Xt.useRef(null);In(le,"blur",f),In(le,"focus",y),In(le,"escape",x),In(le,"click",S),In(le,"loaderror",I),In(le,"loaderstart",M),In(le,"networkschange",B),In(le,"confirm",Q),In(le,"cancel",U),In(le,"shippingaddresschange",O),In(le,"shippingratechange",G),In(le,"change",A);var fe;w&&(e==="expressCheckout"?fe=w:fe=function(){w(le)}),In(le,"ready",fe),Xt.useLayoutEffect(function(){if(te.current===null&&K.current!==null&&(L||j)){var Ae=null;j?Ae=j.createElement(e,p):L&&(Ae=L.create(e,p)),te.current=Ae,ae(Ae),Ae&&Ae.mount(K.current)}},[L,j,p]);var me=Ep(p);return Xt.useEffect(function(){if(te.current){var Ae=pv(p,me,["paymentRequest"]);Ae&&"update"in te.current&&te.current.update(Ae)}},[p,me]),Xt.useLayoutEffect(function(){return function(){if(te.current&&typeof te.current.destroy=="function")try{te.current.destroy(),te.current=null}catch{}}},[]),Xt.createElement("div",{id:c,className:h,ref:K})},i=function(l){V0("mounts <".concat(s,">"));var c=l.id,h=l.className;return Xt.createElement("div",{id:c,className:h})},a=t?i:n;return a.propTypes={id:rs.string,className:rs.string,onChange:rs.func,onBlur:rs.func,onFocus:rs.func,onReady:rs.func,onEscape:rs.func,onClick:rs.func,onLoadError:rs.func,onLoaderStart:rs.func,onNetworksChange:rs.func,onConfirm:rs.func,onCancel:rs.func,onShippingAddressChange:rs.func,onShippingRateChange:rs.func,options:rs.object},a.displayName=s,a.__elementType=e,a},Es=typeof window>"u",sC=Xt.createContext(null);sC.displayName="EmbeddedCheckoutProviderContext";Ns("auBankAccount",Es);Ns("card",Es);Ns("cardNumber",Es);Ns("cardExpiry",Es);Ns("cardCvc",Es);Ns("fpxBank",Es);Ns("iban",Es);Ns("idealBank",Es);Ns("p24Bank",Es);Ns("epsBank",Es);Ns("payment",Es);Ns("expressCheckout",Es);Ns("currencySelector",Es);Ns("paymentRequestButton",Es);Ns("linkAuthentication",Es);Ns("address",Es);Ns("shippingAddress",Es);Ns("paymentMethodMessaging",Es);Ns("affirmMessage",Es);Ns("afterpayClearpayMessage",Es);function nC(){const{session:r,loading:e}=Gu(),t=Pm("your-production-stripe-key");return e?g.jsx("div",{className:"min-h-screen flex items-center justify-center",children:g.jsx(wi,{size:"lg"})}):g.jsx(gv,{stripe:t,children:g.jsxs(X0,{children:[g.jsx(ma,{path:"/",element:r?g.jsx(Rl,{to:"/dashboard"}):g.jsx(Ow,{})}),g.jsx(ma,{path:"/login",element:r?g.jsx(Rl,{to:"/dashboard"}):g.jsx(Wx,{})}),g.jsx(ma,{path:"/signup",element:r?g.jsx(Rl,{to:"/dashboard"}):g.jsx(Gx,{})}),g.jsx(ma,{path:"/pricing",element:g.jsx(Fk,{})}),g.jsx(ma,{path:"/dashboard/*",element:r?g.jsx(Mk,{}):g.jsx(Rl,{to:"/login"})}),g.jsx(ma,{path:"*",element:g.jsx(Rl,{to:"/"})})]})})}Of.createRoot(document.getElementById("root")).render(g.jsx(Xt.StrictMode,{children:g.jsxs(ry,{children:[g.jsx(nC,{}),g.jsx(wy,{})]})}));export{Bt as _};
//# sourceMappingURL=index-ClZx2P18.js.map
