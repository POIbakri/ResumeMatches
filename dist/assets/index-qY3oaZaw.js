const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browser-Dwhluaoo.js","assets/vendor-15hnMuUL.js"])))=>i.map(i=>d[i]);
import{r as p,a as bc,L as se,g as xc,c as ye,u as ii,R as oi,b as st,N as zt,d as kc,B as jc}from"./vendor-15hnMuUL.js";import{a as hs}from"./analytics-Dy164akG.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}})();var ci={exports:{}},br={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sc=p,Ec=Symbol.for("react.element"),Ac=Symbol.for("react.fragment"),Tc=Object.prototype.hasOwnProperty,Nc=Sc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Cc={key:!0,ref:!0,__self:!0,__source:!0};function li(r,e,t){var s,n={},a=null,i=null;t!==void 0&&(a=""+t),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(i=e.ref);for(s in e)Tc.call(e,s)&&!Cc.hasOwnProperty(s)&&(n[s]=e[s]);if(r&&r.defaultProps)for(s in e=r.defaultProps,e)n[s]===void 0&&(n[s]=e[s]);return{$$typeof:Ec,type:r,key:a,ref:i,props:n,_owner:Nc.current}}br.Fragment=Ac;br.jsx=li;br.jsxs=li;ci.exports=br;var c=ci.exports,tn={},la=bc;tn.createRoot=la.createRoot,tn.hydrateRoot=la.hydrateRoot;function Pc(){return c.jsx("nav",{className:"bg-white shadow-sm",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center h-16",children:[c.jsx("div",{className:"flex items-center",children:c.jsx(se,{to:"/",className:"text-xl font-bold text-blue-600",children:"Plus+ Talent"})}),c.jsxs("div",{className:"hidden md:flex items-center space-x-8",children:[c.jsx("a",{href:"#features",className:"text-gray-600 hover:text-gray-900",children:"Features"}),c.jsx("a",{href:"#pricing",className:"text-gray-600 hover:text-gray-900",children:"Pricing"}),c.jsx(se,{to:"/login",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 transition-colors",children:"Sign In"})]})]})})})}function Oc({title:r,titleId:e,...t},s){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?p.createElement("title",{id:e},r):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"}))}const ui=p.forwardRef(Oc);function Rc({title:r,titleId:e,...t},s){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?p.createElement("title",{id:e},r):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18 9 11.25l4.306 4.306a11.95 11.95 0 0 1 5.814-5.518l2.74-1.22m0 0-5.94-2.281m5.94 2.28-2.28 5.941"}))}const Ic=p.forwardRef(Rc);function $c({title:r,titleId:e,...t},s){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?p.createElement("title",{id:e},r):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"}))}const Lc=p.forwardRef($c);function Dc({title:r,titleId:e,...t},s){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?p.createElement("title",{id:e},r):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 3.104v5.714a2.25 2.25 0 0 1-.659 1.591L5 14.5M9.75 3.104c-.251.023-.501.05-.75.082m.75-.082a24.301 24.301 0 0 1 4.5 0m0 0v5.714c0 .597.237 1.17.659 1.591L19.8 15.3M14.25 3.104c.251.023.501.05.75.082M19.8 15.3l-1.57.393A9.065 9.065 0 0 1 12 15a9.065 9.065 0 0 0-6.23-.693L5 14.5m14.8.8 1.402 1.402c1.232 1.232.65 3.318-1.067 3.611A48.309 48.309 0 0 1 12 21c-2.773 0-5.491-.235-8.135-.687-1.718-.293-2.3-2.379-1.067-3.61L5 14.5"}))}const Mc=p.forwardRef(Dc);function Fc({title:r,titleId:e,...t},s){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?p.createElement("title",{id:e},r):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"}))}const Uc=p.forwardRef(Fc);function Bc({title:r,titleId:e,...t},s){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?p.createElement("title",{id:e},r):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 14.15v4.25c0 1.094-.787 2.036-1.872 2.18-2.087.277-4.216.42-6.378.42s-4.291-.143-6.378-.42c-1.085-.144-1.872-1.086-1.872-2.18v-4.25m16.5 0a2.18 2.18 0 0 0 .75-1.661V8.706c0-1.081-.768-2.015-1.837-2.175a48.114 48.114 0 0 0-3.413-.387m4.5 8.006c-.194.165-.42.295-.673.38A23.978 23.978 0 0 1 12 15.75c-2.648 0-5.195-.429-7.577-1.22a2.016 2.016 0 0 1-.673-.38m0 0A2.18 2.18 0 0 1 3 12.489V8.706c0-1.081.768-2.015 1.837-2.175a48.111 48.111 0 0 1 3.413-.387m7.5 0V5.25A2.25 2.25 0 0 0 13.5 3h-3a2.25 2.25 0 0 0-2.25 2.25v.894m7.5 0a48.667 48.667 0 0 0-7.5 0M12 12.75h.008v.008H12v-.008Z"}))}const Wc=p.forwardRef(Bc);function qc({title:r,titleId:e,...t},s){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?p.createElement("title",{id:e},r):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const di=p.forwardRef(qc);function Vc({title:r,titleId:e,...t},s){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?p.createElement("title",{id:e},r):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}const ir=p.forwardRef(Vc);function Hc({title:r,titleId:e,...t},s){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?p.createElement("title",{id:e},r):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))}const Tn=p.forwardRef(Hc);function zc({title:r,titleId:e,...t},s){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?p.createElement("title",{id:e},r):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"}))}const Zc=p.forwardRef(zc);function Jc({title:r,titleId:e,...t},s){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?p.createElement("title",{id:e},r):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const hi=p.forwardRef(Jc);function Gc({title:r,titleId:e,...t},s){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?p.createElement("title",{id:e},r):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const xr=p.forwardRef(Gc);function Yc({title:r,titleId:e,...t},s){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?p.createElement("title",{id:e},r):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const Kc=p.forwardRef(Yc);function Xc({title:r,titleId:e,...t},s){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?p.createElement("title",{id:e},r):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"}))}const Qc=p.forwardRef(Xc);function el({title:r,titleId:e,...t},s){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?p.createElement("title",{id:e},r):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z"}))}const tl=p.forwardRef(el);function sl({title:r,titleId:e,...t},s){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?p.createElement("title",{id:e},r):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"}))}const Nn=p.forwardRef(sl);function rl({title:r,titleId:e,...t},s){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?p.createElement("title",{id:e},r):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const fi=p.forwardRef(rl);function nl({title:r,titleId:e,...t},s){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?p.createElement("title",{id:e},r):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"}))}const mi=p.forwardRef(nl);function al(){return c.jsxs("div",{className:"relative overflow-hidden",children:[c.jsx("div",{className:"absolute inset-0",children:c.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600 to-indigo-600 mix-blend-multiply"})}),c.jsx("div",{className:"relative max-w-7xl mx-auto py-24 px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"text-center",children:[c.jsxs("h1",{className:"text-4xl md:text-6xl font-extrabold text-white mb-8",children:["Transform Your Hiring with",c.jsx("span",{className:"block text-blue-200",children:"AI-Powered CV Analysis"})]}),c.jsx("p",{className:"text-xl text-blue-100 mb-12 max-w-3xl mx-auto",children:"Make better hiring decisions faster with our advanced AI technology. Match candidates to jobs with precision and generate tailored interview plans instantly."}),c.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-4",children:[c.jsxs(se,{to:"/signup",className:"inline-flex items-center justify-center px-8 py-4 border border-transparent text-lg font-medium rounded-md text-blue-600 bg-white hover:bg-blue-50 transition-colors",children:["Start Free Trial",c.jsx(ui,{className:"ml-2 h-5 w-5"})]}),c.jsx("a",{href:"#demo",className:"inline-flex items-center justify-center px-8 py-4 border-2 border-white text-lg font-medium rounded-md text-white hover:bg-white/10 transition-colors",children:"Watch Demo"})]})]})})]})}const il=[{name:"AI-Powered Analysis",description:"Advanced machine learning algorithms analyze CVs against job requirements with unprecedented accuracy.",icon:Nn,color:"bg-blue-500"},{name:"Smart Scoring",description:"Get detailed candidate fit scores and comprehensive breakdowns of qualifications.",icon:di,color:"bg-green-500"},{name:"Instant Reports",description:"Generate professional PDF reports with detailed analysis and recommendations.",icon:xr,color:"bg-purple-500"},{name:"Interview Intelligence",description:"Get AI-generated interview questions tailored to each candidate's profile.",icon:Qc,color:"bg-yellow-500"},{name:"Technical Assessment",description:"Deep analysis of technical skills and experience levels.",icon:Mc,color:"bg-red-500"},{name:"Bias Prevention",description:"Ensure fair and objective candidate evaluation with our AI system.",icon:tl,color:"bg-indigo-500"}];function ol(){return c.jsx("div",{className:"bg-white py-24",id:"features",children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:"text-center mb-16",children:[c.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Powerful Features for Modern Recruitment"}),c.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Everything you need to streamline your candidate evaluation process and make better hiring decisions."})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:il.map(r=>c.jsxs("div",{className:"bg-white rounded-xl p-8 shadow-lg hover:shadow-xl transition-shadow border border-gray-100",children:[c.jsx("div",{className:`${r.color} rounded-lg p-3 w-12 h-12 flex items-center justify-center mb-6`,children:c.jsx(r.icon,{className:"h-6 w-6 text-white"})}),c.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-3",children:r.name}),c.jsx("p",{className:"text-gray-600",children:r.description})]},r.name))})]})})}const cl=[{label:"Accuracy Rate",value:"95%",icon:Nn,description:"Match accuracy"},{label:"Time Saved",value:"75%",icon:hi,description:"Recruitment efficiency"},{label:"CVs Analyzed",value:"100K+",icon:xr,description:"And counting"},{label:"Happy Recruiters",value:"5000+",icon:mi,description:"Trusted by professionals"}];function ll(){return c.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 py-16",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:cl.map(r=>c.jsxs("div",{className:"bg-white/10 rounded-lg p-6 backdrop-blur-lg",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(r.icon,{className:"h-6 w-6 text-blue-200"}),c.jsx("h3",{className:"text-lg font-medium text-white",children:r.label})]}),c.jsx("p",{className:"mt-4 text-4xl font-bold text-white",children:r.value}),c.jsx("p",{className:"mt-1 text-sm text-blue-200",children:r.description})]},r.label))})})})}const ua=[{title:"Upload CV & Job Description",description:"Simply upload a CV and job description to get started.",icon:Lc,color:"bg-blue-500"},{title:"AI Analysis",description:"Our advanced AI analyzes the match and generates insights.",icon:Nn,color:"bg-purple-500"},{title:"Get Detailed Report",description:"Receive a comprehensive analysis with actionable insights.",icon:xr,color:"bg-green-500"},{title:"Make Better Decisions",description:"Use data-driven insights to make informed hiring decisions.",icon:mi,color:"bg-indigo-500"}];function ul(){return c.jsx("div",{className:"bg-gray-50 py-24",children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:"text-center mb-16",children:[c.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"How It Works"}),c.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Get started in minutes with our simple, powerful CV analysis process"})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:ua.map((r,e)=>c.jsxs("div",{className:"relative",children:[e<ua.length-1&&c.jsx("div",{className:"hidden lg:block absolute top-1/2 right-0 w-full h-0.5 bg-gray-200 transform translate-x-1/2"}),c.jsxs("div",{className:"bg-white rounded-xl p-8 shadow-lg relative z-10",children:[c.jsx("div",{className:`${r.color} rounded-full p-3 w-12 h-12 flex items-center justify-center mb-6`,children:c.jsx(r.icon,{className:"h-6 w-6 text-white"})}),c.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-3",children:r.title}),c.jsx("p",{className:"text-gray-600",children:r.description})]})]},r.title))})]})})}function dl({title:r,titleId:e,...t},s){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),r?p.createElement("title",{id:e},r):null,p.createElement("path",{fillRule:"evenodd",d:"M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z",clipRule:"evenodd"}))}const hl=p.forwardRef(dl),fl=[{quote:"This tool has revolutionized our hiring process. We're making better decisions faster than ever.",author:"Sarah Johnson",role:"Head of Recruitment",company:"TechCorp Inc.",rating:5},{quote:"The AI analysis is incredibly accurate. It helps us identify the best candidates quickly and efficiently.",author:"Michael Chen",role:"Technical Recruiter",company:"Innovation Labs",rating:5},{quote:"The interview suggestions are spot-on. It's like having an expert recruiter guiding you through the process.",author:"Emma Williams",role:"HR Director",company:"Global Solutions",rating:5}];function ml(){return c.jsx("div",{className:"bg-white py-24",children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:"text-center mb-16",children:[c.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Loved by Recruiters"}),c.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"See what hiring professionals are saying about our AI-powered CV analyzer"})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:fl.map(r=>c.jsxs("div",{className:"bg-white rounded-xl p-8 shadow-lg border border-gray-100",children:[c.jsx("div",{className:"flex space-x-1 mb-4",children:[...Array(r.rating)].map((e,t)=>c.jsx(hl,{className:"h-5 w-5 text-yellow-400"},t))}),c.jsxs("blockquote",{className:"text-gray-600 mb-6",children:['"',r.quote,'"']}),c.jsxs("div",{children:[c.jsx("p",{className:"font-semibold text-gray-900",children:r.author}),c.jsx("p",{className:"text-sm text-gray-500",children:r.role}),c.jsx("p",{className:"text-sm text-gray-500",children:r.company})]})]},r.author))})]})})}const pl={id:"free",name:"Free Trial",price:0,period:"month",analysisLimit:4,features:["Up to 4 CV analyses","Basic interview questions","PDF export functionality","Email support"]},gl={id:"pro",name:"Pro Plan",price:20,period:"month",analysisLimit:1e3,features:["1000 CV analyses per month","Advanced AI matching","Custom interview plans","Technical skill assessment","Team collaboration","Priority support","Analytics dashboard","Bulk analysis","API access"]},et={FREE:pl,PRO:gl};function yl(){return c.jsx("div",{className:"bg-gray-50 py-24",id:"pricing",children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:"text-center mb-16",children:[c.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Simple, Transparent Pricing"}),c.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Choose the plan that's right for your recruitment needs"})]}),c.jsxs("div",{className:"max-w-5xl mx-auto grid md:grid-cols-2 gap-8",children:[c.jsx("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden border border-gray-200",children:c.jsxs("div",{className:"p-8",children:[c.jsx("h3",{className:"text-2xl font-bold text-gray-900 text-center mb-2",children:et.FREE.name}),c.jsx("p",{className:"text-center text-gray-600 mb-6",children:"Perfect for trying out our service"}),c.jsxs("div",{className:"text-center mb-6",children:[c.jsx("span",{className:"text-4xl font-bold text-gray-900",children:"$0"}),c.jsx("span",{className:"text-gray-600",children:"/month"}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Up to ",et.FREE.analysisLimit," CV analyses"]})]}),c.jsx("ul",{className:"space-y-4 mb-8",children:et.FREE.features.map((r,e)=>c.jsxs("li",{className:"flex items-start",children:[c.jsx(ir,{className:"h-5 w-5 text-green-500 flex-shrink-0 mt-0.5"}),c.jsx("span",{className:"ml-3 text-gray-600",children:r})]},e))}),c.jsx(se,{to:"/signup",className:"block w-full bg-gray-100 text-gray-800 text-center py-3 rounded-lg font-medium hover:bg-gray-200 transition-colors",children:"Start Free Trial"})]})}),c.jsx("div",{className:"bg-gradient-to-br from-blue-600 to-indigo-600 rounded-2xl shadow-lg overflow-hidden transform hover:scale-105 transition-transform",children:c.jsxs("div",{className:"p-8",children:[c.jsx("h3",{className:"text-2xl font-bold text-white text-center mb-2",children:et.PRO.name}),c.jsx("p",{className:"text-center text-blue-100 mb-6",children:"For serious recruiters"}),c.jsxs("div",{className:"text-center mb-6",children:[c.jsxs("span",{className:"text-4xl font-bold text-white",children:["$",et.PRO.price]}),c.jsx("span",{className:"text-blue-100",children:"/month"}),c.jsxs("p",{className:"text-sm text-blue-100 mt-1",children:[et.PRO.analysisLimit," analyses per month"]})]}),c.jsx("ul",{className:"space-y-4 mb-8",children:et.PRO.features.map((r,e)=>c.jsxs("li",{className:"flex items-start",children:[c.jsx(ir,{className:"h-5 w-5 text-white flex-shrink-0 mt-0.5"}),c.jsx("span",{className:"ml-3 text-white",children:r})]},e))}),c.jsx(se,{to:"/signup",className:"block w-full bg-white text-blue-600 text-center py-3 rounded-lg font-medium hover:bg-blue-50 transition-colors",children:"Get Started"})]})})]}),c.jsx("div",{className:"text-center mt-8",children:c.jsx("p",{className:"text-sm text-gray-500",children:"All plans include a 14-day money-back guarantee"})})]})})}function _l(){return c.jsx("div",{className:"bg-gray-50 py-12",children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[c.jsx("p",{className:"text-center text-sm font-semibold text-gray-500 uppercase tracking-wide mb-8",children:"Trusted by leading companies worldwide"}),c.jsxs("div",{className:"grid grid-cols-2 gap-8 md:grid-cols-6 lg:grid-cols-5",children:[c.jsx("div",{className:"col-span-1 flex justify-center md:col-span-2 lg:col-span-1",children:c.jsx("img",{className:"h-12 opacity-50",src:"/logos/microsoft.svg",alt:"Microsoft"})}),c.jsx("div",{className:"col-span-1 flex justify-center md:col-span-2 lg:col-span-1",children:c.jsx("img",{className:"h-12 opacity-50",src:"/logos/google.svg",alt:"Google"})}),c.jsx("div",{className:"col-span-1 flex justify-center md:col-span-2 lg:col-span-1",children:c.jsx("img",{className:"h-12 opacity-50",src:"/logos/amazon.svg",alt:"Amazon"})}),c.jsx("div",{className:"col-span-1 flex justify-center md:col-span-2 lg:col-span-1",children:c.jsx("img",{className:"h-12 opacity-50",src:"/logos/meta.svg",alt:"Meta"})}),c.jsx("div",{className:"col-span-1 flex justify-center md:col-span-2 lg:col-span-1",children:c.jsx("img",{className:"h-12 opacity-50",src:"/logos/apple.svg",alt:"Apple"})})]})]})})}function wl(){return c.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 py-16",children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[c.jsx("h2",{className:"text-3xl font-bold text-white mb-4",children:"Ready to Transform Your Hiring Process?"}),c.jsx("p",{className:"text-xl text-blue-100 mb-8 max-w-3xl mx-auto",children:"Join thousands of recruiters who are making better hiring decisions with AI-powered CV analysis."}),c.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-4",children:[c.jsxs(se,{to:"/signup",className:"inline-flex items-center justify-center px-8 py-4 border border-transparent text-lg font-medium rounded-md text-blue-600 bg-white hover:bg-blue-50 transition-colors",children:["Get Started Free",c.jsx(ui,{className:"ml-2 h-5 w-5"})]}),c.jsx(se,{to:"/pricing",className:"inline-flex items-center justify-center px-8 py-4 border-2 border-white text-lg font-medium rounded-md text-white hover:bg-white/10 transition-colors",children:"View Pricing"})]})]})})}function vl(){return c.jsxs("div",{className:"bg-white",children:[c.jsx(Pc,{}),c.jsx(al,{}),c.jsx(_l,{}),c.jsx(ol,{}),c.jsx(ul,{}),c.jsx(ll,{}),c.jsx(ml,{}),c.jsx(yl,{}),c.jsx(wl,{}),c.jsx("footer",{className:"bg-gray-50 border-t border-gray-200",children:c.jsxs("div",{className:"max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-8",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-sm font-semibold text-gray-400 tracking-wider uppercase",children:"Product"}),c.jsxs("ul",{className:"mt-4 space-y-4",children:[c.jsx("li",{children:c.jsx("a",{href:"#features",className:"text-base text-gray-500 hover:text-gray-900",children:"Features"})}),c.jsx("li",{children:c.jsx("a",{href:"#pricing",className:"text-base text-gray-500 hover:text-gray-900",children:"Pricing"})}),c.jsx("li",{children:c.jsx(se,{to:"/login",className:"text-base text-gray-500 hover:text-gray-900",children:"Sign In"})})]})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-sm font-semibold text-gray-400 tracking-wider uppercase",children:"Support"}),c.jsxs("ul",{className:"mt-4 space-y-4",children:[c.jsx("li",{children:c.jsx(se,{to:"/docs",className:"text-base text-gray-500 hover:text-gray-900",children:"Documentation"})}),c.jsx("li",{children:c.jsx(se,{to:"/help",className:"text-base text-gray-500 hover:text-gray-900",children:"Help Center"})})]})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-sm font-semibold text-gray-400 tracking-wider uppercase",children:"Legal"}),c.jsxs("ul",{className:"mt-4 space-y-4",children:[c.jsx("li",{children:c.jsx(se,{to:"/privacy",className:"text-base text-gray-500 hover:text-gray-900",children:"Privacy"})}),c.jsx("li",{children:c.jsx(se,{to:"/terms",className:"text-base text-gray-500 hover:text-gray-900",children:"Terms"})})]})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-sm font-semibold text-gray-400 tracking-wider uppercase",children:"Company"}),c.jsxs("ul",{className:"mt-4 space-y-4",children:[c.jsx("li",{children:c.jsx(se,{to:"/about",className:"text-base text-gray-500 hover:text-gray-900",children:"About"})}),c.jsx("li",{children:c.jsx(se,{to:"/contact",className:"text-base text-gray-500 hover:text-gray-900",children:"Contact"})})]})]})]}),c.jsx("div",{className:"mt-8 border-t border-gray-200 pt-8",children:c.jsxs("p",{className:"text-base text-gray-400 text-center",children:["Â© ",new Date().getFullYear()," Plus+ Talent. All rights reserved."]})})]})})]})}const bl="modulepreload",xl=function(r){return"/"+r},da={},$t=function(e,t,s){let n=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=i?.nonce||i?.getAttribute("nonce");n=Promise.allSettled(t.map(l=>{if(l=xl(l),l in da)return;da[l]=!0;const u=l.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":bl,u||(h.as="script"),h.crossOrigin="",h.href=l,o&&h.setAttribute("nonce",o),document.head.appendChild(h),u)return new Promise((f,m)=>{h.addEventListener("load",f),h.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return n.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return e().catch(a)})},kl=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>$t(async()=>{const{default:s}=await Promise.resolve().then(()=>Bt);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)};class Cn extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class jl extends Cn{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Sl extends Cn{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class El extends Cn{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var sn;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(sn||(sn={}));var Al=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(s.next(d))}catch(h){i(h)}}function l(d){try{u(s.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,l)}u((s=s.apply(r,e||[])).next())})};class Tl{constructor(e,{headers:t={},customFetch:s,region:n=sn.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=kl(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return Al(this,void 0,void 0,function*(){try{const{headers:n,method:a,body:i}=t;let o={},{region:l}=t;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let u;i&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=i):typeof i=="string"?(o["Content-Type"]="text/plain",u=i):typeof FormData<"u"&&i instanceof FormData?u=i:(o["Content-Type"]="application/json",u=JSON.stringify(i)));const d=yield this.fetch(`${this.url}/${e}`,{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),n),body:u}).catch(_=>{throw new jl(_)}),h=d.headers.get("x-relay-error");if(h&&h==="true")throw new Sl(d);if(!d.ok)throw new El(d);let f=((s=d.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),m;return f==="application/json"?m=yield d.json():f==="application/octet-stream"?m=yield d.blob():f==="text/event-stream"?m=d:f==="multipart/form-data"?m=yield d.formData():m=yield d.text(),{data:m,error:null}}catch(n){return{data:null,error:n}}})}}var de={},Pn={},kr={},Cs={},jr={},Sr={},Nl=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Lt=Nl();const Cl=Lt.fetch,pi=Lt.fetch.bind(Lt),gi=Lt.Headers,Pl=Lt.Request,Ol=Lt.Response,Bt=Object.freeze(Object.defineProperty({__proto__:null,Headers:gi,Request:Pl,Response:Ol,default:pi,fetch:Cl},Symbol.toStringTag,{value:"Module"})),Rl=xc(Bt);var Er={};Object.defineProperty(Er,"__esModule",{value:!0});let Il=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Er.default=Il;var yi=ye&&ye.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Sr,"__esModule",{value:!0});const $l=yi(Rl),Ll=yi(Er);let Dl=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=$l.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const s=this.fetch;let n=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{var i,o,l;let u=null,d=null,h=null,f=a.status,m=a.statusText;if(a.ok){if(this.method!=="HEAD"){const O=await a.text();O===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?d=O:d=JSON.parse(O))}const y=(i=this.headers.Prefer)===null||i===void 0?void 0:i.match(/count=(exact|planned|estimated)/),b=(o=a.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");y&&b&&b.length>1&&(h=parseInt(b[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(u={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,h=null,f=406,m="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const y=await a.text();try{u=JSON.parse(y),Array.isArray(u)&&a.status===404&&(d=[],u=null,f=200,m="OK")}catch{a.status===404&&y===""?(f=204,m="No Content"):u={message:y}}if(u&&this.isMaybeSingle&&(!((l=u?.details)===null||l===void 0)&&l.includes("0 rows"))&&(u=null,f=200,m="OK"),u&&this.shouldThrowOnError)throw new Ll.default(u)}return{error:u,data:d,count:h,status:f,statusText:m}});return this.shouldThrowOnError||(n=n.catch(a=>{var i,o,l;return{error:{message:`${(i=a?.name)!==null&&i!==void 0?i:"FetchError"}: ${a?.message}`,details:`${(o=a?.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=a?.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),n.then(e,t)}};Sr.default=Dl;var Ml=ye&&ye.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(jr,"__esModule",{value:!0});const Fl=Ml(Sr);let Ul=class extends Fl.default{select(e){let t=!1;const s=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:n,referencedTable:a=n}={}){const i=a?`${a}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){const n=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:n=s}={}){const a=typeof n>"u"?"offset":`${n}.offset`,i=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(i,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:n=!1,wal:a=!1,format:i="text"}={}){var o;const l=[e?"analyze":null,t?"verbose":null,s?"settings":null,n?"buffers":null,a?"wal":null].filter(Boolean).join("|"),u=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${i}; for="${u}"; options=${l};`,i==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};jr.default=Ul;var Bl=ye&&ye.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Cs,"__esModule",{value:!0});const Wl=Bl(jr);let ql=class extends Wl.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map(n=>typeof n=="string"&&new RegExp("[,()]").test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:n}={}){let a="";n==="plain"?a="pl":n==="phrase"?a="ph":n==="websearch"&&(a="w");const i=s===void 0?"":`(${s})`;return this.url.searchParams.append(e,`${a}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach(([t,s])=>{this.url.searchParams.append(t,`eq.${s}`)}),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){const n=s?`${s}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}};Cs.default=ql;var Vl=ye&&ye.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(kr,"__esModule",{value:!0});const Zt=Vl(Cs);let Hl=class{constructor(e,{headers:t={},schema:s,fetch:n}){this.url=e,this.headers=t,this.schema=s,this.fetch=n}select(e,{head:t=!1,count:s}={}){const n=t?"HEAD":"GET";let a=!1;const i=(e??"*").split("").map(o=>/\s/.test(o)&&!a?"":(o==='"'&&(a=!a),o)).join("");return this.url.searchParams.set("select",i),s&&(this.headers.Prefer=`count=${s}`),new Zt.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:s=!0}={}){const n="POST",a=[];if(this.headers.Prefer&&a.push(this.headers.Prefer),t&&a.push(`count=${t}`),s||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const i=e.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(i.length>0){const o=[...new Set(i)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new Zt.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:n,defaultToNull:a=!0}={}){const i="POST",o=[`resolution=${s?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&o.push(this.headers.Prefer),n&&o.push(`count=${n}`),a||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(e)){const l=e.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(l.length>0){const u=[...new Set(l)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new Zt.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const s="PATCH",n=[];return this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),this.headers.Prefer=n.join(","),new Zt.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",s=[];return e&&s.push(`count=${e}`),this.headers.Prefer&&s.unshift(this.headers.Prefer),this.headers.Prefer=s.join(","),new Zt.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};kr.default=Hl;var Ar={},Tr={};Object.defineProperty(Tr,"__esModule",{value:!0});Tr.version=void 0;Tr.version="0.0.0-automated";Object.defineProperty(Ar,"__esModule",{value:!0});Ar.DEFAULT_HEADERS=void 0;const zl=Tr;Ar.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${zl.version}`};var _i=ye&&ye.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Pn,"__esModule",{value:!0});const Zl=_i(kr),Jl=_i(Cs),Gl=Ar;let Yl=class wi{constructor(e,{headers:t={},schema:s,fetch:n}={}){this.url=e,this.headers=Object.assign(Object.assign({},Gl.DEFAULT_HEADERS),t),this.schemaName=s,this.fetch=n}from(e){const t=new URL(`${this.url}/${e}`);return new Zl.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new wi(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:n=!1,count:a}={}){let i;const o=new URL(`${this.url}/rpc/${e}`);let l;s||n?(i=s?"HEAD":"GET",Object.entries(t).filter(([d,h])=>h!==void 0).map(([d,h])=>[d,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([d,h])=>{o.searchParams.append(d,h)})):(i="POST",l=t);const u=Object.assign({},this.headers);return a&&(u.Prefer=`count=${a}`),new Jl.default({method:i,url:o,headers:u,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};Pn.default=Yl;var Wt=ye&&ye.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(de,"__esModule",{value:!0});de.PostgrestError=de.PostgrestBuilder=de.PostgrestTransformBuilder=de.PostgrestFilterBuilder=de.PostgrestQueryBuilder=de.PostgrestClient=void 0;const vi=Wt(Pn);de.PostgrestClient=vi.default;const bi=Wt(kr);de.PostgrestQueryBuilder=bi.default;const xi=Wt(Cs);de.PostgrestFilterBuilder=xi.default;const ki=Wt(jr);de.PostgrestTransformBuilder=ki.default;const ji=Wt(Sr);de.PostgrestBuilder=ji.default;const Si=Wt(Er);de.PostgrestError=Si.default;var Kl=de.default={PostgrestClient:vi.default,PostgrestQueryBuilder:bi.default,PostgrestFilterBuilder:xi.default,PostgrestTransformBuilder:ki.default,PostgrestBuilder:ji.default,PostgrestError:Si.default};const{PostgrestClient:Xl,PostgrestQueryBuilder:Cg,PostgrestFilterBuilder:Pg,PostgrestTransformBuilder:Og,PostgrestBuilder:Rg,PostgrestError:Ig}=Kl,Ql="2.11.2",eu={"X-Client-Info":`realtime-js/${Ql}`},tu="1.0.0",Ei=1e4,su=1e3;var Nt;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(Nt||(Nt={}));var me;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(me||(me={}));var be;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(be||(be={}));var rn;(function(r){r.websocket="websocket"})(rn||(rn={}));var at;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(at||(at={}));class ru{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const n=t.getUint8(1),a=t.getUint8(2);let i=this.HEADER_LENGTH+2;const o=s.decode(e.slice(i,i+n));i=i+n;const l=s.decode(e.slice(i,i+a));i=i+a;const u=JSON.parse(s.decode(e.slice(i,e.byteLength)));return{ref:null,topic:o,event:l,payload:u}}}class Ai{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var W;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(W||(W={}));const ha=(r,e,t={})=>{var s;const n=(s=t.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((a,i)=>(a[i]=nu(i,r,e,n),a),{})},nu=(r,e,t,s)=>{const n=e.find(o=>o.name===r),a=n?.type,i=t[r];return a&&!s.includes(a)?Ti(a,i):nn(i)},Ti=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return cu(e,t)}switch(r){case W.bool:return au(e);case W.float4:case W.float8:case W.int2:case W.int4:case W.int8:case W.numeric:case W.oid:return iu(e);case W.json:case W.jsonb:return ou(e);case W.timestamp:return lu(e);case W.abstime:case W.date:case W.daterange:case W.int4range:case W.int8range:case W.money:case W.reltime:case W.text:case W.time:case W.timestamptz:case W.timetz:case W.tsrange:case W.tstzrange:return nn(e);default:return nn(e)}},nn=r=>r,au=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},iu=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},ou=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},cu=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,s=r[t];if(r[0]==="{"&&s==="}"){let a;const i=r.slice(1,t);try{a=JSON.parse("["+i+"]")}catch{a=i?i.split(","):[]}return a.map(o=>Ti(e,o))}return r},lu=r=>typeof r=="string"?r.replace(" ","T"):r,Ni=r=>{let e=r;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Dr{constructor(e,t,s={},n=Ei){this.channel=e,this.event=t,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var fa;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(fa||(fa={}));class cs{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:a,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=cs.syncState(this.state,n,a,i),this.pendingDiffs.forEach(l=>{this.state=cs.syncDiff(this.state,l,a,i)}),this.pendingDiffs=[],o()}),this.channel._on(s.diff,{},n=>{const{onJoin:a,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=cs.syncDiff(this.state,n,a,i),o())}),this.onJoin((n,a,i)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:a,newPresences:i})}),this.onLeave((n,a,i)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:a,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,n){const a=this.cloneDeep(e),i=this.transformState(t),o={},l={};return this.map(a,(u,d)=>{i[u]||(l[u]=d)}),this.map(i,(u,d)=>{const h=a[u];if(h){const f=d.map(b=>b.presence_ref),m=h.map(b=>b.presence_ref),_=d.filter(b=>m.indexOf(b.presence_ref)<0),y=h.filter(b=>f.indexOf(b.presence_ref)<0);_.length>0&&(o[u]=_),y.length>0&&(l[u]=y)}else o[u]=d}),this.syncDiff(a,{joins:o,leaves:l},s,n)}static syncDiff(e,t,s,n){const{joins:a,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(a,(o,l)=>{var u;const d=(u=e[o])!==null&&u!==void 0?u:[];if(e[o]=this.cloneDeep(l),d.length>0){const h=e[o].map(m=>m.presence_ref),f=d.filter(m=>h.indexOf(m.presence_ref)<0);e[o].unshift(...f)}s(o,d,l)}),this.map(i,(o,l)=>{let u=e[o];if(!u)return;const d=l.map(h=>h.presence_ref);u=u.filter(h=>d.indexOf(h.presence_ref)<0),e[o]=u,n(o,u,l),u.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const n=e[s];return"metas"in n?t[s]=n.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):t[s]=n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ma;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(ma||(ma={}));var pa;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(pa||(pa={}));var Me;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(Me||(Me={}));class On{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=me.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Dr(this,be.join,this.params,this.timeout),this.rejoinTimer=new Ai(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=me.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=me.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=me.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=me.errored,this.rejoinTimer.scheduleTimeout())}),this._on(be.reply,{},(n,a)=>{this._trigger(this._replyEventName(a),n)}),this.presence=new cs(this),this.broadcastEndpointURL=Ni(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,n;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:a,presence:i,private:o}}=this.params;this._onError(d=>e?.(Me.CHANNEL_ERROR,d)),this._onClose(()=>e?.(Me.CLOSED));const l={},u={broadcast:a,presence:i,postgres_changes:(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(d=>d.filter))!==null&&n!==void 0?n:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:d})=>{var h;if(this.socket.setAuth(),d===void 0){e?.(Me.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,m=(h=f?.length)!==null&&h!==void 0?h:0,_=[];for(let y=0;y<m;y++){const b=f[y],{filter:{event:O,schema:k,table:F,filter:R}}=b,L=d&&d[y];if(L&&L.event===O&&L.schema===k&&L.table===F&&L.filter===R)_.push(Object.assign(Object.assign({},b),{id:L.id}));else{this.unsubscribe(),e?.(Me.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=_,e&&e(Me.SUBSCRIBED);return}}).receive("error",d=>{e?.(Me.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{e?.(Me.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this._on(e,t,s)}async send(e,t={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){const{event:a,payload:i}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:i,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=u.body)===null||n===void 0?void 0:n.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var i,o,l;const u=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&a("ok"),u.receive("ok",()=>a("ok")),u.receive("error",()=>a("error")),u.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=me.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(be.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(s=>{const n=new Dr(this,be.leave,{},e);n.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})})}async _fetchWithTimeout(e,t,s){const n=new AbortController,a=setTimeout(()=>n.abort(),s),i=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(a),i}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Dr(this,e,t,s);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var n,a;const i=e.toLocaleLowerCase(),{close:o,error:l,leave:u,join:d}=be;if(s&&[o,l,u,d].indexOf(i)>=0&&s!==this._joinRef())return;let f=this._onMessage(i,t,s);if(t&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(m=>{var _,y,b;return((_=m.filter)===null||_===void 0?void 0:_.event)==="*"||((b=(y=m.filter)===null||y===void 0?void 0:y.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===i}).map(m=>m.callback(f,s)):(a=this.bindings[i])===null||a===void 0||a.filter(m=>{var _,y,b,O,k,F;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in m){const R=m.id,L=(_=m.filter)===null||_===void 0?void 0:_.event;return R&&((y=t.ids)===null||y===void 0?void 0:y.includes(R))&&(L==="*"||L?.toLocaleLowerCase()===((b=t.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))}else{const R=(k=(O=m?.filter)===null||O===void 0?void 0:O.event)===null||k===void 0?void 0:k.toLocaleLowerCase();return R==="*"||R===((F=t?.event)===null||F===void 0?void 0:F.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===i}).map(m=>{if(typeof f=="object"&&"ids"in f){const _=f.data,{schema:y,table:b,commit_timestamp:O,type:k,errors:F}=_;f=Object.assign(Object.assign({},{schema:y,table:b,commit_timestamp:O,eventType:k,new:{},old:{},errors:F}),this._getPayloadRecords(_))}m.callback(f,s)})}_isClosed(){return this.state===me.closed}_isJoined(){return this.state===me.joined}_isJoining(){return this.state===me.joining}_isLeaving(){return this.state===me.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const n=e.toLocaleLowerCase(),a={type:n,filter:t,callback:s};return this.bindings[n]?this.bindings[n].push(a):this.bindings[n]=[a],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(n=>{var a;return!(((a=n.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===s&&On.isEqual(n.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(be.close,{},e)}_onError(e){this._on(be.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=me.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=ha(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=ha(e.columns,e.old_record)),t}}const uu=()=>{},du=typeof WebSocket<"u",hu=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class fu{constructor(e,t){var s;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=eu,this.params={},this.timeout=Ei,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=uu,this.conn=null,this.sendBuffer=[],this.serializer=new ru,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=a=>{let i;return a?i=a:typeof fetch>"u"?i=(...o)=>$t(async()=>{const{default:l}=await Promise.resolve().then(()=>Bt);return{default:l}},void 0).then(({default:l})=>l(...o)):i=fetch,(...o)=>i(...o)},this.endPoint=`${e}/${rn.websocket}`,this.httpEndpoint=Ni(e),t?.transport?this.transport=t.transport:this.transport=null,t?.params&&(this.params=t.params),t?.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t?.timeout&&(this.timeout=t.timeout),t?.logger&&(this.logger=t.logger),t?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const n=(s=t?.params)===null||s===void 0?void 0:s.apikey;if(n&&(this.accessTokenValue=n,this.apiKey=n),this.reconnectAfterMs=t?.reconnectAfterMs?t.reconnectAfterMs:a=>[1e3,2e3,5e3,1e4][a-1]||1e4,this.encode=t?.encode?t.encode:(a,i)=>i(JSON.stringify(a)),this.decode=t?.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Ai(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t?.fetch),t?.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=t?.worker||!1,this.workerUrl=t?.workerUrl}this.accessToken=t?.accessToken||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(du){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new mu(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),$t(async()=>{const{default:e}=await import("./browser-Dwhluaoo.js").then(t=>t.b);return{default:e}},__vite__mapDeps([0,1])).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:tu}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Nt.connecting:return at.Connecting;case Nt.open:return at.Open;case Nt.closing:return at.Closing;default:return at.Closed}}isConnected(){return this.connectionState()===at.Open}channel(e,t={config:{}}){const s=new On(`realtime:${e}`,t,this);return this.channels.push(s),s}push(e){const{topic:t,event:s,payload:n,ref:a}=e,i=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${t} ${s} (${a})`,n),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let s=null;try{s=JSON.parse(atob(t.split(".")[1]))}catch{}if(s&&s.exp&&!(Math.floor(Date.now()/1e3)-s.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${s.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${s.exp}`);this.accessTokenValue=t,this.channels.forEach(n=>{t&&n.updateJoinPayload({access_token:t}),n.joinedOnce&&n._isJoined()&&n._push(be.access_token,{access_token:t})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(su,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:s,event:n,payload:a,ref:i}=t;i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${a.status||""} ${s} ${n} ${i&&"("+i+")"||""}`,a),this.channels.filter(o=>o._isMember(s)).forEach(o=>o._trigger(n,a,i)),this.stateChangeCallbacks.message.forEach(o=>o(t))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(be.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${e}${s}${n}`}_workerObjectUrl(e){let t;if(e)t=e;else{const s=new Blob([hu],{type:"application/javascript"});t=URL.createObjectURL(s)}return t}}class mu{constructor(e,t,s){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Nt.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=s.close}}class Rn extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Q(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class pu extends Rn{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class an extends Rn{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var gu=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(s.next(d))}catch(h){i(h)}}function l(d){try{u(s.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,l)}u((s=s.apply(r,e||[])).next())})};const Ci=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>$t(async()=>{const{default:s}=await Promise.resolve().then(()=>Bt);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},yu=()=>gu(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield $t(()=>Promise.resolve().then(()=>Bt),void 0)).Response:Response}),on=r=>{if(Array.isArray(r))return r.map(t=>on(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,s])=>{const n=t.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[n]=on(s)}),e};var pt=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(s.next(d))}catch(h){i(h)}}function l(d){try{u(s.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,l)}u((s=s.apply(r,e||[])).next())})};const Mr=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),_u=(r,e,t)=>pt(void 0,void 0,void 0,function*(){const s=yield yu();r instanceof s&&!t?.noResolveJson?r.json().then(n=>{e(new pu(Mr(n),r.status||500))}).catch(n=>{e(new an(Mr(n),n))}):e(new an(Mr(r),r))}),wu=(r,e,t,s)=>{const n={method:r,headers:e?.headers||{}};return r==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json"},e?.headers),s&&(n.body=JSON.stringify(s)),Object.assign(Object.assign({},n),t))};function Ps(r,e,t,s,n,a){return pt(this,void 0,void 0,function*(){return new Promise((i,o)=>{r(t,wu(e,s,n,a)).then(l=>{if(!l.ok)throw l;return s?.noResolveJson?l:l.json()}).then(l=>i(l)).catch(l=>_u(l,o,s))})})}function or(r,e,t,s){return pt(this,void 0,void 0,function*(){return Ps(r,"GET",e,t,s)})}function Ze(r,e,t,s,n){return pt(this,void 0,void 0,function*(){return Ps(r,"POST",e,s,n,t)})}function vu(r,e,t,s,n){return pt(this,void 0,void 0,function*(){return Ps(r,"PUT",e,s,n,t)})}function bu(r,e,t,s){return pt(this,void 0,void 0,function*(){return Ps(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),s)})}function Pi(r,e,t,s,n){return pt(this,void 0,void 0,function*(){return Ps(r,"DELETE",e,s,n,t)})}var le=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(s.next(d))}catch(h){i(h)}}function l(d){try{u(s.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,l)}u((s=s.apply(r,e||[])).next())})};const xu={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ga={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class ku{constructor(e,t={},s,n){this.url=e,this.headers=t,this.bucketId=s,this.fetch=Ci(n)}uploadOrUpdate(e,t,s,n){return le(this,void 0,void 0,function*(){try{let a;const i=Object.assign(Object.assign({},ga),n);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(i.upsert)});const l=i.metadata;typeof Blob<"u"&&s instanceof Blob?(a=new FormData,a.append("cacheControl",i.cacheControl),l&&a.append("metadata",this.encodeMetadata(l)),a.append("",s)):typeof FormData<"u"&&s instanceof FormData?(a=s,a.append("cacheControl",i.cacheControl),l&&a.append("metadata",this.encodeMetadata(l))):(a=s,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),n?.headers&&(o=Object.assign(Object.assign({},o),n.headers));const u=this._removeEmptyFolders(t),d=this._getFinalPath(u),h=yield this.fetch(`${this.url}/object/${d}`,Object.assign({method:e,body:a,headers:o},i?.duplex?{duplex:i.duplex}:{})),f=yield h.json();return h.ok?{data:{path:u,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(a){if(Q(a))return{data:null,error:a};throw a}})}upload(e,t,s){return le(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,n){return le(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),i=this._getFinalPath(a),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",t);try{let l;const u=Object.assign({upsert:ga.upsert},n),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&s instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",s)):typeof FormData<"u"&&s instanceof FormData?(l=s,l.append("cacheControl",u.cacheControl)):(l=s,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const h=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:d}),f=yield h.json();return h.ok?{data:{path:a,fullPath:f.Key},error:null}:{data:null,error:f}}catch(l){if(Q(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return le(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const n=Object.assign({},this.headers);t?.upsert&&(n["x-upsert"]="true");const a=yield Ze(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:n}),i=new URL(this.url+a.url),o=i.searchParams.get("token");if(!o)throw new Rn("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:o},error:null}}catch(s){if(Q(s))return{data:null,error:s};throw s}})}update(e,t,s){return le(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return le(this,void 0,void 0,function*(){try{return{data:yield Ze(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s?.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(Q(n))return{data:null,error:n};throw n}})}copy(e,t,s){return le(this,void 0,void 0,function*(){try{return{data:{path:(yield Ze(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(Q(n))return{data:null,error:n};throw n}})}createSignedUrl(e,t,s){return le(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),a=yield Ze(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},s?.transform?{transform:s.transform}:{}),{headers:this.headers});const i=s?.download?`&download=${s.download===!0?"":s.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${i}`)},{data:a,error:null}}catch(n){if(Q(n))return{data:null,error:n};throw n}})}createSignedUrls(e,t,s){return le(this,void 0,void 0,function*(){try{const n=yield Ze(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),a=s?.download?`&download=${s.download===!0?"":s.download}`:"";return{data:n.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${a}`):null})),error:null}}catch(n){if(Q(n))return{data:null,error:n};throw n}})}download(e,t){return le(this,void 0,void 0,function*(){const n=typeof t?.transform<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString(t?.transform||{}),i=a?`?${a}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield or(this.fetch,`${this.url}/${n}/${o}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Q(o))return{data:null,error:o};throw o}})}info(e){return le(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const s=yield or(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:on(s),error:null}}catch(s){if(Q(s))return{data:null,error:s};throw s}})}exists(e){return le(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield bu(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(Q(s)&&s instanceof an){const n=s.originalError;if([400,404].includes(n?.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,t){const s=this._getFinalPath(e),n=[],a=t?.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&n.push(a);const o=typeof t?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(t?.transform||{});l!==""&&n.push(l);let u=n.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${s}${u}`)}}}remove(e){return le(this,void 0,void 0,function*(){try{return{data:yield Pi(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Q(t))return{data:null,error:t};throw t}})}list(e,t,s){return le(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},xu),t),{prefix:e||""});return{data:yield Ze(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(Q(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const ju="2.7.1",Su={"X-Client-Info":`storage-js/${ju}`};var _t=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(s.next(d))}catch(h){i(h)}}function l(d){try{u(s.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,l)}u((s=s.apply(r,e||[])).next())})};class Eu{constructor(e,t={},s){this.url=e,this.headers=Object.assign(Object.assign({},Su),t),this.fetch=Ci(s)}listBuckets(){return _t(this,void 0,void 0,function*(){try{return{data:yield or(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Q(e))return{data:null,error:e};throw e}})}getBucket(e){return _t(this,void 0,void 0,function*(){try{return{data:yield or(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Q(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return _t(this,void 0,void 0,function*(){try{return{data:yield Ze(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Q(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return _t(this,void 0,void 0,function*(){try{return{data:yield vu(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Q(s))return{data:null,error:s};throw s}})}emptyBucket(e){return _t(this,void 0,void 0,function*(){try{return{data:yield Ze(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Q(t))return{data:null,error:t};throw t}})}deleteBucket(e){return _t(this,void 0,void 0,function*(){try{return{data:yield Pi(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Q(t))return{data:null,error:t};throw t}})}}class Au extends Eu{constructor(e,t={},s){super(e,t,s)}from(e){return new ku(this.url,this.headers,e,this.fetch)}}const Tu="2.47.8";let Qt="";typeof Deno<"u"?Qt="deno":typeof document<"u"?Qt="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Qt="react-native":Qt="node";const Nu={"X-Client-Info":`supabase-js-${Qt}/${Tu}`},Cu={headers:Nu},Pu={schema:"public"},Ou={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Ru={};var Iu=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(s.next(d))}catch(h){i(h)}}function l(d){try{u(s.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,l)}u((s=s.apply(r,e||[])).next())})};const $u=r=>{let e;return r?e=r:typeof fetch>"u"?e=pi:e=fetch,(...t)=>e(...t)},Lu=()=>typeof Headers>"u"?gi:Headers,Du=(r,e,t)=>{const s=$u(t),n=Lu();return(a,i)=>Iu(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:r;let u=new n(i?.headers);return u.has("apikey")||u.set("apikey",r),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),s(a,Object.assign(Object.assign({},i),{headers:u}))})};var Mu=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(s.next(d))}catch(h){i(h)}}function l(d){try{u(s.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,l)}u((s=s.apply(r,e||[])).next())})};function Fu(r){return r.replace(/\/$/,"")}function Uu(r,e){const{db:t,auth:s,realtime:n,global:a}=r,{db:i,auth:o,realtime:l,global:u}=e,d={db:Object.assign(Object.assign({},i),t),auth:Object.assign(Object.assign({},o),s),realtime:Object.assign(Object.assign({},l),n),global:Object.assign(Object.assign({},u),a),accessToken:()=>Mu(this,void 0,void 0,function*(){return""})};return r.accessToken?d.accessToken=r.accessToken:delete d.accessToken,d}const Oi="2.67.1",Bu="http://localhost:9999",Wu="supabase.auth.token",qu={"X-Client-Info":`gotrue-js/${Oi}`},ya=10,cn="X-Supabase-Api-Version",Ri={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function Vu(r){return Math.round(Date.now()/1e3)+r}function Hu(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const _e=()=>typeof document<"u",tt={tested:!1,writable:!1},ls=()=>{if(!_e())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(tt.tested)return tt.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),tt.tested=!0,tt.writable=!0}catch{tt.tested=!0,tt.writable=!1}return tt.writable};function Fr(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((n,a)=>{e[a]=n})}catch{}return t.searchParams.forEach((s,n)=>{e[n]=s}),e}const Ii=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>$t(async()=>{const{default:s}=await Promise.resolve().then(()=>Bt);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},zu=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",$i=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},Bs=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Ws=async(r,e)=>{await r.removeItem(e)};function Zu(r){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let t="",s,n,a,i,o,l,u,d=0;for(r=r.replace("-","+").replace("_","/");d<r.length;)i=e.indexOf(r.charAt(d++)),o=e.indexOf(r.charAt(d++)),l=e.indexOf(r.charAt(d++)),u=e.indexOf(r.charAt(d++)),s=i<<2|o>>4,n=(o&15)<<4|l>>2,a=(l&3)<<6|u,t=t+String.fromCharCode(s),l!=64&&n!=0&&(t=t+String.fromCharCode(n)),u!=64&&a!=0&&(t=t+String.fromCharCode(a));return t}class Nr{constructor(){this.promise=new Nr.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Nr.promiseConstructor=Promise;function _a(r){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,t=r.split(".");if(t.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const s=t[1];return JSON.parse(Zu(s))}async function Ju(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function Gu(r,e){return new Promise((s,n)=>{(async()=>{for(let a=0;a<1/0;a++)try{const i=await r(a);if(!e(a,null,i)){s(i);return}}catch(i){if(!e(a,i)){n(i);return}}})()})}function Yu(r){return("0"+r.toString(16)).substr(-2)}function Ku(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let n="";for(let a=0;a<56;a++)n+=t.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,Yu).join("")}async function Xu(r){const t=new TextEncoder().encode(r),s=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(s);return Array.from(n).map(a=>String.fromCharCode(a)).join("")}function Qu(r){return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ed(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await Xu(r);return Qu(t)}async function wt(r,e,t=!1){const s=Ku();let n=s;t&&(n+="/PASSWORD_RECOVERY"),await $i(r,`${e}-code-verifier`,n);const a=await ed(s);return[a,s===a?"plain":"s256"]}const td=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function sd(r){const e=r.headers.get(cn);if(!e||!e.match(td))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class In extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function T(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class rd extends In{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function nd(r){return T(r)&&r.name==="AuthApiError"}class Li extends In{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class gt extends In{constructor(e,t,s,n){super(e,s,n),this.name=t,this.status=s}}class He extends gt{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function ad(r){return T(r)&&r.name==="AuthSessionMissingError"}class Ur extends gt{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class qs extends gt{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Vs extends gt{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function id(r){return T(r)&&r.name==="AuthImplicitGrantRedirectError"}class wa extends gt{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ln extends gt{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Br(r){return T(r)&&r.name==="AuthRetryableFetchError"}class va extends gt{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}var od=function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(r);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(r,s[n])&&(t[s[n]]=r[s[n]]);return t};const rt=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),cd=[502,503,504];async function ba(r){var e;if(!zu(r))throw new ln(rt(r),0);if(cd.includes(r.status))throw new ln(rt(r),r.status);let t;try{t=await r.json()}catch(a){throw new Li(rt(a),a)}let s;const n=sd(r);if(n&&n.getTime()>=Ri["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?s=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(s=t.error_code),s){if(s==="weak_password")throw new va(rt(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new He}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((a,i)=>a&&typeof i=="string",!0))throw new va(rt(t),r.status,t.weak_password.reasons);throw new rd(rt(t),r.status||500,s)}const ld=(r,e,t,s)=>{const n={method:r,headers:e?.headers||{}};return r==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),t))};async function P(r,e,t,s){var n;const a=Object.assign({},s?.headers);a[cn]||(a[cn]=Ri["2024-01-01"].name),s?.jwt&&(a.Authorization=`Bearer ${s.jwt}`);const i=(n=s?.query)!==null&&n!==void 0?n:{};s?.redirectTo&&(i.redirect_to=s.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await ud(r,e,t+o,{headers:a,noResolveJson:s?.noResolveJson},{},s?.body);return s?.xform?s?.xform(l):{data:Object.assign({},l),error:null}}async function ud(r,e,t,s,n,a){const i=ld(e,s,n,a);let o;try{o=await r(t,Object.assign({},i))}catch(l){throw console.error(l),new ln(rt(l),0)}if(o.ok||await ba(o),s?.noResolveJson)return o;try{return await o.json()}catch(l){await ba(l)}}function ze(r){var e;let t=null;md(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=Vu(r.expires_in)));const s=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:s},error:null}}function xa(r){const e=ze(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,s)=>t&&typeof s=="string",!0)&&(e.data.weak_password=r.weak_password),e}function Je(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function dd(r){return{data:r,error:null}}function hd(r){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:n,verification_type:a}=r,i=od(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:s,redirect_to:n,verification_type:a},l=Object.assign({},i);return{data:{properties:o,user:l},error:null}}function fd(r){return r}function md(r){return r.access_token&&r.refresh_token&&r.expires_in}var pd=function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(r);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(r,s[n])&&(t[s[n]]=r[s[n]]);return t};class gd{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=Ii(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await P(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(T(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await P(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Je})}catch(s){if(T(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=pd(e,["options"]),n=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(n.new_email=s?.newEmail,delete n.newEmail),await P(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:hd,redirectTo:t?.redirectTo})}catch(t){if(T(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await P(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Je})}catch(t){if(T(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,n,a,i,o,l;try{const u={nextPage:null,lastPage:0,total:0},d=await P(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(a=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:""},xform:fd});if(d.error)throw d.error;const h=await d.json(),f=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,m=(l=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return m.length>0&&(m.forEach(_=>{const y=parseInt(_.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(_.split(";")[1].split("=")[1]);u[`${b}Page`]=y}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(T(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){try{return await P(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Je})}catch(t){if(T(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await P(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Je})}catch(s){if(T(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){try{return await P(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Je})}catch(s){if(T(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){try{const{data:t,error:s}=await P(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:t,error:s}}catch(t){if(T(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await P(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(T(t))return{data:null,error:t};throw t}}}const yd={getItem:r=>ls()?globalThis.localStorage.getItem(r):null,setItem:(r,e)=>{ls()&&globalThis.localStorage.setItem(r,e)},removeItem:r=>{ls()&&globalThis.localStorage.removeItem(r)}};function ka(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}function _d(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const vt={debug:!!(globalThis&&ls()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Di extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class wd extends Di{}async function vd(r,e,t){vt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),vt.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){vt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,n.name);try{return await t()}finally{vt.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,n.name)}}else{if(e===0)throw vt.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new wd(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(vt.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}_d();const bd={url:Bu,storageKey:Wu,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:qu,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},Jt=30*1e3,ja=3;async function Sa(r,e,t){return await t()}class fs{constructor(e){var t,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=fs.nextInstanceID,fs.nextInstanceID+=1,this.instanceID>0&&_e()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},bd),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new gd({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=Ii(n.fetch),this.lock=n.lock||Sa,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:_e()&&(!((t=globalThis?.navigator)===null||t===void 0)&&t.locks)?this.lock=vd:this.lock=Sa,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:ls()?this.storage=yd:(this.memoryStorage={},this.storage=ka(this.memoryStorage)):(this.memoryStorage={},this.storage=ka(this.memoryStorage)),_e()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Oi}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=_e()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",t),t||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:s,error:n}=await this._getSessionFromURL(t);if(n){if(this._debug("#_initialize()","error detecting session from URL",n),id(n)){const o=(e=n.details)===null||e===void 0?void 0:e.code;if(o==="identity_already_exists"||o==="identity_not_found"||o==="single_identity_not_deletable")return{error:n}}return await this._removeSession(),{error:n}}const{session:a,redirectType:i}=s;return this._debug("#_initialize()","detected session in URL",a,"redirect type",i),await this._saveSession(a),setTimeout(async()=>{i==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return T(t)?{error:t}:{error:new Li("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,n;try{const a=await P(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e?.options)===null||n===void 0?void 0:n.captchaToken}},xform:ze}),{data:i,error:o}=a;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(a){if(T(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var t,s,n;try{let a;if("email"in e){const{email:d,password:h,options:f}=e;let m=null,_=null;this.flowType==="pkce"&&([m,_]=await wt(this.storage,this.storageKey)),a=await P(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f?.emailRedirectTo,body:{email:d,password:h,data:(t=f?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:m,code_challenge_method:_},xform:ze})}else if("phone"in e){const{phone:d,password:h,options:f}=e;a=await P(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(s=f?.data)!==null&&s!==void 0?s:{},channel:(n=f?.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:ze})}else throw new qs("You must provide either an email or phone number and a password");const{data:i,error:o}=a;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(a){if(T(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:a,password:i,options:o}=e;t=await P(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:i,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:xa})}else if("phone"in e){const{phone:a,password:i,options:o}=e;t=await P(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:i,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:xa})}else throw new qs("You must provide either an email or phone number and a password");const{data:s,error:n}=t;return n?{data:{user:null,session:null},error:n}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new Ur}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(t){if(T(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,n,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await Bs(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(t??"").split("/");try{const{data:a,error:i}=await P(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:ze});if(await Ws(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new Ur}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:n??null}),error:i})}catch(a){if(T(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:t,provider:s,token:n,access_token:a,nonce:i}=e,o=await P(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:a,nonce:i,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:ze}),{data:l,error:u}=o;return u?{data:{user:null,session:null},error:u}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Ur}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:u})}catch(t){if(T(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,n,a,i;try{if("email"in e){const{email:o,options:l}=e;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await wt(this.storage,this.storageKey));const{error:h}=await P(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=l?.data)!==null&&t!==void 0?t:{},create_user:(s=l?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:l?.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:o,options:l}=e,{data:u,error:d}=await P(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(n=l?.data)!==null&&n!==void 0?n:{},create_user:(a=l?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},channel:(i=l?.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:u?.message_id},error:d}}throw new qs("You must provide either an email or phone number.")}catch(o){if(T(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,s;try{let n,a;"options"in e&&(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo,a=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:i,error:o}=await P(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:n,xform:ze});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const l=i.session,u=i.user;return l?.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(n){if(T(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var t,s,n;try{let a=null,i=null;return this.flowType==="pkce"&&([a,i]=await wt(this.storage,this.storageKey)),await P(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e?.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:i}),headers:this.headers,xform:dd})}catch(a){if(T(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new He;const{error:n}=await P(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(T(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:a}=e,{error:i}=await P(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:a?.captchaToken}},redirectTo:a?.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in e){const{phone:s,type:n,options:a}=e,{data:i,error:o}=await P(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:a?.captchaToken}}});return{data:{user:null,session:null,messageId:i?.message_id},error:o}}throw new qs("You must provide either an email or phone number and a type")}catch(t){if(T(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Bs(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.storage.isServer){let i=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,u,d)=>(!i&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,u,d))})}return{data:{session:e},error:null}}const{session:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await P(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Je}):await this._useSession(async t=>{var s,n,a;const{data:i,error:o}=t;if(o)throw o;return!(!((s=i.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new He}:await P(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0,xform:Je})})}catch(t){if(T(t))return ad(t)&&(await this._removeSession(),await Ws(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:n,error:a}=s;if(a)throw a;if(!n.session)throw new He;const i=n.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await wt(this.storage,this.storageKey));const{data:u,error:d}=await P(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:i.access_token,xform:Je});if(d)throw d;return i.user=u.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(s){if(T(s))return{data:{user:null},error:s};throw s}}_decodeJWT(e){return _a(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new He;const t=Date.now()/1e3;let s=t,n=!0,a=null;const i=_a(e.access_token);if(i.exp&&(s=i.exp,n=s<=t),n){const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};a=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;a={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(t){if(T(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:i,error:o}=t;if(o)throw o;e=(s=i.session)!==null&&s!==void 0?s:void 0}if(!e?.refresh_token)throw new He;const{session:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(T(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e){try{if(!_e())throw new Vs("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new Vs("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new wa("Not a valid PKCE flow url.");const t=Fr(window.location.href);if(e){if(!t.code)throw new wa("No code detected.");const{data:k,error:F}=await this._exchangeCodeForSession(t.code);if(F)throw F;const R=new URL(window.location.href);return R.searchParams.delete("code"),window.history.replaceState(window.history.state,"",R.toString()),{data:{session:k.session,redirectType:null},error:null}}if(t.error||t.error_description||t.error_code)throw new Vs(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});const{provider_token:s,provider_refresh_token:n,access_token:a,refresh_token:i,expires_in:o,expires_at:l,token_type:u}=t;if(!a||!o||!i||!u)throw new Vs("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(o);let f=d+h;l&&(f=parseInt(l));const m=f-d;m*1e3<=Jt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${h}s`);const _=f-h;d-_>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",_,f,d):d-_<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",_,f,d);const{data:y,error:b}=await this._getUser(a);if(b)throw b;const O={provider_token:s,provider_refresh_token:n,access_token:a,expires_in:h,expires_at:f,refresh_token:i,token_type:u,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:O,redirectType:t.type},error:null}}catch(t){if(T(t))return{data:{session:null,redirectType:null},error:t};throw t}}_isImplicitGrantFlow(){const e=Fr(window.location.href);return!!(_e()&&(e.access_token||e.error_description))}async _isPKCEFlow(){const e=Fr(window.location.href),t=await Bs(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:n,error:a}=t;if(a)return{error:a};const i=(s=n.session)===null||s===void 0?void 0:s.access_token;if(i){const{error:o}=await this.admin.signOut(i,e);if(o&&!(nd(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await Ws(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=Hu(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,n;try{const{data:{session:a},error:i}=t;if(i)throw i;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,t={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await wt(this.storage,this.storageKey,!0));try{return await P(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(T(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(T(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:n}=await this._useSession(async a=>{var i,o,l,u,d;const{data:h,error:f}=a;if(f)throw f;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await P(this.fetch,"GET",m,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(n)throw n;return _e()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(s?.url),{data:{provider:e.provider,url:s?.url},error:null}}catch(s){if(T(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,n;const{data:a,error:i}=t;if(i)throw i;return await P(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(t){if(T(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await Gu(async n=>(n>0&&await Ju(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await P(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ze})),(n,a)=>{const i=200*Math.pow(2,n);return a&&Br(a)&&Date.now()+i-s<Jt})}catch(s){if(this._debug(t,"error",s),T(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),_e()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const s=await Bs(this.storage,this.storageKey);if(this._debug(t,"session from storage",s),!this._isValidSession(s)){this._debug(t,"session is not valid"),s!==null&&await this._removeSession();return}const n=Math.round(Date.now()/1e3),a=((e=s.expires_at)!==null&&e!==void 0?e:1/0)<n+ya;if(this._debug(t,`session has${a?"":" not"} expired with margin of ${ya}s`),a){if(this.autoRefreshToken&&s.refresh_token){const{error:i}=await this._callRefreshToken(s.refresh_token);i&&(console.error(i),Br(i)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(t,"error",s),console.error(s);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new He;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Nr;const{data:a,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!a.session)throw new He;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const o={session:a.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(a){if(this._debug(n,"error",a),T(a)){const i={session:null,error:a};return Br(a)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(i),i}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(a),a}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(l){a.push(l)}});if(await Promise.all(i),a.length>0){for(let o=0;o<a.length;o+=1)console.error(a[o]);throw a[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await $i(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Ws(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&_e()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Jt);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/Jt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Jt}ms, refresh threshold is ${ja} ticks`),n<=ja&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Di)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!_e()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const n=[`provider=${encodeURIComponent(t)}`];if(s?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[a,i]=await wt(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(i)}`});n.push(o.toString())}if(s?.queryParams){const a=new URLSearchParams(s.queryParams);n.push(a.toString())}return s?.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:n,error:a}=t;return a?{data:null,error:a}:await P(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(T(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,n;const{data:a,error:i}=t;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:u}=await P(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(s=a?.session)===null||s===void 0?void 0:s.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((n=l?.totp)===null||n===void 0)&&n.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(T(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:a}=t;if(a)return{data:null,error:a};const{data:i,error:o}=await P(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(t){if(T(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:a}=t;return a?{data:null,error:a}:await P(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(T(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=e?.factors||[],n=s.filter(i=>i.factor_type==="totp"&&i.status==="verified"),a=s.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:s,totp:n,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;const{data:{session:n},error:a}=e;if(a)return{data:null,error:a};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const i=this._decodeJWT(n.access_token);let o=null;i.aal&&(o=i.aal);let l=o;((s=(t=n.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(l="aal2");const d=i.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:d},error:null}}))}}fs.nextInstanceID=0;const xd=fs;class kd extends xd{constructor(e){super(e)}}var jd=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(i){i(a)})}return new(t||(t=Promise))(function(a,i){function o(d){try{u(s.next(d))}catch(h){i(h)}}function l(d){try{u(s.throw(d))}catch(h){i(h)}}function u(d){d.done?a(d.value):n(d.value).then(o,l)}u((s=s.apply(r,e||[])).next())})};class Sd{constructor(e,t,s){var n,a,i;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=Fu(e);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,u={db:Pu,realtime:Ru,auth:Object.assign(Object.assign({},Ou),{storageKey:l}),global:Cu},d=Uu(s??{},u);this.storageKey=(n=d.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(a=d.global.headers)!==null&&a!==void 0?a:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(h,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=d.auth)!==null&&i!==void 0?i:{},this.headers,d.global.fetch),this.fetch=Du(t,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new Xl(`${o}/rest/v1`,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),d.accessToken||this._listenForAuthEvents()}get functions(){return new Tl(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Au(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return jd(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(t=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,storageKey:a,flowType:i,lock:o,debug:l},u,d){var h;const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new kd({url:this.authUrl,headers:Object.assign(Object.assign({},f),u),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,flowType:i,lock:o,debug:l,fetch:d,hasCustomAuthorizationHeader:(h="Authorization"in this.headers)!==null&&h!==void 0?h:!1})}_initRealtimeClient(e){return new fu(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,s)=>{this._handleTokenChanged(t,"CLIENT",s?.access_token)})}_handleTokenChanged(e,t,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Ed=(r,e,t)=>new Sd(r,e,t),Ad="https://your-production-project.supabase.co",Td="your-production-anon-key",H=Ed(Ad,Td);function ut({children:r,isLoading:e,variant:t="primary",...s}){const n="w-full py-2 px-4 rounded-md transition-colors disabled:opacity-50",a={primary:"bg-blue-600 text-white hover:bg-blue-700",secondary:"bg-gray-200 text-gray-800 hover:bg-gray-300"};return c.jsx("button",{...s,className:`${n} ${a[t]}`,disabled:e||s.disabled,children:e?c.jsxs("span",{className:"flex items-center justify-center",children:[c.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading..."]}):r})}function ct({label:r,error:e,...t}){return c.jsxs("div",{children:[c.jsx("label",{htmlFor:t.id,className:"block text-sm font-medium text-gray-700",children:r}),c.jsx("input",{...t,className:"mt-1 block w-full rounded-md border p-2 focus:border-blue-500 focus:ring focus:ring-blue-200"}),e&&c.jsx("p",{className:"mt-1 text-sm text-red-600",children:e})]})}function Nd(){const[r,e]=p.useState(""),[t,s]=p.useState(""),[n,a]=p.useState(null),[i,o]=p.useState(!1),l=async u=>{u.preventDefault(),a(null),o(!0);try{const{error:d}=await H.auth.signInWithPassword({email:r,password:t});if(d)throw d}catch(d){a(d instanceof Error?d.message:"An error occurred")}finally{o(!1)}};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("form",{onSubmit:l,className:"space-y-4",children:[c.jsx(ct,{id:"email",type:"email",label:"Email",value:r,onChange:u=>e(u.target.value),required:!0}),c.jsx(ct,{id:"password",type:"password",label:"Password",value:t,onChange:u=>s(u.target.value),required:!0}),n&&c.jsx("div",{className:"text-red-600 text-sm",children:n}),c.jsx(ut,{type:"submit",isLoading:i,children:"Sign In"})]}),c.jsx("div",{className:"text-center",children:c.jsxs("p",{className:"text-sm text-gray-600",children:["Don't have an account?"," ",c.jsx(se,{to:"/signup",className:"text-blue-600 hover:text-blue-700",children:"Sign up"})]})})]})}function Cd(){return c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:c.jsxs("div",{className:"max-w-md w-full bg-white p-8 rounded-lg shadow-md",children:[c.jsx("h1",{className:"text-2xl font-bold mb-6 text-center",children:"Welcome Back"}),c.jsx("p",{className:"text-gray-600 text-center mb-8",children:"Sign in to continue to CV Analyzer"}),c.jsx(Nd,{})]})})}function Pd(){const[r,e]=p.useState(""),[t,s]=p.useState(""),[n,a]=p.useState(""),[i,o]=p.useState(null),[l,u]=p.useState(!1),d=async h=>{if(h.preventDefault(),o(null),t!==n){o("Passwords do not match");return}u(!0);try{const{error:f}=await H.auth.signUp({email:r,password:t,options:{emailRedirectTo:`${window.location.origin}/auth/callback`}});if(f)throw f}catch(f){o(f instanceof Error?f.message:"An error occurred")}finally{u(!1)}};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("form",{onSubmit:d,className:"space-y-4",children:[c.jsx(ct,{id:"email",type:"email",label:"Email",value:r,onChange:h=>e(h.target.value),required:!0}),c.jsx(ct,{id:"password",type:"password",label:"Password",value:t,onChange:h=>s(h.target.value),required:!0}),c.jsx(ct,{id:"confirmPassword",type:"password",label:"Confirm Password",value:n,onChange:h=>a(h.target.value),required:!0}),i&&c.jsx("div",{className:"text-red-600 text-sm",children:i}),c.jsx(ut,{type:"submit",isLoading:l,children:"Sign Up"})]}),c.jsx("div",{className:"text-center",children:c.jsxs("p",{className:"text-sm text-gray-600",children:["Already have an account?"," ",c.jsx(se,{to:"/login",className:"text-blue-600 hover:text-blue-700",children:"Sign in"})]})})]})}function Od(){return c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:c.jsxs("div",{className:"max-w-md w-full bg-white p-8 rounded-lg shadow-md",children:[c.jsx("h1",{className:"text-2xl font-bold mb-6 text-center",children:"Create Account"}),c.jsx("p",{className:"text-gray-600 text-center mb-8",children:"Join CV Analyzer to start analyzing candidates"}),c.jsx(Pd,{})]})})}const Wr={AUTH:{INVALID_CREDENTIALS:"Invalid email or password",EMAIL_IN_USE:"This email is already registered",WEAK_PASSWORD:"Password must be at least 8 characters",SESSION_EXPIRED:"Your session has expired. Please sign in again"},API:{GENERAL:"An unexpected error occurred",NETWORK:"Network error. Please check your connection",RATE_LIMIT:"Too many requests. Please try again later"},ANALYSIS:{FAILED:"Failed to analyze CV",NOT_FOUND:"Analysis not found",LIMIT_REACHED:"Analysis limit reached. Please upgrade your plan"}},Rd={VITE_SUPABASE_URL:"https://your-production-project.supabase.co",VITE_SUPABASE_ANON_KEY:"your-production-anon-key",VITE_OPENAI_API_KEY:"your-production-openai-key",VITE_STRIPE_PUBLIC_KEY:"your-production-stripe-key"};Object.entries(Rd).forEach(([r,e])=>{if(!e)throw new Error(`Missing required environment variable: ${r}`)});function Cr(r){return r instanceof Error?r.name==="AuthError"?Wr.AUTH.INVALID_CREDENTIALS:r.name==="NetworkError"?Wr.API.NETWORK:r.message:Wr.API.GENERAL}function Os(){const[r,e]=p.useState(null),[t,s]=p.useState(!0);return p.useEffect(()=>{H.auth.getSession().then(({data:{session:i}})=>{e(i),s(!1)});const{data:{subscription:a}}=H.auth.onAuthStateChange((i,o)=>{e(o),o&&hs.trackEvent("user_signed_in")});return()=>a.unsubscribe()},[]),{session:r,loading:t,signOut:async()=>{try{const{error:a}=await H.auth.signOut();if(a)throw a;hs.trackEvent("user_signed_out")}catch(a){Cr(a)}}}}function Id(){const{signOut:r}=Os(),e=ii(),t=async()=>{try{await r(),e("/",{replace:!0})}catch(s){console.error("Sign out failed:",s)}};return c.jsx("header",{className:"bg-white shadow",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center h-16",children:[c.jsx("div",{className:"flex items-center",children:c.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"CV Analyzer"})}),c.jsx("div",{className:"flex items-center space-x-4",children:c.jsxs("button",{onClick:t,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[c.jsx(fi,{className:"h-5 w-5 mr-2"}),"Sign Out"]})})]})})})}function Mi({label:r,error:e,...t}){return c.jsxs("div",{children:[c.jsx("label",{htmlFor:t.id,className:"block text-sm font-medium text-gray-700",children:r}),c.jsx("textarea",{...t,className:"mt-1 block w-full rounded-md border p-2 h-32 focus:border-blue-500 focus:ring focus:ring-blue-200"}),e&&c.jsx("p",{className:"mt-1 text-sm text-red-600",children:e})]})}function Rs(r,e){const[t,s]=p.useState(null),[n,a]=p.useState(!0),[i,o]=p.useState(null),l=p.useCallback(async()=>{try{a(!0),o(null);const u=await r();s(u)}catch(u){o(u instanceof Error?u.message:"An error occurred")}finally{a(!1)}},[r]);return p.useEffect(()=>{e?.enabled!==!1&&l()},[l,e?.enabled]),{data:t,isLoading:n,error:i,refetch:l}}class Ue extends Error{constructor(e,t,s){super(e),this.statusCode=t,this.code=s,this.name="ApiError"}}async function $d(r){const{data:e,error:t}=await H.from("candidates").insert([r]).select().single();if(t)throw new Ue("Failed to upload candidate",500);return e}async function Ld(){const{data:r,error:e}=await H.from("candidates").select("*").order("created_at",{ascending:!1});if(e)throw new Ue("Failed to fetch candidates",500);return r||[]}function Fi(){const{data:r,isLoading:e,error:t,refetch:s}=Rs(Ld);return{candidates:r||[],isLoading:e,error:t,refetch:s}}function We({size:r="md"}){const e={sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"};return c.jsx("div",{className:`animate-spin rounded-full border-2 border-gray-300 border-t-blue-600 ${e[r]}`})}function Ui(r,e){p.useEffect(()=>{const t=s=>{!r.current||r.current.contains(s.target)||e()};return document.addEventListener("mousedown",t),document.addEventListener("touchstart",t),()=>{document.removeEventListener("mousedown",t),document.removeEventListener("touchstart",t)}},[r,e])}function B(r){const e=Object.prototype.toString.call(r);return r instanceof Date||typeof r=="object"&&e==="[object Date]"?new r.constructor(+r):typeof r=="number"||e==="[object Number]"||typeof r=="string"||e==="[object String]"?new Date(r):new Date(NaN)}function Ge(r,e){return r instanceof Date?new r.constructor(e):new Date(e)}const Bi=6048e5,Dd=864e5,Hs=43200,Ea=1440;let Md={};function Is(){return Md}function ms(r,e){const t=Is(),s=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,n=B(r),a=n.getDay(),i=(a<s?7:0)+a-s;return n.setDate(n.getDate()-i),n.setHours(0,0,0,0),n}function cr(r){return ms(r,{weekStartsOn:1})}function Wi(r){const e=B(r),t=e.getFullYear(),s=Ge(r,0);s.setFullYear(t+1,0,4),s.setHours(0,0,0,0);const n=cr(s),a=Ge(r,0);a.setFullYear(t,0,4),a.setHours(0,0,0,0);const i=cr(a);return e.getTime()>=n.getTime()?t+1:e.getTime()>=i.getTime()?t:t-1}function Aa(r){const e=B(r);return e.setHours(0,0,0,0),e}function lr(r){const e=B(r),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+r-+t}function Fd(r,e){const t=Aa(r),s=Aa(e),n=+t-lr(t),a=+s-lr(s);return Math.round((n-a)/Dd)}function Ud(r){const e=Wi(r),t=Ge(r,0);return t.setFullYear(e,0,4),t.setHours(0,0,0,0),cr(t)}function Qs(r,e){const t=B(r),s=B(e),n=t.getTime()-s.getTime();return n<0?-1:n>0?1:n}function Bd(r){return Ge(r,Date.now())}function Wd(r){return r instanceof Date||typeof r=="object"&&Object.prototype.toString.call(r)==="[object Date]"}function qd(r){if(!Wd(r)&&typeof r!="number")return!1;const e=B(r);return!isNaN(Number(e))}function Vd(r,e){const t=B(r),s=B(e),n=t.getFullYear()-s.getFullYear(),a=t.getMonth()-s.getMonth();return n*12+a}function Hd(r){return e=>{const s=(r?Math[r]:Math.trunc)(e);return s===0?0:s}}function zd(r,e){return+B(r)-+B(e)}function Zd(r){const e=B(r);return e.setHours(23,59,59,999),e}function Jd(r){const e=B(r),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function Gd(r){const e=B(r);return+Zd(e)==+Jd(e)}function Yd(r,e){const t=B(r),s=B(e),n=Qs(t,s),a=Math.abs(Vd(t,s));let i;if(a<1)i=0;else{t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-n*a);let o=Qs(t,s)===-n;Gd(B(r))&&a===1&&Qs(r,s)===1&&(o=!1),i=n*(a-Number(o))}return i===0?0:i}function Kd(r,e,t){const s=zd(r,e)/1e3;return Hd(t?.roundingMethod)(s)}function Xd(r){const e=B(r),t=Ge(r,0);return t.setFullYear(e.getFullYear(),0,1),t.setHours(0,0,0,0),t}const Qd={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},eh=(r,e,t)=>{let s;const n=Qd[r];return typeof n=="string"?s=n:e===1?s=n.one:s=n.other.replace("{{count}}",e.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+s:s+" ago":s};function qr(r){return(e={})=>{const t=e.width?String(e.width):r.defaultWidth;return r.formats[t]||r.formats[r.defaultWidth]}}const th={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},sh={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},rh={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},nh={date:qr({formats:th,defaultWidth:"full"}),time:qr({formats:sh,defaultWidth:"full"}),dateTime:qr({formats:rh,defaultWidth:"full"})},ah={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},ih=(r,e,t,s)=>ah[r];function Gt(r){return(e,t)=>{const s=t?.context?String(t.context):"standalone";let n;if(s==="formatting"&&r.formattingValues){const i=r.defaultFormattingWidth||r.defaultWidth,o=t?.width?String(t.width):i;n=r.formattingValues[o]||r.formattingValues[i]}else{const i=r.defaultWidth,o=t?.width?String(t.width):r.defaultWidth;n=r.values[o]||r.values[i]}const a=r.argumentCallback?r.argumentCallback(e):e;return n[a]}}const oh={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},ch={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},lh={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},uh={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},dh={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},hh={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},fh=(r,e)=>{const t=Number(r),s=t%100;if(s>20||s<10)switch(s%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},mh={ordinalNumber:fh,era:Gt({values:oh,defaultWidth:"wide"}),quarter:Gt({values:ch,defaultWidth:"wide",argumentCallback:r=>r-1}),month:Gt({values:lh,defaultWidth:"wide"}),day:Gt({values:uh,defaultWidth:"wide"}),dayPeriod:Gt({values:dh,defaultWidth:"wide",formattingValues:hh,defaultFormattingWidth:"wide"})};function Yt(r){return(e,t={})=>{const s=t.width,n=s&&r.matchPatterns[s]||r.matchPatterns[r.defaultMatchWidth],a=e.match(n);if(!a)return null;const i=a[0],o=s&&r.parsePatterns[s]||r.parsePatterns[r.defaultParseWidth],l=Array.isArray(o)?gh(o,h=>h.test(i)):ph(o,h=>h.test(i));let u;u=r.valueCallback?r.valueCallback(l):l,u=t.valueCallback?t.valueCallback(u):u;const d=e.slice(i.length);return{value:u,rest:d}}}function ph(r,e){for(const t in r)if(Object.prototype.hasOwnProperty.call(r,t)&&e(r[t]))return t}function gh(r,e){for(let t=0;t<r.length;t++)if(e(r[t]))return t}function yh(r){return(e,t={})=>{const s=e.match(r.matchPattern);if(!s)return null;const n=s[0],a=e.match(r.parsePattern);if(!a)return null;let i=r.valueCallback?r.valueCallback(a[0]):a[0];i=t.valueCallback?t.valueCallback(i):i;const o=e.slice(n.length);return{value:i,rest:o}}}const _h=/^(\d+)(th|st|nd|rd)?/i,wh=/\d+/i,vh={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},bh={any:[/^b/i,/^(a|c)/i]},xh={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},kh={any:[/1/i,/2/i,/3/i,/4/i]},jh={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Sh={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Eh={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Ah={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Th={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Nh={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Ch={ordinalNumber:yh({matchPattern:_h,parsePattern:wh,valueCallback:r=>parseInt(r,10)}),era:Yt({matchPatterns:vh,defaultMatchWidth:"wide",parsePatterns:bh,defaultParseWidth:"any"}),quarter:Yt({matchPatterns:xh,defaultMatchWidth:"wide",parsePatterns:kh,defaultParseWidth:"any",valueCallback:r=>r+1}),month:Yt({matchPatterns:jh,defaultMatchWidth:"wide",parsePatterns:Sh,defaultParseWidth:"any"}),day:Yt({matchPatterns:Eh,defaultMatchWidth:"wide",parsePatterns:Ah,defaultParseWidth:"any"}),dayPeriod:Yt({matchPatterns:Th,defaultMatchWidth:"any",parsePatterns:Nh,defaultParseWidth:"any"})},qi={code:"en-US",formatDistance:eh,formatLong:nh,formatRelative:ih,localize:mh,match:Ch,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Ph(r){const e=B(r);return Fd(e,Xd(e))+1}function Oh(r){const e=B(r),t=+cr(e)-+Ud(e);return Math.round(t/Bi)+1}function Vi(r,e){const t=B(r),s=t.getFullYear(),n=Is(),a=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,i=Ge(r,0);i.setFullYear(s+1,0,a),i.setHours(0,0,0,0);const o=ms(i,e),l=Ge(r,0);l.setFullYear(s,0,a),l.setHours(0,0,0,0);const u=ms(l,e);return t.getTime()>=o.getTime()?s+1:t.getTime()>=u.getTime()?s:s-1}function Rh(r,e){const t=Is(),s=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,n=Vi(r,e),a=Ge(r,0);return a.setFullYear(n,0,s),a.setHours(0,0,0,0),ms(a,e)}function Ih(r,e){const t=B(r),s=+ms(t,e)-+Rh(t,e);return Math.round(s/Bi)+1}function D(r,e){const t=r<0?"-":"",s=Math.abs(r).toString().padStart(e,"0");return t+s}const qe={y(r,e){const t=r.getFullYear(),s=t>0?t:1-t;return D(e==="yy"?s%100:s,e.length)},M(r,e){const t=r.getMonth();return e==="M"?String(t+1):D(t+1,2)},d(r,e){return D(r.getDate(),e.length)},a(r,e){const t=r.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(r,e){return D(r.getHours()%12||12,e.length)},H(r,e){return D(r.getHours(),e.length)},m(r,e){return D(r.getMinutes(),e.length)},s(r,e){return D(r.getSeconds(),e.length)},S(r,e){const t=e.length,s=r.getMilliseconds(),n=Math.trunc(s*Math.pow(10,t-3));return D(n,e.length)}},bt={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Ta={G:function(r,e,t){const s=r.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(s,{width:"abbreviated"});case"GGGGG":return t.era(s,{width:"narrow"});case"GGGG":default:return t.era(s,{width:"wide"})}},y:function(r,e,t){if(e==="yo"){const s=r.getFullYear(),n=s>0?s:1-s;return t.ordinalNumber(n,{unit:"year"})}return qe.y(r,e)},Y:function(r,e,t,s){const n=Vi(r,s),a=n>0?n:1-n;if(e==="YY"){const i=a%100;return D(i,2)}return e==="Yo"?t.ordinalNumber(a,{unit:"year"}):D(a,e.length)},R:function(r,e){const t=Wi(r);return D(t,e.length)},u:function(r,e){const t=r.getFullYear();return D(t,e.length)},Q:function(r,e,t){const s=Math.ceil((r.getMonth()+1)/3);switch(e){case"Q":return String(s);case"QQ":return D(s,2);case"Qo":return t.ordinalNumber(s,{unit:"quarter"});case"QQQ":return t.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(s,{width:"wide",context:"formatting"})}},q:function(r,e,t){const s=Math.ceil((r.getMonth()+1)/3);switch(e){case"q":return String(s);case"qq":return D(s,2);case"qo":return t.ordinalNumber(s,{unit:"quarter"});case"qqq":return t.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(s,{width:"wide",context:"standalone"})}},M:function(r,e,t){const s=r.getMonth();switch(e){case"M":case"MM":return qe.M(r,e);case"Mo":return t.ordinalNumber(s+1,{unit:"month"});case"MMM":return t.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(s,{width:"wide",context:"formatting"})}},L:function(r,e,t){const s=r.getMonth();switch(e){case"L":return String(s+1);case"LL":return D(s+1,2);case"Lo":return t.ordinalNumber(s+1,{unit:"month"});case"LLL":return t.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(s,{width:"wide",context:"standalone"})}},w:function(r,e,t,s){const n=Ih(r,s);return e==="wo"?t.ordinalNumber(n,{unit:"week"}):D(n,e.length)},I:function(r,e,t){const s=Oh(r);return e==="Io"?t.ordinalNumber(s,{unit:"week"}):D(s,e.length)},d:function(r,e,t){return e==="do"?t.ordinalNumber(r.getDate(),{unit:"date"}):qe.d(r,e)},D:function(r,e,t){const s=Ph(r);return e==="Do"?t.ordinalNumber(s,{unit:"dayOfYear"}):D(s,e.length)},E:function(r,e,t){const s=r.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(s,{width:"short",context:"formatting"});case"EEEE":default:return t.day(s,{width:"wide",context:"formatting"})}},e:function(r,e,t,s){const n=r.getDay(),a=(n-s.weekStartsOn+8)%7||7;switch(e){case"e":return String(a);case"ee":return D(a,2);case"eo":return t.ordinalNumber(a,{unit:"day"});case"eee":return t.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(n,{width:"short",context:"formatting"});case"eeee":default:return t.day(n,{width:"wide",context:"formatting"})}},c:function(r,e,t,s){const n=r.getDay(),a=(n-s.weekStartsOn+8)%7||7;switch(e){case"c":return String(a);case"cc":return D(a,e.length);case"co":return t.ordinalNumber(a,{unit:"day"});case"ccc":return t.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(n,{width:"narrow",context:"standalone"});case"cccccc":return t.day(n,{width:"short",context:"standalone"});case"cccc":default:return t.day(n,{width:"wide",context:"standalone"})}},i:function(r,e,t){const s=r.getDay(),n=s===0?7:s;switch(e){case"i":return String(n);case"ii":return D(n,e.length);case"io":return t.ordinalNumber(n,{unit:"day"});case"iii":return t.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(s,{width:"short",context:"formatting"});case"iiii":default:return t.day(s,{width:"wide",context:"formatting"})}},a:function(r,e,t){const n=r.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(r,e,t){const s=r.getHours();let n;switch(s===12?n=bt.noon:s===0?n=bt.midnight:n=s/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(r,e,t){const s=r.getHours();let n;switch(s>=17?n=bt.evening:s>=12?n=bt.afternoon:s>=4?n=bt.morning:n=bt.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(r,e,t){if(e==="ho"){let s=r.getHours()%12;return s===0&&(s=12),t.ordinalNumber(s,{unit:"hour"})}return qe.h(r,e)},H:function(r,e,t){return e==="Ho"?t.ordinalNumber(r.getHours(),{unit:"hour"}):qe.H(r,e)},K:function(r,e,t){const s=r.getHours()%12;return e==="Ko"?t.ordinalNumber(s,{unit:"hour"}):D(s,e.length)},k:function(r,e,t){let s=r.getHours();return s===0&&(s=24),e==="ko"?t.ordinalNumber(s,{unit:"hour"}):D(s,e.length)},m:function(r,e,t){return e==="mo"?t.ordinalNumber(r.getMinutes(),{unit:"minute"}):qe.m(r,e)},s:function(r,e,t){return e==="so"?t.ordinalNumber(r.getSeconds(),{unit:"second"}):qe.s(r,e)},S:function(r,e){return qe.S(r,e)},X:function(r,e,t){const s=r.getTimezoneOffset();if(s===0)return"Z";switch(e){case"X":return Ca(s);case"XXXX":case"XX":return nt(s);case"XXXXX":case"XXX":default:return nt(s,":")}},x:function(r,e,t){const s=r.getTimezoneOffset();switch(e){case"x":return Ca(s);case"xxxx":case"xx":return nt(s);case"xxxxx":case"xxx":default:return nt(s,":")}},O:function(r,e,t){const s=r.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+Na(s,":");case"OOOO":default:return"GMT"+nt(s,":")}},z:function(r,e,t){const s=r.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+Na(s,":");case"zzzz":default:return"GMT"+nt(s,":")}},t:function(r,e,t){const s=Math.trunc(r.getTime()/1e3);return D(s,e.length)},T:function(r,e,t){const s=r.getTime();return D(s,e.length)}};function Na(r,e=""){const t=r>0?"-":"+",s=Math.abs(r),n=Math.trunc(s/60),a=s%60;return a===0?t+String(n):t+String(n)+e+D(a,2)}function Ca(r,e){return r%60===0?(r>0?"-":"+")+D(Math.abs(r)/60,2):nt(r,e)}function nt(r,e=""){const t=r>0?"-":"+",s=Math.abs(r),n=D(Math.trunc(s/60),2),a=D(s%60,2);return t+n+e+a}const Pa=(r,e)=>{switch(r){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},Hi=(r,e)=>{switch(r){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},$h=(r,e)=>{const t=r.match(/(P+)(p+)?/)||[],s=t[1],n=t[2];if(!n)return Pa(r,e);let a;switch(s){case"P":a=e.dateTime({width:"short"});break;case"PP":a=e.dateTime({width:"medium"});break;case"PPP":a=e.dateTime({width:"long"});break;case"PPPP":default:a=e.dateTime({width:"full"});break}return a.replace("{{date}}",Pa(s,e)).replace("{{time}}",Hi(n,e))},Lh={p:Hi,P:$h},Dh=/^D+$/,Mh=/^Y+$/,Fh=["D","DD","YY","YYYY"];function Uh(r){return Dh.test(r)}function Bh(r){return Mh.test(r)}function Wh(r,e,t){const s=qh(r,e,t);if(console.warn(s),Fh.includes(r))throw new RangeError(s)}function qh(r,e,t){const s=r[0]==="Y"?"years":"days of the month";return`Use \`${r.toLowerCase()}\` instead of \`${r}\` (in \`${e}\`) for formatting ${s} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Vh=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Hh=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,zh=/^'([^]*?)'?$/,Zh=/''/g,Jh=/[a-zA-Z]/;function Gh(r,e,t){const s=Is(),n=s.locale??qi,a=s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,i=s.weekStartsOn??s.locale?.options?.weekStartsOn??0,o=B(r);if(!qd(o))throw new RangeError("Invalid time value");let l=e.match(Hh).map(d=>{const h=d[0];if(h==="p"||h==="P"){const f=Lh[h];return f(d,n.formatLong)}return d}).join("").match(Vh).map(d=>{if(d==="''")return{isToken:!1,value:"'"};const h=d[0];if(h==="'")return{isToken:!1,value:Yh(d)};if(Ta[h])return{isToken:!0,value:d};if(h.match(Jh))throw new RangeError("Format string contains an unescaped latin alphabet character `"+h+"`");return{isToken:!1,value:d}});n.localize.preprocessor&&(l=n.localize.preprocessor(o,l));const u={firstWeekContainsDate:a,weekStartsOn:i,locale:n};return l.map(d=>{if(!d.isToken)return d.value;const h=d.value;(Bh(h)||Uh(h))&&Wh(h,e,String(r));const f=Ta[h[0]];return f(o,h,n.localize,u)}).join("")}function Yh(r){const e=r.match(zh);return e?e[1].replace(Zh,"'"):r}function Kh(r,e,t){const s=Is(),n=t?.locale??s.locale??qi,a=2520,i=Qs(r,e);if(isNaN(i))throw new RangeError("Invalid time value");const o=Object.assign({},t,{addSuffix:t?.addSuffix,comparison:i});let l,u;i>0?(l=B(e),u=B(r)):(l=B(r),u=B(e));const d=Kd(u,l),h=(lr(u)-lr(l))/1e3,f=Math.round((d-h)/60);let m;if(f<2)return t?.includeSeconds?d<5?n.formatDistance("lessThanXSeconds",5,o):d<10?n.formatDistance("lessThanXSeconds",10,o):d<20?n.formatDistance("lessThanXSeconds",20,o):d<40?n.formatDistance("halfAMinute",0,o):d<60?n.formatDistance("lessThanXMinutes",1,o):n.formatDistance("xMinutes",1,o):f===0?n.formatDistance("lessThanXMinutes",1,o):n.formatDistance("xMinutes",f,o);if(f<45)return n.formatDistance("xMinutes",f,o);if(f<90)return n.formatDistance("aboutXHours",1,o);if(f<Ea){const _=Math.round(f/60);return n.formatDistance("aboutXHours",_,o)}else{if(f<a)return n.formatDistance("xDays",1,o);if(f<Hs){const _=Math.round(f/Ea);return n.formatDistance("xDays",_,o)}else if(f<Hs*2)return m=Math.round(f/Hs),n.formatDistance("aboutXMonths",m,o)}if(m=Yd(u,l),m<12){const _=Math.round(f/Hs);return n.formatDistance("xMonths",_,o)}else{const _=m%12,y=Math.trunc(m/12);return _<3?n.formatDistance("aboutXYears",y,o):_<9?n.formatDistance("overXYears",y,o):n.formatDistance("almostXYears",y+1,o)}}function Xh(r,e){return Kh(r,Bd(r),e)}function zi(r){return Gh(new Date(r),"MMMM d, yyyy")}function Qh(r){return Xh(new Date(r),{addSuffix:!0})}function ef(r,e){return r.length<=e?r:`${r.slice(0,e)}...`}function tf({onSelect:r}){const{candidates:e,isLoading:t}=Fi(),[s,n]=p.useState(!1),a=p.useRef(null);return Ui(a,()=>n(!1)),t?c.jsx(We,{size:"sm"}):e.length?c.jsxs("div",{className:"relative",ref:a,children:[c.jsxs("button",{type:"button",onClick:()=>n(!s),className:"inline-flex items-center px-3 py-1.5 text-sm font-medium text-blue-600 hover:text-blue-700 bg-blue-50 hover:bg-blue-100 rounded-md transition-colors",children:[c.jsx("span",{children:"Previous CVs"}),c.jsx(Tn,{className:"ml-1 h-4 w-4"})]}),s&&c.jsx("div",{className:"absolute right-0 z-10 mt-2 w-96 rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5",children:c.jsx("div",{className:"max-h-60 overflow-auto py-1",children:e.map(i=>c.jsxs("button",{onClick:()=>{r({name:i.name,cvText:i.cv_text}),n(!1)},className:"w-full px-4 py-3 text-left hover:bg-gray-50 transition-colors border-b border-gray-100 last:border-0",children:[c.jsx("p",{className:"font-medium text-gray-900",children:i.name}),c.jsx("p",{className:"text-sm text-gray-500 mt-1 line-clamp-2",children:ef(i.cv_text,150)})]},i.id))})})]}):null}function sf({candidateName:r,cvText:e,onNameChange:t,onCvTextChange:s,errors:n={}}){return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("h2",{className:"text-lg font-semibold",children:"Candidate Information"}),c.jsx("div",{className:"h-6 w-6 rounded-full bg-blue-100 flex items-center justify-center",children:c.jsx("span",{className:"text-blue-600 text-sm",children:"1"})})]}),c.jsx(tf,{onSelect:({name:a,cvText:i})=>{t(a),s(i)}})]}),c.jsx(ct,{id:"candidateName",label:"Candidate Name",value:r,onChange:a=>t(a.target.value),error:n.name,placeholder:"Enter candidate's full name",required:!0}),c.jsx(Mi,{id:"cvText",label:"CV Text",value:e,onChange:a=>s(a.target.value),error:n.cvText,placeholder:"Paste the candidate's CV content here...",required:!0})]})}async function rf(r){const{data:e,error:t}=await H.from("jobs").insert([r]).select().single();if(t)throw new Ue("Failed to upload job",500,t.code);return e}async function nf(){const{data:r,error:e}=await H.from("jobs").select("*").order("created_at",{ascending:!1});if(e)throw new Ue("Failed to fetch jobs",500);return r||[]}function Zi(){const{data:r,isLoading:e,error:t,refetch:s}=Rs(nf);return{jobs:r||[],isLoading:e,error:t,refetch:s}}function af({onSelect:r}){const{jobs:e,isLoading:t}=Zi(),[s,n]=p.useState(!1),a=p.useRef(null);return Ui(a,()=>n(!1)),t?c.jsx(We,{size:"sm"}):e.length?c.jsxs("div",{className:"relative",ref:a,children:[c.jsxs("button",{type:"button",onClick:()=>n(!s),"data-action":"select-job",className:"inline-flex items-center px-3 py-1.5 text-sm font-medium text-blue-600 hover:text-blue-700 bg-blue-50 hover:bg-blue-100 rounded-md transition-colors",children:[c.jsx("span",{children:"Previous Jobs"}),c.jsx(Tn,{className:"ml-1 h-4 w-4"})]}),s&&c.jsx("div",{className:"absolute right-0 z-10 mt-2 w-96 rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5",children:c.jsx("div",{className:"max-h-60 overflow-auto py-1",children:e.map(i=>c.jsxs("button",{onClick:()=>{r({title:i.title,description:i.description}),n(!1)},className:"w-full px-4 py-3 text-left hover:bg-gray-50 transition-colors border-b border-gray-100 last:border-0",children:[c.jsx("p",{className:"font-medium text-gray-900",children:i.title}),c.jsx("p",{className:"text-sm text-gray-500 mt-1 line-clamp-2",children:i.description})]},i.id))})})]}):null}function of({jobTitle:r,jobDescription:e,onTitleChange:t,onDescriptionChange:s,errors:n={}}){return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("h2",{className:"text-lg font-semibold",children:"Job Information"}),c.jsx("div",{className:"h-6 w-6 rounded-full bg-blue-100 flex items-center justify-center",children:c.jsx("span",{className:"text-blue-600 text-sm",children:"2"})})]}),c.jsx(af,{onSelect:({title:a,description:i})=>{t(a),s(i)}})]}),c.jsx(ct,{id:"jobTitle",label:"Job Title",value:r,onChange:a=>t(a.target.value),error:n.title,placeholder:"Enter the job position title",required:!0}),c.jsx(Mi,{id:"jobDescription",label:"Job Description",value:e,onChange:a=>s(a.target.value),error:n.description,placeholder:"Paste the job description here...",required:!0})]})}function cf({score:r,verdict:e}){const t=()=>{switch(e){case"GOOD_FIT":return"text-green-600 bg-green-50 border-green-200";case"NEEDS_CONSIDERATION":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"BAD_FIT":return"text-red-600 bg-red-50 border-red-200"}},s=()=>{switch(e){case"GOOD_FIT":return"Strong Match";case"NEEDS_CONSIDERATION":return"Potential Match";case"BAD_FIT":return"Not Suitable"}};return c.jsxs("div",{className:`p-6 rounded-lg border ${t()}`,children:[c.jsx("h3",{className:"font-semibold mb-4",children:"Match Score"}),c.jsxs("div",{className:"flex items-baseline space-x-2",children:[c.jsx("span",{className:"text-5xl font-bold",children:r}),c.jsx("span",{className:"text-2xl",children:"/10"})]}),c.jsx("p",{className:"mt-2 text-sm font-medium",children:s()})]})}function lf({analysis:r}){const e=r.technical_skills||[];return e.length?c.jsx("div",{className:"space-y-6",children:e.map((t,s)=>c.jsxs("div",{className:"border rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("h4",{className:"font-medium text-gray-900",children:t.name}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("div",{className:"h-2 w-24 bg-gray-200 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-blue-600 rounded-full",style:{width:`${t.proficiency}%`}})}),c.jsxs("span",{className:"text-sm text-gray-600",children:[t.proficiency,"%"]})]})]}),c.jsx("p",{className:"text-sm text-gray-600",children:t.assessment}),t.recommendations&&c.jsxs("div",{className:"mt-2 text-sm text-blue-600",children:["Recommendation: ",t.recommendations]})]},s))}):c.jsx("p",{className:"text-sm text-gray-500 italic",children:"Technical skills analysis not available"})}function uf({factors:r=[]}){return r?.length?c.jsx("div",{className:"space-y-3",children:r.map((e,t)=>c.jsxs("div",{className:"flex items-start space-x-3",children:[c.jsx(Kc,{className:"h-5 w-5 text-amber-500 flex-shrink-0 mt-0.5"}),c.jsx("p",{className:"text-sm text-gray-700",children:e})]},t))}):c.jsx("p",{className:"text-sm text-gray-500 italic",children:"No significant risk factors identified"})}function df({potential:r}){return r?c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Growth Areas"}),c.jsx("div",{className:"space-y-2",children:r.areas.map((e,t)=>c.jsxs("div",{className:"flex items-start space-x-3",children:[c.jsx(Ic,{className:"h-5 w-5 text-green-500 flex-shrink-0 mt-0.5"}),c.jsx("p",{className:"text-sm text-gray-700",children:e})]},t))})]}),r.recommendations.length>0&&c.jsxs("div",{children:[c.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Development Recommendations"}),c.jsx("ul",{className:"list-disc pl-5 space-y-1",children:r.recommendations.map((e,t)=>c.jsx("li",{className:"text-sm text-gray-600",children:e},t))})]})]}):c.jsx("p",{className:"text-sm text-gray-500 italic",children:"Growth potential analysis not available"})}function hf({plan:r}){const[e,t]=p.useState(null),n=(a=>a.split(/(?=\w+\s*\(\d+\s*minutes?\):)/i).filter(Boolean).map(o=>{const l=o.match(/^(.*?)(?:\((\d+)\s*minutes?\):)(.*)/is);if(!l)return null;const[,u,d,h]=l,f=h.split(`
`).filter(Boolean).map(b=>b.trim()),m=f.filter(b=>b.startsWith("-")).map(b=>b.slice(1).trim()),_=f.filter(b=>b.toLowerCase().includes("red flag")).map(b=>b.replace(/^[^:]*:\s*/,""))||[],y=f.filter(b=>b.toLowerCase().includes("green flag")).map(b=>b.replace(/^[^:]*:\s*/,""))||[];return{title:u.trim(),duration:`${d} minutes`,questions:m,redFlags:_,greenFlags:y}}).filter(o=>o!==null))(r);return c.jsx("div",{className:"divide-y divide-gray-200",children:n.map((a,i)=>c.jsxs("div",{className:"py-4 first:pt-0 last:pb-0",children:[c.jsxs("button",{onClick:()=>t(e===a.title?null:a.title),className:"w-full flex items-center justify-between text-left",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"text-lg font-medium text-gray-900",children:a.title}),c.jsx("p",{className:"text-sm text-gray-500",children:a.duration})]}),e===a.title?c.jsx(Zc,{className:"h-5 w-5 text-gray-400"}):c.jsx(Tn,{className:"h-5 w-5 text-gray-400"})]}),e===a.title&&c.jsxs("div",{className:"mt-4 space-y-4",children:[c.jsxs("div",{children:[c.jsx("h5",{className:"font-medium text-gray-700 mb-2",children:"Questions:"}),c.jsx("ul",{className:"space-y-2",children:a.questions.map((o,l)=>c.jsxs("li",{className:"flex items-start space-x-2",children:[c.jsx("span",{className:"text-blue-600 mt-1",children:"â¢"}),c.jsx("span",{className:"text-gray-600",children:o})]},l))})]}),a.redFlags.length>0&&c.jsxs("div",{children:[c.jsx("h5",{className:"font-medium text-red-600 mb-2",children:"Watch out for:"}),c.jsx("ul",{className:"space-y-2",children:a.redFlags.map((o,l)=>c.jsxs("li",{className:"flex items-start space-x-2",children:[c.jsx("span",{className:"text-red-600 mt-1",children:"â "}),c.jsx("span",{className:"text-red-600",children:o})]},l))})]}),a.greenFlags.length>0&&c.jsxs("div",{children:[c.jsx("h5",{className:"font-medium text-green-600 mb-2",children:"Positive Indicators:"}),c.jsx("ul",{className:"space-y-2",children:a.greenFlags.map((o,l)=>c.jsxs("li",{className:"flex items-start space-x-2",children:[c.jsx("span",{className:"text-green-600 mt-1",children:"â"}),c.jsx("span",{className:"text-green-600",children:o})]},l))})]})]})]},i))})}function Ji({analysis:r}){return c.jsxs("div",{className:"space-y-8",children:[c.jsx(cf,{score:r.fit_score,verdict:r.verdict}),c.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Technical Analysis"}),c.jsx(lf,{analysis:r})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsx(uf,{factors:r.risk_factors}),c.jsx(df,{potential:r.growth_potential})]}),c.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Interview Plan"}),c.jsx(hf,{plan:r.interview_plan})]})]})}var I;(function(r){r.assertEqual=n=>n;function e(n){}r.assertIs=e;function t(n){throw new Error}r.assertNever=t,r.arrayToEnum=n=>{const a={};for(const i of n)a[i]=i;return a},r.getValidEnumValues=n=>{const a=r.objectKeys(n).filter(o=>typeof n[n[o]]!="number"),i={};for(const o of a)i[o]=n[o];return r.objectValues(i)},r.objectValues=n=>r.objectKeys(n).map(function(a){return n[a]}),r.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{const a=[];for(const i in n)Object.prototype.hasOwnProperty.call(n,i)&&a.push(i);return a},r.find=(n,a)=>{for(const i of n)if(a(i))return i},r.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function s(n,a=" | "){return n.map(i=>typeof i=="string"?`'${i}'`:i).join(a)}r.joinValues=s,r.jsonStringifyReplacer=(n,a)=>typeof a=="bigint"?a.toString():a})(I||(I={}));var un;(function(r){r.mergeShapes=(e,t)=>({...e,...t})})(un||(un={}));const v=I.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Fe=r=>{switch(typeof r){case"undefined":return v.undefined;case"string":return v.string;case"number":return isNaN(r)?v.nan:v.number;case"boolean":return v.boolean;case"function":return v.function;case"bigint":return v.bigint;case"symbol":return v.symbol;case"object":return Array.isArray(r)?v.array:r===null?v.null:r.then&&typeof r.then=="function"&&r.catch&&typeof r.catch=="function"?v.promise:typeof Map<"u"&&r instanceof Map?v.map:typeof Set<"u"&&r instanceof Set?v.set:typeof Date<"u"&&r instanceof Date?v.date:v.object;default:return v.unknown}},g=I.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),ff=r=>JSON.stringify(r,null,2).replace(/"([^"]+)":/g,"$1:");class ge extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(a){return a.message},s={_errors:[]},n=a=>{for(const i of a.issues)if(i.code==="invalid_union")i.unionErrors.map(n);else if(i.code==="invalid_return_type")n(i.returnTypeError);else if(i.code==="invalid_arguments")n(i.argumentsError);else if(i.path.length===0)s._errors.push(t(i));else{let o=s,l=0;for(;l<i.path.length;){const u=i.path[l];l===i.path.length-1?(o[u]=o[u]||{_errors:[]},o[u]._errors.push(t(i))):o[u]=o[u]||{_errors:[]},o=o[u],l++}}};return n(this),s}static assert(e){if(!(e instanceof ge))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,I.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},s=[];for(const n of this.issues)n.path.length>0?(t[n.path[0]]=t[n.path[0]]||[],t[n.path[0]].push(e(n))):s.push(e(n));return{formErrors:s,fieldErrors:t}}get formErrors(){return this.flatten()}}ge.create=r=>new ge(r);const Dt=(r,e)=>{let t;switch(r.code){case g.invalid_type:r.received===v.undefined?t="Required":t=`Expected ${r.expected}, received ${r.received}`;break;case g.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(r.expected,I.jsonStringifyReplacer)}`;break;case g.unrecognized_keys:t=`Unrecognized key(s) in object: ${I.joinValues(r.keys,", ")}`;break;case g.invalid_union:t="Invalid input";break;case g.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${I.joinValues(r.options)}`;break;case g.invalid_enum_value:t=`Invalid enum value. Expected ${I.joinValues(r.options)}, received '${r.received}'`;break;case g.invalid_arguments:t="Invalid function arguments";break;case g.invalid_return_type:t="Invalid function return type";break;case g.invalid_date:t="Invalid date";break;case g.invalid_string:typeof r.validation=="object"?"includes"in r.validation?(t=`Invalid input: must include "${r.validation.includes}"`,typeof r.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${r.validation.position}`)):"startsWith"in r.validation?t=`Invalid input: must start with "${r.validation.startsWith}"`:"endsWith"in r.validation?t=`Invalid input: must end with "${r.validation.endsWith}"`:I.assertNever(r.validation):r.validation!=="regex"?t=`Invalid ${r.validation}`:t="Invalid";break;case g.too_small:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at least":"more than"} ${r.minimum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at least":"over"} ${r.minimum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(r.minimum))}`:t="Invalid input";break;case g.too_big:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at most":"less than"} ${r.maximum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at most":"under"} ${r.maximum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="bigint"?t=`BigInt must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly":r.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(r.maximum))}`:t="Invalid input";break;case g.custom:t="Invalid input";break;case g.invalid_intersection_types:t="Intersection results could not be merged";break;case g.not_multiple_of:t=`Number must be a multiple of ${r.multipleOf}`;break;case g.not_finite:t="Number must be finite";break;default:t=e.defaultError,I.assertNever(r)}return{message:t}};let Gi=Dt;function mf(r){Gi=r}function ur(){return Gi}const dr=r=>{const{data:e,path:t,errorMaps:s,issueData:n}=r,a=[...t,...n.path||[]],i={...n,path:a};if(n.message!==void 0)return{...n,path:a,message:n.message};let o="";const l=s.filter(u=>!!u).slice().reverse();for(const u of l)o=u(i,{data:e,defaultError:o}).message;return{...n,path:a,message:o}},pf=[];function w(r,e){const t=ur(),s=dr({issueData:e,data:r.data,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,t,t===Dt?void 0:Dt].filter(n=>!!n)});r.common.issues.push(s)}class oe{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const s=[];for(const n of t){if(n.status==="aborted")return E;n.status==="dirty"&&e.dirty(),s.push(n.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,t){const s=[];for(const n of t){const a=await n.key,i=await n.value;s.push({key:a,value:i})}return oe.mergeObjectSync(e,s)}static mergeObjectSync(e,t){const s={};for(const n of t){const{key:a,value:i}=n;if(a.status==="aborted"||i.status==="aborted")return E;a.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof i.value<"u"||n.alwaysSet)&&(s[a.value]=i.value)}return{status:e.value,value:s}}}const E=Object.freeze({status:"aborted"}),At=r=>({status:"dirty",value:r}),ce=r=>({status:"valid",value:r}),dn=r=>r.status==="aborted",hn=r=>r.status==="dirty",dt=r=>r.status==="valid",ps=r=>typeof Promise<"u"&&r instanceof Promise;function hr(r,e,t,s){if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(r)}function Yi(r,e,t,s,n){if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(r,t),t}var x;(function(r){r.errToObj=e=>typeof e=="string"?{message:e}:e||{},r.toString=e=>typeof e=="string"?e:e?.message})(x||(x={}));var es,ts;class Re{constructor(e,t,s,n){this._cachedPath=[],this.parent=e,this.data=t,this._path=s,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Oa=(r,e)=>{if(dt(e))return{success:!0,data:e.value};if(!r.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new ge(r.common.issues);return this._error=t,this._error}}};function A(r){if(!r)return{};const{errorMap:e,invalid_type_error:t,required_error:s,description:n}=r;if(e&&(t||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:(i,o)=>{var l,u;const{message:d}=r;return i.code==="invalid_enum_value"?{message:d??o.defaultError}:typeof o.data>"u"?{message:(l=d??s)!==null&&l!==void 0?l:o.defaultError}:i.code!=="invalid_type"?{message:o.defaultError}:{message:(u=d??t)!==null&&u!==void 0?u:o.defaultError}},description:n}}class N{get description(){return this._def.description}_getType(e){return Fe(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Fe(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new oe,ctx:{common:e.parent.common,data:e.data,parsedType:Fe(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(ps(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const s=this.safeParse(e,t);if(s.success)return s.data;throw s.error}safeParse(e,t){var s;const n={common:{issues:[],async:(s=t?.async)!==null&&s!==void 0?s:!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Fe(e)},a=this._parseSync({data:e,path:n.path,parent:n});return Oa(n,a)}"~validate"(e){var t,s;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Fe(e)};if(!this["~standard"].async)try{const a=this._parseSync({data:e,path:[],parent:n});return dt(a)?{value:a.value}:{issues:n.common.issues}}catch(a){!((s=(t=a?.message)===null||t===void 0?void 0:t.toLowerCase())===null||s===void 0)&&s.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(a=>dt(a)?{value:a.value}:{issues:n.common.issues})}async parseAsync(e,t){const s=await this.safeParseAsync(e,t);if(s.success)return s.data;throw s.error}async safeParseAsync(e,t){const s={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Fe(e)},n=this._parse({data:e,path:s.path,parent:s}),a=await(ps(n)?n:Promise.resolve(n));return Oa(s,a)}refine(e,t){const s=n=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(n):t;return this._refinement((n,a)=>{const i=e(n),o=()=>a.addIssue({code:g.custom,...s(n)});return typeof Promise<"u"&&i instanceof Promise?i.then(l=>l?!0:(o(),!1)):i?!0:(o(),!1)})}refinement(e,t){return this._refinement((s,n)=>e(s)?!0:(n.addIssue(typeof t=="function"?t(s,n):t),!1))}_refinement(e){return new Ee({schema:this,typeName:S.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return Oe.create(this,this._def)}nullable(){return Qe.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Se.create(this)}promise(){return Ft.create(this,this._def)}or(e){return ws.create([this,e],this._def)}and(e){return vs.create(this,e,this._def)}transform(e){return new Ee({...A(this._def),schema:this,typeName:S.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new Ss({...A(this._def),innerType:this,defaultValue:t,typeName:S.ZodDefault})}brand(){return new $n({typeName:S.ZodBranded,type:this,...A(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new Es({...A(this._def),innerType:this,catchValue:t,typeName:S.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return $s.create(this,e)}readonly(){return As.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const gf=/^c[^\s-]{8,}$/i,yf=/^[0-9a-z]+$/,_f=/^[0-9A-HJKMNP-TV-Z]{26}$/i,wf=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,vf=/^[a-z0-9_-]{21}$/i,bf=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,xf=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,kf=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,jf="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Vr;const Sf=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Ef=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Af=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Tf=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Nf=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Cf=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Ki="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Pf=new RegExp(`^${Ki}$`);function Xi(r){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return r.precision?e=`${e}\\.\\d{${r.precision}}`:r.precision==null&&(e=`${e}(\\.\\d+)?`),e}function Of(r){return new RegExp(`^${Xi(r)}$`)}function Qi(r){let e=`${Ki}T${Xi(r)}`;const t=[];return t.push(r.local?"Z?":"Z"),r.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function Rf(r,e){return!!((e==="v4"||!e)&&Sf.test(r)||(e==="v6"||!e)&&Af.test(r))}function If(r,e){if(!bf.test(r))return!1;try{const[t]=r.split("."),s=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),n=JSON.parse(atob(s));return!(typeof n!="object"||n===null||!n.typ||!n.alg||e&&n.alg!==e)}catch{return!1}}function $f(r,e){return!!((e==="v4"||!e)&&Ef.test(r)||(e==="v6"||!e)&&Tf.test(r))}class xe extends N{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==v.string){const a=this._getOrReturnCtx(e);return w(a,{code:g.invalid_type,expected:v.string,received:a.parsedType}),E}const s=new oe;let n;for(const a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(n=this._getOrReturnCtx(e,n),w(n,{code:g.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),s.dirty());else if(a.kind==="max")e.data.length>a.value&&(n=this._getOrReturnCtx(e,n),w(n,{code:g.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),s.dirty());else if(a.kind==="length"){const i=e.data.length>a.value,o=e.data.length<a.value;(i||o)&&(n=this._getOrReturnCtx(e,n),i?w(n,{code:g.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):o&&w(n,{code:g.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),s.dirty())}else if(a.kind==="email")kf.test(e.data)||(n=this._getOrReturnCtx(e,n),w(n,{validation:"email",code:g.invalid_string,message:a.message}),s.dirty());else if(a.kind==="emoji")Vr||(Vr=new RegExp(jf,"u")),Vr.test(e.data)||(n=this._getOrReturnCtx(e,n),w(n,{validation:"emoji",code:g.invalid_string,message:a.message}),s.dirty());else if(a.kind==="uuid")wf.test(e.data)||(n=this._getOrReturnCtx(e,n),w(n,{validation:"uuid",code:g.invalid_string,message:a.message}),s.dirty());else if(a.kind==="nanoid")vf.test(e.data)||(n=this._getOrReturnCtx(e,n),w(n,{validation:"nanoid",code:g.invalid_string,message:a.message}),s.dirty());else if(a.kind==="cuid")gf.test(e.data)||(n=this._getOrReturnCtx(e,n),w(n,{validation:"cuid",code:g.invalid_string,message:a.message}),s.dirty());else if(a.kind==="cuid2")yf.test(e.data)||(n=this._getOrReturnCtx(e,n),w(n,{validation:"cuid2",code:g.invalid_string,message:a.message}),s.dirty());else if(a.kind==="ulid")_f.test(e.data)||(n=this._getOrReturnCtx(e,n),w(n,{validation:"ulid",code:g.invalid_string,message:a.message}),s.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{n=this._getOrReturnCtx(e,n),w(n,{validation:"url",code:g.invalid_string,message:a.message}),s.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),w(n,{validation:"regex",code:g.invalid_string,message:a.message}),s.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(n=this._getOrReturnCtx(e,n),w(n,{code:g.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),s.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(n=this._getOrReturnCtx(e,n),w(n,{code:g.invalid_string,validation:{startsWith:a.value},message:a.message}),s.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(n=this._getOrReturnCtx(e,n),w(n,{code:g.invalid_string,validation:{endsWith:a.value},message:a.message}),s.dirty()):a.kind==="datetime"?Qi(a).test(e.data)||(n=this._getOrReturnCtx(e,n),w(n,{code:g.invalid_string,validation:"datetime",message:a.message}),s.dirty()):a.kind==="date"?Pf.test(e.data)||(n=this._getOrReturnCtx(e,n),w(n,{code:g.invalid_string,validation:"date",message:a.message}),s.dirty()):a.kind==="time"?Of(a).test(e.data)||(n=this._getOrReturnCtx(e,n),w(n,{code:g.invalid_string,validation:"time",message:a.message}),s.dirty()):a.kind==="duration"?xf.test(e.data)||(n=this._getOrReturnCtx(e,n),w(n,{validation:"duration",code:g.invalid_string,message:a.message}),s.dirty()):a.kind==="ip"?Rf(e.data,a.version)||(n=this._getOrReturnCtx(e,n),w(n,{validation:"ip",code:g.invalid_string,message:a.message}),s.dirty()):a.kind==="jwt"?If(e.data,a.alg)||(n=this._getOrReturnCtx(e,n),w(n,{validation:"jwt",code:g.invalid_string,message:a.message}),s.dirty()):a.kind==="cidr"?$f(e.data,a.version)||(n=this._getOrReturnCtx(e,n),w(n,{validation:"cidr",code:g.invalid_string,message:a.message}),s.dirty()):a.kind==="base64"?Nf.test(e.data)||(n=this._getOrReturnCtx(e,n),w(n,{validation:"base64",code:g.invalid_string,message:a.message}),s.dirty()):a.kind==="base64url"?Cf.test(e.data)||(n=this._getOrReturnCtx(e,n),w(n,{validation:"base64url",code:g.invalid_string,message:a.message}),s.dirty()):I.assertNever(a);return{status:s.value,value:e.data}}_regex(e,t,s){return this.refinement(n=>e.test(n),{validation:t,code:g.invalid_string,...x.errToObj(s)})}_addCheck(e){return new xe({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...x.errToObj(e)})}url(e){return this._addCheck({kind:"url",...x.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...x.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...x.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...x.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...x.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...x.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...x.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...x.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...x.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...x.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...x.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...x.errToObj(e)})}datetime(e){var t,s;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(t=e?.offset)!==null&&t!==void 0?t:!1,local:(s=e?.local)!==null&&s!==void 0?s:!1,...x.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...x.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...x.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...x.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...x.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...x.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...x.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...x.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...x.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...x.errToObj(t)})}nonempty(e){return this.min(1,x.errToObj(e))}trim(){return new xe({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new xe({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new xe({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}xe.create=r=>{var e;return new xe({checks:[],typeName:S.ZodString,coerce:(e=r?.coerce)!==null&&e!==void 0?e:!1,...A(r)})};function Lf(r,e){const t=(r.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,n=t>s?t:s,a=parseInt(r.toFixed(n).replace(".","")),i=parseInt(e.toFixed(n).replace(".",""));return a%i/Math.pow(10,n)}class Ye extends N{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==v.number){const a=this._getOrReturnCtx(e);return w(a,{code:g.invalid_type,expected:v.number,received:a.parsedType}),E}let s;const n=new oe;for(const a of this._def.checks)a.kind==="int"?I.isInteger(e.data)||(s=this._getOrReturnCtx(e,s),w(s,{code:g.invalid_type,expected:"integer",received:"float",message:a.message}),n.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(s=this._getOrReturnCtx(e,s),w(s,{code:g.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),n.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(s=this._getOrReturnCtx(e,s),w(s,{code:g.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),n.dirty()):a.kind==="multipleOf"?Lf(e.data,a.value)!==0&&(s=this._getOrReturnCtx(e,s),w(s,{code:g.not_multiple_of,multipleOf:a.value,message:a.message}),n.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(s=this._getOrReturnCtx(e,s),w(s,{code:g.not_finite,message:a.message}),n.dirty()):I.assertNever(a);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,x.toString(t))}gt(e,t){return this.setLimit("min",e,!1,x.toString(t))}lte(e,t){return this.setLimit("max",e,!0,x.toString(t))}lt(e,t){return this.setLimit("max",e,!1,x.toString(t))}setLimit(e,t,s,n){return new Ye({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:s,message:x.toString(n)}]})}_addCheck(e){return new Ye({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:x.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:x.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:x.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:x.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:x.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:x.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:x.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:x.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:x.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&I.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(t===null||s.value>t)&&(t=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(t)&&Number.isFinite(e)}}Ye.create=r=>new Ye({checks:[],typeName:S.ZodNumber,coerce:r?.coerce||!1,...A(r)});class Ke extends N{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==v.bigint)return this._getInvalidInput(e);let s;const n=new oe;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(s=this._getOrReturnCtx(e,s),w(s,{code:g.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),n.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(s=this._getOrReturnCtx(e,s),w(s,{code:g.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),n.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(s=this._getOrReturnCtx(e,s),w(s,{code:g.not_multiple_of,multipleOf:a.value,message:a.message}),n.dirty()):I.assertNever(a);return{status:n.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return w(t,{code:g.invalid_type,expected:v.bigint,received:t.parsedType}),E}gte(e,t){return this.setLimit("min",e,!0,x.toString(t))}gt(e,t){return this.setLimit("min",e,!1,x.toString(t))}lte(e,t){return this.setLimit("max",e,!0,x.toString(t))}lt(e,t){return this.setLimit("max",e,!1,x.toString(t))}setLimit(e,t,s,n){return new Ke({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:s,message:x.toString(n)}]})}_addCheck(e){return new Ke({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:x.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:x.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:x.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:x.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:x.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Ke.create=r=>{var e;return new Ke({checks:[],typeName:S.ZodBigInt,coerce:(e=r?.coerce)!==null&&e!==void 0?e:!1,...A(r)})};class gs extends N{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==v.boolean){const s=this._getOrReturnCtx(e);return w(s,{code:g.invalid_type,expected:v.boolean,received:s.parsedType}),E}return ce(e.data)}}gs.create=r=>new gs({typeName:S.ZodBoolean,coerce:r?.coerce||!1,...A(r)});class ht extends N{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==v.date){const a=this._getOrReturnCtx(e);return w(a,{code:g.invalid_type,expected:v.date,received:a.parsedType}),E}if(isNaN(e.data.getTime())){const a=this._getOrReturnCtx(e);return w(a,{code:g.invalid_date}),E}const s=new oe;let n;for(const a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(n=this._getOrReturnCtx(e,n),w(n,{code:g.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),s.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(n=this._getOrReturnCtx(e,n),w(n,{code:g.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),s.dirty()):I.assertNever(a);return{status:s.value,value:new Date(e.data.getTime())}}_addCheck(e){return new ht({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:x.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:x.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}ht.create=r=>new ht({checks:[],coerce:r?.coerce||!1,typeName:S.ZodDate,...A(r)});class fr extends N{_parse(e){if(this._getType(e)!==v.symbol){const s=this._getOrReturnCtx(e);return w(s,{code:g.invalid_type,expected:v.symbol,received:s.parsedType}),E}return ce(e.data)}}fr.create=r=>new fr({typeName:S.ZodSymbol,...A(r)});class ys extends N{_parse(e){if(this._getType(e)!==v.undefined){const s=this._getOrReturnCtx(e);return w(s,{code:g.invalid_type,expected:v.undefined,received:s.parsedType}),E}return ce(e.data)}}ys.create=r=>new ys({typeName:S.ZodUndefined,...A(r)});class _s extends N{_parse(e){if(this._getType(e)!==v.null){const s=this._getOrReturnCtx(e);return w(s,{code:g.invalid_type,expected:v.null,received:s.parsedType}),E}return ce(e.data)}}_s.create=r=>new _s({typeName:S.ZodNull,...A(r)});class Mt extends N{constructor(){super(...arguments),this._any=!0}_parse(e){return ce(e.data)}}Mt.create=r=>new Mt({typeName:S.ZodAny,...A(r)});class lt extends N{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ce(e.data)}}lt.create=r=>new lt({typeName:S.ZodUnknown,...A(r)});class Be extends N{_parse(e){const t=this._getOrReturnCtx(e);return w(t,{code:g.invalid_type,expected:v.never,received:t.parsedType}),E}}Be.create=r=>new Be({typeName:S.ZodNever,...A(r)});class mr extends N{_parse(e){if(this._getType(e)!==v.undefined){const s=this._getOrReturnCtx(e);return w(s,{code:g.invalid_type,expected:v.void,received:s.parsedType}),E}return ce(e.data)}}mr.create=r=>new mr({typeName:S.ZodVoid,...A(r)});class Se extends N{_parse(e){const{ctx:t,status:s}=this._processInputParams(e),n=this._def;if(t.parsedType!==v.array)return w(t,{code:g.invalid_type,expected:v.array,received:t.parsedType}),E;if(n.exactLength!==null){const i=t.data.length>n.exactLength.value,o=t.data.length<n.exactLength.value;(i||o)&&(w(t,{code:i?g.too_big:g.too_small,minimum:o?n.exactLength.value:void 0,maximum:i?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),s.dirty())}if(n.minLength!==null&&t.data.length<n.minLength.value&&(w(t,{code:g.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),s.dirty()),n.maxLength!==null&&t.data.length>n.maxLength.value&&(w(t,{code:g.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),s.dirty()),t.common.async)return Promise.all([...t.data].map((i,o)=>n.type._parseAsync(new Re(t,i,t.path,o)))).then(i=>oe.mergeArray(s,i));const a=[...t.data].map((i,o)=>n.type._parseSync(new Re(t,i,t.path,o)));return oe.mergeArray(s,a)}get element(){return this._def.type}min(e,t){return new Se({...this._def,minLength:{value:e,message:x.toString(t)}})}max(e,t){return new Se({...this._def,maxLength:{value:e,message:x.toString(t)}})}length(e,t){return new Se({...this._def,exactLength:{value:e,message:x.toString(t)}})}nonempty(e){return this.min(1,e)}}Se.create=(r,e)=>new Se({type:r,minLength:null,maxLength:null,exactLength:null,typeName:S.ZodArray,...A(e)});function jt(r){if(r instanceof V){const e={};for(const t in r.shape){const s=r.shape[t];e[t]=Oe.create(jt(s))}return new V({...r._def,shape:()=>e})}else return r instanceof Se?new Se({...r._def,type:jt(r.element)}):r instanceof Oe?Oe.create(jt(r.unwrap())):r instanceof Qe?Qe.create(jt(r.unwrap())):r instanceof Ie?Ie.create(r.items.map(e=>jt(e))):r}class V extends N{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=I.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==v.object){const u=this._getOrReturnCtx(e);return w(u,{code:g.invalid_type,expected:v.object,received:u.parsedType}),E}const{status:s,ctx:n}=this._processInputParams(e),{shape:a,keys:i}=this._getCached(),o=[];if(!(this._def.catchall instanceof Be&&this._def.unknownKeys==="strip"))for(const u in n.data)i.includes(u)||o.push(u);const l=[];for(const u of i){const d=a[u],h=n.data[u];l.push({key:{status:"valid",value:u},value:d._parse(new Re(n,h,n.path,u)),alwaysSet:u in n.data})}if(this._def.catchall instanceof Be){const u=this._def.unknownKeys;if(u==="passthrough")for(const d of o)l.push({key:{status:"valid",value:d},value:{status:"valid",value:n.data[d]}});else if(u==="strict")o.length>0&&(w(n,{code:g.unrecognized_keys,keys:o}),s.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const d of o){const h=n.data[d];l.push({key:{status:"valid",value:d},value:u._parse(new Re(n,h,n.path,d)),alwaysSet:d in n.data})}}return n.common.async?Promise.resolve().then(async()=>{const u=[];for(const d of l){const h=await d.key,f=await d.value;u.push({key:h,value:f,alwaysSet:d.alwaysSet})}return u}).then(u=>oe.mergeObjectSync(s,u)):oe.mergeObjectSync(s,l)}get shape(){return this._def.shape()}strict(e){return x.errToObj,new V({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,s)=>{var n,a,i,o;const l=(i=(a=(n=this._def).errorMap)===null||a===void 0?void 0:a.call(n,t,s).message)!==null&&i!==void 0?i:s.defaultError;return t.code==="unrecognized_keys"?{message:(o=x.errToObj(e).message)!==null&&o!==void 0?o:l}:{message:l}}}:{}})}strip(){return new V({...this._def,unknownKeys:"strip"})}passthrough(){return new V({...this._def,unknownKeys:"passthrough"})}extend(e){return new V({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new V({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:S.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new V({...this._def,catchall:e})}pick(e){const t={};return I.objectKeys(e).forEach(s=>{e[s]&&this.shape[s]&&(t[s]=this.shape[s])}),new V({...this._def,shape:()=>t})}omit(e){const t={};return I.objectKeys(this.shape).forEach(s=>{e[s]||(t[s]=this.shape[s])}),new V({...this._def,shape:()=>t})}deepPartial(){return jt(this)}partial(e){const t={};return I.objectKeys(this.shape).forEach(s=>{const n=this.shape[s];e&&!e[s]?t[s]=n:t[s]=n.optional()}),new V({...this._def,shape:()=>t})}required(e){const t={};return I.objectKeys(this.shape).forEach(s=>{if(e&&!e[s])t[s]=this.shape[s];else{let a=this.shape[s];for(;a instanceof Oe;)a=a._def.innerType;t[s]=a}}),new V({...this._def,shape:()=>t})}keyof(){return eo(I.objectKeys(this.shape))}}V.create=(r,e)=>new V({shape:()=>r,unknownKeys:"strip",catchall:Be.create(),typeName:S.ZodObject,...A(e)});V.strictCreate=(r,e)=>new V({shape:()=>r,unknownKeys:"strict",catchall:Be.create(),typeName:S.ZodObject,...A(e)});V.lazycreate=(r,e)=>new V({shape:r,unknownKeys:"strip",catchall:Be.create(),typeName:S.ZodObject,...A(e)});class ws extends N{_parse(e){const{ctx:t}=this._processInputParams(e),s=this._def.options;function n(a){for(const o of a)if(o.result.status==="valid")return o.result;for(const o of a)if(o.result.status==="dirty")return t.common.issues.push(...o.ctx.common.issues),o.result;const i=a.map(o=>new ge(o.ctx.common.issues));return w(t,{code:g.invalid_union,unionErrors:i}),E}if(t.common.async)return Promise.all(s.map(async a=>{const i={...t,common:{...t.common,issues:[]},parent:null};return{result:await a._parseAsync({data:t.data,path:t.path,parent:i}),ctx:i}})).then(n);{let a;const i=[];for(const l of s){const u={...t,common:{...t.common,issues:[]},parent:null},d=l._parseSync({data:t.data,path:t.path,parent:u});if(d.status==="valid")return d;d.status==="dirty"&&!a&&(a={result:d,ctx:u}),u.common.issues.length&&i.push(u.common.issues)}if(a)return t.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(l=>new ge(l));return w(t,{code:g.invalid_union,unionErrors:o}),E}}get options(){return this._def.options}}ws.create=(r,e)=>new ws({options:r,typeName:S.ZodUnion,...A(e)});const Le=r=>r instanceof xs?Le(r.schema):r instanceof Ee?Le(r.innerType()):r instanceof ks?[r.value]:r instanceof Xe?r.options:r instanceof js?I.objectValues(r.enum):r instanceof Ss?Le(r._def.innerType):r instanceof ys?[void 0]:r instanceof _s?[null]:r instanceof Oe?[void 0,...Le(r.unwrap())]:r instanceof Qe?[null,...Le(r.unwrap())]:r instanceof $n||r instanceof As?Le(r.unwrap()):r instanceof Es?Le(r._def.innerType):[];class Pr extends N{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==v.object)return w(t,{code:g.invalid_type,expected:v.object,received:t.parsedType}),E;const s=this.discriminator,n=t.data[s],a=this.optionsMap.get(n);return a?t.common.async?a._parseAsync({data:t.data,path:t.path,parent:t}):a._parseSync({data:t.data,path:t.path,parent:t}):(w(t,{code:g.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),E)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,s){const n=new Map;for(const a of t){const i=Le(a.shape[e]);if(!i.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of i){if(n.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);n.set(o,a)}}return new Pr({typeName:S.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:n,...A(s)})}}function fn(r,e){const t=Fe(r),s=Fe(e);if(r===e)return{valid:!0,data:r};if(t===v.object&&s===v.object){const n=I.objectKeys(e),a=I.objectKeys(r).filter(o=>n.indexOf(o)!==-1),i={...r,...e};for(const o of a){const l=fn(r[o],e[o]);if(!l.valid)return{valid:!1};i[o]=l.data}return{valid:!0,data:i}}else if(t===v.array&&s===v.array){if(r.length!==e.length)return{valid:!1};const n=[];for(let a=0;a<r.length;a++){const i=r[a],o=e[a],l=fn(i,o);if(!l.valid)return{valid:!1};n.push(l.data)}return{valid:!0,data:n}}else return t===v.date&&s===v.date&&+r==+e?{valid:!0,data:r}:{valid:!1}}class vs extends N{_parse(e){const{status:t,ctx:s}=this._processInputParams(e),n=(a,i)=>{if(dn(a)||dn(i))return E;const o=fn(a.value,i.value);return o.valid?((hn(a)||hn(i))&&t.dirty(),{status:t.value,value:o.data}):(w(s,{code:g.invalid_intersection_types}),E)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([a,i])=>n(a,i)):n(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}}vs.create=(r,e,t)=>new vs({left:r,right:e,typeName:S.ZodIntersection,...A(t)});class Ie extends N{_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==v.array)return w(s,{code:g.invalid_type,expected:v.array,received:s.parsedType}),E;if(s.data.length<this._def.items.length)return w(s,{code:g.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),E;!this._def.rest&&s.data.length>this._def.items.length&&(w(s,{code:g.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const a=[...s.data].map((i,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new Re(s,i,s.path,o)):null}).filter(i=>!!i);return s.common.async?Promise.all(a).then(i=>oe.mergeArray(t,i)):oe.mergeArray(t,a)}get items(){return this._def.items}rest(e){return new Ie({...this._def,rest:e})}}Ie.create=(r,e)=>{if(!Array.isArray(r))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ie({items:r,typeName:S.ZodTuple,rest:null,...A(e)})};class bs extends N{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==v.object)return w(s,{code:g.invalid_type,expected:v.object,received:s.parsedType}),E;const n=[],a=this._def.keyType,i=this._def.valueType;for(const o in s.data)n.push({key:a._parse(new Re(s,o,s.path,o)),value:i._parse(new Re(s,s.data[o],s.path,o)),alwaysSet:o in s.data});return s.common.async?oe.mergeObjectAsync(t,n):oe.mergeObjectSync(t,n)}get element(){return this._def.valueType}static create(e,t,s){return t instanceof N?new bs({keyType:e,valueType:t,typeName:S.ZodRecord,...A(s)}):new bs({keyType:xe.create(),valueType:e,typeName:S.ZodRecord,...A(t)})}}class pr extends N{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==v.map)return w(s,{code:g.invalid_type,expected:v.map,received:s.parsedType}),E;const n=this._def.keyType,a=this._def.valueType,i=[...s.data.entries()].map(([o,l],u)=>({key:n._parse(new Re(s,o,s.path,[u,"key"])),value:a._parse(new Re(s,l,s.path,[u,"value"]))}));if(s.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of i){const u=await l.key,d=await l.value;if(u.status==="aborted"||d.status==="aborted")return E;(u.status==="dirty"||d.status==="dirty")&&t.dirty(),o.set(u.value,d.value)}return{status:t.value,value:o}})}else{const o=new Map;for(const l of i){const u=l.key,d=l.value;if(u.status==="aborted"||d.status==="aborted")return E;(u.status==="dirty"||d.status==="dirty")&&t.dirty(),o.set(u.value,d.value)}return{status:t.value,value:o}}}}pr.create=(r,e,t)=>new pr({valueType:e,keyType:r,typeName:S.ZodMap,...A(t)});class ft extends N{_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==v.set)return w(s,{code:g.invalid_type,expected:v.set,received:s.parsedType}),E;const n=this._def;n.minSize!==null&&s.data.size<n.minSize.value&&(w(s,{code:g.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),t.dirty()),n.maxSize!==null&&s.data.size>n.maxSize.value&&(w(s,{code:g.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),t.dirty());const a=this._def.valueType;function i(l){const u=new Set;for(const d of l){if(d.status==="aborted")return E;d.status==="dirty"&&t.dirty(),u.add(d.value)}return{status:t.value,value:u}}const o=[...s.data.values()].map((l,u)=>a._parse(new Re(s,l,s.path,u)));return s.common.async?Promise.all(o).then(l=>i(l)):i(o)}min(e,t){return new ft({...this._def,minSize:{value:e,message:x.toString(t)}})}max(e,t){return new ft({...this._def,maxSize:{value:e,message:x.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}ft.create=(r,e)=>new ft({valueType:r,minSize:null,maxSize:null,typeName:S.ZodSet,...A(e)});class Ct extends N{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==v.function)return w(t,{code:g.invalid_type,expected:v.function,received:t.parsedType}),E;function s(o,l){return dr({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,ur(),Dt].filter(u=>!!u),issueData:{code:g.invalid_arguments,argumentsError:l}})}function n(o,l){return dr({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,ur(),Dt].filter(u=>!!u),issueData:{code:g.invalid_return_type,returnTypeError:l}})}const a={errorMap:t.common.contextualErrorMap},i=t.data;if(this._def.returns instanceof Ft){const o=this;return ce(async function(...l){const u=new ge([]),d=await o._def.args.parseAsync(l,a).catch(m=>{throw u.addIssue(s(l,m)),u}),h=await Reflect.apply(i,this,d);return await o._def.returns._def.type.parseAsync(h,a).catch(m=>{throw u.addIssue(n(h,m)),u})})}else{const o=this;return ce(function(...l){const u=o._def.args.safeParse(l,a);if(!u.success)throw new ge([s(l,u.error)]);const d=Reflect.apply(i,this,u.data),h=o._def.returns.safeParse(d,a);if(!h.success)throw new ge([n(d,h.error)]);return h.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Ct({...this._def,args:Ie.create(e).rest(lt.create())})}returns(e){return new Ct({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,s){return new Ct({args:e||Ie.create([]).rest(lt.create()),returns:t||lt.create(),typeName:S.ZodFunction,...A(s)})}}class xs extends N{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}xs.create=(r,e)=>new xs({getter:r,typeName:S.ZodLazy,...A(e)});class ks extends N{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return w(t,{received:t.data,code:g.invalid_literal,expected:this._def.value}),E}return{status:"valid",value:e.data}}get value(){return this._def.value}}ks.create=(r,e)=>new ks({value:r,typeName:S.ZodLiteral,...A(e)});function eo(r,e){return new Xe({values:r,typeName:S.ZodEnum,...A(e)})}class Xe extends N{constructor(){super(...arguments),es.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),s=this._def.values;return w(t,{expected:I.joinValues(s),received:t.parsedType,code:g.invalid_type}),E}if(hr(this,es)||Yi(this,es,new Set(this._def.values)),!hr(this,es).has(e.data)){const t=this._getOrReturnCtx(e),s=this._def.values;return w(t,{received:t.data,code:g.invalid_enum_value,options:s}),E}return ce(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Xe.create(e,{...this._def,...t})}exclude(e,t=this._def){return Xe.create(this.options.filter(s=>!e.includes(s)),{...this._def,...t})}}es=new WeakMap;Xe.create=eo;class js extends N{constructor(){super(...arguments),ts.set(this,void 0)}_parse(e){const t=I.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==v.string&&s.parsedType!==v.number){const n=I.objectValues(t);return w(s,{expected:I.joinValues(n),received:s.parsedType,code:g.invalid_type}),E}if(hr(this,ts)||Yi(this,ts,new Set(I.getValidEnumValues(this._def.values))),!hr(this,ts).has(e.data)){const n=I.objectValues(t);return w(s,{received:s.data,code:g.invalid_enum_value,options:n}),E}return ce(e.data)}get enum(){return this._def.values}}ts=new WeakMap;js.create=(r,e)=>new js({values:r,typeName:S.ZodNativeEnum,...A(e)});class Ft extends N{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==v.promise&&t.common.async===!1)return w(t,{code:g.invalid_type,expected:v.promise,received:t.parsedType}),E;const s=t.parsedType===v.promise?t.data:Promise.resolve(t.data);return ce(s.then(n=>this._def.type.parseAsync(n,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Ft.create=(r,e)=>new Ft({type:r,typeName:S.ZodPromise,...A(e)});class Ee extends N{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===S.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:s}=this._processInputParams(e),n=this._def.effect||null,a={addIssue:i=>{w(s,i),i.fatal?t.abort():t.dirty()},get path(){return s.path}};if(a.addIssue=a.addIssue.bind(a),n.type==="preprocess"){const i=n.transform(s.data,a);if(s.common.async)return Promise.resolve(i).then(async o=>{if(t.value==="aborted")return E;const l=await this._def.schema._parseAsync({data:o,path:s.path,parent:s});return l.status==="aborted"?E:l.status==="dirty"||t.value==="dirty"?At(l.value):l});{if(t.value==="aborted")return E;const o=this._def.schema._parseSync({data:i,path:s.path,parent:s});return o.status==="aborted"?E:o.status==="dirty"||t.value==="dirty"?At(o.value):o}}if(n.type==="refinement"){const i=o=>{const l=n.refinement(o,a);if(s.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(s.common.async===!1){const o=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return o.status==="aborted"?E:(o.status==="dirty"&&t.dirty(),i(o.value),{status:t.value,value:o.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(o=>o.status==="aborted"?E:(o.status==="dirty"&&t.dirty(),i(o.value).then(()=>({status:t.value,value:o.value}))))}if(n.type==="transform")if(s.common.async===!1){const i=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!dt(i))return i;const o=n.transform(i.value,a);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:o}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(i=>dt(i)?Promise.resolve(n.transform(i.value,a)).then(o=>({status:t.value,value:o})):i);I.assertNever(n)}}Ee.create=(r,e,t)=>new Ee({schema:r,typeName:S.ZodEffects,effect:e,...A(t)});Ee.createWithPreprocess=(r,e,t)=>new Ee({schema:e,effect:{type:"preprocess",transform:r},typeName:S.ZodEffects,...A(t)});class Oe extends N{_parse(e){return this._getType(e)===v.undefined?ce(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Oe.create=(r,e)=>new Oe({innerType:r,typeName:S.ZodOptional,...A(e)});class Qe extends N{_parse(e){return this._getType(e)===v.null?ce(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Qe.create=(r,e)=>new Qe({innerType:r,typeName:S.ZodNullable,...A(e)});class Ss extends N{_parse(e){const{ctx:t}=this._processInputParams(e);let s=t.data;return t.parsedType===v.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Ss.create=(r,e)=>new Ss({innerType:r,typeName:S.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...A(e)});class Es extends N{_parse(e){const{ctx:t}=this._processInputParams(e),s={...t,common:{...t.common,issues:[]}},n=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return ps(n)?n.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new ge(s.common.issues)},input:s.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new ge(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}}Es.create=(r,e)=>new Es({innerType:r,typeName:S.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...A(e)});class gr extends N{_parse(e){if(this._getType(e)!==v.nan){const s=this._getOrReturnCtx(e);return w(s,{code:g.invalid_type,expected:v.nan,received:s.parsedType}),E}return{status:"valid",value:e.data}}}gr.create=r=>new gr({typeName:S.ZodNaN,...A(r)});const Df=Symbol("zod_brand");class $n extends N{_parse(e){const{ctx:t}=this._processInputParams(e),s=t.data;return this._def.type._parse({data:s,path:t.path,parent:t})}unwrap(){return this._def.type}}class $s extends N{_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return a.status==="aborted"?E:a.status==="dirty"?(t.dirty(),At(a.value)):this._def.out._parseAsync({data:a.value,path:s.path,parent:s})})();{const n=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?E:n.status==="dirty"?(t.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:s.path,parent:s})}}static create(e,t){return new $s({in:e,out:t,typeName:S.ZodPipeline})}}class As extends N{_parse(e){const t=this._def.innerType._parse(e),s=n=>(dt(n)&&(n.value=Object.freeze(n.value)),n);return ps(t)?t.then(n=>s(n)):s(t)}unwrap(){return this._def.innerType}}As.create=(r,e)=>new As({innerType:r,typeName:S.ZodReadonly,...A(e)});function to(r,e={},t){return r?Mt.create().superRefine((s,n)=>{var a,i;if(!r(s)){const o=typeof e=="function"?e(s):typeof e=="string"?{message:e}:e,l=(i=(a=o.fatal)!==null&&a!==void 0?a:t)!==null&&i!==void 0?i:!0,u=typeof o=="string"?{message:o}:o;n.addIssue({code:"custom",...u,fatal:l})}}):Mt.create()}const Mf={object:V.lazycreate};var S;(function(r){r.ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodSymbol="ZodSymbol",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodCatch="ZodCatch",r.ZodPromise="ZodPromise",r.ZodBranded="ZodBranded",r.ZodPipeline="ZodPipeline",r.ZodReadonly="ZodReadonly"})(S||(S={}));const Ff=(r,e={message:`Input not instance of ${r.name}`})=>to(t=>t instanceof r,e),so=xe.create,ro=Ye.create,Uf=gr.create,Bf=Ke.create,no=gs.create,Wf=ht.create,qf=fr.create,Vf=ys.create,Hf=_s.create,zf=Mt.create,Zf=lt.create,Jf=Be.create,Gf=mr.create,Yf=Se.create,Kf=V.create,Xf=V.strictCreate,Qf=ws.create,em=Pr.create,tm=vs.create,sm=Ie.create,rm=bs.create,nm=pr.create,am=ft.create,im=Ct.create,om=xs.create,cm=ks.create,lm=Xe.create,um=js.create,dm=Ft.create,Ra=Ee.create,hm=Oe.create,fm=Qe.create,mm=Ee.createWithPreprocess,pm=$s.create,gm=()=>so().optional(),ym=()=>ro().optional(),_m=()=>no().optional(),wm={string:r=>xe.create({...r,coerce:!0}),number:r=>Ye.create({...r,coerce:!0}),boolean:r=>gs.create({...r,coerce:!0}),bigint:r=>Ke.create({...r,coerce:!0}),date:r=>ht.create({...r,coerce:!0})},vm=E;var Y=Object.freeze({__proto__:null,defaultErrorMap:Dt,setErrorMap:mf,getErrorMap:ur,makeIssue:dr,EMPTY_PATH:pf,addIssueToContext:w,ParseStatus:oe,INVALID:E,DIRTY:At,OK:ce,isAborted:dn,isDirty:hn,isValid:dt,isAsync:ps,get util(){return I},get objectUtil(){return un},ZodParsedType:v,getParsedType:Fe,ZodType:N,datetimeRegex:Qi,ZodString:xe,ZodNumber:Ye,ZodBigInt:Ke,ZodBoolean:gs,ZodDate:ht,ZodSymbol:fr,ZodUndefined:ys,ZodNull:_s,ZodAny:Mt,ZodUnknown:lt,ZodNever:Be,ZodVoid:mr,ZodArray:Se,ZodObject:V,ZodUnion:ws,ZodDiscriminatedUnion:Pr,ZodIntersection:vs,ZodTuple:Ie,ZodRecord:bs,ZodMap:pr,ZodSet:ft,ZodFunction:Ct,ZodLazy:xs,ZodLiteral:ks,ZodEnum:Xe,ZodNativeEnum:js,ZodPromise:Ft,ZodEffects:Ee,ZodTransformer:Ee,ZodOptional:Oe,ZodNullable:Qe,ZodDefault:Ss,ZodCatch:Es,ZodNaN:gr,BRAND:Df,ZodBranded:$n,ZodPipeline:$s,ZodReadonly:As,custom:to,Schema:N,ZodSchema:N,late:Mf,get ZodFirstPartyTypeKind(){return S},coerce:wm,any:zf,array:Yf,bigint:Bf,boolean:no,date:Wf,discriminatedUnion:em,effect:Ra,enum:lm,function:im,instanceof:Ff,intersection:tm,lazy:om,literal:cm,map:nm,nan:Uf,nativeEnum:um,never:Jf,null:Hf,nullable:fm,number:ro,object:Kf,oboolean:_m,onumber:ym,optional:hm,ostring:gm,pipeline:pm,preprocess:mm,promise:dm,record:rm,set:am,strictObject:Xf,string:so,symbol:qf,transformer:Ra,tuple:sm,undefined:Vf,union:Qf,unknown:Zf,void:Gf,NEVER:vm,ZodIssueCode:g,quotelessJson:ff,ZodError:ge});function bm({initialValues:r,validationSchema:e,onSubmit:t}){const[s,n]=p.useState({values:r,errors:{},touched:{}}),a=p.useCallback((l,u)=>{n(d=>({...d,values:{...d.values,[l]:u},touched:{...d.touched,[l]:!0}}))},[]),i=p.useCallback((l,u)=>{if(!e)return"";try{return Y.object({[l]:e._def.shape[l]}).parse({[l]:u}),""}catch(d){return d instanceof Y.ZodError&&d.errors[0]?.message||""}},[e]),o=p.useCallback(async l=>{if(l.preventDefault(),e)try{e.parse(s.values)}catch(u){if(u instanceof Y.ZodError){const d={};u.errors.forEach(h=>{h.path[0]&&(d[h.path[0]]=h.message)}),n(h=>({...h,errors:d}));return}}await t(s.values)},[s.values,e,t]);return{values:s.values,errors:s.errors,touched:s.touched,setFieldValue:a,validateField:i,handleSubmit:o}}function ao(){const[r,e]=p.useState([]),t=p.useCallback((n,a="info")=>{e(i=>[...i,{id:Date.now(),message:n,type:a}])},[]),s=p.useCallback(n=>{e(a=>a.filter(i=>i.id!==n))},[]);return{toasts:r,addToast:t,removeToast:s}}function xm(r=!1){const[e,t]=p.useState(r),[s,n]=p.useState(null),a=p.useCallback(async i=>{t(!0),n(null);try{return await i}catch(o){const l=o instanceof Error?o.message:"An unexpected error occurred";throw n(l),o}finally{t(!1)}},[]);return{isLoading:e,error:s,withLoading:a}}const mn="RFC3986",pn={RFC1738:r=>String(r).replace(/%20/g,"+"),RFC3986:r=>String(r)},km="RFC1738",jm=Array.isArray,Te=(()=>{const r=[];for(let e=0;e<256;++e)r.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return r})(),Hr=1024,Sm=(r,e,t,s,n)=>{if(r.length===0)return r;let a=r;if(typeof r=="symbol"?a=Symbol.prototype.toString.call(r):typeof r!="string"&&(a=String(r)),t==="iso-8859-1")return escape(a).replace(/%u[0-9a-f]{4}/gi,function(o){return"%26%23"+parseInt(o.slice(2),16)+"%3B"});let i="";for(let o=0;o<a.length;o+=Hr){const l=a.length>=Hr?a.slice(o,o+Hr):a,u=[];for(let d=0;d<l.length;++d){let h=l.charCodeAt(d);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||n===km&&(h===40||h===41)){u[u.length]=l.charAt(d);continue}if(h<128){u[u.length]=Te[h];continue}if(h<2048){u[u.length]=Te[192|h>>6]+Te[128|h&63];continue}if(h<55296||h>=57344){u[u.length]=Te[224|h>>12]+Te[128|h>>6&63]+Te[128|h&63];continue}d+=1,h=65536+((h&1023)<<10|l.charCodeAt(d)&1023),u[u.length]=Te[240|h>>18]+Te[128|h>>12&63]+Te[128|h>>6&63]+Te[128|h&63]}i+=u.join("")}return i};function Em(r){return!r||typeof r!="object"?!1:!!(r.constructor&&r.constructor.isBuffer&&r.constructor.isBuffer(r))}function Ia(r,e){if(jm(r)){const t=[];for(let s=0;s<r.length;s+=1)t.push(e(r[s]));return t}return e(r)}const Am=Object.prototype.hasOwnProperty,io={brackets(r){return String(r)+"[]"},comma:"comma",indices(r,e){return String(r)+"["+e+"]"},repeat(r){return String(r)}},Ne=Array.isArray,Tm=Array.prototype.push,oo=function(r,e){Tm.apply(r,Ne(e)?e:[e])},Nm=Date.prototype.toISOString,G={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Sm,encodeValuesOnly:!1,format:mn,formatter:pn[mn],indices:!1,serializeDate(r){return Nm.call(r)},skipNulls:!1,strictNullHandling:!1};function Cm(r){return typeof r=="string"||typeof r=="number"||typeof r=="boolean"||typeof r=="symbol"||typeof r=="bigint"}const zr={};function co(r,e,t,s,n,a,i,o,l,u,d,h,f,m,_,y,b,O){let k=r,F=O,R=0,L=!1;for(;(F=F.get(zr))!==void 0&&!L;){const z=F.get(r);if(R+=1,typeof z<"u"){if(z===R)throw new RangeError("Cyclic object value");L=!0}typeof F.get(zr)>"u"&&(R=0)}if(typeof u=="function"?k=u(e,k):k instanceof Date?k=f?.(k):t==="comma"&&Ne(k)&&(k=Ia(k,function(z){return z instanceof Date?f?.(z):z})),k===null){if(a)return l&&!y?l(e,G.encoder,b,"key",m):e;k=""}if(Cm(k)||Em(k)){if(l){const z=y?e:l(e,G.encoder,b,"key",m);return[_?.(z)+"="+_?.(l(k,G.encoder,b,"value",m))]}return[_?.(e)+"="+_?.(String(k))]}const ne=[];if(typeof k>"u")return ne;let ae;if(t==="comma"&&Ne(k))y&&l&&(k=Ia(k,l)),ae=[{value:k.length>0?k.join(",")||null:void 0}];else if(Ne(u))ae=u;else{const z=Object.keys(k);ae=d?z.sort(d):z}const ee=o?String(e).replace(/\./g,"%2E"):String(e),K=s&&Ne(k)&&k.length===1?ee+"[]":ee;if(n&&Ne(k)&&k.length===0)return K+"[]";for(let z=0;z<ae.length;++z){const Z=ae[z],oa=typeof Z=="object"&&typeof Z.value<"u"?Z.value:k[Z];if(i&&oa===null)continue;const Lr=h&&o?Z.replace(/\./g,"%2E"):Z,vc=Ne(k)?typeof t=="function"?t(K,Lr):K:K+(h?"."+Lr:"["+Lr+"]");O.set(r,R);const ca=new WeakMap;ca.set(zr,O),oo(ne,co(oa,vc,t,s,n,a,i,o,t==="comma"&&y&&Ne(k)?null:l,u,d,h,f,m,_,y,b,ca))}return ne}function Pm(r=G){if(typeof r.allowEmptyArrays<"u"&&typeof r.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof r.encodeDotInKeys<"u"&&typeof r.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(r.encoder!==null&&typeof r.encoder<"u"&&typeof r.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=r.charset||G.charset;if(typeof r.charset<"u"&&r.charset!=="utf-8"&&r.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=mn;if(typeof r.format<"u"){if(!Am.call(pn,r.format))throw new TypeError("Unknown format option provided.");t=r.format}const s=pn[t];let n=G.filter;(typeof r.filter=="function"||Ne(r.filter))&&(n=r.filter);let a;if(r.arrayFormat&&r.arrayFormat in io?a=r.arrayFormat:"indices"in r?a=r.indices?"indices":"repeat":a=G.arrayFormat,"commaRoundTrip"in r&&typeof r.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const i=typeof r.allowDots>"u"?r.encodeDotInKeys?!0:G.allowDots:!!r.allowDots;return{addQueryPrefix:typeof r.addQueryPrefix=="boolean"?r.addQueryPrefix:G.addQueryPrefix,allowDots:i,allowEmptyArrays:typeof r.allowEmptyArrays=="boolean"?!!r.allowEmptyArrays:G.allowEmptyArrays,arrayFormat:a,charset:e,charsetSentinel:typeof r.charsetSentinel=="boolean"?r.charsetSentinel:G.charsetSentinel,commaRoundTrip:!!r.commaRoundTrip,delimiter:typeof r.delimiter>"u"?G.delimiter:r.delimiter,encode:typeof r.encode=="boolean"?r.encode:G.encode,encodeDotInKeys:typeof r.encodeDotInKeys=="boolean"?r.encodeDotInKeys:G.encodeDotInKeys,encoder:typeof r.encoder=="function"?r.encoder:G.encoder,encodeValuesOnly:typeof r.encodeValuesOnly=="boolean"?r.encodeValuesOnly:G.encodeValuesOnly,filter:n,format:t,formatter:s,serializeDate:typeof r.serializeDate=="function"?r.serializeDate:G.serializeDate,skipNulls:typeof r.skipNulls=="boolean"?r.skipNulls:G.skipNulls,sort:typeof r.sort=="function"?r.sort:null,strictNullHandling:typeof r.strictNullHandling=="boolean"?r.strictNullHandling:G.strictNullHandling}}function Om(r,e={}){let t=r;const s=Pm(e);let n,a;typeof s.filter=="function"?(a=s.filter,t=a("",t)):Ne(s.filter)&&(a=s.filter,n=a);const i=[];if(typeof t!="object"||t===null)return"";const o=io[s.arrayFormat],l=o==="comma"&&s.commaRoundTrip;n||(n=Object.keys(t)),s.sort&&n.sort(s.sort);const u=new WeakMap;for(let f=0;f<n.length;++f){const m=n[f];s.skipNulls&&t[m]===null||oo(i,co(t[m],m,o,l,s.allowEmptyArrays,s.strictNullHandling,s.skipNulls,s.encodeDotInKeys,s.encode?s.encoder:null,s.filter,s.sort,s.allowDots,s.serializeDate,s.format,s.formatter,s.encodeValuesOnly,s.charset,u))}const d=i.join(s.delimiter);let h=s.addQueryPrefix===!0?"?":"";return s.charsetSentinel&&(s.charset==="iso-8859-1"?h+="utf8=%26%2310003%3B&":h+="utf8=%E2%9C%93&"),d.length>0?h+d:""}const St="4.76.3";let $a=!1,us,lo,uo,gn,ho,fo,mo,po,go;function Rm(r,e={auto:!1}){if($a)throw new Error(`you must \`import 'openai/shims/${r.kind}'\` before importing anything else from openai`);if(us)throw new Error(`can't \`import 'openai/shims/${r.kind}'\` after \`import 'openai/shims/${us}'\``);$a=e.auto,us=r.kind,lo=r.fetch,uo=r.FormData,gn=r.File,ho=r.ReadableStream,fo=r.getMultipartRequestOptions,mo=r.getDefaultAgent,po=r.fileFromPath,go=r.isFsReadStream}class Im{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function $m({manuallyImported:r}={}){const e=r?"You may need to use polyfills":"Add one of these imports before your first `import â¦ from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let t,s,n,a;try{t=fetch,s=Request,n=Response,a=Headers}catch(i){throw new Error(`this environment is missing the following Web Fetch API type: ${i.message}. ${e}`)}return{kind:"web",fetch:t,Request:s,Response:n,Headers:a,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(i,o)=>({...o,body:new Im(i)}),getDefaultAgent:i=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:i=>!1}}us||Rm($m(),{auto:!0});class C extends Error{}class re extends C{constructor(e,t,s,n){super(`${re.makeMessage(e,t,s)}`),this.status=e,this.headers=n,this.request_id=n?.["x-request-id"],this.error=t;const a=t;this.code=a?.code,this.param=a?.param,this.type=a?.type}static makeMessage(e,t,s){const n=t?.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):s;return e&&n?`${e} ${n}`:e?`${e} status code (no body)`:n||"(no status code or body)"}static generate(e,t,s,n){if(!e||!n)return new Or({message:s,cause:_n(t)});const a=t?.error;return e===400?new yo(e,a,s,n):e===401?new _o(e,a,s,n):e===403?new wo(e,a,s,n):e===404?new vo(e,a,s,n):e===409?new bo(e,a,s,n):e===422?new xo(e,a,s,n):e===429?new ko(e,a,s,n):e>=500?new jo(e,a,s,n):new re(e,a,s,n)}}class ke extends re{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Or extends re{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class Ln extends Or{constructor({message:e}={}){super({message:e??"Request timed out."})}}class yo extends re{}class _o extends re{}class wo extends re{}class vo extends re{}class bo extends re{}class xo extends re{}class ko extends re{}class jo extends re{}class So extends C{constructor(){super("Could not parse response content as the length limit was reached")}}class Eo extends C{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class mt{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];const s=mt.NEWLINE_CHARS.has(t[t.length-1]||"");let n=t.split(mt.NEWLINE_REGEXP);return s&&n.pop(),n.length===1&&!s?(this.buffer.push(n[0]),[]):(this.buffer.length>0&&(n=[this.buffer.join("")+n[0],...n.slice(1)],this.buffer=[]),s||(this.buffer=[n.pop()||""]),n)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new C(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new C(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new C("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}mt.NEWLINE_CHARS=new Set([`
`,"\r"]);mt.NEWLINE_REGEXP=/\r\n|[\n\r]/g;class Pe{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let s=!1;async function*n(){if(s)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let a=!1;try{for await(const i of Lm(e,t))if(!a){if(i.data.startsWith("[DONE]")){a=!0;continue}if(i.event===null){let o;try{o=JSON.parse(i.data)}catch(l){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),l}if(o&&o.error)throw new re(void 0,o.error,void 0,void 0);yield o}else{let o;try{o=JSON.parse(i.data)}catch(l){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),l}if(i.event=="error")throw new re(void 0,o.error,o.message,void 0);yield{event:i.event,data:o}}}a=!0}catch(i){if(i instanceof Error&&i.name==="AbortError")return;throw i}finally{a||t.abort()}}return new Pe(n,t)}static fromReadableStream(e,t){let s=!1;async function*n(){const i=new mt,o=Ao(e);for await(const l of o)for(const u of i.decode(l))yield u;for(const l of i.flush())yield l}async function*a(){if(s)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let i=!1;try{for await(const o of n())i||o&&(yield JSON.parse(o));i=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{i||t.abort()}}return new Pe(a,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],s=this.iterator(),n=a=>({next:()=>{if(a.length===0){const i=s.next();e.push(i),t.push(i)}return a.shift()}});return[new Pe(()=>n(e),this.controller),new Pe(()=>n(t),this.controller)]}toReadableStream(){const e=this;let t;const s=new TextEncoder;return new ho({async start(){t=e[Symbol.asyncIterator]()},async pull(n){try{const{value:a,done:i}=await t.next();if(i)return n.close();const o=s.encode(JSON.stringify(a)+`
`);n.enqueue(o)}catch(a){n.error(a)}},async cancel(){await t.return?.()}})}}async function*Lm(r,e){if(!r.body)throw e.abort(),new C("Attempted to iterate over a response with no body");const t=new Fm,s=new mt,n=Ao(r.body);for await(const a of Dm(n))for(const i of s.decode(a)){const o=t.decode(i);o&&(yield o)}for(const a of s.flush()){const i=t.decode(a);i&&(yield i)}}async function*Dm(r){let e=new Uint8Array;for await(const t of r){if(t==null)continue;const s=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let n=new Uint8Array(e.length+s.length);n.set(e),n.set(s,e.length),e=n;let a;for(;(a=Mm(e))!==-1;)yield e.slice(0,a),e=e.slice(a)}e.length>0&&(yield e)}function Mm(r){for(let s=0;s<r.length-2;s++){if(r[s]===10&&r[s+1]===10||r[s]===13&&r[s+1]===13)return s+2;if(r[s]===13&&r[s+1]===10&&s+3<r.length&&r[s+2]===13&&r[s+3]===10)return s+4}return-1}class Fm{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,s,n]=Um(e,":");return n.startsWith(" ")&&(n=n.substring(1)),t==="event"?this.event=n:t==="data"&&this.data.push(n),null}}function Um(r,e){const t=r.indexOf(e);return t!==-1?[r.substring(0,t),e,r.substring(t+e.length)]:[r,"",""]}function Ao(r){if(r[Symbol.asyncIterator])return r;const e=r.getReader();return{async next(){try{const t=await e.read();return t?.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const To=r=>r!=null&&typeof r=="object"&&typeof r.url=="string"&&typeof r.blob=="function",No=r=>r!=null&&typeof r=="object"&&typeof r.name=="string"&&typeof r.lastModified=="number"&&Rr(r),Rr=r=>r!=null&&typeof r=="object"&&typeof r.size=="number"&&typeof r.type=="string"&&typeof r.text=="function"&&typeof r.slice=="function"&&typeof r.arrayBuffer=="function",Bm=r=>No(r)||To(r)||go(r);async function Co(r,e,t){if(r=await r,No(r))return r;if(To(r)){const n=await r.blob();e||(e=new URL(r.url).pathname.split(/[\\/]/).pop()??"unknown_file");const a=Rr(n)?[await n.arrayBuffer()]:[n];return new gn(a,e,t)}const s=await Wm(r);if(e||(e=Vm(r)??"unknown_file"),!t?.type){const n=s[0]?.type;typeof n=="string"&&(t={...t,type:n})}return new gn(s,e,t)}async function Wm(r){let e=[];if(typeof r=="string"||ArrayBuffer.isView(r)||r instanceof ArrayBuffer)e.push(r);else if(Rr(r))e.push(await r.arrayBuffer());else if(Hm(r))for await(const t of r)e.push(t);else throw new Error(`Unexpected data type: ${typeof r}; constructor: ${r?.constructor?.name}; props: ${qm(r)}`);return e}function qm(r){return`[${Object.getOwnPropertyNames(r).map(t=>`"${t}"`).join(", ")}]`}function Vm(r){return Zr(r.name)||Zr(r.filename)||Zr(r.path)?.split(/[\\/]/).pop()}const Zr=r=>{if(typeof r=="string")return r;if(typeof Buffer<"u"&&r instanceof Buffer)return String(r)},Hm=r=>r!=null&&typeof r=="object"&&typeof r[Symbol.asyncIterator]=="function",La=r=>r&&typeof r=="object"&&r.body&&r[Symbol.toStringTag]==="MultipartBody",Ut=async r=>{const e=await zm(r.body);return fo(e,r)},zm=async r=>{const e=new uo;return await Promise.all(Object.entries(r||{}).map(([t,s])=>yn(e,t,s))),e},yn=async(r,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")r.append(e,String(t));else if(Bm(t)){const s=await Co(t);r.append(e,s)}else if(Array.isArray(t))await Promise.all(t.map(s=>yn(r,e+"[]",s)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([s,n])=>yn(r,`${e}[${s}]`,n)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}};var Po={},Zm=function(r,e,t,s,n){if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(r,t),t},Jm=function(r,e,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(r):s?s.value:e.get(r)},zs;async function Oo(r){const{response:e}=r;if(r.options.stream)return Pt("response",e.status,e.url,e.headers,e.body),r.options.__streamClass?r.options.__streamClass.fromSSEResponse(e,r.controller):Pe.fromSSEResponse(e,r.controller);if(e.status===204)return null;if(r.options.__binaryResponse)return e;const t=e.headers.get("content-type");if(t?.includes("application/json")||t?.includes("application/vnd.api+json")){const a=await e.json();return Pt("response",e.status,e.url,e.headers,a),Ro(a,e)}const n=await e.text();return Pt("response",e.status,e.url,e.headers,n),n}function Ro(r,e){return!r||typeof r!="object"||Array.isArray(r)?r:Object.defineProperty(r,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class Ir extends Promise{constructor(e,t=Oo){super(s=>{s(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new Ir(this.responsePromise,async t=>Ro(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class Gm{constructor({baseURL:e,maxRetries:t=2,timeout:s=6e5,httpAgent:n,fetch:a}){this.baseURL=e,this.maxRetries=Jr("maxRetries",t),this.timeout=Jr("timeout",s),this.httpAgent=n,this.fetch=a??lo}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...tp(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${ap()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,s){return this.request(Promise.resolve(s).then(async n=>{const a=n&&Rr(n?.body)?new DataView(await n.body.arrayBuffer()):n?.body instanceof DataView?n.body:n?.body instanceof ArrayBuffer?new DataView(n.body):n&&ArrayBuffer.isView(n?.body)?new DataView(n.body.buffer):n?.body;return{method:e,path:t,...n,body:a}}))}getAPIList(e,t,s){return this.requestAPIList(t,{method:"get",path:e,...s})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){const{method:s,path:n,query:a,headers:i={}}=e,o=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:La(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,l=this.calculateContentLength(o),u=this.buildURL(n,a);"timeout"in e&&Jr("timeout",e.timeout);const d=e.timeout??this.timeout,h=e.httpAgent??this.httpAgent??mo(u),f=d+1e3;typeof h?.options?.timeout=="number"&&f>(h.options.timeout??0)&&(h.options.timeout=f),this.idempotencyHeader&&s!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=e.idempotencyKey);const m=this.buildHeaders({options:e,headers:i,contentLength:l,retryCount:t});return{req:{method:s,...o&&{body:o},headers:m,...h&&{agent:h},signal:e.signal??null},url:u,timeout:d}}buildHeaders({options:e,headers:t,contentLength:s,retryCount:n}){const a={};s&&(a["content-length"]=s);const i=this.defaultHeaders(e);return Ua(a,i),Ua(a,t),La(e.body)&&us!=="node"&&delete a["content-type"],Ba(i,"x-stainless-retry-count")===void 0&&Ba(t,"x-stainless-retry-count")===void 0&&(a["x-stainless-retry-count"]=String(n)),this.validateHeaders(a,t),a}async prepareOptions(e){}async prepareRequest(e,{url:t,options:s}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,s,n){return re.generate(e,t,s,n)}request(e,t=null){return new Ir(this.makeRequest(e,t))}async makeRequest(e,t){const s=await e,n=s.maxRetries??this.maxRetries;t==null&&(t=n),await this.prepareOptions(s);const{req:a,url:i,timeout:o}=this.buildRequest(s,{retryCount:n-t});if(await this.prepareRequest(a,{url:i,options:s}),Pt("request",i,s,a.headers),s.signal?.aborted)throw new ke;const l=new AbortController,u=await this.fetchWithTimeout(i,a,o,l).catch(_n);if(u instanceof Error){if(s.signal?.aborted)throw new ke;if(t)return this.retryRequest(s,t);throw u.name==="AbortError"?new Ln:new Or({cause:u})}const d=Km(u.headers);if(!u.ok){if(t&&this.shouldRetry(u)){const b=`retrying, ${t} attempts remaining`;return Pt(`response (error; ${b})`,u.status,i,d),this.retryRequest(s,t,d)}const h=await u.text().catch(b=>_n(b).message),f=sp(h),m=f?void 0:h;throw Pt(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,u.status,i,d,m),this.makeStatusError(u.status,f,m,d)}return{response:u,options:s,controller:l}}requestAPIList(e,t){const s=this.makeRequest(t,null);return new Ym(this,s,e)}buildURL(e,t){const s=np(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),n=this.defaultQuery();return $o(n)||(t={...n,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(s.search=this.stringifyQuery(t)),s.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,s])=>typeof s<"u").map(([t,s])=>{if(typeof s=="string"||typeof s=="number"||typeof s=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(s)}`;if(s===null)return`${encodeURIComponent(t)}=`;throw new C(`Cannot stringify type ${typeof s}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,s,n){const{signal:a,...i}=t||{};a&&a.addEventListener("abort",()=>n.abort());const o=setTimeout(()=>n.abort(),s);return this.fetch.call(void 0,e,{signal:n.signal,...i}).finally(()=>{clearTimeout(o)})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,s){let n;const a=s?.["retry-after-ms"];if(a){const o=parseFloat(a);Number.isNaN(o)||(n=o)}const i=s?.["retry-after"];if(i&&!n){const o=parseFloat(i);Number.isNaN(o)?n=Date.parse(i)-Date.now():n=o*1e3}if(!(n&&0<=n&&n<60*1e3)){const o=e.maxRetries??this.maxRetries;n=this.calculateDefaultRetryTimeoutMillis(t,o)}return await Ls(n),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const a=t-e,i=Math.min(.5*Math.pow(2,a),8),o=1-Math.random()*.25;return i*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${St}`}}class Io{constructor(e,t,s,n){zs.set(this,void 0),Zm(this,zs,e),this.options=n,this.response=t,this.body=s}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new C("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&typeof t.query=="object")t.query={...t.query,...e.params};else if("url"in e){const s=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[n,a]of s)e.url.searchParams.set(n,a);t.query=void 0,t.path=e.url.toString()}return await Jm(this,zs,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(zs=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class Ym extends Ir{constructor(e,t,s){super(t,async n=>new s(e,n.response,await Oo(n),n.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}}const Km=r=>new Proxy(Object.fromEntries(r.entries()),{get(e,t){const s=t.toString();return e[s.toLowerCase()]||e[s]}}),Xm={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},he=r=>typeof r=="object"&&r!==null&&!$o(r)&&Object.keys(r).every(e=>Lo(Xm,e)),Qm=()=>{if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":St,"X-Stainless-OS":Ma(Deno.build.os),"X-Stainless-Arch":Da(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:Deno.version?.deno??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":St,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":St,"X-Stainless-OS":Ma(process.platform),"X-Stainless-Arch":Da(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const r=ep();return r?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":St,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${r.browser}`,"X-Stainless-Runtime-Version":r.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":St,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function ep(){if(typeof navigator>"u"||!navigator)return null;const r=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of r){const s=t.exec(navigator.userAgent);if(s){const n=s[1]||0,a=s[2]||0,i=s[3]||0;return{browser:e,version:`${n}.${a}.${i}`}}}return null}const Da=r=>r==="x32"?"x32":r==="x86_64"||r==="x64"?"x64":r==="arm"?"arm":r==="aarch64"||r==="arm64"?"arm64":r?`other:${r}`:"unknown",Ma=r=>(r=r.toLowerCase(),r.includes("ios")?"iOS":r==="android"?"Android":r==="darwin"?"MacOS":r==="win32"?"Windows":r==="freebsd"?"FreeBSD":r==="openbsd"?"OpenBSD":r==="linux"?"Linux":r?`Other:${r}`:"Unknown");let Fa;const tp=()=>Fa??(Fa=Qm()),sp=r=>{try{return JSON.parse(r)}catch{return}},rp=/^[a-z][a-z0-9+.-]*:/i,np=r=>rp.test(r),Ls=r=>new Promise(e=>setTimeout(e,r)),Jr=(r,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new C(`${r} must be an integer`);if(e<0)throw new C(`${r} must be a positive integer`);return e},_n=r=>{if(r instanceof Error)return r;if(typeof r=="object"&&r!==null)try{return new Error(JSON.stringify(r))}catch{}return new Error(r)},Zs=r=>{if(typeof process<"u")return Po?.[r]?.trim()??void 0;if(typeof Deno<"u")return Deno.env?.get?.(r)?.trim()};function $o(r){if(!r)return!0;for(const e in r)return!1;return!0}function Lo(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function Ua(r,e){for(const t in e){if(!Lo(e,t))continue;const s=t.toLowerCase();if(!s)continue;const n=e[t];n===null?delete r[s]:n!==void 0&&(r[s]=n)}}function Pt(r,...e){typeof process<"u"&&Po?.DEBUG==="true"&&console.log(`OpenAI:DEBUG:${r}`,...e)}const ap=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)}),ip=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",op=r=>typeof r?.get=="function",Ba=(r,e)=>{const t=e.toLowerCase();if(op(r)){const s=e[0]?.toUpperCase()+e.substring(1).replace(/([^\w])(\w)/g,(n,a,i)=>a+i.toUpperCase());for(const n of[e,t,e.toUpperCase(),s]){const a=r.get(n);if(a)return a}}for(const[s,n]of Object.entries(r))if(s.toLowerCase()===t)return Array.isArray(n)?(n.length<=1||console.warn(`Received ${n.length} entries for the ${e} header, using the first entry.`),n[0]):n};function Gr(r){return r!=null&&typeof r=="object"&&!Array.isArray(r)}class cp extends Io{constructor(e,t,s,n){super(e,t,s,n),this.data=s.data||[],this.object=s.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Ae extends Io{constructor(e,t,s,n){super(e,t,s,n),this.data=s.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){const e=this.getPaginatedItems();if(!e.length)return null;const t=e[e.length-1]?.id;return t?{params:{after:t}}:null}}class M{constructor(e){this._client=e}}let Do=class extends M{create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}},Dn=class extends M{constructor(){super(...arguments),this.completions=new Do(this._client)}};Dn.Completions=Do;class Mo extends M{create(e,t){return this._client.post("/audio/speech",{body:e,...t,__binaryResponse:!0})}}class Fo extends M{create(e,t){return this._client.post("/audio/transcriptions",Ut({body:e,...t}))}}class Uo extends M{create(e,t){return this._client.post("/audio/translations",Ut({body:e,...t}))}}class Ds extends M{constructor(){super(...arguments),this.transcriptions=new Fo(this._client),this.translations=new Uo(this._client),this.speech=new Mo(this._client)}}Ds.Transcriptions=Fo;Ds.Translations=Uo;Ds.Speech=Mo;class Mn extends M{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return he(e)?this.list({},e):this._client.getAPIList("/batches",Fn,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}}class Fn extends Ae{}Mn.BatchesPage=Fn;class Un extends M{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,s){return this._client.post(`/assistants/${e}`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}list(e={},t){return he(e)?this.list({},e):this._client.getAPIList("/assistants",Bn,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class Bn extends Ae{}Un.AssistantsPage=Bn;function Wa(r){return typeof r.parse=="function"}const Ot=r=>r?.role==="assistant",Bo=r=>r?.role==="function",Wo=r=>r?.role==="tool";var we=function(r,e,t,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(r,t):n?n.value=t:e.set(r,t),t},q=function(r,e,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(r):s?s.value:e.get(r)},wn,er,tr,ss,rs,sr,ns,De,as,yr,_r,Et,qo;class Vo{constructor(){wn.add(this),this.controller=new AbortController,er.set(this,void 0),tr.set(this,()=>{}),ss.set(this,()=>{}),rs.set(this,void 0),sr.set(this,()=>{}),ns.set(this,()=>{}),De.set(this,{}),as.set(this,!1),yr.set(this,!1),_r.set(this,!1),Et.set(this,!1),we(this,er,new Promise((e,t)=>{we(this,tr,e,"f"),we(this,ss,t,"f")}),"f"),we(this,rs,new Promise((e,t)=>{we(this,sr,e,"f"),we(this,ns,t,"f")}),"f"),q(this,er,"f").catch(()=>{}),q(this,rs,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},q(this,wn,"m",qo).bind(this))},0)}_connected(){this.ended||(q(this,tr,"f").call(this),this._emit("connect"))}get ended(){return q(this,as,"f")}get errored(){return q(this,yr,"f")}get aborted(){return q(this,_r,"f")}abort(){this.controller.abort()}on(e,t){return(q(this,De,"f")[e]||(q(this,De,"f")[e]=[])).push({listener:t}),this}off(e,t){const s=q(this,De,"f")[e];if(!s)return this;const n=s.findIndex(a=>a.listener===t);return n>=0&&s.splice(n,1),this}once(e,t){return(q(this,De,"f")[e]||(q(this,De,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,s)=>{we(this,Et,!0,"f"),e!=="error"&&this.once("error",s),this.once(e,t)})}async done(){we(this,Et,!0,"f"),await q(this,rs,"f")}_emit(e,...t){if(q(this,as,"f"))return;e==="end"&&(we(this,as,!0,"f"),q(this,sr,"f").call(this));const s=q(this,De,"f")[e];if(s&&(q(this,De,"f")[e]=s.filter(n=>!n.once),s.forEach(({listener:n})=>n(...t))),e==="abort"){const n=t[0];!q(this,Et,"f")&&!s?.length&&Promise.reject(n),q(this,ss,"f").call(this,n),q(this,ns,"f").call(this,n),this._emit("end");return}if(e==="error"){const n=t[0];!q(this,Et,"f")&&!s?.length&&Promise.reject(n),q(this,ss,"f").call(this,n),q(this,ns,"f").call(this,n),this._emit("end")}}_emitFinal(){}}er=new WeakMap,tr=new WeakMap,ss=new WeakMap,rs=new WeakMap,sr=new WeakMap,ns=new WeakMap,De=new WeakMap,as=new WeakMap,yr=new WeakMap,_r=new WeakMap,Et=new WeakMap,wn=new WeakSet,qo=function(e){if(we(this,yr,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new ke),e instanceof ke)return we(this,_r,!0,"f"),this._emit("abort",e);if(e instanceof C)return this._emit("error",e);if(e instanceof Error){const t=new C(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new C(String(e)))};function Ho(r){return r?.$brand==="auto-parseable-response-format"}function Ms(r){return r?.$brand==="auto-parseable-tool"}function lp(r,e){return!e||!zo(e)?{...r,choices:r.choices.map(t=>({...t,message:{...t.message,parsed:null,tool_calls:t.message.tool_calls??[]}}))}:Wn(r,e)}function Wn(r,e){const t=r.choices.map(s=>{if(s.finish_reason==="length")throw new So;if(s.finish_reason==="content_filter")throw new Eo;return{...s,message:{...s.message,tool_calls:s.message.tool_calls?.map(n=>dp(e,n))??[],parsed:s.message.content&&!s.message.refusal?up(e,s.message.content):null}}});return{...r,choices:t}}function up(r,e){return r.response_format?.type!=="json_schema"?null:r.response_format?.type==="json_schema"?"$parseRaw"in r.response_format?r.response_format.$parseRaw(e):JSON.parse(e):null}function dp(r,e){const t=r.tools?.find(s=>s.function?.name===e.function.name);return{...e,function:{...e.function,parsed_arguments:Ms(t)?t.$parseRaw(e.function.arguments):t?.function.strict?JSON.parse(e.function.arguments):null}}}function hp(r,e){if(!r)return!1;const t=r.tools?.find(s=>s.function?.name===e.function.name);return Ms(t)||t?.function.strict||!1}function zo(r){return Ho(r.response_format)?!0:r.tools?.some(e=>Ms(e)||e.type==="function"&&e.function.strict===!0)??!1}function fp(r){for(const e of r??[]){if(e.type!=="function")throw new C(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new C(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var ue=function(r,e,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(r):s?s.value:e.get(r)},ie,vn,wr,bn,xn,kn,Zo,jn;const qa=10;class Jo extends Vo{constructor(){super(...arguments),ie.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=e.choices[0]?.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),(Bo(e)||Wo(e))&&e.content)this._emit("functionCallResult",e.content);else if(Ot(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(Ot(e)&&e.tool_calls)for(const s of e.tool_calls)s.type==="function"&&this._emit("functionCall",s.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new C("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),ue(this,ie,"m",vn).call(this)}async finalMessage(){return await this.done(),ue(this,ie,"m",wr).call(this)}async finalFunctionCall(){return await this.done(),ue(this,ie,"m",bn).call(this)}async finalFunctionCallResult(){return await this.done(),ue(this,ie,"m",xn).call(this)}async totalUsage(){return await this.done(),ue(this,ie,"m",kn).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=ue(this,ie,"m",wr).call(this);t&&this._emit("finalMessage",t);const s=ue(this,ie,"m",vn).call(this);s&&this._emit("finalContent",s);const n=ue(this,ie,"m",bn).call(this);n&&this._emit("finalFunctionCall",n);const a=ue(this,ie,"m",xn).call(this);a!=null&&this._emit("finalFunctionCallResult",a),this._chatCompletions.some(i=>i.usage)&&this._emit("totalUsage",ue(this,ie,"m",kn).call(this))}async _createChatCompletion(e,t,s){const n=s?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),ue(this,ie,"m",Zo).call(this,t);const a=await e.chat.completions.create({...t,stream:!1},{...s,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Wn(a,t))}async _runChatCompletion(e,t,s){for(const n of t.messages)this._addMessage(n,!1);return await this._createChatCompletion(e,t,s)}async _runFunctions(e,t,s){const n="function",{function_call:a="auto",stream:i,...o}=t,l=typeof a!="string"&&a?.name,{maxChatCompletions:u=qa}=s||{},d={};for(const f of t.functions)d[f.name||f.function.name]=f;const h=t.functions.map(f=>({name:f.name||f.function.name,parameters:f.parameters,description:f.description}));for(const f of t.messages)this._addMessage(f,!1);for(let f=0;f<u;++f){const _=(await this._createChatCompletion(e,{...o,function_call:a,functions:h,messages:[...this.messages]},s)).choices[0]?.message;if(!_)throw new C("missing message in ChatCompletion response");if(!_.function_call)return;const{name:y,arguments:b}=_.function_call,O=d[y];if(O){if(l&&l!==y){const L=`Invalid function_call: ${JSON.stringify(y)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:n,name:y,content:L});continue}}else{const L=`Invalid function_call: ${JSON.stringify(y)}. Available options are: ${h.map(ne=>JSON.stringify(ne.name)).join(", ")}. Please try again`;this._addMessage({role:n,name:y,content:L});continue}let k;try{k=Wa(O)?await O.parse(b):b}catch(L){this._addMessage({role:n,name:y,content:L instanceof Error?L.message:String(L)});continue}const F=await O.function(k,this),R=ue(this,ie,"m",jn).call(this,F);if(this._addMessage({role:n,name:y,content:R}),l)return}}async _runTools(e,t,s){const n="tool",{tool_choice:a="auto",stream:i,...o}=t,l=typeof a!="string"&&a?.function?.name,{maxChatCompletions:u=qa}=s||{},d=t.tools.map(m=>{if(Ms(m)){if(!m.$callback)throw new C("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:m.$callback,name:m.function.name,description:m.function.description||"",parameters:m.function.parameters,parse:m.$parseRaw,strict:!0}}}return m}),h={};for(const m of d)m.type==="function"&&(h[m.function.name||m.function.function.name]=m.function);const f="tools"in t?d.map(m=>m.type==="function"?{type:"function",function:{name:m.function.name||m.function.function.name,parameters:m.function.parameters,description:m.function.description,strict:m.function.strict}}:m):void 0;for(const m of t.messages)this._addMessage(m,!1);for(let m=0;m<u;++m){const y=(await this._createChatCompletion(e,{...o,tool_choice:a,tools:f,messages:[...this.messages]},s)).choices[0]?.message;if(!y)throw new C("missing message in ChatCompletion response");if(!y.tool_calls?.length)return;for(const b of y.tool_calls){if(b.type!=="function")continue;const O=b.id,{name:k,arguments:F}=b.function,R=h[k];if(R){if(l&&l!==k){const ee=`Invalid tool_call: ${JSON.stringify(k)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:n,tool_call_id:O,content:ee});continue}}else{const ee=`Invalid tool_call: ${JSON.stringify(k)}. Available options are: ${Object.keys(h).map(K=>JSON.stringify(K)).join(", ")}. Please try again`;this._addMessage({role:n,tool_call_id:O,content:ee});continue}let L;try{L=Wa(R)?await R.parse(F):F}catch(ee){const K=ee instanceof Error?ee.message:String(ee);this._addMessage({role:n,tool_call_id:O,content:K});continue}const ne=await R.function(L,this),ae=ue(this,ie,"m",jn).call(this,ne);if(this._addMessage({role:n,tool_call_id:O,content:ae}),l)return}}}}ie=new WeakSet,vn=function(){return ue(this,ie,"m",wr).call(this).content??null},wr=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(Ot(t)){const{function_call:s,...n}=t,a={...n,content:t.content??null,refusal:t.refusal??null};return s&&(a.function_call=s),a}}throw new C("stream ended without producing a ChatCompletionMessage with role=assistant")},bn=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(Ot(t)&&t?.function_call)return t.function_call;if(Ot(t)&&t?.tool_calls?.length)return t.tool_calls.at(-1)?.function}},xn=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(Bo(t)&&t.content!=null||Wo(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(s=>s.role==="assistant"&&s.tool_calls?.some(n=>n.type==="function"&&n.id===t.tool_call_id)))return t.content}},kn=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},Zo=function(e){if(e.n!=null&&e.n>1)throw new C("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},jn=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Ts extends Jo{static runFunctions(e,t,s){const n=new Ts,a={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return n._run(()=>n._runFunctions(e,t,a)),n}static runTools(e,t,s){const n=new Ts,a={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runTools"}};return n._run(()=>n._runTools(e,t,a)),n}_addMessage(e,t=!0){super._addMessage(e,t),Ot(e)&&e.content&&this._emit("content",e.content)}}const Go=1,Yo=2,Ko=4,Xo=8,Qo=16,ec=32,tc=64,sc=128,rc=256,nc=sc|rc,ac=Qo|ec|nc|tc,ic=Go|Yo|ac,oc=Ko|Xo,mp=ic|oc,X={STR:Go,NUM:Yo,ARR:Ko,OBJ:Xo,NULL:Qo,BOOL:ec,NAN:tc,INFINITY:sc,MINUS_INFINITY:rc,INF:nc,SPECIAL:ac,ATOM:ic,COLLECTION:oc,ALL:mp};class pp extends Error{}class gp extends Error{}function yp(r,e=X.ALL){if(typeof r!="string")throw new TypeError(`expecting str, got ${typeof r}`);if(!r.trim())throw new Error(`${r} is empty`);return _p(r.trim(),e)}const _p=(r,e)=>{const t=r.length;let s=0;const n=f=>{throw new pp(`${f} at position ${s}`)},a=f=>{throw new gp(`${f} at position ${s}`)},i=()=>(h(),s>=t&&n("Unexpected end of input"),r[s]==='"'?o():r[s]==="{"?l():r[s]==="["?u():r.substring(s,s+4)==="null"||X.NULL&e&&t-s<4&&"null".startsWith(r.substring(s))?(s+=4,null):r.substring(s,s+4)==="true"||X.BOOL&e&&t-s<4&&"true".startsWith(r.substring(s))?(s+=4,!0):r.substring(s,s+5)==="false"||X.BOOL&e&&t-s<5&&"false".startsWith(r.substring(s))?(s+=5,!1):r.substring(s,s+8)==="Infinity"||X.INFINITY&e&&t-s<8&&"Infinity".startsWith(r.substring(s))?(s+=8,1/0):r.substring(s,s+9)==="-Infinity"||X.MINUS_INFINITY&e&&1<t-s&&t-s<9&&"-Infinity".startsWith(r.substring(s))?(s+=9,-1/0):r.substring(s,s+3)==="NaN"||X.NAN&e&&t-s<3&&"NaN".startsWith(r.substring(s))?(s+=3,NaN):d()),o=()=>{const f=s;let m=!1;for(s++;s<t&&(r[s]!=='"'||m&&r[s-1]==="\\");)m=r[s]==="\\"?!m:!1,s++;if(r.charAt(s)=='"')try{return JSON.parse(r.substring(f,++s-Number(m)))}catch(_){a(String(_))}else if(X.STR&e)try{return JSON.parse(r.substring(f,s-Number(m))+'"')}catch{return JSON.parse(r.substring(f,r.lastIndexOf("\\"))+'"')}n("Unterminated string literal")},l=()=>{s++,h();const f={};try{for(;r[s]!=="}";){if(h(),s>=t&&X.OBJ&e)return f;const m=o();h(),s++;try{const _=i();Object.defineProperty(f,m,{value:_,writable:!0,enumerable:!0,configurable:!0})}catch(_){if(X.OBJ&e)return f;throw _}h(),r[s]===","&&s++}}catch{if(X.OBJ&e)return f;n("Expected '}' at end of object")}return s++,f},u=()=>{s++;const f=[];try{for(;r[s]!=="]";)f.push(i()),h(),r[s]===","&&s++}catch{if(X.ARR&e)return f;n("Expected ']' at end of array")}return s++,f},d=()=>{if(s===0){r==="-"&&X.NUM&e&&n("Not sure what '-' is");try{return JSON.parse(r)}catch(m){if(X.NUM&e)try{return r[r.length-1]==="."?JSON.parse(r.substring(0,r.lastIndexOf("."))):JSON.parse(r.substring(0,r.lastIndexOf("e")))}catch{}a(String(m))}}const f=s;for(r[s]==="-"&&s++;r[s]&&!",]}".includes(r[s]);)s++;s==t&&!(X.NUM&e)&&n("Unterminated number literal");try{return JSON.parse(r.substring(f,s))}catch{r.substring(f,s)==="-"&&X.NUM&e&&n("Not sure what '-' is");try{return JSON.parse(r.substring(f,r.lastIndexOf("e")))}catch(_){a(String(_))}}},h=()=>{for(;s<t&&` 
\r	`.includes(r[s]);)s++};return i()},Va=r=>yp(r,X.ALL^X.NUM);var xt=function(r,e,t,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(r,t):n?n.value=t:e.set(r,t),t},U=function(r,e,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(r):s?s.value:e.get(r)},J,$e,kt,Ve,Yr,Js,Kr,Xr,Qr,Gs,en,Ha;class Ns extends Jo{constructor(e){super(),J.add(this),$e.set(this,void 0),kt.set(this,void 0),Ve.set(this,void 0),xt(this,$e,e,"f"),xt(this,kt,[],"f")}get currentChatCompletionSnapshot(){return U(this,Ve,"f")}static fromReadableStream(e){const t=new Ns(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,s){const n=new Ns(t);return n._run(()=>n._runChatCompletion(e,{...t,stream:!0},{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),n}async _createChatCompletion(e,t,s){super._createChatCompletion;const n=s?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),U(this,J,"m",Yr).call(this);const a=await e.chat.completions.create({...t,stream:!0},{...s,signal:this.controller.signal});this._connected();for await(const i of a)U(this,J,"m",Kr).call(this,i);if(a.controller.signal?.aborted)throw new ke;return this._addChatCompletion(U(this,J,"m",Gs).call(this))}async _fromReadableStream(e,t){const s=t?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),U(this,J,"m",Yr).call(this),this._connected();const n=Pe.fromReadableStream(e,this.controller);let a;for await(const i of n)a&&a!==i.id&&this._addChatCompletion(U(this,J,"m",Gs).call(this)),U(this,J,"m",Kr).call(this,i),a=i.id;if(n.controller.signal?.aborted)throw new ke;return this._addChatCompletion(U(this,J,"m",Gs).call(this))}[($e=new WeakMap,kt=new WeakMap,Ve=new WeakMap,J=new WeakSet,Yr=function(){this.ended||xt(this,Ve,void 0,"f")},Js=function(t){let s=U(this,kt,"f")[t.index];return s||(s={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},U(this,kt,"f")[t.index]=s,s)},Kr=function(t){if(this.ended)return;const s=U(this,J,"m",Ha).call(this,t);this._emit("chunk",t,s);for(const n of t.choices){const a=s.choices[n.index];n.delta.content!=null&&a.message?.role==="assistant"&&a.message?.content&&(this._emit("content",n.delta.content,a.message.content),this._emit("content.delta",{delta:n.delta.content,snapshot:a.message.content,parsed:a.message.parsed})),n.delta.refusal!=null&&a.message?.role==="assistant"&&a.message?.refusal&&this._emit("refusal.delta",{delta:n.delta.refusal,snapshot:a.message.refusal}),n.logprobs?.content!=null&&a.message?.role==="assistant"&&this._emit("logprobs.content.delta",{content:n.logprobs?.content,snapshot:a.logprobs?.content??[]}),n.logprobs?.refusal!=null&&a.message?.role==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:n.logprobs?.refusal,snapshot:a.logprobs?.refusal??[]});const i=U(this,J,"m",Js).call(this,a);a.finish_reason&&(U(this,J,"m",Qr).call(this,a),i.current_tool_call_index!=null&&U(this,J,"m",Xr).call(this,a,i.current_tool_call_index));for(const o of n.delta.tool_calls??[])i.current_tool_call_index!==o.index&&(U(this,J,"m",Qr).call(this,a),i.current_tool_call_index!=null&&U(this,J,"m",Xr).call(this,a,i.current_tool_call_index)),i.current_tool_call_index=o.index;for(const o of n.delta.tool_calls??[]){const l=a.message.tool_calls?.[o.index];l?.type&&(l?.type==="function"?this._emit("tool_calls.function.arguments.delta",{name:l.function?.name,index:o.index,arguments:l.function.arguments,parsed_arguments:l.function.parsed_arguments,arguments_delta:o.function?.arguments??""}):(l?.type,void 0))}}},Xr=function(t,s){if(U(this,J,"m",Js).call(this,t).done_tool_calls.has(s))return;const a=t.message.tool_calls?.[s];if(!a)throw new Error("no tool call snapshot");if(!a.type)throw new Error("tool call snapshot missing `type`");if(a.type==="function"){const i=U(this,$e,"f")?.tools?.find(o=>o.type==="function"&&o.function.name===a.function.name);this._emit("tool_calls.function.arguments.done",{name:a.function.name,index:s,arguments:a.function.arguments,parsed_arguments:Ms(i)?i.$parseRaw(a.function.arguments):i?.function.strict?JSON.parse(a.function.arguments):null})}else a.type},Qr=function(t){const s=U(this,J,"m",Js).call(this,t);if(t.message.content&&!s.content_done){s.content_done=!0;const n=U(this,J,"m",en).call(this);this._emit("content.done",{content:t.message.content,parsed:n?n.$parseRaw(t.message.content):null})}t.message.refusal&&!s.refusal_done&&(s.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),t.logprobs?.content&&!s.logprobs_content_done&&(s.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),t.logprobs?.refusal&&!s.logprobs_refusal_done&&(s.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},Gs=function(){if(this.ended)throw new C("stream has ended, this shouldn't happen");const t=U(this,Ve,"f");if(!t)throw new C("request ended without sending any chunks");return xt(this,Ve,void 0,"f"),xt(this,kt,[],"f"),wp(t,U(this,$e,"f"))},en=function(){const t=U(this,$e,"f")?.response_format;return Ho(t)?t:null},Ha=function(t){var s,n,a,i;let o=U(this,Ve,"f");const{choices:l,...u}=t;o?Object.assign(o,u):o=xt(this,Ve,{...u,choices:[]},"f");for(const{delta:d,finish_reason:h,index:f,logprobs:m=null,..._}of t.choices){let y=o.choices[f];if(y||(y=o.choices[f]={finish_reason:h,index:f,message:{},logprobs:m,..._}),m)if(!y.logprobs)y.logprobs=Object.assign({},m);else{const{content:ne,refusal:ae,...ee}=m;Object.assign(y.logprobs,ee),ne&&((s=y.logprobs).content??(s.content=[]),y.logprobs.content.push(...ne)),ae&&((n=y.logprobs).refusal??(n.refusal=[]),y.logprobs.refusal.push(...ae))}if(h&&(y.finish_reason=h,U(this,$e,"f")&&zo(U(this,$e,"f")))){if(h==="length")throw new So;if(h==="content_filter")throw new Eo}if(Object.assign(y,_),!d)continue;const{content:b,refusal:O,function_call:k,role:F,tool_calls:R,...L}=d;if(Object.assign(y.message,L),O&&(y.message.refusal=(y.message.refusal||"")+O),F&&(y.message.role=F),k&&(y.message.function_call?(k.name&&(y.message.function_call.name=k.name),k.arguments&&((a=y.message.function_call).arguments??(a.arguments=""),y.message.function_call.arguments+=k.arguments)):y.message.function_call=k),b&&(y.message.content=(y.message.content||"")+b,!y.message.refusal&&U(this,J,"m",en).call(this)&&(y.message.parsed=Va(y.message.content))),R){y.message.tool_calls||(y.message.tool_calls=[]);for(const{index:ne,id:ae,type:ee,function:K,...z}of R){const Z=(i=y.message.tool_calls)[ne]??(i[ne]={});Object.assign(Z,z),ae&&(Z.id=ae),ee&&(Z.type=ee),K&&(Z.function??(Z.function={name:K.name??"",arguments:""})),K?.name&&(Z.function.name=K.name),K?.arguments&&(Z.function.arguments+=K.arguments,hp(U(this,$e,"f"),Z)&&(Z.function.parsed_arguments=Va(Z.function.arguments)))}}}return o},Symbol.asyncIterator)](){const e=[],t=[];let s=!1;return this.on("chunk",n=>{const a=t.shift();a?a.resolve(n):e.push(n)}),this.on("end",()=>{s=!0;for(const n of t)n.resolve(void 0);t.length=0}),this.on("abort",n=>{s=!0;for(const a of t)a.reject(n);t.length=0}),this.on("error",n=>{s=!0;for(const a of t)a.reject(n);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((a,i)=>t.push({resolve:a,reject:i})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Pe(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function wp(r,e){const{id:t,choices:s,created:n,model:a,system_fingerprint:i,...o}=r,l={...o,id:t,choices:s.map(({message:u,finish_reason:d,index:h,logprobs:f,...m})=>{if(!d)throw new C(`missing finish_reason for choice ${h}`);const{content:_=null,function_call:y,tool_calls:b,...O}=u,k=u.role;if(!k)throw new C(`missing role for choice ${h}`);if(y){const{arguments:F,name:R}=y;if(F==null)throw new C(`missing function_call.arguments for choice ${h}`);if(!R)throw new C(`missing function_call.name for choice ${h}`);return{...m,message:{content:_,function_call:{arguments:F,name:R},role:k,refusal:u.refusal??null},finish_reason:d,index:h,logprobs:f}}return b?{...m,index:h,finish_reason:d,logprobs:f,message:{...O,role:k,content:_,refusal:u.refusal??null,tool_calls:b.map((F,R)=>{const{function:L,type:ne,id:ae,...ee}=F,{arguments:K,name:z,...Z}=L||{};if(ae==null)throw new C(`missing choices[${h}].tool_calls[${R}].id
${Ys(r)}`);if(ne==null)throw new C(`missing choices[${h}].tool_calls[${R}].type
${Ys(r)}`);if(z==null)throw new C(`missing choices[${h}].tool_calls[${R}].function.name
${Ys(r)}`);if(K==null)throw new C(`missing choices[${h}].tool_calls[${R}].function.arguments
${Ys(r)}`);return{...ee,id:ae,type:ne,function:{...Z,name:z,arguments:K}}})}}:{...m,message:{...O,content:_,role:k,refusal:u.refusal??null},finish_reason:d,index:h,logprobs:f}}),created:n,model:a,object:"chat.completion",...i?{system_fingerprint:i}:{}};return lp(l,e)}function Ys(r){return JSON.stringify(r)}class Rt extends Ns{static fromReadableStream(e){const t=new Rt(null);return t._run(()=>t._fromReadableStream(e)),t}static runFunctions(e,t,s){const n=new Rt(null),a={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return n._run(()=>n._runFunctions(e,t,a)),n}static runTools(e,t,s){const n=new Rt(t),a={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runTools"}};return n._run(()=>n._runTools(e,t,a)),n}}let cc=class extends M{parse(e,t){return fp(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t?.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(s=>Wn(s,e))}runFunctions(e,t){return e.stream?Rt.runFunctions(this._client,e,t):Ts.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?Rt.runTools(this._client,e,t):Ts.runTools(this._client,e,t)}stream(e,t){return Ns.createChatCompletion(this._client,e,t)}};class Sn extends M{constructor(){super(...arguments),this.completions=new cc(this._client)}}(function(r){r.Completions=cc})(Sn||(Sn={}));var j=function(r,e,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(r):s?s.value:e.get(r)},fe=function(r,e,t,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(r,t):n?n.value=t:e.set(r,t),t},te,En,Ce,rr,ve,ot,Tt,it,vr,pe,nr,ar,ds,is,os,za,Za,Ja,Ga,Ya,Ka,Xa;class je extends Vo{constructor(){super(...arguments),te.add(this),En.set(this,[]),Ce.set(this,{}),rr.set(this,{}),ve.set(this,void 0),ot.set(this,void 0),Tt.set(this,void 0),it.set(this,void 0),vr.set(this,void 0),pe.set(this,void 0),nr.set(this,void 0),ar.set(this,void 0),ds.set(this,void 0)}[(En=new WeakMap,Ce=new WeakMap,rr=new WeakMap,ve=new WeakMap,ot=new WeakMap,Tt=new WeakMap,it=new WeakMap,vr=new WeakMap,pe=new WeakMap,nr=new WeakMap,ar=new WeakMap,ds=new WeakMap,te=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let s=!1;return this.on("event",n=>{const a=t.shift();a?a.resolve(n):e.push(n)}),this.on("end",()=>{s=!0;for(const n of t)n.resolve(void 0);t.length=0}),this.on("abort",n=>{s=!0;for(const a of t)a.reject(n);t.length=0}),this.on("error",n=>{s=!0;for(const a of t)a.reject(n);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((a,i)=>t.push({resolve:a,reject:i})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new je;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){const s=t?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),this._connected();const n=Pe.fromReadableStream(e,this.controller);for await(const a of n)j(this,te,"m",is).call(this,a);if(n.controller.signal?.aborted)throw new ke;return this._addRun(j(this,te,"m",os).call(this))}toReadableStream(){return new Pe(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,s,n,a){const i=new je;return i._run(()=>i._runToolAssistantStream(e,t,s,n,{...a,headers:{...a?.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createToolAssistantStream(e,t,s,n,a){const i=a?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...n,stream:!0},l=await e.submitToolOutputs(t,s,o,{...a,signal:this.controller.signal});this._connected();for await(const u of l)j(this,te,"m",is).call(this,u);if(l.controller.signal?.aborted)throw new ke;return this._addRun(j(this,te,"m",os).call(this))}static createThreadAssistantStream(e,t,s){const n=new je;return n._run(()=>n._threadAssistantStream(e,t,{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),n}static createAssistantStream(e,t,s,n){const a=new je;return a._run(()=>a._runAssistantStream(e,t,s,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),a}currentEvent(){return j(this,nr,"f")}currentRun(){return j(this,ar,"f")}currentMessageSnapshot(){return j(this,ve,"f")}currentRunStepSnapshot(){return j(this,ds,"f")}async finalRunSteps(){return await this.done(),Object.values(j(this,Ce,"f"))}async finalMessages(){return await this.done(),Object.values(j(this,rr,"f"))}async finalRun(){if(await this.done(),!j(this,ot,"f"))throw Error("Final run was not received.");return j(this,ot,"f")}async _createThreadAssistantStream(e,t,s){const n=s?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort()));const a={...t,stream:!0},i=await e.createAndRun(a,{...s,signal:this.controller.signal});this._connected();for await(const o of i)j(this,te,"m",is).call(this,o);if(i.controller.signal?.aborted)throw new ke;return this._addRun(j(this,te,"m",os).call(this))}async _createAssistantStream(e,t,s,n){const a=n?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const i={...s,stream:!0},o=await e.create(t,i,{...n,signal:this.controller.signal});this._connected();for await(const l of o)j(this,te,"m",is).call(this,l);if(o.controller.signal?.aborted)throw new ke;return this._addRun(j(this,te,"m",os).call(this))}static accumulateDelta(e,t){for(const[s,n]of Object.entries(t)){if(!e.hasOwnProperty(s)){e[s]=n;continue}let a=e[s];if(a==null){e[s]=n;continue}if(s==="index"||s==="type"){e[s]=n;continue}if(typeof a=="string"&&typeof n=="string")a+=n;else if(typeof a=="number"&&typeof n=="number")a+=n;else if(Gr(a)&&Gr(n))a=this.accumulateDelta(a,n);else if(Array.isArray(a)&&Array.isArray(n)){if(a.every(i=>typeof i=="string"||typeof i=="number")){a.push(...n);continue}for(const i of n){if(!Gr(i))throw new Error(`Expected array delta entry to be an object but got: ${i}`);const o=i.index;if(o==null)throw console.error(i),new Error("Expected array delta entry to have an `index` property");if(typeof o!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${o}`);const l=a[o];l==null?a.push(i):a[o]=this.accumulateDelta(l,i)}continue}else throw Error(`Unhandled record type: ${s}, deltaValue: ${n}, accValue: ${a}`);e[s]=a}return e}_addRun(e){return e}async _threadAssistantStream(e,t,s){return await this._createThreadAssistantStream(t,e,s)}async _runAssistantStream(e,t,s,n){return await this._createAssistantStream(t,e,s,n)}async _runToolAssistantStream(e,t,s,n,a){return await this._createToolAssistantStream(s,e,t,n,a)}}is=function(e){if(!this.ended)switch(fe(this,nr,e,"f"),j(this,te,"m",Ja).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":j(this,te,"m",Xa).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":j(this,te,"m",Za).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":j(this,te,"m",za).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},os=function(){if(this.ended)throw new C("stream has ended, this shouldn't happen");if(!j(this,ot,"f"))throw Error("Final run has not been received");return j(this,ot,"f")},za=function(e){const[t,s]=j(this,te,"m",Ya).call(this,e,j(this,ve,"f"));fe(this,ve,t,"f"),j(this,rr,"f")[t.id]=t;for(const n of s){const a=t.content[n.index];a?.type=="text"&&this._emit("textCreated",a.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const n of e.data.delta.content){if(n.type=="text"&&n.text){let a=n.text,i=t.content[n.index];if(i&&i.type=="text")this._emit("textDelta",a,i.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(n.index!=j(this,Tt,"f")){if(j(this,it,"f"))switch(j(this,it,"f").type){case"text":this._emit("textDone",j(this,it,"f").text,j(this,ve,"f"));break;case"image_file":this._emit("imageFileDone",j(this,it,"f").image_file,j(this,ve,"f"));break}fe(this,Tt,n.index,"f")}fe(this,it,t.content[n.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(j(this,Tt,"f")!==void 0){const n=e.data.content[j(this,Tt,"f")];if(n)switch(n.type){case"image_file":this._emit("imageFileDone",n.image_file,j(this,ve,"f"));break;case"text":this._emit("textDone",n.text,j(this,ve,"f"));break}}j(this,ve,"f")&&this._emit("messageDone",e.data),fe(this,ve,void 0,"f")}},Za=function(e){const t=j(this,te,"m",Ga).call(this,e);switch(fe(this,ds,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const s=e.data.delta;if(s.step_details&&s.step_details.type=="tool_calls"&&s.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const a of s.step_details.tool_calls)a.index==j(this,vr,"f")?this._emit("toolCallDelta",a,t.step_details.tool_calls[a.index]):(j(this,pe,"f")&&this._emit("toolCallDone",j(this,pe,"f")),fe(this,vr,a.index,"f"),fe(this,pe,t.step_details.tool_calls[a.index],"f"),j(this,pe,"f")&&this._emit("toolCallCreated",j(this,pe,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":fe(this,ds,void 0,"f"),e.data.step_details.type=="tool_calls"&&j(this,pe,"f")&&(this._emit("toolCallDone",j(this,pe,"f")),fe(this,pe,void 0,"f")),this._emit("runStepDone",e.data,t);break}},Ja=function(e){j(this,En,"f").push(e),this._emit("event",e)},Ga=function(e){switch(e.event){case"thread.run.step.created":return j(this,Ce,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=j(this,Ce,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let s=e.data;if(s.delta){const n=je.accumulateDelta(t,s.delta);j(this,Ce,"f")[e.data.id]=n}return j(this,Ce,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":j(this,Ce,"f")[e.data.id]=e.data;break}if(j(this,Ce,"f")[e.data.id])return j(this,Ce,"f")[e.data.id];throw new Error("No snapshot available")},Ya=function(e,t){let s=[];switch(e.event){case"thread.message.created":return[e.data,s];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let n=e.data;if(n.delta.content)for(const a of n.delta.content)if(a.index in t.content){let i=t.content[a.index];t.content[a.index]=j(this,te,"m",Ka).call(this,a,i)}else t.content[a.index]=a,s.push(a);return[t,s];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,s];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Ka=function(e,t){return je.accumulateDelta(t,e)},Xa=function(e){switch(fe(this,ar,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":fe(this,ot,e.data,"f"),j(this,pe,"f")&&(this._emit("toolCallDone",j(this,pe,"f")),fe(this,pe,void 0,"f"));break}};class qn extends M{create(e,t,s){return this._client.post(`/threads/${e}/messages`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}retrieve(e,t,s){return this._client.get(`/threads/${e}/messages/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}update(e,t,s,n){return this._client.post(`/threads/${e}/messages/${t}`,{body:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e,t={},s){return he(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,Vn,{query:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}del(e,t,s){return this._client.delete(`/threads/${e}/messages/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}}class Vn extends Ae{}qn.MessagesPage=Vn;class Hn extends M{retrieve(e,t,s,n={},a){return he(n)?this.retrieve(e,t,s,{},n):this._client.get(`/threads/${e}/runs/${t}/steps/${s}`,{query:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a?.headers}})}list(e,t,s={},n){return he(s)?this.list(e,t,{},s):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,zn,{query:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}class zn extends Ae{}Hn.RunStepsPage=zn;class Fs extends M{constructor(){super(...arguments),this.steps=new Hn(this._client)}create(e,t,s){const{include:n,...a}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:n},body:a,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers},stream:t.stream??!1})}retrieve(e,t,s){return this._client.get(`/threads/${e}/runs/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}update(e,t,s,n){return this._client.post(`/threads/${e}/runs/${t}`,{body:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e,t={},s){return he(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,Zn,{query:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}cancel(e,t,s){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}async createAndPoll(e,t,s){const n=await this.create(e,t,s);return await this.poll(e,n.id,s)}createAndStream(e,t,s){return je.createAssistantStream(e,this._client.beta.threads.runs,t,s)}async poll(e,t,s){const n={...s?.headers,"X-Stainless-Poll-Helper":"true"};for(s?.pollIntervalMs&&(n["X-Stainless-Custom-Poll-Interval"]=s.pollIntervalMs.toString());;){const{data:a,response:i}=await this.retrieve(e,t,{...s,headers:{...s?.headers,...n}}).withResponse();switch(a.status){case"queued":case"in_progress":case"cancelling":let o=5e3;if(s?.pollIntervalMs)o=s.pollIntervalMs;else{const l=i.headers.get("openai-poll-after-ms");if(l){const u=parseInt(l);isNaN(u)||(o=u)}}await Ls(o);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return a}}}stream(e,t,s){return je.createAssistantStream(e,this._client.beta.threads.runs,t,s)}submitToolOutputs(e,t,s,n){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers},stream:s.stream??!1})}async submitToolOutputsAndPoll(e,t,s,n){const a=await this.submitToolOutputs(e,t,s,n);return await this.poll(e,a.id,n)}submitToolOutputsStream(e,t,s,n){return je.createToolAssistantStream(e,t,this._client.beta.threads.runs,s,n)}}class Zn extends Ae{}Fs.RunsPage=Zn;Fs.Steps=Hn;Fs.RunStepsPage=zn;class qt extends M{constructor(){super(...arguments),this.runs=new Fs(this._client),this.messages=new qn(this._client)}create(e={},t){return he(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,s){return this._client.post(`/threads/${e}`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){const s=await this.createAndRun(e,t);return await this.runs.poll(s.thread_id,s.id,t)}createAndRunStream(e,t){return je.createThreadAssistantStream(e,this._client.beta.threads,t)}}qt.Runs=Fs;qt.RunsPage=Zn;qt.Messages=qn;qt.MessagesPage=Vn;const vp=async r=>{const e=await Promise.allSettled(r),t=e.filter(n=>n.status==="rejected");if(t.length){for(const n of t)console.error(n.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const s=[];for(const n of e)n.status==="fulfilled"&&s.push(n.value);return s};let Jn=class extends M{create(e,t,s){return this._client.post(`/vector_stores/${e}/files`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}retrieve(e,t,s){return this._client.get(`/vector_stores/${e}/files/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}list(e,t={},s){return he(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,$r,{query:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}del(e,t,s){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}async createAndPoll(e,t,s){const n=await this.create(e,t,s);return await this.poll(e,n.id,s)}async poll(e,t,s){const n={...s?.headers,"X-Stainless-Poll-Helper":"true"};for(s?.pollIntervalMs&&(n["X-Stainless-Custom-Poll-Interval"]=s.pollIntervalMs.toString());;){const a=await this.retrieve(e,t,{...s,headers:n}).withResponse(),i=a.data;switch(i.status){case"in_progress":let o=5e3;if(s?.pollIntervalMs)o=s.pollIntervalMs;else{const l=a.response.headers.get("openai-poll-after-ms");if(l){const u=parseInt(l);isNaN(u)||(o=u)}}await Ls(o);break;case"failed":case"completed":return i}}}async upload(e,t,s){const n=await this._client.files.create({file:t,purpose:"assistants"},s);return this.create(e,{file_id:n.id},s)}async uploadAndPoll(e,t,s){const n=await this.upload(e,t,s);return await this.poll(e,n.id,s)}};class $r extends Ae{}Jn.VectorStoreFilesPage=$r;class lc extends M{create(e,t,s){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}retrieve(e,t,s){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}cancel(e,t,s){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}async createAndPoll(e,t,s){const n=await this.create(e,t);return await this.poll(e,n.id,s)}listFiles(e,t,s={},n){return he(s)?this.listFiles(e,t,{},s):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,$r,{query:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async poll(e,t,s){const n={...s?.headers,"X-Stainless-Poll-Helper":"true"};for(s?.pollIntervalMs&&(n["X-Stainless-Custom-Poll-Interval"]=s.pollIntervalMs.toString());;){const{data:a,response:i}=await this.retrieve(e,t,{...s,headers:n}).withResponse();switch(a.status){case"in_progress":let o=5e3;if(s?.pollIntervalMs)o=s.pollIntervalMs;else{const l=i.headers.get("openai-poll-after-ms");if(l){const u=parseInt(l);isNaN(u)||(o=u)}}await Ls(o);break;case"failed":case"cancelled":case"completed":return a}}}async uploadAndPoll(e,{files:t,fileIds:s=[]},n){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const a=n?.maxConcurrency??5,i=Math.min(a,t.length),o=this._client,l=t.values(),u=[...s];async function d(f){for(let m of f){const _=await o.files.create({file:m,purpose:"assistants"},n);u.push(_.id)}}const h=Array(i).fill(l).map(d);return await vp(h),await this.createAndPoll(e,{file_ids:u})}}class Vt extends M{constructor(){super(...arguments),this.files=new Jn(this._client),this.fileBatches=new lc(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,s){return this._client.post(`/vector_stores/${e}`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}list(e={},t){return he(e)?this.list({},e):this._client.getAPIList("/vector_stores",Gn,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class Gn extends Ae{}Vt.VectorStoresPage=Gn;Vt.Files=Jn;Vt.VectorStoreFilesPage=$r;Vt.FileBatches=lc;class yt extends M{constructor(){super(...arguments),this.vectorStores=new Vt(this._client),this.chat=new Sn(this._client),this.assistants=new Un(this._client),this.threads=new qt(this._client)}}yt.VectorStores=Vt;yt.VectorStoresPage=Gn;yt.Assistants=Un;yt.AssistantsPage=Bn;yt.Threads=qt;class uc extends M{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}class dc extends M{create(e,t){return this._client.post("/embeddings",{body:e,...t})}}class Yn extends M{create(e,t){return this._client.post("/files",Ut({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return he(e)?this.list({},e):this._client.getAPIList("/files",Kn,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/json",...t?.headers}})}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:s=30*60*1e3}={}){const n=new Set(["processed","error","deleted"]),a=Date.now();let i=await this.retrieve(e);for(;!i.status||!n.has(i.status);)if(await Ls(t),i=await this.retrieve(e),Date.now()-a>s)throw new Ln({message:`Giving up on waiting for file ${e} to finish processing after ${s} milliseconds.`});return i}}class Kn extends Ae{}Yn.FileObjectsPage=Kn;class Xn extends M{list(e,t={},s){return he(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,Qn,{query:t,...s})}}class Qn extends Ae{}Xn.FineTuningJobCheckpointsPage=Qn;class Ht extends M{constructor(){super(...arguments),this.checkpoints=new Xn(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return he(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",ea,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},s){return he(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,ta,{query:t,...s})}}class ea extends Ae{}class ta extends Ae{}Ht.FineTuningJobsPage=ea;Ht.FineTuningJobEventsPage=ta;Ht.Checkpoints=Xn;Ht.FineTuningJobCheckpointsPage=Qn;class Us extends M{constructor(){super(...arguments),this.jobs=new Ht(this._client)}}Us.Jobs=Ht;Us.FineTuningJobsPage=ea;Us.FineTuningJobEventsPage=ta;class hc extends M{createVariation(e,t){return this._client.post("/images/variations",Ut({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",Ut({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}class sa extends M{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",ra,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}class ra extends cp{}sa.ModelsPage=ra;class fc extends M{create(e,t){return this._client.post("/moderations",{body:e,...t})}}class mc extends M{create(e,t,s){return this._client.post(`/uploads/${e}/parts`,Ut({body:t,...s}))}}class na extends M{constructor(){super(...arguments),this.parts=new mc(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,s){return this._client.post(`/uploads/${e}/complete`,{body:t,...s})}}na.Parts=mc;var pc;class $ extends Gm{constructor({baseURL:e=Zs("OPENAI_BASE_URL"),apiKey:t=Zs("OPENAI_API_KEY"),organization:s=Zs("OPENAI_ORG_ID")??null,project:n=Zs("OPENAI_PROJECT_ID")??null,...a}={}){if(t===void 0)throw new C("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const i={apiKey:t,organization:s,project:n,...a,baseURL:e||"https://api.openai.com/v1"};if(!i.dangerouslyAllowBrowser&&ip())throw new C(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:i.baseURL,timeout:i.timeout??6e5,httpAgent:i.httpAgent,maxRetries:i.maxRetries,fetch:i.fetch}),this.completions=new uc(this),this.chat=new Dn(this),this.embeddings=new dc(this),this.files=new Yn(this),this.images=new hc(this),this.audio=new Ds(this),this.moderations=new fc(this),this.models=new sa(this),this.fineTuning=new Us(this),this.beta=new yt(this),this.batches=new Mn(this),this.uploads=new na(this),this._options=i,this.apiKey=t,this.organization=s,this.project=n}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return Om(e,{arrayFormat:"brackets"})}}pc=$;$.OpenAI=pc;$.DEFAULT_TIMEOUT=6e5;$.OpenAIError=C;$.APIError=re;$.APIConnectionError=Or;$.APIConnectionTimeoutError=Ln;$.APIUserAbortError=ke;$.NotFoundError=vo;$.ConflictError=bo;$.RateLimitError=ko;$.BadRequestError=yo;$.AuthenticationError=_o;$.InternalServerError=jo;$.PermissionDeniedError=wo;$.UnprocessableEntityError=xo;$.toFile=Co;$.fileFromPath=po;$.Completions=uc;$.Chat=Dn;$.Embeddings=dc;$.Files=Yn;$.FileObjectsPage=Kn;$.Images=hc;$.Audio=Ds;$.Moderations=fc;$.Models=sa;$.ModelsPage=ra;$.FineTuning=Us;$.Beta=yt;$.Batches=Mn;$.BatchesPage=Fn;$.Uploads=na;const It={GPT_4:"gpt-4",GPT_4_TURBO:"gpt-4-turbo-preview",GPT_3_5_TURBO:"gpt-3.5-turbo"},bp=It.GPT_4,xp={[It.GPT_4]:{maxTokens:4e3,temperature:.7,presencePenalty:.1,frequencyPenalty:.1},[It.GPT_4_TURBO]:{maxTokens:4e3,temperature:.7,presencePenalty:.1,frequencyPenalty:.1},[It.GPT_3_5_TURBO]:{maxTokens:2e3,temperature:.7,presencePenalty:0,frequencyPenalty:0}},kp={CV_ANALYSIS:`You are an expert HR professional and technical recruiter with deep experience in talent assessment.
Your task is to provide a comprehensive analysis of a candidate's CV against a job description.

Analyze for:
1. Technical Skills Match
2. Experience Alignment
3. Cultural Fit Indicators
4. Growth Potential
5. Risk Factors

Format your response exactly as follows:

FIT_SCORE: [1-10]
VERDICT: [GOOD_FIT|NEEDS_CONSIDERATION|BAD_FIT]

REASONING:
- [Key point 1]
- [Key point 2]
...

TECHNICAL_SKILLS:
- [Skill]: [Detailed assessment]
...

RISK_FACTORS:
- [Risk 1]
- [Risk 2]
...

GROWTH_POTENTIAL:
Areas:
- [Area 1]
- [Area 2]
...
Recommendations:
- [Recommendation 1]
- [Recommendation 2]
...

INTERVIEW_PLAN:
[Section Name] ([Duration] minutes):
Q: [Question]
Follow-up: [Follow-up question]
Red Flags: [What to watch out for]
Green Flags: [Positive indicators]
...`},jp="your-production-openai-key",Sp=new $({apiKey:jp,dangerouslyAllowBrowser:!0});async function Ep(r,e,t=bp){try{const s=xp[t];if(!Object.values(It).includes(t))throw new Error(`Invalid model. Must be one of: ${Object.values(It).join(", ")}`);const a=(await Sp.chat.completions.create({model:t,messages:[{role:"system",content:kp.CV_ANALYSIS},{role:"user",content:`CV:
${r}

Job Description:
${e}`}],...s})).choices[0]?.message?.content;if(!a)throw new Error("No response from OpenAI");return a}catch(s){throw s instanceof Error?new Ue(s.message,500):new Ue("Failed to analyze CV",500)}}function Ap(r){const e=r.match(/FIT_SCORE:\s*(\d+)/i),t=r.match(/VERDICT:\s*(GOOD_FIT|NEEDS_CONSIDERATION|BAD_FIT)/i),s=r.match(/REASONING:([\s\S]*?)(?=TECHNICAL_SKILLS:)/i),n=r.match(/TECHNICAL_SKILLS:([\s\S]*?)(?=RISK_FACTORS:)/i),a=r.match(/RISK_FACTORS:([\s\S]*?)(?=GROWTH_POTENTIAL:)/i),i=r.match(/GROWTH_POTENTIAL:([\s\S]*?)(?=INTERVIEW_PLAN:)/i),o=r.match(/INTERVIEW_PLAN:([\s\S]*$)/i);if(!e||!t||!s||!o)throw new Error("Invalid response format from OpenAI");const l=h=>h.split(`
`).map(f=>f.trim()).filter(f=>f.startsWith("-")).map(f=>f.slice(1).trim()),u=h=>{const f=h.match(/Areas:([\s\S]*?)(?=Recommendations:)/i)?.[1]||"",m=h.match(/Recommendations:([\s\S]*$)/i)?.[1]||"";return{areas:l(f),recommendations:l(m)}},d=h=>h.split(`
`).map(f=>f.trim()).filter(f=>f.startsWith("-")).map(f=>{const[m,_]=f.slice(1).split(":").map(y=>y.trim());return{name:m,proficiency:Tp(_),assessment:_}});return{fit_score:parseInt(e[1],10),verdict:t[1],reasoning:l(s[1]),technical_skills:d(n?.[1]||""),risk_factors:l(a?.[1]||""),growth_potential:u(i?.[1]||""),interview_plan:o[1].trim(),cv_summary:"",job_requirements:"",questions_used:[],suggestions:[],status:"pending"}}function Tp(r){const e={expert:90,advanced:80,strong:75,good:70,intermediate:60,basic:40,limited:30,beginner:20},t=r.toLowerCase();for(const[s,n]of Object.entries(e))if(t.includes(s))return n;return 50}const aa={FREE:4,PRO:1e3},Qa={WARNING:.8,CRITICAL:.95};function Np(r,e){const t=performance.now();return r().finally(()=>{const s=performance.now()-t;hs.trackEvent("performance_measure",{operation:e,duration_ms:Math.round(s)})})}async function Cp({candidateId:r,jobId:e}){return Np(async()=>{try{const[t,s]=await Promise.all([H.from("candidates").select("*").eq("id",r).single(),H.from("jobs").select("*").eq("id",e).single()]);if(t.error)throw new Error("Candidate not found");if(s.error)throw new Error("Job not found");const n=await Ep(t.data.cv_text,s.data.jd_text),a=Ap(n),{data:i,error:o}=await H.from("analysis").insert([{candidate_id:r,job_id:e,...a,created_at:new Date().toISOString()}]).select().single();if(o)throw o;return i}catch(t){throw Cr(t)}},"analyze_candidate_job")}async function Pp(r){const{data:e,error:t}=await H.from("analysis").select("*").eq("id",r).single();if(t)throw new Ue("Analysis not found",404);return e}async function Op(){const{data:r,error:e}=await H.from("analysis").select("*").order("created_at",{ascending:!1});if(e)throw new Ue("Failed to fetch analyses",500);return r||[]}async function Rp(r){try{const{data:e,error:t}=await H.from("subscriptions").select("*").eq("user_id",r).maybeSingle();if(t&&t.code!=="PGRST116")throw t;return e?{status:e.status,plan:e.plan,analysisCount:e.analysis_count,currentPeriodEnd:e.current_period_end}:{status:"active",plan:"free",analysisCount:0,currentPeriodEnd:new Date(Date.now()+30*24*60*60*1e3).toISOString()}}catch(e){return Cr(e),{status:"active",plan:"free",analysisCount:0}}}async function Ip(r){const e=aa[r.plan];return Math.max(0,e-r.analysisCount)}function $p(r){return r.status!=="active"?!1:r.analysisCount<aa[r.plan]}var gc="https://js.stripe.com/v3",Lp=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,ei="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",Dp=function(){for(var e=document.querySelectorAll('script[src^="'.concat(gc,'"]')),t=0;t<e.length;t++){var s=e[t];if(Lp.test(s.src))return s}return null},ti=function(e){var t="",s=document.createElement("script");s.src="".concat(gc).concat(t);var n=document.head||document.body;if(!n)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return n.appendChild(s),s},Mp=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"2.4.0",startTime:t})},Kt=null,Ks=null,Xs=null,Fp=function(e){return function(){e(new Error("Failed to load Stripe.js"))}},Up=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}},Bp=function(e){return Kt!==null?Kt:(Kt=new Promise(function(t,s){if(typeof window>"u"||typeof document>"u"){t(null);return}if(window.Stripe&&e&&console.warn(ei),window.Stripe){t(window.Stripe);return}try{var n=Dp();if(n&&e)console.warn(ei);else if(!n)n=ti(e);else if(n&&Xs!==null&&Ks!==null){var a;n.removeEventListener("load",Xs),n.removeEventListener("error",Ks),(a=n.parentNode)===null||a===void 0||a.removeChild(n),n=ti(e)}Xs=Up(t,s),Ks=Fp(s),n.addEventListener("load",Xs),n.addEventListener("error",Ks)}catch(i){s(i);return}}),Kt.catch(function(t){return Kt=null,Promise.reject(t)}))},Wp=function(e,t,s){if(e===null)return null;var n=e.apply(void 0,t);return Mp(n,s),n},Xt,yc=!1,_c=function(){return Xt||(Xt=Bp(null).catch(function(e){return Xt=null,Promise.reject(e)}),Xt)};Promise.resolve().then(function(){return _c()}).catch(function(r){yc||console.warn(r)});var ia=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];yc=!0;var n=Date.now();return _c().then(function(a){return Wp(a,t,n)})};const qp="your-production-stripe-key";ia(qp);function Vp(){const[r,e]=p.useState(null),{isLoading:t,withLoading:s}=xm(),{addToast:n}=ao(),a=async i=>{try{const o=await $d({name:i.candidateName,cv_text:i.cvText,created_at:new Date().toISOString()}),l=await rf({title:i.jobTitle,description:i.jobDescription,created_at:new Date().toISOString()}),u=await Cp({candidateId:o.id,jobId:l.id});return e(u),n("Analysis completed successfully","success"),u}catch(o){throw n(o instanceof Error?o.message:"Failed to analyze","error"),o}};return{analysis:r,isLoading:t,analyze:i=>s(a(i))}}Y.string().email("Invalid email address");Y.string().min(8,"Password must be at least 8 characters");const si=Y.object({name:Y.string().min(1,"Name is required"),cv_text:Y.string().min(100,"CV text must be at least 100 characters")}),ri=Y.object({title:Y.string().min(1,"Job title is required"),jd_text:Y.string().min(100,"Job description must be at least 100 characters")});Y.object({cvText:Y.string().min(100,"CV text must be at least 100 characters"),jobDescription:Y.string().min(100,"Job description must be at least 100 characters")});Y.object({plan:Y.enum(["free","pro"]),status:Y.enum(["active","trialing","past_due","canceled"]),analysisCount:Y.number().min(0)});const Hp=Y.object({candidateName:si.shape.name,cvText:si.shape.cv_text,jobTitle:ri.shape.title,jobDescription:ri.shape.jd_text}),zp={candidateName:"",cvText:"",jobTitle:"",jobDescription:""};function Zp(){const{analyze:r,analysis:e,isLoading:t}=Vp();return{...bm({initialValues:zp,validationSchema:Hp,onSubmit:async n=>{await r({candidateName:n.candidateName,cvText:n.cvText,jobTitle:n.jobTitle,jobDescription:n.jobDescription})}}),analysis:e,isLoading:t}}const Jp="your-production-stripe-key",Gp=ia(Jp);async function Yp(r){const e=await fetch(`/api/subscription-status/${r}`);if(!e.ok)throw new Error("Failed to get subscription status");const t=await e.json();return{status:t.status,plan:t.plan,analysisCount:t.analysisCount}}const An={PRICES:{PRO:"price_mock_monthly_pro_plan"},MAX_FREE_ANALYSES:4};function Kp(){const{session:r}=Os(),[e,t]=p.useState(null),[s,n]=p.useState(!0);return p.useEffect(()=>{async function o(){if(!r?.user){t(null),n(!1);return}try{const l=await Yp(r.user.id);t({...l,id:r.user.id,status:l.status,plan:l.plan})}catch(l){console.error("Error fetching subscription:",l)}finally{n(!1)}}o()},[r]),{subscription:e,loading:s,canAnalyze:()=>e?e.plan==="pro"?!0:e.analysisCount<An.MAX_FREE_ANALYSES:!1,remainingAnalyses:()=>e?e.plan==="pro"?1/0:Math.max(0,An.MAX_FREE_ANALYSES-e.analysisCount):0}}function Xp(){const[r,e]=p.useState(null),[t,s]=p.useState(!0);return p.useEffect(()=>{H.auth.getSession().then(({data:{session:i}})=>{e(i),s(!1)});const{data:{subscription:a}}=H.auth.onAuthStateChange((i,o)=>{e(o),o&&hs.trackEvent("user_signed_in")});return()=>a.unsubscribe()},[]),{session:r,loading:t,signOut:async()=>{try{const{error:a}=await H.auth.signOut();if(a)throw a;hs.trackEvent("user_signed_out")}catch(a){Cr(a)}}}}function Qp(){const{session:r}=Xp(),[e,t]=p.useState(null),[s,n]=p.useState(!0);return p.useEffect(()=>{async function a(){if(!r?.user){t(null),n(!1);return}try{const i=await Rp(r.user.id);t(i)}catch(i){console.error("Error fetching subscription:",i)}finally{n(!1)}}a()},[r]),{subscription:e,loading:s,canAnalyze:e?$p(e):!1,remainingAnalyses:e?Ip(e):0}}function eg(r){const e=aa[r.plan.toUpperCase()],t=r.analysisCount,s=Math.max(0,e-t),n=t/e*100;return{limit:e,used:t,remaining:s,usagePercentage:n,isWarning:n>=Qa.WARNING*100,isCritical:n>=Qa.CRITICAL*100}}function tg(){const{subscription:r}=Qp();if(!r)return null;const e=eg(r),t=e.isCritical?"bg-red-600":e.isWarning?"bg-yellow-500":"bg-green-600";return c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsxs("span",{className:"text-gray-600",children:[e.used," / ",e.limit," analyses used"]}),c.jsxs("span",{className:"text-gray-600",children:[e.remaining," remaining"]})]}),c.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:c.jsx("div",{className:`h-full ${t} transition-all duration-500`,style:{width:`${Math.min(100,e.usagePercentage)}%`}})}),(e.isWarning||e.isCritical)&&c.jsx("p",{className:`text-sm ${e.isCritical?"text-red-600":"text-yellow-600"}`,children:e.isCritical?"You're almost out of analyses. Upgrade to continue analyzing.":"You're approaching your analysis limit. Consider upgrading soon."})]})}function sg(){const{values:r,errors:e,setFieldValue:t,handleSubmit:s,analysis:n,isLoading:a}=Zp(),{canAnalyze:i}=Kp();return i()?c.jsxs("div",{className:"space-y-8",children:[c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"New Analysis"}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Upload a CV and job description to get started"})]}),c.jsx(tg,{})]}),c.jsxs("form",{onSubmit:s,className:"space-y-8",children:[c.jsx(sf,{candidateName:r.candidateName,cvText:r.cvText,onNameChange:o=>t("candidateName",o),onCvTextChange:o=>t("cvText",o),errors:{name:e.candidateName,cvText:e.cvText}}),c.jsx(of,{jobTitle:r.jobTitle,jobDescription:r.jobDescription,onTitleChange:o=>t("jobTitle",o),onDescriptionChange:o=>t("jobDescription",o),errors:{title:e.jobTitle,description:e.jobDescription}}),c.jsxs("div",{className:"flex justify-end space-x-4",children:[c.jsx(ut,{type:"button",variant:"secondary",onClick:()=>{t("candidateName",""),t("cvText",""),t("jobTitle",""),t("jobDescription","")},disabled:a,children:"Clear Form"}),c.jsx(ut,{type:"submit",isLoading:a,children:"Analyze CV"})]})]}),n&&c.jsx("div",{className:"mt-8",children:c.jsx(Ji,{analysis:n})})]}):c.jsxs("div",{className:"text-center py-12",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Upgrade Your Plan"}),c.jsx("p",{className:"text-gray-600 mb-6",children:"You've reached the limit of your free analyses. Upgrade to Pro for unlimited analyses."}),c.jsx(se,{to:"/pricing",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:"View Pricing Plans"})]})}function wc(){const{data:r,isLoading:e,error:t,refetch:s}=Rs(Op);return{analyses:r||[],isLoading:e,error:t,refetch:s}}function rg({analysis:r,onClick:e}){const t=s=>s>=8?"bg-green-100 text-green-800":s>=6?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800";return c.jsx("div",{onClick:e,className:`p-4 border rounded-lg ${e?"hover:bg-gray-50 cursor-pointer":""} transition-colors`,children:c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"font-medium",children:"Candidate Analysis"}),c.jsx("p",{className:"text-sm text-gray-500",children:new Date(r.created_at).toLocaleDateString()})]}),c.jsxs("div",{className:`px-2 py-1 rounded text-sm ${t(r.fit_score)}`,children:["Score: ",r.fit_score,"/10"]})]})})}function ng(r){const[e,t]=p.useState(!1),{data:s,isLoading:n,error:a,refetch:i}=Rs(()=>Pp(r),{enabled:!!r});return{analysis:s,isLoading:n,error:a,refetch:i,isExpanded:e,toggleExpanded:()=>t(o=>!o)}}function ag({analysisId:r,onClose:e}){const{analysis:t,isLoading:s,error:n}=ng(r);return s?c.jsx("div",{className:"flex justify-center py-12",children:c.jsx(We,{size:"lg"})}):n||!t?c.jsxs("div",{className:"text-center py-12",children:[c.jsx("p",{className:"text-red-600 mb-4",children:n||"Analysis not found"}),c.jsx(ut,{variant:"secondary",onClick:e,children:"Go Back"})]}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h2",{className:"text-xl font-semibold",children:"Analysis Details"}),c.jsx(ut,{variant:"secondary",onClick:e,children:"Close"})]}),c.jsx(Ji,{analysis:t})]})}function ni({title:r,description:e,action:t}){return c.jsxs("div",{className:"text-center py-12",children:[c.jsx("div",{className:"rounded-full bg-blue-100 p-3 mx-auto w-12 h-12 flex items-center justify-center",children:c.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),c.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:r}),c.jsx("p",{className:"mt-2 text-sm text-gray-500",children:e}),t&&c.jsx("div",{className:"mt-6",children:t})]})}function ig(){const{analyses:r,isLoading:e,error:t}=wc(),[s,n]=p.useState(null);return e?c.jsx("div",{className:"flex justify-center py-12",children:c.jsx(We,{size:"lg"})}):t?c.jsx(ni,{title:"Error loading analyses",description:t}):r.length?s?c.jsx(ag,{analysisId:s,onClose:()=>n(null)}):c.jsx("div",{className:"space-y-4",children:r.map(a=>c.jsx(rg,{analysis:a,onClick:()=>n(a.id)},a.id))}):c.jsx(ni,{title:"No analyses yet",description:"Start by analyzing a candidate's CV against a job description."})}function og(){const{candidates:r,isLoading:e}=Fi();return e?c.jsx(We,{}):c.jsxs("div",{className:"space-y-4",children:[r.map(t=>c.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[c.jsx("h3",{className:"font-medium text-gray-900",children:t.name}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:zi(t.created_at)}),c.jsx("p",{className:"text-sm text-gray-600 mt-2 line-clamp-2",children:t.cv_text})]},t.id)),!r.length&&c.jsx("p",{className:"text-gray-500 text-center py-4",children:"No previous candidates found"})]})}function cg(){const{jobs:r,isLoading:e}=Zi();return e?c.jsx(We,{}):c.jsxs("div",{className:"space-y-4",children:[r.map(t=>c.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[c.jsx("h3",{className:"font-medium text-gray-900",children:t.title}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:zi(t.created_at)}),c.jsx("p",{className:"text-sm text-gray-600 mt-2 line-clamp-2",children:t.description})]},t.id)),!r.length&&c.jsx("p",{className:"text-gray-500 text-center py-4",children:"No previous jobs found"})]})}function lg({tabs:r,activeTab:e,onChange:t}){return c.jsx("div",{className:"border-b border-gray-200",children:c.jsx("nav",{className:"-mb-px flex space-x-8",children:r.map(s=>c.jsx("button",{onClick:()=>t(s.id),"data-tab":s.id,className:`
              py-4 px-1 border-b-2 font-medium text-sm cursor-pointer
              ${e===s.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}
            `,children:s.label},s.id))})})}async function ug(){try{const r=new Date;r.setDate(r.getDate()-7);const[{count:e},{count:t},{count:s},{count:n}]=await Promise.all([H.from("analysis").select("*",{count:"exact",head:!0}),H.from("candidates").select("*",{count:"exact",head:!0}),H.from("jobs").select("*",{count:"exact",head:!0}),H.from("analysis").select("*",{count:"exact",head:!0}).gte("created_at",r.toISOString())]);return{totalAnalyses:e||0,totalCandidates:t||0,totalJobs:s||0,recentAnalyses:n||0}}catch{throw new Ue("Failed to fetch dashboard stats",500)}}function dg(){const{data:r,isLoading:e,error:t,refetch:s}=Rs(ug);return{stats:r||{totalAnalyses:0,totalCandidates:0,totalJobs:0,recentAnalyses:0},isLoading:e,error:t,refetch:s}}function hg(){const{stats:r,isLoading:e}=dg();if(e)return c.jsx("div",{className:"flex justify-center py-4",children:c.jsx(We,{})});const t=[{label:"Total Analyses",value:r.totalAnalyses,icon:di,color:"bg-blue-500"},{label:"Candidates",value:r.totalCandidates,icon:xr,color:"bg-green-500"},{label:"Jobs",value:r.totalJobs,icon:Wc,color:"bg-purple-500"},{label:"Recent Analyses",value:r.recentAnalyses,icon:hi,color:"bg-orange-500"}];return c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:t.map(s=>c.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:`${s.color} p-3 rounded-lg`,children:c.jsx(s.icon,{className:"h-6 w-6 text-white"})}),c.jsxs("div",{className:"ml-4",children:[c.jsx("p",{className:"text-sm font-medium text-gray-500",children:s.label}),c.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:s.value})]})]})},s.label))})}function fg({user:r}){return c.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Welcome back, ",r?.email?.split("@")[0]||"Demo User","!"]}),c.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Here's what's happening with your recruitment analysis"})]}),c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsxs("button",{className:"relative p-2 text-gray-400 hover:text-gray-500",children:[c.jsx(Uc,{className:"h-6 w-6"}),c.jsx("span",{className:"absolute top-0 right-0 block h-2 w-2 rounded-full bg-red-400 ring-2 ring-white"})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx(fi,{className:"h-8 w-8 text-gray-400"}),c.jsxs("div",{className:"ml-3",children:[c.jsx("p",{className:"text-sm font-medium text-gray-700",children:r?.email||"demo@example.com"}),c.jsx("p",{className:"text-xs text-gray-500",children:"Recruiter"})]})]})]})]})})}function mg(){const{analyses:r,isLoading:e}=wc(),t=r.slice(0,5);return c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Recent Activity"}),e?c.jsx("div",{className:"flex justify-center py-4",children:c.jsx(We,{})}):c.jsx("div",{className:"h-48 overflow-y-auto pr-2",children:c.jsx("div",{className:"space-y-4",children:t.map(s=>c.jsxs("div",{className:"flex items-start space-x-3",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center",children:c.jsx("span",{className:"text-sm font-medium text-blue-600",children:s.fit_score})})}),c.jsxs("div",{className:"min-w-0 flex-1",children:[c.jsx("p",{className:"text-sm font-medium text-gray-900",children:"New analysis completed"}),c.jsx("p",{className:"text-sm text-gray-500",children:Qh(s.created_at)})]})]},s.id))})})]})}const pg=[{id:"new",label:"New Analysis"},{id:"history",label:"Analysis History"},{id:"candidates",label:"Previous Candidates"},{id:"jobs",label:"Previous Jobs"}];function gg(){const[r,e]=p.useState("new"),{session:t}=Os();return c.jsxs("div",{className:"space-y-6",children:[c.jsx(fg,{user:t?.user}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[c.jsx("div",{className:"lg:col-span-2",children:c.jsx(hg,{})}),c.jsx("div",{className:"lg:col-span-1",children:c.jsx(mg,{})})]}),c.jsx("div",{className:"bg-white rounded-lg shadow",children:c.jsxs("div",{className:"p-6",children:[c.jsx(lg,{tabs:pg,activeTab:r,onChange:e}),c.jsxs("div",{className:"mt-6",children:[r==="new"&&c.jsx(sg,{}),r==="history"&&c.jsx(ig,{}),r==="candidates"&&c.jsx(og,{}),r==="jobs"&&c.jsx(cg,{})]})]})})]})}class yg extends p.Component{state={hasError:!1};static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Uncaught error:",e,t)}render(){return this.state.hasError?this.props.fallback||c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:c.jsxs("div",{className:"max-w-md w-full bg-white p-8 rounded-lg shadow-md",children:[c.jsx("h2",{className:"text-2xl font-bold text-red-600 mb-4",children:"Something went wrong"}),c.jsx("p",{className:"text-gray-600 mb-4",children:this.state.error?.message||"An unexpected error occurred"}),c.jsx("button",{onClick:()=>this.setState({hasError:!1}),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"Try again"})]})}):this.props.children}}function _g(){return c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx(Id,{}),c.jsx("main",{className:"py-8",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsx(yg,{children:c.jsx(oi,{children:c.jsx(st,{path:"/",element:c.jsx(gg,{})})})})})})]})}function ai({plan:r}){const[e,t]=p.useState(!1),{session:s}=Os(),{addToast:n}=ao(),a=ii(),i=async()=>{if(!s){a("/login");return}if(r==="free"){a("/dashboard");return}t(!0);try{const o=await Gp;if(!o)throw new Error("Stripe not initialized");const{error:l}=await o.redirectToCheckout({lineItems:[{price:An.PRICES.PRO,quantity:1}],mode:"subscription",successUrl:`${window.location.origin}/dashboard`,cancelUrl:`${window.location.origin}/pricing`});if(l)throw l}catch(o){n("Failed to start subscription process","error"),console.error("Subscription error:",o)}finally{t(!1)}};return c.jsx(ut,{onClick:i,isLoading:e,variant:r==="pro"?"primary":"secondary",className:"w-full",children:r==="free"?"Start Free Trial":"Subscribe Now"})}const wg="your-production-stripe-key";ia(wg);const vg=4;function bg(){const r=["Unlimited job descriptions","Detailed CV analysis","AI-powered matching","Interview question generation","PDF export functionality","Email support"],e=[...r,"Priority support","Advanced analytics","Team collaboration"];return c.jsx("div",{className:"min-h-screen bg-gray-50 py-12",children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:"text-center mb-16",children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Choose Your Plan"}),c.jsx("p",{className:"text-xl text-gray-600",children:"Start with a free trial, upgrade when you need more"})]}),c.jsxs("div",{className:"max-w-5xl mx-auto grid md:grid-cols-2 gap-8",children:[c.jsx("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden border border-gray-200",children:c.jsxs("div",{className:"px-6 py-8",children:[c.jsx("h3",{className:"text-center text-2xl font-bold text-gray-900 mb-2",children:"Free Trial"}),c.jsx("p",{className:"text-center text-gray-600 mb-6",children:"Perfect for trying out our service"}),c.jsxs("div",{className:"text-center mb-6",children:[c.jsx("span",{className:"text-4xl font-bold text-gray-900",children:"$0"}),c.jsx("span",{className:"text-gray-600",children:"/month"}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Up to ",vg," CV analyses"]})]}),c.jsx("ul",{className:"space-y-4 mb-8",children:r.map((t,s)=>c.jsxs("li",{className:"flex items-start",children:[c.jsx(ir,{className:"h-5 w-5 text-green-500 flex-shrink-0 mt-0.5"}),c.jsx("span",{className:"ml-3 text-gray-600",children:t})]},s))}),c.jsx(ai,{plan:"free"})]})}),c.jsx("div",{className:"bg-gradient-to-br from-blue-600 to-indigo-600 rounded-2xl shadow-lg overflow-hidden transform hover:scale-105 transition-transform",children:c.jsxs("div",{className:"px-6 py-8",children:[c.jsx("h3",{className:"text-center text-2xl font-bold text-white mb-2",children:"Pro Plan"}),c.jsx("p",{className:"text-center text-blue-100 mb-6",children:"For serious recruiters"}),c.jsxs("div",{className:"text-center mb-6",children:[c.jsx("span",{className:"text-4xl font-bold text-white",children:"$12.99"}),c.jsx("span",{className:"text-blue-100",children:"/month"}),c.jsx("p",{className:"text-sm text-blue-100 mt-1",children:"Unlimited analyses"})]}),c.jsx("ul",{className:"space-y-4 mb-8",children:e.map((t,s)=>c.jsxs("li",{className:"flex items-start",children:[c.jsx(ir,{className:"h-5 w-5 text-white flex-shrink-0 mt-0.5"}),c.jsx("span",{className:"ml-3 text-white",children:t})]},s))}),c.jsx(ai,{plan:"pro"})]})})]}),c.jsx("div",{className:"text-center mt-8",children:c.jsx("p",{className:"text-sm text-gray-500",children:"All plans include a 14-day money-back guarantee"})})]})})}function xg(){const{session:r,loading:e}=Os();return e?c.jsx("div",{className:"min-h-screen flex items-center justify-center",children:c.jsx(We,{size:"lg"})}):c.jsxs(oi,{children:[c.jsx(st,{path:"/",element:r?c.jsx(zt,{to:"/dashboard"}):c.jsx(vl,{})}),c.jsx(st,{path:"/login",element:r?c.jsx(zt,{to:"/dashboard"}):c.jsx(Cd,{})}),c.jsx(st,{path:"/signup",element:r?c.jsx(zt,{to:"/dashboard"}):c.jsx(Od,{})}),c.jsx(st,{path:"/pricing",element:c.jsx(bg,{})}),c.jsx(st,{path:"/dashboard/*",element:r?c.jsx(_g,{}):c.jsx(zt,{to:"/login"})}),c.jsx(st,{path:"*",element:c.jsx(zt,{to:"/"})})]})}tn.createRoot(document.getElementById("root")).render(c.jsx(kc.StrictMode,{children:c.jsx(jc,{children:c.jsx(xg,{})})}));
//# sourceMappingURL=index-qY3oaZaw.js.map
