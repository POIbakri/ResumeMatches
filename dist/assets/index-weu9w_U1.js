const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browser-Dwhluaoo.js","assets/vendor-15hnMuUL.js","assets/index.es-DdjfvInn.js","assets/analytics-Dy164akG.js"])))=>i.map(i=>d[i]);
import{r as V,a as ky,L as Ps,g as Cy,c as Vn,u as T0,R as j0,b as ha,N as Cl,d as Py,B as Ly}from"./vendor-15hnMuUL.js";import{a as oc}from"./analytics-Dy164akG.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=t(n);fetch(n.href,r)}})();var I0={exports:{}},Lu={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ty=V,jy=Symbol.for("react.element"),Iy=Symbol.for("react.fragment"),Ry=Object.prototype.hasOwnProperty,Oy=Ty.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,My={key:!0,ref:!0,__self:!0,__source:!0};function R0(i,e,t){var s,n={},r=null,a=null;t!==void 0&&(r=""+t),e.key!==void 0&&(r=""+e.key),e.ref!==void 0&&(a=e.ref);for(s in e)Ry.call(e,s)&&!My.hasOwnProperty(s)&&(n[s]=e[s]);if(i&&i.defaultProps)for(s in e=i.defaultProps,e)n[s]===void 0&&(n[s]=e[s]);return{$$typeof:jy,type:i,key:r,ref:a,props:n,_owner:Oy.current}}Lu.Fragment=Iy;Lu.jsx=R0;Lu.jsxs=R0;I0.exports=Lu;var g=I0.exports,kf={},Ym=ky;kf.createRoot=Ym.createRoot,kf.hydrateRoot=Ym.hydrateRoot;function Fy({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"}))}const Dy=V.forwardRef(Fy);function By({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))}const $y=V.forwardRef(By);function qy({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"}))}const O0=V.forwardRef(qy);function Uy({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18 9 11.25l4.306 4.306a11.95 11.95 0 0 1 5.814-5.518l2.74-1.22m0 0-5.94-2.281m5.94 2.28-2.28 5.941"}))}const zy=V.forwardRef(Uy);function Hy({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"}))}const Wy=V.forwardRef(Hy);function Vy({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const Gy=V.forwardRef(Vy);function Xy({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 3.104v5.714a2.25 2.25 0 0 1-.659 1.591L5 14.5M9.75 3.104c-.251.023-.501.05-.75.082m.75-.082a24.301 24.301 0 0 1 4.5 0m0 0v5.714c0 .597.237 1.17.659 1.591L19.8 15.3M14.25 3.104c.251.023.501.05.75.082M19.8 15.3l-1.57.393A9.065 9.065 0 0 1 12 15a9.065 9.065 0 0 0-6.23-.693L5 14.5m14.8.8 1.402 1.402c1.232 1.232.65 3.318-1.067 3.611A48.309 48.309 0 0 1 12 21c-2.773 0-5.491-.235-8.135-.687-1.718-.293-2.3-2.379-1.067-3.61L5 14.5"}))}const Yy=V.forwardRef(Xy);function Ky({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"}))}const Jy=V.forwardRef(Ky);function Zy({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 14.15v4.25c0 1.094-.787 2.036-1.872 2.18-2.087.277-4.216.42-6.378.42s-4.291-.143-6.378-.42c-1.085-.144-1.872-1.086-1.872-2.18v-4.25m16.5 0a2.18 2.18 0 0 0 .75-1.661V8.706c0-1.081-.768-2.015-1.837-2.175a48.114 48.114 0 0 0-3.413-.387m4.5 8.006c-.194.165-.42.295-.673.38A23.978 23.978 0 0 1 12 15.75c-2.648 0-5.195-.429-7.577-1.22a2.016 2.016 0 0 1-.673-.38m0 0A2.18 2.18 0 0 1 3 12.489V8.706c0-1.081.768-2.015 1.837-2.175a48.111 48.111 0 0 1 3.413-.387m7.5 0V5.25A2.25 2.25 0 0 0 13.5 3h-3a2.25 2.25 0 0 0-2.25 2.25v.894m7.5 0a48.667 48.667 0 0 0-7.5 0M12 12.75h.008v.008H12v-.008Z"}))}const yp=V.forwardRef(Zy);function Qy({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const M0=V.forwardRef(Qy);function ev({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const tv=V.forwardRef(ev);function sv({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}const du=V.forwardRef(sv);function nv({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))}const Vo=V.forwardRef(nv);function iv({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"}))}const rv=V.forwardRef(iv);function av({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"}))}const Tu=V.forwardRef(av);function ov({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const F0=V.forwardRef(ov);function lv({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m6.75 12-3-3m0 0-3 3m3-3v6m-1.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const D0=V.forwardRef(lv);function cv({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"}))}const B0=V.forwardRef(cv);function hv({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const ju=V.forwardRef(hv);function uv({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const dv=V.forwardRef(uv);function fv({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))}const pv=V.forwardRef(fv);function mv({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"}))}const gv=V.forwardRef(mv);function bv({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const yv=V.forwardRef(bv);function vv({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113a.375.375 0 0 1-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112Z"}))}const wv=V.forwardRef(vv);function xv({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z"}))}const Km=V.forwardRef(xv);function _v({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z"}))}const Av=V.forwardRef(_v);function Sv({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"}))}const vp=V.forwardRef(Sv);function Nv({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const $0=V.forwardRef(Nv);function Ev({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"}))}const q0=V.forwardRef(Ev);function kv({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"}))}const Cv=V.forwardRef(kv);function Pv({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z"}))}const Lv=V.forwardRef(Pv);function Tv({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const jv=V.forwardRef(Tv);function Iv({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const Rv=V.forwardRef(Iv);function Ov(){const[i,e]=V.useState(!1),t=()=>{window.location.reload()};return g.jsx("nav",{className:"bg-white shadow-sm",children:g.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[g.jsxs("div",{className:"flex justify-between items-center h-16",children:[g.jsx("div",{className:"flex items-center",children:g.jsx(Ps,{to:"/",onClick:t,className:"flex items-center",children:g.jsx("img",{src:"/images/logo.png",alt:"Company Logo",className:"h-8 xs:h-10 sm:h-12 w-auto scale-110 transform hover:scale-105 transition-transform duration-200",style:{marginTop:"-4px",marginBottom:"-4px"}})})}),g.jsxs("div",{className:"hidden md:flex items-center space-x-4 lg:space-x-8",children:[g.jsx("a",{href:"#features",className:"text-sm lg:text-base text-gray-600 hover:text-gray-900 font-medium transition-colors duration-200",children:"Features"}),g.jsx("a",{href:"#pricing",className:"text-sm lg:text-base text-gray-600 hover:text-gray-900 font-medium transition-colors duration-200",children:"Pricing"}),g.jsx(Ps,{to:"/login",className:"inline-flex items-center px-3 lg:px-4 py-1.5 lg:py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-500 hover:bg-blue-600 transition-colors shadow-sm hover:shadow-md",children:"Sign In"})]}),g.jsx("div",{className:"md:hidden",children:g.jsx("button",{onClick:()=>e(!i),className:"inline-flex items-center justify-center p-2 rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500",children:i?g.jsx(Rv,{className:"block h-6 w-6"}):g.jsx(Gy,{className:"block h-6 w-6"})})})]}),i&&g.jsx("div",{className:"md:hidden py-3",children:g.jsxs("div",{className:"flex flex-col space-y-3 px-2",children:[g.jsx("a",{href:"#features",className:"text-gray-600 hover:text-gray-900 font-medium px-3 py-2 rounded-md hover:bg-gray-100",children:"Features"}),g.jsx("a",{href:"#pricing",className:"text-gray-600 hover:text-gray-900 font-medium px-3 py-2 rounded-md hover:bg-gray-100",children:"Pricing"}),g.jsx(Ps,{to:"/login",className:"text-center text-white bg-blue-500 hover:bg-blue-600 px-3 py-2 rounded-md font-medium shadow-sm hover:shadow-md",children:"Sign In"})]})})]})})}function Mv(){return g.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-gray-900 via-blue-900 to-indigo-900 border border-blue-500/20 rounded-lg",children:[g.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[g.jsx("div",{className:"absolute inset-0 bg-[url('/grid.svg')] opacity-10"}),g.jsx("div",{className:"absolute -top-20 xs:-top-30 sm:-top-40 -right-20 xs:-right-30 sm:-right-40 w-40 xs:w-60 sm:w-80 h-40 xs:h-60 sm:h-80 bg-blue-500 rounded-full blur-3xl opacity-30 animate-pulse"}),g.jsx("div",{className:"absolute -bottom-20 xs:-bottom-30 sm:-bottom-40 -left-20 xs:-left-30 sm:-left-40 w-40 xs:w-60 sm:w-80 h-40 xs:h-60 sm:h-80 bg-indigo-500 rounded-full blur-3xl opacity-30 animate-pulse delay-1000"})]}),g.jsx("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:g.jsxs("div",{className:"py-8 xs:py-12 sm:py-16",children:[g.jsx("div",{className:"inline-flex items-center px-3 xs:px-4 py-1 xs:py-1.5 rounded-full border border-blue-400/30 bg-blue-500/10 backdrop-blur-sm mb-6 xs:mb-8",children:g.jsx("span",{className:"text-xs xs:text-sm text-blue-200 font-medium",children:"âœ¨ AI-Powered Recruitment Solution"})}),g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 xs:gap-8 lg:gap-12 items-center",children:[g.jsxs("div",{className:"order-2 lg:order-1",children:[g.jsxs("h1",{children:[g.jsx("span",{className:"block text-2xl xs:text-3xl sm:text-5xl lg:text-6xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-blue-200 to-indigo-200 leading-tight mb-2 xs:mb-4",children:"Transform Your Hiring Process"}),g.jsx("span",{className:"block text-xl xs:text-2xl sm:text-4xl lg:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-indigo-400",children:"With Intelligent CV Analysis"})]}),g.jsx("p",{className:"mt-4 xs:mt-6 text-sm xs:text-base sm:text-lg text-blue-100/90 max-w-2xl leading-relaxed",children:"Make better hiring decisions faster with our advanced AI technology. Match candidates to jobs with precision and generate tailored interview plans instantly."}),g.jsxs("div",{className:"mt-6 xs:mt-8 flex flex-col xs:flex-row items-stretch xs:items-center gap-3 xs:gap-4 sm:gap-6",children:[g.jsxs(Ps,{to:"/signup",className:"group relative inline-flex items-center justify-center px-4 xs:px-6 sm:px-8 py-2.5 xs:py-3 sm:py-4 text-sm xs:text-base sm:text-lg font-semibold text-blue-900 bg-white rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-200 overflow-hidden",children:[g.jsx("span",{className:"relative z-10",children:"Start Free Trial"}),g.jsx(O0,{className:"ml-2 h-4 xs:h-5 w-4 xs:w-5 relative z-10 group-hover:translate-x-1 transition-transform"}),g.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-100 to-blue-50 opacity-0 group-hover:opacity-100 transition-opacity"})]}),g.jsxs("a",{href:"#demo",className:"group inline-flex items-center justify-center px-4 xs:px-6 sm:px-8 py-2.5 xs:py-3 sm:py-4 text-sm xs:text-base sm:text-lg font-semibold text-white border-2 border-white/20 rounded-xl backdrop-blur-sm hover:bg-white/10 transition-all duration-200",children:[g.jsx(wv,{className:"mr-2 h-4 xs:h-5 sm:h-6 w-4 xs:w-5 sm:w-6"}),"Watch Demo"]})]})]}),g.jsxs("div",{className:"relative w-full max-w-[280px] xs:max-w-lg mx-auto order-1 lg:order-2 h-[16rem] xs:h-[20rem] sm:h-[24rem]",children:[g.jsx("div",{className:"absolute top-0 left-0 w-56 xs:w-64 sm:w-72 h-[16rem] xs:h-[20rem] sm:h-[24rem] bg-white/10 backdrop-blur-sm rounded-lg border border-white/20 shadow-xl transform -rotate-6 animate-float",children:g.jsxs("div",{className:"p-3 xs:p-4 sm:p-6 space-y-3 xs:space-y-4",children:[g.jsxs("div",{className:"flex items-center space-x-2 xs:space-x-3",children:[g.jsx("div",{className:"w-8 xs:w-10 sm:w-12 h-8 xs:h-10 sm:h-12 rounded-full bg-blue-200/30 animate-pulse"}),g.jsxs("div",{className:"space-y-1.5 xs:space-y-2",children:[g.jsx("div",{className:"h-2 xs:h-3 sm:h-4 w-24 xs:w-28 sm:w-32 bg-blue-200/30 rounded animate-pulse"}),g.jsx("div",{className:"h-1.5 xs:h-2 sm:h-3 w-16 xs:w-20 sm:w-24 bg-blue-200/20 rounded animate-pulse"})]})]}),g.jsxs("div",{className:"space-y-1.5 xs:space-y-2 pt-2 xs:pt-3",children:[g.jsxs("div",{className:"flex items-center space-x-1.5 xs:space-x-2",children:[g.jsx("div",{className:"w-2 xs:w-3 sm:w-4 h-2 xs:h-3 sm:h-4 rounded bg-blue-200/30 animate-pulse"}),g.jsx("div",{className:"h-1.5 xs:h-2 sm:h-3 w-24 xs:w-28 sm:w-32 bg-blue-200/20 rounded animate-pulse"})]}),g.jsxs("div",{className:"flex items-center space-x-1.5 xs:space-x-2",children:[g.jsx("div",{className:"w-2 xs:w-3 sm:w-4 h-2 xs:h-3 sm:h-4 rounded bg-blue-200/30 animate-pulse"}),g.jsx("div",{className:"h-1.5 xs:h-2 sm:h-3 w-32 xs:w-36 sm:w-40 bg-blue-200/20 rounded animate-pulse"})]})]}),g.jsxs("div",{className:"space-y-2 xs:space-y-3 pt-2 xs:pt-3",children:[g.jsx("div",{className:"h-2 xs:h-3 sm:h-4 w-16 xs:w-20 sm:w-24 bg-blue-200/30 rounded"}),[...Array(3)].map((i,e)=>g.jsxs("div",{className:"space-y-1.5 xs:space-y-2",children:[g.jsx("div",{className:"h-1.5 xs:h-2 sm:h-3 bg-blue-200/20 rounded w-full"}),g.jsx("div",{className:"h-1.5 xs:h-2 sm:h-3 bg-blue-200/20 rounded w-5/6"}),g.jsx("div",{className:"h-1.5 xs:h-2 sm:h-3 bg-blue-200/20 rounded w-4/6"})]},e))]})]})}),g.jsx("div",{className:"absolute top-4 right-0 w-56 xs:w-64 sm:w-72 h-[16rem] xs:h-[20rem] sm:h-[24rem] bg-white/10 backdrop-blur-sm rounded-lg border border-white/20 shadow-xl transform rotate-6 animate-float delay-500",children:g.jsxs("div",{className:"p-3 xs:p-4 sm:p-6 space-y-3 xs:space-y-4",children:[g.jsxs("div",{className:"space-y-2 xs:space-y-3",children:[g.jsx("div",{className:"h-3 xs:h-4 sm:h-5 bg-indigo-200/30 rounded w-3/4"}),g.jsx("div",{className:"h-2 xs:h-3 sm:h-4 bg-indigo-200/20 rounded w-1/2"})]}),g.jsxs("div",{className:"flex items-center space-x-2 xs:space-x-3 pt-1.5 xs:pt-2",children:[g.jsx("div",{className:"w-6 xs:w-8 sm:w-10 h-6 xs:h-8 sm:h-10 rounded bg-indigo-200/30"}),g.jsxs("div",{className:"space-y-1.5 xs:space-y-2",children:[g.jsx("div",{className:"h-1.5 xs:h-2 sm:h-3 w-16 xs:w-20 sm:w-24 bg-indigo-200/20 rounded"}),g.jsx("div",{className:"h-1.5 xs:h-2 sm:h-3 w-24 xs:w-28 sm:w-32 bg-indigo-200/20 rounded"})]})]}),g.jsxs("div",{className:"space-y-2 xs:space-y-3 pt-2 xs:pt-3",children:[g.jsx("div",{className:"h-2 xs:h-3 sm:h-4 w-24 xs:w-28 sm:w-32 bg-indigo-200/30 rounded"}),[...Array(4)].map((i,e)=>g.jsxs("div",{className:"flex items-center space-x-1.5 xs:space-x-2",children:[g.jsx("div",{className:"w-1.5 xs:w-2 sm:w-3 h-1.5 xs:h-2 sm:h-3 rounded-full bg-indigo-200/30"}),g.jsx("div",{className:"h-1.5 xs:h-2 sm:h-3 bg-indigo-200/20 rounded w-full"})]},e))]})]})}),g.jsxs("div",{className:"absolute inset-0 flex items-center justify-center",children:[g.jsx("div",{className:"w-12 xs:w-16 sm:w-20 h-12 xs:h-16 sm:h-20 rounded-full bg-blue-500/20 animate-ping"}),g.jsx("div",{className:"absolute w-8 xs:w-12 sm:w-16 h-8 xs:h-12 sm:h-16 rounded-full bg-indigo-400/20 animate-pulse"}),g.jsx("div",{className:"absolute w-6 xs:w-8 sm:w-12 h-6 xs:h-8 sm:h-12 rounded-full bg-blue-400/30 animate-pulse delay-300"})]})]})]})]})})]})}const Fv=[{name:"AI-Powered Analysis",description:"Advanced machine learning algorithms analyze CVs against job requirements with unprecedented accuracy.",icon:vp,color:"bg-blue-400"},{name:"Smart Scoring",description:"Get detailed candidate fit scores and comprehensive breakdowns of qualifications.",icon:M0,color:"bg-blue-400"},{name:"Instant Reports",description:"Generate professional PDF reports with detailed analysis and recommendations.",icon:ju,color:"bg-blue-400"},{name:"Interview Intelligence",description:"Get AI-generated interview questions tailored to each candidate's profile.",icon:gv,color:"bg-blue-400"},{name:"Technical Assessment",description:"Deep analysis of technical skills and experience levels.",icon:Yy,color:"bg-blue-400"},{name:"Bias Prevention",description:"Ensure fair and objective candidate evaluation with our AI system.",icon:Av,color:"bg-blue-400"}];function Dv(){return g.jsxs("div",{className:"relative bg-gradient-to-br from-blue-900 via-blue-800 to-indigo-900 py-12 sm:py-16 md:py-20 lg:py-24 overflow-hidden border border-blue-500/20 rounded-lg",id:"features",children:[g.jsxs("div",{className:"absolute inset-0",children:[g.jsx("div",{className:"absolute inset-0 bg-[url('/grid.svg')] opacity-10"}),g.jsx("div",{className:"absolute -top-20 sm:-top-30 md:-top-40 -right-20 sm:-right-30 md:-right-40 w-40 sm:w-60 md:w-80 h-40 sm:h-60 md:h-80 bg-blue-500 rounded-full blur-3xl opacity-30 animate-pulse"}),g.jsx("div",{className:"absolute -bottom-20 sm:-bottom-30 md:-bottom-40 -left-20 sm:-left-30 md:-left-40 w-40 sm:w-60 md:w-80 h-40 sm:h-60 md:h-80 bg-indigo-500 rounded-full blur-3xl opacity-30 animate-pulse delay-1000"})]}),g.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[g.jsxs("div",{className:"text-center mb-8 sm:mb-12 md:mb-16 transform transition-all duration-500 hover:scale-105",children:[g.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-white mb-3 sm:mb-4",children:"Powerful Features for Modern Recruitment"}),g.jsx("p",{className:"text-lg sm:text-xl text-blue-100/90 max-w-3xl mx-auto px-2",children:"Everything you need to streamline your candidate evaluation process and make better hiring decisions."})]}),g.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 lg:gap-8",children:Fv.map((i,e)=>g.jsxs("div",{className:"group bg-white/10 backdrop-blur-sm rounded-xl p-4 sm:p-6 lg:p-8 shadow-lg hover:shadow-2xl transition-all duration-300 border border-blue-300/30 hover:border-blue-400/50 transform hover:-translate-y-1",style:{animationDelay:`${e*100}ms`},children:[g.jsx("div",{className:`${i.color} rounded-lg p-2 sm:p-3 w-10 sm:w-12 h-10 sm:h-12 flex items-center justify-center mb-4 sm:mb-6 transform transition-transform group-hover:scale-110 group-hover:rotate-3`,children:g.jsx(i.icon,{className:"h-5 sm:h-6 w-5 sm:w-6 text-white animate-pulse"})}),g.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-white mb-2 sm:mb-3 group-hover:text-blue-200 transition-colors",children:i.name}),g.jsx("p",{className:"text-sm sm:text-base text-blue-100/80 group-hover:text-blue-100 transition-colors",children:i.description}),g.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400/10 to-indigo-400/10 opacity-0 group-hover:opacity-20 transition-opacity rounded-xl"})]},i.name))})]})]})}const Bv=[{label:"Accuracy Rate",value:"95%",icon:vp,description:"Match accuracy",gradient:"from-blue-400 to-indigo-400"},{label:"Time Saved",value:"75%",icon:F0,description:"Recruitment efficiency",gradient:"from-indigo-400 to-purple-400"},{label:"CVs Analyzed",value:"100K+",icon:ju,description:"And counting",gradient:"from-purple-400 to-pink-400"},{label:"Happy Recruiters",value:"5000+",icon:q0,description:"Trusted by professionals",gradient:"from-pink-400 to-red-400"}];function $v(){return g.jsxs("div",{className:"relative bg-gradient-to-br from-blue-900 via-indigo-900 to-purple-900 py-12 xs:py-16 sm:py-20 lg:py-24 overflow-hidden border border-blue-500/20 rounded-lg",children:[g.jsxs("div",{className:"absolute inset-0",children:[g.jsx("div",{className:"absolute inset-0 bg-[url('/grid.svg')] opacity-10"}),g.jsx("div",{className:"absolute -top-20 xs:-top-30 sm:-top-40 -right-20 xs:-right-30 sm:-right-40 w-40 xs:w-60 sm:w-80 h-40 xs:h-60 sm:h-80 bg-blue-500 rounded-full blur-3xl opacity-30 animate-pulse"}),g.jsx("div",{className:"absolute -bottom-20 xs:-bottom-30 sm:-bottom-40 -left-20 xs:-left-30 sm:-left-40 w-40 xs:w-60 sm:w-80 h-40 xs:h-60 sm:h-80 bg-indigo-500 rounded-full blur-3xl opacity-30 animate-pulse delay-1000"})]}),g.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[g.jsxs("div",{className:"text-center mb-8 xs:mb-12 lg:mb-16",children:[g.jsx("h2",{className:"text-2xl xs:text-3xl font-bold text-white mb-2 xs:mb-4",children:"Proven Track Record"}),g.jsx("p",{className:"text-base xs:text-lg sm:text-xl text-blue-100/90 max-w-3xl mx-auto px-2",children:"Our platform delivers measurable results for recruitment teams worldwide"})]}),g.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 xs:gap-6 sm:gap-8",children:Bv.map((i,e)=>g.jsxs("div",{className:"group relative bg-white/10 rounded-xl p-4 xs:p-6 sm:p-8 backdrop-blur-lg border border-white/20 hover:border-white/40 transition-all duration-300 transform hover:-translate-y-1 hover:shadow-2xl",style:{animationDelay:`${e*100}ms`},children:[g.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${i.gradient} opacity-0 group-hover:opacity-10 transition-opacity duration-500 rounded-xl`}),g.jsxs("div",{className:"relative z-10",children:[g.jsxs("div",{className:"flex items-center space-x-2 xs:space-x-3 sm:space-x-4 mb-4 xs:mb-5 sm:mb-6",children:[g.jsx("div",{className:"p-2 xs:p-2.5 sm:p-3 rounded-lg bg-white/10 group-hover:bg-white/20 transition-colors duration-300",children:g.jsx(i.icon,{className:"h-4 xs:h-5 sm:h-6 w-4 xs:w-5 sm:w-6 text-white group-hover:scale-110 transform transition-transform duration-300"})}),g.jsx("h3",{className:"text-base xs:text-lg font-medium text-white group-hover:text-blue-200 transition-colors duration-300",children:i.label})]}),g.jsx("p",{className:"text-3xl xs:text-4xl sm:text-5xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-white to-blue-200 mb-2 xs:mb-3",children:i.value}),g.jsx("p",{className:"text-xs xs:text-sm text-blue-200 group-hover:text-blue-100 transition-colors duration-300",children:i.description})]}),g.jsx("div",{className:"absolute bottom-0 left-0 w-full h-0.5 xs:h-1 bg-gradient-to-r from-transparent via-white/20 to-transparent transform scale-x-0 group-hover:scale-x-100 transition-transform duration-500"}),g.jsx("div",{className:"absolute top-0 right-0 w-12 xs:w-14 sm:w-16 h-12 xs:h-14 sm:h-16 bg-white/5 rounded-full blur-2xl group-hover:bg-white/10 transition-colors duration-300"})]},i.label))})]})]})}const Jm=[{title:"Upload CV & Job Description",description:"Simply upload a CV and job description to get started.",icon:Wy,color:"bg-blue-500",gradient:"from-blue-500/10 to-blue-600/10"},{title:"AI Analysis",description:"Our advanced AI analyzes the match and generates insights.",icon:vp,color:"bg-purple-500",gradient:"from-purple-500/10 to-purple-600/10"},{title:"Get Detailed Report",description:"Receive a comprehensive analysis with actionable insights.",icon:ju,color:"bg-green-500",gradient:"from-green-500/10 to-green-600/10"},{title:"Make Better Decisions",description:"Use data-driven insights to make informed hiring decisions.",icon:q0,color:"bg-indigo-500",gradient:"from-indigo-500/10 to-indigo-600/10"}];function qv(){return g.jsxs("div",{className:"relative bg-white py-12 xs:py-16 sm:py-20 lg:py-24 overflow-hidden border border-blue-500/20 rounded-lg",children:[g.jsxs("div",{className:"absolute inset-0",children:[g.jsx("div",{className:"absolute inset-0 bg-[url('/grid.svg')] opacity-5"}),g.jsx("div",{className:"absolute -top-20 xs:-top-30 sm:-top-40 -right-20 xs:-right-30 sm:-right-40 w-40 xs:w-60 sm:w-80 h-40 xs:h-60 sm:h-80 bg-blue-100 rounded-full blur-3xl opacity-30 animate-pulse"}),g.jsx("div",{className:"absolute -bottom-20 xs:-bottom-30 sm:-bottom-40 -left-20 xs:-left-30 sm:-left-40 w-40 xs:w-60 sm:w-80 h-40 xs:h-60 sm:h-80 bg-indigo-100 rounded-full blur-3xl opacity-30 animate-pulse delay-1000"})]}),g.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[g.jsxs("div",{className:"text-center mb-8 xs:mb-12 lg:mb-16 transform transition-all duration-500 hover:scale-105",children:[g.jsx("h2",{className:"text-2xl xs:text-3xl font-bold text-gray-900 mb-2 xs:mb-4",children:"How It Works"}),g.jsx("p",{className:"text-base xs:text-lg sm:text-xl text-gray-600 max-w-3xl mx-auto px-2",children:"Get started in minutes with our simple, powerful CV analysis process"})]}),g.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 xs:gap-6 sm:gap-8",children:Jm.map((i,e)=>g.jsxs("div",{className:"relative h-full",children:[e<Jm.length-1&&g.jsx("div",{className:"hidden lg:block absolute top-1/2 right-0 w-full h-0.5 bg-gray-200 transform translate-x-1/2"}),g.jsxs("div",{className:"group bg-white rounded-xl p-4 xs:p-6 sm:p-8 shadow-lg hover:shadow-2xl transition-all duration-300 border border-gray-200 hover:border-blue-400/50 transform hover:-translate-y-2 relative z-10 h-full flex flex-col",children:[g.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${i.gradient} opacity-0 group-hover:opacity-100 transition-opacity duration-300 rounded-xl`}),g.jsxs("div",{className:"absolute inset-0 overflow-hidden rounded-xl",children:[g.jsx("div",{className:`absolute w-1.5 xs:w-2 h-1.5 xs:h-2 ${i.color} rounded-full top-1/4 left-1/4 animate-float opacity-0 group-hover:opacity-30`}),g.jsx("div",{className:`absolute w-2 xs:w-3 h-2 xs:h-3 ${i.color} rounded-full top-3/4 right-1/4 animate-float-delayed opacity-0 group-hover:opacity-30`}),g.jsx("div",{className:`absolute w-1.5 xs:w-2 h-1.5 xs:h-2 ${i.color} rounded-full bottom-1/4 right-1/3 animate-float-slow opacity-0 group-hover:opacity-30`})]}),g.jsx("div",{className:`${i.color} rounded-full p-2 xs:p-3 w-10 xs:w-12 sm:w-14 h-10 xs:h-12 sm:h-14 flex items-center justify-center mb-4 xs:mb-5 sm:mb-6 transform transition-all duration-300 group-hover:scale-110 group-hover:rotate-6 group-hover:shadow-lg relative z-10`,children:g.jsx(i.icon,{className:"h-5 xs:h-6 sm:h-7 w-5 xs:w-6 sm:w-7 text-white group-hover:animate-pulse"})}),g.jsx("h3",{className:"text-lg xs:text-xl font-semibold text-gray-900 mb-2 xs:mb-3 group-hover:text-blue-600 transition-colors relative z-10",children:i.title}),g.jsx("p",{className:"text-sm xs:text-base text-gray-600 group-hover:text-gray-900 transition-colors flex-grow relative z-10",children:i.description}),g.jsx("div",{className:`absolute bottom-0 left-1/2 transform -translate-x-1/2 w-0 h-0.5 xs:h-1 ${i.color} group-hover:w-1/2 transition-all duration-300 rounded-full`})]})]},i.title))})]})]})}function Uv({title:i,titleId:e,...t},s){return V.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},t),i?V.createElement("title",{id:e},i):null,V.createElement("path",{fillRule:"evenodd",d:"M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z",clipRule:"evenodd"}))}const zv=V.forwardRef(Uv),Hv=[{quote:"This tool has revolutionized our hiring process. We're making better decisions faster than ever.",author:"Sarah Johnson",role:"Head of Recruitment",company:"TechCorp Inc.",rating:5},{quote:"The AI analysis is incredibly accurate. It helps us identify the best candidates quickly and efficiently.",author:"Michael Chen",role:"Technical Recruiter",company:"Innovation Labs",rating:5},{quote:"The interview suggestions are spot-on. It's like having an expert recruiter guiding you through the process.",author:"Emma Williams",role:"HR Director",company:"Global Solutions",rating:5}];function Wv(){return g.jsxs("div",{className:"relative bg-white py-12 xs:py-16 sm:py-20 lg:py-24 overflow-hidden border border-blue-500/20 rounded-lg",children:[g.jsxs("div",{className:"absolute inset-0",children:[g.jsx("div",{className:"absolute inset-0 bg-[url('/grid.svg')] opacity-5"}),g.jsx("div",{className:"absolute -top-20 xs:-top-30 sm:-top-40 -right-20 xs:-right-30 sm:-right-40 w-40 xs:w-60 sm:w-80 h-40 xs:h-60 sm:h-80 bg-blue-100 rounded-full blur-3xl opacity-30 animate-pulse"}),g.jsx("div",{className:"absolute -bottom-20 xs:-bottom-30 sm:-bottom-40 -left-20 xs:-left-30 sm:-left-40 w-40 xs:w-60 sm:w-80 h-40 xs:h-60 sm:h-80 bg-indigo-100 rounded-full blur-3xl opacity-30 animate-pulse delay-1000"})]}),g.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[g.jsxs("div",{className:"text-center mb-8 xs:mb-12 lg:mb-16",children:[g.jsx("p",{className:"inline-flex items-center px-3 xs:px-4 py-1 xs:py-1.5 rounded-full border border-blue-400/30 bg-blue-500/10 backdrop-blur-sm text-blue-600 text-xs xs:text-sm font-medium mb-3 xs:mb-4",children:"Client Testimonials"}),g.jsx("h2",{className:"text-2xl xs:text-3xl font-bold text-gray-900 mb-2 xs:mb-4",children:"Loved by Recruiters"}),g.jsx("p",{className:"text-base xs:text-lg sm:text-xl text-gray-600 max-w-3xl mx-auto px-2",children:"See what hiring professionals are saying about our AI-powered CV analyzer"})]}),g.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 xs:gap-6 sm:gap-8",children:Hv.map(i=>g.jsxs("div",{className:"group relative bg-white rounded-xl p-4 xs:p-6 sm:p-8 shadow-lg border border-blue-100 hover:border-blue-300 transition-all duration-300 transform hover:-translate-y-1 hover:shadow-2xl",children:[g.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50 to-indigo-50 opacity-0 group-hover:opacity-100 transition-opacity duration-300 rounded-xl"}),g.jsxs("div",{className:"relative z-10",children:[g.jsx("div",{className:"flex space-x-0.5 xs:space-x-1 mb-3 xs:mb-4",children:[...Array(i.rating)].map((e,t)=>g.jsx(zv,{className:"h-4 xs:h-5 w-4 xs:w-5 text-blue-400 group-hover:text-blue-500 transition-colors duration-300"},t))}),g.jsxs("blockquote",{className:"text-sm xs:text-base text-gray-600 mb-4 xs:mb-6 group-hover:text-gray-700 transition-colors",children:['"',i.quote,'"']}),g.jsxs("div",{children:[g.jsx("p",{className:"font-semibold text-sm xs:text-base text-gray-900 group-hover:text-blue-600 transition-colors",children:i.author}),g.jsx("p",{className:"text-xs xs:text-sm text-gray-500 group-hover:text-gray-600 transition-colors",children:i.role}),g.jsx("p",{className:"text-xs xs:text-sm text-gray-500 group-hover:text-gray-600 transition-colors",children:i.company})]})]}),g.jsx("div",{className:"absolute bottom-0 left-1/2 transform -translate-x-1/2 w-0 h-0.5 xs:h-1 bg-blue-400 group-hover:w-1/2 transition-all duration-300 rounded-full"}),g.jsx("div",{className:"absolute top-4 right-4 w-8 xs:w-12 h-8 xs:h-12 bg-blue-400/5 rounded-full blur group-hover:bg-blue-400/10 transition-colors duration-300"})]},i.author))})]})]})}const Vv={id:"free",name:"Free Trial",price:0,period:"month",analysisLimit:4,features:["Up to 4 CV analyses","Basic interview questions","PDF export functionality","Email support"]},Gv={id:"pro",name:"Pro Plan",price:20,period:"month",analysisLimit:1e3,features:["1000 CV analyses per month","Advanced AI matching","Custom interview plans","Technical skill assessment","Team collaboration","Priority support","Analytics dashboard","Bulk analysis","API access"]},jn={FREE:Vv,PRO:Gv};function Xv(){return g.jsxs("div",{className:"relative bg-white py-12 xs:py-16 sm:py-20 lg:py-24 overflow-hidden border border-blue-500/20 rounded-lg",id:"pricing",children:[g.jsxs("div",{className:"absolute inset-0",children:[g.jsx("div",{className:"absolute inset-0 bg-[url('/grid.svg')] opacity-[0.02]"}),g.jsx("div",{className:"absolute -top-20 xs:-top-30 sm:-top-40 -right-20 xs:-right-30 sm:-right-40 w-40 xs:w-60 sm:w-80 h-40 xs:h-60 sm:h-80 bg-blue-100 rounded-full blur-3xl opacity-30 animate-pulse"}),g.jsx("div",{className:"absolute -bottom-20 xs:-bottom-30 sm:-bottom-40 -left-20 xs:-left-30 sm:-left-40 w-40 xs:w-60 sm:w-80 h-40 xs:h-60 sm:h-80 bg-indigo-100 rounded-full blur-3xl opacity-30 animate-pulse delay-1000"})]}),g.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[g.jsxs("div",{className:"text-center mb-8 xs:mb-12 lg:mb-16",children:[g.jsx("p",{className:"inline-flex items-center px-3 xs:px-4 py-1 xs:py-1.5 rounded-full border border-blue-400/30 bg-blue-500/10 backdrop-blur-sm text-blue-600 text-xs xs:text-sm font-medium mb-3 xs:mb-4",children:"Flexible Plans"}),g.jsx("h2",{className:"text-2xl xs:text-3xl font-bold text-gray-900 mb-2 xs:mb-4",children:"Simple, Transparent Pricing"}),g.jsx("p",{className:"text-base xs:text-lg sm:text-xl text-gray-600 max-w-3xl mx-auto",children:"Choose the plan that's right for your recruitment needs"})]}),g.jsxs("div",{className:"max-w-5xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-4 xs:gap-6 sm:gap-8",children:[g.jsxs("div",{className:"group relative bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-200 hover:border-blue-300 transition-all duration-300 transform hover:-translate-y-1",children:[g.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-50 to-blue-50 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),g.jsxs("div",{className:"relative p-4 xs:p-6 sm:p-8",children:[g.jsx("h3",{className:"text-xl xs:text-2xl font-bold text-gray-900 text-center mb-1 xs:mb-2",children:jn.FREE.name}),g.jsx("p",{className:"text-sm xs:text-base text-center text-gray-600 mb-4 xs:mb-6",children:"Perfect for trying out our service"}),g.jsxs("div",{className:"text-center mb-6 xs:mb-8",children:[g.jsx("span",{className:"text-4xl xs:text-5xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-gray-900 to-gray-600",children:"$0"}),g.jsx("span",{className:"text-gray-600",children:"/month"}),g.jsxs("p",{className:"text-xs xs:text-sm text-gray-500 mt-1 xs:mt-2",children:["Up to ",jn.FREE.analysisLimit," CV analyses"]})]}),g.jsx("ul",{className:"space-y-3 xs:space-y-4 mb-6 xs:mb-8",children:jn.FREE.features.map((i,e)=>g.jsxs("li",{className:"flex items-start group/item",children:[g.jsx(du,{className:"h-4 xs:h-5 w-4 xs:w-5 text-green-500 flex-shrink-0 mt-0.5 group-hover/item:scale-110 transition-transform"}),g.jsx("span",{className:"ml-2 xs:ml-3 text-sm xs:text-base text-gray-600",children:i})]},e))}),g.jsx(Ps,{to:"/signup",className:"block w-full bg-gray-100 text-gray-800 text-center py-3 xs:py-4 rounded-xl text-sm xs:text-base font-medium hover:bg-gray-200 transition-all duration-300 hover:shadow-lg",children:"Start Free Trial"})]})]}),g.jsxs("div",{className:"group relative bg-gradient-to-br from-blue-600 to-indigo-600 rounded-2xl shadow-xl overflow-hidden transform hover:scale-[1.02] transition-all duration-300",children:[g.jsx("div",{className:"absolute inset-0 bg-[url('/grid.svg')] opacity-10"}),g.jsxs("div",{className:"relative p-4 xs:p-6 sm:p-8",children:[g.jsx("h3",{className:"text-xl xs:text-2xl font-bold text-white text-center mb-1 xs:mb-2",children:jn.PRO.name}),g.jsx("p",{className:"text-sm xs:text-base text-center text-blue-100 mb-4 xs:mb-6",children:"For serious recruiters"}),g.jsxs("div",{className:"text-center mb-6 xs:mb-8",children:[g.jsxs("span",{className:"text-4xl xs:text-5xl font-bold text-white",children:["$",jn.PRO.price]}),g.jsx("span",{className:"text-blue-100",children:"/month"}),g.jsxs("p",{className:"text-xs xs:text-sm text-blue-100 mt-1 xs:mt-2",children:[jn.PRO.analysisLimit," analyses per month"]})]}),g.jsx("ul",{className:"space-y-3 xs:space-y-4 mb-6 xs:mb-8",children:jn.PRO.features.map((i,e)=>g.jsxs("li",{className:"flex items-start group/item",children:[g.jsx(du,{className:"h-4 xs:h-5 w-4 xs:w-5 text-white flex-shrink-0 mt-0.5 group-hover/item:scale-110 transition-transform"}),g.jsx("span",{className:"ml-2 xs:ml-3 text-sm xs:text-base text-white",children:i})]},e))}),g.jsx(Ps,{to:"/signup",className:"block w-full bg-white text-blue-600 text-center py-3 xs:py-4 rounded-xl text-sm xs:text-base font-medium hover:bg-blue-50 transition-all duration-300 hover:shadow-lg",children:"Get Started"})]})]})]})]})]})}function Yv(){return g.jsxs("div",{className:"relative overflow-hidden bg-white border border-blue-500/20 rounded-lg py-8 xs:py-12 sm:py-16 lg:py-20",children:[g.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[g.jsx("div",{className:"absolute inset-0 bg-[url('/grid.svg')] opacity-[0.02]"}),g.jsx("div",{className:"absolute -top-20 xs:-top-30 sm:-top-40 -right-20 xs:-right-30 sm:-right-40 w-40 xs:w-60 sm:w-80 h-40 xs:h-60 sm:h-80 bg-blue-100 rounded-full blur-3xl opacity-20 animate-pulse"}),g.jsx("div",{className:"absolute -bottom-20 xs:-bottom-30 sm:-bottom-40 -left-20 xs:-left-30 sm:-left-40 w-40 xs:w-60 sm:w-80 h-40 xs:h-60 sm:h-80 bg-indigo-100 rounded-full blur-3xl opacity-20 animate-pulse delay-1000"})]}),g.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[g.jsxs("div",{className:"text-center",children:[g.jsx("p",{className:"inline-flex items-center px-3 xs:px-4 py-1 xs:py-1.5 rounded-full border border-blue-400/30 bg-blue-500/10 backdrop-blur-sm text-blue-600 text-xs xs:text-sm font-medium mb-4 xs:mb-6 sm:mb-8",children:"Trusted by Industry Leaders"}),g.jsx("p",{className:"text-lg xs:text-xl sm:text-2xl font-semibold text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-indigo-600 mb-8 xs:mb-10 sm:mb-12",children:"Powering recruitment at world's leading companies"})]}),g.jsx("div",{className:"grid grid-cols-2 xs:grid-cols-3 md:grid-cols-6 lg:grid-cols-5 gap-4 xs:gap-6 sm:gap-8",children:[{src:"/logos/microsoft.svg",alt:"Microsoft"},{src:"/logos/google.svg",alt:"Google"},{src:"/logos/amazon.svg",alt:"Amazon"},{src:"/logos/meta.svg",alt:"Meta"},{src:"/logos/apple.svg",alt:"Apple"}].map((i,e)=>g.jsx("div",{className:"col-span-1 flex justify-center items-center md:col-span-2 lg:col-span-1",children:g.jsxs("div",{className:"relative group w-full max-w-[120px] xs:max-w-[140px] sm:max-w-[160px]",children:[g.jsx("div",{className:"absolute -inset-2 bg-gradient-to-r from-blue-100/60 to-indigo-100/60 rounded-lg blur opacity-0 group-hover:opacity-100 transition duration-500"}),g.jsx("img",{className:"relative w-full h-8 xs:h-10 sm:h-12 object-contain opacity-50 group-hover:opacity-100 transition-opacity duration-300",src:i.src,alt:i.alt,loading:"lazy"})]})},e))})]})]})}function Kv(){return g.jsxs("div",{className:"relative bg-gradient-to-r from-blue-600 to-indigo-600 py-12 sm:py-16 md:py-20 lg:py-24 overflow-hidden",children:[g.jsxs("div",{className:"absolute inset-0",children:[g.jsx("div",{className:"absolute inset-0 bg-[url('/grid.svg')] opacity-10"}),g.jsx("div",{className:"absolute -top-20 sm:-top-30 md:-top-40 -right-20 sm:-right-30 md:-right-40 w-40 sm:w-60 md:w-80 h-40 sm:h-60 md:h-80 bg-blue-400 rounded-full blur-3xl opacity-20 animate-pulse"}),g.jsx("div",{className:"absolute -bottom-20 sm:-bottom-30 md:-bottom-40 -left-20 sm:-left-30 md:-left-40 w-40 sm:w-60 md:w-80 h-40 sm:h-60 md:h-80 bg-indigo-400 rounded-full blur-3xl opacity-20 animate-pulse delay-1000"})]}),g.jsxs("div",{className:"relative w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[g.jsxs("h2",{className:"text-3xl xs:text-4xl sm:text-5xl font-bold text-white mb-4 sm:mb-6 leading-tight",children:["Ready to Transform Your"," ",g.jsx("span",{className:"inline-block sm:hidden",children:"Hiring Process?"}),g.jsx("br",{className:"hidden sm:block"}),g.jsx("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-blue-200 to-indigo-200 sm:inline",children:g.jsx("span",{className:"hidden sm:inline",children:"Hiring Process?"})})]}),g.jsx("p",{className:"text-lg xs:text-xl sm:text-2xl text-blue-100 mb-8 sm:mb-12 max-w-3xl mx-auto leading-relaxed px-2",children:"Join thousands of recruiters who are making better hiring decisions with AI-powered CV analysis."}),g.jsxs("div",{className:"flex flex-col xs:flex-row justify-center gap-4 sm:gap-6 px-4",children:[g.jsxs(Ps,{to:"/signup",className:"group inline-flex items-center justify-center px-6 sm:px-8 py-3 sm:py-4 border border-transparent text-base sm:text-lg font-medium rounded-xl text-blue-600 bg-white hover:bg-blue-50 transition-all duration-300 transform hover:-translate-y-1 hover:shadow-xl w-full xs:w-auto",children:["Get Started Free",g.jsx(O0,{className:"ml-2 h-5 w-5 group-hover:translate-x-1 transition-transform"})]}),g.jsx(Ps,{to:"/pricing",className:"inline-flex items-center justify-center px-6 sm:px-8 py-3 sm:py-4 border-2 border-white text-base sm:text-lg font-medium rounded-xl text-white hover:bg-white/10 transition-all duration-300 backdrop-blur-sm transform hover:-translate-y-1 w-full xs:w-auto",children:"View Pricing"})]})]})]})}function Jv(){return g.jsxs("div",{className:"bg-white min-h-screen",children:[g.jsx(Ov,{}),g.jsx(Mv,{}),g.jsx(Yv,{}),g.jsx(Dv,{}),g.jsx(qv,{}),g.jsx($v,{}),g.jsx(Wv,{}),g.jsx(Xv,{}),g.jsx(Kv,{}),g.jsx("footer",{className:"bg-gradient-to-b from-gray-50 to-gray-100 border-t border-gray-200",children:g.jsxs("div",{className:"max-w-7xl mx-auto py-8 xs:py-10 sm:py-12 px-4 sm:px-6 lg:px-8",children:[g.jsxs("div",{className:"grid grid-cols-2 xs:grid-cols-2 sm:grid-cols-4 gap-x-4 xs:gap-x-6 sm:gap-x-8 gap-y-8 xs:gap-y-10",children:[g.jsxs("div",{className:"space-y-4 xs:space-y-5 sm:space-y-6",children:[g.jsx("h3",{className:"text-xs xs:text-sm font-semibold text-gray-500 tracking-wider uppercase",children:"Product"}),g.jsxs("ul",{className:"mt-2 xs:mt-3 sm:mt-4 space-y-2 xs:space-y-3 sm:space-y-4",children:[g.jsx("li",{children:g.jsx("a",{href:"#features",className:"text-sm xs:text-base text-gray-600 hover:text-blue-600 transition-colors duration-200",children:"Features"})}),g.jsx("li",{children:g.jsx("a",{href:"#pricing",className:"text-sm xs:text-base text-gray-600 hover:text-blue-600 transition-colors duration-200",children:"Pricing"})}),g.jsx("li",{children:g.jsx(Ps,{to:"/login",className:"text-sm xs:text-base text-gray-600 hover:text-blue-600 transition-colors duration-200",children:"Sign In"})})]})]}),g.jsxs("div",{className:"space-y-4 xs:space-y-5 sm:space-y-6",children:[g.jsx("h3",{className:"text-xs xs:text-sm font-semibold text-gray-500 tracking-wider uppercase",children:"Support"}),g.jsxs("ul",{className:"mt-2 xs:mt-3 sm:mt-4 space-y-2 xs:space-y-3 sm:space-y-4",children:[g.jsx("li",{children:g.jsx(Ps,{to:"/docs",className:"text-sm xs:text-base text-gray-600 hover:text-blue-600 transition-colors duration-200",children:"Documentation"})}),g.jsx("li",{children:g.jsx(Ps,{to:"/help",className:"text-sm xs:text-base text-gray-600 hover:text-blue-600 transition-colors duration-200",children:"Help Center"})})]})]}),g.jsxs("div",{className:"space-y-4 xs:space-y-5 sm:space-y-6",children:[g.jsx("h3",{className:"text-xs xs:text-sm font-semibold text-gray-500 tracking-wider uppercase",children:"Legal"}),g.jsxs("ul",{className:"mt-2 xs:mt-3 sm:mt-4 space-y-2 xs:space-y-3 sm:space-y-4",children:[g.jsx("li",{children:g.jsx(Ps,{to:"/privacy",className:"text-sm xs:text-base text-gray-600 hover:text-blue-600 transition-colors duration-200",children:"Privacy"})}),g.jsx("li",{children:g.jsx(Ps,{to:"/terms",className:"text-sm xs:text-base text-gray-600 hover:text-blue-600 transition-colors duration-200",children:"Terms"})})]})]}),g.jsxs("div",{className:"space-y-4 xs:space-y-5 sm:space-y-6",children:[g.jsx("h3",{className:"text-xs xs:text-sm font-semibold text-gray-500 tracking-wider uppercase",children:"Company"}),g.jsxs("ul",{className:"mt-2 xs:mt-3 sm:mt-4 space-y-2 xs:space-y-3 sm:space-y-4",children:[g.jsx("li",{children:g.jsx(Ps,{to:"/about",className:"text-sm xs:text-base text-gray-600 hover:text-blue-600 transition-colors duration-200",children:"About"})}),g.jsx("li",{children:g.jsx(Ps,{to:"/contact",className:"text-sm xs:text-base text-gray-600 hover:text-blue-600 transition-colors duration-200",children:"Contact"})})]})]})]}),g.jsx("div",{className:"mt-8 xs:mt-10 sm:mt-12 pt-6 xs:pt-7 sm:pt-8 border-t border-gray-200",children:g.jsxs("div",{className:"flex flex-col xs:flex-row items-center justify-between space-y-4 xs:space-y-0",children:[g.jsx("div",{className:"flex items-center space-x-2",children:g.jsx("img",{src:"/images/logo.png",alt:"Company Logo",className:"h-10 xs:h-12 sm:h-16 w-auto"})}),g.jsxs("p",{className:"text-xs xs:text-sm text-gray-500",children:["Â© ",new Date().getFullYear()," All rights reserved."]})]})})]})})]})}const Zv="modulepreload",Qv=function(i){return"/"+i},Zm={},fr=function(e,t,s){let n=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");n=Promise.allSettled(t.map(l=>{if(l=Qv(l),l in Zm)return;Zm[l]=!0;const c=l.endsWith(".css"),h=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${h}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":Zv,c||(d.as="script"),d.crossOrigin="",d.href=l,o&&d.setAttribute("nonce",o),document.head.appendChild(d),c)return new Promise((p,f)=>{d.addEventListener("load",p),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${l}`)))})}))}function r(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return n.then(a=>{for(const o of a||[])o.status==="rejected"&&r(o.reason);return e().catch(r)})},ew=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...t)=>fr(async()=>{const{default:s}=await Promise.resolve().then(()=>Go);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)};class wp extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class tw extends wp{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class sw extends wp{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class nw extends wp{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Cf;(function(i){i.Any="any",i.ApNortheast1="ap-northeast-1",i.ApNortheast2="ap-northeast-2",i.ApSouth1="ap-south-1",i.ApSoutheast1="ap-southeast-1",i.ApSoutheast2="ap-southeast-2",i.CaCentral1="ca-central-1",i.EuCentral1="eu-central-1",i.EuWest1="eu-west-1",i.EuWest2="eu-west-2",i.EuWest3="eu-west-3",i.SaEast1="sa-east-1",i.UsEast1="us-east-1",i.UsWest1="us-west-1",i.UsWest2="us-west-2"})(Cf||(Cf={}));var iw=function(i,e,t,s){function n(r){return r instanceof t?r:new t(function(a){a(r)})}return new(t||(t=Promise))(function(r,a){function o(h){try{c(s.next(h))}catch(d){a(d)}}function l(h){try{c(s.throw(h))}catch(d){a(d)}}function c(h){h.done?r(h.value):n(h.value).then(o,l)}c((s=s.apply(i,e||[])).next())})};class rw{constructor(e,{headers:t={},customFetch:s,region:n=Cf.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=ew(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return iw(this,void 0,void 0,function*(){try{const{headers:n,method:r,body:a}=t;let o={},{region:l}=t;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let c;a&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",c=a):typeof a=="string"?(o["Content-Type"]="text/plain",c=a):typeof FormData<"u"&&a instanceof FormData?c=a:(o["Content-Type"]="application/json",c=JSON.stringify(a)));const h=yield this.fetch(`${this.url}/${e}`,{method:r||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),n),body:c}).catch(v=>{throw new tw(v)}),d=h.headers.get("x-relay-error");if(d&&d==="true")throw new sw(h);if(!h.ok)throw new nw(h);let p=((s=h.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),f;return p==="application/json"?f=yield h.json():p==="application/octet-stream"?f=yield h.blob():p==="text/event-stream"?f=h:p==="multipart/form-data"?f=yield h.formData():f=yield h.text(),{data:f,error:null}}catch(n){return{data:null,error:n}}})}}var wn={},xp={},Iu={},Pc={},Ru={},Ou={},aw=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},$o=aw();const ow=$o.fetch,U0=$o.fetch.bind($o),z0=$o.Headers,lw=$o.Request,cw=$o.Response,Go=Object.freeze(Object.defineProperty({__proto__:null,Headers:z0,Request:lw,Response:cw,default:U0,fetch:ow},Symbol.toStringTag,{value:"Module"})),hw=Cy(Go);var Mu={};Object.defineProperty(Mu,"__esModule",{value:!0});let uw=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Mu.default=uw;var H0=Vn&&Vn.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Ou,"__esModule",{value:!0});const dw=H0(hw),fw=H0(Mu);let pw=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=dw.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const s=this.fetch;let n=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async r=>{var a,o,l;let c=null,h=null,d=null,p=r.status,f=r.statusText;if(r.ok){if(this.method!=="HEAD"){const x=await r.text();x===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?h=x:h=JSON.parse(x))}const w=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),A=(o=r.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");w&&A&&A.length>1&&(d=parseInt(A[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(h)&&(h.length>1?(c={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,d=null,p=406,f="Not Acceptable"):h.length===1?h=h[0]:h=null)}else{const w=await r.text();try{c=JSON.parse(w),Array.isArray(c)&&r.status===404&&(h=[],c=null,p=200,f="OK")}catch{r.status===404&&w===""?(p=204,f="No Content"):c={message:w}}if(c&&this.isMaybeSingle&&(!((l=c?.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,p=200,f="OK"),c&&this.shouldThrowOnError)throw new fw.default(c)}return{error:c,data:h,count:d,status:p,statusText:f}});return this.shouldThrowOnError||(n=n.catch(r=>{var a,o,l;return{error:{message:`${(a=r?.name)!==null&&a!==void 0?a:"FetchError"}: ${r?.message}`,details:`${(o=r?.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=r?.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),n.then(e,t)}};Ou.default=pw;var mw=Vn&&Vn.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Ru,"__esModule",{value:!0});const gw=mw(Ou);let bw=class extends gw.default{select(e){let t=!1;const s=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:n,referencedTable:r=n}={}){const a=r?`${r}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){const n=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:n=s}={}){const r=typeof n>"u"?"offset":`${n}.offset`,a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(r,`${e}`),this.url.searchParams.set(a,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:n=!1,wal:r=!1,format:a="text"}={}){var o;const l=[e?"analyze":null,t?"verbose":null,s?"settings":null,n?"buffers":null,r?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${c}"; options=${l};`,a==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Ru.default=bw;var yw=Vn&&Vn.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Pc,"__esModule",{value:!0});const vw=yw(Ru);let ww=class extends vw.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map(n=>typeof n=="string"&&new RegExp("[,()]").test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:n}={}){let r="";n==="plain"?r="pl":n==="phrase"?r="ph":n==="websearch"&&(r="w");const a=s===void 0?"":`(${s})`;return this.url.searchParams.append(e,`${r}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([t,s])=>{this.url.searchParams.append(t,`eq.${s}`)}),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){const n=s?`${s}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}};Pc.default=ww;var xw=Vn&&Vn.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Iu,"__esModule",{value:!0});const Pl=xw(Pc);let _w=class{constructor(e,{headers:t={},schema:s,fetch:n}){this.url=e,this.headers=t,this.schema=s,this.fetch=n}select(e,{head:t=!1,count:s}={}){const n=t?"HEAD":"GET";let r=!1;const a=(e??"*").split("").map(o=>/\s/.test(o)&&!r?"":(o==='"'&&(r=!r),o)).join("");return this.url.searchParams.set("select",a),s&&(this.headers.Prefer=`count=${s}`),new Pl.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:s=!0}={}){const n="POST",r=[];if(this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),s||r.push("missing=default"),this.headers.Prefer=r.join(","),Array.isArray(e)){const a=e.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(a.length>0){const o=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new Pl.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:n,defaultToNull:r=!0}={}){const a="POST",o=[`resolution=${s?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&o.push(this.headers.Prefer),n&&o.push(`count=${n}`),r||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(e)){const l=e.reduce((c,h)=>c.concat(Object.keys(h)),[]);if(l.length>0){const c=[...new Set(l)].map(h=>`"${h}"`);this.url.searchParams.set("columns",c.join(","))}}return new Pl.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const s="PATCH",n=[];return this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),this.headers.Prefer=n.join(","),new Pl.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",s=[];return e&&s.push(`count=${e}`),this.headers.Prefer&&s.unshift(this.headers.Prefer),this.headers.Prefer=s.join(","),new Pl.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Iu.default=_w;var Fu={},Du={};Object.defineProperty(Du,"__esModule",{value:!0});Du.version=void 0;Du.version="0.0.0-automated";Object.defineProperty(Fu,"__esModule",{value:!0});Fu.DEFAULT_HEADERS=void 0;const Aw=Du;Fu.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Aw.version}`};var W0=Vn&&Vn.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(xp,"__esModule",{value:!0});const Sw=W0(Iu),Nw=W0(Pc),Ew=Fu;let kw=class V0{constructor(e,{headers:t={},schema:s,fetch:n}={}){this.url=e,this.headers=Object.assign(Object.assign({},Ew.DEFAULT_HEADERS),t),this.schemaName=s,this.fetch=n}from(e){const t=new URL(`${this.url}/${e}`);return new Sw.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new V0(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:n=!1,count:r}={}){let a;const o=new URL(`${this.url}/rpc/${e}`);let l;s||n?(a=s?"HEAD":"GET",Object.entries(t).filter(([h,d])=>d!==void 0).map(([h,d])=>[h,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([h,d])=>{o.searchParams.append(h,d)})):(a="POST",l=t);const c=Object.assign({},this.headers);return r&&(c.Prefer=`count=${r}`),new Nw.default({method:a,url:o,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};xp.default=kw;var Xo=Vn&&Vn.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(wn,"__esModule",{value:!0});wn.PostgrestError=wn.PostgrestBuilder=wn.PostgrestTransformBuilder=wn.PostgrestFilterBuilder=wn.PostgrestQueryBuilder=wn.PostgrestClient=void 0;const G0=Xo(xp);wn.PostgrestClient=G0.default;const X0=Xo(Iu);wn.PostgrestQueryBuilder=X0.default;const Y0=Xo(Pc);wn.PostgrestFilterBuilder=Y0.default;const K0=Xo(Ru);wn.PostgrestTransformBuilder=K0.default;const J0=Xo(Ou);wn.PostgrestBuilder=J0.default;const Z0=Xo(Mu);wn.PostgrestError=Z0.default;var Cw=wn.default={PostgrestClient:G0.default,PostgrestQueryBuilder:X0.default,PostgrestFilterBuilder:Y0.default,PostgrestTransformBuilder:K0.default,PostgrestBuilder:J0.default,PostgrestError:Z0.default};const{PostgrestClient:Pw,PostgrestQueryBuilder:ck,PostgrestFilterBuilder:hk,PostgrestTransformBuilder:uk,PostgrestBuilder:dk,PostgrestError:fk}=Cw,Lw="2.11.2",Tw={"X-Client-Info":`realtime-js/${Lw}`},jw="1.0.0",Q0=1e4,Iw=1e3;var Lo;(function(i){i[i.connecting=0]="connecting",i[i.open=1]="open",i[i.closing=2]="closing",i[i.closed=3]="closed"})(Lo||(Lo={}));var Pn;(function(i){i.closed="closed",i.errored="errored",i.joined="joined",i.joining="joining",i.leaving="leaving"})(Pn||(Pn={}));var ui;(function(i){i.close="phx_close",i.error="phx_error",i.join="phx_join",i.reply="phx_reply",i.leave="phx_leave",i.access_token="access_token"})(ui||(ui={}));var Pf;(function(i){i.websocket="websocket"})(Pf||(Pf={}));var pa;(function(i){i.Connecting="connecting",i.Open="open",i.Closing="closing",i.Closed="closed"})(pa||(pa={}));class Rw{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const n=t.getUint8(1),r=t.getUint8(2);let a=this.HEADER_LENGTH+2;const o=s.decode(e.slice(a,a+n));a=a+n;const l=s.decode(e.slice(a,a+r));a=a+r;const c=JSON.parse(s.decode(e.slice(a,e.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class e1{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Jt;(function(i){i.abstime="abstime",i.bool="bool",i.date="date",i.daterange="daterange",i.float4="float4",i.float8="float8",i.int2="int2",i.int4="int4",i.int4range="int4range",i.int8="int8",i.int8range="int8range",i.json="json",i.jsonb="jsonb",i.money="money",i.numeric="numeric",i.oid="oid",i.reltime="reltime",i.text="text",i.time="time",i.timestamp="timestamp",i.timestamptz="timestamptz",i.timetz="timetz",i.tsrange="tsrange",i.tstzrange="tstzrange"})(Jt||(Jt={}));const Qm=(i,e,t={})=>{var s;const n=(s=t.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((r,a)=>(r[a]=Ow(a,i,e,n),r),{})},Ow=(i,e,t,s)=>{const n=e.find(o=>o.name===i),r=n?.type,a=t[i];return r&&!s.includes(r)?t1(r,a):Lf(a)},t1=(i,e)=>{if(i.charAt(0)==="_"){const t=i.slice(1,i.length);return Bw(e,t)}switch(i){case Jt.bool:return Mw(e);case Jt.float4:case Jt.float8:case Jt.int2:case Jt.int4:case Jt.int8:case Jt.numeric:case Jt.oid:return Fw(e);case Jt.json:case Jt.jsonb:return Dw(e);case Jt.timestamp:return $w(e);case Jt.abstime:case Jt.date:case Jt.daterange:case Jt.int4range:case Jt.int8range:case Jt.money:case Jt.reltime:case Jt.text:case Jt.time:case Jt.timestamptz:case Jt.timetz:case Jt.tsrange:case Jt.tstzrange:return Lf(e);default:return Lf(e)}},Lf=i=>i,Mw=i=>{switch(i){case"t":return!0;case"f":return!1;default:return i}},Fw=i=>{if(typeof i=="string"){const e=parseFloat(i);if(!Number.isNaN(e))return e}return i},Dw=i=>{if(typeof i=="string")try{return JSON.parse(i)}catch(e){return console.log(`JSON parse error: ${e}`),i}return i},Bw=(i,e)=>{if(typeof i!="string")return i;const t=i.length-1,s=i[t];if(i[0]==="{"&&s==="}"){let r;const a=i.slice(1,t);try{r=JSON.parse("["+a+"]")}catch{r=a?a.split(","):[]}return r.map(o=>t1(e,o))}return i},$w=i=>typeof i=="string"?i.replace(" ","T"):i,s1=i=>{let e=i;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Gd{constructor(e,t,s={},n=Q0){this.channel=e,this.event=t,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var eg;(function(i){i.SYNC="sync",i.JOIN="join",i.LEAVE="leave"})(eg||(eg={}));class Zl{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:r,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Zl.syncState(this.state,n,r,a),this.pendingDiffs.forEach(l=>{this.state=Zl.syncDiff(this.state,l,r,a)}),this.pendingDiffs=[],o()}),this.channel._on(s.diff,{},n=>{const{onJoin:r,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=Zl.syncDiff(this.state,n,r,a),o())}),this.onJoin((n,r,a)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:r,newPresences:a})}),this.onLeave((n,r,a)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:r,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,n){const r=this.cloneDeep(e),a=this.transformState(t),o={},l={};return this.map(r,(c,h)=>{a[c]||(l[c]=h)}),this.map(a,(c,h)=>{const d=r[c];if(d){const p=h.map(A=>A.presence_ref),f=d.map(A=>A.presence_ref),v=h.filter(A=>f.indexOf(A.presence_ref)<0),w=d.filter(A=>p.indexOf(A.presence_ref)<0);v.length>0&&(o[c]=v),w.length>0&&(l[c]=w)}else o[c]=h}),this.syncDiff(r,{joins:o,leaves:l},s,n)}static syncDiff(e,t,s,n){const{joins:r,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(r,(o,l)=>{var c;const h=(c=e[o])!==null&&c!==void 0?c:[];if(e[o]=this.cloneDeep(l),h.length>0){const d=e[o].map(f=>f.presence_ref),p=h.filter(f=>d.indexOf(f.presence_ref)<0);e[o].unshift(...p)}s(o,h,l)}),this.map(a,(o,l)=>{let c=e[o];if(!c)return;const h=l.map(d=>d.presence_ref);c=c.filter(d=>h.indexOf(d.presence_ref)<0),e[o]=c,n(o,c,l),c.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const n=e[s];return"metas"in n?t[s]=n.metas.map(r=>(r.presence_ref=r.phx_ref,delete r.phx_ref,delete r.phx_ref_prev,r)):t[s]=n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var tg;(function(i){i.ALL="*",i.INSERT="INSERT",i.UPDATE="UPDATE",i.DELETE="DELETE"})(tg||(tg={}));var sg;(function(i){i.BROADCAST="broadcast",i.PRESENCE="presence",i.POSTGRES_CHANGES="postgres_changes",i.SYSTEM="system"})(sg||(sg={}));var hr;(function(i){i.SUBSCRIBED="SUBSCRIBED",i.TIMED_OUT="TIMED_OUT",i.CLOSED="CLOSED",i.CHANNEL_ERROR="CHANNEL_ERROR"})(hr||(hr={}));class _p{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=Pn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Gd(this,ui.join,this.params,this.timeout),this.rejoinTimer=new e1(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Pn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Pn.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=Pn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Pn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ui.reply,{},(n,r)=>{this._trigger(this._replyEventName(r),n)}),this.presence=new Zl(this),this.broadcastEndpointURL=s1(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,n;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:r,presence:a,private:o}}=this.params;this._onError(h=>e?.(hr.CHANNEL_ERROR,h)),this._onClose(()=>e?.(hr.CLOSED));const l={},c={broadcast:r,presence:a,postgres_changes:(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(h=>h.filter))!==null&&n!==void 0?n:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:h})=>{var d;if(this.socket.setAuth(),h===void 0){e?.(hr.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,f=(d=p?.length)!==null&&d!==void 0?d:0,v=[];for(let w=0;w<f;w++){const A=p[w],{filter:{event:x,schema:S,table:j,filter:M}}=A,B=h&&h[w];if(B&&B.event===x&&B.schema===S&&B.table===j&&B.filter===M)v.push(Object.assign(Object.assign({},A),{id:B.id}));else{this.unsubscribe(),e?.(hr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,e&&e(hr.SUBSCRIBED);return}}).receive("error",h=>{e?.(hr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{e?.(hr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this._on(e,t,s)}async send(e,t={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){const{event:r,payload:a}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:r,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=c.body)===null||n===void 0?void 0:n.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(r=>{var a,o,l;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&r("ok"),c.receive("ok",()=>r("ok")),c.receive("error",()=>r("error")),c.receive("timeout",()=>r("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Pn.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ui.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(s=>{const n=new Gd(this,ui.leave,{},e);n.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})})}async _fetchWithTimeout(e,t,s){const n=new AbortController,r=setTimeout(()=>n.abort(),s),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(r),a}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Gd(this,e,t,s);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var n,r;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:c,join:h}=ui;if(s&&[o,l,c,h].indexOf(a)>=0&&s!==this._joinRef())return;let p=this._onMessage(a,t,s);if(t&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(f=>{var v,w,A;return((v=f.filter)===null||v===void 0?void 0:v.event)==="*"||((A=(w=f.filter)===null||w===void 0?void 0:w.event)===null||A===void 0?void 0:A.toLocaleLowerCase())===a}).map(f=>f.callback(p,s)):(r=this.bindings[a])===null||r===void 0||r.filter(f=>{var v,w,A,x,S,j;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in f){const M=f.id,B=(v=f.filter)===null||v===void 0?void 0:v.event;return M&&((w=t.ids)===null||w===void 0?void 0:w.includes(M))&&(B==="*"||B?.toLocaleLowerCase()===((A=t.data)===null||A===void 0?void 0:A.type.toLocaleLowerCase()))}else{const M=(S=(x=f?.filter)===null||x===void 0?void 0:x.event)===null||S===void 0?void 0:S.toLocaleLowerCase();return M==="*"||M===((j=t?.event)===null||j===void 0?void 0:j.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===a}).map(f=>{if(typeof p=="object"&&"ids"in p){const v=p.data,{schema:w,table:A,commit_timestamp:x,type:S,errors:j}=v;p=Object.assign(Object.assign({},{schema:w,table:A,commit_timestamp:x,eventType:S,new:{},old:{},errors:j}),this._getPayloadRecords(v))}f.callback(p,s)})}_isClosed(){return this.state===Pn.closed}_isJoined(){return this.state===Pn.joined}_isJoining(){return this.state===Pn.joining}_isLeaving(){return this.state===Pn.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const n=e.toLocaleLowerCase(),r={type:n,filter:t,callback:s};return this.bindings[n]?this.bindings[n].push(r):this.bindings[n]=[r],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(n=>{var r;return!(((r=n.type)===null||r===void 0?void 0:r.toLocaleLowerCase())===s&&_p.isEqual(n.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ui.close,{},e)}_onError(e){this._on(ui.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Pn.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Qm(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Qm(e.columns,e.old_record)),t}}const qw=()=>{},Uw=typeof WebSocket<"u",zw=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Hw{constructor(e,t){var s;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=Tw,this.params={},this.timeout=Q0,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=qw,this.conn=null,this.sendBuffer=[],this.serializer=new Rw,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=r=>{let a;return r?a=r:typeof fetch>"u"?a=(...o)=>fr(async()=>{const{default:l}=await Promise.resolve().then(()=>Go);return{default:l}},void 0).then(({default:l})=>l(...o)):a=fetch,(...o)=>a(...o)},this.endPoint=`${e}/${Pf.websocket}`,this.httpEndpoint=s1(e),t?.transport?this.transport=t.transport:this.transport=null,t?.params&&(this.params=t.params),t?.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t?.timeout&&(this.timeout=t.timeout),t?.logger&&(this.logger=t.logger),t?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const n=(s=t?.params)===null||s===void 0?void 0:s.apikey;if(n&&(this.accessTokenValue=n,this.apiKey=n),this.reconnectAfterMs=t?.reconnectAfterMs?t.reconnectAfterMs:r=>[1e3,2e3,5e3,1e4][r-1]||1e4,this.encode=t?.encode?t.encode:(r,a)=>a(JSON.stringify(r)),this.decode=t?.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new e1(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t?.fetch),t?.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=t?.worker||!1,this.workerUrl=t?.workerUrl}this.accessToken=t?.accessToken||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(Uw){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new Ww(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),fr(async()=>{const{default:e}=await import("./browser-Dwhluaoo.js").then(t=>t.b);return{default:e}},__vite__mapDeps([0,1])).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:jw}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Lo.connecting:return pa.Connecting;case Lo.open:return pa.Open;case Lo.closing:return pa.Closing;default:return pa.Closed}}isConnected(){return this.connectionState()===pa.Open}channel(e,t={config:{}}){const s=new _p(`realtime:${e}`,t,this);return this.channels.push(s),s}push(e){const{topic:t,event:s,payload:n,ref:r}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${t} ${s} (${r})`,n),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let s=null;try{s=JSON.parse(atob(t.split(".")[1]))}catch{}if(s&&s.exp&&!(Math.floor(Date.now()/1e3)-s.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${s.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${s.exp}`);this.accessTokenValue=t,this.channels.forEach(n=>{t&&n.updateJoinPayload({access_token:t}),n.joinedOnce&&n._isJoined()&&n._push(ui.access_token,{access_token:t})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(Iw,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:s,event:n,payload:r,ref:a}=t;a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${r.status||""} ${s} ${n} ${a&&"("+a+")"||""}`,r),this.channels.filter(o=>o._isMember(s)).forEach(o=>o._trigger(n,r,a)),this.stateChangeCallbacks.message.forEach(o=>o(t))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(ui.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${e}${s}${n}`}_workerObjectUrl(e){let t;if(e)t=e;else{const s=new Blob([zw],{type:"application/javascript"});t=URL.createObjectURL(s)}return t}}class Ww{constructor(e,t,s){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Lo.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=s.close}}class Ap extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Ms(i){return typeof i=="object"&&i!==null&&"__isStorageError"in i}class Vw extends Ap{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Tf extends Ap{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Gw=function(i,e,t,s){function n(r){return r instanceof t?r:new t(function(a){a(r)})}return new(t||(t=Promise))(function(r,a){function o(h){try{c(s.next(h))}catch(d){a(d)}}function l(h){try{c(s.throw(h))}catch(d){a(d)}}function c(h){h.done?r(h.value):n(h.value).then(o,l)}c((s=s.apply(i,e||[])).next())})};const n1=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...t)=>fr(async()=>{const{default:s}=await Promise.resolve().then(()=>Go);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},Xw=()=>Gw(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield fr(()=>Promise.resolve().then(()=>Go),void 0)).Response:Response}),jf=i=>{if(Array.isArray(i))return i.map(t=>jf(t));if(typeof i=="function"||i!==Object(i))return i;const e={};return Object.entries(i).forEach(([t,s])=>{const n=t.replace(/([-_][a-z])/gi,r=>r.toUpperCase().replace(/[-_]/g,""));e[n]=jf(s)}),e};var Pa=function(i,e,t,s){function n(r){return r instanceof t?r:new t(function(a){a(r)})}return new(t||(t=Promise))(function(r,a){function o(h){try{c(s.next(h))}catch(d){a(d)}}function l(h){try{c(s.throw(h))}catch(d){a(d)}}function c(h){h.done?r(h.value):n(h.value).then(o,l)}c((s=s.apply(i,e||[])).next())})};const Xd=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),Yw=(i,e,t)=>Pa(void 0,void 0,void 0,function*(){const s=yield Xw();i instanceof s&&!t?.noResolveJson?i.json().then(n=>{e(new Vw(Xd(n),i.status||500))}).catch(n=>{e(new Tf(Xd(n),n))}):e(new Tf(Xd(i),i))}),Kw=(i,e,t,s)=>{const n={method:i,headers:e?.headers||{}};return i==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json"},e?.headers),s&&(n.body=JSON.stringify(s)),Object.assign(Object.assign({},n),t))};function Lc(i,e,t,s,n,r){return Pa(this,void 0,void 0,function*(){return new Promise((a,o)=>{i(t,Kw(e,s,n,r)).then(l=>{if(!l.ok)throw l;return s?.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>Yw(l,o,s))})})}function fu(i,e,t,s){return Pa(this,void 0,void 0,function*(){return Lc(i,"GET",e,t,s)})}function Mr(i,e,t,s,n){return Pa(this,void 0,void 0,function*(){return Lc(i,"POST",e,s,n,t)})}function Jw(i,e,t,s,n){return Pa(this,void 0,void 0,function*(){return Lc(i,"PUT",e,s,n,t)})}function Zw(i,e,t,s){return Pa(this,void 0,void 0,function*(){return Lc(i,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),s)})}function i1(i,e,t,s,n){return Pa(this,void 0,void 0,function*(){return Lc(i,"DELETE",e,s,n,t)})}var gn=function(i,e,t,s){function n(r){return r instanceof t?r:new t(function(a){a(r)})}return new(t||(t=Promise))(function(r,a){function o(h){try{c(s.next(h))}catch(d){a(d)}}function l(h){try{c(s.throw(h))}catch(d){a(d)}}function c(h){h.done?r(h.value):n(h.value).then(o,l)}c((s=s.apply(i,e||[])).next())})};const Qw={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ng={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class e5{constructor(e,t={},s,n){this.url=e,this.headers=t,this.bucketId=s,this.fetch=n1(n)}uploadOrUpdate(e,t,s,n){return gn(this,void 0,void 0,function*(){try{let r;const a=Object.assign(Object.assign({},ng),n);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&s instanceof Blob?(r=new FormData,r.append("cacheControl",a.cacheControl),l&&r.append("metadata",this.encodeMetadata(l)),r.append("",s)):typeof FormData<"u"&&s instanceof FormData?(r=s,r.append("cacheControl",a.cacheControl),l&&r.append("metadata",this.encodeMetadata(l))):(r=s,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),n?.headers&&(o=Object.assign(Object.assign({},o),n.headers));const c=this._removeEmptyFolders(t),h=this._getFinalPath(c),d=yield this.fetch(`${this.url}/object/${h}`,Object.assign({method:e,body:r,headers:o},a?.duplex?{duplex:a.duplex}:{})),p=yield d.json();return d.ok?{data:{path:c,id:p.Id,fullPath:p.Key},error:null}:{data:null,error:p}}catch(r){if(Ms(r))return{data:null,error:r};throw r}})}upload(e,t,s){return gn(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,n){return gn(this,void 0,void 0,function*(){const r=this._removeEmptyFolders(e),a=this._getFinalPath(r),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",t);try{let l;const c=Object.assign({upsert:ng.upsert},n),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&s instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",s)):typeof FormData<"u"&&s instanceof FormData?(l=s,l.append("cacheControl",c.cacheControl)):(l=s,h["cache-control"]=`max-age=${c.cacheControl}`,h["content-type"]=c.contentType);const d=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:h}),p=yield d.json();return d.ok?{data:{path:r,fullPath:p.Key},error:null}:{data:null,error:p}}catch(l){if(Ms(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return gn(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const n=Object.assign({},this.headers);t?.upsert&&(n["x-upsert"]="true");const r=yield Mr(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:n}),a=new URL(this.url+r.url),o=a.searchParams.get("token");if(!o)throw new Ap("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:o},error:null}}catch(s){if(Ms(s))return{data:null,error:s};throw s}})}update(e,t,s){return gn(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return gn(this,void 0,void 0,function*(){try{return{data:yield Mr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s?.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(Ms(n))return{data:null,error:n};throw n}})}copy(e,t,s){return gn(this,void 0,void 0,function*(){try{return{data:{path:(yield Mr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(Ms(n))return{data:null,error:n};throw n}})}createSignedUrl(e,t,s){return gn(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),r=yield Mr(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},s?.transform?{transform:s.transform}:{}),{headers:this.headers});const a=s?.download?`&download=${s.download===!0?"":s.download}`:"";return r={signedUrl:encodeURI(`${this.url}${r.signedURL}${a}`)},{data:r,error:null}}catch(n){if(Ms(n))return{data:null,error:n};throw n}})}createSignedUrls(e,t,s){return gn(this,void 0,void 0,function*(){try{const n=yield Mr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),r=s?.download?`&download=${s.download===!0?"":s.download}`:"";return{data:n.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${r}`):null})),error:null}}catch(n){if(Ms(n))return{data:null,error:n};throw n}})}download(e,t){return gn(this,void 0,void 0,function*(){const n=typeof t?.transform<"u"?"render/image/authenticated":"object",r=this.transformOptsToQueryString(t?.transform||{}),a=r?`?${r}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield fu(this.fetch,`${this.url}/${n}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Ms(o))return{data:null,error:o};throw o}})}info(e){return gn(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const s=yield fu(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:jf(s),error:null}}catch(s){if(Ms(s))return{data:null,error:s};throw s}})}exists(e){return gn(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield Zw(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(Ms(s)&&s instanceof Tf){const n=s.originalError;if([400,404].includes(n?.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,t){const s=this._getFinalPath(e),n=[],r=t?.download?`download=${t.download===!0?"":t.download}`:"";r!==""&&n.push(r);const o=typeof t?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(t?.transform||{});l!==""&&n.push(l);let c=n.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${s}${c}`)}}}remove(e){return gn(this,void 0,void 0,function*(){try{return{data:yield i1(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Ms(t))return{data:null,error:t};throw t}})}list(e,t,s){return gn(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},Qw),t),{prefix:e||""});return{data:yield Mr(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(Ms(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const t5="2.7.1",s5={"X-Client-Info":`storage-js/${t5}`};var ho=function(i,e,t,s){function n(r){return r instanceof t?r:new t(function(a){a(r)})}return new(t||(t=Promise))(function(r,a){function o(h){try{c(s.next(h))}catch(d){a(d)}}function l(h){try{c(s.throw(h))}catch(d){a(d)}}function c(h){h.done?r(h.value):n(h.value).then(o,l)}c((s=s.apply(i,e||[])).next())})};class n5{constructor(e,t={},s){this.url=e,this.headers=Object.assign(Object.assign({},s5),t),this.fetch=n1(s)}listBuckets(){return ho(this,void 0,void 0,function*(){try{return{data:yield fu(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Ms(e))return{data:null,error:e};throw e}})}getBucket(e){return ho(this,void 0,void 0,function*(){try{return{data:yield fu(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Ms(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return ho(this,void 0,void 0,function*(){try{return{data:yield Mr(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Ms(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return ho(this,void 0,void 0,function*(){try{return{data:yield Jw(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Ms(s))return{data:null,error:s};throw s}})}emptyBucket(e){return ho(this,void 0,void 0,function*(){try{return{data:yield Mr(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Ms(t))return{data:null,error:t};throw t}})}deleteBucket(e){return ho(this,void 0,void 0,function*(){try{return{data:yield i1(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Ms(t))return{data:null,error:t};throw t}})}}class i5 extends n5{constructor(e,t={},s){super(e,t,s)}from(e){return new e5(this.url,this.headers,e,this.fetch)}}const r5="2.47.8";let ql="";typeof Deno<"u"?ql="deno":typeof document<"u"?ql="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ql="react-native":ql="node";const a5={"X-Client-Info":`supabase-js-${ql}/${r5}`},o5={headers:a5},l5={schema:"public"},c5={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},h5={};var u5=function(i,e,t,s){function n(r){return r instanceof t?r:new t(function(a){a(r)})}return new(t||(t=Promise))(function(r,a){function o(h){try{c(s.next(h))}catch(d){a(d)}}function l(h){try{c(s.throw(h))}catch(d){a(d)}}function c(h){h.done?r(h.value):n(h.value).then(o,l)}c((s=s.apply(i,e||[])).next())})};const d5=i=>{let e;return i?e=i:typeof fetch>"u"?e=U0:e=fetch,(...t)=>e(...t)},f5=()=>typeof Headers>"u"?z0:Headers,p5=(i,e,t)=>{const s=d5(t),n=f5();return(r,a)=>u5(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:i;let c=new n(a?.headers);return c.has("apikey")||c.set("apikey",i),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),s(r,Object.assign(Object.assign({},a),{headers:c}))})};var m5=function(i,e,t,s){function n(r){return r instanceof t?r:new t(function(a){a(r)})}return new(t||(t=Promise))(function(r,a){function o(h){try{c(s.next(h))}catch(d){a(d)}}function l(h){try{c(s.throw(h))}catch(d){a(d)}}function c(h){h.done?r(h.value):n(h.value).then(o,l)}c((s=s.apply(i,e||[])).next())})};function g5(i){return i.replace(/\/$/,"")}function b5(i,e){const{db:t,auth:s,realtime:n,global:r}=i,{db:a,auth:o,realtime:l,global:c}=e,h={db:Object.assign(Object.assign({},a),t),auth:Object.assign(Object.assign({},o),s),realtime:Object.assign(Object.assign({},l),n),global:Object.assign(Object.assign({},c),r),accessToken:()=>m5(this,void 0,void 0,function*(){return""})};return i.accessToken?h.accessToken=i.accessToken:delete h.accessToken,h}const r1="2.67.1",y5="http://localhost:9999",v5="supabase.auth.token",w5={"X-Client-Info":`gotrue-js/${r1}`},ig=10,If="X-Supabase-Api-Version",a1={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function x5(i){return Math.round(Date.now()/1e3)+i}function _5(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){const e=Math.random()*16|0;return(i=="x"?e:e&3|8).toString(16)})}const ai=()=>typeof document<"u",ca={tested:!1,writable:!1},Ql=()=>{if(!ai())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ca.tested)return ca.writable;const i=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(i,i),globalThis.localStorage.removeItem(i),ca.tested=!0,ca.writable=!0}catch{ca.tested=!0,ca.writable=!1}return ca.writable};function Yd(i){const e={},t=new URL(i);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((n,r)=>{e[r]=n})}catch{}return t.searchParams.forEach((s,n)=>{e[n]=s}),e}const o1=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...t)=>fr(async()=>{const{default:s}=await Promise.resolve().then(()=>Go);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},A5=i=>typeof i=="object"&&i!==null&&"status"in i&&"ok"in i&&"json"in i&&typeof i.json=="function",l1=async(i,e,t)=>{await i.setItem(e,JSON.stringify(t))},Ih=async(i,e)=>{const t=await i.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Rh=async(i,e)=>{await i.removeItem(e)};function S5(i){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let t="",s,n,r,a,o,l,c,h=0;for(i=i.replace("-","+").replace("_","/");h<i.length;)a=e.indexOf(i.charAt(h++)),o=e.indexOf(i.charAt(h++)),l=e.indexOf(i.charAt(h++)),c=e.indexOf(i.charAt(h++)),s=a<<2|o>>4,n=(o&15)<<4|l>>2,r=(l&3)<<6|c,t=t+String.fromCharCode(s),l!=64&&n!=0&&(t=t+String.fromCharCode(n)),c!=64&&r!=0&&(t=t+String.fromCharCode(r));return t}class Bu{constructor(){this.promise=new Bu.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Bu.promiseConstructor=Promise;function rg(i){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,t=i.split(".");if(t.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const s=t[1];return JSON.parse(S5(s))}async function N5(i){return await new Promise(e=>{setTimeout(()=>e(null),i)})}function E5(i,e){return new Promise((s,n)=>{(async()=>{for(let r=0;r<1/0;r++)try{const a=await i(r);if(!e(r,null,a)){s(a);return}}catch(a){if(!e(r,a)){n(a);return}}})()})}function k5(i){return("0"+i.toString(16)).substr(-2)}function C5(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let n="";for(let r=0;r<56;r++)n+=t.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,k5).join("")}async function P5(i){const t=new TextEncoder().encode(i),s=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(s);return Array.from(n).map(r=>String.fromCharCode(r)).join("")}function L5(i){return btoa(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function T5(i){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),i;const t=await P5(i);return L5(t)}async function uo(i,e,t=!1){const s=C5();let n=s;t&&(n+="/PASSWORD_RECOVERY"),await l1(i,`${e}-code-verifier`,n);const r=await T5(s);return[r,s===r?"plain":"s256"]}const j5=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function I5(i){const e=i.headers.get(If);if(!e||!e.match(j5))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class Sp extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function mt(i){return typeof i=="object"&&i!==null&&"__isAuthError"in i}class R5 extends Sp{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function O5(i){return mt(i)&&i.name==="AuthApiError"}class c1 extends Sp{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class La extends Sp{constructor(e,t,s,n){super(e,s,n),this.name=t,this.status=s}}class Rr extends La{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function M5(i){return mt(i)&&i.name==="AuthSessionMissingError"}class Kd extends La{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Oh extends La{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Mh extends La{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function F5(i){return mt(i)&&i.name==="AuthImplicitGrantRedirectError"}class ag extends La{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Rf extends La{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Jd(i){return mt(i)&&i.name==="AuthRetryableFetchError"}class og extends La{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}var D5=function(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(i);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(i,s[n])&&(t[s[n]]=i[s[n]]);return t};const ua=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),B5=[502,503,504];async function lg(i){var e;if(!A5(i))throw new Rf(ua(i),0);if(B5.includes(i.status))throw new Rf(ua(i),i.status);let t;try{t=await i.json()}catch(r){throw new c1(ua(r),r)}let s;const n=I5(i);if(n&&n.getTime()>=a1["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?s=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(s=t.error_code),s){if(s==="weak_password")throw new og(ua(t),i.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new Rr}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0))throw new og(ua(t),i.status,t.weak_password.reasons);throw new R5(ua(t),i.status||500,s)}const $5=(i,e,t,s)=>{const n={method:i,headers:e?.headers||{}};return i==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),t))};async function St(i,e,t,s){var n;const r=Object.assign({},s?.headers);r[If]||(r[If]=a1["2024-01-01"].name),s?.jwt&&(r.Authorization=`Bearer ${s.jwt}`);const a=(n=s?.query)!==null&&n!==void 0?n:{};s?.redirectTo&&(a.redirect_to=s.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await q5(i,e,t+o,{headers:r,noResolveJson:s?.noResolveJson},{},s?.body);return s?.xform?s?.xform(l):{data:Object.assign({},l),error:null}}async function q5(i,e,t,s,n,r){const a=$5(e,s,n,r);let o;try{o=await i(t,Object.assign({},a))}catch(l){throw console.error(l),new Rf(ua(l),0)}if(o.ok||await lg(o),s?.noResolveJson)return o;try{return await o.json()}catch(l){await lg(l)}}function Or(i){var e;let t=null;W5(i)&&(t=Object.assign({},i),i.expires_at||(t.expires_at=x5(i.expires_in)));const s=(e=i.user)!==null&&e!==void 0?e:i;return{data:{session:t,user:s},error:null}}function cg(i){const e=Or(i);return!e.error&&i.weak_password&&typeof i.weak_password=="object"&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.message&&typeof i.weak_password.message=="string"&&i.weak_password.reasons.reduce((t,s)=>t&&typeof s=="string",!0)&&(e.data.weak_password=i.weak_password),e}function Fr(i){var e;return{data:{user:(e=i.user)!==null&&e!==void 0?e:i},error:null}}function U5(i){return{data:i,error:null}}function z5(i){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:n,verification_type:r}=i,a=D5(i,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:s,redirect_to:n,verification_type:r},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function H5(i){return i}function W5(i){return i.access_token&&i.refresh_token&&i.expires_in}var V5=function(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(i);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(i,s[n])&&(t[s[n]]=i[s[n]]);return t};class G5{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=o1(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await St(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(mt(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await St(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Fr})}catch(s){if(mt(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=V5(e,["options"]),n=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(n.new_email=s?.newEmail,delete n.newEmail),await St(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:z5,redirectTo:t?.redirectTo})}catch(t){if(mt(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await St(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Fr})}catch(t){if(mt(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,n,r,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},h=await St(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(r=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:""},xform:H5});if(h.error)throw h.error;const d=await h.json(),p=(a=h.headers.get("x-total-count"))!==null&&a!==void 0?a:0,f=(l=(o=h.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(v=>{const w=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),A=JSON.parse(v.split(";")[1].split("=")[1]);c[`${A}Page`]=w}),c.total=parseInt(p)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(mt(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){try{return await St(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Fr})}catch(t){if(mt(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await St(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Fr})}catch(s){if(mt(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){try{return await St(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Fr})}catch(s){if(mt(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){try{const{data:t,error:s}=await St(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:t,error:s}}catch(t){if(mt(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await St(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(mt(t))return{data:null,error:t};throw t}}}const X5={getItem:i=>Ql()?globalThis.localStorage.getItem(i):null,setItem:(i,e)=>{Ql()&&globalThis.localStorage.setItem(i,e)},removeItem:i=>{Ql()&&globalThis.localStorage.removeItem(i)}};function hg(i={}){return{getItem:e=>i[e]||null,setItem:(e,t)=>{i[e]=t},removeItem:e=>{delete i[e]}}}function Y5(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const fo={debug:!!(globalThis&&Ql()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class h1 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class K5 extends h1{}async function J5(i,e,t){fo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",i,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),fo.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",i)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(i,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){fo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",i,n.name);try{return await t()}finally{fo.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",i,n.name)}}else{if(e===0)throw fo.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",i),new K5(`Acquiring an exclusive Navigator LockManager lock "${i}" immediately failed`);if(fo.debug)try{const r=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(r,null,"  "))}catch(r){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",r)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}Y5();const Z5={url:y5,storageKey:v5,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:w5,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},Ll=30*1e3,ug=3;async function dg(i,e,t){return await t()}class lc{constructor(e){var t,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=lc.nextInstanceID,lc.nextInstanceID+=1,this.instanceID>0&&ai()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},Z5),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new G5({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=o1(n.fetch),this.lock=n.lock||dg,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:ai()&&(!((t=globalThis?.navigator)===null||t===void 0)&&t.locks)?this.lock=J5:this.lock=dg,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:Ql()?this.storage=X5:(this.memoryStorage={},this.storage=hg(this.memoryStorage)):(this.memoryStorage={},this.storage=hg(this.memoryStorage)),ai()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(r){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",r)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async r=>{this._debug("received broadcast notification from other tab or client",r),await this._notifyAllSubscribers(r.data.event,r.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${r1}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=ai()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",t),t||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:s,error:n}=await this._getSessionFromURL(t);if(n){if(this._debug("#_initialize()","error detecting session from URL",n),F5(n)){const o=(e=n.details)===null||e===void 0?void 0:e.code;if(o==="identity_already_exists"||o==="identity_not_found"||o==="single_identity_not_deletable")return{error:n}}return await this._removeSession(),{error:n}}const{session:r,redirectType:a}=s;return this._debug("#_initialize()","detected session in URL",r,"redirect type",a),await this._saveSession(r),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",r):await this._notifyAllSubscribers("SIGNED_IN",r)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return mt(t)?{error:t}:{error:new c1("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,n;try{const r=await St(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e?.options)===null||n===void 0?void 0:n.captchaToken}},xform:Or}),{data:a,error:o}=r;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(r){if(mt(r))return{data:{user:null,session:null},error:r};throw r}}async signUp(e){var t,s,n;try{let r;if("email"in e){const{email:h,password:d,options:p}=e;let f=null,v=null;this.flowType==="pkce"&&([f,v]=await uo(this.storage,this.storageKey)),r=await St(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p?.emailRedirectTo,body:{email:h,password:d,data:(t=p?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:p?.captchaToken},code_challenge:f,code_challenge_method:v},xform:Or})}else if("phone"in e){const{phone:h,password:d,options:p}=e;r=await St(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:d,data:(s=p?.data)!==null&&s!==void 0?s:{},channel:(n=p?.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:p?.captchaToken}},xform:Or})}else throw new Oh("You must provide either an email or phone number and a password");const{data:a,error:o}=r;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(r){if(mt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithPassword(e){try{let t;if("email"in e){const{email:r,password:a,options:o}=e;t=await St(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:a,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:cg})}else if("phone"in e){const{phone:r,password:a,options:o}=e;t=await St(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:a,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:cg})}else throw new Oh("You must provide either an email or phone number and a password");const{data:s,error:n}=t;return n?{data:{user:null,session:null},error:n}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new Kd}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(t){if(mt(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,n,r;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(r=e.options)===null||r===void 0?void 0:r.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await Ih(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(t??"").split("/");try{const{data:r,error:a}=await St(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Or});if(await Rh(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!r||!r.session||!r.user?{data:{user:null,session:null,redirectType:null},error:new Kd}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign(Object.assign({},r),{redirectType:n??null}),error:a})}catch(r){if(mt(r))return{data:{user:null,session:null,redirectType:null},error:r};throw r}}async signInWithIdToken(e){try{const{options:t,provider:s,token:n,access_token:r,nonce:a}=e,o=await St(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:r,nonce:a,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:Or}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Kd}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(t){if(mt(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,n,r,a;try{if("email"in e){const{email:o,options:l}=e;let c=null,h=null;this.flowType==="pkce"&&([c,h]=await uo(this.storage,this.storageKey));const{error:d}=await St(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=l?.data)!==null&&t!==void 0?t:{},create_user:(s=l?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},code_challenge:c,code_challenge_method:h},redirectTo:l?.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:o,options:l}=e,{data:c,error:h}=await St(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(n=l?.data)!==null&&n!==void 0?n:{},create_user:(r=l?.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},channel:(a=l?.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:c?.message_id},error:h}}throw new Oh("You must provide either an email or phone number.")}catch(o){if(mt(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,s;try{let n,r;"options"in e&&(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo,r=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:a,error:o}=await St(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:r}}),redirectTo:n,xform:Or});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,c=a.user;return l?.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(n){if(mt(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var t,s,n;try{let r=null,a=null;return this.flowType==="pkce"&&([r,a]=await uo(this.storage,this.storageKey)),await St(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e?.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:r,code_challenge_method:a}),headers:this.headers,xform:U5})}catch(r){if(mt(r))return{data:null,error:r};throw r}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new Rr;const{error:n}=await St(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(mt(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:r}=e,{error:a}=await St(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:r?.captchaToken}},redirectTo:r?.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:s,type:n,options:r}=e,{data:a,error:o}=await St(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:r?.captchaToken}}});return{data:{user:null,session:null,messageId:a?.message_id},error:o}}throw new Oh("You must provide either an email or phone number and a type")}catch(t){if(mt(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Ih(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.storage.isServer){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,h)=>(!a&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,h))})}return{data:{session:e},error:null}}const{session:n,error:r}=await this._callRefreshToken(e.refresh_token);return r?{data:{session:null},error:r}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await St(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Fr}):await this._useSession(async t=>{var s,n,r;const{data:a,error:o}=t;if(o)throw o;return!(!((s=a.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Rr}:await St(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(r=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&r!==void 0?r:void 0,xform:Fr})})}catch(t){if(mt(t))return M5(t)&&(await this._removeSession(),await Rh(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:n,error:r}=s;if(r)throw r;if(!n.session)throw new Rr;const a=n.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await uo(this.storage,this.storageKey));const{data:c,error:h}=await St(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:Fr});if(h)throw h;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(s){if(mt(s))return{data:{user:null},error:s};throw s}}_decodeJWT(e){return rg(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Rr;const t=Date.now()/1e3;let s=t,n=!0,r=null;const a=rg(e.access_token);if(a.exp&&(s=a.exp,n=s<=t),n){const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};r=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;r={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)}return{data:{user:r.user,session:r},error:null}}catch(t){if(mt(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:a,error:o}=t;if(o)throw o;e=(s=a.session)!==null&&s!==void 0?s:void 0}if(!e?.refresh_token)throw new Rr;const{session:n,error:r}=await this._callRefreshToken(e.refresh_token);return r?{data:{user:null,session:null},error:r}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(mt(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e){try{if(!ai())throw new Mh("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new Mh("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new ag("Not a valid PKCE flow url.");const t=Yd(window.location.href);if(e){if(!t.code)throw new ag("No code detected.");const{data:S,error:j}=await this._exchangeCodeForSession(t.code);if(j)throw j;const M=new URL(window.location.href);return M.searchParams.delete("code"),window.history.replaceState(window.history.state,"",M.toString()),{data:{session:S.session,redirectType:null},error:null}}if(t.error||t.error_description||t.error_code)throw new Mh(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});const{provider_token:s,provider_refresh_token:n,access_token:r,refresh_token:a,expires_in:o,expires_at:l,token_type:c}=t;if(!r||!o||!a||!c)throw new Mh("No session defined in URL");const h=Math.round(Date.now()/1e3),d=parseInt(o);let p=h+d;l&&(p=parseInt(l));const f=p-h;f*1e3<=Ll&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${d}s`);const v=p-d;h-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,p,h):h-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,p,h);const{data:w,error:A}=await this._getUser(r);if(A)throw A;const x={provider_token:s,provider_refresh_token:n,access_token:r,expires_in:d,expires_at:p,refresh_token:a,token_type:c,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:t.type},error:null}}catch(t){if(mt(t))return{data:{session:null,redirectType:null},error:t};throw t}}_isImplicitGrantFlow(){const e=Yd(window.location.href);return!!(ai()&&(e.access_token||e.error_description))}async _isPKCEFlow(){const e=Yd(window.location.href),t=await Ih(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:n,error:r}=t;if(r)return{error:r};const a=(s=n.session)===null||s===void 0?void 0:s.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(O5(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await Rh(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=_5(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,n;try{const{data:{session:r},error:a}=t;if(a)throw a;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(r){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",r),console.error(r)}})}async resetPasswordForEmail(e,t={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await uo(this.storage,this.storageKey,!0));try{return await St(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(r){if(mt(r))return{data:null,error:r};throw r}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(mt(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:n}=await this._useSession(async r=>{var a,o,l,c,h;const{data:d,error:p}=r;if(p)throw p;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await St(this.fetch,"GET",f,{headers:this.headers,jwt:(h=(c=d.session)===null||c===void 0?void 0:c.access_token)!==null&&h!==void 0?h:void 0})});if(n)throw n;return ai()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(s?.url),{data:{provider:e.provider,url:s?.url},error:null}}catch(s){if(mt(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,n;const{data:r,error:a}=t;if(a)throw a;return await St(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=r.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(t){if(mt(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await E5(async n=>(n>0&&await N5(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await St(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Or})),(n,r)=>{const a=200*Math.pow(2,n);return r&&Jd(r)&&Date.now()+a-s<Ll})}catch(s){if(this._debug(t,"error",s),mt(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),ai()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const s=await Ih(this.storage,this.storageKey);if(this._debug(t,"session from storage",s),!this._isValidSession(s)){this._debug(t,"session is not valid"),s!==null&&await this._removeSession();return}const n=Math.round(Date.now()/1e3),r=((e=s.expires_at)!==null&&e!==void 0?e:1/0)<n+ig;if(this._debug(t,`session has${r?"":" not"} expired with margin of ${ig}s`),r){if(this.autoRefreshToken&&s.refresh_token){const{error:a}=await this._callRefreshToken(s.refresh_token);a&&(console.error(a),Jd(a)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(t,"error",s),console.error(s);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new Rr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Bu;const{data:r,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!r.session)throw new Rr;await this._saveSession(r.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",r.session);const o={session:r.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(r){if(this._debug(n,"error",r),mt(r)){const a={session:null,error:r};return Jd(r)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(r),r}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const r=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(l){r.push(l)}});if(await Promise.all(a),r.length>0){for(let o=0;o<r.length;o+=1)console.error(r[o]);throw r[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await l1(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Rh(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&ai()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ll);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/Ll);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Ll}ms, refresh threshold is ${ug} ticks`),n<=ug&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof h1)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ai()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const n=[`provider=${encodeURIComponent(t)}`];if(s?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[r,a]=await uo(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(r)}`,code_challenge_method:`${encodeURIComponent(a)}`});n.push(o.toString())}if(s?.queryParams){const r=new URLSearchParams(s.queryParams);n.push(r.toString())}return s?.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:n,error:r}=t;return r?{data:null,error:r}:await St(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(mt(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,n;const{data:r,error:a}=t;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await St(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(s=r?.session)===null||s===void 0?void 0:s.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((n=l?.totp)===null||n===void 0)&&n.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(mt(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:r}=t;if(r)return{data:null,error:r};const{data:a,error:o}=await St(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(t){if(mt(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:r}=t;return r?{data:null,error:r}:await St(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(mt(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=e?.factors||[],n=s.filter(a=>a.factor_type==="totp"&&a.status==="verified"),r=s.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:s,totp:n,phone:r},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;const{data:{session:n},error:r}=e;if(r)return{data:null,error:r};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const a=this._decodeJWT(n.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((s=(t=n.user.factors)===null||t===void 0?void 0:t.filter(d=>d.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(l="aal2");const h=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:h},error:null}}))}}lc.nextInstanceID=0;const Q5=lc;class ex extends Q5{constructor(e){super(e)}}var tx=function(i,e,t,s){function n(r){return r instanceof t?r:new t(function(a){a(r)})}return new(t||(t=Promise))(function(r,a){function o(h){try{c(s.next(h))}catch(d){a(d)}}function l(h){try{c(s.throw(h))}catch(d){a(d)}}function c(h){h.done?r(h.value):n(h.value).then(o,l)}c((s=s.apply(i,e||[])).next())})};class sx{constructor(e,t,s){var n,r,a;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=g5(e);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:l5,realtime:h5,auth:Object.assign(Object.assign({},c5),{storageKey:l}),global:o5},h=b5(s??{},c);this.storageKey=(n=h.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(r=h.global.headers)!==null&&r!==void 0?r:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(d,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=h.auth)!==null&&a!==void 0?a:{},this.headers,h.global.fetch),this.fetch=p5(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new Pw(`${o}/rest/v1`,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new rw(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new i5(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return tx(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(t=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,storageKey:r,flowType:a,lock:o,debug:l},c,h){var d;const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ex({url:this.authUrl,headers:Object.assign(Object.assign({},p),c),storageKey:r,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,flowType:a,lock:o,debug:l,fetch:h,hasCustomAuthorizationHeader:(d="Authorization"in this.headers)!==null&&d!==void 0?d:!1})}_initRealtimeClient(e){return new Hw(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,s)=>{this._handleTokenChanged(t,"CLIENT",s?.access_token)})}_handleTokenChanged(e,t,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const nx=(i,e,t)=>new sx(i,e,t),ix="https://your-production-project.supabase.co",rx="your-production-anon-key",ut=nx(ix,rx,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce"}});function qi({children:i,isLoading:e,variant:t="primary",...s}){const n="w-full py-2 px-4 rounded-md transition-colors disabled:opacity-50",r={primary:"bg-blue-600 text-white hover:bg-blue-700",secondary:"bg-gray-200 text-gray-800 hover:bg-gray-300"};return g.jsx("button",{...s,className:`${n} ${r[t]}`,disabled:e||s.disabled,children:e?g.jsxs("span",{className:"flex items-center justify-center",children:[g.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2",viewBox:"0 0 24 24",children:[g.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),g.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading..."]}):i})}function wa({label:i,error:e,...t}){return g.jsxs("div",{children:[g.jsx("label",{htmlFor:t.id,className:"block text-sm font-medium text-gray-700",children:i}),g.jsx("input",{...t,className:"mt-1 block w-full rounded-md border p-2 focus:border-blue-500 focus:ring focus:ring-blue-200"}),e&&g.jsx("p",{className:"mt-1 text-sm text-red-600",children:e})]})}function ax(){const[i,e]=V.useState(""),[t,s]=V.useState(""),[n,r]=V.useState(null),[a,o]=V.useState(!1),l=async c=>{if(c.preventDefault(),r(null),o(!0),!i.trim()||!t.trim()){r("Email and password are required"),o(!1);return}const h=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(!h.test(i)){r("Please enter a valid email address"),o(!1);return}try{console.log("Auth attempt with:",{emailLength:i.length,passwordLength:t.length,emailValid:h.test(i)});const{data:d,error:p}=await ut.auth.signInWithPassword({email:i.trim(),password:t.trim()});if(p)throw console.error("Supabase auth error:",{status:p.status,message:p.message,name:p.name}),p.message.includes("Invalid login credentials")?new Error("Invalid email or password"):p;console.log("Login successful",{userId:d.user?.id})}catch(d){console.error("Login error:",d),r(d instanceof Error?d.message:"An error occurred during login")}finally{o(!1)}};return g.jsxs("div",{className:"space-y-6",children:[g.jsxs("form",{onSubmit:l,className:"space-y-4",children:[g.jsx(wa,{id:"email",type:"email",label:"Email",value:i,onChange:c=>e(c.target.value),required:!0}),g.jsx(wa,{id:"password",type:"password",label:"Password",value:t,onChange:c=>s(c.target.value),required:!0}),n&&g.jsx("div",{className:"text-red-600 text-sm",children:n}),g.jsx(qi,{type:"submit",isLoading:a,children:"Sign In"})]}),g.jsx("div",{className:"text-center",children:g.jsxs("p",{className:"text-sm text-gray-600",children:["Don't have an account?"," ",g.jsx(Ps,{to:"/signup",className:"text-blue-600 hover:text-blue-700",children:"Sign up"})]})})]})}function ox(){return g.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:g.jsxs("div",{className:"max-w-md w-full bg-white p-8 rounded-lg shadow-md",children:[g.jsx("h1",{className:"text-2xl font-bold mb-6 text-center",children:"Welcome Back"}),g.jsx("p",{className:"text-gray-600 text-center mb-8",children:"Sign in to continue to Top Match Talent"}),g.jsx(ax,{})]})})}function lx(){const[i,e]=V.useState(""),[t,s]=V.useState(""),[n,r]=V.useState(""),[a,o]=V.useState(null),[l,c]=V.useState(!1),h=async d=>{if(d.preventDefault(),o(null),t!==n){o("Passwords do not match");return}c(!0);try{const{error:p}=await ut.auth.signUp({email:i,password:t,options:{emailRedirectTo:`${window.location.origin}/auth/callback`}});if(p)throw p}catch(p){o(p instanceof Error?p.message:"An error occurred")}finally{c(!1)}};return g.jsxs("div",{className:"space-y-6",children:[g.jsxs("form",{onSubmit:h,className:"space-y-4",children:[g.jsx(wa,{id:"email",type:"email",label:"Email",value:i,onChange:d=>e(d.target.value),required:!0}),g.jsx(wa,{id:"password",type:"password",label:"Password",value:t,onChange:d=>s(d.target.value),required:!0}),g.jsx(wa,{id:"confirmPassword",type:"password",label:"Confirm Password",value:n,onChange:d=>r(d.target.value),required:!0}),a&&g.jsx("div",{className:"text-red-600 text-sm",children:a}),g.jsx(qi,{type:"submit",isLoading:l,children:"Sign Up"})]}),g.jsx("div",{className:"text-center",children:g.jsxs("p",{className:"text-sm text-gray-600",children:["Already have an account?"," ",g.jsx(Ps,{to:"/login",className:"text-blue-600 hover:text-blue-700",children:"Sign in"})]})})]})}function cx(){return g.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:g.jsxs("div",{className:"max-w-md w-full bg-white p-8 rounded-lg shadow-md",children:[g.jsx("h1",{className:"text-2xl font-bold mb-6 text-center",children:"Create Account"}),g.jsx("p",{className:"text-gray-600 text-center mb-8",children:"Join Top Match Talent to start analyzing candidates"}),g.jsx(lx,{})]})})}const Zd={AUTH:{INVALID_CREDENTIALS:"Invalid email or password",EMAIL_IN_USE:"This email is already registered",WEAK_PASSWORD:"Password must be at least 8 characters",SESSION_EXPIRED:"Your session has expired. Please sign in again"},API:{GENERAL:"An unexpected error occurred",NETWORK:"Network error. Please check your connection",RATE_LIMIT:"Too many requests. Please try again later"},ANALYSIS:{FAILED:"Failed to analyze CV",NOT_FOUND:"Analysis not found",LIMIT_REACHED:"Analysis limit reached. Please upgrade your plan"}},hx={VITE_SUPABASE_URL:"https://your-production-project.supabase.co",VITE_SUPABASE_ANON_KEY:"your-production-anon-key",VITE_OPENAI_API_KEY:"your-production-openai-key",VITE_STRIPE_PUBLIC_KEY:"your-production-stripe-key"};Object.entries(hx).forEach(([i,e])=>{if(!e)throw new Error(`Missing required environment variable: ${i}`)});function Np(i){return i instanceof Error?i.name==="AuthError"?Zd.AUTH.INVALID_CREDENTIALS:i.name==="NetworkError"?Zd.API.NETWORK:i.message:Zd.API.GENERAL}function $u(){const[i,e]=V.useState(null),[t,s]=V.useState(!0);return V.useEffect(()=>{ut.auth.getSession().then(({data:{session:a}})=>{e(a),s(!1)});const{data:{subscription:r}}=ut.auth.onAuthStateChange((a,o)=>{e(o),o&&oc.trackEvent("user_signed_in")});return()=>r.unsubscribe()},[]),{session:i,loading:t,signOut:async()=>{try{const{error:r}=await ut.auth.signOut();if(r)throw r;oc.trackEvent("user_signed_out")}catch(r){Np(r)}}}}function ux(){const{signOut:i}=$u(),e=T0(),t=async()=>{try{await i(),e("/",{replace:!0})}catch(s){console.error("Sign out failed:",s)}};return g.jsx("header",{className:"bg-white shadow",children:g.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:g.jsxs("div",{className:"flex justify-between items-center h-16",children:[g.jsx("div",{className:"flex items-center",children:g.jsx(Ps,{to:"/",className:"flex items-center",children:g.jsx("img",{src:"/images/logo.png",alt:"Logo",className:"h-12 w-auto",onError:s=>{s.currentTarget.src="/images/fallback-logo.png"}})})}),g.jsx("div",{className:"flex items-center space-x-4",children:g.jsxs("button",{onClick:t,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200",children:[g.jsx($0,{className:"h-5 w-5 mr-2"}),"Sign Out"]})})]})})})}function Ep({label:i,error:e,...t}){return g.jsxs("div",{children:[g.jsx("label",{htmlFor:t.id,className:"block text-sm font-medium text-gray-700",children:i}),g.jsx("textarea",{...t,className:"mt-1 block w-full rounded-md border p-2 h-32 focus:border-blue-500 focus:ring focus:ring-blue-200"}),e&&g.jsx("p",{className:"mt-1 text-sm text-red-600",children:e})]})}function Tc(i,e){const[t,s]=V.useState(null),[n,r]=V.useState(!0),[a,o]=V.useState(null),l=V.useRef(i);l.current=i;const c=V.useCallback(async()=>{try{r(!0),o(null);const h=await l.current();s(h)}catch(h){o(h instanceof Error?h.message:"An error occurred")}finally{r(!1)}},[]);return V.useEffect(()=>{e?.enabled!==!1&&c()},[c,e?.enabled]),{data:t,isLoading:n,error:a,refetch:c}}class Dt extends Error{constructor(e,t,s){super(e),this.statusCode=t,this.code=s,this.name="ApiError"}}async function dx(i){const{data:e}=await ut.auth.getUser();if(!e?.user?.id)throw new Dt("User must be authenticated to upload candidates",401);const t={...i,user_id:e.user.id},{data:s,error:n}=await ut.from("candidates").insert([t]).select("id, name, cv_text, created_at").single();if(n)throw n.code==="23505"?new Dt("A candidate with this name already exists",400):new Dt(`Failed to upload candidate: ${n.message}`,500);if(!s)throw new Dt("No data returned after candidate upload",500);return s}async function fx(){const{data:i}=await ut.auth.getUser();if(!i?.user?.id)throw new Dt("User must be authenticated to list candidates",401);const{data:e,error:t}=await ut.from("candidates").select("id, name, cv_text, created_at").eq("user_id",i.user.id).order("created_at",{ascending:!1});if(t)throw new Dt(`Failed to fetch candidates: ${t.message}`,500);return e||[]}function kp(){const{data:i,isLoading:e,error:t,refetch:s}=Tc(fx);return{candidates:i||[],isLoading:e,error:t,refetch:s}}function mr({size:i="md"}){const e={sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"};return g.jsx("div",{className:`animate-spin rounded-full border-2 border-gray-300 border-t-blue-600 ${e[i]}`})}function u1(i,e){V.useEffect(()=>{const t=s=>{!i.current||i.current.contains(s.target)||e()};return document.addEventListener("mousedown",t),document.addEventListener("touchstart",t),()=>{document.removeEventListener("mousedown",t),document.removeEventListener("touchstart",t)}},[i,e])}function Xt(i){const e=Object.prototype.toString.call(i);return i instanceof Date||typeof i=="object"&&e==="[object Date]"?new i.constructor(+i):typeof i=="number"||e==="[object Number]"||typeof i=="string"||e==="[object String]"?new Date(i):new Date(NaN)}function qr(i,e){return i instanceof Date?new i.constructor(e):new Date(e)}const d1=6048e5,px=864e5,Fh=43200,fg=1440;let mx={};function jc(){return mx}function cc(i,e){const t=jc(),s=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,n=Xt(i),r=n.getDay(),a=(r<s?7:0)+r-s;return n.setDate(n.getDate()-a),n.setHours(0,0,0,0),n}function pu(i){return cc(i,{weekStartsOn:1})}function f1(i){const e=Xt(i),t=e.getFullYear(),s=qr(i,0);s.setFullYear(t+1,0,4),s.setHours(0,0,0,0);const n=pu(s),r=qr(i,0);r.setFullYear(t,0,4),r.setHours(0,0,0,0);const a=pu(r);return e.getTime()>=n.getTime()?t+1:e.getTime()>=a.getTime()?t:t-1}function pg(i){const e=Xt(i);return e.setHours(0,0,0,0),e}function mu(i){const e=Xt(i),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+i-+t}function gx(i,e){const t=pg(i),s=pg(e),n=+t-mu(t),r=+s-mu(s);return Math.round((n-r)/px)}function bx(i){const e=f1(i),t=qr(i,0);return t.setFullYear(e,0,4),t.setHours(0,0,0,0),pu(t)}function eu(i,e){const t=Xt(i),s=Xt(e),n=t.getTime()-s.getTime();return n<0?-1:n>0?1:n}function yx(i){return qr(i,Date.now())}function vx(i){return i instanceof Date||typeof i=="object"&&Object.prototype.toString.call(i)==="[object Date]"}function wx(i){if(!vx(i)&&typeof i!="number")return!1;const e=Xt(i);return!isNaN(Number(e))}function xx(i,e){const t=Xt(i),s=Xt(e),n=t.getFullYear()-s.getFullYear(),r=t.getMonth()-s.getMonth();return n*12+r}function _x(i){return e=>{const s=(i?Math[i]:Math.trunc)(e);return s===0?0:s}}function Ax(i,e){return+Xt(i)-+Xt(e)}function Sx(i){const e=Xt(i);return e.setHours(23,59,59,999),e}function Nx(i){const e=Xt(i),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function Ex(i){const e=Xt(i);return+Sx(e)==+Nx(e)}function kx(i,e){const t=Xt(i),s=Xt(e),n=eu(t,s),r=Math.abs(xx(t,s));let a;if(r<1)a=0;else{t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-n*r);let o=eu(t,s)===-n;Ex(Xt(i))&&r===1&&eu(i,s)===1&&(o=!1),a=n*(r-Number(o))}return a===0?0:a}function Cx(i,e,t){const s=Ax(i,e)/1e3;return _x(t?.roundingMethod)(s)}function Px(i){const e=Xt(i),t=qr(i,0);return t.setFullYear(e.getFullYear(),0,1),t.setHours(0,0,0,0),t}const Lx={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Tx=(i,e,t)=>{let s;const n=Lx[i];return typeof n=="string"?s=n:e===1?s=n.one:s=n.other.replace("{{count}}",e.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+s:s+" ago":s};function Qd(i){return(e={})=>{const t=e.width?String(e.width):i.defaultWidth;return i.formats[t]||i.formats[i.defaultWidth]}}const jx={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Ix={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Rx={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Ox={date:Qd({formats:jx,defaultWidth:"full"}),time:Qd({formats:Ix,defaultWidth:"full"}),dateTime:Qd({formats:Rx,defaultWidth:"full"})},Mx={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Fx=(i,e,t,s)=>Mx[i];function Tl(i){return(e,t)=>{const s=t?.context?String(t.context):"standalone";let n;if(s==="formatting"&&i.formattingValues){const a=i.defaultFormattingWidth||i.defaultWidth,o=t?.width?String(t.width):a;n=i.formattingValues[o]||i.formattingValues[a]}else{const a=i.defaultWidth,o=t?.width?String(t.width):i.defaultWidth;n=i.values[o]||i.values[a]}const r=i.argumentCallback?i.argumentCallback(e):e;return n[r]}}const Dx={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Bx={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},$x={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},qx={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Ux={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},zx={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Hx=(i,e)=>{const t=Number(i),s=t%100;if(s>20||s<10)switch(s%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},Wx={ordinalNumber:Hx,era:Tl({values:Dx,defaultWidth:"wide"}),quarter:Tl({values:Bx,defaultWidth:"wide",argumentCallback:i=>i-1}),month:Tl({values:$x,defaultWidth:"wide"}),day:Tl({values:qx,defaultWidth:"wide"}),dayPeriod:Tl({values:Ux,defaultWidth:"wide",formattingValues:zx,defaultFormattingWidth:"wide"})};function jl(i){return(e,t={})=>{const s=t.width,n=s&&i.matchPatterns[s]||i.matchPatterns[i.defaultMatchWidth],r=e.match(n);if(!r)return null;const a=r[0],o=s&&i.parsePatterns[s]||i.parsePatterns[i.defaultParseWidth],l=Array.isArray(o)?Gx(o,d=>d.test(a)):Vx(o,d=>d.test(a));let c;c=i.valueCallback?i.valueCallback(l):l,c=t.valueCallback?t.valueCallback(c):c;const h=e.slice(a.length);return{value:c,rest:h}}}function Vx(i,e){for(const t in i)if(Object.prototype.hasOwnProperty.call(i,t)&&e(i[t]))return t}function Gx(i,e){for(let t=0;t<i.length;t++)if(e(i[t]))return t}function Xx(i){return(e,t={})=>{const s=e.match(i.matchPattern);if(!s)return null;const n=s[0],r=e.match(i.parsePattern);if(!r)return null;let a=i.valueCallback?i.valueCallback(r[0]):r[0];a=t.valueCallback?t.valueCallback(a):a;const o=e.slice(n.length);return{value:a,rest:o}}}const Yx=/^(\d+)(th|st|nd|rd)?/i,Kx=/\d+/i,Jx={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Zx={any:[/^b/i,/^(a|c)/i]},Qx={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},e_={any:[/1/i,/2/i,/3/i,/4/i]},t_={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},s_={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},n_={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},i_={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},r_={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},a_={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},o_={ordinalNumber:Xx({matchPattern:Yx,parsePattern:Kx,valueCallback:i=>parseInt(i,10)}),era:jl({matchPatterns:Jx,defaultMatchWidth:"wide",parsePatterns:Zx,defaultParseWidth:"any"}),quarter:jl({matchPatterns:Qx,defaultMatchWidth:"wide",parsePatterns:e_,defaultParseWidth:"any",valueCallback:i=>i+1}),month:jl({matchPatterns:t_,defaultMatchWidth:"wide",parsePatterns:s_,defaultParseWidth:"any"}),day:jl({matchPatterns:n_,defaultMatchWidth:"wide",parsePatterns:i_,defaultParseWidth:"any"}),dayPeriod:jl({matchPatterns:r_,defaultMatchWidth:"any",parsePatterns:a_,defaultParseWidth:"any"})},p1={code:"en-US",formatDistance:Tx,formatLong:Ox,formatRelative:Fx,localize:Wx,match:o_,options:{weekStartsOn:0,firstWeekContainsDate:1}};function l_(i){const e=Xt(i);return gx(e,Px(e))+1}function c_(i){const e=Xt(i),t=+pu(e)-+bx(e);return Math.round(t/d1)+1}function m1(i,e){const t=Xt(i),s=t.getFullYear(),n=jc(),r=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,a=qr(i,0);a.setFullYear(s+1,0,r),a.setHours(0,0,0,0);const o=cc(a,e),l=qr(i,0);l.setFullYear(s,0,r),l.setHours(0,0,0,0);const c=cc(l,e);return t.getTime()>=o.getTime()?s+1:t.getTime()>=c.getTime()?s:s-1}function h_(i,e){const t=jc(),s=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,n=m1(i,e),r=qr(i,0);return r.setFullYear(n,0,s),r.setHours(0,0,0,0),cc(r,e)}function u_(i,e){const t=Xt(i),s=+cc(t,e)-+h_(t,e);return Math.round(s/d1)+1}function Ft(i,e){const t=i<0?"-":"",s=Math.abs(i).toString().padStart(e,"0");return t+s}const Lr={y(i,e){const t=i.getFullYear(),s=t>0?t:1-t;return Ft(e==="yy"?s%100:s,e.length)},M(i,e){const t=i.getMonth();return e==="M"?String(t+1):Ft(t+1,2)},d(i,e){return Ft(i.getDate(),e.length)},a(i,e){const t=i.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(i,e){return Ft(i.getHours()%12||12,e.length)},H(i,e){return Ft(i.getHours(),e.length)},m(i,e){return Ft(i.getMinutes(),e.length)},s(i,e){return Ft(i.getSeconds(),e.length)},S(i,e){const t=e.length,s=i.getMilliseconds(),n=Math.trunc(s*Math.pow(10,t-3));return Ft(n,e.length)}},po={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},mg={G:function(i,e,t){const s=i.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(s,{width:"abbreviated"});case"GGGGG":return t.era(s,{width:"narrow"});case"GGGG":default:return t.era(s,{width:"wide"})}},y:function(i,e,t){if(e==="yo"){const s=i.getFullYear(),n=s>0?s:1-s;return t.ordinalNumber(n,{unit:"year"})}return Lr.y(i,e)},Y:function(i,e,t,s){const n=m1(i,s),r=n>0?n:1-n;if(e==="YY"){const a=r%100;return Ft(a,2)}return e==="Yo"?t.ordinalNumber(r,{unit:"year"}):Ft(r,e.length)},R:function(i,e){const t=f1(i);return Ft(t,e.length)},u:function(i,e){const t=i.getFullYear();return Ft(t,e.length)},Q:function(i,e,t){const s=Math.ceil((i.getMonth()+1)/3);switch(e){case"Q":return String(s);case"QQ":return Ft(s,2);case"Qo":return t.ordinalNumber(s,{unit:"quarter"});case"QQQ":return t.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(s,{width:"wide",context:"formatting"})}},q:function(i,e,t){const s=Math.ceil((i.getMonth()+1)/3);switch(e){case"q":return String(s);case"qq":return Ft(s,2);case"qo":return t.ordinalNumber(s,{unit:"quarter"});case"qqq":return t.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(s,{width:"wide",context:"standalone"})}},M:function(i,e,t){const s=i.getMonth();switch(e){case"M":case"MM":return Lr.M(i,e);case"Mo":return t.ordinalNumber(s+1,{unit:"month"});case"MMM":return t.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(s,{width:"wide",context:"formatting"})}},L:function(i,e,t){const s=i.getMonth();switch(e){case"L":return String(s+1);case"LL":return Ft(s+1,2);case"Lo":return t.ordinalNumber(s+1,{unit:"month"});case"LLL":return t.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(s,{width:"wide",context:"standalone"})}},w:function(i,e,t,s){const n=u_(i,s);return e==="wo"?t.ordinalNumber(n,{unit:"week"}):Ft(n,e.length)},I:function(i,e,t){const s=c_(i);return e==="Io"?t.ordinalNumber(s,{unit:"week"}):Ft(s,e.length)},d:function(i,e,t){return e==="do"?t.ordinalNumber(i.getDate(),{unit:"date"}):Lr.d(i,e)},D:function(i,e,t){const s=l_(i);return e==="Do"?t.ordinalNumber(s,{unit:"dayOfYear"}):Ft(s,e.length)},E:function(i,e,t){const s=i.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(s,{width:"short",context:"formatting"});case"EEEE":default:return t.day(s,{width:"wide",context:"formatting"})}},e:function(i,e,t,s){const n=i.getDay(),r=(n-s.weekStartsOn+8)%7||7;switch(e){case"e":return String(r);case"ee":return Ft(r,2);case"eo":return t.ordinalNumber(r,{unit:"day"});case"eee":return t.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(n,{width:"short",context:"formatting"});case"eeee":default:return t.day(n,{width:"wide",context:"formatting"})}},c:function(i,e,t,s){const n=i.getDay(),r=(n-s.weekStartsOn+8)%7||7;switch(e){case"c":return String(r);case"cc":return Ft(r,e.length);case"co":return t.ordinalNumber(r,{unit:"day"});case"ccc":return t.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(n,{width:"narrow",context:"standalone"});case"cccccc":return t.day(n,{width:"short",context:"standalone"});case"cccc":default:return t.day(n,{width:"wide",context:"standalone"})}},i:function(i,e,t){const s=i.getDay(),n=s===0?7:s;switch(e){case"i":return String(n);case"ii":return Ft(n,e.length);case"io":return t.ordinalNumber(n,{unit:"day"});case"iii":return t.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(s,{width:"short",context:"formatting"});case"iiii":default:return t.day(s,{width:"wide",context:"formatting"})}},a:function(i,e,t){const n=i.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(i,e,t){const s=i.getHours();let n;switch(s===12?n=po.noon:s===0?n=po.midnight:n=s/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(i,e,t){const s=i.getHours();let n;switch(s>=17?n=po.evening:s>=12?n=po.afternoon:s>=4?n=po.morning:n=po.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(i,e,t){if(e==="ho"){let s=i.getHours()%12;return s===0&&(s=12),t.ordinalNumber(s,{unit:"hour"})}return Lr.h(i,e)},H:function(i,e,t){return e==="Ho"?t.ordinalNumber(i.getHours(),{unit:"hour"}):Lr.H(i,e)},K:function(i,e,t){const s=i.getHours()%12;return e==="Ko"?t.ordinalNumber(s,{unit:"hour"}):Ft(s,e.length)},k:function(i,e,t){let s=i.getHours();return s===0&&(s=24),e==="ko"?t.ordinalNumber(s,{unit:"hour"}):Ft(s,e.length)},m:function(i,e,t){return e==="mo"?t.ordinalNumber(i.getMinutes(),{unit:"minute"}):Lr.m(i,e)},s:function(i,e,t){return e==="so"?t.ordinalNumber(i.getSeconds(),{unit:"second"}):Lr.s(i,e)},S:function(i,e){return Lr.S(i,e)},X:function(i,e,t){const s=i.getTimezoneOffset();if(s===0)return"Z";switch(e){case"X":return bg(s);case"XXXX":case"XX":return da(s);case"XXXXX":case"XXX":default:return da(s,":")}},x:function(i,e,t){const s=i.getTimezoneOffset();switch(e){case"x":return bg(s);case"xxxx":case"xx":return da(s);case"xxxxx":case"xxx":default:return da(s,":")}},O:function(i,e,t){const s=i.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+gg(s,":");case"OOOO":default:return"GMT"+da(s,":")}},z:function(i,e,t){const s=i.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+gg(s,":");case"zzzz":default:return"GMT"+da(s,":")}},t:function(i,e,t){const s=Math.trunc(i.getTime()/1e3);return Ft(s,e.length)},T:function(i,e,t){const s=i.getTime();return Ft(s,e.length)}};function gg(i,e=""){const t=i>0?"-":"+",s=Math.abs(i),n=Math.trunc(s/60),r=s%60;return r===0?t+String(n):t+String(n)+e+Ft(r,2)}function bg(i,e){return i%60===0?(i>0?"-":"+")+Ft(Math.abs(i)/60,2):da(i,e)}function da(i,e=""){const t=i>0?"-":"+",s=Math.abs(i),n=Ft(Math.trunc(s/60),2),r=Ft(s%60,2);return t+n+e+r}const yg=(i,e)=>{switch(i){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},g1=(i,e)=>{switch(i){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},d_=(i,e)=>{const t=i.match(/(P+)(p+)?/)||[],s=t[1],n=t[2];if(!n)return yg(i,e);let r;switch(s){case"P":r=e.dateTime({width:"short"});break;case"PP":r=e.dateTime({width:"medium"});break;case"PPP":r=e.dateTime({width:"long"});break;case"PPPP":default:r=e.dateTime({width:"full"});break}return r.replace("{{date}}",yg(s,e)).replace("{{time}}",g1(n,e))},f_={p:g1,P:d_},p_=/^D+$/,m_=/^Y+$/,g_=["D","DD","YY","YYYY"];function b_(i){return p_.test(i)}function y_(i){return m_.test(i)}function v_(i,e,t){const s=w_(i,e,t);if(console.warn(s),g_.includes(i))throw new RangeError(s)}function w_(i,e,t){const s=i[0]==="Y"?"years":"days of the month";return`Use \`${i.toLowerCase()}\` instead of \`${i}\` (in \`${e}\`) for formatting ${s} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const x_=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,__=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,A_=/^'([^]*?)'?$/,S_=/''/g,N_=/[a-zA-Z]/;function E_(i,e,t){const s=jc(),n=s.locale??p1,r=s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,a=s.weekStartsOn??s.locale?.options?.weekStartsOn??0,o=Xt(i);if(!wx(o))throw new RangeError("Invalid time value");let l=e.match(__).map(h=>{const d=h[0];if(d==="p"||d==="P"){const p=f_[d];return p(h,n.formatLong)}return h}).join("").match(x_).map(h=>{if(h==="''")return{isToken:!1,value:"'"};const d=h[0];if(d==="'")return{isToken:!1,value:k_(h)};if(mg[d])return{isToken:!0,value:h};if(d.match(N_))throw new RangeError("Format string contains an unescaped latin alphabet character `"+d+"`");return{isToken:!1,value:h}});n.localize.preprocessor&&(l=n.localize.preprocessor(o,l));const c={firstWeekContainsDate:r,weekStartsOn:a,locale:n};return l.map(h=>{if(!h.isToken)return h.value;const d=h.value;(y_(d)||b_(d))&&v_(d,e,String(i));const p=mg[d[0]];return p(o,d,n.localize,c)}).join("")}function k_(i){const e=i.match(A_);return e?e[1].replace(S_,"'"):i}function C_(i,e,t){const s=jc(),n=t?.locale??s.locale??p1,r=2520,a=eu(i,e);if(isNaN(a))throw new RangeError("Invalid time value");const o=Object.assign({},t,{addSuffix:t?.addSuffix,comparison:a});let l,c;a>0?(l=Xt(e),c=Xt(i)):(l=Xt(i),c=Xt(e));const h=Cx(c,l),d=(mu(c)-mu(l))/1e3,p=Math.round((h-d)/60);let f;if(p<2)return t?.includeSeconds?h<5?n.formatDistance("lessThanXSeconds",5,o):h<10?n.formatDistance("lessThanXSeconds",10,o):h<20?n.formatDistance("lessThanXSeconds",20,o):h<40?n.formatDistance("halfAMinute",0,o):h<60?n.formatDistance("lessThanXMinutes",1,o):n.formatDistance("xMinutes",1,o):p===0?n.formatDistance("lessThanXMinutes",1,o):n.formatDistance("xMinutes",p,o);if(p<45)return n.formatDistance("xMinutes",p,o);if(p<90)return n.formatDistance("aboutXHours",1,o);if(p<fg){const v=Math.round(p/60);return n.formatDistance("aboutXHours",v,o)}else{if(p<r)return n.formatDistance("xDays",1,o);if(p<Fh){const v=Math.round(p/fg);return n.formatDistance("xDays",v,o)}else if(p<Fh*2)return f=Math.round(p/Fh),n.formatDistance("aboutXMonths",f,o)}if(f=kx(c,l),f<12){const v=Math.round(p/Fh);return n.formatDistance("xMonths",v,o)}else{const v=f%12,w=Math.trunc(f/12);return v<3?n.formatDistance("aboutXYears",w,o):v<9?n.formatDistance("overXYears",w,o):n.formatDistance("almostXYears",w+1,o)}}function P_(i,e){return C_(i,yx(i),e)}function b1(i){return E_(new Date(i),"MMMM d, yyyy")}function L_(i){return P_(new Date(i),{addSuffix:!0})}function T_(i,e){return i.length<=e?i:`${i.slice(0,e)}...`}function hc(i,e,t){return t.some(s=>s.name.toLowerCase().trim()===i.toLowerCase().trim()&&s.cv_text.trim()===e.trim())}function uc(i,e,t){return t.some(s=>s.title.toLowerCase().trim()===i.toLowerCase().trim()&&s.jd_text.trim()===e.trim())}function j_({onSelect:i}){const{candidates:e,isLoading:t}=kp(),[s,n]=V.useState(!1),r=V.useRef(null);u1(r,()=>n(!1));const a=e.reduce((o,l)=>{const c=o.findIndex(h=>hc(l.name,l.cv_text,[h]));return c>=0?(o[c].duplicateCount+=1,o[c].lastSubmitted=new Date(Math.max(new Date(o[c].lastSubmitted).getTime(),new Date(l.created_at).getTime())).toISOString()):o.push({...l,duplicateCount:1,lastSubmitted:l.created_at}),o},[]);return t?g.jsx(mr,{size:"sm"}):e.length?g.jsxs("div",{className:"relative",ref:r,children:[g.jsxs("button",{type:"button",onClick:()=>n(!s),className:"inline-flex items-center px-3 py-1.5 text-sm font-medium text-blue-600 hover:text-blue-700 bg-blue-50 hover:bg-blue-100 rounded-md transition-colors",children:[g.jsx("span",{children:"Previous CVs"}),g.jsx(Vo,{className:"ml-1 h-4 w-4"})]}),s&&g.jsx("div",{className:"absolute right-0 z-10 mt-2 w-96 rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5",children:g.jsx("div",{className:"max-h-60 overflow-auto py-1",children:a.map(o=>g.jsxs("button",{onClick:()=>{i({name:o.name,cvText:o.cv_text}),n(!1)},className:"w-full px-4 py-3 text-left hover:bg-gray-50 transition-colors border-b border-gray-100 last:border-0",children:[g.jsxs("div",{className:"flex justify-between items-start",children:[g.jsx("p",{className:"font-medium text-gray-900",children:o.name}),o.duplicateCount>1&&g.jsxs("span",{className:"text-xs px-2 py-1 bg-blue-50 text-blue-600 rounded-full",children:["Submitted ",o.duplicateCount," times"]})]}),g.jsx("p",{className:"text-sm text-gray-500 mt-1 line-clamp-2",children:T_(o.cv_text,150)})]},o.id))})})]}):null}var ec={};ec.d=(i,e)=>{for(var t in e)ec.o(e,t)&&!ec.o(i,t)&&Object.defineProperty(i,t,{enumerable:!0,get:e[t]})};ec.o=(i,e)=>Object.prototype.hasOwnProperty.call(i,e);var nt=globalThis.pdfjsLib={};ec.d(nt,{AbortException:()=>Ta,AnnotationEditorLayer:()=>ur,AnnotationEditorParamsType:()=>Nt,AnnotationEditorType:()=>pt,AnnotationEditorUIManager:()=>Ur,AnnotationLayer:()=>kS,AnnotationMode:()=>Dr,ColorPicker:()=>Wn,DOMSVGFactory:()=>Bp,DrawLayer:()=>rn,FeatureTest:()=>ln,GlobalWorkerOptions:()=>sc,ImageKind:()=>tu,InvalidPDFException:()=>v1,MissingPDFException:()=>Ic,OPS:()=>li,OutputScale:()=>Df,PDFDataRangeTransport:()=>F1,PDFDateString:()=>x1,PDFWorker:()=>Os,PasswordResponses:()=>M_,PermissionFlag:()=>O_,PixelsPerInch:()=>qo,RenderingCancelledException:()=>Lp,TextLayer:()=>an,UnexpectedResponseException:()=>Hu,Util:()=>He,VerbosityLevel:()=>qu,XfaLayer:()=>B1,build:()=>oS,createValidAbsoluteUrl:()=>$_,fetchData:()=>Vu,getDocument:()=>ZA,getFilenameFromUrl:()=>Y_,getPdfFilenameFromUrl:()=>K_,getXfaPageViewport:()=>J_,isDataScheme:()=>Gu,isPdfFile:()=>Tp,noContextMenu:()=>bi,normalizeUnicode:()=>V_,setLayerDimensions:()=>Aa,shadow:()=>xt,stopEvent:()=>di,version:()=>aS});const on=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),y1=[1,0,0,1,0,0],Of=[.001,0,0,.001,0,0],I_=1e7,ef=1.35,Tn={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Dr={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},R_="pdfjs_internal_editor_",pt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},Nt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},O_={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Ks={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},tu={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Es={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Il={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},qu={ERRORS:0,WARNINGS:1,INFOS:5},li={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},M_={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Uu=qu.WARNINGS;function F_(i){Number.isInteger(i)&&(Uu=i)}function D_(){return Uu}function zu(i){Uu>=qu.INFOS&&console.log(`Info: ${i}`)}function yt(i){Uu>=qu.WARNINGS&&console.log(`Warning: ${i}`)}function Ht(i){throw new Error(i)}function _s(i,e){i||Ht(e)}function B_(i){switch(i?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function $_(i,e=null,t=null){if(!i)return null;try{if(t&&typeof i=="string"&&(t.addDefaultProtocol&&i.startsWith("www.")&&i.match(/\./g)?.length>=2&&(i=`http://${i}`),t.tryConvertEncoding))try{i=W_(i)}catch{}const s=e?new URL(i,e):new URL(i);if(B_(s))return s}catch{}return null}function xt(i,e,t,s=!1){return Object.defineProperty(i,e,{value:t,enumerable:!s,configurable:!0,writable:!1}),t}const Yr=function(){function e(t,s){this.message=t,this.name=s}return e.prototype=new Error,e.constructor=e,e}();class Mf extends Yr{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Ff extends Yr{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class v1 extends Yr{constructor(e){super(e,"InvalidPDFException")}}class Ic extends Yr{constructor(e){super(e,"MissingPDFException")}}class Hu extends Yr{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class q_ extends Yr{constructor(e){super(e,"FormatError")}}class Ta extends Yr{constructor(e){super(e,"AbortException")}}function w1(i){(typeof i!="object"||i?.length===void 0)&&Ht("Invalid argument for bytesToString");const e=i.length,t=8192;if(e<t)return String.fromCharCode.apply(null,i);const s=[];for(let n=0;n<e;n+=t){const r=Math.min(n+t,e),a=i.subarray(n,r);s.push(String.fromCharCode.apply(null,a))}return s.join("")}function Wu(i){typeof i!="string"&&Ht("Invalid argument for stringToBytes");const e=i.length,t=new Uint8Array(e);for(let s=0;s<e;++s)t[s]=i.charCodeAt(s)&255;return t}function U_(i){return String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,i&255)}function Cp(i){const e=Object.create(null);for(const[t,s]of i)e[t]=s;return e}function z_(){const i=new Uint8Array(4);return i[0]=1,new Uint32Array(i.buffer,0,1)[0]===1}function H_(){try{return new Function(""),!0}catch{return!1}}class ln{static get isLittleEndian(){return xt(this,"isLittleEndian",z_())}static get isEvalSupported(){return xt(this,"isEvalSupported",H_())}static get isOffscreenCanvasSupported(){return xt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return xt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof navigator?.platform=="string"?xt(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof navigator?.userAgent=="string"&&navigator.userAgent.includes("Firefox")}):xt(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){return xt(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const tf=Array.from(Array(256).keys(),i=>i.toString(16).padStart(2,"0"));class He{static makeHexColor(e,t,s){return`#${tf[e]}${tf[t]}${tf[s]}`}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const s=e[0]*t[0]+e[1]*t[2]+t[4],n=e[0]*t[1]+e[1]*t[3]+t[5];return[s,n]}static applyInverseTransform(e,t){const s=t[0]*t[3]-t[1]*t[2],n=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/s,r=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/s;return[n,r]}static getAxialAlignedBoundingBox(e,t){const s=this.applyTransform(e,t),n=this.applyTransform(e.slice(2,4),t),r=this.applyTransform([e[0],e[3]],t),a=this.applyTransform([e[2],e[1]],t);return[Math.min(s[0],n[0],r[0],a[0]),Math.min(s[1],n[1],r[1],a[1]),Math.max(s[0],n[0],r[0],a[0]),Math.max(s[1],n[1],r[1],a[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],s=e[0]*t[0]+e[1]*t[2],n=e[0]*t[1]+e[1]*t[3],r=e[2]*t[0]+e[3]*t[2],a=e[2]*t[1]+e[3]*t[3],o=(s+a)/2,l=Math.sqrt((s+a)**2-4*(s*a-r*n))/2,c=o+l||1,h=o-l||1;return[Math.sqrt(c),Math.sqrt(h)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),n=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>n)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>a?null:[s,r,n,a]}static#e(e,t,s,n,r,a,o,l,c,h){if(c<=0||c>=1)return;const d=1-c,p=c*c,f=p*c,v=d*(d*(d*e+3*c*t)+3*p*s)+f*n,w=d*(d*(d*r+3*c*a)+3*p*o)+f*l;h[0]=Math.min(h[0],v),h[1]=Math.min(h[1],w),h[2]=Math.max(h[2],v),h[3]=Math.max(h[3],w)}static#t(e,t,s,n,r,a,o,l,c,h,d,p){if(Math.abs(c)<1e-12){Math.abs(h)>=1e-12&&this.#e(e,t,s,n,r,a,o,l,-d/h,p);return}const f=h**2-4*d*c;if(f<0)return;const v=Math.sqrt(f),w=2*c;this.#e(e,t,s,n,r,a,o,l,(-h+v)/w,p),this.#e(e,t,s,n,r,a,o,l,(-h-v)/w,p)}static bezierBoundingBox(e,t,s,n,r,a,o,l,c){return c?(c[0]=Math.min(c[0],e,o),c[1]=Math.min(c[1],t,l),c[2]=Math.max(c[2],e,o),c[3]=Math.max(c[3],t,l)):c=[Math.min(e,o),Math.min(t,l),Math.max(e,o),Math.max(t,l)],this.#t(e,s,r,o,t,n,a,l,3*(-e+3*(s-r)+o),6*(e-2*s+r),3*(s-e),c),this.#t(e,s,r,o,t,n,a,l,3*(-t+3*(n-a)+l),6*(t-2*n+a),3*(n-t),c),c}}function W_(i){return decodeURIComponent(escape(i))}let sf=null,vg=null;function V_(i){return sf||(sf=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,vg=new Map([["ï¬…","Å¿t"]])),i.replaceAll(sf,(e,t,s)=>t?t.normalize("NFKC"):vg.get(s))}function G_(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const i=new Uint8Array(32);return crypto.getRandomValues(i),w1(i)}const Pp="pdfjs_internal_id_",ir={BEZIER_CURVE_TO:0,MOVE_TO:1,LINE_TO:2,QUADRATIC_CURVE_TO:3,RESTORE:4,SAVE:5,SCALE:6,TRANSFORM:7,TRANSLATE:8};function X_(i){return Uint8Array.prototype.toBase64?i.toBase64():btoa(w1(i))}typeof Promise.try!="function"&&(Promise.try=function(i,...e){return new Promise(t=>{t(i(...e))})});const or="http://www.w3.org/2000/svg";class qo{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function Vu(i,e="text"){if(Ul(i,document.baseURI)){const t=await fetch(i);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,s)=>{const n=new XMLHttpRequest;n.open("GET",i,!0),n.responseType=e,n.onreadystatechange=()=>{if(n.readyState===XMLHttpRequest.DONE){if(n.status===200||n.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(n.response);return}t(n.responseText);return}s(new Error(n.statusText))}},n.send(null)})}class Rc{constructor({viewBox:e,scale:t,rotation:s,offsetX:n=0,offsetY:r=0,dontFlip:a=!1}){this.viewBox=e,this.scale=t,this.rotation=s,this.offsetX=n,this.offsetY=r;const o=(e[2]+e[0])/2,l=(e[3]+e[1])/2;let c,h,d,p;switch(s%=360,s<0&&(s+=360),s){case 180:c=-1,h=0,d=0,p=1;break;case 90:c=0,h=1,d=1,p=0;break;case 270:c=0,h=-1,d=-1,p=0;break;case 0:c=1,h=0,d=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(d=-d,p=-p);let f,v,w,A;c===0?(f=Math.abs(l-e[1])*t+n,v=Math.abs(o-e[0])*t+r,w=(e[3]-e[1])*t,A=(e[2]-e[0])*t):(f=Math.abs(o-e[0])*t+n,v=Math.abs(l-e[1])*t+r,w=(e[2]-e[0])*t,A=(e[3]-e[1])*t),this.transform=[c*t,h*t,d*t,p*t,f-c*t*o-d*t*l,v-h*t*o-p*t*l],this.width=w,this.height=A}get rawDims(){const{viewBox:e}=this;return xt(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:n=this.offsetY,dontFlip:r=!1}={}){return new Rc({viewBox:this.viewBox.slice(),scale:e,rotation:t,offsetX:s,offsetY:n,dontFlip:r})}convertToViewportPoint(e,t){return He.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=He.applyTransform([e[0],e[1]],this.transform),s=He.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){return He.applyInverseTransform([e,t],this.transform)}}class Lp extends Yr{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Gu(i){const e=i.length;let t=0;for(;t<e&&i[t].trim()==="";)t++;return i.substring(t,t+5).toLowerCase()==="data:"}function Tp(i){return typeof i=="string"&&/\.pdf$/i.test(i)}function Y_(i){return[i]=i.split(/[#?]/,1),i.substring(i.lastIndexOf("/")+1)}function K_(i,e="document.pdf"){if(typeof i!="string")return e;if(Gu(i))return yt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,s=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,n=t.exec(i);let r=s.exec(n[1])||s.exec(n[2])||s.exec(n[3]);if(r&&(r=r[0],r.includes("%")))try{r=s.exec(decodeURIComponent(r))[0]}catch{}return r||e}class wg{started=Object.create(null);times=[];time(e){e in this.started&&yt(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||yt(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:n,end:r}of this.times)e.push(`${s.padEnd(t)} ${r-n}ms
`);return e.join("")}}function Ul(i,e){try{const{protocol:t}=e?new URL(i,e):new URL(i);return t==="http:"||t==="https:"}catch{return!1}}function bi(i){i.preventDefault()}function di(i){i.preventDefault(),i.stopPropagation()}function xg(i){console.log("Deprecated API usage: "+i)}class x1{static#e;static toDateObject(e){if(!e||typeof e!="string")return null;this.#e||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=this.#e.exec(e);if(!t)return null;const s=parseInt(t[1],10);let n=parseInt(t[2],10);n=n>=1&&n<=12?n-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const c=t[7]||"Z";let h=parseInt(t[8],10);h=h>=0&&h<=23?h:0;let d=parseInt(t[9],10)||0;return d=d>=0&&d<=59?d:0,c==="-"?(a+=h,o+=d):c==="+"&&(a-=h,o-=d),new Date(Date.UTC(s,n,r,a,o,l))}}function J_(i,{scale:e=1,rotation:t=0}){const{width:s,height:n}=i.attributes.style,r=[0,0,parseInt(s),parseInt(n)];return new Rc({viewBox:r,scale:e,rotation:t})}function jp(i){if(i.startsWith("#")){const e=parseInt(i.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return i.startsWith("rgb(")?i.slice(4,-1).split(",").map(e=>parseInt(e)):i.startsWith("rgba(")?i.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(yt(`Not a valid color format: "${i}"`),[0,0,0])}function Z_(i){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of i.keys()){e.style.color=t;const s=window.getComputedStyle(e).color;i.set(t,jp(s))}e.remove()}function es(i){const{a:e,b:t,c:s,d:n,e:r,f:a}=i.getTransform();return[e,t,s,n,r,a]}function ji(i){const{a:e,b:t,c:s,d:n,e:r,f:a}=i.getTransform().invertSelf();return[e,t,s,n,r,a]}function Aa(i,e,t=!1,s=!0){if(e instanceof Rc){const{pageWidth:n,pageHeight:r}=e.rawDims,{style:a}=i,o=ln.isCSSRoundSupported,l=`var(--scale-factor) * ${n}px`,c=`var(--scale-factor) * ${r}px`,h=o?`round(down, ${l}, var(--scale-round-x, 1px))`:`calc(${l})`,d=o?`round(down, ${c}, var(--scale-round-y, 1px))`:`calc(${c})`;!t||e.rotation%180===0?(a.width=h,a.height=d):(a.width=d,a.height=h)}s&&i.setAttribute("data-main-rotation",e.rotation)}class Df{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}class tc{#e=null;#t=null;#s;#n=null;#r=null;static#i=null;constructor(e){this.#s=e,tc.#i||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"})}render(){const e=this.#e=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=this.#s._uiManager._signal;e.addEventListener("contextmenu",bi,{signal:t}),e.addEventListener("pointerdown",tc.#c,{signal:t});const s=this.#n=document.createElement("div");s.className="buttons",e.append(s);const n=this.#s.toolbarPosition;if(n){const{style:r}=e,a=this.#s._uiManager.direction==="ltr"?1-n[0]:n[0];r.insetInlineEnd=`${100*a}%`,r.top=`calc(${100*n[1]}% + var(--editor-toolbar-vert-offset))`}return this.#u(),e}get div(){return this.#e}static#c(e){e.stopPropagation()}#o(e){this.#s._focusEventsAllowed=!1,di(e)}#h(e){this.#s._focusEventsAllowed=!0,di(e)}#l(e){const t=this.#s._uiManager._signal;e.addEventListener("focusin",this.#o.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",bi,{signal:t})}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#r?.shown()}#u(){const{editorType:e,_uiManager:t}=this.#s,s=document.createElement("button");s.className="delete",s.tabIndex=0,s.setAttribute("data-l10n-id",tc.#i[e]),this.#l(s),s.addEventListener("click",n=>{t.delete()},{signal:t._signal}),this.#n.append(s)}get#a(){const e=document.createElement("div");return e.className="divider",e}async addAltText(e){const t=await e.render();this.#l(t),this.#n.prepend(t,this.#a),this.#r=e}addColorPicker(e){this.#t=e;const t=e.renderButton();this.#l(t),this.#n.prepend(t,this.#a)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}}class Q_{#e=null;#t=null;#s;constructor(e){this.#s=e}#n(){const e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",bi,{signal:this.#s._signal});const t=this.#e=document.createElement("div");return t.className="buttons",e.append(t),this.#i(),e}#r(e,t){let s=0,n=0;for(const r of e){const a=r.y+r.height;if(a<s)continue;const o=r.x+(t?r.width:0);if(a>s){n=o,s=a;continue}t?o>n&&(n=o):o<n&&(n=o)}return[t?1-n:n,s]}show(e,t,s){const[n,r]=this.#r(t,s),{style:a}=this.#t||=this.#n();e.append(this.#t),a.insetInlineEnd=`${100*n}%`,a.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#i(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const s=this.#s._signal;e.addEventListener("contextmenu",bi,{signal:s}),e.addEventListener("click",()=>{this.#s.highlightSelection("floating_button")},{signal:s}),this.#e.append(e)}}function gu(i,e,t){for(const s of t)e.addEventListener(s,i[s].bind(i))}class eA{#e=0;get id(){return`${R_}${this.#e++}`}}class Ip{#e=G_();#t=0;#s=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),n=new Image;n.src=e;const r=n.decode().then(()=>(s.drawImage(n,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return xt(this,"_isSVGFittingCanvas",r)}async#n(e,t){this.#s||=new Map;let s=this.#s.get(e);if(s===null)return null;if(s?.bitmap)return s.refCounter+=1,s;try{s||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let n;if(typeof t=="string"?(s.url=t,n=await Vu(t,"blob")):t instanceof File?n=s.file=t:t instanceof Blob&&(n=t),n.type==="image/svg+xml"){const r=Ip._isSVGFittingCanvas,a=new FileReader,o=new Image,l=new Promise((c,h)=>{o.onload=()=>{s.bitmap=o,s.isSvg=!0,c()},a.onload=async()=>{const d=s.svgUrl=a.result;o.src=await r?`${d}#svgView(preserveAspectRatio(none))`:d},o.onerror=a.onerror=h});a.readAsDataURL(n),await l}else s.bitmap=await createImageBitmap(n);s.refCounter=1}catch(n){yt(n),s=null}return this.#s.set(e,s),s&&this.#s.set(s.id,s),s}async getFromFile(e){const{lastModified:t,name:s,size:n,type:r}=e;return this.#n(`${t}_${s}_${n}_${r}`,e)}async getFromUrl(e){return this.#n(e,e)}async getFromBlob(e,t){const s=await t;return this.#n(e,s)}async getFromId(e){this.#s||=new Map;const t=this.#s.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:s}=t;return delete t.blobPromise,this.getFromBlob(t.id,s)}return this.getFromUrl(t.url)}getFromCanvas(e,t){this.#s||=new Map;let s=this.#s.get(e);if(s?.bitmap)return s.refCounter+=1,s;const n=new OffscreenCanvas(t.width,t.height);return n.getContext("2d").drawImage(t,0,0),s={bitmap:n.transferToImageBitmap(),id:`image_${this.#e}_${this.#t++}`,refCounter:1,isSvg:!1},this.#s.set(e,s),this.#s.set(s.id,s),s}getSvgUrl(e){const t=this.#s.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#s||=new Map;const t=this.#s.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:s}=t;if(!t.url&&!t.file){const n=new OffscreenCanvas(s.width,s.height);n.getContext("bitmaprenderer").transferFromImageBitmap(s),t.blobPromise=n.convertToBlob()}s.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#e}_`)}}class tA{#e=[];#t=!1;#s;#n=-1;constructor(e=128){this.#s=e}add({cmd:e,undo:t,post:s,mustExec:n,type:r=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(n&&e(),this.#t)return;const l={cmd:e,undo:t,post:s,type:r};if(this.#n===-1){this.#e.length>0&&(this.#e.length=0),this.#n=0,this.#e.push(l);return}if(a&&this.#e[this.#n].type===r){o&&(l.undo=this.#e[this.#n].undo),this.#e[this.#n]=l;return}const c=this.#n+1;c===this.#s?this.#e.splice(0,1):(this.#n=c,c<this.#e.length&&this.#e.splice(c)),this.#e.push(l)}undo(){if(this.#n===-1)return;this.#t=!0;const{undo:e,post:t}=this.#e[this.#n];e(),t?.(),this.#t=!1,this.#n-=1}redo(){if(this.#n<this.#e.length-1){this.#n+=1,this.#t=!0;const{cmd:e,post:t}=this.#e[this.#n];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#e.length-1}cleanType(e){if(this.#n!==-1){for(let t=this.#n;t>=0;t--)if(this.#e[t].type!==e){this.#e.splice(t+1,this.#n-t),this.#n=t;return}this.#e.length=0,this.#n=-1}}destroy(){this.#e=null}}class Oc{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=ln.platform;for(const[s,n,r={}]of e)for(const a of s){const o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:n,options:r}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:n,options:r}),this.allKeys.add(a.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(this.#e(t));if(!s)return;const{callback:n,options:{bubbles:r=!1,args:a=[],checker:o=null}}=s;o&&!o(e,t)||(n.bind(e,...a,t)(),r||di(t))}}class Rp{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return Z_(e),xt(this,"_colors",e)}convert(e){const t=jp(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,n]of this._colors)if(n.every((r,a)=>r===t[a]))return Rp._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?He.makeHexColor(...t):e}}class Ur{#e=new AbortController;#t=null;#s=new Map;#n=new Map;#r=null;#i=null;#c=null;#o=new tA;#h=null;#l=null;#u=0;#a=new Set;#d=null;#f=null;#p=new Set;_editorUndoBar=null;#g=!1;#m=!1;#b=!1;#y=null;#w=null;#x=null;#S=null;#N=!1;#E=null;#C=new eA;#_=!1;#P=!1;#k=null;#L=null;#R=null;#D=null;#A=pt.NONE;#v=new Set;#I=null;#B=null;#q=null;#U={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#M=[0,0];#j=null;#$=null;#V=null;#O=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=Ur.prototype,t=a=>a.#$.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),s=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},n=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return xt(this,"_keyboardManager",new Oc([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&a.#$.contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&a.#$.contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}constructor(e,t,s,n,r,a,o,l,c,h,d,p){const f=this._signal=this.#e.signal;this.#$=e,this.#V=t,this.#r=s,this._eventBus=n,n._on("editingaction",this.onEditingAction.bind(this),{signal:f}),n._on("pagechanging",this.onPageChanging.bind(this),{signal:f}),n._on("scalechanging",this.onScaleChanging.bind(this),{signal:f}),n._on("rotationchanging",this.onRotationChanging.bind(this),{signal:f}),n._on("setpreference",this.onSetPreference.bind(this),{signal:f}),n._on("switchannotationeditorparams",v=>this.updateParams(v.type,v.value),{signal:f}),this.#te(),this.#re(),this.#X(),this.#i=r.annotationStorage,this.#y=r.filterFactory,this.#B=a,this.#S=o||null,this.#g=l,this.#m=c,this.#b=h,this.#D=d||null,this.viewParameters={realScale:qo.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=p||null}destroy(){this.#O?.resolve(),this.#O=null,this.#e?.abort(),this.#e=null,this._signal=null;for(const e of this.#n.values())e.destroy();this.#n.clear(),this.#s.clear(),this.#p.clear(),this.#t=null,this.#v.clear(),this.#o.destroy(),this.#r?.destroy(),this.#E?.hide(),this.#E=null,this.#w&&(clearTimeout(this.#w),this.#w=null),this.#j&&(clearTimeout(this.#j),this.#j=null),this._editorUndoBar?.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return this.#D}get useNewAltTextFlow(){return this.#m}get useNewAltTextWhenAddingImage(){return this.#b}get hcmFilter(){return xt(this,"hcmFilter",this.#B?this.#y.addHCMFilter(this.#B.foreground,this.#B.background):"none")}get direction(){return xt(this,"direction",getComputedStyle(this.#$).direction)}get highlightColors(){return xt(this,"highlightColors",this.#S?new Map(this.#S.split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return xt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#l=e}setMainHighlightColorPicker(e){this.#R=e}editAltText(e,t=!1){this.#r?.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":this.#b=t;break}}onPageChanging({pageNumber:e}){this.#u=e-1}focusMainContainer(){this.#$.focus()}findParent(e,t){for(const s of this.#n.values()){const{x:n,y:r,width:a,height:o}=s.div.getBoundingClientRect();if(e>=n&&e<=n+a&&t>=r&&t<=r+o)return s}return null}disableUserSelect(e=!1){this.#V.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#p.add(e)}removeShouldRescale(e){this.#p.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*qo.PDF_TO_CSS_UNITS;for(const t of this.#p)t.onScaleChanging();this.#l?.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}#H({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e}#G(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of this.#n.values())if(s.hasTextLayer(e))return s;return null}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:s,anchorOffset:n,focusNode:r,focusOffset:a}=t,o=t.toString(),c=this.#H(t).closest(".textLayer"),h=this.getSelectionBoxes(c);if(!h)return;t.empty();const d=this.#G(c),p=this.#A===pt.NONE,f=()=>{d?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:h,anchorNode:s,anchorOffset:n,focusNode:r,focusOffset:a,text:o}),p&&this.showAllEditors("highlight",!0,!0)};if(p){this.switchToMode(pt.HIGHLIGHT,f);return}f()}#Q(){const e=document.getSelection();if(!e||e.isCollapsed)return;const s=this.#H(e).closest(".textLayer"),n=this.getSelectionBoxes(s);n&&(this.#E||=new Q_(this),this.#E.show(s,n,this.direction==="ltr"))}addToAnnotationStorage(e){!e.isEmpty()&&this.#i&&!this.#i.has(e.id)&&this.#i.setValue(e.id,e)}#ee(){const e=document.getSelection();if(!e||e.isCollapsed){this.#I&&(this.#E?.hide(),this.#I=null,this.#T({hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===this.#I)return;const n=this.#H(e).closest(".textLayer");if(!n){this.#I&&(this.#E?.hide(),this.#I=null,this.#T({hasSelectedText:!1}));return}if(this.#E?.hide(),this.#I=t,this.#T({hasSelectedText:!0}),!(this.#A!==pt.HIGHLIGHT&&this.#A!==pt.NONE)&&(this.#A===pt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#N=this.isShiftKeyDown,!this.isShiftKeyDown)){const r=this.#A===pt.HIGHLIGHT?this.#G(n):null;r?.toggleDrawing();const a=new AbortController,o=this.combinedSignal(a),l=c=>{c.type==="pointerup"&&c.button!==0||(a.abort(),r?.toggleDrawing(!0),c.type==="pointerup"&&this.#W("main_toolbar"))};window.addEventListener("pointerup",l,{signal:o}),window.addEventListener("blur",l,{signal:o})}}#W(e=""){this.#A===pt.HIGHLIGHT?this.highlightSelection(e):this.#g&&this.#Q()}#te(){document.addEventListener("selectionchange",this.#ee.bind(this),{signal:this._signal})}#se(){if(this.#x)return;this.#x=new AbortController;const e=this.combinedSignal(this.#x);window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}#ne(){this.#x?.abort(),this.#x=null}blur(){if(this.isShiftKeyDown=!1,this.#N&&(this.#N=!1,this.#W("main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#v)if(t.div.contains(e)){this.#L=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#L)return;const[e,t]=this.#L;this.#L=null,t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}#X(){if(this.#k)return;this.#k=new AbortController;const e=this.combinedSignal(this.#k);window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}#ie(){this.#k?.abort(),this.#k=null}#Y(){if(this.#h)return;this.#h=new AbortController;const e=this.combinedSignal(this.#h);document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}#K(){this.#h?.abort(),this.#h=null}#re(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}addEditListeners(){this.#X(),this.#Y()}removeEditListeners(){this.#ie(),this.#K()}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of this.#f)if(s.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const s of this.#f)if(s.isHandlingMimeForPasting(t.type)){s.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const s of this.#v){const n=s.serialize(!0);n&&t.push(n)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const a of this.#f)if(a.isHandlingMimeForPasting(r.type)){a.paste(r,this.currentLayer);return}let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(r){yt(`paste: "${r.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const n=this.currentLayer;try{const r=[];for(const l of s){const c=await n.deserialize(l);if(!c)return;r.push(c)}const a=()=>{for(const l of r)this.#J(l);this.#Z(r)},o=()=>{for(const l of r)l.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(r){yt(`paste: "${r.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),this.#A!==pt.NONE&&!this.isEditorHandlingKeyboard&&Ur._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,this.#N&&(this.#N=!1,this.#W("main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#T(e){Object.entries(e).some(([s,n])=>this.#U[s]!==n)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#U,e)}),this.#A===pt.HIGHLIGHT&&e.hasSelectedEditor===!1&&this.#F([[Nt.HIGHLIGHT_FREE,!0]]))}#F(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#se(),this.#Y(),this.#T({isEditing:this.#A!==pt.NONE,isEmpty:this.#z(),hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:this.#o.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ne(),this.#K(),this.#T({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#f){this.#f=e;for(const t of this.#f)this.#F(t.defaultPropertiesToUpdate)}}getId(){return this.#C.id}get currentLayer(){return this.#n.get(this.#u)}getLayer(e){return this.#n.get(e)}get currentPageIndex(){return this.#u}addLayer(e){this.#n.set(e.pageIndex,e),this.#_?e.enable():e.disable()}removeLayer(e){this.#n.delete(e.pageIndex)}async updateMode(e,t=null,s=!1){if(this.#A!==e&&!(this.#O&&(await this.#O.promise,!this.#O))){if(this.#O=Promise.withResolvers(),this.#A=e,e===pt.NONE){this.setEditingState(!1),this.#oe(),this._editorUndoBar?.hide(),this.#O.resolve();return}this.setEditingState(!0),await this.#ae(),this.unselectAll();for(const n of this.#n.values())n.updateMode(e);if(!t){s&&this.addNewEditorFromKeyboard(),this.#O.resolve();return}for(const n of this.#s.values())n.annotationElementId===t?(this.setSelected(n),n.enterInEditMode()):n.unselect();this.#O.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==this.#A&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){if(this.#f){switch(e){case Nt.CREATE:this.currentLayer.addNewEditor();return;case Nt.HIGHLIGHT_DEFAULT_COLOR:this.#R?.updateColor(t);break;case Nt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#q||=new Map).set(e,t),this.showAllEditors("highlight",t);break}for(const s of this.#v)s.updateParams(e,t);for(const s of this.#f)s.updateDefaultParams(e,t)}}showAllEditors(e,t,s=!1){for(const r of this.#s.values())r.editorType===e&&r.show(t);(this.#q?.get(Nt.HIGHLIGHT_SHOW_ALL)??!0)!==t&&this.#F([[Nt.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(this.#P!==e){this.#P=e;for(const t of this.#n.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}async#ae(){if(!this.#_){this.#_=!0;const e=[];for(const t of this.#n.values())e.push(t.enable());await Promise.all(e);for(const t of this.#s.values())t.enable()}}#oe(){if(this.unselectAll(),this.#_){this.#_=!1;for(const e of this.#n.values())e.disable();for(const e of this.#s.values())e.disable()}}getEditors(e){const t=[];for(const s of this.#s.values())s.pageIndex===e&&t.push(s);return t}getEditor(e){return this.#s.get(e)}addEditor(e){this.#s.set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(this.#w&&clearTimeout(this.#w),this.#w=setTimeout(()=>{this.focusMainContainer(),this.#w=null},0)),this.#s.delete(e.id),this.unselect(e),(!e.annotationElementId||!this.#a.has(e.annotationElementId))&&this.#i?.remove(e.id)}addDeletedAnnotationElement(e){this.#a.add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return this.#a.has(e)}removeDeletedAnnotationElement(e){this.#a.delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}#J(e){const t=this.#n.get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#F(e.propertiesToUpdate))}get#le(){let e=null;for(e of this.#v);return e}updateUI(e){this.#le===e&&this.#F(e.propertiesToUpdate)}updateUIForDefaultProperties(e){this.#F(e.defaultPropertiesToUpdate)}toggleSelected(e){if(this.#v.has(e)){this.#v.delete(e),e.unselect(),this.#T({hasSelectedEditor:this.hasSelection});return}this.#v.add(e),e.select(),this.#F(e.propertiesToUpdate),this.#T({hasSelectedEditor:!0})}setSelected(e){this.#l?.commitOrRemove();for(const t of this.#v)t!==e&&t.unselect();this.#v.clear(),this.#v.add(e),e.select(),this.#F(e.propertiesToUpdate),this.#T({hasSelectedEditor:!0})}isSelected(e){return this.#v.has(e)}get firstSelectedEditor(){return this.#v.values().next().value}unselect(e){e.unselect(),this.#v.delete(e),this.#T({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#v.size!==0}get isEnterHandled(){return this.#v.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#o.undo(),this.#T({hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#z()}),this._editorUndoBar?.hide()}redo(){this.#o.redo(),this.#T({hasSomethingToUndo:!0,hasSomethingToRedo:this.#o.hasSomethingToRedo(),isEmpty:this.#z()})}addCommands(e){this.#o.add(e),this.#T({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#z()})}cleanUndoStack(e){this.#o.cleanType(e)}#z(){if(this.#s.size===0)return!0;if(this.#s.size===1)for(const e of this.#s.values())return e.isEmpty();return!1}delete(){this.commitOrRemove();const e=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...this.#v],s=()=>{this._editorUndoBar?.show(n,t.length===1?t[0].editorType:t.length);for(const r of t)r.remove()},n=()=>{for(const r of t)this.#J(r)};this.addCommands({cmd:s,undo:n,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#Z(e){for(const t of this.#v)t.unselect();this.#v.clear();for(const t of e)t.isEmpty()||(this.#v.add(t),t.select());this.#T({hasSelectedEditor:this.hasSelection})}selectAll(){for(const e of this.#v)e.commit();this.#Z(this.#s.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#A!==pt.NONE))&&!this.#l?.commitOrRemove()&&this.hasSelection){for(const e of this.#v)e.unselect();this.#v.clear(),this.#T({hasSelectedEditor:!1})}}translateSelectedEditors(e,t,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;this.#M[0]+=e,this.#M[1]+=t;const[n,r]=this.#M,a=[...this.#v],o=1e3;this.#j&&clearTimeout(this.#j),this.#j=setTimeout(()=>{this.#j=null,this.#M[0]=this.#M[1]=0,this.addCommands({cmd:()=>{for(const l of a)this.#s.has(l.id)&&l.translateInPage(n,r)},undo:()=>{for(const l of a)this.#s.has(l.id)&&l.translateInPage(-n,-r)},mustExec:!1})},o);for(const l of a)l.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#d=new Map;for(const e of this.#v)this.#d.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#d)return!1;this.disableUserSelect(!1);const e=this.#d;this.#d=null;let t=!1;for(const[{x:n,y:r,pageIndex:a},o]of e)o.newX=n,o.newY=r,o.newPageIndex=a,t||=n!==o.savedX||r!==o.savedY||a!==o.savedPageIndex;if(!t)return!1;const s=(n,r,a,o)=>{if(this.#s.has(n.id)){const l=this.#n.get(o);l?n._setParentAndPosition(l,r,a):(n.pageIndex=o,n.x=r,n.y=a)}};return this.addCommands({cmd:()=>{for(const[n,{newX:r,newY:a,newPageIndex:o}]of e)s(n,r,a,o)},undo:()=>{for(const[n,{savedX:r,savedY:a,savedPageIndex:o}]of e)s(n,r,a,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#d)for(const s of this.#d.keys())s.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#v.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#A}get imageManager(){return xt(this,"imageManager",new Ip)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let c=0,h=t.rangeCount;c<h;c++)if(!e.contains(t.getRangeAt(c).commonAncestorContainer))return null;const{x:s,y:n,width:r,height:a}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(c,h,d,p)=>({x:(h-n)/a,y:1-(c+d-s)/r,width:p/a,height:d/r});break;case"180":o=(c,h,d,p)=>({x:1-(c+d-s)/r,y:1-(h+p-n)/a,width:d/r,height:p/a});break;case"270":o=(c,h,d,p)=>({x:1-(h+p-n)/a,y:(c-s)/r,width:p/a,height:d/r});break;default:o=(c,h,d,p)=>({x:(c-s)/r,y:(h-n)/a,width:d/r,height:p/a});break}const l=[];for(let c=0,h=t.rangeCount;c<h;c++){const d=t.getRangeAt(c);if(!d.collapsed)for(const{x:p,y:f,width:v,height:w}of d.getClientRects())v===0||w===0||l.push(o(p,f,v,w))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(this.#c||=new Map).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){this.#c?.delete(e)}renderAnnotationElement(e){const t=this.#c?.get(e.data.id);if(!t)return;const s=this.#i.getRawValue(t);s&&(this.#A===pt.NONE&&!s.hasBeenModified||s.renderAnnotationElement(e))}}class Mi{#e=null;#t=!1;#s=null;#n=null;#r=null;#i=null;#c=!1;#o=null;#h=null;#l=null;#u=null;#a=!1;static#d=null;static _l10n=null;constructor(e){this.#h=e,this.#a=e._uiManager.useNewAltTextFlow,Mi.#d||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(e){Mi._l10n??=e}async render(){const e=this.#s=document.createElement("button");e.className="altText",e.tabIndex="0";const t=this.#n=document.createElement("span");e.append(t),this.#a?(e.classList.add("new"),e.setAttribute("data-l10n-id",Mi.#d.missing),t.setAttribute("data-l10n-id",Mi.#d["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=this.#h._uiManager._signal;e.addEventListener("contextmenu",bi,{signal:s}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:s});const n=r=>{r.preventDefault(),this.#h._uiManager.editAltText(this.#h),this.#a&&this.#h._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#f}})};return e.addEventListener("click",n,{capture:!0,signal:s}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(this.#c=!0,n(r))},{signal:s}),await this.#p(),e}get#f(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#s&&(this.#s.focus({focusVisible:this.#c}),this.#c=!1)}isEmpty(){return this.#a?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#a?this.#e!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(e){this.#e===null&&(this.#l=e,this.#u=await Mi._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e}),this.#p())}toggleAltTextBadge(e=!1){if(!this.#a||this.#e){this.#o?.remove(),this.#o=null;return}if(!this.#o){const t=this.#o=document.createElement("div");t.className="noAltTextBadge",this.#h.div.append(t)}this.#o.classList.toggle("hidden",!e)}serialize(e){let t=this.#e;return!e&&this.#l===t&&(t=this.#u),{altText:t,decorative:this.#t,guessedText:this.#l,textWithDisclaimer:this.#u}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:e,decorative:t,guessedText:s,textWithDisclaimer:n,cancel:r=!1}){s&&(this.#l=s,this.#u=n),!(this.#e===e&&this.#t===t)&&(r||(this.#e=e,this.#t=t),this.#p())}toggle(e=!1){this.#s&&(!e&&this.#i&&(clearTimeout(this.#i),this.#i=null),this.#s.disabled=!e)}shown(){this.#h._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#f}})}destroy(){this.#s?.remove(),this.#s=null,this.#n=null,this.#r=null,this.#o?.remove(),this.#o=null}async#p(){const e=this.#s;if(!e)return;if(this.#a){if(e.classList.toggle("done",!!this.#e),e.setAttribute("data-l10n-id",Mi.#d[this.#f]),this.#n?.setAttribute("data-l10n-id",Mi.#d[`${this.#f}-label`]),!this.#e){this.#r?.remove();return}}else{if(!this.#e&&!this.#t){e.classList.remove("done"),this.#r?.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=this.#r;if(!t){this.#r=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${this.#h.id}`;const n=100,r=this.#h._uiManager._signal;r.addEventListener("abort",()=>{clearTimeout(this.#i),this.#i=null},{once:!0}),e.addEventListener("mouseenter",()=>{this.#i=setTimeout(()=>{this.#i=null,this.#r.classList.add("show"),this.#h._reportTelemetry({action:"alt_text_tooltip"})},n)},{signal:r}),e.addEventListener("mouseleave",()=>{this.#i&&(clearTimeout(this.#i),this.#i=null),this.#r?.classList.remove("show")},{signal:r})}this.#t?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=this.#e),t.parentNode||e.append(t),this.#h.getImageForAltText()?.setAttribute("aria-describedby",t.id)}}class bt{#e=null;#t=null;#s=null;#n=!1;#r=null;#i="";#c=!1;#o=null;#h=null;#l=null;#u=null;#a="";#d=!1;#f=null;#p=!1;#g=!1;#m=!1;#b=null;#y=0;#w=0;#x=null;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#S=!1;#N=bt._zIndex++;static _borderLineWidth=-1;static _colorManager=new Rp;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const e=bt.prototype._resizeWithKeyboard,t=Ur.TRANSLATE_SMALL,s=Ur.TRANSLATE_BIG;return xt(this,"_resizerKeyboardManager",new Oc([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],bt.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:s,pageHeight:n,pageX:r,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,n],this.pageTranslation=[r,a];const[o,l]=this.parentDimensions;this.x=e.x/o,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return xt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new sA({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(bt._l10n??=e,bt._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),bt._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);bt._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Ht("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#S}set _isDraggable(e){this.#S=e,this.div?.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#N}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):this.#j(),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#d?this.#d=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,n){const[r,a]=this.parentDimensions;[s,n]=this.screenToPageTranslation(s,n),this.x=(e+s)/r,this.y=(t+n)/a,this.fixAndSetPosition()}#E([e,t],s,n){[s,n]=this.screenToPageTranslation(s,n),this.x+=s/e,this.y+=n/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(e,t){this.#E(this.parentDimensions,e,t)}translateInPage(e,t){this.#f||=[this.x,this.y,this.width,this.height],this.#E(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){this.#f||=[this.x,this.y,this.width,this.height];const{div:s,parentDimensions:[n,r]}=this;if(this.x+=e/n,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:d,y:p}=this.div.getBoundingClientRect();this.parent.findNewParent(this,d,p)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[l,c]=this.getBaseTranslation();a+=l,o+=c;const{style:h}=s;h.left=`${(100*a).toFixed(2)}%`,h.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),s.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!this.#f&&(this.#f[0]!==this.x||this.#f[1]!==this.y)}get _hasBeenResized(){return!!this.#f&&(this.#f[2]!==this.width||this.#f[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=bt,n=s/e,r=s/t;switch(this.rotation){case 90:return[-n,r];case 180:return[n,r];case 270:return[n,-r];default:return[-n,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[s,n]}=this;let{x:r,y:a,width:o,height:l}=this;if(o*=s,l*=n,r*=s,a*=n,this._mustFixPosition)switch(e){case 0:r=Math.max(0,Math.min(s-o,r)),a=Math.max(0,Math.min(n-l,a));break;case 90:r=Math.max(0,Math.min(s-l,r)),a=Math.min(n,Math.max(o,a));break;case 180:r=Math.min(s,Math.max(o,r)),a=Math.min(n,Math.max(l,a));break;case 270:r=Math.min(s,Math.max(l,r)),a=Math.max(0,Math.min(n-o,a));break}this.x=r/=s,this.y=a/=n;const[c,h]=this.getBaseTranslation();r+=c,a+=h,t.left=`${(100*r).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}static#C(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return bt.#C(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return bt.#C(e,t,360-this.parentRotation)}#_(e){switch(e){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this;return[t*e,s*e]}setDims(e,t){const[s,n]=this.parentDimensions,{style:r}=this.div;r.width=`${(100*e/s).toFixed(2)}%`,this.#c||(r.height=`${(100*t/n).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:s}=e,n=s.endsWith("%"),r=!this.#c&&t.endsWith("%");if(n&&r)return;const[a,o]=this.parentDimensions;n||(e.width=`${(100*parseFloat(s)/a).toFixed(2)}%`),!this.#c&&!r&&(e.height=`${(100*parseFloat(t)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#P(){if(this.#o)return;this.#o=document.createElement("div"),this.#o.classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const n=document.createElement("div");this.#o.append(n),n.classList.add("resizer",s),n.setAttribute("data-resizer-name",s),n.addEventListener("pointerdown",this.#k.bind(this,s),{signal:t}),n.addEventListener("contextmenu",bi,{signal:t}),n.tabIndex=-1}this.div.prepend(this.#o)}#k(e,t){t.preventDefault();const{isMac:s}=ln.platform;if(t.button!==0||t.ctrlKey&&s)return;this.#s?.toggle(!1);const n=this._isDraggable;this._isDraggable=!1,this.#h=[t.screenX,t.screenY];const r=new AbortController,a=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#D.bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",di,{passive:!1,signal:a}),window.addEventListener("contextmenu",bi,{signal:a}),this.#l={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const o=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const c=()=>{r.abort(),this.parent.togglePointerEvents(!0),this.#s?.toggle(!0),this._isDraggable=n,this.parent.div.style.cursor=o,this.div.style.cursor=l,this.#R()};window.addEventListener("pointerup",c,{signal:a}),window.addEventListener("blur",c,{signal:a})}#L(e,t,s,n){this.width=s,this.height=n,this.x=e,this.y=t;const[r,a]=this.parentDimensions;this.setDims(r*s,a*n),this.fixAndSetPosition(),this._onResized()}_onResized(){}#R(){if(!this.#l)return;const{savedX:e,savedY:t,savedWidth:s,savedHeight:n}=this.#l;this.#l=null;const r=this.x,a=this.y,o=this.width,l=this.height;r===e&&a===t&&o===s&&l===n||this.addCommands({cmd:this.#L.bind(this,r,a,o,l),undo:this.#L.bind(this,e,t,s,n),mustExec:!0})}#D(e,t){const[s,n]=this.parentDimensions,r=this.x,a=this.y,o=this.width,l=this.height,c=bt.MIN_SIZE/s,h=bt.MIN_SIZE/n,d=se=>Math.round(se*1e4)/1e4,p=this.#_(this.rotation),f=(se,Z)=>[p[0]*se+p[2]*Z,p[1]*se+p[3]*Z],v=this.#_(360-this.rotation),w=(se,Z)=>[v[0]*se+v[2]*Z,v[1]*se+v[3]*Z];let A,x,S=!1,j=!1;switch(e){case"topLeft":S=!0,A=(se,Z)=>[0,0],x=(se,Z)=>[se,Z];break;case"topMiddle":A=(se,Z)=>[se/2,0],x=(se,Z)=>[se/2,Z];break;case"topRight":S=!0,A=(se,Z)=>[se,0],x=(se,Z)=>[0,Z];break;case"middleRight":j=!0,A=(se,Z)=>[se,Z/2],x=(se,Z)=>[0,Z/2];break;case"bottomRight":S=!0,A=(se,Z)=>[se,Z],x=(se,Z)=>[0,0];break;case"bottomMiddle":A=(se,Z)=>[se/2,Z],x=(se,Z)=>[se/2,0];break;case"bottomLeft":S=!0,A=(se,Z)=>[0,Z],x=(se,Z)=>[se,0];break;case"middleLeft":j=!0,A=(se,Z)=>[0,Z/2],x=(se,Z)=>[se,Z/2];break}const M=A(o,l),B=x(o,l);let Q=f(...B);const q=d(r+Q[0]),O=d(a+Q[1]);let G=1,ie=1,L,R;if(t.fromKeyboard)({deltaX:L,deltaY:R}=t);else{const{screenX:se,screenY:Z}=t,[fe,me]=this.#h;[L,R]=this.screenToPageTranslation(se-fe,Z-me),this.#h[0]=se,this.#h[1]=Z}if([L,R]=w(L/s,R/n),S){const se=Math.hypot(o,l);G=ie=Math.max(Math.min(Math.hypot(B[0]-M[0]-L,B[1]-M[1]-R)/se,1/o,1/l),c/o,h/l)}else j?G=Math.max(c,Math.min(1,Math.abs(B[0]-M[0]-L)))/o:ie=Math.max(h,Math.min(1,Math.abs(B[1]-M[1]-R)))/l;const W=d(o*G),U=d(l*ie);Q=f(...x(W,U));const he=q-Q[0],ae=O-Q[1];this.#f||=[this.x,this.y,this.width,this.height],this.width=W,this.height=U,this.x=he,this.y=ae,this.setDims(s*W,n*U),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#s?.finish()}async addEditToolbar(){return this._editToolbar||this.#g?this._editToolbar:(this._editToolbar=new tc(this),this.div.append(this._editToolbar.render()),this.#s&&await this._editToolbar.addAltText(this.#s),this._editToolbar)}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#s?.destroy())}addContainer(e){const t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){this.#s||(Mi.initialize(bt._l10n),this.#s=new Mi(this),this.#e&&(this.#s.data=this.#e,this.#e=null),await this.addEditToolbar())}get altTextData(){return this.#s?.data}set altTextData(e){this.#s&&(this.#s.data=e)}get guessedAltText(){return this.#s?.guessedText}async setGuessedAltText(e){await this.#s?.setGuessedText(e)}serializeAltText(e){return this.#s?.serialize(e)}hasAltText(){return!!this.#s&&!this.#s.isEmpty()}hasAltTextData(){return this.#s?.hasData()??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=this.#n?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.#I();const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[s,n]=this.getInitialTranslation();return this.translate(s,n),gu(this,this.div,["pointerdown"]),this._uiManager._editorUndoBar?.hide(),this.div}pointerdown(e){const{isMac:t}=ln.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#d=!0,this._isDraggable){this.#v(e);return}this.#A(e)}get isSelected(){return this._uiManager.isSelected(this)}#A(e){const{isMac:t}=ln.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#v(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();const s=new AbortController,n=this._uiManager.combinedSignal(s),r={capture:!0,passive:!1,signal:n},a=l=>{s.abort(),this.#r=null,this.#d=!1,this._uiManager.endDragSession()||this.#A(l)};t&&(this.#y=e.clientX,this.#w=e.clientY,this.#r=e.pointerId,this.#i=e.pointerType,window.addEventListener("pointermove",l=>{const{clientX:c,clientY:h,pointerId:d}=l;if(d!==this.#r){di(l);return}const[p,f]=this.screenToPageTranslation(c-this.#y,h-this.#w);this.#y=c,this.#w=h,this._uiManager.dragSelectedEditors(p,f)},r),window.addEventListener("touchmove",di,r),window.addEventListener("pointerdown",l=>{l.isPrimary&&l.pointerType===this.#i&&a(l),di(l)},r)),this._onStartDragging();const o=l=>{if(!this.#r||this.#r===l.pointerId){a(l),this._onStopDragging();return}di(l)};window.addEventListener("pointerup",o,{signal:n}),window.addEventListener("blur",o,{signal:n})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#b&&clearTimeout(this.#b),this.#b=setTimeout(()=>{this.#b=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,s=this.rotation){const n=this.parentScale,[r,a]=this.pageDimensions,[o,l]=this.pageTranslation,c=e/n,h=t/n,d=this.x*r,p=this.y*a,f=this.width*r,v=this.height*a;switch(s){case 0:return[d+c+o,a-p-h-v+l,d+c+f+o,a-p-h+l];case 90:return[d+h+o,a-p+c+l,d+h+v+o,a-p+c+f+l];case 180:return[d-c-f+o,a-p+h+l,d-c+o,a-p+h+v+l];case 270:return[d-h-v+o,a-p-c-f+l,d-h+o,a-p-c+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,n,r,a]=e,o=r-s,l=a-n;switch(this.rotation){case 0:return[s,t-a,o,l];case 90:return[s,t-n,l,o];case 180:return[r,t-n,o,l];case 270:return[r,t-a,l,o];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#g=!0}disableEditMode(){this.#g=!1}isInEditMode(){return this.#g}shouldGetKeyboardEvents(){return this.#m}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:s,right:n}=this.getClientDimensions(),{innerHeight:r,innerWidth:a}=window;return t<a&&n>0&&e<r&&s>0}#I(){if(this.#u||!this.div)return;this.#u=new AbortController;const e=this._uiManager.combinedSignal(this.#u);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#I()}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){Ht("An editor must be serializable")}static async deserialize(e,t,s){const n=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s});n.rotation=e.rotation,n.#e=e.accessibilityData;const[r,a]=n.pageDimensions,[o,l,c,h]=n.getRectInCurrentCoords(e.rect,a);return n.x=o/r,n.y=l/a,n.width=c/r,n.height=h/a,n}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#u?.abort(),this.#u=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#b&&(clearTimeout(this.#b),this.#b=null),this.#j(),this.removeEditToolbar(),this.#x){for(const e of this.#x.values())clearTimeout(e);this.#x=null}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#P(),this.#o.classList.remove("hidden"),gu(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#l={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const t=this.#o.children;if(!this.#t){this.#t=Array.from(t);const a=this.#B.bind(this),o=this.#q.bind(this),l=this._uiManager._signal;for(const c of this.#t){const h=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",a,{signal:l}),c.addEventListener("blur",o,{signal:l}),c.addEventListener("focus",this.#U.bind(this,h),{signal:l}),c.setAttribute("data-l10n-id",bt._l10nResizer[h])}}const s=this.#t[0];let n=0;for(const a of t){if(a===s)break;n++}const r=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(r!==n){if(r<n)for(let o=0;o<n-r;o++)this.#o.append(this.#o.firstChild);else if(r>n)for(let o=0;o<r-n;o++)this.#o.firstChild.before(this.#o.lastChild);let a=0;for(const o of t){const c=this.#t[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",bt._l10nResizer[c])}}this.#M(0),this.#m=!0,this.#o.firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#B(e){bt._resizerKeyboardManager.exec(this,e)}#q(e){this.#m&&e.relatedTarget?.parentNode!==this.#o&&this.#j()}#U(e){this.#a=this.#m?e:""}#M(e){if(this.#t)for(const t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#m&&this.#D(this.#a,{deltaX:e,deltaY:t,fromKeyboard:!0})}#j(){this.#m=!1,this.#M(-1),this.#R()}_stopResizingWithKeyboard(){this.#j(),this.div.focus()}select(){if(this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#s?.toggleAltTextBadge(!1)}unselect(){this.#o?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#s?.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(e){this.#p=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){this.#c=!0;const s=e/t,{style:n}=this.div;n.aspectRatio=s,n.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#x||=new Map;const{action:s}=e;let n=this.#x.get(s);n&&clearTimeout(n),n=setTimeout(()=>{this._reportTelemetry(e),this.#x.delete(s),this.#x.size===0&&(this.#x=null)},bt._telemetryTimeout),this.#x.set(s,n);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#n=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#n=!0}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const s=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),s.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}}class sA extends bt{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const _g=3285377520,zn=4294901760,Ii=65535;class _1{constructor(e){this.h1=e?e&4294967295:_g,this.h2=e?e&4294967295:_g}update(e){let t,s;if(typeof e=="string"){t=new Uint8Array(e.length*2),s=0;for(let w=0,A=e.length;w<A;w++){const x=e.charCodeAt(w);x<=255?t[s++]=x:(t[s++]=x>>>8,t[s++]=x&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),s=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const n=s>>2,r=s-n*4,a=new Uint32Array(t.buffer,0,n);let o=0,l=0,c=this.h1,h=this.h2;const d=3432918353,p=461845907,f=d&Ii,v=p&Ii;for(let w=0;w<n;w++)w&1?(o=a[w],o=o*d&zn|o*f&Ii,o=o<<15|o>>>17,o=o*p&zn|o*v&Ii,c^=o,c=c<<13|c>>>19,c=c*5+3864292196):(l=a[w],l=l*d&zn|l*f&Ii,l=l<<15|l>>>17,l=l*p&zn|l*v&Ii,h^=l,h=h<<13|h>>>19,h=h*5+3864292196);switch(o=0,r){case 3:o^=t[n*4+2]<<16;case 2:o^=t[n*4+1]<<8;case 1:o^=t[n*4],o=o*d&zn|o*f&Ii,o=o<<15|o>>>17,o=o*p&zn|o*v&Ii,n&1?c^=o:h^=o}this.h1=c,this.h2=h}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&zn|e*36045&Ii,t=t*4283543511&zn|((t<<16|e>>>16)*2950163797&zn)>>>16,e^=t>>>1,e=e*444984403&zn|e*60499&Ii,t=t*3301882366&zn|((t<<16|e>>>16)*3120437893&zn)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const Bf=Object.freeze({map:null,hash:"",transfer:void 0});class Op{#e=!1;#t=null;#s=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=this.#s.get(e);return s===void 0?t:Object.assign(t,s)}getRawValue(e){return this.#s.get(e)}remove(e){if(this.#s.delete(e),this.#s.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of this.#s.values())if(t instanceof bt)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=this.#s.get(e);let n=!1;if(s!==void 0)for(const[r,a]of Object.entries(t))s[r]!==a&&(n=!0,s[r]=a);else n=!0,this.#s.set(e,t);n&&this.#n(),t instanceof bt&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return this.#s.has(e)}getAll(){return this.#s.size>0?Cp(this.#s):null}setAll(e){for(const[t,s]of Object.entries(e))this.setValue(t,s)}get size(){return this.#s.size}#n(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new A1(this)}get serializable(){if(this.#s.size===0)return Bf;const e=new Map,t=new _1,s=[],n=Object.create(null);let r=!1;for(const[a,o]of this.#s){const l=o instanceof bt?o.serialize(!1,n):o;l&&(e.set(a,l),t.update(`${a}:${JSON.stringify(l)}`),r||=!!l.bitmap)}if(r)for(const a of e.values())a.bitmap&&s.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:Bf}get editorStats(){let e=null;const t=new Map;for(const s of this.#s.values()){if(!(s instanceof bt))continue;const n=s.telemetryFinalData;if(!n)continue;const{type:r}=n;t.has(r)||t.set(r,Object.getPrototypeOf(s).constructor),e||=Object.create(null);const a=e[r]||=new Map;for(const[o,l]of Object.entries(n)){if(o==="type")continue;let c=a.get(o);c||(c=new Map,a.set(o,c));const h=c.get(l)??0;c.set(l,h+1)}}for(const[s,n]of t)e[s]=n.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){this.#t=null}get modifiedIds(){if(this.#t)return this.#t;const e=[];for(const t of this.#s.values())!(t instanceof bt)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}}class A1 extends Op{#e;constructor(e){super();const{map:t,hash:s,transfer:n}=e.serializable,r=structuredClone(t,n?{transfer:n}:null);this.#e={map:r,hash:s,transfer:n}}get print(){Ht("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return xt(this,"modifiedIds",{ids:new Set,hash:""})}}class nA{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||this.#e.has(e.loadedName))){if(_s(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:n,style:r}=e,a=new FontFace(s,n,r);this.addNativeFontFace(a);try{await a.load(),this.#e.add(s),t?.(e)}catch{yt(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}Ht("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const s=e.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(n){throw yt(`Failed to load font '${s.family}': '${n}'.`),e.disableFontFace=!0,n}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const n=this._queueLoadingCallback(s);this._prepareFontLoadEvent(e,n)})}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return xt(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(on||typeof navigator<"u"&&typeof navigator?.userAgent=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),xt(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(_s(!n.done,"completeRequest() cannot be called twice."),n.done=!0;s.length>0&&s[0].done;){const r=s.shift();setTimeout(r.callback,0)}}const{loadingRequests:s}=this,n={done:!1,complete:t,callback:e};return s.push(n),n}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return xt(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function s(M,B){return M.charCodeAt(B)<<24|M.charCodeAt(B+1)<<16|M.charCodeAt(B+2)<<8|M.charCodeAt(B+3)&255}function n(M,B,Q,q){const O=M.substring(0,B),G=M.substring(B+Q);return O+q+G}let r,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let c=0;function h(M,B){if(++c>30){yt("Load test font never loaded."),B();return}if(l.font="30px "+M,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){B();return}setTimeout(h.bind(null,M,B))}const d=`lt${Date.now()}${this.loadTestFontId++}`;let p=this._loadTestFont;p=n(p,976,d.length,d);const v=16,w=1482184792;let A=s(p,v);for(r=0,a=d.length-3;r<a;r+=4)A=A-w+s(d,r)|0;r<d.length&&(A=A-w+s(d+"XXX",r)|0),p=n(p,v,4,U_(A));const x=`url(data:font/opentype;base64,${btoa(p)});`,S=`@font-face {font-family:"${d}";src:${x}}`;this.insertRule(S);const j=this._document.createElement("div");j.style.visibility="hidden",j.style.width=j.style.height="10px",j.style.position="absolute",j.style.top=j.style.left="0px";for(const M of[e.loadedName,d]){const B=this._document.createElement("span");B.textContent="Hi",B.style.fontFamily=M,j.append(B)}this._document.body.append(j),h(d,()=>{j.remove(),t.complete()})}}class iA{constructor(e,{disableFontFace:t=!1,inspectFont:s=null}){this.compiledGlyphs=Object.create(null);for(const n in e)this[n]=e[n];this.disableFontFace=t===!0,this._inspectFont=s}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${X_(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];let s;try{s=e.get(this.loadedName+"_path_"+t)}catch(r){yt(`getPathGenerator - ignoring character: "${r}".`)}if(!Array.isArray(s)||s.length===0)return this.compiledGlyphs[t]=function(r,a){};const n=[];for(let r=0,a=s.length;r<a;)switch(s[r++]){case ir.BEZIER_CURVE_TO:{const[o,l,c,h,d,p]=s.slice(r,r+6);n.push(f=>f.bezierCurveTo(o,l,c,h,d,p)),r+=6}break;case ir.MOVE_TO:{const[o,l]=s.slice(r,r+2);n.push(c=>c.moveTo(o,l)),r+=2}break;case ir.LINE_TO:{const[o,l]=s.slice(r,r+2);n.push(c=>c.lineTo(o,l)),r+=2}break;case ir.QUADRATIC_CURVE_TO:{const[o,l,c,h]=s.slice(r,r+4);n.push(d=>d.quadraticCurveTo(o,l,c,h)),r+=4}break;case ir.RESTORE:n.push(o=>o.restore());break;case ir.SAVE:n.push(o=>o.save());break;case ir.SCALE:_s(n.length===2,"Scale command is only valid at the third position.");break;case ir.TRANSFORM:{const[o,l,c,h,d,p]=s.slice(r,r+6);n.push(f=>f.transform(o,l,c,h,d,p)),r+=6}break;case ir.TRANSLATE:{const[o,l]=s.slice(r,r+2);n.push(c=>c.translate(o,l)),r+=2}break}return n.push(r=>r.closePath()),this.compiledGlyphs[t]=function(a,o){n[0](a),n[1](a),a.scale(o,-o);for(let l=2,c=n.length;l<c;l++)n[l](a)}}}class S1{#e=!1;constructor({enableHWA:e=!1}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Ht("Abstract method `_createCanvas` called.")}}class rA extends S1{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}}class N1{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Ht("Abstract method `_fetch` called.")}}class E1 extends N1{async _fetch(e){const t=await Vu(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Wu(t)}}class k1{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,n,r){return"none"}destroy(e=!1){}}class aA extends k1{#e;#t;#s;#n;#r;#i;#c=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#n=e,this.#r=t}get#o(){return this.#t||=new Map}get#h(){return this.#i||=new Map}get#l(){if(!this.#s){const e=this.#r.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const s=this.#r.createElementNS(or,"svg");s.setAttribute("width",0),s.setAttribute("height",0),this.#s=this.#r.createElementNS(or,"defs"),e.append(s),s.append(this.#s),this.#r.body.append(e)}return this.#s}#u(e){if(e.length===1){const l=e[0],c=new Array(256);for(let d=0;d<256;d++)c[d]=l[d]/255;const h=c.join(",");return[h,h,h]}const[t,s,n]=e,r=new Array(256),a=new Array(256),o=new Array(256);for(let l=0;l<256;l++)r[l]=t[l]/255,a[l]=s[l]/255,o[l]=n[l]/255;return[r.join(","),a.join(","),o.join(",")]}#a(e){if(this.#e===void 0){this.#e="";const t=this.#r.URL;t!==this.#r.baseURI&&(Gu(t)?yt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=t.split("#",1)[0])}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#o.get(e);if(t)return t;const[s,n,r]=this.#u(e),a=e.length===1?s:`${s}${n}${r}`;if(t=this.#o.get(a),t)return this.#o.set(e,t),t;const o=`g_${this.#n}_transfer_map_${this.#c++}`,l=this.#a(o);this.#o.set(e,l),this.#o.set(a,l);const c=this.#p(o);return this.#m(s,n,r,c),l}addHCMFilter(e,t){const s=`${e}-${t}`,n="base";let r=this.#h.get(n);if(r?.key===s||(r?(r.filter?.remove(),r.key=s,r.url="none",r.filter=null):(r={key:s,url:"none",filter:null},this.#h.set(n,r)),!e||!t))return r.url;const a=this.#y(e);e=He.makeHexColor(...a);const o=this.#y(t);if(t=He.makeHexColor(...o),this.#l.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return r.url;const l=new Array(256);for(let f=0;f<=255;f++){const v=f/255;l[f]=v<=.03928?v/12.92:((v+.055)/1.055)**2.4}const c=l.join(","),h=`g_${this.#n}_hcm_filter`,d=r.filter=this.#p(h);this.#m(c,c,c,d),this.#f(d);const p=(f,v)=>{const w=a[f]/255,A=o[f]/255,x=new Array(v+1);for(let S=0;S<=v;S++)x[S]=w+S/v*(A-w);return x.join(",")};return this.#m(p(0,5),p(1,5),p(2,5),d),r.url=this.#a(h),r.url}addAlphaFilter(e){let t=this.#o.get(e);if(t)return t;const[s]=this.#u([e]),n=`alpha_${s}`;if(t=this.#o.get(n),t)return this.#o.set(e,t),t;const r=`g_${this.#n}_alpha_map_${this.#c++}`,a=this.#a(r);this.#o.set(e,a),this.#o.set(n,a);const o=this.#p(r);return this.#b(s,o),a}addLuminosityFilter(e){let t=this.#o.get(e||"luminosity");if(t)return t;let s,n;if(e?([s]=this.#u([e]),n=`luminosity_${s}`):n="luminosity",t=this.#o.get(n),t)return this.#o.set(e,t),t;const r=`g_${this.#n}_luminosity_map_${this.#c++}`,a=this.#a(r);this.#o.set(e,a),this.#o.set(n,a);const o=this.#p(r);return this.#d(o),e&&this.#b(s,o),a}addHighlightHCMFilter(e,t,s,n,r){const a=`${t}-${s}-${n}-${r}`;let o=this.#h.get(e);if(o?.key===a||(o?(o.filter?.remove(),o.key=a,o.url="none",o.filter=null):(o={key:a,url:"none",filter:null},this.#h.set(e,o)),!t||!s))return o.url;const[l,c]=[t,s].map(this.#y.bind(this));let h=Math.round(.2126*l[0]+.7152*l[1]+.0722*l[2]),d=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),[p,f]=[n,r].map(this.#y.bind(this));d<h&&([h,d,p,f]=[d,h,f,p]),this.#l.style.color="";const v=(x,S,j)=>{const M=new Array(256),B=(d-h)/j,Q=x/255,q=(S-x)/(255*j);let O=0;for(let G=0;G<=j;G++){const ie=Math.round(h+G*B),L=Q+G*q;for(let R=O;R<=ie;R++)M[R]=L;O=ie+1}for(let G=O;G<256;G++)M[G]=M[O-1];return M.join(",")},w=`g_${this.#n}_hcm_${e}_filter`,A=o.filter=this.#p(w);return this.#f(A),this.#m(v(p[0],f[0],5),v(p[1],f[1],5),v(p[2],f[2],5),A),o.url=this.#a(w),o.url}destroy(e=!1){e&&this.#i?.size||(this.#s?.parentNode.parentNode.remove(),this.#s=null,this.#t?.clear(),this.#t=null,this.#i?.clear(),this.#i=null,this.#c=0)}#d(e){const t=this.#r.createElementNS(or,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#f(e){const t=this.#r.createElementNS(or,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#p(e){const t=this.#r.createElementNS(or,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#l.append(t),t}#g(e,t,s){const n=this.#r.createElementNS(or,t);n.setAttribute("type","discrete"),n.setAttribute("tableValues",s),e.append(n)}#m(e,t,s,n){const r=this.#r.createElementNS(or,"feComponentTransfer");n.append(r),this.#g(r,"feFuncR",e),this.#g(r,"feFuncG",t),this.#g(r,"feFuncB",s)}#b(e,t){const s=this.#r.createElementNS(or,"feComponentTransfer");t.append(s),this.#g(s,"feFuncA",e)}#y(e){return this.#l.style.color=e,jp(getComputedStyle(this.#l).getPropertyValue("color"))}}class C1{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Ht("Abstract method `_fetch` called.")}}class P1 extends C1{async _fetch(e){const t=await Vu(e,"arraybuffer");return new Uint8Array(t)}}async function L1(i){const t=await process.getBuiltinModule("fs").promises.readFile(i);return new Uint8Array(t)}class oA extends k1{}class lA extends S1{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class cA extends N1{async _fetch(e){return L1(e)}}class hA extends C1{async _fetch(e){return L1(e)}}const Zs={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function $f(i,e){if(!e)return;const t=e[2]-e[0],s=e[3]-e[1],n=new Path2D;n.rect(e[0],e[1],t,s),i.clip(n)}class Mp{getPattern(){Ht("Abstract method `getPattern` called.")}}class uA extends Mp{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)t.addColorStop(s[0],s[1]);return t}getPattern(e,t,s,n){let r;if(n===Zs.STROKE||n===Zs.FILL){const a=t.current.getClippedPathBoundingBox(n,es(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,c=t.cachedCanvases.getCanvas("pattern",o,l),h=c.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-a[0],-a[1]),s=He.transform(s,[1,0,0,1,a[0],a[1]]),h.transform(...t.baseTransform),this.matrix&&h.transform(...this.matrix),$f(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),r=e.createPattern(c.canvas,"no-repeat");const d=new DOMMatrix(s);r.setTransform(d)}else $f(e,this._bbox),r=this._createGradient(e);return r}}function nf(i,e,t,s,n,r,a,o){const l=e.coords,c=e.colors,h=i.data,d=i.width*4;let p;l[t+1]>l[s+1]&&(p=t,t=s,s=p,p=r,r=a,a=p),l[s+1]>l[n+1]&&(p=s,s=n,n=p,p=a,a=o,o=p),l[t+1]>l[s+1]&&(p=t,t=s,s=p,p=r,r=a,a=p);const f=(l[t]+e.offsetX)*e.scaleX,v=(l[t+1]+e.offsetY)*e.scaleY,w=(l[s]+e.offsetX)*e.scaleX,A=(l[s+1]+e.offsetY)*e.scaleY,x=(l[n]+e.offsetX)*e.scaleX,S=(l[n+1]+e.offsetY)*e.scaleY;if(v>=S)return;const j=c[r],M=c[r+1],B=c[r+2],Q=c[a],q=c[a+1],O=c[a+2],G=c[o],ie=c[o+1],L=c[o+2],R=Math.round(v),W=Math.round(S);let U,he,ae,se,Z,fe,me,ke;for(let k=R;k<=W;k++){if(k<A){const re=k<v?0:(v-k)/(v-A);U=f-(f-w)*re,he=j-(j-Q)*re,ae=M-(M-q)*re,se=B-(B-O)*re}else{let re;k>S?re=1:A===S?re=0:re=(A-k)/(A-S),U=w-(w-x)*re,he=Q-(Q-G)*re,ae=q-(q-ie)*re,se=O-(O-L)*re}let D;k<v?D=0:k>S?D=1:D=(v-k)/(v-S),Z=f-(f-x)*D,fe=j-(j-G)*D,me=M-(M-ie)*D,ke=B-(B-L)*D;const z=Math.round(Math.min(U,Z)),X=Math.round(Math.max(U,Z));let ee=d*k+z*4;for(let re=z;re<=X;re++)D=(U-re)/(U-Z),D<0?D=0:D>1&&(D=1),h[ee++]=he-(he-fe)*D|0,h[ee++]=ae-(ae-me)*D|0,h[ee++]=se-(se-ke)*D|0,h[ee++]=255}}function dA(i,e,t){const s=e.coords,n=e.colors;let r,a;switch(e.type){case"lattice":const o=e.verticesPerRow,l=Math.floor(s.length/o)-1,c=o-1;for(r=0;r<l;r++){let h=r*o;for(let d=0;d<c;d++,h++)nf(i,t,s[h],s[h+1],s[h+o],n[h],n[h+1],n[h+o]),nf(i,t,s[h+o+1],s[h+1],s[h+o],n[h+o+1],n[h+1],n[h+o])}break;case"triangles":for(r=0,a=s.length;r<a;r+=3)nf(i,t,s[r],s[r+1],s[r+2],n[r],n[r+1],n[r+2]);break;default:throw new Error("illegal figure")}}class fA extends Mp{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,s){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-o,h=Math.ceil(this._bounds[3])-l,d=Math.min(Math.ceil(Math.abs(c*e[0]*1.1)),3e3),p=Math.min(Math.ceil(Math.abs(h*e[1]*1.1)),3e3),f=c/d,v=h/p,w={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/f,scaleY:1/v},A=d+2*2,x=p+2*2,S=s.getCanvas("mesh",A,x),j=S.context,M=j.createImageData(d,p);if(t){const Q=M.data;for(let q=0,O=Q.length;q<O;q+=4)Q[q]=t[0],Q[q+1]=t[1],Q[q+2]=t[2],Q[q+3]=255}for(const Q of this._figures)dA(M,Q,w);return j.putImageData(M,2,2),{canvas:S.canvas,offsetX:o-2*f,offsetY:l-2*v,scaleX:f,scaleY:v}}getPattern(e,t,s,n){$f(e,this._bbox);let r;if(n===Zs.SHADING)r=He.singularValueDecompose2dScale(es(e));else if(r=He.singularValueDecompose2dScale(t.baseTransform),this.matrix){const o=He.singularValueDecompose2dScale(this.matrix);r=[r[0]*o[0],r[1]*o[1]]}const a=this._createMeshCanvas(r,n===Zs.SHADING?null:this._background,t.cachedCanvases);return n!==Zs.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class pA extends Mp{getPattern(){return"hotpink"}}function mA(i){switch(i[0]){case"RadialAxial":return new uA(i);case"Mesh":return new fA(i);case"Dummy":return new pA}throw new Error(`Unknown IR type: ${i[0]}`)}const Ag={COLORED:1,UNCOLORED:2};class Fp{static MAX_PATTERN_SIZE=3e3;constructor(e,t,s,n,r){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=s,this.canvasGraphicsFactory=n,this.baseTransform=r}createPatternCanvas(e){const{bbox:t,operatorList:s,paintType:n,tilingType:r,color:a,canvasGraphicsFactory:o}=this;let{xstep:l,ystep:c}=this;l=Math.abs(l),c=Math.abs(c),zu("TilingType: "+r);const h=t[0],d=t[1],p=t[2],f=t[3],v=p-h,w=f-d,A=He.singularValueDecompose2dScale(this.matrix),x=He.singularValueDecompose2dScale(this.baseTransform),S=A[0]*x[0],j=A[1]*x[1];let M=v,B=w,Q=!1,q=!1;const O=Math.ceil(l*S),G=Math.ceil(c*j),ie=Math.ceil(v*S),L=Math.ceil(w*j);O>=ie?M=l:Q=!0,G>=L?B=c:q=!0;const R=this.getSizeAndScale(M,this.ctx.canvas.width,S),W=this.getSizeAndScale(B,this.ctx.canvas.height,j),U=e.cachedCanvases.getCanvas("pattern",R.size,W.size),he=U.context,ae=o.createCanvasGraphics(he);if(ae.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(ae,n,a),he.translate(-R.scale*h,-W.scale*d),ae.transform(R.scale,0,0,W.scale,0,0),he.save(),this.clipBbox(ae,h,d,p,f),ae.baseTransform=es(ae.ctx),ae.executeOperatorList(s),ae.endDrawing(),he.restore(),Q||q){const se=U.canvas;Q&&(M=l),q&&(B=c);const Z=this.getSizeAndScale(M,this.ctx.canvas.width,S),fe=this.getSizeAndScale(B,this.ctx.canvas.height,j),me=Z.size,ke=fe.size,k=e.cachedCanvases.getCanvas("pattern-workaround",me,ke),D=k.context,z=Q?Math.floor(v/l):0,X=q?Math.floor(w/c):0;for(let ee=0;ee<=z;ee++)for(let re=0;re<=X;re++)D.drawImage(se,me*ee,ke*re,me,ke,0,0,me,ke);return{canvas:k.canvas,scaleX:Z.scale,scaleY:fe.scale,offsetX:h,offsetY:d}}return{canvas:U.canvas,scaleX:R.scale,scaleY:W.scale,offsetX:h,offsetY:d}}getSizeAndScale(e,t,s){const n=Math.max(Fp.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*s);return r>=n?r=n:s=r/e,{scale:s,size:r}}clipBbox(e,t,s,n,r){const a=n-t,o=r-s;e.ctx.rect(t,s,a,o),e.current.updateRectMinMax(es(e.ctx),[t,s,n,r]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const n=e.ctx,r=e.current;switch(t){case Ag.COLORED:const a=this.ctx;n.fillStyle=a.fillStyle,n.strokeStyle=a.strokeStyle,r.fillColor=a.fillStyle,r.strokeColor=a.strokeStyle;break;case Ag.UNCOLORED:const o=He.makeHexColor(s[0],s[1],s[2]);n.fillStyle=o,n.strokeStyle=o,r.fillColor=o,r.strokeColor=o;break;default:throw new q_(`Unsupported paint type: ${t}`)}}getPattern(e,t,s,n){let r=s;n!==Zs.SHADING&&(r=He.transform(r,t.baseTransform),this.matrix&&(r=He.transform(r,this.matrix)));const a=this.createPatternCanvas(t);let o=new DOMMatrix(r);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const l=e.createPattern(a.canvas,"repeat");return l.setTransform(o),l}}function gA({src:i,srcPos:e=0,dest:t,width:s,height:n,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const o=ln.isLittleEndian?4278190080:255,[l,c]=a?[r,o]:[o,r],h=s>>3,d=s&7,p=i.length;t=new Uint32Array(t.buffer);let f=0;for(let v=0;v<n;v++){for(const A=e+h;e<A;e++){const x=e<p?i[e]:255;t[f++]=x&128?c:l,t[f++]=x&64?c:l,t[f++]=x&32?c:l,t[f++]=x&16?c:l,t[f++]=x&8?c:l,t[f++]=x&4?c:l,t[f++]=x&2?c:l,t[f++]=x&1?c:l}if(d===0)continue;const w=e<p?i[e++]:255;for(let A=0;A<d;A++)t[f++]=w&1<<7-A?c:l}return{srcPos:e,destPos:f}}const Sg=16,Ng=100,bA=15,Eg=10,kg=1e3,vn=16;function yA(i,e){if(i._removeMirroring)throw new Error("Context is already forwarding operations.");i.__originalSave=i.save,i.__originalRestore=i.restore,i.__originalRotate=i.rotate,i.__originalScale=i.scale,i.__originalTranslate=i.translate,i.__originalTransform=i.transform,i.__originalSetTransform=i.setTransform,i.__originalResetTransform=i.resetTransform,i.__originalClip=i.clip,i.__originalMoveTo=i.moveTo,i.__originalLineTo=i.lineTo,i.__originalBezierCurveTo=i.bezierCurveTo,i.__originalRect=i.rect,i.__originalClosePath=i.closePath,i.__originalBeginPath=i.beginPath,i._removeMirroring=()=>{i.save=i.__originalSave,i.restore=i.__originalRestore,i.rotate=i.__originalRotate,i.scale=i.__originalScale,i.translate=i.__originalTranslate,i.transform=i.__originalTransform,i.setTransform=i.__originalSetTransform,i.resetTransform=i.__originalResetTransform,i.clip=i.__originalClip,i.moveTo=i.__originalMoveTo,i.lineTo=i.__originalLineTo,i.bezierCurveTo=i.__originalBezierCurveTo,i.rect=i.__originalRect,i.closePath=i.__originalClosePath,i.beginPath=i.__originalBeginPath,delete i._removeMirroring},i.save=function(){e.save(),this.__originalSave()},i.restore=function(){e.restore(),this.__originalRestore()},i.translate=function(s,n){e.translate(s,n),this.__originalTranslate(s,n)},i.scale=function(s,n){e.scale(s,n),this.__originalScale(s,n)},i.transform=function(s,n,r,a,o,l){e.transform(s,n,r,a,o,l),this.__originalTransform(s,n,r,a,o,l)},i.setTransform=function(s,n,r,a,o,l){e.setTransform(s,n,r,a,o,l),this.__originalSetTransform(s,n,r,a,o,l)},i.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},i.rotate=function(s){e.rotate(s),this.__originalRotate(s)},i.clip=function(s){e.clip(s),this.__originalClip(s)},i.moveTo=function(t,s){e.moveTo(t,s),this.__originalMoveTo(t,s)},i.lineTo=function(t,s){e.lineTo(t,s),this.__originalLineTo(t,s)},i.bezierCurveTo=function(t,s,n,r,a,o){e.bezierCurveTo(t,s,n,r,a,o),this.__originalBezierCurveTo(t,s,n,r,a,o)},i.rect=function(t,s,n,r){e.rect(t,s,n,r),this.__originalRect(t,s,n,r)},i.closePath=function(){e.closePath(),this.__originalClosePath()},i.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class vA{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let n;return this.cache[e]!==void 0?(n=this.cache[e],this.canvasFactory.reset(n,t,s)):(n=this.canvasFactory.create(t,s),this.cache[e]=n),n}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Dh(i,e,t,s,n,r,a,o,l,c){const[h,d,p,f,v,w]=es(i);if(d===0&&p===0){const S=a*h+v,j=Math.round(S),M=o*f+w,B=Math.round(M),Q=(a+l)*h+v,q=Math.abs(Math.round(Q)-j)||1,O=(o+c)*f+w,G=Math.abs(Math.round(O)-B)||1;return i.setTransform(Math.sign(h),0,0,Math.sign(f),j,B),i.drawImage(e,t,s,n,r,0,0,q,G),i.setTransform(h,d,p,f,v,w),[q,G]}if(h===0&&f===0){const S=o*p+v,j=Math.round(S),M=a*d+w,B=Math.round(M),Q=(o+c)*p+v,q=Math.abs(Math.round(Q)-j)||1,O=(a+l)*d+w,G=Math.abs(Math.round(O)-B)||1;return i.setTransform(0,Math.sign(d),Math.sign(p),0,j,B),i.drawImage(e,t,s,n,r,0,0,G,q),i.setTransform(h,d,p,f,v,w),[G,q]}i.drawImage(e,t,s,n,r,a,o,l,c);const A=Math.hypot(h,d),x=Math.hypot(p,f);return[A*l,x*c]}function wA(i){const{width:e,height:t}=i;if(e>kg||t>kg)return null;const s=1e3,n=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),r=e+1;let a=new Uint8Array(r*(t+1)),o,l,c;const h=e+7&-8;let d=new Uint8Array(h*t),p=0;for(const x of i.data){let S=128;for(;S>0;)d[p++]=x&S?0:255,S>>=1}let f=0;for(p=0,d[p]!==0&&(a[0]=1,++f),l=1;l<e;l++)d[p]!==d[p+1]&&(a[l]=d[p]?2:1,++f),p++;for(d[p]!==0&&(a[l]=2,++f),o=1;o<t;o++){p=o*h,c=o*r,d[p-h]!==d[p]&&(a[c]=d[p]?1:8,++f);let x=(d[p]?4:0)+(d[p-h]?8:0);for(l=1;l<e;l++)x=(x>>2)+(d[p+1]?4:0)+(d[p-h+1]?8:0),n[x]&&(a[c+l]=n[x],++f),p++;if(d[p-h]!==d[p]&&(a[c+l]=d[p]?2:4,++f),f>s)return null}for(p=h*(t-1),c=o*r,d[p]!==0&&(a[c]=8,++f),l=1;l<e;l++)d[p]!==d[p+1]&&(a[c+l]=d[p]?4:8,++f),p++;if(d[p]!==0&&(a[c+l]=4,++f),f>s)return null;const v=new Int32Array([0,r,-1,0,-r,0,0,0,1]),w=new Path2D;for(o=0;f&&o<=t;o++){let x=o*r;const S=x+e;for(;x<S&&!a[x];)x++;if(x===S)continue;w.moveTo(x%r,o);const j=x;let M=a[x];do{const B=v[M];do x+=B;while(!a[x]);const Q=a[x];Q!==5&&Q!==10?(M=Q,a[x]=0):(M=Q&51*M>>4,a[x]&=M>>2|M<<2),w.lineTo(x%r,x/r|0),a[x]||--f}while(j!==x);--o}return d=null,a=null,function(x){x.save(),x.scale(1/e,-1/t),x.translate(0,-t),x.fill(w),x.beginPath(),x.restore()}}class Cg{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=y1,this.textMatrixScale=1,this.fontMatrix=Of,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=Ks.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,s){[t,s]=He.applyTransform([t,s],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,s),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,s)}updateRectMinMax(e,t){const s=He.applyTransform(t,e),n=He.applyTransform(t.slice(2),e),r=He.applyTransform([t[0],t[3]],e),a=He.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,s[0],n[0],r[0],a[0]),this.minY=Math.min(this.minY,s[1],n[1],r[1],a[1]),this.maxX=Math.max(this.maxX,s[0],n[0],r[0],a[0]),this.maxY=Math.max(this.maxY,s[1],n[1],r[1],a[1])}updateScalingPathMinMax(e,t){He.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,s,n,r,a,o,l,c,h){const d=He.bezierBoundingBox(t,s,n,r,a,o,l,c,h);h||this.updateRectMinMax(e,d)}getPathBoundingBox(e=Zs.FILL,t=null){const s=[this.minX,this.minY,this.maxX,this.maxY];if(e===Zs.STROKE){t||Ht("Stroke bounding box must include transform.");const n=He.singularValueDecompose2dScale(t),r=n[0]*this.lineWidth/2,a=n[1]*this.lineWidth/2;s[0]-=r,s[1]-=a,s[2]+=r,s[3]+=a}return s}updateClipFromPath(){const e=He.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=Zs.FILL,t=null){return He.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function Pg(i,e){if(e instanceof ImageData){i.putImageData(e,0,0);return}const t=e.height,s=e.width,n=t%vn,r=(t-n)/vn,a=n===0?r:r+1,o=i.createImageData(s,vn);let l=0,c;const h=e.data,d=o.data;let p,f,v,w;if(e.kind===tu.GRAYSCALE_1BPP){const A=h.byteLength,x=new Uint32Array(d.buffer,0,d.byteLength>>2),S=x.length,j=s+7>>3,M=4294967295,B=ln.isLittleEndian?4278190080:255;for(p=0;p<a;p++){for(v=p<r?vn:n,c=0,f=0;f<v;f++){const Q=A-l;let q=0;const O=Q>j?s:Q*8-7,G=O&-8;let ie=0,L=0;for(;q<G;q+=8)L=h[l++],x[c++]=L&128?M:B,x[c++]=L&64?M:B,x[c++]=L&32?M:B,x[c++]=L&16?M:B,x[c++]=L&8?M:B,x[c++]=L&4?M:B,x[c++]=L&2?M:B,x[c++]=L&1?M:B;for(;q<O;q++)ie===0&&(L=h[l++],ie=128),x[c++]=L&ie?M:B,ie>>=1}for(;c<S;)x[c++]=0;i.putImageData(o,0,p*vn)}}else if(e.kind===tu.RGBA_32BPP){for(f=0,w=s*vn*4,p=0;p<r;p++)d.set(h.subarray(l,l+w)),l+=w,i.putImageData(o,0,f),f+=vn;p<a&&(w=s*n*4,d.set(h.subarray(l,l+w)),i.putImageData(o,0,f))}else if(e.kind===tu.RGB_24BPP)for(v=vn,w=s*v,p=0;p<a;p++){for(p>=r&&(v=n,w=s*v),c=0,f=w;f--;)d[c++]=h[l++],d[c++]=h[l++],d[c++]=h[l++],d[c++]=255;i.putImageData(o,0,p*vn)}else throw new Error(`bad image kind: ${e.kind}`)}function Lg(i,e){if(e.bitmap){i.drawImage(e.bitmap,0,0);return}const t=e.height,s=e.width,n=t%vn,r=(t-n)/vn,a=n===0?r:r+1,o=i.createImageData(s,vn);let l=0;const c=e.data,h=o.data;for(let d=0;d<a;d++){const p=d<r?vn:n;({srcPos:l}=gA({src:c,srcPos:l,dest:h,width:s,height:p,nonBlackColor:0})),i.putImageData(o,0,d*vn)}}function Rl(i,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of t)i[s]!==void 0&&(e[s]=i[s]);i.setLineDash!==void 0&&(e.setLineDash(i.getLineDash()),e.lineDashOffset=i.lineDashOffset)}function Bh(i){if(i.strokeStyle=i.fillStyle="#000000",i.fillRule="nonzero",i.globalAlpha=1,i.lineWidth=1,i.lineCap="butt",i.lineJoin="miter",i.miterLimit=10,i.globalCompositeOperation="source-over",i.font="10px sans-serif",i.setLineDash!==void 0&&(i.setLineDash([]),i.lineDashOffset=0),!on){const{filter:e}=i;e!=="none"&&e!==""&&(i.filter="none")}}function Tg(i,e){if(e)return!0;const t=He.singularValueDecompose2dScale(i);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const s=Math.fround((globalThis.devicePixelRatio||1)*qo.PDF_TO_CSS_UNITS);return t[0]<=s&&t[1]<=s}const xA=["butt","round","square"],_A=["miter","round","bevel"],AA={},jg={};class To{constructor(e,t,s,n,r,{optionalContentConfig:a,markedContentStack:o=null},l,c){this.ctx=e,this.current=new Cg(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=n,this.filterFactory=r,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new vA(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:s=!1,background:n=null}){const r=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=n||"#ffffff",this.ctx.fillRect(0,0,r,a),this.ctx.fillStyle=o,s){const l=this.cachedCanvases.getCanvas("transparent",r,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...es(this.compositeCtx))}this.ctx.save(),Bh(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=es(this.ctx)}executeOperatorList(e,t,s,n){const r=e.argsArray,a=e.fnArray;let o=t||0;const l=r.length;if(l===o)return o;const c=l-o>Eg&&typeof s=="function",h=c?Date.now()+bA:0;let d=0;const p=this.commonObjs,f=this.objs;let v;for(;;){if(n!==void 0&&o===n.nextBreakPoint)return n.breakIt(o,s),o;if(v=a[o],v!==li.dependency)this[v].apply(this,r[o]);else for(const w of r[o]){const A=w.startsWith("g_")?p:f;if(!A.has(w))return A.get(w,s),o}if(o++,o===l)return o;if(c&&++d>Eg){if(Date.now()>h)return s(),o;d=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const s=e.width??e.displayWidth,n=e.height??e.displayHeight;let r=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=s,l=n,c="prescale1",h,d;for(;r>2&&o>1||a>2&&l>1;){let p=o,f=l;r>2&&o>1&&(p=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),r/=o/p),a>2&&l>1&&(f=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/f),h=this.cachedCanvases.getCanvas(c,p,f),d=h.context,d.clearRect(0,0,p,f),d.drawImage(e,0,0,o,l,0,0,p,f),e=h.canvas,o=p,l=f,c=c==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:l}}_createMaskCanvas(e){const t=this.ctx,{width:s,height:n}=e,r=this.current.fillColor,a=this.current.patternFill,o=es(t);let l,c,h,d;if((e.bitmap||e.data)&&e.count>1){const O=e.bitmap||e.data.buffer;c=JSON.stringify(a?o:[o.slice(0,4),r]),l=this._cachedBitmapsMap.get(O),l||(l=new Map,this._cachedBitmapsMap.set(O,l));const G=l.get(c);if(G&&!a){const ie=Math.round(Math.min(o[0],o[2])+o[4]),L=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:G,offsetX:ie,offsetY:L}}h=G}h||(d=this.cachedCanvases.getCanvas("maskCanvas",s,n),Lg(d.context,e));let p=He.transform(o,[1/s,0,0,-1/n,0,0]);p=He.transform(p,[1,0,0,1,0,-n]);const[f,v,w,A]=He.getAxialAlignedBoundingBox([0,0,s,n],p),x=Math.round(w-f)||1,S=Math.round(A-v)||1,j=this.cachedCanvases.getCanvas("fillCanvas",x,S),M=j.context,B=f,Q=v;M.translate(-B,-Q),M.transform(...p),h||(h=this._scaleImage(d.canvas,ji(M)),h=h.img,l&&a&&l.set(c,h)),M.imageSmoothingEnabled=Tg(es(M),e.interpolate),Dh(M,h,0,0,h.width,h.height,0,0,s,n),M.globalCompositeOperation="source-in";const q=He.transform(ji(M),[1,0,0,1,-B,-Q]);return M.fillStyle=a?r.getPattern(t,this,q,Zs.FILL):r,M.fillRect(0,0,s,n),l&&!a&&(this.cachedCanvases.delete("fillCanvas"),l.set(c,j.canvas)),{canvas:j.canvas,offsetX:Math.round(B),offsetY:Math.round(Q)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=xA[e]}setLineJoin(e){this.ctx.lineJoin=_A[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(e),s.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,s]of e)switch(t){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.current.fillAlpha=s,this.ctx.globalAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,n=this.cachedCanvases.getCanvas(s,e,t);this.suspendedCtx=this.ctx,this.ctx=n.context;const r=this.ctx;r.setTransform(...es(this.suspendedCtx)),Rl(this.suspendedCtx,r),yA(r,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Rl(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,n){const r=n[0],a=n[1],o=n[2]-r,l=n[3]-a;o===0||l===0||(this.genericComposeSMask(t.context,s,o,l,t.subtype,t.backdrop,t.transferMap,r,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,n,r,a,o,l,c,h,d){let p=e.canvas,f=l-h,v=c-d;if(a){const A=He.makeHexColor(...a);if(f<0||v<0||f+s>p.width||v+n>p.height){const x=this.cachedCanvases.getCanvas("maskExtension",s,n),S=x.context;S.drawImage(p,-f,-v),S.globalCompositeOperation="destination-atop",S.fillStyle=A,S.fillRect(0,0,s,n),S.globalCompositeOperation="source-over",p=x.canvas,f=v=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const x=new Path2D;x.rect(f,v,s,n),e.clip(x),e.globalCompositeOperation="destination-atop",e.fillStyle=A,e.fillRect(f,v,s,n),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):r==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const w=new Path2D;w.rect(l,c,s,n),t.clip(w),t.globalCompositeOperation="destination-in",t.drawImage(p,f,v,s,n,l,c,s,n),t.restore()}save(){this.inSMaskMode?(Rl(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Rl(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,s,n,r,a){this.ctx.transform(e,t,s,n,r,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s){const n=this.ctx,r=this.current;let a=r.x,o=r.y,l,c;const h=es(n),d=h[0]===0&&h[3]===0||h[1]===0&&h[2]===0,p=d?s.slice(0):null;for(let f=0,v=0,w=e.length;f<w;f++)switch(e[f]|0){case li.rectangle:a=t[v++],o=t[v++];const A=t[v++],x=t[v++],S=a+A,j=o+x;n.moveTo(a,o),A===0||x===0?n.lineTo(S,j):(n.lineTo(S,o),n.lineTo(S,j),n.lineTo(a,j)),d||r.updateRectMinMax(h,[a,o,S,j]),n.closePath();break;case li.moveTo:a=t[v++],o=t[v++],n.moveTo(a,o),d||r.updatePathMinMax(h,a,o);break;case li.lineTo:a=t[v++],o=t[v++],n.lineTo(a,o),d||r.updatePathMinMax(h,a,o);break;case li.curveTo:l=a,c=o,a=t[v+4],o=t[v+5],n.bezierCurveTo(t[v],t[v+1],t[v+2],t[v+3],a,o),r.updateCurvePathMinMax(h,l,c,t[v],t[v+1],t[v+2],t[v+3],a,o,p),v+=6;break;case li.curveTo2:l=a,c=o,n.bezierCurveTo(a,o,t[v],t[v+1],t[v+2],t[v+3]),r.updateCurvePathMinMax(h,l,c,a,o,t[v],t[v+1],t[v+2],t[v+3],p),a=t[v+2],o=t[v+3],v+=4;break;case li.curveTo3:l=a,c=o,a=t[v+2],o=t[v+3],n.bezierCurveTo(t[v],t[v+1],a,o,a,o),r.updateCurvePathMinMax(h,l,c,t[v],t[v+1],a,o,a,o,p),v+=4;break;case li.closePath:n.closePath();break}d&&r.updateScalingPathMinMax(h,p),r.setCurrentPoint(a,o)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,s=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof s=="object"&&s?.getPattern?(t.save(),t.strokeStyle=s.getPattern(t,this,ji(t),Zs.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,s=this.current.fillColor,n=this.current.patternFill;let r=!1;n&&(t.save(),t.fillStyle=s.getPattern(t,this,ji(t),Zs.FILL),r=!0);const a=this.current.getClippedPathBoundingBox();this.contentVisible&&a!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),r&&t.restore(),e&&this.consumePath(a)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=AA}eoClip(){this.pendingClip=jg}beginText(){this.current.textMatrix=y1,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}t.save(),t.beginPath();for(const s of e)t.setTransform(...s.transform),t.translate(s.x,s.y),s.addToPath(t,s.fontSize);t.restore(),t.clip(),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){const s=this.commonObjs.get(e),n=this.current;if(!s)throw new Error(`Can't find font for ${e}`);if(n.fontMatrix=s.fontMatrix||Of,(n.fontMatrix[0]===0||n.fontMatrix[3]===0)&&yt("Invalid font matrix for font "+e),t<0?(t=-t,n.fontDirection=-1):n.fontDirection=1,this.current.font=s,this.current.fontSize=t,s.isType3Font)return;const r=s.loadedName||"sans-serif",a=s.systemFontInfo?.css||`"${r}", ${s.fallbackName}`;let o="normal";s.black?o="900":s.bold&&(o="bold");const l=s.italic?"italic":"normal";let c=t;t<Sg?c=Sg:t>Ng&&(c=Ng),this.current.fontSizeScale=t/c,this.ctx.font=`${l} ${o} ${c}px ${a}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,s,n,r,a){this.current.textMatrix=[e,t,s,n,r,a],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,s,n,r){const a=this.ctx,o=this.current,l=o.font,c=o.textRenderingMode,h=o.fontSize/o.fontSizeScale,d=c&Ks.FILL_STROKE_MASK,p=!!(c&Ks.ADD_TO_PATH_FLAG),f=o.patternFill&&!l.missingFile,v=o.patternStroke&&!l.missingFile;let w;(l.disableFontFace||p||f||v)&&(w=l.getPathGenerator(this.commonObjs,e)),l.disableFontFace||f||v?(a.save(),a.translate(t,s),a.beginPath(),w(a,h),(d===Ks.FILL||d===Ks.FILL_STROKE)&&(n&&a.setTransform(...n),a.fill()),(d===Ks.STROKE||d===Ks.FILL_STROKE)&&(r&&a.setTransform(...r),a.stroke()),a.restore()):((d===Ks.FILL||d===Ks.FILL_STROKE)&&a.fillText(e,t,s),(d===Ks.STROKE||d===Ks.FILL_STROKE)&&a.strokeText(e,t,s)),p&&(this.pendingTextPaths||=[]).push({transform:es(a),x:t,y:s,fontSize:h,addToPath:w})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let n=3;n<t.length;n+=4)if(t[n]>0&&t[n]<255){s=!0;break}return xt(this,"isFontSubpixelAAEnabled",s)}showText(e){const t=this.current,s=t.font;if(s.isType3Font)return this.showType3Text(e);const n=t.fontSize;if(n===0)return;const r=this.ctx,a=t.fontSizeScale,o=t.charSpacing,l=t.wordSpacing,c=t.fontDirection,h=t.textHScale*c,d=e.length,p=s.vertical,f=p?1:-1,v=s.defaultVMetrics,w=n*t.fontMatrix[0],A=t.textRenderingMode===Ks.FILL&&!s.disableFontFace&&!t.patternFill;r.save(),r.transform(...t.textMatrix),r.translate(t.x,t.y+t.textRise),c>0?r.scale(h,-1):r.scale(h,1);let x,S;if(t.patternFill){r.save();const q=t.fillColor.getPattern(r,this,ji(r),Zs.FILL);x=es(r),r.restore(),r.fillStyle=q}if(t.patternStroke){r.save();const q=t.strokeColor.getPattern(r,this,ji(r),Zs.STROKE);S=es(r),r.restore(),r.strokeStyle=q}let j=t.lineWidth;const M=t.textMatrixScale;if(M===0||j===0){const q=t.textRenderingMode&Ks.FILL_STROKE_MASK;(q===Ks.STROKE||q===Ks.FILL_STROKE)&&(j=this.getSinglePixelWidth())}else j/=M;if(a!==1&&(r.scale(a,a),j/=a),r.lineWidth=j,s.isInvalidPDFjsFont){const q=[];let O=0;for(const G of e)q.push(G.unicode),O+=G.width;r.fillText(q.join(""),0,0),t.x+=O*w*h,r.restore(),this.compose();return}let B=0,Q;for(Q=0;Q<d;++Q){const q=e[Q];if(typeof q=="number"){B+=f*q*n/1e3;continue}let O=!1;const G=(q.isSpace?l:0)+o,ie=q.fontChar,L=q.accent;let R,W,U=q.width;if(p){const ae=q.vmetric||v,se=-(q.vmetric?ae[1]:U*.5)*w,Z=ae[2]*w;U=ae?-ae[0]:U,R=se/a,W=(B+Z)/a}else R=B/a,W=0;if(s.remeasure&&U>0){const ae=r.measureText(ie).width*1e3/n*a;if(U<ae&&this.isFontSubpixelAAEnabled){const se=U/ae;O=!0,r.save(),r.scale(se,1),R/=se}else U!==ae&&(R+=(U-ae)/2e3*n/a)}if(this.contentVisible&&(q.isInFont||s.missingFile)){if(A&&!L)r.fillText(ie,R,W);else if(this.paintChar(ie,R,W,x,S),L){const ae=R+n*L.offset.x/a,se=W-n*L.offset.y/a;this.paintChar(L.fontChar,ae,se,x,S)}}const he=p?U*w-G*c:U*w+G*c;B+=he,O&&r.restore()}p?t.y-=B:t.x+=B*h,r.restore(),this.compose()}showType3Text(e){const t=this.ctx,s=this.current,n=s.font,r=s.fontSize,a=s.fontDirection,o=n.vertical?1:-1,l=s.charSpacing,c=s.wordSpacing,h=s.textHScale*a,d=s.fontMatrix||Of,p=e.length,f=s.textRenderingMode===Ks.INVISIBLE;let v,w,A,x;if(!(f||r===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...s.textMatrix),t.translate(s.x,s.y),t.scale(h,a),v=0;v<p;++v){if(w=e[v],typeof w=="number"){x=o*w*r/1e3,this.ctx.translate(x,0),s.x+=x*h;continue}const S=(w.isSpace?c:0)+l,j=n.charProcOperatorList[w.operatorListId];if(!j){yt(`Type3 character "${w.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=w,this.save(),t.scale(r,r),t.transform(...d),this.executeOperatorList(j),this.restore()),A=He.applyTransform([w.width,0],d)[0]*r+S,t.translate(A,0),s.x+=A*h}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,s,n,r,a){this.ctx.rect(s,n,r-s,a-n),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const s=e[1],n=this.baseTransform||es(this.ctx),r={createCanvasGraphics:a=>new To(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new Fp(e,s,this.ctx,r,n)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,s){this.ctx.strokeStyle=this.current.strokeColor=He.makeHexColor(e,t,s),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,s){this.ctx.fillStyle=this.current.fillColor=He.makeHexColor(e,t,s),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let s;return this.cachedPatterns.has(e)?s=this.cachedPatterns.get(e):(s=mA(this.getObject(e)),this.cachedPatterns.set(e,s)),t&&(s.matrix=t),s}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const s=this._getPattern(e);t.fillStyle=s.getPattern(t,this,ji(t),Zs.SHADING);const n=ji(t);if(n){const{width:r,height:a}=t.canvas,[o,l,c,h]=He.getAxialAlignedBoundingBox([0,0,r,a],n);this.ctx.fillRect(o,l,c-o,h-l)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Ht("Should not call beginInlineImage")}beginImageData(){Ht("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=es(this.ctx),t)){const s=t[2]-t[0],n=t[3]-t[1];this.ctx.rect(t[0],t[1],s,n),this.current.updateRectMinMax(es(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||zu("TODO: Support non-isolated groups."),e.knockout&&yt("Knockout groups not supported.");const s=es(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let n=He.getAxialAlignedBoundingBox(e.bbox,es(t));const r=[0,0,t.canvas.width,t.canvas.height];n=He.intersect(n,r)||[0,0,0,0];const a=Math.floor(n[0]),o=Math.floor(n[1]),l=Math.max(Math.ceil(n[2])-a,1),c=Math.max(Math.ceil(n[3])-o,1);this.current.startNewPathAndClipBox([0,0,l,c]);let h="groupAt"+this.groupLevel;e.smask&&(h+="_smask_"+this.smaskCounter++%2);const d=this.cachedCanvases.getCanvas(h,l,c),p=d.context;p.translate(-a,-o),p.transform(...s),e.smask?this.smaskStack.push({canvas:d.canvas,context:p,offsetX:a,offsetY:o,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,o),t.save()),Rl(t,p),this.ctx=p,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const n=es(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...n);const r=He.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],n);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(e,t,s,n,r){if(this.#e(),Bh(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const a=t[2]-t[0],o=t[3]-t[1];if(r&&this.annotationCanvasMap){s=s.slice(),s[4]-=t[0],s[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=a,t[3]=o;const[l,c]=He.singularValueDecompose2dScale(es(this.ctx)),{viewportScale:h}=this,d=Math.ceil(a*this.outputScaleX*h),p=Math.ceil(o*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(d,p);const{canvas:f,context:v}=this.annotationCanvas;this.annotationCanvasMap.set(e,f),this.annotationCanvas.savedCtx=this.ctx,this.ctx=v,this.ctx.save(),this.ctx.setTransform(l,0,0,-c,0,o*c),Bh(this.ctx)}else Bh(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],a,o),this.ctx.clip(),this.ctx.beginPath()}this.current=new Cg(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...n)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const s=this.ctx,n=this.processingType3;if(n&&(n.compiled===void 0&&(n.compiled=wA(e)),n.compiled)){n.compiled(s);return}const r=this._createMaskCanvas(e),a=r.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(a,r.offsetX,r.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,s=0,n=0,r,a){if(!this.contentVisible)return;e=this.getObject(e.data,e);const o=this.ctx;o.save();const l=es(o);o.transform(t,s,n,r,0,0);const c=this._createMaskCanvas(e);o.setTransform(1,0,0,1,c.offsetX-l[4],c.offsetY-l[5]);for(let h=0,d=a.length;h<d;h+=2){const p=He.transform(l,[t,s,n,r,a[h],a[h+1]]),[f,v]=He.applyTransform([0,0],p);o.drawImage(c.canvas,f,v)}o.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,s=this.current.fillColor,n=this.current.patternFill;for(const r of e){const{data:a,width:o,height:l,transform:c}=r,h=this.cachedCanvases.getCanvas("maskCanvas",o,l),d=h.context;d.save();const p=this.getObject(a,r);Lg(d,p),d.globalCompositeOperation="source-in",d.fillStyle=n?s.getPattern(d,this,ji(t),Zs.FILL):s,d.fillRect(0,0,o,l),d.restore(),t.save(),t.transform(...c),t.scale(1,-1),Dh(t,h.canvas,0,0,o,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){yt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,s,n){if(!this.contentVisible)return;const r=this.getObject(e);if(!r){yt("Dependent image isn't ready yet");return}const a=r.width,o=r.height,l=[];for(let c=0,h=n.length;c<h;c+=2)l.push({transform:[t,0,0,s,n[c],n[c+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(r,l)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:s,height:n}=e,r=this.cachedCanvases.getCanvas("inlineImage",s,n),a=r.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",r.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,s=e.height,n=this.ctx;if(this.save(),!on){const{filter:o}=n;o!=="none"&&o!==""&&(n.filter="none")}n.scale(1/t,-1/s);let r;if(e.bitmap)r=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)r=e;else{const l=this.cachedCanvases.getCanvas("inlineImage",t,s).context;Pg(l,e),r=this.applyTransferMapsToCanvas(l)}const a=this._scaleImage(r,ji(n));n.imageSmoothingEnabled=Tg(es(n),e.interpolate),Dh(n,a.img,0,0,a.paintWidth,a.paintHeight,0,-s,t,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const s=this.ctx;let n;if(e.bitmap)n=e.bitmap;else{const r=e.width,a=e.height,l=this.cachedCanvases.getCanvas("inlineImage",r,a).context;Pg(l,e),n=this.applyTransferMapsToCanvas(l)}for(const r of t)s.save(),s.transform(...r.transform),s.scale(1,-1),Dh(s,n,r.x,r.y,r.w,r.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const s=this.ctx;this.pendingClip&&(t||(this.pendingClip===jg?s.clip("evenodd"):s.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),s.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=es(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),n=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,n)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:s,c:n,d:r}=this.ctx.getTransform();let a,o;if(s===0&&n===0){const l=Math.abs(t),c=Math.abs(r);if(l===c)if(e===0)a=o=1/l;else{const h=l*e;a=o=h<1?1/h:1}else if(e===0)a=1/l,o=1/c;else{const h=l*e,d=c*e;a=h<1?1/h:1,o=d<1?1/d:1}}else{const l=Math.abs(t*r-s*n),c=Math.hypot(t,s),h=Math.hypot(n,r);if(e===0)a=h/l,o=c/l;else{const d=e*l;a=h>d?h/d:1,o=c>d?c/d:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:s}=this.current,[n,r]=this.getScaleForStroking();if(t.lineWidth=s||1,n===1&&r===1){t.stroke();return}const a=t.getLineDash();if(e&&t.save(),t.scale(n,r),a.length>0){const o=Math.max(n,r);t.setLineDash(a.map(l=>l/o)),t.lineDashOffset/=o}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}for(const i in li)To.prototype[i]!==void 0&&(To.prototype[li[i]]=To.prototype[i]);class sc{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}}const $h={UNKNOWN:0,DATA:1,ERROR:2},xs={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Ig(){}function Hn(i){switch(i instanceof Error||typeof i=="object"&&i!==null||Ht('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),i.name){case"AbortException":return new Ta(i.message);case"MissingPDFException":return new Ic(i.message);case"PasswordException":return new Mf(i.message,i.code);case"UnexpectedResponseException":return new Hu(i.message,i.status);case"UnknownErrorException":return new Ff(i.message,i.details);default:return new Ff(i.message,i.toString())}}class zl{#e=new AbortController;constructor(e,t,s){this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",this.#t.bind(this),{signal:this.#e.signal})}#t({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#n(e);return}if(e.callback){const s=e.callbackId,n=this.callbackCapabilities[s];if(!n)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],e.callback===$h.DATA)n.resolve(e.data);else if(e.callback===$h.ERROR)n.reject(Hn(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const s=this.sourceName,n=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(a){r.postMessage({sourceName:s,targetName:n,callback:$h.DATA,callbackId:e.callbackId,data:a})},function(a){r.postMessage({sourceName:s,targetName:n,callback:$h.ERROR,callbackId:e.callbackId,reason:Hn(a)})});return}if(e.streamId){this.#s(e);return}t(e.data)}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const n=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[n]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:n,data:t},s)}catch(a){r.reject(a)}return r.promise}sendWithStream(e,t,s,n){const r=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{const h=Promise.withResolvers();return this.streamControllers[r]={controller:c,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:e,streamId:r,data:t,desiredSize:c.desiredSize},n),h.promise},pull:c=>{const h=Promise.withResolvers();return this.streamControllers[r].pullCall=h,l.postMessage({sourceName:a,targetName:o,stream:xs.PULL,streamId:r,desiredSize:c.desiredSize}),h.promise},cancel:c=>{_s(c instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[r].cancelCall=h,this.streamControllers[r].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:xs.CANCEL,streamId:r,reason:Hn(c)}),h.promise}},s)}#s(e){const t=e.streamId,s=this.sourceName,n=e.sourceName,r=this.comObj,a=this,o=this.actionHandler[e.action],l={enqueue(c,h=1,d){if(this.isCancelled)return;const p=this.desiredSize;this.desiredSize-=h,p>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:s,targetName:n,stream:xs.ENQUEUE,streamId:t,chunk:c},d)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:n,stream:xs.CLOSE,streamId:t}),delete a.streamSinks[t])},error(c){_s(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:n,stream:xs.ERROR,streamId:t,reason:Hn(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(o,e.data,l).then(function(){r.postMessage({sourceName:s,targetName:n,stream:xs.START_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:s,targetName:n,stream:xs.START_COMPLETE,streamId:t,reason:Hn(c)})})}#n(e){const t=e.streamId,s=this.sourceName,n=e.sourceName,r=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case xs.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(Hn(e.reason));break;case xs.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(Hn(e.reason));break;case xs.PULL:if(!o){r.postMessage({sourceName:s,targetName:n,stream:xs.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||Ig).then(function(){r.postMessage({sourceName:s,targetName:n,stream:xs.PULL_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:s,targetName:n,stream:xs.PULL_COMPLETE,streamId:t,reason:Hn(c)})});break;case xs.ENQUEUE:if(_s(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case xs.CLOSE:if(_s(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),this.#r(a,t);break;case xs.ERROR:_s(a,"error should have stream controller"),a.controller.error(Hn(e.reason)),this.#r(a,t);break;case xs.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(Hn(e.reason)),this.#r(a,t);break;case xs.CANCEL:if(!o)break;const l=Hn(e.reason);Promise.try(o.onCancel||Ig,l).then(function(){r.postMessage({sourceName:s,targetName:n,stream:xs.CANCEL_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:s,targetName:n,stream:xs.CANCEL_COMPLETE,streamId:t,reason:Hn(c)})}),o.sinkCapability.reject(l),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#r(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.#e?.abort(),this.#e=null}}class SA{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}getAll(){return Cp(this.#e)}has(e){return this.#e.has(e)}}const vo=Symbol("INTERNAL");class NA{#e=!1;#t=!1;#s=!1;#n=!0;constructor(e,{name:t,intent:s,usage:n,rbGroups:r}){this.#e=!!(e&Tn.DISPLAY),this.#t=!!(e&Tn.PRINT),this.name=t,this.intent=s,this.usage=n,this.rbGroups=r}get visible(){if(this.#s)return this.#n;if(!this.#n)return!1;const{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,s=!1){e!==vo&&Ht("Internal method `_setVisible` called."),this.#s=s,this.#n=t}}class EA{#e=null;#t=new Map;#s=null;#n=null;constructor(e,t=Tn.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#n=e.order;for(const s of e.groups)this.#t.set(s.id,new NA(t,s));if(e.baseState==="OFF")for(const s of this.#t.values())s._setVisible(vo,!1);for(const s of e.on)this.#t.get(s)._setVisible(vo,!0);for(const s of e.off)this.#t.get(s)._setVisible(vo,!1);this.#s=this.getHash()}}#r(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let n=1;n<t;n++){const r=e[n];let a;if(Array.isArray(r))a=this.#r(r);else if(this.#t.has(r))a=this.#t.get(r).visible;else return yt(`Optional content group not found: ${r}`),!0;switch(s){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return s==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return zu("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(yt(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#r(e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!this.#t.has(t))return yt(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!this.#t.has(t))return yt(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!this.#t.has(t))return yt(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!this.#t.has(t))return yt(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return yt(`Unknown optional content policy ${e.policy}.`),!0}return yt(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,s=!0){const n=this.#t.get(e);if(!n){yt(`Optional content group not found: ${e}`);return}if(s&&t&&n.rbGroups.length)for(const r of n.rbGroups)for(const a of r)a!==e&&this.#t.get(a)?._setVisible(vo,!1,!0);n._setVisible(vo,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let s;for(const n of e){switch(n){case"ON":case"OFF":case"Toggle":s=n;continue}const r=this.#t.get(n);if(r)switch(s){case"ON":this.setVisibility(n,!0,t);break;case"OFF":this.setVisibility(n,!1,t);break;case"Toggle":this.setVisibility(n,!r.visible,t);break}}this.#e=null}get hasInitialVisibility(){return this.#s===null||this.getHash()===this.#s}getOrder(){return this.#t.size?this.#n?this.#n.slice():[...this.#t.keys()]:null}getGroups(){return this.#t.size>0?Cp(this.#t):null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;const e=new _1;for(const[t,s]of this.#t)e.update(`${t}:${s.visible}`);return this.#e=e.hexdigest()}}class kA{constructor(e,{disableRange:t=!1,disableStream:s=!1}){_s(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:n,initialData:r,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,r?.length>0){const l=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!s,this._isRangeSupported=!t,this._contentLength=n,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,c)=>{this._onReceiveData({begin:l,chunk:c})}),e.addProgressListener((l,c)=>{this._onProgress({loaded:l,total:c})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const s=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const n=this._rangeReaders.some(function(r){return r._begin!==e?!1:(r._enqueue(s),!0)});_s(n,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){_s(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new CA(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new PA(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}}class CA{constructor(e,t,s=!1,n=null){this._stream=e,this._done=s||!1,this._filename=Tp(n)?n:null,this._queuedChunks=t||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class PA{constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function LA(i){let e=!0,t=s("filename\\*","i").exec(i);if(t){t=t[1];let h=o(t);return h=unescape(h),h=l(h),h=c(h),r(h)}if(t=a(i),t){const h=c(t);return r(h)}if(t=s("filename","i").exec(i),t){t=t[1];let h=o(t);return h=c(h),r(h)}function s(h,d){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',d)}function n(h,d){if(h){if(!/^[\x00-\xFF]+$/.test(d))return d;try{const p=new TextDecoder(h,{fatal:!0}),f=Wu(d);d=p.decode(f),e=!1}catch{}}return d}function r(h){return e&&/[\x80-\xff]/.test(h)&&(h=n("utf-8",h),e&&(h=n("iso-8859-1",h))),h}function a(h){const d=[];let p;const f=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(p=f.exec(h))!==null;){let[,w,A,x]=p;if(w=parseInt(w,10),w in d){if(w===0)break;continue}d[w]=[A,x]}const v=[];for(let w=0;w<d.length&&w in d;++w){let[A,x]=d[w];x=o(x),A&&(x=unescape(x),w===0&&(x=l(x))),v.push(x)}return v.join("")}function o(h){if(h.startsWith('"')){const d=h.slice(1).split('\\"');for(let p=0;p<d.length;++p){const f=d[p].indexOf('"');f!==-1&&(d[p]=d[p].slice(0,f),d.length=p+1),d[p]=d[p].replaceAll(/\\(.)/g,"$1")}h=d.join('"')}return h}function l(h){const d=h.indexOf("'");if(d===-1)return h;const p=h.slice(0,d),v=h.slice(d+1).replace(/^[^']*'/,"");return n(p,v)}function c(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(d,p,f,v){if(f==="q"||f==="Q")return v=v.replaceAll("_"," "),v=v.replaceAll(/=([0-9a-fA-F]{2})/g,function(w,A){return String.fromCharCode(parseInt(A,16))}),n(p,v);try{v=atob(v)}catch{}return n(p,v)})}return""}function T1(i,e){const t=new Headers;if(!i||!e||typeof e!="object")return t;for(const s in e){const n=e[s];n!==void 0&&t.append(s,n)}return t}function Xu(i){try{return new URL(i).origin}catch{}return null}function j1({responseHeaders:i,isHttp:e,rangeChunkSize:t,disableRange:s}){const n={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(i.get("Content-Length"),10);return!Number.isInteger(r)||(n.suggestedLength=r,r<=2*t)||s||!e||i.get("Accept-Ranges")!=="bytes"||(i.get("Content-Encoding")||"identity")!=="identity"||(n.allowRangeRequests=!0),n}function I1(i){const e=i.get("Content-Disposition");if(e){let t=LA(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(Tp(t))return t}return null}function Yu(i,e){return i===404||i===0&&e.startsWith("file:")?new Ic('Missing PDF "'+e+'".'):new Hu(`Unexpected server response (${i}) while retrieving PDF "${e}".`,i)}function R1(i){return i===200||i===206}function O1(i,e,t){return{method:"GET",headers:i,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function M1(i){return i instanceof Uint8Array?i.buffer:i instanceof ArrayBuffer?i:(yt(`getArrayBuffer - unexpected data format: ${i}`),new Uint8Array(i).buffer)}class Rg{_responseOrigin=null;constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=T1(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return _s(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new TA(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new jA(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class TA{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const s=new Headers(e.headers),n=t.url;fetch(n,O1(s,this._withCredentials,this._abortController)).then(r=>{if(e._responseOrigin=Xu(r.url),!R1(r.status))throw Yu(r.status,n);this._reader=r.body.getReader(),this._headersCapability.resolve();const a=r.headers,{allowRangeRequests:o,suggestedLength:l}=j1({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=I1(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Ta("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:M1(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class jA{constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const n=e.source;this._withCredentials=n.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!n.disableStream,this._abortController=new AbortController;const r=new Headers(e.headers);r.append("Range",`bytes=${t}-${s-1}`);const a=n.url;fetch(a,O1(r,this._withCredentials,this._abortController)).then(o=>{const l=Xu(o.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!R1(o.status))throw Yu(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:M1(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}const rf=200,af=206;function IA(i){const e=i.response;return typeof e!="string"?e:Wu(e).buffer}class RA{_responseOrigin=null;constructor({url:e,httpHeaders:t,withCredentials:s}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=T1(this.isHttp,t),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(e,t,s){const n={begin:e,end:t};for(const r in s)n[r]=s[r];return this.request(n)}requestFull(e){return this.request(e)}request(e){const t=new XMLHttpRequest,s=this.currXhrId++,n=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[r,a]of this.headers)t.setRequestHeader(r,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),n.expectedStatus=af):n.expectedStatus=rf,t.responseType="arraybuffer",e.onError&&(t.onerror=function(r){e.onError(t.status)}),t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),n.onHeadersReceived=e.onHeadersReceived,n.onDone=e.onDone,n.onError=e.onError,n.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){const s=this.pendingRequests[e];s&&s.onProgress?.(t)}onStateChange(e,t){const s=this.pendingRequests[e];if(!s)return;const n=s.xhr;if(n.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),n.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],n.status===0&&this.isHttp){s.onError?.(n.status);return}const r=n.status||rf;if(!(r===rf&&s.expectedStatus===af)&&r!==s.expectedStatus){s.onError?.(n.status);return}const o=IA(n);if(r===af){const l=n.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);s.onDone({begin:parseInt(c[1],10),chunk:o})}else o?s.onDone({begin:0,chunk:o}):s.onError?.(n.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class OA{constructor(e){this._source=e,this._manager=new RA(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return _s(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new MA(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new FA(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class MA{constructor(e,t){this._manager=e;const s={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._fullRequestId=e.requestFull(s),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Xu(t.responseURL);const s=t.getAllResponseHeaders(),n=new Headers(s?s.trim().split(/[\r\n]+/).map(o=>{const[l,...c]=o.split(": ");return[l,c.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:a}=j1({responseHeaders:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=I1(n),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Yu(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class FA{constructor(e,t,s){this._manager=e;const n={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._requestId=e.requestRange(t,s,n),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const e=Xu(this._manager.getRequestXhr(this._requestId)?.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??=Yu(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const DA=/^[a-z][a-z0-9\-+.]+:/i;function BA(i){if(DA.test(i))return new URL(i);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(i))}class $A{constructor(e){this.source=e,this.url=BA(e.url),_s(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return _s(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new qA(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new UA(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class qA{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(n=>{this._contentLength=n.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},n=>{n.code==="ENOENT"&&(n=new Ic(`Missing PDF "${this._url}".`)),this._storedError=n,this._headersCapability.reject(n)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Ta("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class UA{constructor(e,t,s){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const n=e.source;this._isStreamingSupported=!n.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:t,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const zA=1e5,bn=30,HA=.8;class an{#e=Promise.withResolvers();#t=null;#s=!1;#n=!!globalThis.FontInspector?.enabled;#r=null;#i=null;#c=0;#o=0;#h=null;#l=null;#u=0;#a=0;#d=Object.create(null);#f=[];#p=null;#g=[];#m=new WeakMap;#b=null;static#y=new Map;static#w=new Map;static#x=new WeakMap;static#S=null;static#N=new Set;constructor({textContentSource:e,container:t,viewport:s}){if(e instanceof ReadableStream)this.#p=e;else if(typeof e=="object")this.#p=new ReadableStream({start(l){l.enqueue(e),l.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#l=t,this.#a=s.scale*(globalThis.devicePixelRatio||1),this.#u=s.rotation,this.#i={div:null,properties:null,ctx:null};const{pageWidth:n,pageHeight:r,pageX:a,pageY:o}=s.rawDims;this.#b=[1,0,0,-1,-a,o+r],this.#o=n,this.#c=r,an.#L(),Aa(t,s),this.#e.promise.finally(()=>{an.#N.delete(this),this.#i=null,this.#d=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=ln.platform;return xt(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{this.#h.read().then(({value:t,done:s})=>{if(s){this.#e.resolve();return}this.#r??=t.lang,Object.assign(this.#d,t.styles),this.#E(t.items),e()},this.#e.reject)};return this.#h=this.#p.getReader(),an.#N.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){const s=e.scale*(globalThis.devicePixelRatio||1),n=e.rotation;if(n!==this.#u&&(t?.(),this.#u=n,Aa(this.#l,{rotation:n})),s!==this.#a){t?.(),this.#a=s;const r={div:null,properties:null,ctx:an.#P(this.#r)};for(const a of this.#g)r.properties=this.#m.get(a),r.div=a,this.#_(r)}}cancel(){const e=new Ta("TextLayer task cancelled.");this.#h?.cancel(e).catch(()=>{}),this.#h=null,this.#e.reject(e)}get textDivs(){return this.#g}get textContentItemsStr(){return this.#f}#E(e){if(this.#s)return;this.#i.ctx??=an.#P(this.#r);const t=this.#g,s=this.#f;for(const n of e){if(t.length>zA){yt("Ignoring additional textDivs for performance reasons."),this.#s=!0;return}if(n.str===void 0){if(n.type==="beginMarkedContentProps"||n.type==="beginMarkedContent"){const r=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),n.id!==null&&this.#t.setAttribute("id",`${n.id}`),r.append(this.#t)}else n.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}s.push(n.str),this.#C(n)}}#C(e){const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#g.push(t);const n=He.transform(this.#b,e.transform);let r=Math.atan2(n[1],n[0]);const a=this.#d[e.fontName];a.vertical&&(r+=Math.PI/2);let o=this.#n&&a.fontSubstitution||a.fontFamily;o=an.fontFamilyMap.get(o)||o;const l=Math.hypot(n[2],n[3]),c=l*an.#R(o,this.#r);let h,d;r===0?(h=n[4],d=n[5]-c):(h=n[4]+c*Math.sin(r),d=n[5]-c*Math.cos(r));const p="calc(var(--scale-factor)*",f=t.style;this.#t===this.#l?(f.left=`${(100*h/this.#o).toFixed(2)}%`,f.top=`${(100*d/this.#c).toFixed(2)}%`):(f.left=`${p}${h.toFixed(2)}px)`,f.top=`${p}${d.toFixed(2)}px)`),f.fontSize=`${p}${(an.#S*l).toFixed(2)}px)`,f.fontFamily=o,s.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#n&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),r!==0&&(s.angle=r*(180/Math.PI));let v=!1;if(e.str.length>1)v=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const w=Math.abs(e.transform[0]),A=Math.abs(e.transform[3]);w!==A&&Math.max(w,A)/Math.min(w,A)>1.5&&(v=!0)}if(v&&(s.canvasWidth=a.vertical?e.height:e.width),this.#m.set(t,s),this.#i.div=t,this.#i.properties=s,this.#_(this.#i),s.hasText&&this.#t.append(t),s.hasEOL){const w=document.createElement("br");w.setAttribute("role","presentation"),this.#t.append(w)}}#_(e){const{div:t,properties:s,ctx:n}=e,{style:r}=t;let a="";if(an.#S>1&&(a=`scale(${1/an.#S})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:o}=r,{canvasWidth:l,fontSize:c}=s;an.#k(n,c*this.#a,o);const{width:h}=n.measureText(t.textContent);h>0&&(a=`scaleX(${l*this.#a/h}) ${a}`)}s.angle!==0&&(a=`rotate(${s.angle}deg) ${a}`),a.length>0&&(r.transform=a)}static cleanup(){if(!(this.#N.size>0)){this.#y.clear();for(const{canvas:e}of this.#w.values())e.remove();this.#w.clear()}}static#P(e=null){let t=this.#w.get(e||="");if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#w.set(e,t),this.#x.set(t,{size:0,family:""})}return t}static#k(e,t,s){const n=this.#x.get(e);t===n.size&&s===n.family||(e.font=`${t}px ${s}`,n.size=t,n.family=s)}static#L(){if(this.#S!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#S=e.getBoundingClientRect().height,e.remove()}static#R(e,t){const s=this.#y.get(e);if(s)return s;const n=this.#P(t);n.canvas.width=n.canvas.height=bn,this.#k(n,bn,e);const r=n.measureText("");let a=r.fontBoundingBoxAscent,o=Math.abs(r.fontBoundingBoxDescent);if(a){const h=a/(a+o);return this.#y.set(e,h),n.canvas.width=n.canvas.height=0,h}n.strokeStyle="red",n.clearRect(0,0,bn,bn),n.strokeText("g",0,0);let l=n.getImageData(0,0,bn,bn).data;o=0;for(let h=l.length-1-3;h>=0;h-=4)if(l[h]>0){o=Math.ceil(h/4/bn);break}n.clearRect(0,0,bn,bn),n.strokeText("A",0,bn),l=n.getImageData(0,0,bn,bn).data,a=0;for(let h=0,d=l.length;h<d;h+=4)if(l[h]>0){a=bn-Math.floor(h/4/bn);break}n.canvas.width=n.canvas.height=0;const c=a?a/(a+o):HA;return this.#y.set(e,c),c}}class dc{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};function n(r){if(!r)return;let a=null;const o=r.name;if(o==="#text")a=r.value;else if(dc.shouldBuildText(o))r?.attributes?.textContent?a=r.attributes.textContent:r.value&&(a=r.value);else return;if(a!==null&&t.push({str:a}),!!r.children)for(const l of r.children)n(l)}return n(e),s}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const WA=65536,VA=100,GA=5e3,XA=on?lA:rA,YA=on?cA:E1,KA=on?oA:aA,JA=on?hA:P1;function ZA(i={}){typeof i=="string"||i instanceof URL?i={url:i}:(i instanceof ArrayBuffer||ArrayBuffer.isView(i))&&(i={data:i});const e=new Dp,{docId:t}=e,s=i.url?QA(i.url):null,n=i.data?eS(i.data):null,r=i.httpHeaders||null,a=i.withCredentials===!0,o=i.password??null,l=i.range instanceof F1?i.range:null,c=Number.isInteger(i.rangeChunkSize)&&i.rangeChunkSize>0?i.rangeChunkSize:WA;let h=i.worker instanceof Os?i.worker:null;const d=i.verbosity,p=typeof i.docBaseUrl=="string"&&!Gu(i.docBaseUrl)?i.docBaseUrl:null,f=typeof i.cMapUrl=="string"?i.cMapUrl:null,v=i.cMapPacked!==!1,w=i.CMapReaderFactory||YA,A=typeof i.standardFontDataUrl=="string"?i.standardFontDataUrl:null,x=i.StandardFontDataFactory||JA,S=i.stopAtErrors!==!0,j=Number.isInteger(i.maxImageSize)&&i.maxImageSize>-1?i.maxImageSize:-1,M=i.isEvalSupported!==!1,B=typeof i.isOffscreenCanvasSupported=="boolean"?i.isOffscreenCanvasSupported:!on,Q=typeof i.isImageDecoderSupported=="boolean"?i.isImageDecoderSupported:!on&&(ln.platform.isFirefox||!globalThis.chrome),q=Number.isInteger(i.canvasMaxAreaInBytes)?i.canvasMaxAreaInBytes:-1,O=typeof i.disableFontFace=="boolean"?i.disableFontFace:on,G=i.fontExtraProperties===!0,ie=i.enableXfa===!0,L=i.ownerDocument||globalThis.document,R=i.disableRange===!0,W=i.disableStream===!0,U=i.disableAutoFetch===!0,he=i.pdfBug===!0,ae=i.CanvasFactory||XA,se=i.FilterFactory||KA,Z=i.enableHWA===!0,fe=l?l.length:i.length??NaN,me=typeof i.useSystemFonts=="boolean"?i.useSystemFonts:!on&&!O,ke=typeof i.useWorkerFetch=="boolean"?i.useWorkerFetch:w===E1&&x===P1&&f&&A&&Ul(f,document.baseURI)&&Ul(A,document.baseURI);i.canvasFactory&&xg("`canvasFactory`-instance option, please use `CanvasFactory` instead."),i.filterFactory&&xg("`filterFactory`-instance option, please use `FilterFactory` instead.");const k=null;F_(d);const D={canvasFactory:new ae({ownerDocument:L,enableHWA:Z}),filterFactory:new se({docId:t,ownerDocument:L}),cMapReaderFactory:ke?null:new w({baseUrl:f,isCompressed:v}),standardFontDataFactory:ke?null:new x({baseUrl:A})};if(!h){const ee={verbosity:d,port:sc.workerPort};h=ee.port?Os.fromPort(ee):new Os(ee),e._worker=h}const z={docId:t,apiVersion:"4.9.155",data:n,password:o,disableAutoFetch:U,rangeChunkSize:c,length:fe,docBaseUrl:p,enableXfa:ie,evaluatorOptions:{maxImageSize:j,disableFontFace:O,ignoreErrors:S,isEvalSupported:M,isOffscreenCanvasSupported:B,isImageDecoderSupported:Q,canvasMaxAreaInBytes:q,fontExtraProperties:G,useSystemFonts:me,cMapUrl:ke?f:null,standardFontDataUrl:ke?A:null}},X={disableFontFace:O,fontExtraProperties:G,ownerDocument:L,pdfBug:he,styleElement:k,loadingParams:{disableAutoFetch:U,enableXfa:ie}};return h.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const ee=h.messageHandler.sendWithPromise("GetDocRequest",z,n?[n.buffer]:null);let re;if(l)re=new kA(l,{disableRange:R,disableStream:W});else if(!n){if(!s)throw new Error("getDocument - no `url` parameter provided.");let ue;if(on)if(Ul(s)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");ue=Rg}else ue=$A;else ue=Ul(s)?Rg:OA;re=new ue({url:s,length:fe,httpHeaders:r,withCredentials:a,rangeChunkSize:c,disableRange:R,disableStream:W})}return ee.then(ue=>{if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const de=new zl(t,ue,h.port),Ee=new iS(de,e,re,X,D);e._transport=Ee,de.send("Ready",null)})}).catch(e._capability.reject),e}function QA(i){if(i instanceof URL)return i.href;try{return new URL(i,window.location).href}catch{if(on&&typeof i=="string")return i}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function eS(i){if(on&&typeof Buffer<"u"&&i instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength)return i;if(typeof i=="string")return Wu(i);if(i instanceof ArrayBuffer||ArrayBuffer.isView(i)||typeof i=="object"&&!isNaN(i?.length))return new Uint8Array(i);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Og(i){return typeof i=="object"&&Number.isInteger(i?.num)&&i.num>=0&&Number.isInteger(i?.gen)&&i.gen>=0}class Dp{static#e=0;constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${Dp.#e++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null}}class F1{constructor(e,t,s=!1,n=null){this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=n,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const s of this._rangeListeners)s(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const s of this._progressListeners)s(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){Ht("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class tS{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return xt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class sS{#e=null;#t=!1;constructor(e,t,s,n=!1){this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=n?new wg:null,this._pdfBug=n,this.commonObjs=s.commonObjs,this.objs=new D1,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:n=0,dontFlip:r=!1}={}){return new Rc({viewBox:this.view,scale:e,rotation:t,offsetX:s,offsetY:n,dontFlip:r})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return xt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,viewport:t,intent:s="display",annotationMode:n=Dr.ENABLE,transform:r=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:l=null,pageColors:c=null,printAnnotationStorage:h=null,isEditing:d=!1}){this._stats?.time("Overall");const p=this._transport.getRenderingIntent(s,n,h,d),{renderingIntent:f,cacheKey:v}=p;this.#t=!1,this.#n(),o||=this._transport.getOptionalContentConfig(f);let w=this._intentStates.get(v);w||(w=Object.create(null),this._intentStates.set(v,w)),w.streamReaderCancelTimeout&&(clearTimeout(w.streamReaderCancelTimeout),w.streamReaderCancelTimeout=null);const A=!!(f&Tn.PRINT);w.displayReadyCapability||(w.displayReadyCapability=Promise.withResolvers(),w.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(p));const x=M=>{w.renderTasks.delete(S),(this._maybeCleanupAfterRender||A)&&(this.#t=!0),this.#s(!A),M?(S.capability.reject(M),this._abortOperatorList({intentState:w,reason:M instanceof Error?M:new Error(M)})):S.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},S=new No({callback:x,params:{canvasContext:e,viewport:t,transform:r,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:w.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!A,pdfBug:this._pdfBug,pageColors:c});(w.renderTasks||=new Set).add(S);const j=S.task;return Promise.all([w.displayReadyCapability.promise,o]).then(([M,B])=>{if(this.destroyed){x();return}if(this._stats?.time("Rendering"),!(B.renderingIntent&f))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");S.initializeGraphics({transparency:M,optionalContentConfig:B}),S.operatorListChanged()}).catch(x),j}getOperatorList({intent:e="display",annotationMode:t=Dr.ENABLE,printAnnotationStorage:s=null,isEditing:n=!1}={}){function r(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}const a=this._transport.getRenderingIntent(e,t,s,n,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=r,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||=new Set).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(n){return n.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>dc.textContent(s));const t=this.streamTextContent(e);return new Promise(function(s,n){function r(){a.read().then(function({value:l,done:c}){if(c){s(o);return}o.lang??=l.lang,Object.assign(o.styles,l.styles),o.items.push(...l.items),r()},n)}const a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),this.#t=!1,this.#n(),Promise.all(e)}cleanup(e=!1){this.#t=!0;const t=this.#s(!1);return e&&t&&(this._stats&&=new wg),t}#s(e=!1){if(this.#n(),!this.#t||this.destroyed)return!1;if(e)return this.#e=setTimeout(()=>{this.#e=null,this.#s(!1)},GA),!1;for(const{renderTasks:t,operatorList:s}of this._intentStates.values())if(t.size>0||!s.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}#n(){this.#e&&(clearTimeout(this.#e),this.#e=null)}_startRenderPage(e,t){const s=this._intentStates.get(t);s&&(this._stats?.timeEnd("Page Request"),s.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let s=0,n=e.length;s<n;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&this.#s(!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:s,modifiedIds:n}){const{map:r,transfer:a}=s,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r,modifiedIds:n},a).getReader(),c=this._intentStates.get(t);c.streamReader=l;const h=()=>{l.read().then(({value:d,done:p})=>{if(p){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(d,c),h())},d=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const p of c.renderTasks)p.operatorListChanged();this.#s(!0)}if(c.displayReadyCapability)c.displayReadyCapability.reject(d);else if(c.opListReadCapability)c.opListReadCapability.reject(d);else throw d}})};h()}_abortOperatorList({intentState:e,reason:t,force:s=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!s){if(e.renderTasks.size>0)return;if(t instanceof Lp){let n=VA;t.extraDelay>0&&t.extraDelay<1e3&&(n+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},n);return}}if(e.streamReader.cancel(new Ta(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[n,r]of this._intentStates)if(r===e){this._intentStates.delete(n);break}this.cleanup()}}}get stats(){return this._stats}}class nS{#e=new Map;#t=Promise.resolve();postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(const[n]of this.#e)n.call(this,s)})}addEventListener(e,t,s=null){let n=null;if(s?.signal instanceof AbortSignal){const{signal:r}=s;if(r.aborted){yt("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);n=()=>r.removeEventListener("abort",a),r.addEventListener("abort",a)}this.#e.set(t,n)}removeEventListener(e,t){this.#e.get(t)?.(),this.#e.delete(t)}terminate(){for(const[,e]of this.#e)e?.();this.#e.clear()}}class Os{static#e=0;static#t=!1;static#s;static{on&&(this.#t=!0,sc.workerSrc||="./pdf.worker.mjs"),this._isSameOrigin=(e,t)=>{let s;try{if(s=new URL(e),!s.origin||s.origin==="null")return!1}catch{return!1}const n=new URL(t,s);return s.origin===n.origin},this._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))}}constructor({name:e=null,port:t=null,verbosity:s=D_()}={}){if(this.name=e,this.destroyed=!1,this.verbosity=s,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if(Os.#s?.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(Os.#s||=new WeakMap).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}#n(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new zl("main","worker",e),this._messageHandler.on("ready",function(){}),this.#n()}_initialize(){if(Os.#t||Os.#r){this._setupFakeWorker();return}let{workerSrc:e}=Os;try{Os._isSameOrigin(window.location.href,e)||(e=Os._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new zl("main","worker",t),n=()=>{r.abort(),s.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},r=new AbortController;t.addEventListener("error",()=>{this._webWorker||n()},{signal:r.signal}),s.on("test",o=>{if(r.abort(),this.destroyed||!o){n();return}this._messageHandler=s,this._port=t,this._webWorker=t,this.#n()}),s.on("ready",o=>{if(r.abort(),this.destroyed){n();return}try{a()}catch{this._setupFakeWorker()}});const a=()=>{const o=new Uint8Array;s.send("test",o,[o.buffer])};a();return}catch{zu("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){Os.#t||(yt("Setting up fake worker."),Os.#t=!0),Os._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new nS;this._port=t;const s=`fake${Os.#e++}`,n=new zl(s+"_worker",s,t);e.setup(n,t),this._messageHandler=new zl(s,s+"_worker",t),this.#n()}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){this.destroyed=!0,this._webWorker?.terminate(),this._webWorker=null,Os.#s?.delete(this._port),this._port=null,this._messageHandler?.destroy(),this._messageHandler=null}static fromPort(e){if(!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const t=this.#s?.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Os(e)}static get workerSrc(){if(sc.workerSrc)return sc.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get#r(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){return xt(this,"_setupFakeWorkerGlobal",(async()=>this.#r?this.#r:(await import(this.workerSrc)).WorkerMessageHandler)())}}class iS{#e=new Map;#t=new Map;#s=new Map;#n=new Map;#r=null;constructor(e,t,s,n,r){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new D1,this.fontLoader=new nA({ownerDocument:n.ownerDocument,styleElement:n.styleElement}),this.loadingParams=n.loadingParams,this._params=n,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#i(e,t=null){const s=this.#e.get(e);if(s)return s;const n=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,n),n}get annotationStorage(){return xt(this,"annotationStorage",new Op)}getRenderingIntent(e,t=Dr.ENABLE,s=null,n=!1,r=!1){let a=Tn.DISPLAY,o=Bf;switch(e){case"any":a=Tn.ANY;break;case"display":break;case"print":a=Tn.PRINT;break;default:yt(`getRenderingIntent - invalid intent: ${e}`)}const l=a&Tn.PRINT&&s instanceof A1?s:this.annotationStorage;switch(t){case Dr.DISABLE:a+=Tn.ANNOTATIONS_DISABLE;break;case Dr.ENABLE:break;case Dr.ENABLE_FORMS:a+=Tn.ANNOTATIONS_FORMS;break;case Dr.ENABLE_STORAGE:a+=Tn.ANNOTATIONS_STORAGE,o=l.serializable;break;default:yt(`getRenderingIntent - invalid annotationMode: ${t}`)}n&&(a+=Tn.IS_EDITING),r&&(a+=Tn.OPLIST);const{ids:c,hash:h}=l.modifiedIds,d=[a,o.hash,h];return{renderingIntent:a,cacheKey:d.join("_"),annotationStorageSerializable:o,modifiedIds:c}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#r?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const s of this.#t.values())e.push(s._destroy());this.#t.clear(),this.#s.clear(),this.#n.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),an.cleanup(),this._networkStream?.cancelAllRequests(new Ta("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(s,n)=>{_s(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},n.onPull=()=>{this._fullReader.read().then(function({value:r,done:a}){if(a){n.close();return}_s(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{n.error(r)})},n.onCancel=r=>{this._fullReader.cancel(r),n.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async s=>{await this._fullReader.headersReady;const{isStreamingSupported:n,isRangeSupported:r,contentLength:a}=this._fullReader;return(!n||!r)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=o=>{t.onProgress?.({loaded:o.loaded,total:o.total})}),{isStreamingSupported:n,isRangeSupported:r,contentLength:a}}),e.on("GetRangeReader",(s,n)=>{_s(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(s.begin,s.end);if(!r){n.close();return}n.onPull=()=>{r.read().then(function({value:a,done:o}){if(o){n.close();return}_s(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{n.error(a)})},n.onCancel=a=>{r.cancel(a),n.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new tS(s,this))}),e.on("DocException",function(s){let n;switch(s.name){case"PasswordException":n=new Mf(s.message,s.code);break;case"InvalidPDFException":n=new v1(s.message);break;case"MissingPDFException":n=new Ic(s.message);break;case"UnexpectedResponseException":n=new Hu(s.message,s.status);break;case"UnknownErrorException":n=new Ff(s.message,s.details);break;default:Ht("DocException - expected a valid Error.")}t._capability.reject(n)}),e.on("PasswordRequest",s=>{if(this.#r=Promise.withResolvers(),t.onPassword){const n=r=>{r instanceof Error?this.#r.reject(r):this.#r.resolve({password:r})};try{t.onPassword(n,s.code)}catch(r){this.#r.reject(r)}}else this.#r.reject(new Mf(s.message,s.code));return this.#r.promise}),e.on("DataLoaded",s=>{t.onProgress?.({loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),e.on("StartRenderPage",s=>{if(this.destroyed)return;this.#t.get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),e.on("commonobj",([s,n,r])=>{if(this.destroyed||this.commonObjs.has(s))return null;switch(n){case"Font":const{disableFontFace:a,fontExtraProperties:o,pdfBug:l}=this._params;if("error"in r){const p=r.error;yt(`Error during font loading: ${p}`),this.commonObjs.resolve(s,p);break}const c=l&&globalThis.FontInspector?.enabled?(p,f)=>globalThis.FontInspector.fontAdded(p,f):null,h=new iA(r,{disableFontFace:a,inspectFont:c});this.fontLoader.bind(h).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!o&&h.data&&(h.data=null),this.commonObjs.resolve(s,h)});break;case"CopyLocalImage":const{imageRef:d}=r;_s(d,"The imageRef must be defined.");for(const p of this.#t.values())for(const[,f]of p.objs)if(f?.ref===d)return f.dataLen?(this.commonObjs.resolve(s,structuredClone(f)),f.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,r);break;default:throw new Error(`Got unknown common object type ${n}`)}return null}),e.on("obj",([s,n,r,a])=>{if(this.destroyed)return;const o=this.#t.get(n);if(!o.objs.has(s)){if(o._intentStates.size===0){a?.bitmap?.close();return}switch(r){case"Image":o.objs.resolve(s,a),a?.dataLen>I_&&(o._maybeCleanupAfterRender=!0);break;case"Pattern":o.objs.resolve(s,a);break;default:throw new Error(`Got unknown object type ${r}`)}}}),e.on("DocProgress",s=>{this.destroyed||t.onProgress?.({loaded:s.loaded,total:s.total})}),e.on("FetchBuiltInCMap",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(s)}),e.on("FetchStandardFontData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&yt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=this.#s.get(t);if(s)return s;const n=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&this.#n.set(r.refStr,e);const a=new sS(t,r,this,this._params.pdfBug);return this.#t.set(t,a),a});return this.#s.set(t,n),n}getPageIndex(e){return Og(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#i("GetFieldObjects")}hasJSActions(){return this.#i("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#i("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#i("GetOptionalContentConfig").then(t=>new EA(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#e.get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then(n=>({info:n[0],metadata:n[1]?new SA(n[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),an.cleanup()}}cachedPageNumber(e){if(!Og(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#n.get(t)??null}}const qh=Symbol("INITIAL_DATA");class D1{#e=Object.create(null);#t(e){return this.#e[e]||={...Promise.withResolvers(),data:qh}}get(e,t=null){if(t){const n=this.#t(e);return n.promise.then(()=>t(n.data)),null}const s=this.#e[e];if(!s||s.data===qh)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=this.#e[e];return!!t&&t.data!==qh}resolve(e,t=null){const s=this.#t(e);s.data=t,s.resolve()}clear(){for(const e in this.#e){const{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(const e in this.#e){const{data:t}=this.#e[e];t!==qh&&(yield[e,t])}}}class rS{#e=null;constructor(e){this.#e=e,this.onContinue=null}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}}class No{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:s,commonObjs:n,annotationCanvasMap:r,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:h=!1,pdfBug:d=!1,pageColors:p=null}){this.callback=e,this.params=t,this.objs=s,this.commonObjs=n,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=d,this.pageColors=p,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new rS(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(No.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");No.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:s,viewport:n,transform:r,background:a}=this.params;this.gfx=new To(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:n,transparency:e,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),No.#t.delete(this._canvas),this.callback(e||new Lp(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),No.#t.delete(this._canvas),this.callback())))}}const aS="4.9.155",oS="a4eb8407c";function Mg(i){return Math.floor(Math.max(0,Math.min(1,i))*255).toString(16).padStart(2,"0")}function Ol(i){return Math.max(0,Math.min(255,255*i))}class Fg{static CMYK_G([e,t,s,n]){return["G",1-Math.min(1,.3*e+.59*s+.11*t+n)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Ol(e),[e,e,e]}static G_HTML([e]){const t=Mg(e);return`#${t}${t}${t}`}static RGB_G([e,t,s]){return["G",.3*e+.59*t+.11*s]}static RGB_rgb(e){return e.map(Ol)}static RGB_HTML(e){return`#${e.map(Mg).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,s,n]){return["RGB",1-Math.min(1,e+n),1-Math.min(1,s+n),1-Math.min(1,t+n)]}static CMYK_rgb([e,t,s,n]){return[Ol(1-Math.min(1,e+n)),Ol(1-Math.min(1,s+n)),Ol(1-Math.min(1,t+n))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,s]){const n=1-e,r=1-t,a=1-s,o=Math.min(n,r,a);return["CMYK",n,r,a,o]}}class lS{create(e,t,s=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const n=this._createSVG("svg:svg");return n.setAttribute("version","1.1"),s||(n.setAttribute("width",`${e}px`),n.setAttribute("height",`${t}px`)),n.setAttribute("preserveAspectRatio","none"),n.setAttribute("viewBox",`0 0 ${e} ${t}`),n}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Ht("Abstract method `_createSVG` called.")}}class Bp extends lS{_createSVG(e){return document.createElementNS(or,e)}}class B1{static setupStorage(e,t,s,n,r){const a=n.getValue(t,{value:null});switch(s.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),r==="print")break;e.addEventListener("input",o=>{n.setValue(t,{value:o.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(a.value===s.attributes.xfaOn?e.setAttribute("checked",!0):a.value===s.attributes.xfaOff&&e.removeAttribute("checked"),r==="print")break;e.addEventListener("change",o=>{n.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),r==="print")break;e.addEventListener("input",o=>{n.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const o of s.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const l=o.target.options,c=l.selectedIndex===-1?"":l[l.selectedIndex].value;n.setValue(t,{value:c})});break}}static setAttributes({html:e,element:t,storage:s=null,intent:n,linkService:r}){const{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${n}`);for(const[l,c]of Object.entries(a))if(c!=null)switch(l){case"class":c.length&&e.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",c);break;case"style":Object.assign(e.style,c);break;case"textContent":e.textContent=c;break;default:(!o||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,c)}o&&r.addLinkAttributes(e,a.href,a.newWindow),s&&a.dataId&&this.setupStorage(e,a.dataId,t,s)}static render(e){const t=e.annotationStorage,s=e.linkService,n=e.xfaHtml,r=e.intent||"display",a=document.createElement(n.name);n.attributes&&this.setAttributes({html:a,element:n,intent:r,linkService:s});const o=r!=="richText",l=e.div;if(l.append(a),e.viewport){const d=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=d}o&&l.setAttribute("class","xfaLayer xfaFont");const c=[];if(n.children.length===0){if(n.value){const d=document.createTextNode(n.value);a.append(d),o&&dc.shouldBuildText(n.name)&&c.push(d)}return{textDivs:c}}const h=[[n,-1,a]];for(;h.length>0;){const[d,p,f]=h.at(-1);if(p+1===d.children.length){h.pop();continue}const v=d.children[++h.at(-1)[1]];if(v===null)continue;const{name:w}=v;if(w==="#text"){const x=document.createTextNode(v.value);c.push(x),f.append(x);continue}const A=v?.attributes?.xmlns?document.createElementNS(v.attributes.xmlns,w):document.createElement(w);if(f.append(A),v.attributes&&this.setAttributes({html:A,element:v,storage:t,intent:r,linkService:s}),v.children?.length>0)h.push([v,-1,A]);else if(v.value){const x=document.createTextNode(v.value);o&&dc.shouldBuildText(w)&&c.push(x),A.append(x)}}for(const d of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))d.setAttribute("readOnly",!0);return{textDivs:c}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Mc=1e3,cS=9,Sa=new WeakSet;function $r(i){return{width:i[2]-i[0],height:i[3]-i[1]}}class hS{static create(e){switch(e.data.annotationType){case Es.LINK:return new $1(e);case Es.TEXT:return new uS(e);case Es.WIDGET:switch(e.data.fieldType){case"Tx":return new dS(e);case"Btn":return e.data.radioButton?new q1(e):e.data.checkBox?new pS(e):new mS(e);case"Ch":return new gS(e);case"Sig":return new fS(e)}return new ja(e);case Es.POPUP:return new qf(e);case Es.FREETEXT:return new U1(e);case Es.LINE:return new yS(e);case Es.SQUARE:return new vS(e);case Es.CIRCLE:return new wS(e);case Es.POLYLINE:return new z1(e);case Es.CARET:return new _S(e);case Es.INK:return new $p(e);case Es.POLYGON:return new xS(e);case Es.HIGHLIGHT:return new H1(e);case Es.UNDERLINE:return new AS(e);case Es.SQUIGGLY:return new SS(e);case Es.STRIKEOUT:return new NS(e);case Es.STAMP:return new W1(e);case Es.FILEATTACHMENT:return new ES(e);default:return new gs(e)}}}class gs{#e=null;#t=!1;#s=null;constructor(e,{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:n=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(s)),n&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:s}){return!!(e?.str||t?.str||s?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return gs._hasPopupData(this.data)}updateEdited(e){if(!this.container)return;this.#e||={rect:this.data.rect.slice(0)};const{rect:t}=e;t&&this.#n(t),this.#s?.popup.updateEdited(e)}resetEdited(){this.#e&&(this.#n(this.#e.rect),this.#s?.popup.resetEdited(),this.#e=null)}#n(e){const{container:{style:t},data:{rect:s,rotation:n},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:l}}}}=this;s?.splice(0,4,...e);const{width:c,height:h}=$r(e);t.left=`${100*(e[0]-o)/r}%`,t.top=`${100*(a-e[3]+l)/a}%`,n===0?(t.width=`${100*c/r}%`,t.height=`${100*h/a}%`):this.setRotation(n)}_createContainer(e){const{data:t,parent:{page:s,viewport:n}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),this instanceof ja||(r.tabIndex=Mc);const{style:a}=r;if(a.zIndex=this.parent.zIndex++,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof qf){const{rotation:w}=t;return!t.hasOwnCanvas&&w!==0&&this.setRotation(w,r),r}const{width:o,height:l}=$r(t.rect);if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const w=t.borderStyle.horizontalCornerRadius,A=t.borderStyle.verticalCornerRadius;if(w>0||A>0){const S=`calc(${w}px * var(--scale-factor)) / calc(${A}px * var(--scale-factor))`;a.borderRadius=S}else if(this instanceof q1){const S=`calc(${o}px * var(--scale-factor)) / calc(${l}px * var(--scale-factor))`;a.borderRadius=S}switch(t.borderStyle.style){case Il.SOLID:a.borderStyle="solid";break;case Il.DASHED:a.borderStyle="dashed";break;case Il.BEVELED:yt("Unimplemented border style: beveled");break;case Il.INSET:yt("Unimplemented border style: inset");break;case Il.UNDERLINE:a.borderBottomStyle="solid";break}const x=t.borderColor||null;x?(this.#t=!0,a.borderColor=He.makeHexColor(x[0]|0,x[1]|0,x[2]|0)):a.borderWidth=0}const c=He.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:h,pageHeight:d,pageX:p,pageY:f}=n.rawDims;a.left=`${100*(c[0]-p)/h}%`,a.top=`${100*(c[1]-f)/d}%`;const{rotation:v}=t;return t.hasOwnCanvas||v===0?(a.width=`${100*o/h}%`,a.height=`${100*l/d}%`):this.setRotation(v,r),r}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:n}=this.parent.viewport.rawDims,{width:r,height:a}=$r(this.data.rect);let o,l;e%180===0?(o=100*r/s,l=100*a/n):(o=100*a/s,l=100*r/n),t.style.width=`${o}%`,t.style.height=`${l}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,s,n)=>{const r=n.detail[t],a=r[0],o=r.slice(1);n.target.style[s]=Fg[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[s]:Fg[`${a}_rgb`](o)})};return xt(this,"_commonActions",{display:t=>{const{display:s}=t.detail,n=s%2===1;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:s===1||s===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:s}=t.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const s=t.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const n of Object.keys(t.detail))(e[n]||s[n])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[n,r]of Object.entries(t)){const a=s[n];if(a){const o={detail:{[n]:r},target:e};a(o),delete t[n]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,n,r]=this.data.rect.map(w=>Math.fround(w));if(e.length===8){const[w,A,x,S]=e.subarray(2,6);if(n===w&&r===A&&t===x&&s===S)return}const{style:a}=this.container;let o;if(this.#t){const{borderColor:w,borderWidth:A}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${w}" stroke-width="${A}">`],this.container.classList.add("hasBorder")}const l=n-t,c=r-s,{svgFactory:h}=this,d=h.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0);const p=h.createElement("defs");d.append(p);const f=h.createElement("clipPath"),v=`clippath_${this.data.id}`;f.setAttribute("id",v),f.setAttribute("clipPathUnits","objectBoundingBox"),p.append(f);for(let w=2,A=e.length;w<A;w+=8){const x=e[w],S=e[w+1],j=e[w+2],M=e[w+3],B=h.createElement("rect"),Q=(j-t)/l,q=(r-S)/c,O=(x-j)/l,G=(S-M)/c;B.setAttribute("x",Q),B.setAttribute("y",q),B.setAttribute("width",O),B.setAttribute("height",G),f.append(B),o?.push(`<rect vector-effect="non-scaling-stroke" x="${Q}" y="${q}" width="${O}" height="${G}"/>`)}this.#t&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(d),this.container.style.clipPath=`url(#${v})`}_createPopup(){const{data:e}=this,t=this.#s=new qf({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]});this.parent.div.append(t.render())}render(){Ht("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const s=[];if(this._fieldObjects){const n=this._fieldObjects[e];if(n)for(const{page:r,id:a,exportValues:o}of n){if(r===-1||a===t)continue;const l=typeof o=="string"?o:null,c=document.querySelector(`[data-element-id="${a}"]`);if(c&&!Sa.has(c)){yt(`_getElementsByName - element not allowed: ${a}`);continue}s.push({id:a,exportValue:l,domElement:c})}return s}for(const n of document.getElementsByName(e)){const{exportValue:r}=n,a=n.getAttribute("data-element-id");a!==t&&Sa.has(n)&&s.push({id:a,exportValue:r,domElement:n})}return s}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}}class $1 extends gs{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,s=document.createElement("a");s.setAttribute("data-element-id",e.id);let n=!1;return e.url?(t.addLinkAttributes(s,e.url,e.newWindow),n=!0):e.action?(this._bindNamedAction(s,e.action),n=!0):e.attachment?(this.#t(s,e.attachment,e.attachmentDest),n=!0):e.setOCGState?(this.#s(s,e.setOCGState),n=!0):e.dest?(this._bindLink(s,e.dest),n=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,e),n=!0),e.resetForm?(this._bindResetFormAction(s,e.resetForm),n=!0):this.isTooltipOnly&&!n&&(this._bindLink(s,""),n=!0)),this.container.classList.add("linkAnnotation"),n&&this.container.append(s),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e()}_bindNamedAction(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),this.#e()}#t(e,t,s=null){e.href=this.linkService.getAnchorUrl(""),t.description&&(e.title=t.description),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,s),!1),this.#e()}#s(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const n of Object.keys(t.actions)){const r=s.get(n);r&&(e[r]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:n}}),!1))}e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){const s=e.onclick;if(s||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){yt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(e.onclick=()=>!1);return}e.onclick=()=>{s?.();const{fields:n,refs:r,include:a}=t,o=[];if(n.length!==0||r.length!==0){const h=new Set(r);for(const d of n){const p=this._fieldObjects[d]||[];for(const{id:f}of p)h.add(f)}for(const d of Object.values(this._fieldObjects))for(const p of d)h.has(p.id)===a&&o.push(p)}else for(const h of Object.values(this._fieldObjects))o.push(...h);const l=this.annotationStorage,c=[];for(const h of o){const{id:d}=h;switch(c.push(d),h.type){case"text":{const f=h.defaultValue||"";l.setValue(d,{value:f});break}case"checkbox":case"radiobutton":{const f=h.defaultValue===h.exportValues;l.setValue(d,{value:f});break}case"combobox":case"listbox":{const f=h.defaultValue||"";l.setValue(d,{value:f});break}default:continue}const p=document.querySelector(`[data-element-id="${d}"]`);if(p){if(!Sa.has(p)){yt(`_bindResetFormAction - element not allowed: ${d}`);continue}}else continue;p.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:c,name:"ResetForm"}}),!1}}}class uS extends gs{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class ja extends gs{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return ln.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,n,r){s.includes("mouse")?e.addEventListener(s,a=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:r(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(s,a=>{if(s==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(s==="focus"){if(t.focused)return;t.focused=!0}r&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:r(a)}})})}_setEventListeners(e,t,s,n){for(const[r,a]of s)(a==="Action"||this.data.actions?.[a])&&((a==="Focus"||a==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,r,a,n),a==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):a==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":He.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,n=this.data.defaultAppearanceData.fontSize||cS,r=e.style;let a;const o=2,l=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o),h=Math.round(c/(ef*n))||1,d=c/h;a=Math.min(n,l(d/ef))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(n,l(c/ef))}r.fontSize=`calc(${a}px * var(--scale-factor))`,r.color=He.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class dS extends ja{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,s,n){const r=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=s),r.setValue(a.id,{[n]:s})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const n=e.getValue(t,{value:this.data.fieldValue});let r=n.value||"";const a=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;a&&r.length>a&&(r=r.slice(0,a));let o=n.formattedValue||this.data.textContent?.join(`
`)||null;o&&this.data.comb&&(o=o.replaceAll(/\s+/g,""));const l={userValue:r,formattedValue:o,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=o??r,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type="text",s.setAttribute("value",o??r),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),Sa.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=Mc,this._setRequired(s,this.data.required),a&&(s.maxLength=a),s.addEventListener("input",h=>{e.setValue(t,{value:h.target.value}),this.setPropertyOnSiblings(s,"value",h.target.value,"value"),l.formattedValue=null}),s.addEventListener("resetform",h=>{const d=this.data.defaultFieldValue??"";s.value=l.userValue=d,l.formattedValue=null});let c=h=>{const{formattedValue:d}=l;d!=null&&(h.target.value=d),h.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",d=>{if(l.focused)return;const{target:p}=d;l.userValue&&(p.value=l.userValue),l.lastCommittedValue=p.value,l.commitKey=1,this.data.actions?.Focus||(l.focused=!0)}),s.addEventListener("updatefromsandbox",d=>{this.showElementAndHideCanvas(d.target);const p={value(f){l.userValue=f.detail.value??"",e.setValue(t,{value:l.userValue.toString()}),f.target.value=l.userValue},formattedValue(f){const{formattedValue:v}=f.detail;l.formattedValue=v,v!=null&&f.target!==document.activeElement&&(f.target.value=v),e.setValue(t,{formattedValue:v})},selRange(f){f.target.setSelectionRange(...f.detail.selRange)},charLimit:f=>{const{charLimit:v}=f.detail,{target:w}=f;if(v===0){w.removeAttribute("maxLength");return}w.setAttribute("maxLength",v);let A=l.userValue;!A||A.length<=v||(A=A.slice(0,v),w.value=l.userValue=A,e.setValue(t,{value:A}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:A,willCommit:!0,commitKey:1,selStart:w.selectionStart,selEnd:w.selectionEnd}}))}};this._dispatchEventFromSandbox(p,d)}),s.addEventListener("keydown",d=>{l.commitKey=1;let p=-1;if(d.key==="Escape"?p=0:d.key==="Enter"&&!this.data.multiLine?p=2:d.key==="Tab"&&(l.commitKey=3),p===-1)return;const{value:f}=d.target;l.lastCommittedValue!==f&&(l.lastCommittedValue=f,l.userValue=f,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:f,willCommit:!0,commitKey:p,selStart:d.target.selectionStart,selEnd:d.target.selectionEnd}}))});const h=c;c=null,s.addEventListener("blur",d=>{if(!l.focused||!d.relatedTarget)return;this.data.actions?.Blur||(l.focused=!1);const{value:p}=d.target;l.userValue=p,l.lastCommittedValue!==p&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:p,willCommit:!0,commitKey:l.commitKey,selStart:d.target.selectionStart,selEnd:d.target.selectionEnd}}),h(d)}),this.data.actions?.Keystroke&&s.addEventListener("beforeinput",d=>{l.lastCommittedValue=null;const{data:p,target:f}=d,{value:v,selectionStart:w,selectionEnd:A}=f;let x=w,S=A;switch(d.inputType){case"deleteWordBackward":{const j=v.substring(0,w).match(/\w*[^\w]*$/);j&&(x-=j[0].length);break}case"deleteWordForward":{const j=v.substring(w).match(/^[^\w]*\w*/);j&&(S+=j[0].length);break}case"deleteContentBackward":w===A&&(x-=1);break;case"deleteContentForward":w===A&&(S+=1);break}d.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:v,change:p||"",willCommit:!1,selStart:x,selEnd:S}})}),this._setEventListeners(s,l,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],d=>d.target.value)}if(c&&s.addEventListener("blur",c),this.data.comb){const d=(this.data.rect[2]-this.data.rect[0])/a;s.classList.add("comb"),s.style.letterSpacing=`calc(${d}px * var(--scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class fS extends ja{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class pS extends ja{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let n=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;typeof n=="string"&&(n=n!=="Off",e.setValue(s,{value:n})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return Sa.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,n&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=Mc,r.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,s)){const h=l&&c.exportValue===t.exportValue;c.domElement&&(c.domElement.checked=h),e.setValue(c.id,{value:h})}e.setValue(s,{value:l})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",a=>{const o={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(s,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class q1 extends ja{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let n=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if(typeof n=="string"&&(n=n!==t.buttonValue,e.setValue(s,{value:n})),n)for(const a of this._getElementsByName(t.fieldName,s))e.setValue(a.id,{value:!1});const r=document.createElement("input");if(Sa.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,n&&r.setAttribute("checked",!0),r.tabIndex=Mc,r.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,s))e.setValue(c.id,{value:!1});e.setValue(s,{value:l})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;r.addEventListener("updatefromsandbox",o=>{const l={value:c=>{const h=a===c.detail.value;for(const d of this._getElementsByName(c.target.name)){const p=h&&d.id===s;d.domElement&&(d.domElement.checked=p),e.setValue(d.id,{value:p})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class mS extends $1{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),e}}class gS extends ja{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),n=document.createElement("select");Sa.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,this._setRequired(n,this.data.required),n.name=this.data.fieldName,n.tabIndex=Mc;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(n.size=this.data.options.length,this.data.multiSelect&&(n.multiple=!0)),n.addEventListener("resetform",h=>{const d=this.data.defaultFieldValue;for(const p of n.options)p.selected=p.value===d});for(const h of this.data.options){const d=document.createElement("option");d.textContent=h.displayValue,d.value=h.exportValue,s.value.includes(h.exportValue)&&(d.setAttribute("selected",!0),r=!1),n.append(d)}let a=null;if(r){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),n.prepend(h),a=()=>{h.remove(),n.removeEventListener("input",a),a=null},n.addEventListener("input",a)}const o=h=>{const d=h?"value":"textContent",{options:p,multiple:f}=n;return f?Array.prototype.filter.call(p,v=>v.selected).map(v=>v[d]):p.selectedIndex===-1?null:p[p.selectedIndex][d]};let l=o(!1);const c=h=>{const d=h.target.options;return Array.prototype.map.call(d,p=>({displayValue:p.textContent,exportValue:p.value}))};return this.enableScripting&&this.hasJSActions?(n.addEventListener("updatefromsandbox",h=>{const d={value(p){a?.();const f=p.detail.value,v=new Set(Array.isArray(f)?f:[f]);for(const w of n.options)w.selected=v.has(w.value);e.setValue(t,{value:o(!0)}),l=o(!1)},multipleSelection(p){n.multiple=!0},remove(p){const f=n.options,v=p.detail.remove;f[v].selected=!1,n.remove(v),f.length>0&&Array.prototype.findIndex.call(f,A=>A.selected)===-1&&(f[0].selected=!0),e.setValue(t,{value:o(!0),items:c(p)}),l=o(!1)},clear(p){for(;n.length!==0;)n.remove(0);e.setValue(t,{value:null,items:[]}),l=o(!1)},insert(p){const{index:f,displayValue:v,exportValue:w}=p.detail.insert,A=n.children[f],x=document.createElement("option");x.textContent=v,x.value=w,A?A.before(x):n.append(x),e.setValue(t,{value:o(!0),items:c(p)}),l=o(!1)},items(p){const{items:f}=p.detail;for(;n.length!==0;)n.remove(0);for(const v of f){const{displayValue:w,exportValue:A}=v,x=document.createElement("option");x.textContent=w,x.value=A,n.append(x)}n.options.length>0&&(n.options[0].selected=!0),e.setValue(t,{value:o(!0),items:c(p)}),l=o(!1)},indices(p){const f=new Set(p.detail.indices);for(const v of p.target.options)v.selected=f.has(v.index);e.setValue(t,{value:o(!0)}),l=o(!1)},editable(p){p.target.disabled=!p.detail.editable}};this._dispatchEventFromSandbox(d,h)}),n.addEventListener("input",h=>{const d=o(!0),p=o(!1);e.setValue(t,{value:d}),h.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:p,changeEx:d,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(n,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):n.addEventListener("input",function(h){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class qf extends gs{constructor(e){const{data:t,elements:s}=e;super(e,{isRenderable:gs._hasPopupData(t)}),this.elements=s,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new bS({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const s of this.elements)s.popup=e,s.container.ariaHasPopup="dialog",t.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(s=>`${Pp}${s}`).join(",")),this.container}}class bS{#e=this.#E.bind(this);#t=this.#k.bind(this);#s=this.#P.bind(this);#n=this.#_.bind(this);#r=null;#i=null;#c=null;#o=null;#h=null;#l=null;#u=null;#a=!1;#d=null;#f=null;#p=null;#g=null;#m=null;#b=null;#y=!1;constructor({container:e,color:t,elements:s,titleObj:n,modificationDate:r,contentsObj:a,richText:o,parent:l,rect:c,parentRect:h,open:d}){this.#i=e,this.#m=n,this.#c=a,this.#g=o,this.#l=l,this.#r=t,this.#p=c,this.#u=h,this.#h=s,this.#o=x1.toDateObject(r),this.trigger=s.flatMap(p=>p.getElementsToTriggerPopup());for(const p of this.trigger)p.addEventListener("click",this.#n),p.addEventListener("mouseenter",this.#s),p.addEventListener("mouseleave",this.#t),p.classList.add("popupTriggerArea");for(const p of s)p.container?.addEventListener("keydown",this.#e);this.#i.hidden=!0,d&&this.#_()}render(){if(this.#d)return;const e=this.#d=document.createElement("div");if(e.className="popup",this.#r){const r=e.style.outlineColor=He.makeHexColor(...this.#r);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`:e.style.backgroundColor=He.makeHexColor(...this.#r.map(o=>Math.floor(.7*(255-o)+o)))}const t=document.createElement("span");t.className="header";const s=document.createElement("h1");if(t.append(s),{dir:s.dir,str:s.textContent}=this.#m,e.append(t),this.#o){const r=document.createElement("span");r.classList.add("popupDate"),r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#o.valueOf()})),t.append(r)}const n=this.#w;if(n)B1.render({xfaHtml:n,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const r=this._formatContents(this.#c);e.append(r)}this.#i.append(e)}get#w(){const e=this.#g,t=this.#c;return e?.str&&(!t?.str||t.str===e.str)&&this.#g.html||null}get#x(){return this.#w?.attributes?.style?.fontSize||0}get#S(){return this.#w?.attributes?.style?.color||null}#N(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},n={style:{color:this.#S,fontSize:this.#x?`calc(${this.#x}px * var(--scale-factor))`:""}};for(const r of e.split(`
`))t.push({name:"span",value:r,attributes:n});return s}_formatContents({str:e,dir:t}){const s=document.createElement("p");s.classList.add("popupContent"),s.dir=t;const n=e.split(/(?:\r\n?|\n)/);for(let r=0,a=n.length;r<a;++r){const o=n[r];s.append(document.createTextNode(o)),r<a-1&&s.append(document.createElement("br"))}return s}#E(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#a)&&this.#_()}updateEdited({rect:e,popupContent:t}){this.#b||={contentsObj:this.#c,richText:this.#g},e&&(this.#f=null),t&&(this.#g=this.#N(t),this.#c=null),this.#d?.remove(),this.#d=null}resetEdited(){this.#b&&({contentsObj:this.#c,richText:this.#g}=this.#b,this.#b=null,this.#d?.remove(),this.#d=null,this.#f=null)}#C(){if(this.#f!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:n,pageY:r}}}=this.#l;let a=!!this.#u,o=a?this.#u:this.#p;for(const v of this.#h)if(!o||He.intersect(v.data.rect,o)!==null){o=v.data.rect,a=!0;break}const l=He.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),h=a?o[2]-o[0]+5:0,d=l[0]+h,p=l[1];this.#f=[100*(d-n)/t,100*(p-r)/s];const{style:f}=this.#i;f.left=`${this.#f[0]}%`,f.top=`${this.#f[1]}%`}#_(){this.#a=!this.#a,this.#a?(this.#P(),this.#i.addEventListener("click",this.#n),this.#i.addEventListener("keydown",this.#e)):(this.#k(),this.#i.removeEventListener("click",this.#n),this.#i.removeEventListener("keydown",this.#e))}#P(){this.#d||this.render(),this.isVisible?this.#a&&this.#i.classList.add("focused"):(this.#C(),this.#i.hidden=!1,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)+1e3)}#k(){this.#i.classList.remove("focused"),!(this.#a||!this.isVisible)&&(this.#i.hidden=!0,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)-1e3)}forceHide(){this.#y=this.isVisible,this.#y&&(this.#i.hidden=!0)}maybeShow(){this.#y&&(this.#d||this.#P(),this.#y=!1,this.#i.hidden=!1)}get isVisible(){return this.#i.hidden===!1}}class U1 extends gs{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=pt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class yS extends gs{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:t,height:s}=$r(e.rect),n=this.svgFactory.create(t,s,!0),r=this.#e=this.svgFactory.createElement("svg:line");return r.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),r.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),r.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),r.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),r.setAttribute("stroke-width",e.borderStyle.width||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),n.append(r),this.container.append(n),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class vS extends gs{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:t,height:s}=$r(e.rect),n=this.svgFactory.create(t,s,!0),r=e.borderStyle.width,a=this.#e=this.svgFactory.createElement("svg:rect");return a.setAttribute("x",r/2),a.setAttribute("y",r/2),a.setAttribute("width",t-r),a.setAttribute("height",s-r),a.setAttribute("stroke-width",r||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),n.append(a),this.container.append(n),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class wS extends gs{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:t,height:s}=$r(e.rect),n=this.svgFactory.create(t,s,!0),r=e.borderStyle.width,a=this.#e=this.svgFactory.createElement("svg:ellipse");return a.setAttribute("cx",t/2),a.setAttribute("cy",s/2),a.setAttribute("rx",t/2-r/2),a.setAttribute("ry",s/2-r/2),a.setAttribute("stroke-width",r||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),n.append(a),this.container.append(n),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class z1 extends gs{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:s,popupRef:n}}=this;if(!t)return this.container;const{width:r,height:a}=$r(e),o=this.svgFactory.create(r,a,!0);let l=[];for(let h=0,d=t.length;h<d;h+=2){const p=t[h]-e[0],f=e[3]-t[h+1];l.push(`${p},${f}`)}l=l.join(" ");const c=this.#e=this.svgFactory.createElement(this.svgElementName);return c.setAttribute("points",l),c.setAttribute("stroke-width",s.width||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),o.append(c),this.container.append(o),!n&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class xS extends z1{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class _S extends gs{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class $p extends gs{#e=null;#t=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?pt.HIGHLIGHT:pt.INK}#s(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:s,borderStyle:n,popupRef:r}}=this,{transform:a,width:o,height:l}=this.#s(t,e),c=this.svgFactory.create(o,l,!0),h=this.#e=this.svgFactory.createElement("svg:g");c.append(h),h.setAttribute("stroke-width",n.width||1),h.setAttribute("stroke-linecap","round"),h.setAttribute("stroke-linejoin","round"),h.setAttribute("stroke-miterlimit",10),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),h.setAttribute("transform",a);for(let d=0,p=s.length;d<p;d++){const f=this.svgFactory.createElement(this.svgElementName);this.#t.push(f),f.setAttribute("points",s[d].join(",")),h.append(f)}return!r&&this.hasPopupData&&this._createPopup(),this.container.append(c),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:s,rect:n}=e,r=this.#e;if(t>=0&&r.setAttribute("stroke-width",t||1),s)for(let a=0,o=this.#t.length;a<o;a++)this.#t[a].setAttribute("points",s[a].join(","));if(n){const{transform:a,width:o,height:l}=this.#s(this.data.rotation,n);r.parentElement.setAttribute("viewBox",`0 0 ${o} ${l}`),r.setAttribute("transform",a)}}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class H1 extends gs{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=pt.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class AS extends gs{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class SS extends gs{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class NS extends gs{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class W1 extends gs{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=pt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class ES extends gs{#e=null;constructor(e){super(e,{isRenderable:!0});const{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...t})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let s;t.hasAppearance||t.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),s.addEventListener("dblclick",this.#t.bind(this)),this.#e=s;const{isMac:n}=ln.platform;return e.addEventListener("keydown",r=>{r.key==="Enter"&&(n?r.metaKey:r.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),e.append(s),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class kS{#e=null;#t=null;#s=new Map;#n=null;constructor({div:e,accessibilityManager:t,annotationCanvasMap:s,annotationEditorUIManager:n,page:r,viewport:a,structTreeLayer:o}){this.div=e,this.#e=t,this.#t=s,this.#n=o||null,this.page=r,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=n}hasEditableAnnotations(){return this.#s.size>0}async#r(e,t){const s=e.firstChild||e,n=s.id=`${Pp}${t}`,r=await this.#n?.getAriaAttributes(n);if(r)for(const[a,o]of r)s.setAttribute(a,o);this.div.append(e),this.#e?.moveElementInDOM(this.div,e,s,!1)}async render(e){const{annotations:t}=e,s=this.div;Aa(s,this.viewport);const n=new Map,r={data:null,layer:s,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new Bp,annotationStorage:e.annotationStorage||new Op,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const a of t){if(a.noHTML)continue;const o=a.annotationType===Es.POPUP;if(o){const h=n.get(a.id);if(!h)continue;r.elements=h}else{const{width:h,height:d}=$r(a.rect);if(h<=0||d<=0)continue}r.data=a;const l=hS.create(r);if(!l.isRenderable)continue;if(!o&&a.popupRef){const h=n.get(a.popupRef);h?h.push(l):n.set(a.popupRef,[l])}const c=l.render();a.hidden&&(c.style.visibility="hidden"),await this.#r(c,a.id),l._isEditable&&(this.#s.set(l.data.id,l),this._annotationEditorUIManager?.renderAnnotationElement(l))}this.#i()}update({viewport:e}){const t=this.div;this.viewport=e,Aa(t,{rotation:e.rotation}),this.#i(),t.hidden=!1}#i(){if(!this.#t)return;const e=this.div;for(const[t,s]of this.#t){const n=e.querySelector(`[data-annotation-id="${t}"]`);if(!n)continue;s.className="annotationContent";const{firstChild:r}=n;r?r.nodeName==="CANVAS"?r.replaceWith(s):r.classList.contains("annotationContent")?r.after(s):r.before(s):n.append(s)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#s.values())}getEditableAnnotation(e){return this.#s.get(e)}}const Uh=/\r\n?|\n/g;class ks extends bt{#e;#t="";#s=`${this.id}-editor`;#n=null;#r;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=ks.prototype,t=r=>r.isEmpty(),s=Ur.TRANSLATE_SMALL,n=Ur.TRANSLATE_BIG;return xt(this,"_keyboardManager",new Oc([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[n,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,n],checker:t}]]))}static _type="freetext";static _editorType=pt.FREETEXT;constructor(e){super({...e,name:"freeTextEditor"}),this.#e=e.color||ks._defaultColor||bt._defaultLineColor,this.#r=e.fontSize||ks._defaultFontSize}static initialize(e,t){bt.initialize(e,t);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case Nt.FREETEXT_SIZE:ks._defaultFontSize=t;break;case Nt.FREETEXT_COLOR:ks._defaultColor=t;break}}updateParams(e,t){switch(e){case Nt.FREETEXT_SIZE:this.#i(t);break;case Nt.FREETEXT_COLOR:this.#c(t);break}}static get defaultPropertiesToUpdate(){return[[Nt.FREETEXT_SIZE,ks._defaultFontSize],[Nt.FREETEXT_COLOR,ks._defaultColor||bt._defaultLineColor]]}get propertiesToUpdate(){return[[Nt.FREETEXT_SIZE,this.#r],[Nt.FREETEXT_COLOR,this.#e]]}#i(e){const t=n=>{this.editorDiv.style.fontSize=`calc(${n}px * var(--scale-factor))`,this.translate(0,-(n-this.#r)*this.parentScale),this.#r=n,this.#h()},s=this.#r;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Nt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#c(e){const t=n=>{this.#e=this.editorDiv.style.color=n},s=this.#e;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Nt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-ks._internalPadding*e,-(ks._internalPadding+this.#r)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(pt.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#n=new AbortController;const e=this._uiManager.combinedSignal(this.#n);this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#s),this._isDraggable=!0,this.#n?.abort(),this.#n=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#o(){const e=[];this.editorDiv.normalize();let t=null;for(const s of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&s.nodeName==="BR"||(e.push(ks.#l(s)),t=s);return e.join(`
`)}#h(){const[e,t]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:n,div:r}=this,a=r.style.display,o=r.classList.contains("hidden");r.classList.remove("hidden"),r.style.display="hidden",n.div.append(this.div),s=r.getBoundingClientRect(),r.remove(),r.style.display=a,r.classList.toggle("hidden",o)}this.rotation%180===this.parentRotation%180?(this.width=s.width/e,this.height=s.height/t):(this.width=s.height/e,this.height=s.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#t,t=this.#t=this.#o().trimEnd();if(e===t)return;const s=n=>{if(this.#t=n,!n){this.remove();return}this.#u(),this._uiManager.rebuild(this),this.#h()};this.addCommands({cmd:()=>{s(t)},undo:()=>{s(e)},mustExec:!1}),this.#h()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){ks._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#s),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${this.#r}px * var(--scale-factor))`,s.color=this.#e,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),gu(this,this.div,["dblclick","keydown"]),this.width){const[n,r]=this.parentDimensions;if(this.annotationElementId){const{position:a}=this._initialData;let[o,l]=this.getInitialTranslation();[o,l]=this.pageTranslationToScreen(o,l);const[c,h]=this.pageDimensions,[d,p]=this.pageTranslation;let f,v;switch(this.rotation){case 0:f=e+(a[0]-d)/c,v=t+this.height-(a[1]-p)/h;break;case 90:f=e+(a[0]-d)/c,v=t-(a[1]-p)/h,[o,l]=[l,-o];break;case 180:f=e-this.width+(a[0]-d)/c,v=t-(a[1]-p)/h,[o,l]=[-o,-l];break;case 270:f=e+(a[0]-d-this.height*h)/c,v=t+(a[1]-p-this.width*c)/h,[o,l]=[-l,o];break}this.setAt(f*n,v*r,o,l)}else this.setAt(e*n,t*r,this.width*n,this.height*r);this.#u(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#l(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(Uh,"")}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:s}=t;if(s.length===1&&s[0]==="text/plain")return;e.preventDefault();const n=ks.#d(t.getData("text")||"").replaceAll(Uh,`
`);if(!n)return;const r=window.getSelection();if(!r.rangeCount)return;this.editorDiv.normalize(),r.deleteFromDocument();const a=r.getRangeAt(0);if(!n.includes(`
`)){a.insertNode(document.createTextNode(n)),this.editorDiv.normalize(),r.collapseToStart();return}const{startContainer:o,startOffset:l}=a,c=[],h=[];if(o.nodeType===Node.TEXT_NODE){const f=o.parentElement;if(h.push(o.nodeValue.slice(l).replaceAll(Uh,"")),f!==this.editorDiv){let v=c;for(const w of this.editorDiv.childNodes){if(w===f){v=h;continue}v.push(ks.#l(w))}}c.push(o.nodeValue.slice(0,l).replaceAll(Uh,""))}else if(o===this.editorDiv){let f=c,v=0;for(const w of this.editorDiv.childNodes)v++===l&&(f=h),f.push(ks.#l(w))}this.#t=`${c.join(`
`)}${n}${h.join(`
`)}`,this.#u();const d=new Range;let p=c.reduce((f,v)=>f+v.length,0);for(const{firstChild:f}of this.editorDiv.childNodes)if(f.nodeType===Node.TEXT_NODE){const v=f.nodeValue.length;if(p<=v){d.setStart(f,p),d.setEnd(f,p);break}p-=v}r.removeAllRanges(),r.addRange(d)}#u(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const e of this.#t.split(`
`)){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#a(){return this.#t.replaceAll("Â "," ")}static#d(e){return e.replaceAll(" ","Â ")}get contentDiv(){return this.editorDiv}static async deserialize(e,t,s){let n=null;if(e instanceof U1){const{data:{defaultAppearanceData:{fontSize:a,fontColor:o},rect:l,rotation:c,id:h,popupRef:d},textContent:p,textPosition:f,parent:{page:{pageNumber:v}}}=e;if(!p||p.length===0)return null;n=e={annotationType:pt.FREETEXT,color:Array.from(o),fontSize:a,value:p.join(`
`),position:f,pageIndex:v-1,rect:l.slice(0),rotation:c,id:h,deleted:!1,popupRef:d}}const r=await super.deserialize(e,t,s);return r.#r=e.fontSize,r.#e=He.makeHexColor(...e.color),r.#t=ks.#d(e.value),r.annotationElementId=e.id||null,r._initialData=n,r}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=ks._internalPadding*this.parentScale,s=this.getRect(t,t),n=bt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#e),r={annotationType:pt.FREETEXT,color:n,fontSize:this.#r,value:this.#a(),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?r:this.annotationElementId&&!this.#f(r)?null:(r.id=this.annotationElementId,r)}#f(e){const{value:t,fontSize:s,color:n,pageIndex:r}=this._initialData;return this._hasBeenMoved||e.value!==t||e.fontSize!==s||e.color.some((a,o)=>a!==n[o])||e.pageIndex!==r}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(this.deleted)return t;const{style:s}=t;s.fontSize=`calc(${this.#r}px * var(--scale-factor))`,s.color=this.#e,t.replaceChildren();for(const r of this.#t.split(`
`)){const a=document.createElement("div");a.append(r?document.createTextNode(r):document.createElement("br")),t.append(a)}const n=ks._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(n,n),popupContent:this.#t}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}class $e{static PRECISION=1e-4;toSVGPath(){Ht("Abstract method `toSVGPath` must be implemented.")}get box(){Ht("Abstract getter `box` must be implemented.")}serialize(e,t){Ht("Abstract method `serialize` must be implemented.")}static _rescale(e,t,s,n,r,a){a||=new Float32Array(e.length);for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o]*n,a[o+1]=s+e[o+1]*r;return a}static _rescaleAndSwap(e,t,s,n,r,a){a||=new Float32Array(e.length);for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o+1]*n,a[o+1]=s+e[o]*r;return a}static _translate(e,t,s,n){n||=new Float32Array(e.length);for(let r=0,a=e.length;r<a;r+=2)n[r]=t+e[r],n[r+1]=s+e[r+1];return n}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,s,n,r){switch(r){case 90:return[1-t/s,e/n];case 180:return[1-e/s,1-t/n];case 270:return[t/s,1-e/n];default:return[e/s,t/n]}}static _normalizePagePoint(e,t,s){switch(s){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,s,n,r,a){return[(e+5*s)/6,(t+5*n)/6,(5*s+r)/6,(5*n+a)/6,(s+r)/2,(n+a)/2]}}class ya{#e;#t=[];#s;#n;#r=[];#i=new Float32Array(18);#c;#o;#h;#l;#u;#a;#d=[];static#f=8;static#p=2;static#g=ya.#f+ya.#p;constructor({x:e,y:t},s,n,r,a,o=0){this.#e=s,this.#a=r*n,this.#n=a,this.#i.set([NaN,NaN,NaN,NaN,e,t],6),this.#s=o,this.#l=ya.#f*n,this.#h=ya.#g*n,this.#u=n,this.#d.push(e,t)}isEmpty(){return isNaN(this.#i[8])}#m(){const e=this.#i.subarray(4,6),t=this.#i.subarray(16,18),[s,n,r,a]=this.#e;return[(this.#c+(e[0]-t[0])/2-s)/r,(this.#o+(e[1]-t[1])/2-n)/a,(this.#c+(t[0]-e[0])/2-s)/r,(this.#o+(t[1]-e[1])/2-n)/a]}add({x:e,y:t}){this.#c=e,this.#o=t;const[s,n,r,a]=this.#e;let[o,l,c,h]=this.#i.subarray(8,12);const d=e-c,p=t-h,f=Math.hypot(d,p);if(f<this.#h)return!1;const v=f-this.#l,w=v/f,A=w*d,x=w*p;let S=o,j=l;o=c,l=h,c+=A,h+=x,this.#d?.push(e,t);const M=-x/v,B=A/v,Q=M*this.#a,q=B*this.#a;return this.#i.set(this.#i.subarray(2,8),0),this.#i.set([c+Q,h+q],4),this.#i.set(this.#i.subarray(14,18),12),this.#i.set([c-Q,h-q],16),isNaN(this.#i[6])?(this.#r.length===0&&(this.#i.set([o+Q,l+q],2),this.#r.push(NaN,NaN,NaN,NaN,(o+Q-s)/r,(l+q-n)/a),this.#i.set([o-Q,l-q],14),this.#t.push(NaN,NaN,NaN,NaN,(o-Q-s)/r,(l-q-n)/a)),this.#i.set([S,j,o,l,c,h],6),!this.isEmpty()):(this.#i.set([S,j,o,l,c,h],6),Math.abs(Math.atan2(j-l,S-o)-Math.atan2(x,A))<Math.PI/2?([o,l,c,h]=this.#i.subarray(2,6),this.#r.push(NaN,NaN,NaN,NaN,((o+c)/2-s)/r,((l+h)/2-n)/a),[o,l,S,j]=this.#i.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,((S+o)/2-s)/r,((j+l)/2-n)/a),!0):([S,j,o,l,c,h]=this.#i.subarray(0,6),this.#r.push(((S+5*o)/6-s)/r,((j+5*l)/6-n)/a,((5*o+c)/6-s)/r,((5*l+h)/6-n)/a,((o+c)/2-s)/r,((l+h)/2-n)/a),[c,h,o,l,S,j]=this.#i.subarray(12,18),this.#t.push(((S+5*o)/6-s)/r,((j+5*l)/6-n)/a,((5*o+c)/6-s)/r,((5*l+h)/6-n)/a,((o+c)/2-s)/r,((l+h)/2-n)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=this.#r,t=this.#t;if(isNaN(this.#i[6])&&!this.isEmpty())return this.#b();const s=[];s.push(`M${e[4]} ${e[5]}`);for(let n=6;n<e.length;n+=6)isNaN(e[n])?s.push(`L${e[n+4]} ${e[n+5]}`):s.push(`C${e[n]} ${e[n+1]} ${e[n+2]} ${e[n+3]} ${e[n+4]} ${e[n+5]}`);this.#w(s);for(let n=t.length-6;n>=6;n-=6)isNaN(t[n])?s.push(`L${t[n+4]} ${t[n+5]}`):s.push(`C${t[n]} ${t[n+1]} ${t[n+2]} ${t[n+3]} ${t[n+4]} ${t[n+5]}`);return this.#y(s),s.join(" ")}#b(){const[e,t,s,n]=this.#e,[r,a,o,l]=this.#m();return`M${(this.#i[2]-e)/s} ${(this.#i[3]-t)/n} L${(this.#i[4]-e)/s} ${(this.#i[5]-t)/n} L${r} ${a} L${o} ${l} L${(this.#i[16]-e)/s} ${(this.#i[17]-t)/n} L${(this.#i[14]-e)/s} ${(this.#i[15]-t)/n} Z`}#y(e){const t=this.#t;e.push(`L${t[4]} ${t[5]} Z`)}#w(e){const[t,s,n,r]=this.#e,a=this.#i.subarray(4,6),o=this.#i.subarray(16,18),[l,c,h,d]=this.#m();e.push(`L${(a[0]-t)/n} ${(a[1]-s)/r} L${l} ${c} L${h} ${d} L${(o[0]-t)/n} ${(o[1]-s)/r}`)}newFreeDrawOutline(e,t,s,n,r,a){return new V1(e,t,s,n,r,a)}getOutlines(){const e=this.#r,t=this.#t,s=this.#i,[n,r,a,o]=this.#e,l=new Float32Array((this.#d?.length??0)+2);for(let d=0,p=l.length-2;d<p;d+=2)l[d]=(this.#d[d]-n)/a,l[d+1]=(this.#d[d+1]-r)/o;if(l[l.length-2]=(this.#c-n)/a,l[l.length-1]=(this.#o-r)/o,isNaN(s[6])&&!this.isEmpty())return this.#x(l);const c=new Float32Array(this.#r.length+24+this.#t.length);let h=e.length;for(let d=0;d<h;d+=2){if(isNaN(e[d])){c[d]=c[d+1]=NaN;continue}c[d]=e[d],c[d+1]=e[d+1]}h=this.#N(c,h);for(let d=t.length-6;d>=6;d-=6)for(let p=0;p<6;p+=2){if(isNaN(t[d+p])){c[h]=c[h+1]=NaN,h+=2;continue}c[h]=t[d+p],c[h+1]=t[d+p+1],h+=2}return this.#S(c,h),this.newFreeDrawOutline(c,l,this.#e,this.#u,this.#s,this.#n)}#x(e){const t=this.#i,[s,n,r,a]=this.#e,[o,l,c,h]=this.#m(),d=new Float32Array(36);return d.set([NaN,NaN,NaN,NaN,(t[2]-s)/r,(t[3]-n)/a,NaN,NaN,NaN,NaN,(t[4]-s)/r,(t[5]-n)/a,NaN,NaN,NaN,NaN,o,l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,(t[16]-s)/r,(t[17]-n)/a,NaN,NaN,NaN,NaN,(t[14]-s)/r,(t[15]-n)/a],0),this.newFreeDrawOutline(d,e,this.#e,this.#u,this.#s,this.#n)}#S(e,t){const s=this.#t;return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+=6}#N(e,t){const s=this.#i.subarray(4,6),n=this.#i.subarray(16,18),[r,a,o,l]=this.#e,[c,h,d,p]=this.#m();return e.set([NaN,NaN,NaN,NaN,(s[0]-r)/o,(s[1]-a)/l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,d,p,NaN,NaN,NaN,NaN,(n[0]-r)/o,(n[1]-a)/l],t),t+=24}}class V1 extends $e{#e;#t=new Float32Array(4);#s;#n;#r;#i;#c;constructor(e,t,s,n,r,a){super(),this.#c=e,this.#r=t,this.#e=s,this.#i=n,this.#s=r,this.#n=a,this.lastPoint=[NaN,NaN],this.#o(a);const[o,l,c,h]=this.#t;for(let d=0,p=e.length;d<p;d+=2)e[d]=(e[d]-o)/c,e[d+1]=(e[d+1]-l)/h;for(let d=0,p=t.length;d<p;d+=2)t[d]=(t[d]-o)/c,t[d+1]=(t[d+1]-l)/h}toSVGPath(){const e=[`M${this.#c[4]} ${this.#c[5]}`];for(let t=6,s=this.#c.length;t<s;t+=6){if(isNaN(this.#c[t])){e.push(`L${this.#c[t+4]} ${this.#c[t+5]}`);continue}e.push(`C${this.#c[t]} ${this.#c[t+1]} ${this.#c[t+2]} ${this.#c[t+3]} ${this.#c[t+4]} ${this.#c[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,s,n],r){const a=s-e,o=n-t;let l,c;switch(r){case 0:l=$e._rescale(this.#c,e,n,a,-o),c=$e._rescale(this.#r,e,n,a,-o);break;case 90:l=$e._rescaleAndSwap(this.#c,e,t,a,o),c=$e._rescaleAndSwap(this.#r,e,t,a,o);break;case 180:l=$e._rescale(this.#c,s,t,-a,o),c=$e._rescale(this.#r,s,t,-a,o);break;case 270:l=$e._rescaleAndSwap(this.#c,s,n,-a,-o),c=$e._rescaleAndSwap(this.#r,s,n,-a,-o);break}return{outline:Array.from(l),points:[Array.from(c)]}}#o(e){const t=this.#c;let s=t[4],n=t[5],r=s,a=n,o=s,l=n,c=s,h=n;const d=e?Math.max:Math.min;for(let f=6,v=t.length;f<v;f+=6){if(isNaN(t[f]))r=Math.min(r,t[f+4]),a=Math.min(a,t[f+5]),o=Math.max(o,t[f+4]),l=Math.max(l,t[f+5]),h<t[f+5]?(c=t[f+4],h=t[f+5]):h===t[f+5]&&(c=d(c,t[f+4]));else{const w=He.bezierBoundingBox(s,n,...t.slice(f,f+6));r=Math.min(r,w[0]),a=Math.min(a,w[1]),o=Math.max(o,w[2]),l=Math.max(l,w[3]),h<w[3]?(c=w[2],h=w[3]):h===w[3]&&(c=d(c,w[2]))}s=t[f+4],n=t[f+5]}const p=this.#t;p[0]=r-this.#s,p[1]=a-this.#s,p[2]=o-r+2*this.#s,p[3]=l-a+2*this.#s,this.lastPoint=[c,h]}get box(){return this.#t}newOutliner(e,t,s,n,r,a=0){return new ya(e,t,s,n,r,a)}getNewOutline(e,t){const[s,n,r,a]=this.#t,[o,l,c,h]=this.#e,d=r*c,p=a*h,f=s*c+o,v=n*h+l,w=this.newOutliner({x:this.#r[0]*d+f,y:this.#r[1]*p+v},this.#e,this.#i,e,this.#n,t??this.#s);for(let A=2;A<this.#r.length;A+=2)w.add({x:this.#r[A]*d+f,y:this.#r[A+1]*p+v});return w.getOutlines()}}class Uf{#e;#t;#s=[];#n=[];constructor(e,t=0,s=0,n=!0){let r=1/0,a=-1/0,o=1/0,l=-1/0;const h=10**-4;for(const{x,y:S,width:j,height:M}of e){const B=Math.floor((x-t)/h)*h,Q=Math.ceil((x+j+t)/h)*h,q=Math.floor((S-t)/h)*h,O=Math.ceil((S+M+t)/h)*h,G=[B,q,O,!0],ie=[Q,q,O,!1];this.#s.push(G,ie),r=Math.min(r,B),a=Math.max(a,Q),o=Math.min(o,q),l=Math.max(l,O)}const d=a-r+2*s,p=l-o+2*s,f=r-s,v=o-s,w=this.#s.at(n?-1:-2),A=[w[0],w[2]];for(const x of this.#s){const[S,j,M]=x;x[0]=(S-f)/d,x[1]=(j-v)/p,x[2]=(M-v)/p}this.#e=new Float32Array([f,v,d,p]),this.#t=A}getOutlines(){this.#s.sort((t,s)=>t[0]-s[0]||t[1]-s[1]||t[2]-s[2]);const e=[];for(const t of this.#s)t[3]?(e.push(...this.#h(t)),this.#c(t)):(this.#o(t),e.push(...this.#h(t)));return this.#r(e)}#r(e){const t=[],s=new Set;for(const a of e){const[o,l,c]=a;t.push([o,l,a],[o,c,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){const l=t[a][2],c=t[a+1][2];l.push(c),c.push(l),s.add(l),s.add(c)}const n=[];let r;for(;s.size>0;){const a=s.values().next().value;let[o,l,c,h,d]=a;s.delete(a);let p=o,f=l;for(r=[o,c],n.push(r);;){let v;if(s.has(h))v=h;else if(s.has(d))v=d;else break;s.delete(v),[o,l,c,h,d]=v,p!==o&&(r.push(p,f,o,f===l?l:c),p=o),f=f===l?c:l}r.push(p,f)}return new CS(n,this.#e,this.#t)}#i(e){const t=this.#n;let s=0,n=t.length-1;for(;s<=n;){const r=s+n>>1,a=t[r][0];if(a===e)return r;a<e?s=r+1:n=r-1}return n+1}#c([,e,t]){const s=this.#i(e);this.#n.splice(s,0,[e,t])}#o([,e,t]){const s=this.#i(e);for(let n=s;n<this.#n.length;n++){const[r,a]=this.#n[n];if(r!==e)break;if(r===e&&a===t){this.#n.splice(n,1);return}}for(let n=s-1;n>=0;n--){const[r,a]=this.#n[n];if(r!==e)break;if(r===e&&a===t){this.#n.splice(n,1);return}}}#h(e){const[t,s,n]=e,r=[[t,s,n]],a=this.#i(n);for(let o=0;o<a;o++){const[l,c]=this.#n[o];for(let h=0,d=r.length;h<d;h++){const[,p,f]=r[h];if(!(c<=p||f<=l)){if(p>=l){if(f>c)r[h][1]=c;else{if(d===1)return[];r.splice(h,1),h--,d--}continue}r[h][2]=l,f>c&&r.push([t,c,f])}}}return r}}class CS extends $e{#e;#t;constructor(e,t,s){super(),this.#t=e,this.#e=t,this.lastPoint=s}toSVGPath(){const e=[];for(const t of this.#t){let[s,n]=t;e.push(`M${s} ${n}`);for(let r=2;r<t.length;r+=2){const a=t[r],o=t[r+1];a===s?(e.push(`V${o}`),n=o):o===n&&(e.push(`H${a}`),s=a)}e.push("Z")}return e.join(" ")}serialize([e,t,s,n],r){const a=[],o=s-e,l=n-t;for(const c of this.#t){const h=new Array(c.length);for(let d=0;d<c.length;d+=2)h[d]=e+c[d]*o,h[d+1]=n-c[d+1]*l;a.push(h)}return a}get box(){return this.#e}get classNamesForOutlining(){return["highlightOutline"]}}class zf extends ya{newFreeDrawOutline(e,t,s,n,r,a){return new PS(e,t,s,n,r,a)}}class PS extends V1{newOutliner(e,t,s,n,r,a=0){return new zf(e,t,s,n,r,a)}}class Wn{#e=null;#t=null;#s;#n=null;#r=!1;#i=!1;#c=null;#o;#h=null;#l=null;#u;static#a=null;static get _keyboardManager(){return xt(this,"_keyboardManager",new Oc([[["Escape","mac+Escape"],Wn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Wn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Wn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Wn.prototype._moveToPrevious],[["Home","mac+Home"],Wn.prototype._moveToBeginning],[["End","mac+End"],Wn.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#i=!1,this.#u=Nt.HIGHLIGHT_COLOR,this.#c=e):(this.#i=!0,this.#u=Nt.HIGHLIGHT_DEFAULT_COLOR),this.#l=e?._uiManager||t,this.#o=this.#l._eventBus,this.#s=e?.color||this.#l?.highlightColors.values().next().value||"#FFFF98",Wn.#a||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const e=this.#e=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=this.#l._signal;e.addEventListener("click",this.#g.bind(this),{signal:t}),e.addEventListener("keydown",this.#p.bind(this),{signal:t});const s=this.#t=document.createElement("span");return s.className="swatch",s.setAttribute("aria-hidden",!0),s.style.backgroundColor=this.#s,e.append(s),e}renderMainDropdown(){const e=this.#n=this.#d();return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}#d(){const e=document.createElement("div"),t=this.#l._signal;e.addEventListener("contextmenu",bi,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[s,n]of this.#l.highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",n),r.title=s,r.setAttribute("data-l10n-id",Wn.#a[s]);const a=document.createElement("span");r.append(a),a.className="swatch",a.style.backgroundColor=n,r.setAttribute("aria-selected",n===this.#s),r.addEventListener("click",this.#f.bind(this,n),{signal:t}),e.append(r)}return e.addEventListener("keydown",this.#p.bind(this),{signal:t}),e}#f(e,t){t.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:this.#u,value:e})}_colorSelectFromKeyboard(e){if(e.target===this.#e){this.#g(e);return}const t=e.target.getAttribute("data-color");t&&this.#f(t,e)}_moveToNext(e){if(!this.#b){this.#g(e);return}if(e.target===this.#e){this.#n.firstChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#n?.firstChild||e.target===this.#e){this.#b&&this._hideDropdownFromKeyboard();return}this.#b||this.#g(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#b){this.#g(e);return}this.#n.firstChild?.focus()}_moveToEnd(e){if(!this.#b){this.#g(e);return}this.#n.lastChild?.focus()}#p(e){Wn._keyboardManager.exec(this,e)}#g(e){if(this.#b){this.hideDropdown();return}if(this.#r=e.detail===0,this.#h||(this.#h=new AbortController,window.addEventListener("pointerdown",this.#m.bind(this),{signal:this.#l.combinedSignal(this.#h)})),this.#n){this.#n.classList.remove("hidden");return}const t=this.#n=this.#d();this.#e.append(t)}#m(e){this.#n?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#n?.classList.add("hidden"),this.#h?.abort(),this.#h=null}get#b(){return this.#n&&!this.#n.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#i){if(!this.#b){this.#c?.unselect();return}this.hideDropdown(),this.#e.focus({preventScroll:!0,focusVisible:this.#r})}}updateColor(e){if(this.#t&&(this.#t.style.backgroundColor=e),!this.#n)return;const t=this.#l.highlightColors.values();for(const s of this.#n.children)s.setAttribute("aria-selected",t.next().value===e)}destroy(){this.#e?.remove(),this.#e=null,this.#t=null,this.#n?.remove(),this.#n=null}}class ds extends bt{#e=null;#t=0;#s;#n=null;#r=null;#i=null;#c=null;#o=0;#h=null;#l=null;#u=null;#a=!1;#d=null;#f;#p=null;#g="";#m;#b="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=pt.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const e=ds.prototype;return xt(this,"_keyboardManager",new Oc([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super({...e,name:"highlightEditor"}),this.color=e.color||ds._defaultColor,this.#m=e.thickness||ds._defaultThickness,this.#f=e.opacity||ds._defaultOpacity,this.#s=e.boxes||null,this.#b=e.methodOfCreation||"",this.#g=e.text||"",this._isDraggable=!1,e.highlightId>-1?(this.#a=!0,this.#w(e),this.#C()):this.#s&&(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#c=e.focusNode,this.#o=e.focusOffset,this.#y(),this.#C(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#a?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#m,methodOfCreation:this.#b}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#y(){const e=new Uf(this.#s,.001);this.#l=e.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const t=new Uf(this.#s,.0025,.001,this._uiManager.direction==="ltr");this.#i=t.getOutlines();const{lastPoint:s}=this.#i;this.#d=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height]}#w({highlightOutlines:e,highlightId:t,clipPathId:s}){this.#l=e;const n=1.5;if(this.#i=e.getNewOutline(this.#m/2+n,.0025),t>=0)this.#u=t,this.#n=s,this.parent.drawLayer.finalizeDraw(t,{bbox:e.box,path:{d:e.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#i.box,path:{d:this.#i.toSVGPath()}},!0);else if(this.parent){const h=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#u,{bbox:ds.#_(this.#l.box,(h-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:ds.#_(this.#i.box,h),path:{d:this.#i.toSVGPath()}})}const[r,a,o,l]=e.box;switch(this.rotation){case 0:this.x=r,this.y=a,this.width=o,this.height=l;break;case 90:{const[h,d]=this.parentDimensions;this.x=a,this.y=1-r,this.width=o*d/h,this.height=l*h/d;break}case 180:this.x=1-r,this.y=1-a,this.width=o,this.height=l;break;case 270:{const[h,d]=this.parentDimensions;this.x=1-a,this.y=r,this.width=o*d/h,this.height=l*h/d;break}}const{lastPoint:c}=this.#i;this.#d=[(c[0]-r)/o,(c[1]-a)/l]}static initialize(e,t){bt.initialize(e,t),ds._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case Nt.HIGHLIGHT_DEFAULT_COLOR:ds._defaultColor=t;break;case Nt.HIGHLIGHT_THICKNESS:ds._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#d}updateParams(e,t){switch(e){case Nt.HIGHLIGHT_COLOR:this.#x(t);break;case Nt.HIGHLIGHT_THICKNESS:this.#S(t);break}}static get defaultPropertiesToUpdate(){return[[Nt.HIGHLIGHT_DEFAULT_COLOR,ds._defaultColor],[Nt.HIGHLIGHT_THICKNESS,ds._defaultThickness]]}get propertiesToUpdate(){return[[Nt.HIGHLIGHT_COLOR,this.color||ds._defaultColor],[Nt.HIGHLIGHT_THICKNESS,this.#m||ds._defaultThickness],[Nt.HIGHLIGHT_FREE,this.#a]]}#x(e){const t=(r,a)=>{this.color=r,this.#f=a,this.parent?.drawLayer.updateProperties(this.#u,{root:{fill:r,"fill-opacity":a}}),this.#r?.updateColor(r)},s=this.color,n=this.#f;this.addCommands({cmd:t.bind(this,e,ds._defaultOpacity),undo:t.bind(this,s,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Nt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)}#S(e){const t=this.#m,s=n=>{this.#m=n,this.#N(n)};this.addCommands({cmd:s.bind(this,e),undo:s.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Nt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(this.#r=new Wn({editor:this}),e.addColorPicker(this.#r)),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#L())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#L())}onceAdded(){this.annotationElementId||this.parent.addUndoableEditor(this),this.div.focus()}remove(){this.#E(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#C(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#E():e&&(this.#C(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#N(e){if(!this.#a)return;this.#w({highlightOutlines:this.#l.getNewOutline(e/2)}),this.fixAndSetPosition();const[t,s]=this.parentDimensions;this.setDims(this.width*t,this.height*s)}#E(){this.#u===null||!this.parent||(this.parent.drawLayer.remove(this.#u),this.#u=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#C(e=this.parent){this.#u===null&&({id:this.#u,clipPathId:this.#n}=e.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#f},rootClass:{highlight:!0,free:this.#a},path:{d:this.#l.toSVGPath()}},!1,!0),this.#p=e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#a},bbox:this.#i.box,path:{d:this.#i.toSVGPath()}},this.#a),this.#h&&(this.#h.style.clipPath=this.#n))}static#_([e,t,s,n],r){switch(r){case 90:return[1-t-n,e,n,s];case 180:return[1-e-s,1-t-n,s,n];case 270:return[t,1-e-s,n,s]}return[e,t,s,n]}rotate(e){const{drawLayer:t}=this.parent;let s;this.#a?(e=(e-this.rotation+360)%360,s=ds.#_(this.#l.box,e)):s=ds.#_([this.x,this.y,this.width,this.height],e),t.updateProperties(this.#u,{bbox:s,root:{"data-main-rotation":e}}),t.updateProperties(this.#p,{bbox:ds.#_(this.#i.box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();this.#g&&(e.setAttribute("aria-label",this.#g),e.setAttribute("role","mark")),this.#a?e.classList.add("free"):this.div.addEventListener("keydown",this.#P.bind(this),{signal:this._uiManager._signal});const t=this.#h=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#n;const[s,n]=this.parentDimensions;return this.setDims(this.width*s,this.height*n),gu(this,this.#h,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#P(e){ds._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#k(!0);break;case 1:case 3:this.#k(!1);break}}#k(e){if(!this.#e)return;const t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#c,this.#o)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#a||this.#k(!1))}get _mustFixPosition(){return!this.#a}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(this.#u,{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!e}}))}#L(){return this.#a?this.rotation:0}#R(){if(this.#a)return null;const[e,t]=this.pageDimensions,[s,n]=this.pageTranslation,r=this.#s,a=new Float32Array(r.length*8);let o=0;for(const{x:l,y:c,width:h,height:d}of r){const p=l*e+s,f=(1-c)*t+n;a[o]=a[o+4]=p,a[o+1]=a[o+3]=f,a[o+2]=a[o+6]=p+h*e,a[o+5]=a[o+7]=f-d*t,o+=8}return a}#D(e){return this.#l.serialize(e,this.#L())}static startHighlighting(e,t,{target:s,x:n,y:r}){const{x:a,y:o,width:l,height:c}=s.getBoundingClientRect(),h=new AbortController,d=e.combinedSignal(h),p=f=>{h.abort(),this.#v(e,f)};window.addEventListener("blur",p,{signal:d}),window.addEventListener("pointerup",p,{signal:d}),window.addEventListener("pointerdown",di,{capture:!0,passive:!1,signal:d}),window.addEventListener("contextmenu",bi,{signal:d}),s.addEventListener("pointermove",this.#A.bind(this,e),{signal:d}),this._freeHighlight=new zf({x:n,y:r},[a,o,l,c],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#A(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#v(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(e,t,s){let n=null;if(e instanceof H1){const{data:{quadPoints:v,rect:w,rotation:A,id:x,color:S,opacity:j,popupRef:M},parent:{page:{pageNumber:B}}}=e;n=e={annotationType:pt.HIGHLIGHT,color:Array.from(S),opacity:j,quadPoints:v,boxes:null,pageIndex:B-1,rect:w.slice(0),rotation:A,id:x,deleted:!1,popupRef:M}}else if(e instanceof $p){const{data:{inkLists:v,rect:w,rotation:A,id:x,color:S,borderStyle:{rawWidth:j},popupRef:M},parent:{page:{pageNumber:B}}}=e;n=e={annotationType:pt.HIGHLIGHT,color:Array.from(S),thickness:j,inkLists:v,boxes:null,pageIndex:B-1,rect:w.slice(0),rotation:A,id:x,deleted:!1,popupRef:M}}const{color:r,quadPoints:a,inkLists:o,opacity:l}=e,c=await super.deserialize(e,t,s);c.color=He.makeHexColor(...r),c.#f=l||1,o&&(c.#m=e.thickness),c.annotationElementId=e.id||null,c._initialData=n;const[h,d]=c.pageDimensions,[p,f]=c.pageTranslation;if(a){const v=c.#s=[];for(let w=0;w<a.length;w+=8)v.push({x:(a[w]-p)/h,y:1-(a[w+1]-f)/d,width:(a[w+2]-a[w])/h,height:(a[w+1]-a[w+5])/d});c.#y(),c.#C(),c.rotate(c.rotation)}else if(o){c.#a=!0;const v=o[0],w={x:v[0]-p,y:d-(v[1]-f)},A=new zf(w,[0,0,h,d],1,c.#m/2,!0,.001);for(let j=0,M=v.length;j<M;j+=2)w.x=v[j]-p,w.y=d-(v[j+1]-f),A.add(w);const{id:x,clipPathId:S}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:c.color,"fill-opacity":c._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:A.toSVGPath()}},!0,!0);c.#w({highlightOutlines:A.getOutlines(),highlightId:x,clipPathId:S}),c.#C()}return c}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=this.getRect(0,0),s=bt._colorManager.convert(this.color),n={annotationType:pt.HIGHLIGHT,color:s,opacity:this.#f,thickness:this.#m,quadPoints:this.#R(),outlines:this.#D(t),pageIndex:this.pageIndex,rect:t,rotation:this.#L(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#I(n)?null:(n.id=this.annotationElementId,n)}#I(e){const{color:t}=this._initialData;return e.color.some((s,n)=>s!==t[n])}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class LS{#e=Object.create(null);updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,s]of Object.entries(e))this.updateProperty(t,s)}updateSVGProperty(e,t){this.#e[e]=t}toSVGProperties(){const e=this.#e;return this.#e=Object.create(null),{root:e}}reset(){this.#e=Object.create(null)}updateAll(e=this){this.updateProperties(e)}clone(){Ht("Not implemented")}}class ma extends bt{#e=null;#t;_drawId=null;static _currentDrawId=-1;static _currentDraw=null;static _currentDrawingOptions=null;static _currentParent=null;static _INNER_MARGIN=3;constructor(e){super(e),this.#t=e.mustBeCommitted||!1,e.drawOutlines&&(this.#s(e),this.#i())}#s({drawOutlines:e,drawId:t,drawingOptions:s}){this.#e=e,this._drawingOptions||=s,t>=0?(this._drawId=t,this.parent.drawLayer.finalizeDraw(t,e.defaultProperties)):this._drawId=this.#n(e,this.parent),this.#h(e.box)}#n(e,t){const{id:s}=t.drawLayer.draw(ma._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return s}static _mergeSVGProperties(e,t){const s=new Set(Object.keys(e));for(const[n,r]of Object.entries(t))s.has(n)?Object.assign(e[n],r):e[n]=r;return e}static getDefaultDrawingOptions(e){Ht("Not implemented")}static get typesMap(){Ht("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const s=this.typesMap.get(e);s&&this._defaultDrawingOptions.updateProperty(s,t),this._currentParent&&(this._currentDraw.updateProperty(s,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const s=this.constructor.typesMap.get(e);s&&this._updateProperty(e,s,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[s,n]of this.typesMap)e.push([s,t[n]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[s,n]of this.constructor.typesMap)e.push([s,t[n]]);return e}_updateProperty(e,t,s){const n=this._drawingOptions,r=n[t],a=o=>{n.updateProperty(t,o);const l=this.#e.updateProperty(t,o);l&&this.#h(l),this.parent?.drawLayer.updateProperties(this._drawId,n.toSVGProperties())};this.addCommands({cmd:a.bind(this,s),undo:a.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,ma._mergeSVGProperties(this.#e.getPathResizingSVGProperties(this.#o()),{bbox:this.#l()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,ma._mergeSVGProperties(this.#e.getPathResizedSVGProperties(this.#o()),{bbox:this.#l()}))}_onTranslating(e,t){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#l(e,t)})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,ma._mergeSVGProperties(this.#e.getPathTranslatedSVGProperties(this.#o(),this.parentDimensions),{bbox:this.#l()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#t&&(this.#t=!1,this.commit(),this.parent.setSelected(this),this.isOnScreen&&this.div.focus())}remove(){this.#r(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#i(),this.#h(this.#e.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),this.#r()):e&&(this._uiManager.addShouldRescale(this),this.#i(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),t&&this.select()}#r(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#i(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#n(this.#e,e)}}#c([e,t,s,n]){const{parentDimensions:[r,a],rotation:o}=this;switch(o){case 90:return[t,1-e,s*(a/r),n*(r/a)];case 180:return[1-e,1-t,s,n];case 270:return[1-t,e,s*(a/r),n*(r/a)];default:return[e,t,s,n]}}#o(){const{x:e,y:t,width:s,height:n,parentDimensions:[r,a],rotation:o}=this;switch(o){case 90:return[1-t,e,s*(r/a),n*(a/r)];case 180:return[1-e,1-t,s,n];case 270:return[t,1-e,s*(r/a),n*(a/r)];default:return[e,t,s,n]}}#h(e){if([this.x,this.y,this.width,this.height]=this.#c(e),this.div){this.fixAndSetPosition();const[t,s]=this.parentDimensions;this.setDims(this.width*t,this.height*s)}this._onResized()}#l(){const{x:e,y:t,width:s,height:n,rotation:r,parentRotation:a,parentDimensions:[o,l]}=this;switch((r*4+a)/90){case 1:return[1-t-n,e,n,s];case 2:return[1-e-s,1-t-n,s,n];case 3:return[t,1-e-s,n,s];case 4:return[e,t-s*(o/l),n*(l/o),s*(o/l)];case 5:return[1-t,e,s*(o/l),n*(l/o)];case 6:return[1-e-n*(l/o),1-t,n*(l/o),s*(o/l)];case 7:return[t-s*(o/l),1-e-n*(l/o),s*(o/l),n*(l/o)];case 8:return[e-s,t-n,s,n];case 9:return[1-t,e-s,n,s];case 10:return[1-e,1-t,s,n];case 11:return[t-n,1-e,n,s];case 12:return[e-n*(l/o),t,n*(l/o),s*(o/l)];case 13:return[1-t-s*(o/l),e-n*(l/o),s*(o/l),n*(l/o)];case 14:return[1-e,1-t-s*(o/l),n*(l/o),s*(o/l)];case 15:return[t,1-e,s*(o/l),n*(l/o)];default:return[e,t,s,n]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,ma._mergeSVGProperties({bbox:this.#l()},this.#e.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#e.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const e=super.render();e.classList.add("draw");const t=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal";const[s,n]=this.parentDimensions;return this.setDims(this.width*s,this.height*n),this._uiManager.addShouldRescale(this),this.disableEditing(),e}static createDrawerInstance(e,t,s,n,r){Ht("Not implemented")}static startDrawing(e,t,s,{target:n,offsetX:r,offsetY:a}){const{viewport:{rotation:o}}=e,{width:l,height:c}=n.getBoundingClientRect(),h=new AbortController,d=e.combinedSignal(h);if(window.addEventListener("pointerup",p=>{h.abort(),e.toggleDrawing(!0),this._endDraw(p)},{signal:d}),window.addEventListener("pointerdown",di,{capture:!0,passive:!1,signal:d}),window.addEventListener("contextmenu",bi,{signal:d}),n.addEventListener("pointermove",this._drawMove.bind(this),{signal:d}),e.toggleDrawing(),t._editorUndoBar?.hide(),this._currentDraw){e.drawLayer.updateProperties(this._currentDrawId,this._currentDraw.startNew(r,a,l,c,o));return}t.updateUIForDefaultProperties(this),this._currentDraw=this.createDrawerInstance(r,a,l,c,o),this._currentDrawingOptions=this.getDefaultDrawingOptions(),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(this._currentDrawingOptions.toSVGProperties(),this._currentDraw.defaultSVGProperties),!0,!1)}static _drawMove({offsetX:e,offsetY:t}){this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._currentDraw.add(e,t))}static _endDraw({offsetX:e,offsetY:t}){const s=this._currentParent;if(s.drawLayer.updateProperties(this._currentDrawId,this._currentDraw.end(e,t)),this.supportMultipleDrawings){const n=this._currentDraw,r=this._currentDrawId,a=n.getLastElement();s.addCommands({cmd:()=>{s.drawLayer.updateProperties(r,n.setLastElement(a))},undo:()=>{s.drawLayer.updateProperties(r,n.removeLastElement())},mustExec:!1,type:Nt.DRAW_STEP});return}this.endDrawing(!1)}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack(Nt.DRAW_STEP),!this._currentDraw.isEmpty()){const{pageDimensions:[s,n],scale:r}=t,a=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:this._currentDraw.getOutlines(s*r,n*r,r,this._INNER_MARGIN),drawingOptions:this._currentDrawingOptions,mustBeCommitted:!e});return this._cleanup(),a}return t.drawLayer.remove(this._currentDrawId),this._cleanup(),null}static _cleanup(){this._currentDrawId=-1,this._currentDraw=null,this._currentDrawingOptions=null,this._currentParent=null}createDrawingOptions(e){}static deserializeDraw(e,t,s,n,r,a){Ht("Not implemented")}static async deserialize(e,t,s){const{rawDims:{pageWidth:n,pageHeight:r,pageX:a,pageY:o}}=t.viewport,l=this.deserializeDraw(a,o,n,r,this._INNER_MARGIN,e),c=await super.deserialize(e,t,s);return c.createDrawingOptions(e),c.#s({drawOutlines:l}),c.#i(),c.onScaleChanging(),c.rotate(),c}serializeDraw(e){const[t,s]=this.pageTranslation,[n,r]=this.pageDimensions;return this.#e.serialize([t,s,n,r],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class TS{#e=new Float64Array(6);#t;#s;#n;#r;#i;#c="";#o=0;#h=new Ku;#l;#u;constructor(e,t,s,n,r,a){this.#l=s,this.#u=n,this.#n=r,this.#r=a,[e,t]=this.#a(e,t);const o=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#i=[e,t],this.#s=[{line:o,points:this.#i}],this.#e.set(o,0)}updateProperty(e,t){e==="stroke-width"&&(this.#r=t)}#a(e,t){return $e._normalizePoint(e,t,this.#l,this.#u,this.#n)}isEmpty(){return!this.#s||this.#s.length===0}add(e,t){[e,t]=this.#a(e,t);const[s,n,r,a]=this.#e.subarray(2,6),o=e-r,l=t-a;return Math.hypot(this.#l*o,this.#u*l)<=2?null:(this.#i.push(e,t),isNaN(s)?(this.#e.set([r,a,e,t],2),this.#t.push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(this.#e[0])&&this.#t.splice(6,6),this.#e.set([s,n,r,a,e,t],0),this.#t.push(...$e.createBezierPoints(s,n,r,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const s=this.add(e,t);return s||(this.#i.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,s,n,r){this.#l=s,this.#u=n,this.#n=r,[e,t]=this.#a(e,t);const a=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#i=[e,t];const o=this.#s.at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),this.#s.push({line:a,points:this.#i}),this.#e.set(a,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#s.at(-1)}setLastElement(e){return this.#s?(this.#s.push(e),this.#t=e.line,this.#i=e.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#h.setLastElement(e)}removeLastElement(){if(!this.#s)return this.#h.removeLastElement();this.#s.pop(),this.#c="";for(let e=0,t=this.#s.length;e<t;e++){const{line:s,points:n}=this.#s[e];this.#t=s,this.#i=n,this.#o=0,this.toSVGPath()}return{path:{d:this.#c}}}toSVGPath(){const e=$e.svgRound(this.#t[4]),t=$e.svgRound(this.#t[5]);if(this.#i.length===2)return this.#c=`${this.#c} M ${e} ${t} Z`,this.#c;if(this.#i.length<=6){const n=this.#c.lastIndexOf("M");this.#c=`${this.#c.slice(0,n)} M ${e} ${t}`,this.#o=6}if(this.#i.length===4){const n=$e.svgRound(this.#t[10]),r=$e.svgRound(this.#t[11]);return this.#c=`${this.#c} L ${n} ${r}`,this.#o=12,this.#c}const s=[];this.#o===0&&(s.push(`M ${e} ${t}`),this.#o=6);for(let n=this.#o,r=this.#t.length;n<r;n+=6){const[a,o,l,c,h,d]=this.#t.slice(n,n+6).map($e.svgRound);s.push(`C${a} ${o} ${l} ${c} ${h} ${d}`)}return this.#c+=s.join(" "),this.#o=this.#t.length,this.#c}getOutlines(e,t,s,n){const r=this.#s.at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),this.#h.build(this.#s,e,t,s,this.#n,this.#r,n),this.#e=null,this.#t=null,this.#s=null,this.#c=null,this.#h}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class Ku extends $e{#e;#t=0;#s;#n;#r;#i;#c;#o;#h;build(e,t,s,n,r,a,o){this.#r=t,this.#i=s,this.#c=n,this.#o=r,this.#h=a,this.#s=o??0,this.#n=e,this.#a()}setLastElement(e){return this.#n.push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#n.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of this.#n){if(e.push(`M${$e.svgRound(t[4])} ${$e.svgRound(t[5])}`),t.length===6){e.push("Z");continue}if(t.length===12){e.push(`L${$e.svgRound(t[10])} ${$e.svgRound(t[11])}`);continue}for(let s=6,n=t.length;s<n;s+=6){const[r,a,o,l,c,h]=t.subarray(s,s+6).map($e.svgRound);e.push(`C${r} ${a} ${o} ${l} ${c} ${h}`)}}return e.join("")}serialize([e,t,s,n],r){const a=[],o=[],[l,c,h,d]=this.#u();let p,f,v,w,A,x,S,j,M;switch(this.#o){case 0:M=$e._rescale,p=e,f=t+n,v=s,w=-n,A=e+l*s,x=t+(1-c-d)*n,S=e+(l+h)*s,j=t+(1-c)*n;break;case 90:M=$e._rescaleAndSwap,p=e,f=t,v=s,w=n,A=e+c*s,x=t+l*n,S=e+(c+d)*s,j=t+(l+h)*n;break;case 180:M=$e._rescale,p=e+s,f=t,v=-s,w=n,A=e+(1-l-h)*s,x=t+c*n,S=e+(1-l)*s,j=t+(c+d)*n;break;case 270:M=$e._rescaleAndSwap,p=e+s,f=t+n,v=-s,w=-n,A=e+(1-c-d)*s,x=t+(1-l-h)*n,S=e+(1-c)*s,j=t+(1-l)*n;break}for(const{line:B,points:Q}of this.#n)a.push(M(B,p,f,v,w,r?new Array(B.length):null)),o.push(M(Q,p,f,v,w,r?new Array(Q.length):null));return{lines:a,points:o,rect:[A,x,S,j]}}static deserialize(e,t,s,n,r,{paths:{lines:a,points:o},rotation:l,thickness:c}){const h=[];let d,p,f,v,w;switch(l){case 0:w=$e._rescale,d=-e/s,p=t/n+1,f=1/s,v=-1/n;break;case 90:w=$e._rescaleAndSwap,d=-t/n,p=-e/s,f=1/n,v=1/s;break;case 180:w=$e._rescale,d=e/s+1,p=-t/n,f=-1/s,v=1/n;break;case 270:w=$e._rescaleAndSwap,d=t/n+1,p=e/s+1,f=-1/n,v=-1/s;break}if(!a){a=[];for(const x of o){const S=x.length;if(S===2){a.push(new Float32Array([NaN,NaN,NaN,NaN,x[0],x[1]]));continue}if(S===4){a.push(new Float32Array([NaN,NaN,NaN,NaN,x[0],x[1],NaN,NaN,NaN,NaN,x[2],x[3]]));continue}const j=new Float32Array(3*(S-2));a.push(j);let[M,B,Q,q]=x.subarray(0,4);j.set([NaN,NaN,NaN,NaN,M,B],0);for(let O=4;O<S;O+=2){const G=x[O],ie=x[O+1];j.set($e.createBezierPoints(M,B,Q,q,G,ie),(O-2)*3),[M,B,Q,q]=[Q,q,G,ie]}}}for(let x=0,S=a.length;x<S;x++)h.push({line:w(a[x].map(j=>j??NaN),d,p,f,v),points:w(o[x].map(j=>j??NaN),d,p,f,v)});const A=new Ku;return A.build(h,s,n,1,l,c,r),A}#l(e=this.#h){const t=this.#s+e/2*this.#c;return this.#o%180===0?[t/this.#r,t/this.#i]:[t/this.#i,t/this.#r]}#u(){const[e,t,s,n]=this.#e,[r,a]=this.#l(0);return[e+r,t+a,s-2*r,n-2*a]}#a(){const e=this.#e=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:n}of this.#n){if(n.length<=12){for(let o=4,l=n.length;o<l;o+=6){const[c,h]=n.subarray(o,o+2);e[0]=Math.min(e[0],c),e[1]=Math.min(e[1],h),e[2]=Math.max(e[2],c),e[3]=Math.max(e[3],h)}continue}let r=n[4],a=n[5];for(let o=6,l=n.length;o<l;o+=6){const[c,h,d,p,f,v]=n.subarray(o,o+6);He.bezierBoundingBox(r,a,c,h,d,p,f,v,e),r=f,a=v}}const[t,s]=this.#l();e[0]=Math.min(1,Math.max(0,e[0]-t)),e[1]=Math.min(1,Math.max(0,e[1]-s)),e[2]=Math.min(1,Math.max(0,e[2]+t)),e[3]=Math.min(1,Math.max(0,e[3]+s)),e[2]-=e[0],e[3]-=e[1]}get box(){return this.#e}updateProperty(e,t){return e==="stroke-width"?this.#d(t):null}#d(e){const[t,s]=this.#l();this.#h=e;const[n,r]=this.#l(),[a,o]=[n-t,r-s],l=this.#e;return l[0]-=a,l[1]-=o,l[2]+=2*a,l[3]+=2*o,l}updateParentDimensions([e,t],s){const[n,r]=this.#l();this.#r=e,this.#i=t,this.#c=s;const[a,o]=this.#l(),l=a-n,c=o-r,h=this.#e;return h[0]-=l,h[1]-=c,h[2]+=2*l,h[3]+=2*c,h}updateRotation(e){return this.#t=e,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#e.map($e.svgRound).join(" ")}get defaultProperties(){const[e,t]=this.#e;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${$e.svgRound(e)} ${$e.svgRound(t)}`}}}get rotationTransform(){const[,,e,t]=this.#e;let s=0,n=0,r=0,a=0,o=0,l=0;switch(this.#t){case 90:n=t/e,r=-e/t,o=e;break;case 180:s=-1,a=-1,o=e,l=t;break;case 270:n=-t/e,r=e/t,l=t;break;default:return""}return`matrix(${s} ${n} ${r} ${a} ${$e.svgRound(o)} ${$e.svgRound(l)})`}getPathResizingSVGProperties([e,t,s,n]){const[r,a]=this.#l(),[o,l,c,h]=this.#e;if(Math.abs(c-r)<=$e.PRECISION||Math.abs(h-a)<=$e.PRECISION){const w=e+s/2-(o+c/2),A=t+n/2-(l+h/2);return{path:{"transform-origin":`${$e.svgRound(e)} ${$e.svgRound(t)}`,transform:`${this.rotationTransform} translate(${w} ${A})`}}}const d=(s-2*r)/(c-2*r),p=(n-2*a)/(h-2*a),f=c/s,v=h/n;return{path:{"transform-origin":`${$e.svgRound(o)} ${$e.svgRound(l)}`,transform:`${this.rotationTransform} scale(${f} ${v}) translate(${$e.svgRound(r)} ${$e.svgRound(a)}) scale(${d} ${p}) translate(${$e.svgRound(-r)} ${$e.svgRound(-a)})`}}}getPathResizedSVGProperties([e,t,s,n]){const[r,a]=this.#l(),o=this.#e,[l,c,h,d]=o;if(o[0]=e,o[1]=t,o[2]=s,o[3]=n,Math.abs(h-r)<=$e.PRECISION||Math.abs(d-a)<=$e.PRECISION){const A=e+s/2-(l+h/2),x=t+n/2-(c+d/2);for(const{line:S,points:j}of this.#n)$e._translate(S,A,x,S),$e._translate(j,A,x,j);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${$e.svgRound(e)} ${$e.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const p=(s-2*r)/(h-2*r),f=(n-2*a)/(d-2*a),v=-p*(l+r)+e+r,w=-f*(c+a)+t+a;if(p!==1||f!==1||v!==0||w!==0)for(const{line:A,points:x}of this.#n)$e._rescale(A,v,w,p,f,A),$e._rescale(x,v,w,p,f,x);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${$e.svgRound(e)} ${$e.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,t],s){const[n,r]=s,a=this.#e,o=e-a[0],l=t-a[1];if(this.#r===n&&this.#i===r)for(const{line:c,points:h}of this.#n)$e._translate(c,o,l,c),$e._translate(h,o,l,h);else{const c=this.#r/n,h=this.#i/r;this.#r=n,this.#i=r;for(const{line:d,points:p}of this.#n)$e._rescale(d,o,l,c,h,d),$e._rescale(p,o,l,c,h,p);a[2]*=c,a[3]*=h}return a[0]=e,a[1]=t,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${$e.svgRound(e)} ${$e.svgRound(t)}`}}}get defaultSVGProperties(){const e=this.#e;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${$e.svgRound(e[0])} ${$e.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}class qp extends LS{#e;constructor(e){super(),this.#e=e,super.updateProperties({fill:"none",stroke:bt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??=this["stroke-width"],t*=this.#e.realScale),super.updateSVGProperty(e,t)}clone(){const e=new qp(this.#e);return e.updateAll(this),e}}class Up extends ma{static _type="ink";static _editorType=pt.INK;static _defaultDrawingOptions=null;constructor(e){super({...e,name:"inkEditor"}),this._willKeepAspectRatio=!0}static initialize(e,t){bt.initialize(e,t),this._defaultDrawingOptions=new qp(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return xt(this,"typesMap",new Map([[Nt.INK_THICKNESS,"stroke-width"],[Nt.INK_COLOR,"stroke"],[Nt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,s,n,r){return new TS(e,t,s,n,r,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,s,n,r,a){return Ku.deserialize(e,t,s,n,r,a)}static async deserialize(e,t,s){let n=null;if(e instanceof $p){const{data:{inkLists:a,rect:o,rotation:l,id:c,color:h,opacity:d,borderStyle:{rawWidth:p},popupRef:f},parent:{page:{pageNumber:v}}}=e;n=e={annotationType:pt.INK,color:Array.from(h),thickness:p,opacity:d,paths:{points:a},boxes:null,pageIndex:v-1,rect:o.slice(0),rotation:l,id:c,deleted:!1,popupRef:f}}const r=await super.deserialize(e,t,s);return r.annotationElementId=e.id||null,r._initialData=n,r}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:s}=this;t.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:t,opacity:s}){this._drawingOptions=Up.getDefaultDrawingOptions({stroke:He.makeHexColor(...e),"stroke-width":t,"stroke-opacity":s})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:s,rect:n}=this.serializeDraw(e),{_drawingOptions:{stroke:r,"stroke-opacity":a,"stroke-width":o}}=this,l={annotationType:pt.INK,color:bt._colorManager.convert(r),opacity:a,thickness:o,paths:{lines:t,points:s},pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?l:this.annotationElementId&&!this.#e(l)?null:(l.id=this.annotationElementId,l)}#e(e){const{color:t,thickness:s,opacity:n,pageIndex:r}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||e.color.some((a,o)=>a!==t[o])||e.thickness!==s||e.opacity!==n||e.pageIndex!==r}renderAnnotationElement(e){const{points:t,rect:s}=this.serializeDraw(!1);return e.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:t}),null}}class zp extends bt{#e=null;#t=null;#s=null;#n=null;#r=null;#i="";#c=null;#o=null;#h=null;#l=!1;#u=!1;static _type="stamp";static _editorType=pt.STAMP;constructor(e){super({...e,name:"stampEditor"}),this.#n=e.bitmapUrl,this.#r=e.bitmapFile}static initialize(e,t){bt.initialize(e,t)}static get supportedTypes(){return xt(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(t=>`image/${t}`))}static get supportedTypesStr(){return xt(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,t){t.pasteEditor(pt.STAMP,{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){const t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#a(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#l=e.isSvg),e.file&&(this.#i=e.file.name),this.#p()}#d(){if(this.#s=null,this._uiManager.enableWaiting(!1),!!this.#c){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(e=null,t=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:n,width:r,height:a}=e||this.copyCanvas(null,null,!0).imageData,o=await s.guess({name:"altText",request:{data:n,width:r,height:a,channels:n.length/(r*a)}});if(!o)throw new Error("No response from the AI service.");if(o.error)throw new Error("Error from the AI service.");if(o.cancel)return null;if(!o.output)throw new Error("No valid response from the AI service.");const l=o.output;return await this.setGuessedAltText(l),t&&!this.hasAltTextData()&&(this.altTextData={alt:l,decorative:!1}),l}#f(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(s=>this.#a(s,!0)).finally(()=>this.#d());return}if(this.#n){const s=this.#n;this.#n=null,this._uiManager.enableWaiting(!0),this.#s=this._uiManager.imageManager.getFromUrl(s).then(n=>this.#a(n)).finally(()=>this.#d());return}if(this.#r){const s=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#s=this._uiManager.imageManager.getFromFile(s).then(n=>this.#a(n)).finally(()=>this.#d());return}const e=document.createElement("input");e.type="file",e.accept=zp.supportedTypesStr;const t=this._uiManager._signal;this.#s=new Promise(s=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const n=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#a(n)}s()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),s()},{signal:t})}).finally(()=>this.#d()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#c?.remove(),this.#c=null,this.#o?.disconnect(),this.#o=null,this.#h&&(clearTimeout(this.#h),this.#h=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#f();return}super.rebuild(),this.div!==null&&(this.#t&&this.#c===null&&this.#f(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(this.#s||this.#e||this.#n||this.#r||this.#t)}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;if(this.width&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),this.#e?this.#p():this.#f(),this.width&&!this.annotationElementId){const[s,n]=this.parentDimensions;this.setAt(e*s,t*n,this.width*s,this.height*n)}return this.div}#p(){const{div:e}=this;let{width:t,height:s}=this.#e;const[n,r]=this.pageDimensions,a=.75;if(this.width)t=this.width*n,s=this.height*r;else if(t>a*n||s>a*r){const h=Math.min(a*n/t,a*r/s);t*=h,s*=h}const[o,l]=this.parentDimensions;this.setDims(t*o/n,s*l/r),this._uiManager.enableWaiting(!1);const c=this.#c=document.createElement("canvas");c.setAttribute("role","img"),this.addContainer(c),(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#b(t,s),this.#w(),this.#u||(this.parent.addUndoableEditor(this),this.#u=!0),this._reportTelemetry({action:"inserted_image"}),this.#i&&c.setAttribute("aria-label",this.#i)}copyCanvas(e,t,s=!1){e||(e=224);const{width:n,height:r}=this.#e,a=new Df;let o=this.#e,l=n,c=r,h=null;if(t){if(n>t||r>t){const Q=Math.min(t/n,t/r);l=Math.floor(n*Q),c=Math.floor(r*Q)}h=document.createElement("canvas");const p=h.width=Math.ceil(l*a.sx),f=h.height=Math.ceil(c*a.sy);this.#l||(o=this.#m(p,f));const v=h.getContext("2d");v.filter=this._uiManager.hcmFilter;let w="white",A="#cfcfd8";this._uiManager.hcmFilter!=="none"?A="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(w="#8f8f9d",A="#42414d");const x=15,S=x*a.sx,j=x*a.sy,M=new OffscreenCanvas(S*2,j*2),B=M.getContext("2d");B.fillStyle=w,B.fillRect(0,0,S*2,j*2),B.fillStyle=A,B.fillRect(0,0,S,j),B.fillRect(S,j,S,j),v.fillStyle=v.createPattern(M,"repeat"),v.fillRect(0,0,p,f),v.drawImage(o,0,0,o.width,o.height,0,0,p,f)}let d=null;if(s){let p,f;if(a.symmetric&&o.width<e&&o.height<e)p=o.width,f=o.height;else if(o=this.#e,n>e||r>e){const A=Math.min(e/n,e/r);p=Math.floor(n*A),f=Math.floor(r*A),this.#l||(o=this.#m(p,f))}const w=new OffscreenCanvas(p,f).getContext("2d",{willReadFrequently:!0});w.drawImage(o,0,0,o.width,o.height,0,0,p,f),d={width:p,height:f,data:w.getImageData(0,0,p,f).data}}return{canvas:h,width:l,height:c,imageData:d}}#g(e,t){const[s,n]=this.parentDimensions;this.width=e/s,this.height=t/n,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this.#h!==null&&clearTimeout(this.#h);const r=200;this.#h=setTimeout(()=>{this.#h=null,this.#b(e,t)},r)}#m(e,t){const{width:s,height:n}=this.#e;let r=s,a=n,o=this.#e;for(;r>2*e||a>2*t;){const l=r,c=a;r>2*e&&(r=r>=16384?Math.floor(r/2)-1:Math.ceil(r/2)),a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const h=new OffscreenCanvas(r,a);h.getContext("2d").drawImage(o,0,0,l,c,0,0,r,a),o=h.transferToImageBitmap()}return o}#b(e,t){const s=new Df,n=Math.ceil(e*s.sx),r=Math.ceil(t*s.sy),a=this.#c;if(!a||a.width===n&&a.height===r)return;a.width=n,a.height=r;const o=this.#l?this.#e:this.#m(n,r),l=a.getContext("2d");l.filter=this._uiManager.hcmFilter,l.drawImage(o,0,0,o.width,o.height,0,0,n,r)}getImageForAltText(){return this.#c}#y(e){if(e){if(this.#l){const n=this._uiManager.imageManager.getSvgUrl(this.#t);if(n)return n}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#l){const[t,s]=this.pageDimensions,n=Math.round(this.width*t*qo.PDF_TO_CSS_UNITS),r=Math.round(this.height*s*qo.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(n,r);return a.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,n,r),a.transferToImageBitmap()}return structuredClone(this.#e)}#w(){this._uiManager._signal&&(this.#o=new ResizeObserver(e=>{const t=e[0].contentRect;t.width&&t.height&&this.#g(t.width,t.height)}),this.#o.observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{this.#o?.disconnect(),this.#o=null},{once:!0}))}static async deserialize(e,t,s){let n=null;if(e instanceof W1){const{data:{rect:v,rotation:w,id:A,structParent:x,popupRef:S},container:j,parent:{page:{pageNumber:M}}}=e,B=j.querySelector("canvas"),Q=s.imageManager.getFromCanvas(j.id,B);B.remove();const q=(await t._structTree.getAriaAttributes(`${Pp}${A}`))?.get("aria-label")||"";n=e={annotationType:pt.STAMP,bitmapId:Q.id,bitmap:Q.bitmap,pageIndex:M-1,rect:v.slice(0),rotation:w,id:A,deleted:!1,accessibilityData:{decorative:!1,altText:q},isSvg:!1,structParent:x,popupRef:S}}const r=await super.deserialize(e,t,s),{rect:a,bitmap:o,bitmapUrl:l,bitmapId:c,isSvg:h,accessibilityData:d}=e;c&&s.imageManager.isValidId(c)?(r.#t=c,o&&(r.#e=o)):r.#n=l,r.#l=h;const[p,f]=r.pageDimensions;return r.width=(a[2]-a[0])/p,r.height=(a[3]-a[1])/f,r.annotationElementId=e.id||null,d&&(r.altTextData=d),r._initialData=n,r.#u=!!n,r}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s={annotationType:pt.STAMP,bitmapId:this.#t,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#l,structTreeParentId:this._structTreeParentId};if(e)return s.bitmapUrl=this.#y(!0),s.accessibilityData=this.serializeAltText(!0),s;const{decorative:n,altText:r}=this.serializeAltText(!1);if(!n&&r&&(s.accessibilityData={type:"Figure",alt:r}),this.annotationElementId){const o=this.#x(s);if(o.isSame)return null;o.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1}if(s.id=this.annotationElementId,t===null)return s;t.stamps||=new Map;const a=this.#l?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:a,serialized:s}),s.bitmap=this.#y(!1);else if(this.#l){const o=t.stamps.get(this.#t);a>o.area&&(o.area=a,o.serialized.bitmap.close(),o.serialized.bitmap=this.#y(!1))}return s}#x(e){const{pageIndex:t,accessibilityData:{altText:s}}=this._initialData,n=e.pageIndex===t,r=(e.accessibilityData?.alt||"")===s;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&n&&r,isSameAltText:r}}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}}class ur{#e;#t=!1;#s=null;#n=null;#r=null;#i=new Map;#c=!1;#o=!1;#h=null;#l=null;#u=null;#a;static _initialized=!1;static#d=new Map([ks,Up,zp,ds].map(e=>[e._editorType,e]));constructor({uiManager:e,pageIndex:t,div:s,structTreeLayer:n,accessibilityManager:r,annotationLayer:a,drawLayer:o,textLayer:l,viewport:c,l10n:h}){const d=[...ur.#d.values()];if(!ur._initialized){ur._initialized=!0;for(const p of d)p.initialize(h,e)}e.registerEditorTypes(d),this.#a=e,this.pageIndex=t,this.div=s,this.#e=r,this.#s=a,this.viewport=c,this.#l=l,this.drawLayer=o,this._structTree=n,this.#a.addLayer(this)}get isEmpty(){return this.#i.size===0}get isInvisible(){return this.isEmpty&&this.#a.getMode()===pt.NONE}updateToolbar(e){this.#a.updateToolbar(e)}updateMode(e=this.#a.getMode()){switch(this.#b(),e){case pt.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case pt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case pt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const s of ur.#d.values())t.toggle(`${s._type}Editing`,e===s._editorType);this.div.hidden=!1}hasTextLayer(e){return e===this.#l?.div}setEditingState(e){this.#a.setEditingState(e)}addCommands(e){this.#a.addCommands(e)}cleanUndoStack(e){this.#a.cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){this.#s?.div.classList.toggle("disabled",!e)}async enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const s of this.#i.values())s.enableEditing(),s.show(!0),s.annotationElementId&&(this.#a.removeChangedExistingAnnotation(s),e.add(s.annotationElementId));if(!this.#s)return;const t=this.#s.getEditableAnnotations();for(const s of t){if(s.hide(),this.#a.isDeletedAnnotationElement(s.data.id)||e.has(s.data.id))continue;const n=await this.deserialize(s);n&&(this.addOrRebuild(n),n.enableEditing())}}disable(){this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const n of this.#i.values())if(n.disableEditing(),!!n.annotationElementId){if(n.serialize()!==null){e.set(n.annotationElementId,n);continue}else t.set(n.annotationElementId,n);this.getEditableAnnotation(n.annotationElementId)?.show(),n.remove()}if(this.#s){const n=this.#s.getEditableAnnotations();for(const r of n){const{id:a}=r.data;if(this.#a.isDeletedAnnotationElement(a))continue;let o=t.get(a);if(o){o.resetAnnotationElement(r),o.show(!1),r.show();continue}o=e.get(a),o&&(this.#a.addChangedExistingAnnotation(o),o.renderAnnotationElement(r)&&o.show(!1)),r.show()}}this.#b(),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const n of ur.#d.values())s.remove(`${n._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#o=!1}getEditableAnnotation(e){return this.#s?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#a.getActive()!==e&&this.#a.setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,this.#l?.div&&!this.#u){this.#u=new AbortController;const e=this.#a.combinedSignal(this.#u);this.#l.div.addEventListener("pointerdown",this.#f.bind(this),{signal:e}),this.#l.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#l?.div&&this.#u&&(this.#u.abort(),this.#u=null,this.#l.div.classList.remove("highlighting"))}#f(e){this.#a.unselectAll();const{target:t}=e;if(t===this.#l.div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&this.#l.div.contains(t)){const{isMac:s}=ln.platform;if(e.button!==0||e.ctrlKey&&s)return;this.#a.showAllEditors("highlight",!0,!0),this.#l.div.classList.add("free"),this.toggleDrawing(),ds.startHighlighting(this,this.#a.direction==="ltr",{target:this.#l.div,x:e.x,y:e.y}),this.#l.div.addEventListener("pointerup",()=>{this.#l.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#a._signal}),e.preventDefault()}}enableClick(){if(this.#n)return;this.#n=new AbortController;const e=this.#a.combinedSignal(this.#n);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e}),this.div.addEventListener("pointerup",this.pointerup.bind(this),{signal:e})}disableClick(){this.#n?.abort(),this.#n=null}attach(e){this.#i.set(e.id,e);const{annotationElementId:t}=e;t&&this.#a.isDeletedAnnotationElement(t)&&this.#a.removeDeletedAnnotationElement(e)}detach(e){this.#i.delete(e.id),this.#e?.removePointerInTextLayer(e.contentDiv),!this.#o&&e.annotationElementId&&this.#a.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#a.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(this.#a.addDeletedAnnotationElement(e.annotationElementId),bt.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),this.#a.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(),this.#a.addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!this.#r&&(e._focusEventsAllowed=!1,this.#r=setTimeout(()=>{this.#r=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this.#a._signal}),t.focus())},0)),e._structTreeParentId=this.#e?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),s=()=>{e.remove()};this.addCommands({cmd:t,undo:s,mustExec:!1})}getNextId(){return this.#a.getId()}get#p(){return ur.#d.get(this.#a.getMode())}combinedSignal(e){return this.#a.combinedSignal(e)}#g(e){const t=this.#p;return t?new t.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#p?.canCreateNewEmptyEditor()}pasteEditor(e,t){this.#a.updateToolbar(e),this.#a.updateMode(e);const{offsetX:s,offsetY:n}=this.#m(),r=this.getNextId(),a=this.#g({parent:this,id:r,x:s,y:n,uiManager:this.#a,isCentered:!0,...t});a&&this.add(a)}async deserialize(e){return await ur.#d.get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,this.#a)||null}createAndAddNewEditor(e,t,s={}){const n=this.getNextId(),r=this.#g({parent:this,id:n,x:e.offsetX,y:e.offsetY,uiManager:this.#a,isCentered:t,...s});return r&&this.add(r),r}#m(){const{x:e,y:t,width:s,height:n}=this.div.getBoundingClientRect(),r=Math.max(0,e),a=Math.max(0,t),o=Math.min(window.innerWidth,e+s),l=Math.min(window.innerHeight,t+n),c=(r+o)/2-e,h=(a+l)/2-t,[d,p]=this.viewport.rotation%180===0?[c,h]:[h,c];return{offsetX:d,offsetY:p}}addNewEditor(){this.createAndAddNewEditor(this.#m(),!0)}setSelected(e){this.#a.setSelected(e)}toggleSelected(e){this.#a.toggleSelected(e)}unselect(e){this.#a.unselect(e)}pointerup(e){const{isMac:t}=ln.platform;if(!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&this.#c&&(this.#c=!1,!(this.#p?.isDrawer&&this.#p.supportMultipleDrawings))){if(!this.#t){this.#t=!0;return}if(this.#a.getMode()===pt.STAMP){this.#a.unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){if(this.#a.getMode()===pt.HIGHLIGHT&&this.enableTextSelection(),this.#c){this.#c=!1;return}const{isMac:t}=ln.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(this.#c=!0,this.#p?.isDrawer){this.startDrawingSession(e);return}const s=this.#a.getActive();this.#t=!s||s.isEmpty()}startDrawingSession(e){if(this.div.focus(),this.#h){this.#p.startDrawing(this,this.#a,!1,e);return}this.#a.setCurrentDrawingSession(this),this.#h=new AbortController;const t=this.#a.combinedSignal(this.#h);this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&this.commitOrRemove()},{signal:t}),this.#p.startDrawing(this,this.#a,!1,e)}endDrawingSession(e=!1){return this.#h?(this.#a.setCurrentDrawingSession(null),this.#h.abort(),this.#h=null,this.#p.endDrawing(e)):null}findNewParent(e,t,s){const n=this.#a.findParent(t,s);return n===null||n===this?!1:(n.changeParent(e),!0)}commitOrRemove(){return this.#h?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#h&&this.#p.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#a.getActive()?.parent===this&&(this.#a.commitOrRemove(),this.#a.setActiveEditor(null)),this.#r&&(clearTimeout(this.#r),this.#r=null);for(const e of this.#i.values())this.#e?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#i.clear(),this.#a.removeLayer(this)}#b(){for(const e of this.#i.values())e.isEmpty()&&e.remove()}render({viewport:e}){this.viewport=e,Aa(this.div,e);for(const t of this.#a.getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){this.#a.commitOrRemove(),this.#b();const t=this.viewport.rotation,s=e.rotation;if(this.viewport=e,Aa(this.div,{rotation:s}),t!==s)for(const n of this.#i.values())n.rotate(s)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return this.#a.viewParameters.realScale}}class rn{#e=null;#t=0;#s=new Map;#n=new Map;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#s.size>0)for(const t of this.#s.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return xt(this,"_svgFactory",new Bp)}static#r(e,[t,s,n,r]){const{style:a}=e;a.top=`${100*s}%`,a.left=`${100*t}%`,a.width=`${100*n}%`,a.height=`${100*r}%`}#i(){const e=rn._svgFactory.create(1,1,!0);return this.#e.append(e),e.setAttribute("aria-hidden",!0),e}#c(e,t){const s=rn._svgFactory.createElement("clipPath");e.append(s);const n=`clip_${t}`;s.setAttribute("id",n),s.setAttribute("clipPathUnits","objectBoundingBox");const r=rn._svgFactory.createElement("use");return s.append(r),r.setAttribute("href",`#${t}`),r.classList.add("clip"),n}#o(e,t){for(const[s,n]of Object.entries(t))n===null?e.removeAttribute(s):e.setAttribute(s,n)}draw(e,t=!1,s=!1){const n=this.#t++,r=this.#i(),a=rn._svgFactory.createElement("defs");r.append(a);const o=rn._svgFactory.createElement("path");a.append(o);const l=`path_p${this.pageIndex}_${n}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke"),t&&this.#n.set(n,o);const c=s?this.#c(a,l):null,h=rn._svgFactory.createElement("use");return r.append(h),h.setAttribute("href",`#${l}`),this.updateProperties(r,e),this.#s.set(n,r),{id:n,clipPathId:`url(#${c})`}}drawOutline(e,t){const s=this.#t++,n=this.#i(),r=rn._svgFactory.createElement("defs");n.append(r);const a=rn._svgFactory.createElement("path");r.append(a);const o=`path_p${this.pageIndex}_${s}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const d=rn._svgFactory.createElement("mask");r.append(d),l=`mask_p${this.pageIndex}_${s}`,d.setAttribute("id",l),d.setAttribute("maskUnits","objectBoundingBox");const p=rn._svgFactory.createElement("rect");d.append(p),p.setAttribute("width","1"),p.setAttribute("height","1"),p.setAttribute("fill","white");const f=rn._svgFactory.createElement("use");d.append(f),f.setAttribute("href",`#${o}`),f.setAttribute("stroke","none"),f.setAttribute("fill","black"),f.setAttribute("fill-rule","nonzero"),f.classList.add("mask")}const c=rn._svgFactory.createElement("use");n.append(c),c.setAttribute("href",`#${o}`),l&&c.setAttribute("mask",`url(#${l})`);const h=c.cloneNode();return n.append(h),c.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(n,e),this.#s.set(s,n),s}finalizeDraw(e,t){this.#n.delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:s,bbox:n,rootClass:r,path:a}=t,o=typeof e=="number"?this.#s.get(e):e;if(o){if(s&&this.#o(o,s),n&&rn.#r(o,n),r){const{classList:l}=o;for(const[c,h]of Object.entries(r))l.toggle(c,h)}if(a){const c=o.firstChild.firstChild;this.#o(c,a)}}}updateParent(e,t){if(t===this)return;const s=this.#s.get(e);s&&(t.#e.append(s),this.#s.delete(e),t.#s.set(e,s))}remove(e){this.#n.delete(e),this.#e!==null&&(this.#s.get(e).remove(),this.#s.delete(e))}destroy(){this.#e=null;for(const e of this.#s.values())e.remove();this.#s.clear(),this.#n.clear()}}globalThis.pdfjsTestingUtils={HighlightOutliner:Uf};nt.AbortException;nt.AnnotationEditorLayer;nt.AnnotationEditorParamsType;nt.AnnotationEditorType;nt.AnnotationEditorUIManager;nt.AnnotationLayer;nt.AnnotationMode;nt.ColorPicker;nt.DOMSVGFactory;nt.DrawLayer;nt.FeatureTest;var jS=nt.GlobalWorkerOptions;nt.ImageKind;nt.InvalidPDFException;nt.MissingPDFException;nt.OPS;nt.OutputScale;nt.PDFDataRangeTransport;nt.PDFDateString;nt.PDFWorker;nt.PasswordResponses;nt.PermissionFlag;nt.PixelsPerInch;nt.RenderingCancelledException;nt.TextLayer;nt.UnexpectedResponseException;nt.Util;nt.VerbosityLevel;nt.XfaLayer;nt.build;nt.createValidAbsoluteUrl;nt.fetchData;var IS=nt.getDocument;nt.getFilenameFromUrl;nt.getPdfFilenameFromUrl;nt.getXfaPageViewport;nt.isDataScheme;nt.isPdfFile;nt.noContextMenu;nt.normalizeUnicode;nt.setLayerDimensions;nt.shadow;nt.stopEvent;nt.version;jS.workerSrc="/pdfjs/pdf.worker.js";function G1({onFileSelect:i,onTextExtracted:e,onTitleExtracted:t,accept:s=".pdf",label:n,type:r}){const a=V.useRef(null),[o,l]=V.useState(!1),[c,h]=V.useState(null),d=f=>{const v=f.split(`
`).map(w=>w.trim()).filter(Boolean);if(r==="cv")return(v[0]||"").split(" ").slice(0,3).join(" ");{const w=/position|job title|role/i,A=v.find(x=>w.test(x));return A?A.replace(/(position|job title|role)[:|\s]+/i,"").trim():v[0]||""}},p=async f=>{const v=f.target.files?.[0];if(v)try{l(!0),h(null),i(v);const w=await v.arrayBuffer(),x=await IS({data:w}).promise;let S="";for(let B=1;B<=x.numPages;B++){const O=(await(await x.getPage(B)).getTextContent()).items.map(G=>G.str).join(" ");S+=O+`
`}const j=S.trim(),M=d(j);e(j),t&&t(M)}catch(w){console.error("Error reading PDF:",w),h("Failed to process PDF. Please try again.")}finally{l(!1)}};return g.jsx("div",{className:"mt-2",children:g.jsx("div",{onClick:()=>a.current?.click(),className:"flex justify-center rounded-lg border border-dashed border-gray-300 px-6 py-10 cursor-pointer hover:border-gray-400",children:g.jsxs("div",{className:"text-center",children:[g.jsx(D0,{className:"mx-auto h-12 w-12 text-gray-400"}),g.jsxs("div",{className:"mt-4 flex text-sm leading-6 text-gray-600",children:[g.jsxs("label",{className:"relative cursor-pointer rounded-md bg-white font-semibold text-blue-600 focus-within:outline-none focus-within:ring-2 focus-within:ring-blue-600 focus-within:ring-offset-2 hover:text-blue-500",children:[g.jsx("span",{children:o?"Processing...":"Upload a file"}),g.jsx("input",{ref:a,type:"file",className:"sr-only",accept:s,onChange:p,disabled:o})]}),g.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),g.jsx("p",{className:"text-xs leading-5 text-gray-600",children:n}),c&&g.jsx("p",{className:"text-xs text-red-600 mt-2",children:c})]})})})}function RS({candidateName:i,cvText:e,onNameChange:t,onCvTextChange:s,errors:n={}}){const{candidates:r=[]}=kp(),a=l=>{hc(l,e,r)||t(l)},o=l=>{hc(i,l,r)||s(l)};return g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center space-x-2",children:[g.jsx("h2",{className:"text-lg font-semibold",children:"Candidate Information"}),g.jsx("div",{className:"h-6 w-6 rounded-full bg-blue-100 flex items-center justify-center",children:g.jsx("span",{className:"text-blue-600 text-sm",children:"1"})})]}),g.jsx(j_,{onSelect:({name:l,cvText:c})=>{t(l),s(c)}})]}),g.jsx(wa,{id:"candidateName",label:"Candidate Name",value:i,onChange:l=>a(l.target.value),error:n.name,placeholder:"Enter candidate's full name",required:!0}),g.jsx(G1,{type:"cv",onFileSelect:()=>{},onTextExtracted:l=>o(l),onTitleExtracted:l=>a(l),label:"Upload CV (PDF)"}),g.jsx(Ep,{id:"cvText",label:"CV Text",value:e,onChange:l=>o(l.target.value),error:n.cvText,placeholder:"Paste the candidate's CV content here or upload a PDF above",required:!0})]})}async function OS(i,e,t=""){try{const{data:{user:s}}=await ut.auth.getUser();if(!s)throw new Error("Not authenticated");const{data:n,error:r}=await ut.from("jobs").insert([{title:i,jd_text:e,company:t,user_id:s.id}]).select().single();if(r)throw console.error("Upload error:",r),r;return n}catch(s){throw console.error("Upload job error:",s),new Error(`Failed to upload job: ${s instanceof Error?s.message:"Unknown error"}`)}}async function MS(){try{const{data:{user:i}}=await ut.auth.getUser();if(!i)throw new Error("Not authenticated");const{data:e,error:t}=await ut.from("jobs").select("id, title, jd_text, company, created_at").eq("user_id",i.id).order("created_at",{ascending:!1});if(t)throw t;return e||[]}catch(i){throw console.error("Get jobs error:",i),new Error("Failed to fetch jobs")}}function Hp(){const{data:i,isLoading:e,error:t,refetch:s}=Tc(MS);return{jobs:i||[],isLoading:e,error:t,refetch:s}}function FS({onSelect:i}){const{jobs:e,isLoading:t}=Hp(),[s,n]=V.useState(!1),r=V.useRef(null);u1(r,()=>n(!1));const a=e.reduce((o,l)=>{const c=o.findIndex(h=>uc(l.title,l.jd_text,[h]));return c>=0?(o[c].duplicateCount+=1,o[c].lastSubmitted=new Date(Math.max(new Date(o[c].lastSubmitted).getTime(),new Date(l.created_at).getTime())).toISOString()):o.push({...l,duplicateCount:1,lastSubmitted:l.created_at}),o},[]);return t?g.jsx(mr,{size:"sm"}):e.length?g.jsxs("div",{className:"relative",ref:r,children:[g.jsxs("button",{type:"button",onClick:()=>n(!s),"data-action":"select-job",className:"inline-flex items-center px-3 py-1.5 text-sm font-medium text-blue-600 hover:text-blue-700 bg-blue-50 hover:bg-blue-100 rounded-md transition-colors",children:[g.jsx("span",{children:"Previous Jobs"}),g.jsx(Vo,{className:"ml-1 h-4 w-4"})]}),s&&g.jsx("div",{className:"absolute right-0 z-10 mt-2 w-96 rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5",children:g.jsx("div",{className:"max-h-60 overflow-auto py-1",children:a.map(o=>g.jsxs("button",{onClick:()=>{i({title:o.title,description:o.jd_text}),n(!1)},className:"w-full px-4 py-3 text-left hover:bg-gray-50 transition-colors border-b border-gray-100 last:border-0",children:[g.jsxs("div",{className:"flex justify-between items-start",children:[g.jsx("p",{className:"font-medium text-gray-900",children:o.title}),o.duplicateCount>1&&g.jsxs("span",{className:"text-xs px-2 py-1 bg-blue-50 text-blue-600 rounded-full",children:["Submitted ",o.duplicateCount," times"]})]}),g.jsx("p",{className:"text-sm text-gray-500 mt-1 line-clamp-2",children:o.jd_text})]},o.id))})})]}):null}function DS({jobTitle:i,jobDescription:e,onTitleChange:t,onDescriptionChange:s,errors:n={}}){const{jobs:r=[]}=Hp(),a=l=>{uc(l,e,r)||t(l)},o=l=>{uc(i,l,r)||s(l)};return g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center space-x-2",children:[g.jsx("h2",{className:"text-lg font-semibold",children:"Job Information"}),g.jsx("div",{className:"h-6 w-6 rounded-full bg-blue-100 flex items-center justify-center",children:g.jsx("span",{className:"text-blue-600 text-sm",children:"2"})})]}),g.jsx(FS,{onSelect:({title:l,description:c})=>{t(l),s(c)}})]}),g.jsx(wa,{id:"jobTitle",label:"Job Title",value:i,onChange:l=>a(l.target.value),error:n.title,placeholder:"Enter the job position title",required:!0}),g.jsx(G1,{type:"job",onFileSelect:()=>{},onTextExtracted:l=>o(l),onTitleExtracted:l=>a(l),label:"Upload Job Description (PDF)"}),g.jsx(Ep,{id:"jobDescription",label:"Job Description",value:e,onChange:l=>o(l.target.value),error:n.description,placeholder:"Paste the job description here or upload a PDF above",required:!0})]})}function BS({score:i,verdict:e}){const t=()=>{switch(e){case"STRONG_FIT":return"text-green-600 bg-green-50 border-green-200";case"POTENTIAL_FIT":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"NEEDS_CONSIDERATION":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"NOT_RECOMMENDED":return"text-red-600 bg-red-50 border-red-200"}},s=()=>{switch(e){case"STRONG_FIT":return"Strong Match";case"POTENTIAL_FIT":return"Potential Match";case"NEEDS_CONSIDERATION":return"Potential Match";case"NOT_RECOMMENDED":return"Not Suitable"}};return g.jsxs("div",{className:`p-6 rounded-lg border ${t()}`,children:[g.jsx("h3",{className:"font-semibold mb-4",children:"Match Score"}),g.jsxs("div",{className:"flex items-baseline space-x-2",children:[g.jsx("span",{className:"text-5xl font-bold",children:i}),g.jsx("span",{className:"text-2xl",children:"/10"})]}),g.jsx("p",{className:"mt-2 text-sm font-medium",children:s()})]})}function $S({analysis:i}){const e=s=>{const n=r=>r>=90?"EXPERT":r>=80?"ADVANCED":r>=60?"INTERMEDIATE":r>=40?"BASIC":"BEGINNER";return{skill:s.name,proficiency:n(parseInt(s.proficiency,10)),evidence:s.assessment,currency:s.currency}},t=(i.technical_skills||[]).map(s=>"skill"in s&&"evidence"in s&&"currency"in s?s:e(s));return t.length?g.jsx("div",{className:"space-y-6",children:t.map((s,n)=>g.jsx("div",{className:"border rounded-lg p-4",children:g.jsxs("div",{className:"space-y-3",children:[g.jsxs("div",{className:"flex items-start justify-between",children:[g.jsx("div",{children:g.jsxs("h4",{className:"font-medium text-gray-900",children:["Skill: ",s.skill]})}),g.jsxs("div",{className:"flex items-center space-x-2",children:[g.jsx("span",{className:"text-sm text-gray-600",children:"Proficiency:"}),g.jsx("span",{className:"font-medium text-blue-600",children:s.proficiency})]})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex items-start",children:[g.jsx("span",{className:"text-gray-600 mr-2",children:"â€¢"}),g.jsxs("div",{children:[g.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"Evidence: "}),g.jsx("span",{className:"text-sm text-gray-600",children:s.evidence})]})]}),g.jsxs("div",{className:"flex items-start",children:[g.jsx("span",{className:"text-gray-600 mr-2",children:"â€¢"}),g.jsxs("div",{children:[g.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"Experience: "}),g.jsx("span",{className:"text-sm text-gray-600",children:s.currency})]})]})]})]})},n))}):g.jsx("p",{className:"text-sm text-gray-500 italic",children:"Technical skills analysis not available"})}function qS({factors:i=[]}){if(!i?.length)return g.jsx("div",{className:"text-sm text-gray-500 italic",children:g.jsx("p",{children:"No significant risk factors identified"})});const e=i.map(s=>{if(typeof s=="string"){const n=s.replace(/^RISK_FACTORS:\s*/i,"").trim(),r=/^-\s*Severity:\s*\[?(HIGH|MEDIUM|LOW)\]?\s*\n\s*\*\s*Description:\s*\[?([^\n\]]+)\]?\s*\n\s*\*\s*Mitigation:\s*\[?([^\n\]]+)\]?/im,a=n.match(r);if(a){const[,h,d,p]=a;return{severity:h.toUpperCase(),description:d.trim(),mitigation:p.trim()}}const o=n.match(/Severity:\s*\[?(HIGH|MEDIUM|LOW)\]?/i),l=n.match(/Description:\s*\[?([^\n\]]+)\]?/i),c=n.match(/Mitigation:\s*\[?([^\n\]]+)\]?/i);if(o)return{severity:o[1].toUpperCase(),description:l?.[1]?.trim()||n,mitigation:c?.[1]?.trim()};try{const h=JSON.parse(n);if(h&&typeof h=="object")return{severity:(h.severity||"MEDIUM").toUpperCase(),description:h.description||"",mitigation:h.mitigation||""}}catch{}return{severity:"MEDIUM",description:n}}return s}),t=s=>{switch(s){case"HIGH":return"text-red-500";case"MEDIUM":return"text-amber-500";case"LOW":return"text-yellow-500";default:return"text-amber-500"}};return g.jsx("div",{className:"space-y-4",children:e.map((s,n)=>g.jsx("div",{className:"rounded-lg bg-gray-50 p-4",children:g.jsxs("div",{className:"flex items-start space-x-3",children:[g.jsx(dv,{className:`h-5 w-5 flex-shrink-0 mt-0.5 ${t(s.severity)}`}),g.jsxs("div",{className:"flex-1",children:[g.jsx("div",{className:"flex items-center space-x-2",children:g.jsx("span",{className:`text-xs font-medium ${t(s.severity)}`,children:s.severity})}),g.jsx("p",{className:"mt-1 text-sm text-gray-700",children:s.description}),s.mitigation&&g.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:[g.jsx("span",{className:"font-medium",children:"Mitigation: "}),s.mitigation]})]})]})},n))})}function US({potential:i}){return i?g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{children:[g.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Growth Areas"}),g.jsx("div",{className:"space-y-2",children:i.areas.map((e,t)=>g.jsxs("div",{className:"flex items-start space-x-3",children:[g.jsx(zy,{className:"h-5 w-5 text-green-500 flex-shrink-0 mt-0.5"}),g.jsx("p",{className:"text-sm text-gray-700",children:e})]},t))})]}),i.recommendations.length>0&&g.jsxs("div",{children:[g.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Development Recommendations"}),g.jsx("ul",{className:"list-disc pl-5 space-y-1",children:i.recommendations.map((e,t)=>g.jsx("li",{className:"text-sm text-gray-600",children:e},t))})]})]}):g.jsx("p",{className:"text-sm text-gray-500 italic",children:"Growth potential analysis not available"})}function zS({plan:i}){const[e,t]=V.useState(null),n=(r=>{if(!r)return[];try{return r.replace(/^INTERVIEW_PLAN:\s*/i,"").replace(/\r\n/g,`
`).trim().split(/(?=\d+\.\s*Question Category:)/i).filter(l=>l.trim()).map(l=>{const c=l.match(/Question Category:\s*(.*?)\((\d+)\s*minutes\)/i);if(!c)return null;const[,h,d]=c,p=[],f=[],v=[],w=l.split(`
`).map(x=>x.trim());let A="";return w.forEach(x=>{if(x.startsWith("Primary Question:")){A="primary";const S=x.replace(/^Primary Question:\s*/i,"").trim();S&&p.unshift(S)}else if(x.startsWith("Follow-up Questions:"))A="followup";else if(x.startsWith("Red Flags:"))A="red";else if(x.startsWith("Green Flags:"))A="green";else if(x.startsWith("Expected Answer:")||x.startsWith("Evaluation Criteria:"))A="other";else if(x.startsWith("-")&&x.length>1){const S=x.replace(/^-\s*/,"").trim();switch(A){case"followup":p.push(S);break;case"red":f.push(S);break;case"green":v.push(S);break}}}),{title:h.trim(),duration:`${d} minutes`,questions:p,redFlags:f,greenFlags:v}}).filter(l=>l!==null)}catch(a){return console.error("Error parsing interview plan:",a),[]}})(i);return i?n.length===0?g.jsxs("div",{className:"text-gray-500 italic",children:[g.jsx("p",{children:"No interview plan sections found"}),!1]}):g.jsx("div",{className:"divide-y divide-gray-200",children:n.map((r,a)=>g.jsxs("div",{className:"py-4 first:pt-0 last:pb-0",children:[g.jsxs("button",{onClick:()=>t(e===r.title?null:r.title),className:"w-full flex items-center justify-between text-left",children:[g.jsxs("div",{children:[g.jsx("h4",{className:"text-lg font-medium text-gray-900",children:r.title}),g.jsx("p",{className:"text-sm text-gray-500",children:r.duration})]}),e===r.title?g.jsx(Tu,{className:"h-5 w-5 text-gray-400"}):g.jsx(Vo,{className:"h-5 w-5 text-gray-400"})]}),e===r.title&&g.jsxs("div",{className:"mt-4 space-y-4",children:[r.questions.length>0&&g.jsxs("div",{children:[g.jsx("h5",{className:"font-medium text-gray-700 mb-2",children:"Questions:"}),g.jsx("ul",{className:"space-y-2",children:r.questions.map((o,l)=>g.jsxs("li",{className:"flex items-start space-x-2",children:[g.jsx("span",{className:"text-blue-600 mt-1",children:"â€¢"}),g.jsx("span",{className:"text-gray-600",children:o})]},l))})]}),r.redFlags.length>0&&g.jsxs("div",{children:[g.jsx("h5",{className:"font-medium text-red-600 mb-2",children:"Watch out for:"}),g.jsx("ul",{className:"space-y-2",children:r.redFlags.map((o,l)=>g.jsxs("li",{className:"flex items-start space-x-2",children:[g.jsx("span",{className:"text-red-600 mt-1",children:"âš "}),g.jsx("span",{className:"text-red-600",children:o})]},l))})]}),r.greenFlags.length>0&&g.jsxs("div",{children:[g.jsx("h5",{className:"font-medium text-green-600 mb-2",children:"Positive Indicators:"}),g.jsx("ul",{className:"space-y-2",children:r.greenFlags.map((o,l)=>g.jsxs("li",{className:"flex items-start space-x-2",children:[g.jsx("span",{className:"text-green-600 mt-1",children:"âœ“"}),g.jsx("span",{className:"text-green-600",children:o})]},l))})]})]})]},a))}):g.jsx("p",{className:"text-sm text-gray-500 italic",children:"Interview plan not available"})}function HS({analysis:i}){const[e,t]=V.useState({name:"",cv_text:""}),[s,n]=V.useState({title:"",company:"",jd_text:""});return V.useEffect(()=>{async function r(){const{data:a}=await ut.from("candidates").select("name, cv_text").eq("id",i.candidate_id).single(),{data:o}=await ut.from("jobs").select("title, company, jd_text").eq("id",i.job_id).single();a&&t(a),o&&n(o)}r()},[i.candidate_id,i.job_id]),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[g.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[g.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[g.jsx(Cv,{className:"h-5 w-5 text-blue-600"}),g.jsx("h4",{className:"font-medium",children:"Candidate Profile"})]}),g.jsxs("div",{className:"space-y-3",children:[g.jsxs("div",{children:[g.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Name"}),g.jsx("p",{className:"text-base text-gray-900",children:e.name||"Loading..."})]}),g.jsxs("div",{children:[g.jsx("p",{className:"text-sm font-medium text-gray-500",children:"CV Summary"}),g.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:i.cv_summary})]})]})]}),g.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[g.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[g.jsx(yp,{className:"h-5 w-5 text-blue-600"}),g.jsx("h4",{className:"font-medium",children:"Position Details"})]}),g.jsxs("div",{className:"space-y-3",children:[g.jsxs("div",{children:[g.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Position"}),g.jsx("p",{className:"text-base text-gray-900",children:s.title||"Loading..."})]}),s.company&&g.jsxs("div",{children:[g.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Company"}),g.jsx("p",{className:"text-base text-gray-900",children:s.company})]}),g.jsxs("div",{children:[g.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Requirements"}),g.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:i.job_requirements})]})]})]})]})}function Wp(){const[i,e]=V.useState([]),t=V.useCallback((n,r="info")=>{e(a=>[...a,{id:Date.now(),message:n,type:r}])},[]),s=V.useCallback(n=>{e(r=>r.filter(a=>a.id!==n))},[]);return{toasts:i,addToast:t,removeToast:s}}async function WS(i){const{data:e,error:t}=await ut.from("analysis").select(`
      *,
      candidates (
        name,
        cv_text
      ),
      jobs (
        title,
        jd_text
      )
    `).eq("id",i).single();if(t)throw new Dt("Analysis not found",404);return{...e,cv_summary:e.candidates?.cv_text||"",job_requirements:e.jobs?.jd_text||""}}async function VS(){const{data:i,error:e}=await ut.from("analysis").select(`
      *,
      candidates (
        name
      ),
      jobs (
        title
      )
    `).order("created_at",{ascending:!1});if(e)throw new Dt("Failed to fetch analyses",500);return i?.map(t=>({...t,cv_summary:"",job_requirements:""}))||[]}async function GS(i,e){const{error:t}=await ut.from("analysis").update({notes:e}).eq("id",i);if(t)throw new Dt("Failed to update notes",500)}function XS(i){const[e,t]=V.useState(!1),{addToast:s}=Wp();return{isLoading:e,updateNotes:async r=>{t(!0);try{await GS(i,r),s("Notes updated successfully","success")}catch(a){throw s(a instanceof Error?a.message:"Failed to update notes","error"),a}finally{t(!1)}}}}function YS({analysis:i}){const[e,t]=V.useState(!1),{updateNotes:s,isLoading:n}=XS(i.id??""),[r,a]=V.useState(i.notes||""),o=async()=>{try{await s(r),t(!1)}catch{t(!0)}};return g.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[g.jsxs("div",{className:"flex justify-between items-center mb-4",children:[g.jsx("h3",{className:"font-medium",children:"Interview Notes"}),!e&&g.jsx(qi,{variant:"secondary",onClick:()=>t(!0),children:"Edit Notes"})]}),e?g.jsxs("div",{className:"space-y-4",children:[g.jsx(Ep,{label:"Notes",value:r,onChange:l=>a(l.target.value),placeholder:"Add your interview notes here..."}),g.jsxs("div",{className:"flex justify-end space-x-2",children:[g.jsx(qi,{variant:"secondary",onClick:()=>t(!1),disabled:n,children:"Cancel"}),g.jsx(qi,{onClick:o,isLoading:n,children:"Save Notes"})]})]}):g.jsx("div",{className:"prose max-w-none",children:i.notes?g.jsx("p",{className:"whitespace-pre-wrap",children:i.notes}):g.jsx("p",{className:"text-gray-500 italic",children:"No notes added yet"})})]})}function Bt(i){"@babel/helpers - typeof";return Bt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bt(i)}var Qs=Uint8Array,In=Uint16Array,Vp=Int32Array,Ju=new Qs([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Zu=new Qs([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Hf=new Qs([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),X1=function(i,e){for(var t=new In(31),s=0;s<31;++s)t[s]=e+=1<<i[s-1];for(var n=new Vp(t[30]),s=1;s<30;++s)for(var r=t[s];r<t[s+1];++r)n[r]=r-t[s]<<5|s;return{b:t,r:n}},Y1=X1(Ju,2),K1=Y1.b,Wf=Y1.r;K1[28]=258,Wf[258]=28;var J1=X1(Zu,0),KS=J1.b,Dg=J1.r,Vf=new In(32768);for(var Zt=0;Zt<32768;++Zt){var Tr=(Zt&43690)>>1|(Zt&21845)<<1;Tr=(Tr&52428)>>2|(Tr&13107)<<2,Tr=(Tr&61680)>>4|(Tr&3855)<<4,Vf[Zt]=((Tr&65280)>>8|(Tr&255)<<8)>>1}var Ui=function(i,e,t){for(var s=i.length,n=0,r=new In(e);n<s;++n)i[n]&&++r[i[n]-1];var a=new In(e);for(n=1;n<e;++n)a[n]=a[n-1]+r[n-1]<<1;var o;if(t){o=new In(1<<e);var l=15-e;for(n=0;n<s;++n)if(i[n])for(var c=n<<4|i[n],h=e-i[n],d=a[i[n]-1]++<<h,p=d|(1<<h)-1;d<=p;++d)o[Vf[d]>>l]=c}else for(o=new In(s),n=0;n<s;++n)i[n]&&(o[n]=Vf[a[i[n]-1]++]>>15-i[n]);return o},zr=new Qs(288);for(var Zt=0;Zt<144;++Zt)zr[Zt]=8;for(var Zt=144;Zt<256;++Zt)zr[Zt]=9;for(var Zt=256;Zt<280;++Zt)zr[Zt]=7;for(var Zt=280;Zt<288;++Zt)zr[Zt]=8;var fc=new Qs(32);for(var Zt=0;Zt<32;++Zt)fc[Zt]=5;var JS=Ui(zr,9,0),ZS=Ui(zr,9,1),QS=Ui(fc,5,0),e3=Ui(fc,5,1),of=function(i){for(var e=i[0],t=1;t<i.length;++t)i[t]>e&&(e=i[t]);return e},ii=function(i,e,t){var s=e/8|0;return(i[s]|i[s+1]<<8)>>(e&7)&t},lf=function(i,e){var t=e/8|0;return(i[t]|i[t+1]<<8|i[t+2]<<16)>>(e&7)},Gp=function(i){return(i+7)/8|0},Z1=function(i,e,t){return(t==null||t>i.length)&&(t=i.length),new Qs(i.subarray(e,t))},t3=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ci=function(i,e,t){var s=new Error(e||t3[i]);if(s.code=i,Error.captureStackTrace&&Error.captureStackTrace(s,ci),!t)throw s;return s},s3=function(i,e,t,s){var n=i.length,r=0;if(!n||e.f&&!e.l)return t||new Qs(0);var a=!t,o=a||e.i!=2,l=e.i;a&&(t=new Qs(n*3));var c=function(Ne){var Re=t.length;if(Ne>Re){var Le=new Qs(Math.max(Re*2,Ne));Le.set(t),t=Le}},h=e.f||0,d=e.p||0,p=e.b||0,f=e.l,v=e.d,w=e.m,A=e.n,x=n*8;do{if(!f){h=ii(i,d,1);var S=ii(i,d+1,3);if(d+=3,S)if(S==1)f=ZS,v=e3,w=9,A=5;else if(S==2){var Q=ii(i,d,31)+257,q=ii(i,d+10,15)+4,O=Q+ii(i,d+5,31)+1;d+=14;for(var G=new Qs(O),ie=new Qs(19),L=0;L<q;++L)ie[Hf[L]]=ii(i,d+L*3,7);d+=q*3;for(var R=of(ie),W=(1<<R)-1,U=Ui(ie,R,1),L=0;L<O;){var he=U[ii(i,d,W)];d+=he&15;var j=he>>4;if(j<16)G[L++]=j;else{var ae=0,se=0;for(j==16?(se=3+ii(i,d,3),d+=2,ae=G[L-1]):j==17?(se=3+ii(i,d,7),d+=3):j==18&&(se=11+ii(i,d,127),d+=7);se--;)G[L++]=ae}}var Z=G.subarray(0,Q),fe=G.subarray(Q);w=of(Z),A=of(fe),f=Ui(Z,w,1),v=Ui(fe,A,1)}else ci(1);else{var j=Gp(d)+4,M=i[j-4]|i[j-3]<<8,B=j+M;if(B>n){l&&ci(0);break}o&&c(p+M),t.set(i.subarray(j,B),p),e.b=p+=M,e.p=d=B*8,e.f=h;continue}if(d>x){l&&ci(0);break}}o&&c(p+131072);for(var me=(1<<w)-1,ke=(1<<A)-1,k=d;;k=d){var ae=f[lf(i,d)&me],D=ae>>4;if(d+=ae&15,d>x){l&&ci(0);break}if(ae||ci(2),D<256)t[p++]=D;else if(D==256){k=d,f=null;break}else{var z=D-254;if(D>264){var L=D-257,X=Ju[L];z=ii(i,d,(1<<X)-1)+K1[L],d+=X}var ee=v[lf(i,d)&ke],re=ee>>4;ee||ci(3),d+=ee&15;var fe=KS[re];if(re>3){var X=Zu[re];fe+=lf(i,d)&(1<<X)-1,d+=X}if(d>x){l&&ci(0);break}o&&c(p+131072);var ue=p+z;if(p<fe){var de=r-fe,Ee=Math.min(fe,ue);for(de+p<0&&ci(3);p<Ee;++p)t[p]=s[de+p]}for(;p<ue;++p)t[p]=t[p-fe]}}e.l=f,e.p=k,e.b=p,e.f=h,f&&(h=1,e.m=w,e.d=v,e.n=A)}while(!h);return p!=t.length&&a?Z1(t,0,p):t.subarray(0,p)},rr=function(i,e,t){t<<=e&7;var s=e/8|0;i[s]|=t,i[s+1]|=t>>8},Ml=function(i,e,t){t<<=e&7;var s=e/8|0;i[s]|=t,i[s+1]|=t>>8,i[s+2]|=t>>16},cf=function(i,e){for(var t=[],s=0;s<i.length;++s)i[s]&&t.push({s,f:i[s]});var n=t.length,r=t.slice();if(!n)return{t:eb,l:0};if(n==1){var a=new Qs(t[0].s+1);return a[t[0].s]=1,{t:a,l:1}}t.sort(function(B,Q){return B.f-Q.f}),t.push({s:-1,f:25001});var o=t[0],l=t[1],c=0,h=1,d=2;for(t[0]={s:-1,f:o.f+l.f,l:o,r:l};h!=n-1;)o=t[t[c].f<t[d].f?c++:d++],l=t[c!=h&&t[c].f<t[d].f?c++:d++],t[h++]={s:-1,f:o.f+l.f,l:o,r:l};for(var p=r[0].s,s=1;s<n;++s)r[s].s>p&&(p=r[s].s);var f=new In(p+1),v=Gf(t[h-1],f,0);if(v>e){var s=0,w=0,A=v-e,x=1<<A;for(r.sort(function(Q,q){return f[q.s]-f[Q.s]||Q.f-q.f});s<n;++s){var S=r[s].s;if(f[S]>e)w+=x-(1<<v-f[S]),f[S]=e;else break}for(w>>=A;w>0;){var j=r[s].s;f[j]<e?w-=1<<e-f[j]++-1:++s}for(;s>=0&&w;--s){var M=r[s].s;f[M]==e&&(--f[M],++w)}v=e}return{t:new Qs(f),l:v}},Gf=function(i,e,t){return i.s==-1?Math.max(Gf(i.l,e,t+1),Gf(i.r,e,t+1)):e[i.s]=t},Bg=function(i){for(var e=i.length;e&&!i[--e];);for(var t=new In(++e),s=0,n=i[0],r=1,a=function(l){t[s++]=l},o=1;o<=e;++o)if(i[o]==n&&o!=e)++r;else{if(!n&&r>2){for(;r>138;r-=138)a(32754);r>2&&(a(r>10?r-11<<5|28690:r-3<<5|12305),r=0)}else if(r>3){for(a(n),--r;r>6;r-=6)a(8304);r>2&&(a(r-3<<5|8208),r=0)}for(;r--;)a(n);r=1,n=i[o]}return{c:t.subarray(0,s),n:e}},Fl=function(i,e){for(var t=0,s=0;s<e.length;++s)t+=i[s]*e[s];return t},Q1=function(i,e,t){var s=t.length,n=Gp(e+2);i[n]=s&255,i[n+1]=s>>8,i[n+2]=i[n]^255,i[n+3]=i[n+1]^255;for(var r=0;r<s;++r)i[n+r+4]=t[r];return(n+4+s)*8},$g=function(i,e,t,s,n,r,a,o,l,c,h){rr(e,h++,t),++n[256];for(var d=cf(n,15),p=d.t,f=d.l,v=cf(r,15),w=v.t,A=v.l,x=Bg(p),S=x.c,j=x.n,M=Bg(w),B=M.c,Q=M.n,q=new In(19),O=0;O<S.length;++O)++q[S[O]&31];for(var O=0;O<B.length;++O)++q[B[O]&31];for(var G=cf(q,7),ie=G.t,L=G.l,R=19;R>4&&!ie[Hf[R-1]];--R);var W=c+5<<3,U=Fl(n,zr)+Fl(r,fc)+a,he=Fl(n,p)+Fl(r,w)+a+14+3*R+Fl(q,ie)+2*q[16]+3*q[17]+7*q[18];if(l>=0&&W<=U&&W<=he)return Q1(e,h,i.subarray(l,l+c));var ae,se,Z,fe;if(rr(e,h,1+(he<U)),h+=2,he<U){ae=Ui(p,f,0),se=p,Z=Ui(w,A,0),fe=w;var me=Ui(ie,L,0);rr(e,h,j-257),rr(e,h+5,Q-1),rr(e,h+10,R-4),h+=14;for(var O=0;O<R;++O)rr(e,h+3*O,ie[Hf[O]]);h+=3*R;for(var ke=[S,B],k=0;k<2;++k)for(var D=ke[k],O=0;O<D.length;++O){var z=D[O]&31;rr(e,h,me[z]),h+=ie[z],z>15&&(rr(e,h,D[O]>>5&127),h+=D[O]>>12)}}else ae=JS,se=zr,Z=QS,fe=fc;for(var O=0;O<o;++O){var X=s[O];if(X>255){var z=X>>18&31;Ml(e,h,ae[z+257]),h+=se[z+257],z>7&&(rr(e,h,X>>23&31),h+=Ju[z]);var ee=X&31;Ml(e,h,Z[ee]),h+=fe[ee],ee>3&&(Ml(e,h,X>>5&8191),h+=Zu[ee])}else Ml(e,h,ae[X]),h+=se[X]}return Ml(e,h,ae[256]),h+se[256]},n3=new Vp([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),eb=new Qs(0),i3=function(i,e,t,s,n,r){var a=r.z||i.length,o=new Qs(s+a+5*(1+Math.ceil(a/7e3))+n),l=o.subarray(s,o.length-n),c=r.l,h=(r.r||0)&7;if(e){h&&(l[0]=r.r>>3);for(var d=n3[e-1],p=d>>13,f=d&8191,v=(1<<t)-1,w=r.p||new In(32768),A=r.h||new In(v+1),x=Math.ceil(t/3),S=2*x,j=function(Ke){return(i[Ke]^i[Ke+1]<<x^i[Ke+2]<<S)&v},M=new Vp(25e3),B=new In(288),Q=new In(32),q=0,O=0,G=r.i||0,ie=0,L=r.w||0,R=0;G+2<a;++G){var W=j(G),U=G&32767,he=A[W];if(w[U]=he,A[W]=U,L<=G){var ae=a-G;if((q>7e3||ie>24576)&&(ae>423||!c)){h=$g(i,l,0,M,B,Q,O,ie,R,G-R,h),ie=q=O=0,R=G;for(var se=0;se<286;++se)B[se]=0;for(var se=0;se<30;++se)Q[se]=0}var Z=2,fe=0,me=f,ke=U-he&32767;if(ae>2&&W==j(G-ke))for(var k=Math.min(p,ae)-1,D=Math.min(32767,G),z=Math.min(258,ae);ke<=D&&--me&&U!=he;){if(i[G+Z]==i[G+Z-ke]){for(var X=0;X<z&&i[G+X]==i[G+X-ke];++X);if(X>Z){if(Z=X,fe=ke,X>k)break;for(var ee=Math.min(ke,X-2),re=0,se=0;se<ee;++se){var ue=G-ke+se&32767,de=w[ue],Ee=ue-de&32767;Ee>re&&(re=Ee,he=ue)}}}U=he,he=w[U],ke+=U-he&32767}if(fe){M[ie++]=268435456|Wf[Z]<<18|Dg[fe];var Ne=Wf[Z]&31,Re=Dg[fe]&31;O+=Ju[Ne]+Zu[Re],++B[257+Ne],++Q[Re],L=G+Z,++q}else M[ie++]=i[G],++B[i[G]]}}for(G=Math.max(G,L);G<a;++G)M[ie++]=i[G],++B[i[G]];h=$g(i,l,c,M,B,Q,O,ie,R,G-R,h),c||(r.r=h&7|l[h/8|0]<<3,h-=7,r.h=A,r.p=w,r.i=G,r.w=L)}else{for(var G=r.w||0;G<a+c;G+=65535){var Le=G+65535;Le>=a&&(l[h/8|0]=c,Le=a),h=Q1(l,h+1,i.subarray(G,Le))}r.i=a}return Z1(o,0,s+Gp(h)+n)},tb=function(){var i=1,e=0;return{p:function(t){for(var s=i,n=e,r=t.length|0,a=0;a!=r;){for(var o=Math.min(a+2655,r);a<o;++a)n+=s+=t[a];s=(s&65535)+15*(s>>16),n=(n&65535)+15*(n>>16)}i=s,e=n},d:function(){return i%=65521,e%=65521,(i&255)<<24|(i&65280)<<8|(e&255)<<8|e>>8}}},r3=function(i,e,t,s,n){if(!n&&(n={l:1},e.dictionary)){var r=e.dictionary.subarray(-32768),a=new Qs(r.length+i.length);a.set(r),a.set(i,r.length),i=a,n.w=r.length}return i3(i,e.level==null?6:e.level,e.mem==null?n.l?Math.ceil(Math.max(8,Math.min(13,Math.log(i.length)))*1.5):20:12+e.mem,t,s,n)},sb=function(i,e,t){for(;t;++e)i[e]=t,t>>>=8},a3=function(i,e){var t=e.level,s=t==0?0:t<6?1:t==9?3:2;if(i[0]=120,i[1]=s<<6|(e.dictionary&&32),i[1]|=31-(i[0]<<8|i[1])%31,e.dictionary){var n=tb();n.p(e.dictionary),sb(i,2,n.d())}},o3=function(i,e){return((i[0]&15)!=8||i[0]>>4>7||(i[0]<<8|i[1])%31)&&ci(6,"invalid zlib data"),(i[1]>>5&1)==+!e&&ci(6,"invalid zlib data: "+(i[1]&32?"need":"unexpected")+" dictionary"),(i[1]>>3&4)+2};function Xf(i,e){e||(e={});var t=tb();t.p(i);var s=r3(i,e,e.dictionary?6:2,4);return a3(s,e),sb(s,s.length-4,t.d()),s}function l3(i,e){return s3(i.subarray(o3(i,e),-4),{i:2},e,e)}var c3=typeof TextDecoder<"u"&&new TextDecoder,h3=0;try{c3.decode(eb,{stream:!0}),h3=1}catch{}var Ze=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function hf(){Ze.console&&typeof Ze.console.log=="function"&&Ze.console.log.apply(Ze.console,arguments)}var Gt={log:hf,warn:function(i){Ze.console&&(typeof Ze.console.warn=="function"?Ze.console.warn.apply(Ze.console,arguments):hf.call(null,arguments))},error:function(i){Ze.console&&(typeof Ze.console.error=="function"?Ze.console.error.apply(Ze.console,arguments):hf(i))}};function uf(i,e,t){var s=new XMLHttpRequest;s.open("GET",i),s.responseType="blob",s.onload=function(){fa(s.response,e,t)},s.onerror=function(){Gt.error("could not download file")},s.send()}function qg(i){var e=new XMLHttpRequest;e.open("HEAD",i,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function zh(i){try{i.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),i.dispatchEvent(e)}}var nc,Yf,fa=Ze.saveAs||((typeof window>"u"?"undefined":Bt(window))!=="object"||window!==Ze?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(i,e,t){var s=Ze.URL||Ze.webkitURL,n=document.createElement("a");e=e||i.name||"download",n.download=e,n.rel="noopener",typeof i=="string"?(n.href=i,n.origin!==location.origin?qg(n.href)?uf(i,e,t):zh(n,n.target="_blank"):zh(n)):(n.href=s.createObjectURL(i),setTimeout(function(){s.revokeObjectURL(n.href)},4e4),setTimeout(function(){zh(n)},0))}:"msSaveOrOpenBlob"in navigator?function(i,e,t){if(e=e||i.name||"download",typeof i=="string")if(qg(i))uf(i,e,t);else{var s=document.createElement("a");s.href=i,s.target="_blank",setTimeout(function(){zh(s)})}else navigator.msSaveOrOpenBlob(function(n,r){return r===void 0?r={autoBom:!1}:Bt(r)!=="object"&&(Gt.warn("Deprecated: Expected third argument to be a object"),r={autoBom:!r}),r.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n}(i,t),e)}:function(i,e,t,s){if((s=s||open("","_blank"))&&(s.document.title=s.document.body.innerText="downloading..."),typeof i=="string")return uf(i,e,t);var n=i.type==="application/octet-stream",r=/constructor/i.test(Ze.HTMLElement)||Ze.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||n&&r)&&(typeof FileReader>"u"?"undefined":Bt(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var h=o.result;h=a?h:h.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=h:location=h,s=null},o.readAsDataURL(i)}else{var l=Ze.URL||Ze.webkitURL,c=l.createObjectURL(i);s?s.location=c:location.href=c,s=null,setTimeout(function(){l.revokeObjectURL(c)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function nb(i){var e;i=i||"",this.ok=!1,i.charAt(0)=="#"&&(i=i.substr(1,6)),i={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[i=(i=i.replace(/ /g,"")).toLowerCase()]||i;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],s=0;s<t.length;s++){var n=t[s].re,r=t[s].process,a=n.exec(i);a&&(e=r(a),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),l=this.g.toString(16),c=this.b.toString(16);return o.length==1&&(o="0"+o),l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),"#"+o+l+c}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function df(i,e){var t=i[0],s=i[1],n=i[2],r=i[3];t=Vs(t,s,n,r,e[0],7,-680876936),r=Vs(r,t,s,n,e[1],12,-389564586),n=Vs(n,r,t,s,e[2],17,606105819),s=Vs(s,n,r,t,e[3],22,-1044525330),t=Vs(t,s,n,r,e[4],7,-176418897),r=Vs(r,t,s,n,e[5],12,1200080426),n=Vs(n,r,t,s,e[6],17,-1473231341),s=Vs(s,n,r,t,e[7],22,-45705983),t=Vs(t,s,n,r,e[8],7,1770035416),r=Vs(r,t,s,n,e[9],12,-1958414417),n=Vs(n,r,t,s,e[10],17,-42063),s=Vs(s,n,r,t,e[11],22,-1990404162),t=Vs(t,s,n,r,e[12],7,1804603682),r=Vs(r,t,s,n,e[13],12,-40341101),n=Vs(n,r,t,s,e[14],17,-1502002290),t=Gs(t,s=Vs(s,n,r,t,e[15],22,1236535329),n,r,e[1],5,-165796510),r=Gs(r,t,s,n,e[6],9,-1069501632),n=Gs(n,r,t,s,e[11],14,643717713),s=Gs(s,n,r,t,e[0],20,-373897302),t=Gs(t,s,n,r,e[5],5,-701558691),r=Gs(r,t,s,n,e[10],9,38016083),n=Gs(n,r,t,s,e[15],14,-660478335),s=Gs(s,n,r,t,e[4],20,-405537848),t=Gs(t,s,n,r,e[9],5,568446438),r=Gs(r,t,s,n,e[14],9,-1019803690),n=Gs(n,r,t,s,e[3],14,-187363961),s=Gs(s,n,r,t,e[8],20,1163531501),t=Gs(t,s,n,r,e[13],5,-1444681467),r=Gs(r,t,s,n,e[2],9,-51403784),n=Gs(n,r,t,s,e[7],14,1735328473),t=Xs(t,s=Gs(s,n,r,t,e[12],20,-1926607734),n,r,e[5],4,-378558),r=Xs(r,t,s,n,e[8],11,-2022574463),n=Xs(n,r,t,s,e[11],16,1839030562),s=Xs(s,n,r,t,e[14],23,-35309556),t=Xs(t,s,n,r,e[1],4,-1530992060),r=Xs(r,t,s,n,e[4],11,1272893353),n=Xs(n,r,t,s,e[7],16,-155497632),s=Xs(s,n,r,t,e[10],23,-1094730640),t=Xs(t,s,n,r,e[13],4,681279174),r=Xs(r,t,s,n,e[0],11,-358537222),n=Xs(n,r,t,s,e[3],16,-722521979),s=Xs(s,n,r,t,e[6],23,76029189),t=Xs(t,s,n,r,e[9],4,-640364487),r=Xs(r,t,s,n,e[12],11,-421815835),n=Xs(n,r,t,s,e[15],16,530742520),t=Ys(t,s=Xs(s,n,r,t,e[2],23,-995338651),n,r,e[0],6,-198630844),r=Ys(r,t,s,n,e[7],10,1126891415),n=Ys(n,r,t,s,e[14],15,-1416354905),s=Ys(s,n,r,t,e[5],21,-57434055),t=Ys(t,s,n,r,e[12],6,1700485571),r=Ys(r,t,s,n,e[3],10,-1894986606),n=Ys(n,r,t,s,e[10],15,-1051523),s=Ys(s,n,r,t,e[1],21,-2054922799),t=Ys(t,s,n,r,e[8],6,1873313359),r=Ys(r,t,s,n,e[15],10,-30611744),n=Ys(n,r,t,s,e[6],15,-1560198380),s=Ys(s,n,r,t,e[13],21,1309151649),t=Ys(t,s,n,r,e[4],6,-145523070),r=Ys(r,t,s,n,e[11],10,-1120210379),n=Ys(n,r,t,s,e[2],15,718787259),s=Ys(s,n,r,t,e[9],21,-343485551),i[0]=Br(t,i[0]),i[1]=Br(s,i[1]),i[2]=Br(n,i[2]),i[3]=Br(r,i[3])}function Qu(i,e,t,s,n,r){return e=Br(Br(e,i),Br(s,r)),Br(e<<n|e>>>32-n,t)}function Vs(i,e,t,s,n,r,a){return Qu(e&t|~e&s,i,e,n,r,a)}function Gs(i,e,t,s,n,r,a){return Qu(e&s|t&~s,i,e,n,r,a)}function Xs(i,e,t,s,n,r,a){return Qu(e^t^s,i,e,n,r,a)}function Ys(i,e,t,s,n,r,a){return Qu(t^(e|~s),i,e,n,r,a)}function ib(i){var e,t=i.length,s=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=i.length;e+=64)df(s,u3(i.substring(e-64,e)));i=i.substring(e-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<i.length;e++)n[e>>2]|=i.charCodeAt(e)<<(e%4<<3);if(n[e>>2]|=128<<(e%4<<3),e>55)for(df(s,n),e=0;e<16;e++)n[e]=0;return n[14]=8*t,df(s,n),s}function u3(i){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=i.charCodeAt(e)+(i.charCodeAt(e+1)<<8)+(i.charCodeAt(e+2)<<16)+(i.charCodeAt(e+3)<<24);return t}nc=Ze.atob.bind(Ze),Yf=Ze.btoa.bind(Ze);var Ug="0123456789abcdef".split("");function d3(i){for(var e="",t=0;t<4;t++)e+=Ug[i>>8*t+4&15]+Ug[i>>8*t&15];return e}function f3(i){return String.fromCharCode((255&i)>>0,(65280&i)>>8,(16711680&i)>>16,(4278190080&i)>>24)}function Kf(i){return ib(i).map(f3).join("")}var p3=function(i){for(var e=0;e<i.length;e++)i[e]=d3(i[e]);return i.join("")}(ib("hello"))!="5d41402abc4b2a76b9719d911017c592";function Br(i,e){if(p3){var t=(65535&i)+(65535&e);return(i>>16)+(e>>16)+(t>>16)<<16|65535&t}return i+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Jf(i,e){var t,s,n,r;if(i!==t){for(var a=(n=i,r=1+(256/i.length>>0),new Array(r+1).join(n)),o=[],l=0;l<256;l++)o[l]=l;var c=0;for(l=0;l<256;l++){var h=o[l];c=(c+h+a.charCodeAt(l))%256,o[l]=o[c],o[c]=h}t=i,s=o}else o=s;var d=e.length,p=0,f=0,v="";for(l=0;l<d;l++)f=(f+(h=o[p=(p+1)%256]))%256,o[p]=o[f],o[f]=h,a=o[(o[p]+o[f])%256],v+=String.fromCharCode(e.charCodeAt(l)^a);return v}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var zg={print:4,modify:8,copy:16,"annot-forms":32};function wo(i,e,t,s){this.v=1,this.r=2;var n=192;i.forEach(function(o){if(zg.perm!==void 0)throw new Error("Invalid permission: "+o);n+=zg[o]}),this.padding="(Â¿N^NuÂŠAd\0NVÃ¿Ãº\b..\0Â¶Ãh>Â€/\fÂ©Ã¾dSiz";var r=(e+this.padding).substr(0,32),a=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(r,a),this.P=-(1+(255^n)),this.encryptionKey=Kf(r+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(s)).substr(0,5),this.U=Jf(this.encryptionKey,this.padding)}function xo(i){if(/[^\u0000-\u00ff]/.test(i))throw new Error("Invalid PDF Name Object: "+i+", Only accept ASCII characters.");for(var e="",t=i.length,s=0;s<t;s++){var n=i.charCodeAt(s);n<33||n===35||n===37||n===40||n===41||n===47||n===60||n===62||n===91||n===93||n===123||n===125||n>126?e+="#"+("0"+n.toString(16)).slice(-2):e+=i[s]}return e}function Hg(i){if(Bt(i)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,s,n){if(n=n||!1,typeof t!="string"||typeof s!="function"||typeof n!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var r=Math.random().toString(35);return e[t][r]=[s,!!n],r},this.unsubscribe=function(t){for(var s in e)if(e[s][t])return delete e[s][t],Object.keys(e[s]).length===0&&delete e[s],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var s=Array.prototype.slice.call(arguments,1),n=[];for(var r in e[t]){var a=e[t][r];try{a[0].apply(i,s)}catch(o){Ze.console&&Gt.error("jsPDF PubSub Error",o.message,o)}a[1]&&n.push(r)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function bu(i){if(!(this instanceof bu))return new bu(i);var e="opacity,stroke-opacity".split(",");for(var t in i)i.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=i[t]);this.id="",this.objectNumber=-1}function rb(i,e){this.gState=i,this.matrix=e,this.id="",this.objectNumber=-1}function ga(i,e,t,s,n){if(!(this instanceof ga))return new ga(i,e,t,s,n);this.type=i==="axial"?2:3,this.coords=e,this.colors=t,rb.call(this,s,n)}function Eo(i,e,t,s,n){if(!(this instanceof Eo))return new Eo(i,e,t,s,n);this.boundingBox=i,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,rb.call(this,s,n)}function Je(i){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",s=arguments[1],n=arguments[2],r=arguments[3],a=[],o=1,l=16,c="S",h=null;Bt(i=i||{})==="object"&&(t=i.orientation,s=i.unit||s,n=i.format||n,r=i.compress||i.compressPdf||r,(h=i.encryption||null)!==null&&(h.userPassword=h.userPassword||"",h.ownerPassword=h.ownerPassword||"",h.userPermissions=h.userPermissions||[]),o=typeof i.userUnit=="number"?Math.abs(i.userUnit):1,i.precision!==void 0&&(e=i.precision),i.floatPrecision!==void 0&&(l=i.floatPrecision),c=i.defaultPathOperation||"S"),a=i.filters||(r===!0?["FlateEncode"]:a),s=s||"mm",t=(""+(t||"P")).toLowerCase();var d=i.putOnlyUsedFonts||!1,p={},f={internal:{},__private__:{}};f.__private__.PubSub=Hg;var v="1.3",w=f.__private__.getPdfVersion=function(){return v};f.__private__.setPdfVersion=function(b){v=b};var A={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};f.__private__.getPageFormats=function(){return A};var x=f.__private__.getPageFormat=function(b){return A[b]};n=n||"a4";var S={COMPAT:"compat",ADVANCED:"advanced"},j=S.COMPAT;function M(){this.saveGraphicsState(),H(new Ye(Me,0,0,-Me,0,yr()*Me).toString()+" cm"),this.setFontSize(this.getFontSize()/Me),c="n",j=S.ADVANCED}function B(){this.restoreGraphicsState(),c="S",j=S.COMPAT}var Q=f.__private__.combineFontStyleAndFontWeight=function(b,E){if(b=="bold"&&E=="normal"||b=="bold"&&E==400||b=="normal"&&E=="italic"||b=="bold"&&E=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return E&&(b=E==400||E==="normal"?b==="italic"?"italic":"normal":E!=700&&E!=="bold"||b!=="normal"?(E==700?"bold":E)+""+b:"bold"),b};f.advancedAPI=function(b){var E=j===S.COMPAT;return E&&M.call(this),typeof b!="function"||(b(this),E&&B.call(this)),this},f.compatAPI=function(b){var E=j===S.ADVANCED;return E&&B.call(this),typeof b!="function"||(b(this),E&&M.call(this)),this},f.isAdvancedAPI=function(){return j===S.ADVANCED};var q,O=function(b){if(j!==S.ADVANCED)throw new Error(b+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},G=f.roundToPrecision=f.__private__.roundToPrecision=function(b,E){var $=e||E;if(isNaN(b)||isNaN($))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return b.toFixed($).replace(/0+$/,"")};q=f.hpf=f.__private__.hpf=typeof l=="number"?function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.hpf");return G(b,l)}:l==="smart"?function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.hpf");return G(b,b>-1&&b<1?16:5)}:function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.hpf");return G(b,16)};var ie=f.f2=f.__private__.f2=function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.f2");return G(b,2)},L=f.__private__.f3=function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.f3");return G(b,3)},R=f.scale=f.__private__.scale=function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.scale");return j===S.COMPAT?b*Me:j===S.ADVANCED?b:void 0},W=function(b){return j===S.COMPAT?yr()-b:j===S.ADVANCED?b:void 0},U=function(b){return R(W(b))};f.__private__.setPrecision=f.setPrecision=function(b){typeof parseInt(b,10)=="number"&&(e=parseInt(b,10))};var he,ae="00000000000000000000000000000000",se=f.__private__.getFileId=function(){return ae},Z=f.__private__.setFileId=function(b){return ae=b!==void 0&&/^[a-fA-F0-9]{32}$/.test(b)?b.toUpperCase():ae.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),h!==null&&(Hs=new wo(h.userPermissions,h.userPassword,h.ownerPassword,ae)),ae};f.setFileId=function(b){return Z(b),this},f.getFileId=function(){return se()};var fe=f.__private__.convertDateToPDFDate=function(b){var E=b.getTimezoneOffset(),$=E<0?"+":"-",Y=Math.floor(Math.abs(E/60)),oe=Math.abs(E%60),ge=[$,z(Y),"'",z(oe),"'"].join("");return["D:",b.getFullYear(),z(b.getMonth()+1),z(b.getDate()),z(b.getHours()),z(b.getMinutes()),z(b.getSeconds()),ge].join("")},me=f.__private__.convertPDFDateToDate=function(b){var E=parseInt(b.substr(2,4),10),$=parseInt(b.substr(6,2),10)-1,Y=parseInt(b.substr(8,2),10),oe=parseInt(b.substr(10,2),10),ge=parseInt(b.substr(12,2),10),_e=parseInt(b.substr(14,2),10);return new Date(E,$,Y,oe,ge,_e,0)},ke=f.__private__.setCreationDate=function(b){var E;if(b===void 0&&(b=new Date),b instanceof Date)E=fe(b);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(b))throw new Error("Invalid argument passed to jsPDF.setCreationDate");E=b}return he=E},k=f.__private__.getCreationDate=function(b){var E=he;return b==="jsDate"&&(E=me(he)),E};f.setCreationDate=function(b){return ke(b),this},f.getCreationDate=function(b){return k(b)};var D,z=f.__private__.padd2=function(b){return("0"+parseInt(b)).slice(-2)},X=f.__private__.padd2Hex=function(b){return("00"+(b=b.toString())).substr(b.length)},ee=0,re=[],ue=[],de=0,Ee=[],Ne=[],Re=!1,Le=ue,Ke=function(){ee=0,de=0,ue=[],re=[],Ee=[],Xi=bs(),Kn=bs()};f.__private__.setCustomOutputDestination=function(b){Re=!0,Le=b};var be=function(b){Re||(Le=b)};f.__private__.resetCustomOutputDestination=function(){Re=!1,Le=ue};var H=f.__private__.out=function(b){return b=b.toString(),de+=b.length+1,Le.push(b),Le},lt=f.__private__.write=function(b){return H(arguments.length===1?b.toString():Array.prototype.join.call(arguments," "))},Ue=f.__private__.getArrayBuffer=function(b){for(var E=b.length,$=new ArrayBuffer(E),Y=new Uint8Array($);E--;)Y[E]=b.charCodeAt(E);return $},Se=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];f.__private__.getStandardFonts=function(){return Se};var Ce=i.fontSize||16;f.__private__.setFontSize=f.setFontSize=function(b){return Ce=j===S.ADVANCED?b/Me:b,this};var Oe,je=f.__private__.getFontSize=f.getFontSize=function(){return j===S.COMPAT?Ce:Ce*Me},Ve=i.R2L||!1;f.__private__.setR2L=f.setR2L=function(b){return Ve=b,this},f.__private__.getR2L=f.getR2L=function(){return Ve};var it,ft=f.__private__.setZoomMode=function(b){var E=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(b))Oe=b;else if(isNaN(b)){if(E.indexOf(b)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+b+'" is not recognized.');Oe=b}else Oe=parseInt(b,10)};f.__private__.getZoomMode=function(){return Oe};var vt,Pt=f.__private__.setPageMode=function(b){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(b)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+b+'" is not recognized.');it=b};f.__private__.getPageMode=function(){return it};var qt=f.__private__.setLayoutMode=function(b){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(b)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+b+'" is not recognized.');vt=b};f.__private__.getLayoutMode=function(){return vt},f.__private__.setDisplayMode=f.setDisplayMode=function(b,E,$){return ft(b),qt(E),Pt($),this};var tt={title:"",subject:"",author:"",keywords:"",creator:""};f.__private__.getDocumentProperty=function(b){if(Object.keys(tt).indexOf(b)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return tt[b]},f.__private__.getDocumentProperties=function(){return tt},f.__private__.setDocumentProperties=f.setProperties=f.setDocumentProperties=function(b){for(var E in tt)tt.hasOwnProperty(E)&&b[E]&&(tt[E]=b[E]);return this},f.__private__.setDocumentProperty=function(b,E){if(Object.keys(tt).indexOf(b)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return tt[b]=E};var wt,Me,zs,Tt,Gn,Wt={},Qt={},_i=[],It={},Kr={},is={},Xn={},Gi=null,rs=0,rt=[],Rt=new Hg(f),Jr=i.hotfixes||[],Ds={},Ai={},Si=[],Ye=function b(E,$,Y,oe,ge,_e){if(!(this instanceof b))return new b(E,$,Y,oe,ge,_e);isNaN(E)&&(E=1),isNaN($)&&($=0),isNaN(Y)&&(Y=0),isNaN(oe)&&(oe=1),isNaN(ge)&&(ge=0),isNaN(_e)&&(_e=0),this._matrix=[E,$,Y,oe,ge,_e]};Object.defineProperty(Ye.prototype,"sx",{get:function(){return this._matrix[0]},set:function(b){this._matrix[0]=b}}),Object.defineProperty(Ye.prototype,"shy",{get:function(){return this._matrix[1]},set:function(b){this._matrix[1]=b}}),Object.defineProperty(Ye.prototype,"shx",{get:function(){return this._matrix[2]},set:function(b){this._matrix[2]=b}}),Object.defineProperty(Ye.prototype,"sy",{get:function(){return this._matrix[3]},set:function(b){this._matrix[3]=b}}),Object.defineProperty(Ye.prototype,"tx",{get:function(){return this._matrix[4]},set:function(b){this._matrix[4]=b}}),Object.defineProperty(Ye.prototype,"ty",{get:function(){return this._matrix[5]},set:function(b){this._matrix[5]=b}}),Object.defineProperty(Ye.prototype,"a",{get:function(){return this._matrix[0]},set:function(b){this._matrix[0]=b}}),Object.defineProperty(Ye.prototype,"b",{get:function(){return this._matrix[1]},set:function(b){this._matrix[1]=b}}),Object.defineProperty(Ye.prototype,"c",{get:function(){return this._matrix[2]},set:function(b){this._matrix[2]=b}}),Object.defineProperty(Ye.prototype,"d",{get:function(){return this._matrix[3]},set:function(b){this._matrix[3]=b}}),Object.defineProperty(Ye.prototype,"e",{get:function(){return this._matrix[4]},set:function(b){this._matrix[4]=b}}),Object.defineProperty(Ye.prototype,"f",{get:function(){return this._matrix[5]},set:function(b){this._matrix[5]=b}}),Object.defineProperty(Ye.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Ye.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Ye.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Ye.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Ye.prototype.join=function(b){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(q).join(b)},Ye.prototype.multiply=function(b){var E=b.sx*this.sx+b.shy*this.shx,$=b.sx*this.shy+b.shy*this.sy,Y=b.shx*this.sx+b.sy*this.shx,oe=b.shx*this.shy+b.sy*this.sy,ge=b.tx*this.sx+b.ty*this.shx+this.tx,_e=b.tx*this.shy+b.ty*this.sy+this.ty;return new Ye(E,$,Y,oe,ge,_e)},Ye.prototype.decompose=function(){var b=this.sx,E=this.shy,$=this.shx,Y=this.sy,oe=this.tx,ge=this.ty,_e=Math.sqrt(b*b+E*E),Fe=(b/=_e)*$+(E/=_e)*Y;$-=b*Fe,Y-=E*Fe;var Ge=Math.sqrt($*$+Y*Y);return Fe/=Ge,b*(Y/=Ge)<E*($/=Ge)&&(b=-b,E=-E,Fe=-Fe,_e=-_e),{scale:new Ye(_e,0,0,Ge,0,0),translate:new Ye(1,0,0,1,oe,ge),rotate:new Ye(b,E,-E,b,0,0),skew:new Ye(1,0,Fe,1,0,0)}},Ye.prototype.toString=function(b){return this.join(" ")},Ye.prototype.inversed=function(){var b=this.sx,E=this.shy,$=this.shx,Y=this.sy,oe=this.tx,ge=this.ty,_e=1/(b*Y-E*$),Fe=Y*_e,Ge=-E*_e,ct=-$*_e,at=b*_e;return new Ye(Fe,Ge,ct,at,-Fe*oe-ct*ge,-Ge*oe-at*ge)},Ye.prototype.applyToPoint=function(b){var E=b.x*this.sx+b.y*this.shx+this.tx,$=b.x*this.shy+b.y*this.sy+this.ty;return new Xa(E,$)},Ye.prototype.applyToRectangle=function(b){var E=this.applyToPoint(b),$=this.applyToPoint(new Xa(b.x+b.w,b.y+b.h));return new ll(E.x,E.y,$.x-E.x,$.y-E.y)},Ye.prototype.clone=function(){var b=this.sx,E=this.shy,$=this.shx,Y=this.sy,oe=this.tx,ge=this.ty;return new Ye(b,E,$,Y,oe,ge)},f.Matrix=Ye;var Yn=f.matrixMult=function(b,E){return E.multiply(b)},Ni=new Ye(1,0,0,1,0,0);f.unitMatrix=f.identityMatrix=Ni;var hn=function(b,E){if(!Kr[b]){var $=(E instanceof ga?"Sh":"P")+(Object.keys(It).length+1).toString(10);E.id=$,Kr[b]=$,It[$]=E,Rt.publish("addPattern",E)}};f.ShadingPattern=ga,f.TilingPattern=Eo,f.addShadingPattern=function(b,E){return O("addShadingPattern()"),hn(b,E),this},f.beginTilingPattern=function(b){O("beginTilingPattern()"),oh(b.boundingBox[0],b.boundingBox[1],b.boundingBox[2]-b.boundingBox[0],b.boundingBox[3]-b.boundingBox[1],b.matrix)},f.endTilingPattern=function(b,E){O("endTilingPattern()"),E.stream=Ne[D].join(`
`),hn(b,E),Rt.publish("endTilingPattern",E),Si.pop().restore()};var As=f.__private__.newObject=function(){var b=bs();return An(b,!0),b},bs=f.__private__.newObjectDeferred=function(){return ee++,re[ee]=function(){return de},ee},An=function(b,E){return E=typeof E=="boolean"&&E,re[b]=de,E&&H(b+" 0 obj"),b},Oa=f.__private__.newAdditionalObject=function(){var b={objId:bs(),content:""};return Ee.push(b),b},Xi=bs(),Kn=bs(),Jn=f.__private__.decodeColorString=function(b){var E=b.split(" ");if(E.length!==2||E[1]!=="g"&&E[1]!=="G")E.length===5&&(E[4]==="k"||E[4]==="K")&&(E=[(1-E[0])*(1-E[3]),(1-E[1])*(1-E[3]),(1-E[2])*(1-E[3]),"r"]);else{var $=parseFloat(E[0]);E=[$,$,$,"r"]}for(var Y="#",oe=0;oe<3;oe++)Y+=("0"+Math.floor(255*parseFloat(E[oe])).toString(16)).slice(-2);return Y},Zn=f.__private__.encodeColorString=function(b){var E;typeof b=="string"&&(b={ch1:b});var $=b.ch1,Y=b.ch2,oe=b.ch3,ge=b.ch4,_e=b.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof $=="string"&&$.charAt(0)!=="#"){var Fe=new nb($);if(Fe.ok)$=Fe.toHex();else if(!/^\d*\.?\d*$/.test($))throw new Error('Invalid color "'+$+'" passed to jsPDF.encodeColorString.')}if(typeof $=="string"&&/^#[0-9A-Fa-f]{3}$/.test($)&&($="#"+$[1]+$[1]+$[2]+$[2]+$[3]+$[3]),typeof $=="string"&&/^#[0-9A-Fa-f]{6}$/.test($)){var Ge=parseInt($.substr(1),16);$=Ge>>16&255,Y=Ge>>8&255,oe=255&Ge}if(Y===void 0||ge===void 0&&$===Y&&Y===oe)if(typeof $=="string")E=$+" "+_e[0];else switch(b.precision){case 2:E=ie($/255)+" "+_e[0];break;case 3:default:E=L($/255)+" "+_e[0]}else if(ge===void 0||Bt(ge)==="object"){if(ge&&!isNaN(ge.a)&&ge.a===0)return E=["1.","1.","1.",_e[1]].join(" ");if(typeof $=="string")E=[$,Y,oe,_e[1]].join(" ");else switch(b.precision){case 2:E=[ie($/255),ie(Y/255),ie(oe/255),_e[1]].join(" ");break;default:case 3:E=[L($/255),L(Y/255),L(oe/255),_e[1]].join(" ")}}else if(typeof $=="string")E=[$,Y,oe,ge,_e[2]].join(" ");else switch(b.precision){case 2:E=[ie($),ie(Y),ie(oe),ie(ge),_e[2]].join(" ");break;case 3:default:E=[L($),L(Y),L(oe),L(ge),_e[2]].join(" ")}return E},Ei=f.__private__.getFilters=function(){return a},On=f.__private__.putStream=function(b){var E=(b=b||{}).data||"",$=b.filters||Ei(),Y=b.alreadyAppliedFilters||[],oe=b.addLength1||!1,ge=E.length,_e=b.objectId,Fe=function(Ws){return Ws};if(h!==null&&_e===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");h!==null&&(Fe=Hs.encryptor(_e,0));var Ge={};$===!0&&($=["FlateEncode"]);var ct=b.additionalKeyValues||[],at=(Ge=Je.API.processDataByFilters!==void 0?Je.API.processDataByFilters(E,$):{data:E,reverseChain:[]}).reverseChain+(Array.isArray(Y)?Y.join(" "):Y.toString());if(Ge.data.length!==0&&(ct.push({key:"Length",value:Ge.data.length}),oe===!0&&ct.push({key:"Length1",value:ge})),at.length!=0)if(at.split("/").length-1==1)ct.push({key:"Filter",value:at});else{ct.push({key:"Filter",value:"["+at+"]"});for(var kt=0;kt<ct.length;kt+=1)if(ct[kt].key==="DecodeParms"){for(var ts=[],as=0;as<Ge.reverseChain.split("/").length-1;as+=1)ts.push("null");ts.push(ct[kt].value),ct[kt].value="["+ts.join(" ")+"]"}}H("<<");for(var ys=0;ys<ct.length;ys++)H("/"+ct[ys].key+" "+ct[ys].value);H(">>"),Ge.data.length!==0&&(H("stream"),H(Fe(Ge.data)),H("endstream"))},ki=f.__private__.putPage=function(b){var E=b.number,$=b.data,Y=b.objId,oe=b.contentsObjId;An(Y,!0),H("<</Type /Page"),H("/Parent "+b.rootDictionaryObjId+" 0 R"),H("/Resources "+b.resourceDictionaryObjId+" 0 R"),H("/MediaBox ["+parseFloat(q(b.mediaBox.bottomLeftX))+" "+parseFloat(q(b.mediaBox.bottomLeftY))+" "+q(b.mediaBox.topRightX)+" "+q(b.mediaBox.topRightY)+"]"),b.cropBox!==null&&H("/CropBox ["+q(b.cropBox.bottomLeftX)+" "+q(b.cropBox.bottomLeftY)+" "+q(b.cropBox.topRightX)+" "+q(b.cropBox.topRightY)+"]"),b.bleedBox!==null&&H("/BleedBox ["+q(b.bleedBox.bottomLeftX)+" "+q(b.bleedBox.bottomLeftY)+" "+q(b.bleedBox.topRightX)+" "+q(b.bleedBox.topRightY)+"]"),b.trimBox!==null&&H("/TrimBox ["+q(b.trimBox.bottomLeftX)+" "+q(b.trimBox.bottomLeftY)+" "+q(b.trimBox.topRightX)+" "+q(b.trimBox.topRightY)+"]"),b.artBox!==null&&H("/ArtBox ["+q(b.artBox.bottomLeftX)+" "+q(b.artBox.bottomLeftY)+" "+q(b.artBox.topRightX)+" "+q(b.artBox.topRightY)+"]"),typeof b.userUnit=="number"&&b.userUnit!==1&&H("/UserUnit "+b.userUnit),Rt.publish("putPage",{objId:Y,pageContext:rt[E],pageNumber:E,page:$}),H("/Contents "+oe+" 0 R"),H(">>"),H("endobj");var ge=$.join(`
`);return j===S.ADVANCED&&(ge+=`
Q`),An(oe,!0),On({data:ge,filters:Ei(),objectId:oe}),H("endobj"),Y},Zr=f.__private__.putPages=function(){var b,E,$=[];for(b=1;b<=rs;b++)rt[b].objId=bs(),rt[b].contentsObjId=bs();for(b=1;b<=rs;b++)$.push(ki({number:b,data:Ne[b],objId:rt[b].objId,contentsObjId:rt[b].contentsObjId,mediaBox:rt[b].mediaBox,cropBox:rt[b].cropBox,bleedBox:rt[b].bleedBox,trimBox:rt[b].trimBox,artBox:rt[b].artBox,userUnit:rt[b].userUnit,rootDictionaryObjId:Xi,resourceDictionaryObjId:Kn}));An(Xi,!0),H("<</Type /Pages");var Y="/Kids [";for(E=0;E<rs;E++)Y+=$[E]+" 0 R ";H(Y+"]"),H("/Count "+rs),H(">>"),H("endobj"),Rt.publish("postPutPages")},Ma=function(b){Rt.publish("putFont",{font:b,out:H,newObject:As,putStream:On}),b.isAlreadyPutted!==!0&&(b.objectNumber=As(),H("<<"),H("/Type /Font"),H("/BaseFont /"+xo(b.postScriptName)),H("/Subtype /Type1"),typeof b.encoding=="string"&&H("/Encoding /"+b.encoding),H("/FirstChar 32"),H("/LastChar 255"),H(">>"),H("endobj"))},Fa=function(){for(var b in Wt)Wt.hasOwnProperty(b)&&(d===!1||d===!0&&p.hasOwnProperty(b))&&Ma(Wt[b])},Da=function(b){b.objectNumber=As();var E=[];E.push({key:"Type",value:"/XObject"}),E.push({key:"Subtype",value:"/Form"}),E.push({key:"BBox",value:"["+[q(b.x),q(b.y),q(b.x+b.width),q(b.y+b.height)].join(" ")+"]"}),E.push({key:"Matrix",value:"["+b.matrix.toString()+"]"});var $=b.pages[1].join(`
`);On({data:$,additionalKeyValues:E,objectId:b.objectNumber}),H("endobj")},Ba=function(){for(var b in Ds)Ds.hasOwnProperty(b)&&Da(Ds[b])},zc=function(b,E){var $,Y=[],oe=1/(E-1);for($=0;$<1;$+=oe)Y.push($);if(Y.push(1),b[0].offset!=0){var ge={offset:0,color:b[0].color};b.unshift(ge)}if(b[b.length-1].offset!=1){var _e={offset:1,color:b[b.length-1].color};b.push(_e)}for(var Fe="",Ge=0,ct=0;ct<Y.length;ct++){for($=Y[ct];$>b[Ge+1].offset;)Ge++;var at=b[Ge].offset,kt=($-at)/(b[Ge+1].offset-at),ts=b[Ge].color,as=b[Ge+1].color;Fe+=X(Math.round((1-kt)*ts[0]+kt*as[0]).toString(16))+X(Math.round((1-kt)*ts[1]+kt*as[1]).toString(16))+X(Math.round((1-kt)*ts[2]+kt*as[2]).toString(16))}return Fe.trim()},rd=function(b,E){E||(E=21);var $=As(),Y=zc(b.colors,E),oe=[];oe.push({key:"FunctionType",value:"0"}),oe.push({key:"Domain",value:"[0.0 1.0]"}),oe.push({key:"Size",value:"["+E+"]"}),oe.push({key:"BitsPerSample",value:"8"}),oe.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),oe.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),On({data:Y,additionalKeyValues:oe,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:$}),H("endobj"),b.objectNumber=As(),H("<< /ShadingType "+b.type),H("/ColorSpace /DeviceRGB");var ge="/Coords ["+q(parseFloat(b.coords[0]))+" "+q(parseFloat(b.coords[1]))+" ";b.type===2?ge+=q(parseFloat(b.coords[2]))+" "+q(parseFloat(b.coords[3])):ge+=q(parseFloat(b.coords[2]))+" "+q(parseFloat(b.coords[3]))+" "+q(parseFloat(b.coords[4]))+" "+q(parseFloat(b.coords[5])),H(ge+="]"),b.matrix&&H("/Matrix ["+b.matrix.toString()+"]"),H("/Function "+$+" 0 R"),H("/Extend [true true]"),H(">>"),H("endobj")},ad=function(b,E){var $=bs(),Y=As();E.push({resourcesOid:$,objectOid:Y}),b.objectNumber=Y;var oe=[];oe.push({key:"Type",value:"/Pattern"}),oe.push({key:"PatternType",value:"1"}),oe.push({key:"PaintType",value:"1"}),oe.push({key:"TilingType",value:"1"}),oe.push({key:"BBox",value:"["+b.boundingBox.map(q).join(" ")+"]"}),oe.push({key:"XStep",value:q(b.xStep)}),oe.push({key:"YStep",value:q(b.yStep)}),oe.push({key:"Resources",value:$+" 0 R"}),b.matrix&&oe.push({key:"Matrix",value:"["+b.matrix.toString()+"]"}),On({data:b.stream,additionalKeyValues:oe,objectId:b.objectNumber}),H("endobj")},$a=function(b){var E;for(E in It)It.hasOwnProperty(E)&&(It[E]instanceof ga?rd(It[E]):It[E]instanceof Eo&&ad(It[E],b))},Hc=function(b){for(var E in b.objectNumber=As(),H("<<"),b)switch(E){case"opacity":H("/ca "+ie(b[E]));break;case"stroke-opacity":H("/CA "+ie(b[E]))}H(">>"),H("endobj")},od=function(){var b;for(b in is)is.hasOwnProperty(b)&&Hc(is[b])},Zo=function(){for(var b in H("/XObject <<"),Ds)Ds.hasOwnProperty(b)&&Ds[b].objectNumber>=0&&H("/"+b+" "+Ds[b].objectNumber+" 0 R");Rt.publish("putXobjectDict"),H(">>")},ld=function(){Hs.oid=As(),H("<<"),H("/Filter /Standard"),H("/V "+Hs.v),H("/R "+Hs.r),H("/U <"+Hs.toHexString(Hs.U)+">"),H("/O <"+Hs.toHexString(Hs.O)+">"),H("/P "+Hs.P),H(">>"),H("endobj")},Wc=function(){for(var b in H("/Font <<"),Wt)Wt.hasOwnProperty(b)&&(d===!1||d===!0&&p.hasOwnProperty(b))&&H("/"+b+" "+Wt[b].objectNumber+" 0 R");H(">>")},cd=function(){if(Object.keys(It).length>0){for(var b in H("/Shading <<"),It)It.hasOwnProperty(b)&&It[b]instanceof ga&&It[b].objectNumber>=0&&H("/"+b+" "+It[b].objectNumber+" 0 R");Rt.publish("putShadingPatternDict"),H(">>")}},qa=function(b){if(Object.keys(It).length>0){for(var E in H("/Pattern <<"),It)It.hasOwnProperty(E)&&It[E]instanceof f.TilingPattern&&It[E].objectNumber>=0&&It[E].objectNumber<b&&H("/"+E+" "+It[E].objectNumber+" 0 R");Rt.publish("putTilingPatternDict"),H(">>")}},hd=function(){if(Object.keys(is).length>0){var b;for(b in H("/ExtGState <<"),is)is.hasOwnProperty(b)&&is[b].objectNumber>=0&&H("/"+b+" "+is[b].objectNumber+" 0 R");Rt.publish("putGStateDict"),H(">>")}},cs=function(b){An(b.resourcesOid,!0),H("<<"),H("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Wc(),cd(),qa(b.objectOid),hd(),Zo(),H(">>"),H("endobj")},Vc=function(){var b=[];Fa(),od(),Ba(),$a(b),Rt.publish("putResources"),b.forEach(cs),cs({resourcesOid:Kn,objectOid:Number.MAX_SAFE_INTEGER}),Rt.publish("postPutResources")},Gc=function(){Rt.publish("putAdditionalObjects");for(var b=0;b<Ee.length;b++){var E=Ee[b];An(E.objId,!0),H(E.content),H("endobj")}Rt.publish("postPutAdditionalObjects")},Xc=function(b){Qt[b.fontName]=Qt[b.fontName]||{},Qt[b.fontName][b.fontStyle]=b.id},Qo=function(b,E,$,Y,oe){var ge={id:"F"+(Object.keys(Wt).length+1).toString(10),postScriptName:b,fontName:E,fontStyle:$,encoding:Y,isStandardFont:oe||!1,metadata:{}};return Rt.publish("addFont",{font:ge,instance:this}),Wt[ge.id]=ge,Xc(ge),ge.id},ud=function(b){for(var E=0,$=Se.length;E<$;E++){var Y=Qo.call(this,b[E][0],b[E][1],b[E][2],Se[E][3],!0);d===!1&&(p[Y]=!0);var oe=b[E][0].split("-");Xc({id:Y,fontName:oe[0],fontStyle:oe[1]||""})}Rt.publish("addFonts",{fonts:Wt,dictionary:Qt})},Qn=function(b){return b.foo=function(){try{return b.apply(this,arguments)}catch(Y){var E=Y.stack||"";~E.indexOf(" at ")&&(E=E.split(" at ")[1]);var $="Error in function "+E.split(`
`)[0].split("<")[0]+": "+Y.message;if(!Ze.console)throw new Error($);Ze.console.error($,Y),Ze.alert&&alert($)}},b.foo.bar=b,b.foo},Ua=function(b,E){var $,Y,oe,ge,_e,Fe,Ge,ct,at;if(oe=(E=E||{}).sourceEncoding||"Unicode",_e=E.outputEncoding,(E.autoencode||_e)&&Wt[wt].metadata&&Wt[wt].metadata[oe]&&Wt[wt].metadata[oe].encoding&&(ge=Wt[wt].metadata[oe].encoding,!_e&&Wt[wt].encoding&&(_e=Wt[wt].encoding),!_e&&ge.codePages&&(_e=ge.codePages[0]),typeof _e=="string"&&(_e=ge[_e]),_e)){for(Ge=!1,Fe=[],$=0,Y=b.length;$<Y;$++)(ct=_e[b.charCodeAt($)])?Fe.push(String.fromCharCode(ct)):Fe.push(b[$]),Fe[$].charCodeAt(0)>>8&&(Ge=!0);b=Fe.join("")}for($=b.length;Ge===void 0&&$!==0;)b.charCodeAt($-1)>>8&&(Ge=!0),$--;if(!Ge)return b;for(Fe=E.noBOM?[]:[254,255],$=0,Y=b.length;$<Y;$++){if((at=(ct=b.charCodeAt($))>>8)>>8)throw new Error("Character at position "+$+" of string '"+b+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Fe.push(at),Fe.push(ct-(at<<8))}return String.fromCharCode.apply(void 0,Fe)},un=f.__private__.pdfEscape=f.pdfEscape=function(b,E){return Ua(b,E).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},el=f.__private__.beginPage=function(b){Ne[++rs]=[],rt[rs]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(b[0]),topRightY:Number(b[1])}},Kc(rs),be(Ne[D])},Yc=function(b,E){var $,Y,oe;switch(t=E||t,typeof b=="string"&&($=x(b.toLowerCase()),Array.isArray($)&&(Y=$[0],oe=$[1])),Array.isArray(b)&&(Y=b[0]*Me,oe=b[1]*Me),isNaN(Y)&&(Y=n[0],oe=n[1]),(Y>14400||oe>14400)&&(Gt.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Y=Math.min(14400,Y),oe=Math.min(14400,oe)),n=[Y,oe],t.substr(0,1)){case"l":oe>Y&&(n=[oe,Y]);break;case"p":Y>oe&&(n=[oe,Y])}el(n),sh(il),H(ei),al!==0&&H(al+" J"),ol!==0&&H(ol+" j"),Rt.publish("addPage",{pageNumber:rs})},dd=function(b){b>0&&b<=rs&&(Ne.splice(b,1),rt.splice(b,1),rs--,D>rs&&(D=rs),this.setPage(D))},Kc=function(b){b>0&&b<=rs&&(D=b)},fd=f.__private__.getNumberOfPages=f.getNumberOfPages=function(){return Ne.length-1},Jc=function(b,E,$){var Y,oe=void 0;return $=$||{},b=b!==void 0?b:Wt[wt].fontName,E=E!==void 0?E:Wt[wt].fontStyle,Y=b.toLowerCase(),Qt[Y]!==void 0&&Qt[Y][E]!==void 0?oe=Qt[Y][E]:Qt[b]!==void 0&&Qt[b][E]!==void 0?oe=Qt[b][E]:$.disableWarning===!1&&Gt.warn("Unable to look up font label for font '"+b+"', '"+E+"'. Refer to getFontList() for available fonts."),oe||$.noFallback||(oe=Qt.times[E])==null&&(oe=Qt.times.normal),oe},pd=f.__private__.putInfo=function(){var b=As(),E=function(Y){return Y};for(var $ in h!==null&&(E=Hs.encryptor(b,0)),H("<<"),H("/Producer ("+un(E("jsPDF "+Je.version))+")"),tt)tt.hasOwnProperty($)&&tt[$]&&H("/"+$.substr(0,1).toUpperCase()+$.substr(1)+" ("+un(E(tt[$]))+")");H("/CreationDate ("+un(E(he))+")"),H(">>"),H("endobj")},tl=f.__private__.putCatalog=function(b){var E=(b=b||{}).rootDictionaryObjId||Xi;switch(As(),H("<<"),H("/Type /Catalog"),H("/Pages "+E+" 0 R"),Oe||(Oe="fullwidth"),Oe){case"fullwidth":H("/OpenAction [3 0 R /FitH null]");break;case"fullheight":H("/OpenAction [3 0 R /FitV null]");break;case"fullpage":H("/OpenAction [3 0 R /Fit]");break;case"original":H("/OpenAction [3 0 R /XYZ null null 1]");break;default:var $=""+Oe;$.substr($.length-1)==="%"&&(Oe=parseInt(Oe)/100),typeof Oe=="number"&&H("/OpenAction [3 0 R /XYZ null null "+ie(Oe)+"]")}switch(vt||(vt="continuous"),vt){case"continuous":H("/PageLayout /OneColumn");break;case"single":H("/PageLayout /SinglePage");break;case"two":case"twoleft":H("/PageLayout /TwoColumnLeft");break;case"tworight":H("/PageLayout /TwoColumnRight")}it&&H("/PageMode /"+it),Rt.publish("putCatalog"),H(">>"),H("endobj")},md=f.__private__.putTrailer=function(){H("trailer"),H("<<"),H("/Size "+(ee+1)),H("/Root "+ee+" 0 R"),H("/Info "+(ee-1)+" 0 R"),h!==null&&H("/Encrypt "+Hs.oid+" 0 R"),H("/ID [ <"+ae+"> <"+ae+"> ]"),H(">>")},gd=f.__private__.putHeader=function(){H("%PDF-"+v),H("%ÂºÃŸÂ¬Ã ")},bd=f.__private__.putXRef=function(){var b="0000000000";H("xref"),H("0 "+(ee+1)),H("0000000000 65535 f ");for(var E=1;E<=ee;E++)typeof re[E]=="function"?H((b+re[E]()).slice(-10)+" 00000 n "):re[E]!==void 0?H((b+re[E]).slice(-10)+" 00000 n "):H("0000000000 00000 n ")},Yi=f.__private__.buildDocument=function(){Ke(),be(ue),Rt.publish("buildDocument"),gd(),Zr(),Gc(),Vc(),h!==null&&ld(),pd(),tl();var b=de;return bd(),md(),H("startxref"),H(""+b),H("%%EOF"),be(Ne[D]),ue.join(`
`)},za=f.__private__.getBlob=function(b){return new Blob([Ue(b)],{type:"application/pdf"})},Ha=f.output=f.__private__.output=Qn(function(b,E){switch(typeof(E=E||{})=="string"?E={filename:E}:E.filename=E.filename||"generated.pdf",b){case void 0:return Yi();case"save":f.save(E.filename);break;case"arraybuffer":return Ue(Yi());case"blob":return za(Yi());case"bloburi":case"bloburl":if(Ze.URL!==void 0&&typeof Ze.URL.createObjectURL=="function")return Ze.URL&&Ze.URL.createObjectURL(za(Yi()))||void 0;Gt.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var $="",Y=Yi();try{$=Yf(Y)}catch{$=Yf(unescape(encodeURIComponent(Y)))}return"data:application/pdf;filename="+E.filename+";base64,"+$;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Ze)==="[object Window]"){var oe="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",ge=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';E.pdfObjectUrl&&(oe=E.pdfObjectUrl,ge="");var _e='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+oe+'"'+ge+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(E)+");<\/script></body></html>",Fe=Ze.open();return Fe!==null&&Fe.document.write(_e),Fe}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Ze)==="[object Window]"){var Ge='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(E.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+E.filename+'" width="500px" height="400px" /></body></html>',ct=Ze.open();if(ct!==null){ct.document.write(Ge);var at=this;ct.document.documentElement.querySelector("#pdfViewer").onload=function(){ct.document.title=E.filename,ct.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(at.output("bloburl"))}}return ct}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Ze)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var kt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",E)+'"></iframe></body></html>',ts=Ze.open();if(ts!==null&&(ts.document.write(kt),ts.document.title=E.filename),ts||typeof safari>"u")return ts;break;case"datauri":case"dataurl":return Ze.document.location.href=this.output("datauristring",E);default:return null}}),Zc=function(b){return Array.isArray(Jr)===!0&&Jr.indexOf(b)>-1};switch(s){case"pt":Me=1;break;case"mm":Me=72/25.4;break;case"cm":Me=72/2.54;break;case"in":Me=72;break;case"px":Me=Zc("px_scaling")==1?.75:96/72;break;case"pc":case"em":Me=12;break;case"ex":Me=6;break;default:if(typeof s!="number")throw new Error("Invalid unit: "+s);Me=s}var Hs=null;ke(),Z();var yd=function(b){return h!==null?Hs.encryptor(b,0):function(E){return E}},Qc=f.__private__.getPageInfo=f.getPageInfo=function(b){if(isNaN(b)||b%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:rt[b].objId,pageNumber:b,pageContext:rt[b]}},st=f.__private__.getPageInfoByObjId=function(b){if(isNaN(b)||b%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var E in rt)if(rt[E].objId===b)break;return Qc(E)},vd=f.__private__.getCurrentPageInfo=f.getCurrentPageInfo=function(){return{objId:rt[D].objId,pageNumber:D,pageContext:rt[D]}};f.addPage=function(){return Yc.apply(this,arguments),this},f.setPage=function(){return Kc.apply(this,arguments),be.call(this,Ne[D]),this},f.insertPage=function(b){return this.addPage(),this.movePage(D,b),this},f.movePage=function(b,E){var $,Y;if(b>E){$=Ne[b],Y=rt[b];for(var oe=b;oe>E;oe--)Ne[oe]=Ne[oe-1],rt[oe]=rt[oe-1];Ne[E]=$,rt[E]=Y,this.setPage(E)}else if(b<E){$=Ne[b],Y=rt[b];for(var ge=b;ge<E;ge++)Ne[ge]=Ne[ge+1],rt[ge]=rt[ge+1];Ne[E]=$,rt[E]=Y,this.setPage(E)}return this},f.deletePage=function(){return dd.apply(this,arguments),this},f.__private__.text=f.text=function(b,E,$,Y,oe){var ge,_e,Fe,Ge,ct,at,kt,ts,as,ys=(Y=Y||{}).scope||this;if(typeof b=="number"&&typeof E=="number"&&(typeof $=="string"||Array.isArray($))){var Ws=$;$=E,E=b,b=Ws}if(arguments[3]instanceof Ye?(O("The transform parameter of text() with a Matrix value"),as=oe):(Fe=arguments[4],Ge=arguments[5],Bt(kt=arguments[3])==="object"&&kt!==null||(typeof Fe=="string"&&(Ge=Fe,Fe=null),typeof kt=="string"&&(Ge=kt,kt=null),typeof kt=="number"&&(Fe=kt,kt=null),Y={flags:kt,angle:Fe,align:Ge})),isNaN(E)||isNaN($)||b==null)throw new Error("Invalid arguments passed to jsPDF.text");if(b.length===0)return ys;var Ts="",ti=!1,Sn=typeof Y.lineHeightFactor=="number"?Y.lineHeightFactor:ea,Li=ys.internal.scaleFactor;function lh(Yt){return Yt=Yt.split("	").join(Array(Y.TabLen||9).join(" ")),un(Yt,kt)}function dl(Yt){for(var Kt,us=Yt.concat(),Ss=[],er=us.length;er--;)typeof(Kt=us.shift())=="string"?Ss.push(Kt):Array.isArray(Yt)&&(Kt.length===1||Kt[1]===void 0&&Kt[2]===void 0)?Ss.push(Kt[0]):Ss.push([Kt[0],Kt[1],Kt[2]]);return Ss}function fl(Yt,Kt){var us;if(typeof Yt=="string")us=Kt(Yt)[0];else if(Array.isArray(Yt)){for(var Ss,er,xl=Yt.concat(),ro=[],fh=xl.length;fh--;)typeof(Ss=xl.shift())=="string"?ro.push(Kt(Ss)[0]):Array.isArray(Ss)&&typeof Ss[0]=="string"&&(er=Kt(Ss[0],Ss[1],Ss[2]),ro.push([er[0],er[1],er[2]]));us=ro}return us}var Ka=!1,pl=!0;if(typeof b=="string")Ka=!0;else if(Array.isArray(b)){var ml=b.concat();_e=[];for(var Ja,Bs=ml.length;Bs--;)(typeof(Ja=ml.shift())!="string"||Array.isArray(Ja)&&typeof Ja[0]!="string")&&(pl=!1);Ka=pl}if(Ka===!1)throw new Error('Type of text must be string or Array. "'+b+'" is not recognized.');typeof b=="string"&&(b=b.match(/[\r?\n]/)?b.split(/\r\n|\r|\n/g):[b]);var Za=Ce/ys.internal.scaleFactor,Qa=Za*(Sn-1);switch(Y.baseline){case"bottom":$-=Qa;break;case"top":$+=Za-Qa;break;case"hanging":$+=Za-2*Qa;break;case"middle":$+=Za/2-Qa}if((at=Y.maxWidth||0)>0&&(typeof b=="string"?b=ys.splitTextToSize(b,at):Object.prototype.toString.call(b)==="[object Array]"&&(b=b.reduce(function(Yt,Kt){return Yt.concat(ys.splitTextToSize(Kt,at))},[]))),ge={text:b,x:E,y:$,options:Y,mutex:{pdfEscape:un,activeFontKey:wt,fonts:Wt,activeFontSize:Ce}},Rt.publish("preProcessText",ge),b=ge.text,Fe=(Y=ge.options).angle,!(as instanceof Ye)&&Fe&&typeof Fe=="number"){Fe*=Math.PI/180,Y.rotationDirection===0&&(Fe=-Fe),j===S.ADVANCED&&(Fe=-Fe);var eo=Math.cos(Fe),gl=Math.sin(Fe);as=new Ye(eo,gl,-gl,eo,0,0)}else Fe&&Fe instanceof Ye&&(as=Fe);j!==S.ADVANCED||as||(as=Ni),(ct=Y.charSpace||Ga)!==void 0&&(Ts+=q(R(ct))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(ts=Y.horizontalScale)!==void 0&&(Ts+=q(100*ts)+` Tz
`),Y.lang;var dn=-1,Pd=Y.renderingMode!==void 0?Y.renderingMode:Y.stroke,bl=ys.internal.getCurrentPageInfo().pageContext;switch(Pd){case 0:case!1:case"fill":dn=0;break;case 1:case!0:case"stroke":dn=1;break;case 2:case"fillThenStroke":dn=2;break;case 3:case"invisible":dn=3;break;case 4:case"fillAndAddForClipping":dn=4;break;case 5:case"strokeAndAddPathForClipping":dn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":dn=6;break;case 7:case"addToPathForClipping":dn=7}var ch=bl.usedRenderingMode!==void 0?bl.usedRenderingMode:-1;dn!==-1?Ts+=dn+` Tr
`:ch!==-1&&(Ts+=`0 Tr
`),dn!==-1&&(bl.usedRenderingMode=dn),Ge=Y.align||"left";var Mn,to=Ce*Sn,hh=ys.internal.pageSize.getWidth(),uh=Wt[wt];ct=Y.charSpace||Ga,at=Y.maxWidth||0,kt=Object.assign({autoencode:!0,noBOM:!0},Y.flags);var vr=[],na=function(Yt){return ys.getStringUnitWidth(Yt,{font:uh,charSpace:ct,fontSize:Ce,doKerning:!1})*Ce/Li};if(Object.prototype.toString.call(b)==="[object Array]"){var fn;_e=dl(b),Ge!=="left"&&(Mn=_e.map(na));var tn,wr=0;if(Ge==="right"){E-=Mn[0],b=[],Bs=_e.length;for(var Ji=0;Ji<Bs;Ji++)Ji===0?(tn=Pi(E),fn=Ki($)):(tn=R(wr-Mn[Ji]),fn=-to),b.push([_e[Ji],tn,fn]),wr=Mn[Ji]}else if(Ge==="center"){E-=Mn[0]/2,b=[],Bs=_e.length;for(var Zi=0;Zi<Bs;Zi++)Zi===0?(tn=Pi(E),fn=Ki($)):(tn=R((wr-Mn[Zi])/2),fn=-to),b.push([_e[Zi],tn,fn]),wr=Mn[Zi]}else if(Ge==="left"){b=[],Bs=_e.length;for(var so=0;so<Bs;so++)b.push(_e[so])}else if(Ge==="justify"&&uh.encoding==="Identity-H"){b=[],Bs=_e.length,at=at!==0?at:hh;for(var Qi=0,hs=0;hs<Bs;hs++)if(fn=hs===0?Ki($):-to,tn=hs===0?Pi(E):Qi,hs<Bs-1){var yl=R((at-Mn[hs])/(_e[hs].split(" ").length-1)),sn=_e[hs].split(" ");b.push([sn[0]+" ",tn,fn]),Qi=0;for(var Fn=1;Fn<sn.length;Fn++){var no=(na(sn[Fn-1]+" "+sn[Fn])-na(sn[Fn]))*Li+yl;Fn==sn.length-1?b.push([sn[Fn],no,0]):b.push([sn[Fn]+" ",no,0]),Qi-=no}}else b.push([_e[hs],tn,fn]);b.push(["",Qi,0])}else{if(Ge!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(b=[],Bs=_e.length,at=at!==0?at:hh,hs=0;hs<Bs;hs++)fn=hs===0?Ki($):-to,tn=hs===0?Pi(E):0,hs<Bs-1?vr.push(q(R((at-Mn[hs])/(_e[hs].split(" ").length-1)))):vr.push(0),b.push([_e[hs],tn,fn])}}var dh=typeof Y.R2L=="boolean"?Y.R2L:Ve;dh===!0&&(b=fl(b,function(Yt,Kt,us){return[Yt.split("").reverse().join(""),Kt,us]})),ge={text:b,x:E,y:$,options:Y,mutex:{pdfEscape:un,activeFontKey:wt,fonts:Wt,activeFontSize:Ce}},Rt.publish("postProcessText",ge),b=ge.text,ti=ge.mutex.isHex||!1;var vl=Wt[wt].encoding;vl!=="WinAnsiEncoding"&&vl!=="StandardEncoding"||(b=fl(b,function(Yt,Kt,us){return[lh(Yt),Kt,us]})),_e=dl(b),b=[];for(var ia,ra,xr,aa=0,io=1,oa=Array.isArray(_e[0])?io:aa,_r="",wl=function(Yt,Kt,us){var Ss="";return us instanceof Ye?(us=typeof Y.angle=="number"?Yn(us,new Ye(1,0,0,1,Yt,Kt)):Yn(new Ye(1,0,0,1,Yt,Kt),us),j===S.ADVANCED&&(us=Yn(new Ye(1,0,0,-1,0,0),us)),Ss=us.join(" ")+` Tm
`):Ss=q(Yt)+" "+q(Kt)+` Td
`,Ss},Dn=0;Dn<_e.length;Dn++){switch(_r="",oa){case io:xr=(ti?"<":"(")+_e[Dn][0]+(ti?">":")"),ia=parseFloat(_e[Dn][1]),ra=parseFloat(_e[Dn][2]);break;case aa:xr=(ti?"<":"(")+_e[Dn]+(ti?">":")"),ia=Pi(E),ra=Ki($)}vr!==void 0&&vr[Dn]!==void 0&&(_r=vr[Dn]+` Tw
`),Dn===0?b.push(_r+wl(ia,ra,as)+xr):oa===aa?b.push(_r+xr):oa===io&&b.push(_r+wl(ia,ra,as)+xr)}b=oa===aa?b.join(` Tj
T* `):b.join(` Tj
`),b+=` Tj
`;var Bn=`BT
/`;return Bn+=wt+" "+Ce+` Tf
`,Bn+=q(Ce*Sn)+` TL
`,Bn+=ta+`
`,Bn+=Ts,Bn+=b,H(Bn+="ET"),p[wt]=!0,ys};var wd=f.__private__.clip=f.clip=function(b){return H(b==="evenodd"?"W*":"W"),this};f.clipEvenOdd=function(){return wd("evenodd")},f.__private__.discardPath=f.discardPath=function(){return H("n"),this};var Ci=f.__private__.isValidStyle=function(b){var E=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(b)!==-1&&(E=!0),E};f.__private__.setDefaultPathOperation=f.setDefaultPathOperation=function(b){return Ci(b)&&(c=b),this};var eh=f.__private__.getStyle=f.getStyle=function(b){var E=c;switch(b){case"D":case"S":E="S";break;case"F":E="f";break;case"FD":case"DF":E="B";break;case"f":case"f*":case"B":case"B*":E=b}return E},th=f.close=function(){return H("h"),this};f.stroke=function(){return H("S"),this},f.fill=function(b){return Wa("f",b),this},f.fillEvenOdd=function(b){return Wa("f*",b),this},f.fillStroke=function(b){return Wa("B",b),this},f.fillStrokeEvenOdd=function(b){return Wa("B*",b),this};var Wa=function(b,E){Bt(E)==="object"?_d(E,b):H(b)},sl=function(b){b===null||j===S.ADVANCED&&b===void 0||(b=eh(b),H(b))};function xd(b,E,$,Y,oe){var ge=new Eo(E||this.boundingBox,$||this.xStep,Y||this.yStep,this.gState,oe||this.matrix);ge.stream=this.stream;var _e=b+"$$"+this.cloneIndex+++"$$";return hn(_e,ge),ge}var _d=function(b,E){var $=Kr[b.key],Y=It[$];if(Y instanceof ga)H("q"),H(Ad(E)),Y.gState&&f.setGState(Y.gState),H(b.matrix.toString()+" cm"),H("/"+$+" sh"),H("Q");else if(Y instanceof Eo){var oe=new Ye(1,0,0,-1,0,yr());b.matrix&&(oe=oe.multiply(b.matrix||Ni),$=xd.call(Y,b.key,b.boundingBox,b.xStep,b.yStep,oe).id),H("q"),H("/Pattern cs"),H("/"+$+" scn"),Y.gState&&f.setGState(Y.gState),H(E),H("Q")}},Ad=function(b){switch(b){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},nl=f.moveTo=function(b,E){return H(q(R(b))+" "+q(U(E))+" m"),this},Qr=f.lineTo=function(b,E){return H(q(R(b))+" "+q(U(E))+" l"),this},gr=f.curveTo=function(b,E,$,Y,oe,ge){return H([q(R(b)),q(U(E)),q(R($)),q(U(Y)),q(R(oe)),q(U(ge)),"c"].join(" ")),this};f.__private__.line=f.line=function(b,E,$,Y,oe){if(isNaN(b)||isNaN(E)||isNaN($)||isNaN(Y)||!Ci(oe))throw new Error("Invalid arguments passed to jsPDF.line");return j===S.COMPAT?this.lines([[$-b,Y-E]],b,E,[1,1],oe||"S"):this.lines([[$-b,Y-E]],b,E,[1,1]).stroke()},f.__private__.lines=f.lines=function(b,E,$,Y,oe,ge){var _e,Fe,Ge,ct,at,kt,ts,as,ys,Ws,Ts,ti;if(typeof b=="number"&&(ti=$,$=E,E=b,b=ti),Y=Y||[1,1],ge=ge||!1,isNaN(E)||isNaN($)||!Array.isArray(b)||!Array.isArray(Y)||!Ci(oe)||typeof ge!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(nl(E,$),_e=Y[0],Fe=Y[1],ct=b.length,Ws=E,Ts=$,Ge=0;Ge<ct;Ge++)(at=b[Ge]).length===2?(Ws=at[0]*_e+Ws,Ts=at[1]*Fe+Ts,Qr(Ws,Ts)):(kt=at[0]*_e+Ws,ts=at[1]*Fe+Ts,as=at[2]*_e+Ws,ys=at[3]*Fe+Ts,Ws=at[4]*_e+Ws,Ts=at[5]*Fe+Ts,gr(kt,ts,as,ys,Ws,Ts));return ge&&th(),sl(oe),this},f.path=function(b){for(var E=0;E<b.length;E++){var $=b[E],Y=$.c;switch($.op){case"m":nl(Y[0],Y[1]);break;case"l":Qr(Y[0],Y[1]);break;case"c":gr.apply(this,Y);break;case"h":th()}}return this},f.__private__.rect=f.rect=function(b,E,$,Y,oe){if(isNaN(b)||isNaN(E)||isNaN($)||isNaN(Y)||!Ci(oe))throw new Error("Invalid arguments passed to jsPDF.rect");return j===S.COMPAT&&(Y=-Y),H([q(R(b)),q(U(E)),q(R($)),q(R(Y)),"re"].join(" ")),sl(oe),this},f.__private__.triangle=f.triangle=function(b,E,$,Y,oe,ge,_e){if(isNaN(b)||isNaN(E)||isNaN($)||isNaN(Y)||isNaN(oe)||isNaN(ge)||!Ci(_e))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[$-b,Y-E],[oe-$,ge-Y],[b-oe,E-ge]],b,E,[1,1],_e,!0),this},f.__private__.roundedRect=f.roundedRect=function(b,E,$,Y,oe,ge,_e){if(isNaN(b)||isNaN(E)||isNaN($)||isNaN(Y)||isNaN(oe)||isNaN(ge)||!Ci(_e))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Fe=4/3*(Math.SQRT2-1);return oe=Math.min(oe,.5*$),ge=Math.min(ge,.5*Y),this.lines([[$-2*oe,0],[oe*Fe,0,oe,ge-ge*Fe,oe,ge],[0,Y-2*ge],[0,ge*Fe,-oe*Fe,ge,-oe,ge],[2*oe-$,0],[-oe*Fe,0,-oe,-ge*Fe,-oe,-ge],[0,2*ge-Y],[0,-ge*Fe,oe*Fe,-ge,oe,-ge]],b+oe,E,[1,1],_e,!0),this},f.__private__.ellipse=f.ellipse=function(b,E,$,Y,oe){if(isNaN(b)||isNaN(E)||isNaN($)||isNaN(Y)||!Ci(oe))throw new Error("Invalid arguments passed to jsPDF.ellipse");var ge=4/3*(Math.SQRT2-1)*$,_e=4/3*(Math.SQRT2-1)*Y;return nl(b+$,E),gr(b+$,E-_e,b+ge,E-Y,b,E-Y),gr(b-ge,E-Y,b-$,E-_e,b-$,E),gr(b-$,E+_e,b-ge,E+Y,b,E+Y),gr(b+ge,E+Y,b+$,E+_e,b+$,E),sl(oe),this},f.__private__.circle=f.circle=function(b,E,$,Y){if(isNaN(b)||isNaN(E)||isNaN($)||!Ci(Y))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(b,E,$,$,Y)},f.setFont=function(b,E,$){return $&&(E=Q(E,$)),wt=Jc(b,E,{disableWarning:!1}),this};var Sd=f.__private__.getFont=f.getFont=function(){return Wt[Jc.apply(f,arguments)]};f.__private__.getFontList=f.getFontList=function(){var b,E,$={};for(b in Qt)if(Qt.hasOwnProperty(b))for(E in $[b]=[],Qt[b])Qt[b].hasOwnProperty(E)&&$[b].push(E);return $},f.addFont=function(b,E,$,Y,oe){var ge=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&ge.indexOf(arguments[3])!==-1?oe=arguments[3]:arguments[3]&&ge.indexOf(arguments[3])==-1&&($=Q($,Y)),oe=oe||"Identity-H",Qo.call(this,b,E,$,oe)};var ea,il=i.lineWidth||.200025,Va=f.__private__.getLineWidth=f.getLineWidth=function(){return il},sh=f.__private__.setLineWidth=f.setLineWidth=function(b){return il=b,H(q(R(b))+" w"),this};f.__private__.setLineDash=Je.API.setLineDash=Je.API.setLineDashPattern=function(b,E){if(b=b||[],E=E||0,isNaN(E)||!Array.isArray(b))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return b=b.map(function($){return q(R($))}).join(" "),E=q(R(E)),H("["+b+"] "+E+" d"),this};var nh=f.__private__.getLineHeight=f.getLineHeight=function(){return Ce*ea};f.__private__.getLineHeight=f.getLineHeight=function(){return Ce*ea};var ih=f.__private__.setLineHeightFactor=f.setLineHeightFactor=function(b){return typeof(b=b||1.15)=="number"&&(ea=b),this},rh=f.__private__.getLineHeightFactor=f.getLineHeightFactor=function(){return ea};ih(i.lineHeight);var Pi=f.__private__.getHorizontalCoordinate=function(b){return R(b)},Ki=f.__private__.getVerticalCoordinate=function(b){return j===S.ADVANCED?b:rt[D].mediaBox.topRightY-rt[D].mediaBox.bottomLeftY-R(b)},Nd=f.__private__.getHorizontalCoordinateString=f.getHorizontalCoordinateString=function(b){return q(Pi(b))},br=f.__private__.getVerticalCoordinateString=f.getVerticalCoordinateString=function(b){return q(Ki(b))},ei=i.strokeColor||"0 G";f.__private__.getStrokeColor=f.getDrawColor=function(){return Jn(ei)},f.__private__.setStrokeColor=f.setDrawColor=function(b,E,$,Y){return ei=Zn({ch1:b,ch2:E,ch3:$,ch4:Y,pdfColorType:"draw",precision:2}),H(ei),this};var rl=i.fillColor||"0 g";f.__private__.getFillColor=f.getFillColor=function(){return Jn(rl)},f.__private__.setFillColor=f.setFillColor=function(b,E,$,Y){return rl=Zn({ch1:b,ch2:E,ch3:$,ch4:Y,pdfColorType:"fill",precision:2}),H(rl),this};var ta=i.textColor||"0 g",Ed=f.__private__.getTextColor=f.getTextColor=function(){return Jn(ta)};f.__private__.setTextColor=f.setTextColor=function(b,E,$,Y){return ta=Zn({ch1:b,ch2:E,ch3:$,ch4:Y,pdfColorType:"text",precision:3}),this};var Ga=i.charSpace,kd=f.__private__.getCharSpace=f.getCharSpace=function(){return parseFloat(Ga||0)};f.__private__.setCharSpace=f.setCharSpace=function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Ga=b,this};var al=0;f.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},f.__private__.setLineCap=f.setLineCap=function(b){var E=f.CapJoinStyles[b];if(E===void 0)throw new Error("Line cap style of '"+b+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return al=E,H(E+" J"),this};var ol=0;f.__private__.setLineJoin=f.setLineJoin=function(b){var E=f.CapJoinStyles[b];if(E===void 0)throw new Error("Line join style of '"+b+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ol=E,H(E+" j"),this},f.__private__.setLineMiterLimit=f.__private__.setMiterLimit=f.setLineMiterLimit=f.setMiterLimit=function(b){if(b=b||0,isNaN(b))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return H(q(R(b))+" M"),this},f.GState=bu,f.setGState=function(b){(b=typeof b=="string"?is[Xn[b]]:ah(null,b)).equals(Gi)||(H("/"+b.id+" gs"),Gi=b)};var ah=function(b,E){if(!b||!Xn[b]){var $=!1;for(var Y in is)if(is.hasOwnProperty(Y)&&is[Y].equals(E)){$=!0;break}if($)E=is[Y];else{var oe="GS"+(Object.keys(is).length+1).toString(10);is[oe]=E,E.id=oe}return b&&(Xn[b]=E.id),Rt.publish("addGState",E),E}};f.addGState=function(b,E){return ah(b,E),this},f.saveGraphicsState=function(){return H("q"),_i.push({key:wt,size:Ce,color:ta}),this},f.restoreGraphicsState=function(){H("Q");var b=_i.pop();return wt=b.key,Ce=b.size,ta=b.color,Gi=null,this},f.setCurrentTransformationMatrix=function(b){return H(b.toString()+" cm"),this},f.comment=function(b){return H("#"+b),this};var Xa=function(b,E){var $=b||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return $},set:function(ge){isNaN(ge)||($=parseFloat(ge))}});var Y=E||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Y},set:function(ge){isNaN(ge)||(Y=parseFloat(ge))}});var oe="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return oe},set:function(ge){oe=ge.toString()}}),this},ll=function(b,E,$,Y){Xa.call(this,b,E),this.type="rect";var oe=$||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return oe},set:function(_e){isNaN(_e)||(oe=parseFloat(_e))}});var ge=Y||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return ge},set:function(_e){isNaN(_e)||(ge=parseFloat(_e))}}),this},cl=function(){this.page=rs,this.currentPage=D,this.pages=Ne.slice(0),this.pagesContext=rt.slice(0),this.x=zs,this.y=Tt,this.matrix=Gn,this.width=sa(D),this.height=yr(D),this.outputDestination=Le,this.id="",this.objectNumber=-1};cl.prototype.restore=function(){rs=this.page,D=this.currentPage,rt=this.pagesContext,Ne=this.pages,zs=this.x,Tt=this.y,Gn=this.matrix,hl(D,this.width),ul(D,this.height),Le=this.outputDestination};var oh=function(b,E,$,Y,oe){Si.push(new cl),rs=D=0,Ne=[],zs=b,Tt=E,Gn=oe,el([$,Y])},Cd=function(b){if(Ai[b])Si.pop().restore();else{var E=new cl,$="Xo"+(Object.keys(Ds).length+1).toString(10);E.id=$,Ai[b]=$,Ds[$]=E,Rt.publish("addFormObject",E),Si.pop().restore()}};for(var Ya in f.beginFormObject=function(b,E,$,Y,oe){return oh(b,E,$,Y,oe),this},f.endFormObject=function(b){return Cd(b),this},f.doFormObject=function(b,E){var $=Ds[Ai[b]];return H("q"),H(E.toString()+" cm"),H("/"+$.id+" Do"),H("Q"),this},f.getFormObject=function(b){var E=Ds[Ai[b]];return{x:E.x,y:E.y,width:E.width,height:E.height,matrix:E.matrix}},f.save=function(b,E){return b=b||"generated.pdf",(E=E||{}).returnPromise=E.returnPromise||!1,E.returnPromise===!1?(fa(za(Yi()),b),typeof fa.unload=="function"&&Ze.setTimeout&&setTimeout(fa.unload,911),this):new Promise(function($,Y){try{var oe=fa(za(Yi()),b);typeof fa.unload=="function"&&Ze.setTimeout&&setTimeout(fa.unload,911),$(oe)}catch(ge){Y(ge.message)}})},Je.API)Je.API.hasOwnProperty(Ya)&&(Ya==="events"&&Je.API.events.length?function(b,E){var $,Y,oe;for(oe=E.length-1;oe!==-1;oe--)$=E[oe][0],Y=E[oe][1],b.subscribe.apply(b,[$].concat(typeof Y=="function"?[Y]:Y))}(Rt,Je.API.events):f[Ya]=Je.API[Ya]);var sa=f.getPageWidth=function(b){return(rt[b=b||D].mediaBox.topRightX-rt[b].mediaBox.bottomLeftX)/Me},hl=f.setPageWidth=function(b,E){rt[b].mediaBox.topRightX=E*Me+rt[b].mediaBox.bottomLeftX},yr=f.getPageHeight=function(b){return(rt[b=b||D].mediaBox.topRightY-rt[b].mediaBox.bottomLeftY)/Me},ul=f.setPageHeight=function(b,E){rt[b].mediaBox.topRightY=E*Me+rt[b].mediaBox.bottomLeftY};return f.internal={pdfEscape:un,getStyle:eh,getFont:Sd,getFontSize:je,getCharSpace:kd,getTextColor:Ed,getLineHeight:nh,getLineHeightFactor:rh,getLineWidth:Va,write:lt,getHorizontalCoordinate:Pi,getVerticalCoordinate:Ki,getCoordinateString:Nd,getVerticalCoordinateString:br,collections:{},newObject:As,newAdditionalObject:Oa,newObjectDeferred:bs,newObjectDeferredBegin:An,getFilters:Ei,putStream:On,events:Rt,scaleFactor:Me,pageSize:{getWidth:function(){return sa(D)},setWidth:function(b){hl(D,b)},getHeight:function(){return yr(D)},setHeight:function(b){ul(D,b)}},encryptionOptions:h,encryption:Hs,getEncryptor:yd,output:Ha,getNumberOfPages:fd,pages:Ne,out:H,f2:ie,f3:L,getPageInfo:Qc,getPageInfoByObjId:st,getCurrentPageInfo:vd,getPDFVersion:w,Point:Xa,Rectangle:ll,Matrix:Ye,hasHotfix:Zc},Object.defineProperty(f.internal.pageSize,"width",{get:function(){return sa(D)},set:function(b){hl(D,b)},enumerable:!0,configurable:!0}),Object.defineProperty(f.internal.pageSize,"height",{get:function(){return yr(D)},set:function(b){ul(D,b)},enumerable:!0,configurable:!0}),ud.call(f,Se),wt="F1",Yc(n,t),Rt.publish("initialized"),f}wo.prototype.lsbFirstWord=function(i){return String.fromCharCode(i>>0&255,i>>8&255,i>>16&255,i>>24&255)},wo.prototype.toHexString=function(i){return i.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},wo.prototype.hexToBytes=function(i){for(var e=[],t=0;t<i.length;t+=2)e.push(String.fromCharCode(parseInt(i.substr(t,2),16)));return e.join("")},wo.prototype.processOwnerPassword=function(i,e){return Jf(Kf(e).substr(0,5),i)},wo.prototype.encryptor=function(i,e){var t=Kf(this.encryptionKey+String.fromCharCode(255&i,i>>8&255,i>>16&255,255&e,e>>8&255)).substr(0,10);return function(s){return Jf(t,s)}},bu.prototype.equals=function(i){var e,t="id,objectNumber,equals";if(!i||Bt(i)!==Bt(this))return!1;var s=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!i.hasOwnProperty(e)||this[e]!==i[e])return!1;s++}for(e in i)i.hasOwnProperty(e)&&t.indexOf(e)<0&&s--;return s===0},Je.API={events:[]},Je.version="2.5.2";var ls=Je.API,Xp=1,Ia=function(i){return i.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},mo=function(i){return i.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},ot=function(i){return i.toFixed(2)},jr=function(i){return i.toFixed(5)};ls.__acroform__={};var _n=function(i,e){i.prototype=Object.create(e.prototype),i.prototype.constructor=i},Wg=function(i){return i*Xp},Oi=function(i){var e=new ob,t=qe.internal.getHeight(i)||0,s=qe.internal.getWidth(i)||0;return e.BBox=[0,0,Number(ot(s)),Number(ot(t))],e},m3=ls.__acroform__.setBit=function(i,e){if(i=i||0,e=e||0,isNaN(i)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return i|=1<<e},g3=ls.__acroform__.clearBit=function(i,e){if(i=i||0,e=e||0,isNaN(i)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return i&=~(1<<e)},b3=ls.__acroform__.getBit=function(i,e){if(isNaN(i)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return i&1<<e?1:0},fs=ls.__acroform__.getBitForPdf=function(i,e){if(isNaN(i)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return b3(i,e-1)},ps=ls.__acroform__.setBitForPdf=function(i,e){if(isNaN(i)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return m3(i,e-1)},ms=ls.__acroform__.clearBitForPdf=function(i,e){if(isNaN(i)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return g3(i,e-1)},y3=ls.__acroform__.calculateCoordinates=function(i,e){var t=e.internal.getHorizontalCoordinate,s=e.internal.getVerticalCoordinate,n=i[0],r=i[1],a=i[2],o=i[3],l={};return l.lowerLeft_X=t(n)||0,l.lowerLeft_Y=s(r+o)||0,l.upperRight_X=t(n+a)||0,l.upperRight_Y=s(r)||0,[Number(ot(l.lowerLeft_X)),Number(ot(l.lowerLeft_Y)),Number(ot(l.upperRight_X)),Number(ot(l.upperRight_Y))]},v3=function(i){if(i.appearanceStreamContent)return i.appearanceStreamContent;if(i.V||i.DV){var e=[],t=i._V||i.DV,s=Zf(i,t),n=i.scope.internal.getFont(i.fontName,i.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(i.scope.__private__.encodeColorString(i.color)),e.push("/"+n+" "+ot(s.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(s.text),e.push("ET"),e.push("Q"),e.push("EMC");var r=Oi(i);return r.scope=i.scope,r.stream=e.join(`
`),r}},Zf=function(i,e){var t=i.fontSize===0?i.maxFontSize:i.fontSize,s={text:"",fontSize:""},n=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");n=i.multiline?n.map(function(L){return L.split(`
`)}):n.map(function(L){return[L]});var r=t,a=qe.internal.getHeight(i)||0;a=a<0?-a:a;var o=qe.internal.getWidth(i)||0;o=o<0?-o:o;var l=function(L,R,W){if(L+1<n.length){var U=R+" "+n[L+1][0];return Hh(U,i,W).width<=o-4}return!1};r++;e:for(;r>0;){e="",r--;var c,h,d=Hh("3",i,r).height,p=i.multiline?a-r:(a-d)/2,f=p+=2,v=0,w=0,A=0;if(r<=0){e=`(...) Tj
`,e+="% Width of Text: "+Hh(e,i,r=12).width+", FieldWidth:"+o+`
`;break}for(var x="",S=0,j=0;j<n.length;j++)if(n.hasOwnProperty(j)){var M=!1;if(n[j].length!==1&&A!==n[j].length-1){if((d+2)*(S+2)+2>a)continue e;x+=n[j][A],M=!0,w=j,j--}else{x=(x+=n[j][A]+" ").substr(x.length-1)==" "?x.substr(0,x.length-1):x;var B=parseInt(j),Q=l(B,x,r),q=j>=n.length-1;if(Q&&!q){x+=" ",A=0;continue}if(Q||q){if(q)w=B;else if(i.multiline&&(d+2)*(S+2)+2>a)continue e}else{if(!i.multiline||(d+2)*(S+2)+2>a)continue e;w=B}}for(var O="",G=v;G<=w;G++){var ie=n[G];if(i.multiline){if(G===w){O+=ie[A]+" ",A=(A+1)%ie.length;continue}if(G===v){O+=ie[ie.length-1]+" ";continue}}O+=ie[0]+" "}switch(O=O.substr(O.length-1)==" "?O.substr(0,O.length-1):O,h=Hh(O,i,r).width,i.textAlign){case"right":c=o-h-2;break;case"center":c=(o-h)/2;break;case"left":default:c=2}e+=ot(c)+" "+ot(f)+` Td
`,e+="("+Ia(O)+`) Tj
`,e+=-ot(c)+` 0 Td
`,f=-(r+2),h=0,v=M?w:w+1,S++,x=""}break}return s.text=e,s.fontSize=r,s},Hh=function(i,e,t){var s=e.scope.internal.getFont(e.fontName,e.fontStyle),n=e.scope.getStringUnitWidth(i,{font:s,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:s,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:n}},w3={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},x3=function(i,e){var t={type:"reference",object:i};e.internal.getPageInfo(i.page).pageContext.annotations.find(function(s){return s.type===t.type&&s.object===t.object})===void 0&&e.internal.getPageInfo(i.page).pageContext.annotations.push(t)},_3=function(i,e){for(var t in i)if(i.hasOwnProperty(t)){var s=t,n=i[t];e.internal.newObjectDeferredBegin(n.objId,!0),Bt(n)==="object"&&typeof n.putStream=="function"&&n.putStream(),delete i[s]}},A3=function(i,e){if(e.scope=i,i.internal!==void 0&&(i.internal.acroformPlugin===void 0||i.internal.acroformPlugin.isInitialized===!1)){if(vi.FieldNum=0,i.internal.acroformPlugin=JSON.parse(JSON.stringify(w3)),i.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Xp=i.internal.scaleFactor,i.internal.acroformPlugin.acroFormDictionaryRoot=new lb,i.internal.acroformPlugin.acroFormDictionaryRoot.scope=i,i.internal.acroformPlugin.acroFormDictionaryRoot._eventID=i.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(i)}),i.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var s=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in s)if(s.hasOwnProperty(n)){var r=s[n];r.objId=void 0,r.hasAnnotation&&x3(r,t)}})(i)}),i.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(i)}),i.internal.events.subscribe("postPutPages",function(t){(function(s,n){var r=!s;for(var a in s||(n.internal.newObjectDeferredBegin(n.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),n.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),s=s||n.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(s.hasOwnProperty(a)){var o=s[a],l=[],c=o.Rect;if(o.Rect&&(o.Rect=y3(o.Rect,n)),n.internal.newObjectDeferredBegin(o.objId,!0),o.DA=qe.createDefaultAppearanceStream(o),Bt(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(l=o.getKeyValueListForStream()),o.Rect=c,o.hasAppearanceStream&&!o.appearanceStreamContent){var h=v3(o);l.push({key:"AP",value:"<</N "+h+">>"}),n.internal.acroformPlugin.xForms.push(h)}if(o.appearanceStreamContent){var d="";for(var p in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(p)){var f=o.appearanceStreamContent[p];if(d+="/"+p+" ",d+="<<",Object.keys(f).length>=1||Array.isArray(f)){for(var a in f)if(f.hasOwnProperty(a)){var v=f[a];typeof v=="function"&&(v=v.call(n,o)),d+="/"+a+" "+v+" ",n.internal.acroformPlugin.xForms.indexOf(v)>=0||n.internal.acroformPlugin.xForms.push(v)}}else typeof(v=f)=="function"&&(v=v.call(n,o)),d+="/"+a+" "+v,n.internal.acroformPlugin.xForms.indexOf(v)>=0||n.internal.acroformPlugin.xForms.push(v);d+=">>"}l.push({key:"AP",value:`<<
`+d+">>"})}n.internal.putStream({additionalKeyValues:l,objectId:o.objId}),n.internal.out("endobj")}r&&_3(n.internal.acroformPlugin.xForms,n)})(t,i)}),i.internal.acroformPlugin.isInitialized=!0}},ab=ls.__acroform__.arrayToPdfArray=function(i,e,t){var s=function(a){return a};if(Array.isArray(i)){for(var n="[",r=0;r<i.length;r++)switch(r!==0&&(n+=" "),Bt(i[r])){case"boolean":case"number":case"object":n+=i[r].toString();break;case"string":i[r].substr(0,1)!=="/"?(e!==void 0&&t&&(s=t.internal.getEncryptor(e)),n+="("+Ia(s(i[r].toString()))+")"):n+=i[r].toString()}return n+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},ff=function(i,e,t){var s=function(n){return n};return e!==void 0&&t&&(s=t.internal.getEncryptor(e)),(i=i||"").toString(),i="("+Ia(s(i))+")"},Bi=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(i){this._objId=i}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Bi.prototype.toString=function(){return this.objId+" 0 R"},Bi.prototype.putStream=function(){var i=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:i,objectId:this.objId}),this.scope.internal.out("endobj")},Bi.prototype.getKeyValueListForStream=function(){var i=[],e=Object.getOwnPropertyNames(this).filter(function(r){return r!="content"&&r!="appearanceStreamContent"&&r!="scope"&&r!="objId"&&r.substring(0,1)!="_"});for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var s=e[t],n=this[s];n&&(Array.isArray(n)?i.push({key:s,value:ab(n,this.objId,this.scope)}):n instanceof Bi?(n.scope=this.scope,i.push({key:s,value:n.objId+" 0 R"})):typeof n!="function"&&i.push({key:s,value:n}))}return i};var ob=function(){Bi.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var i,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){i=t.trim()},get:function(){return i||null}})};_n(ob,Bi);var lb=function(){Bi.call(this);var i,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(i){var t=function(s){return s};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+Ia(t(i))+")"}},set:function(t){i=t}})};_n(lb,Bi);var vi=function i(){Bi.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute F supplied.');e=x}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!fs(e,3)},set:function(x){x?this.F=ps(e,3):this.F=ms(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute Ff supplied.');t=x}});var s=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(s.length!==0)return s},set:function(x){s=x!==void 0?x:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[0])?0:s[0]},set:function(x){s[0]=x}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[1])?0:s[1]},set:function(x){s[1]=x}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[2])?0:s[2]},set:function(x){s[2]=x}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[3])?0:s[3]},set:function(x){s[3]=x}});var n="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return n},set:function(x){switch(x){case"/Btn":case"/Tx":case"/Ch":case"/Sig":n=x;break;default:throw new Error('Invalid value "'+x+'" for attribute FT supplied.')}}});var r=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!r||r.length<1){if(this instanceof yu)return;r="FieldObject"+i.FieldNum++}var x=function(S){return S};return this.scope&&(x=this.scope.internal.getEncryptor(this.objId)),"("+Ia(x(r))+")"},set:function(x){r=x.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return r},set:function(x){r=x}});var a="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return a},set:function(x){a=x}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(x){o=x}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(x){l=x}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return c===void 0?50/Xp:c},set:function(x){c=x}});var h="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return h},set:function(x){h=x}});var d="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!d||this instanceof yu||this instanceof xa))return ff(d,this.objId,this.scope)},set:function(x){x=x.toString(),d=x}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Fs?p:ff(p,this.objId,this.scope)},set:function(x){x=x.toString(),p=this instanceof Fs?x:x.substr(0,1)==="("?mo(x.substr(1,x.length-2)):mo(x)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Fs?mo(p.substr(1,p.length-1)):p},set:function(x){x=x.toString(),p=this instanceof Fs?"/"+x:x}});var f=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(f)return f},set:function(x){this.V=x}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof Fs?f:ff(f,this.objId,this.scope)},set:function(x){x=x.toString(),f=this instanceof Fs?x:x.substr(0,1)==="("?mo(x.substr(1,x.length-2)):mo(x)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Fs?mo(f.substr(1,f.length-1)):f},set:function(x){x=x.toString(),f=this instanceof Fs?"/"+x:x}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var v,w=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return w},set:function(x){x=!!x,w=x}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(v)return v},set:function(x){v=x}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,1)},set:function(x){x?this.Ff=ps(this.Ff,1):this.Ff=ms(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,2)},set:function(x){x?this.Ff=ps(this.Ff,2):this.Ff=ms(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,3)},set:function(x){x?this.Ff=ps(this.Ff,3):this.Ff=ms(this.Ff,3)}});var A=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(A!==null)return A},set:function(x){if([0,1,2].indexOf(x)===-1)throw new Error('Invalid value "'+x+'" for attribute Q supplied.');A=x}}),Object.defineProperty(this,"textAlign",{get:function(){var x;switch(A){case 0:default:x="left";break;case 1:x="center";break;case 2:x="right"}return x},configurable:!0,enumerable:!0,set:function(x){switch(x){case"right":case 2:A=2;break;case"center":case 1:A=1;break;case"left":case 0:default:A=0}}})};_n(vi,Bi);var jo=function(){vi.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var i=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return i},set:function(t){i=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return i},set:function(t){i=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return ab(e,this.objId,this.scope)},set:function(t){var s,n;n=[],typeof(s=t)=="string"&&(n=function(r,a,o){o||(o=1);for(var l,c=[];l=a.exec(r);)c.push(l[o]);return c}(s,/\((.*?)\)/g)),e=n}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,s){for(s=s||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),s!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,18)},set:function(t){t?this.Ff=ps(this.Ff,18):this.Ff=ms(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=ps(this.Ff,19):this.Ff=ms(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,20)},set:function(t){t?(this.Ff=ps(this.Ff,20),e.sort()):this.Ff=ms(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,22)},set:function(t){t?this.Ff=ps(this.Ff,22):this.Ff=ms(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,23)},set:function(t){t?this.Ff=ps(this.Ff,23):this.Ff=ms(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,27)},set:function(t){t?this.Ff=ps(this.Ff,27):this.Ff=ms(this.Ff,27)}}),this.hasAppearanceStream=!1};_n(jo,vi);var Io=function(){jo.call(this),this.fontName="helvetica",this.combo=!1};_n(Io,jo);var Ro=function(){Io.call(this),this.combo=!0};_n(Ro,Io);var su=function(){Ro.call(this),this.edit=!0};_n(su,Ro);var Fs=function(){vi.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,15)},set:function(t){t?this.Ff=ps(this.Ff,15):this.Ff=ms(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,16)},set:function(t){t?this.Ff=ps(this.Ff,16):this.Ff=ms(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,17)},set:function(t){t?this.Ff=ps(this.Ff,17):this.Ff=ms(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,26)},set:function(t){t?this.Ff=ps(this.Ff,26):this.Ff=ms(this.Ff,26)}});var i,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(r){return r};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var s,n=[];for(s in n.push("<<"),e)n.push("/"+s+" ("+Ia(t(e[s]))+")");return n.push(">>"),n.join(`
`)}},set:function(t){Bt(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return i},set:function(t){i=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return i.substr(1,i.length-1)},set:function(t){i="/"+t}})};_n(Fs,vi);var nu=function(){Fs.call(this),this.pushButton=!0};_n(nu,Fs);var Oo=function(){Fs.call(this),this.radio=!0,this.pushButton=!1;var i=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return i},set:function(e){i=e!==void 0?e:[]}})};_n(Oo,Fs);var yu=function(){var i,e;vi.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return i},set:function(n){i=n}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(n){e=n}});var t,s={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(o){return o};this.scope&&(n=this.scope.internal.getEncryptor(this.objId));var r,a=[];for(r in a.push("<<"),s)a.push("/"+r+" ("+Ia(n(s[r]))+")");return a.push(">>"),a.join(`
`)},set:function(n){Bt(n)==="object"&&(s=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return s.CA||""},set:function(n){typeof n=="string"&&(s.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(n){t="/"+n}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=qe.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};_n(yu,vi),Oo.prototype.setAppearance=function(i){if(!("createAppearanceStream"in i)||!("getCA"in i))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=i.createAppearanceStream(t.optionName),t.caption=i.getCA()}},Oo.prototype.createOption=function(i){var e=new yu;return e.Parent=this,e.optionName=i,this.Kids.push(e),S3.call(this.scope,e),e};var iu=function(){Fs.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=qe.CheckBox.createAppearanceStream()};_n(iu,Fs);var xa=function(){vi.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,13)},set:function(e){e?this.Ff=ps(this.Ff,13):this.Ff=ms(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,21)},set:function(e){e?this.Ff=ps(this.Ff,21):this.Ff=ms(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,23)},set:function(e){e?this.Ff=ps(this.Ff,23):this.Ff=ms(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,24)},set:function(e){e?this.Ff=ps(this.Ff,24):this.Ff=ms(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,25)},set:function(e){e?this.Ff=ps(this.Ff,25):this.Ff=ms(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,26)},set:function(e){e?this.Ff=ps(this.Ff,26):this.Ff=ms(this.Ff,26)}});var i=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return i},set:function(e){i=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return i},set:function(e){Number.isInteger(e)&&(i=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};_n(xa,vi);var ru=function(){xa.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,14)},set:function(i){i?this.Ff=ps(this.Ff,14):this.Ff=ms(this.Ff,14)}}),this.password=!0};_n(ru,xa);var qe={CheckBox:{createAppearanceStream:function(){return{N:{On:qe.CheckBox.YesNormal},D:{On:qe.CheckBox.YesPushDown,Off:qe.CheckBox.OffPushDown}}},YesPushDown:function(i){var e=Oi(i);e.scope=i.scope;var t=[],s=i.scope.internal.getFont(i.fontName,i.fontStyle).id,n=i.scope.__private__.encodeColorString(i.color),r=Zf(i,i.caption);return t.push("0.749023 g"),t.push("0 0 "+ot(qe.internal.getWidth(i))+" "+ot(qe.internal.getHeight(i))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+s+" "+ot(r.fontSize)+" Tf "+n),t.push("BT"),t.push(r.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(i){var e=Oi(i);e.scope=i.scope;var t=i.scope.internal.getFont(i.fontName,i.fontStyle).id,s=i.scope.__private__.encodeColorString(i.color),n=[],r=qe.internal.getHeight(i),a=qe.internal.getWidth(i),o=Zf(i,i.caption);return n.push("1 g"),n.push("0 0 "+ot(a)+" "+ot(r)+" re"),n.push("f"),n.push("q"),n.push("0 0 1 rg"),n.push("0 0 "+ot(a-1)+" "+ot(r-1)+" re"),n.push("W"),n.push("n"),n.push("0 g"),n.push("BT"),n.push("/"+t+" "+ot(o.fontSize)+" Tf "+s),n.push(o.text),n.push("ET"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(i){var e=Oi(i);e.scope=i.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+ot(qe.internal.getWidth(i))+" "+ot(qe.internal.getHeight(i))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(i){var e={D:{Off:qe.RadioButton.Circle.OffPushDown},N:{}};return e.N[i]=qe.RadioButton.Circle.YesNormal,e.D[i]=qe.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(i){var e=Oi(i);e.scope=i.scope;var t=[],s=qe.internal.getWidth(i)<=qe.internal.getHeight(i)?qe.internal.getWidth(i)/4:qe.internal.getHeight(i)/4;s=Number((.9*s).toFixed(5));var n=qe.internal.Bezier_C,r=Number((s*n).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+jr(qe.internal.getWidth(i)/2)+" "+jr(qe.internal.getHeight(i)/2)+" cm"),t.push(s+" 0 m"),t.push(s+" "+r+" "+r+" "+s+" 0 "+s+" c"),t.push("-"+r+" "+s+" -"+s+" "+r+" -"+s+" 0 c"),t.push("-"+s+" -"+r+" -"+r+" -"+s+" 0 -"+s+" c"),t.push(r+" -"+s+" "+s+" -"+r+" "+s+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(i){var e=Oi(i);e.scope=i.scope;var t=[],s=qe.internal.getWidth(i)<=qe.internal.getHeight(i)?qe.internal.getWidth(i)/4:qe.internal.getHeight(i)/4;s=Number((.9*s).toFixed(5));var n=Number((2*s).toFixed(5)),r=Number((n*qe.internal.Bezier_C).toFixed(5)),a=Number((s*qe.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+jr(qe.internal.getWidth(i)/2)+" "+jr(qe.internal.getHeight(i)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+r+" "+r+" "+n+" 0 "+n+" c"),t.push("-"+r+" "+n+" -"+n+" "+r+" -"+n+" 0 c"),t.push("-"+n+" -"+r+" -"+r+" -"+n+" 0 -"+n+" c"),t.push(r+" -"+n+" "+n+" -"+r+" "+n+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+jr(qe.internal.getWidth(i)/2)+" "+jr(qe.internal.getHeight(i)/2)+" cm"),t.push(s+" 0 m"),t.push(s+" "+a+" "+a+" "+s+" 0 "+s+" c"),t.push("-"+a+" "+s+" -"+s+" "+a+" -"+s+" 0 c"),t.push("-"+s+" -"+a+" -"+a+" -"+s+" 0 -"+s+" c"),t.push(a+" -"+s+" "+s+" -"+a+" "+s+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(i){var e=Oi(i);e.scope=i.scope;var t=[],s=qe.internal.getWidth(i)<=qe.internal.getHeight(i)?qe.internal.getWidth(i)/4:qe.internal.getHeight(i)/4;s=Number((.9*s).toFixed(5));var n=Number((2*s).toFixed(5)),r=Number((n*qe.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+jr(qe.internal.getWidth(i)/2)+" "+jr(qe.internal.getHeight(i)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+r+" "+r+" "+n+" 0 "+n+" c"),t.push("-"+r+" "+n+" -"+n+" "+r+" -"+n+" 0 c"),t.push("-"+n+" -"+r+" -"+r+" -"+n+" 0 -"+n+" c"),t.push(r+" -"+n+" "+n+" -"+r+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(i){var e={D:{Off:qe.RadioButton.Cross.OffPushDown},N:{}};return e.N[i]=qe.RadioButton.Cross.YesNormal,e.D[i]=qe.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(i){var e=Oi(i);e.scope=i.scope;var t=[],s=qe.internal.calculateCross(i);return t.push("q"),t.push("1 1 "+ot(qe.internal.getWidth(i)-2)+" "+ot(qe.internal.getHeight(i)-2)+" re"),t.push("W"),t.push("n"),t.push(ot(s.x1.x)+" "+ot(s.x1.y)+" m"),t.push(ot(s.x2.x)+" "+ot(s.x2.y)+" l"),t.push(ot(s.x4.x)+" "+ot(s.x4.y)+" m"),t.push(ot(s.x3.x)+" "+ot(s.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(i){var e=Oi(i);e.scope=i.scope;var t=qe.internal.calculateCross(i),s=[];return s.push("0.749023 g"),s.push("0 0 "+ot(qe.internal.getWidth(i))+" "+ot(qe.internal.getHeight(i))+" re"),s.push("f"),s.push("q"),s.push("1 1 "+ot(qe.internal.getWidth(i)-2)+" "+ot(qe.internal.getHeight(i)-2)+" re"),s.push("W"),s.push("n"),s.push(ot(t.x1.x)+" "+ot(t.x1.y)+" m"),s.push(ot(t.x2.x)+" "+ot(t.x2.y)+" l"),s.push(ot(t.x4.x)+" "+ot(t.x4.y)+" m"),s.push(ot(t.x3.x)+" "+ot(t.x3.y)+" l"),s.push("s"),s.push("Q"),e.stream=s.join(`
`),e},OffPushDown:function(i){var e=Oi(i);e.scope=i.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+ot(qe.internal.getWidth(i))+" "+ot(qe.internal.getHeight(i))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(i){var e=i.scope.internal.getFont(i.fontName,i.fontStyle).id,t=i.scope.__private__.encodeColorString(i.color);return"/"+e+" "+i.fontSize+" Tf "+t}};qe.internal={Bezier_C:.551915024494,calculateCross:function(i){var e=qe.internal.getWidth(i),t=qe.internal.getHeight(i),s=Math.min(e,t);return{x1:{x:(e-s)/2,y:(t-s)/2+s},x2:{x:(e-s)/2+s,y:(t-s)/2},x3:{x:(e-s)/2,y:(t-s)/2},x4:{x:(e-s)/2+s,y:(t-s)/2+s}}}},qe.internal.getWidth=function(i){var e=0;return Bt(i)==="object"&&(e=Wg(i.Rect[2])),e},qe.internal.getHeight=function(i){var e=0;return Bt(i)==="object"&&(e=Wg(i.Rect[3])),e};var S3=ls.addField=function(i){if(A3(this,i),!(i instanceof vi))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=i).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),i.page=i.scope.internal.getCurrentPageInfo().pageNumber,this};ls.AcroFormChoiceField=jo,ls.AcroFormListBox=Io,ls.AcroFormComboBox=Ro,ls.AcroFormEditBox=su,ls.AcroFormButton=Fs,ls.AcroFormPushButton=nu,ls.AcroFormRadioButton=Oo,ls.AcroFormCheckBox=iu,ls.AcroFormTextField=xa,ls.AcroFormPasswordField=ru,ls.AcroFormAppearance=qe,ls.AcroForm={ChoiceField:jo,ListBox:Io,ComboBox:Ro,EditBox:su,Button:Fs,PushButton:nu,RadioButton:Oo,CheckBox:iu,TextField:xa,PasswordField:ru,Appearance:qe},Je.AcroForm={ChoiceField:jo,ListBox:Io,ComboBox:Ro,EditBox:su,Button:Fs,PushButton:nu,RadioButton:Oo,CheckBox:iu,TextField:xa,PasswordField:ru,Appearance:qe};function cb(i){return i.reduce(function(e,t,s){return e[t]=s,e},{})}(function(i){i.__addimage__={};var e="UNKNOWN",t={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=i.__addimage__.getImageFileTypeByImageData=function(L,R){var W,U,he,ae,se,Z=e;if((R=R||e)==="RGBA"||L.data!==void 0&&L.data instanceof Uint8ClampedArray&&"height"in L&&"width"in L)return"RGBA";if(Q(L))for(se in t)for(he=t[se],W=0;W<he.length;W+=1){for(ae=!0,U=0;U<he[W].length;U+=1)if(he[W][U]!==void 0&&he[W][U]!==L[U]){ae=!1;break}if(ae===!0){Z=se;break}}else for(se in t)for(he=t[se],W=0;W<he.length;W+=1){for(ae=!0,U=0;U<he[W].length;U+=1)if(he[W][U]!==void 0&&he[W][U]!==L.charCodeAt(U)){ae=!1;break}if(ae===!0){Z=se;break}}return Z===e&&R!==e&&(Z=R),Z},n=function L(R){for(var W=this.internal.write,U=this.internal.putStream,he=(0,this.internal.getFilters)();he.indexOf("FlateEncode")!==-1;)he.splice(he.indexOf("FlateEncode"),1);R.objectId=this.internal.newObject();var ae=[];if(ae.push({key:"Type",value:"/XObject"}),ae.push({key:"Subtype",value:"/Image"}),ae.push({key:"Width",value:R.width}),ae.push({key:"Height",value:R.height}),R.colorSpace===A.INDEXED?ae.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(R.palette.length/3-1)+" "+("sMask"in R&&R.sMask!==void 0?R.objectId+2:R.objectId+1)+" 0 R]"}):(ae.push({key:"ColorSpace",value:"/"+R.colorSpace}),R.colorSpace===A.DEVICE_CMYK&&ae.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ae.push({key:"BitsPerComponent",value:R.bitsPerComponent}),"decodeParameters"in R&&R.decodeParameters!==void 0&&ae.push({key:"DecodeParms",value:"<<"+R.decodeParameters+">>"}),"transparency"in R&&Array.isArray(R.transparency)){for(var se="",Z=0,fe=R.transparency.length;Z<fe;Z++)se+=R.transparency[Z]+" "+R.transparency[Z]+" ";ae.push({key:"Mask",value:"["+se+"]"})}R.sMask!==void 0&&ae.push({key:"SMask",value:R.objectId+1+" 0 R"});var me=R.filter!==void 0?["/"+R.filter]:void 0;if(U({data:R.data,additionalKeyValues:ae,alreadyAppliedFilters:me,objectId:R.objectId}),W("endobj"),"sMask"in R&&R.sMask!==void 0){var ke="/Predictor "+R.predictor+" /Colors 1 /BitsPerComponent "+R.bitsPerComponent+" /Columns "+R.width,k={width:R.width,height:R.height,colorSpace:"DeviceGray",bitsPerComponent:R.bitsPerComponent,decodeParameters:ke,data:R.sMask};"filter"in R&&(k.filter=R.filter),L.call(this,k)}if(R.colorSpace===A.INDEXED){var D=this.internal.newObject();U({data:O(new Uint8Array(R.palette)),objectId:D}),W("endobj")}},r=function(){var L=this.internal.collections.addImage_images;for(var R in L)n.call(this,L[R])},a=function(){var L,R=this.internal.collections.addImage_images,W=this.internal.write;for(var U in R)W("/I"+(L=R[U]).index,L.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",r),this.internal.events.subscribe("putXobjectDict",a))},l=function(){var L=this.internal.collections.addImage_images;return o.call(this),L},c=function(){return Object.keys(this.internal.collections.addImage_images).length},h=function(L){return typeof i["process"+L.toUpperCase()]=="function"},d=function(L){return Bt(L)==="object"&&L.nodeType===1},p=function(L,R){if(L.nodeName==="IMG"&&L.hasAttribute("src")){var W=""+L.getAttribute("src");if(W.indexOf("data:image/")===0)return nc(unescape(W).split("base64,").pop());var U=i.loadFile(W,!0);if(U!==void 0)return U}if(L.nodeName==="CANVAS"){if(L.width===0||L.height===0)throw new Error("Given canvas must have data. Canvas width: "+L.width+", height: "+L.height);var he;switch(R){case"PNG":he="image/png";break;case"WEBP":he="image/webp";break;case"JPEG":case"JPG":default:he="image/jpeg"}return nc(L.toDataURL(he,1).split("base64,").pop())}},f=function(L){var R=this.internal.collections.addImage_images;if(R){for(var W in R)if(L===R[W].alias)return R[W]}},v=function(L,R,W){return L||R||(L=-96,R=-96),L<0&&(L=-1*W.width*72/L/this.internal.scaleFactor),R<0&&(R=-1*W.height*72/R/this.internal.scaleFactor),L===0&&(L=R*W.width/W.height),R===0&&(R=L*W.height/W.width),[L,R]},w=function(L,R,W,U,he,ae){var se=v.call(this,W,U,he),Z=this.internal.getCoordinateString,fe=this.internal.getVerticalCoordinateString,me=l.call(this);if(W=se[0],U=se[1],me[he.index]=he,ae){ae*=Math.PI/180;var ke=Math.cos(ae),k=Math.sin(ae),D=function(X){return X.toFixed(4)},z=[D(ke),D(k),D(-1*k),D(ke),0,0,"cm"]}this.internal.write("q"),ae?(this.internal.write([1,"0","0",1,Z(L),fe(R+U),"cm"].join(" ")),this.internal.write(z.join(" ")),this.internal.write([Z(W),"0","0",Z(U),"0","0","cm"].join(" "))):this.internal.write([Z(W),"0","0",Z(U),Z(L),fe(R+U),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+he.index+" Do"),this.internal.write("Q")},A=i.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};i.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var x=i.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},S=i.__addimage__.sHashCode=function(L){var R,W,U=0;if(typeof L=="string")for(W=L.length,R=0;R<W;R++)U=(U<<5)-U+L.charCodeAt(R),U|=0;else if(Q(L))for(W=L.byteLength/2,R=0;R<W;R++)U=(U<<5)-U+L[R],U|=0;return U},j=i.__addimage__.validateStringAsBase64=function(L){(L=L||"").toString().trim();var R=!0;return L.length===0&&(R=!1),L.length%4!=0&&(R=!1),/^[A-Za-z0-9+/]+$/.test(L.substr(0,L.length-2))===!1&&(R=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(L.substr(-2))===!1&&(R=!1),R},M=i.__addimage__.extractImageFromDataUrl=function(L){var R=(L=L||"").split("base64,"),W=null;if(R.length===2){var U=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(R[0]);Array.isArray(U)&&(W={mimeType:U[1],charset:U[2],data:R[1]})}return W},B=i.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};i.__addimage__.isArrayBuffer=function(L){return B()&&L instanceof ArrayBuffer};var Q=i.__addimage__.isArrayBufferView=function(L){return B()&&typeof Uint32Array<"u"&&(L instanceof Int8Array||L instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&L instanceof Uint8ClampedArray||L instanceof Int16Array||L instanceof Uint16Array||L instanceof Int32Array||L instanceof Uint32Array||L instanceof Float32Array||L instanceof Float64Array)},q=i.__addimage__.binaryStringToUint8Array=function(L){for(var R=L.length,W=new Uint8Array(R),U=0;U<R;U++)W[U]=L.charCodeAt(U);return W},O=i.__addimage__.arrayBufferToBinaryString=function(L){for(var R="",W=Q(L)?L:new Uint8Array(L),U=0;U<W.length;U+=8192)R+=String.fromCharCode.apply(null,W.subarray(U,U+8192));return R};i.addImage=function(){var L,R,W,U,he,ae,se,Z,fe;if(typeof arguments[1]=="number"?(R=e,W=arguments[1],U=arguments[2],he=arguments[3],ae=arguments[4],se=arguments[5],Z=arguments[6],fe=arguments[7]):(R=arguments[1],W=arguments[2],U=arguments[3],he=arguments[4],ae=arguments[5],se=arguments[6],Z=arguments[7],fe=arguments[8]),Bt(L=arguments[0])==="object"&&!d(L)&&"imageData"in L){var me=L;L=me.imageData,R=me.format||R||e,W=me.x||W||0,U=me.y||U||0,he=me.w||me.width||he,ae=me.h||me.height||ae,se=me.alias||se,Z=me.compression||Z,fe=me.rotation||me.angle||fe}var ke=this.internal.getFilters();if(Z===void 0&&ke.indexOf("FlateEncode")!==-1&&(Z="SLOW"),isNaN(W)||isNaN(U))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var k=G.call(this,L,R,se,Z);return w.call(this,W,U,he,ae,k,fe),this};var G=function(L,R,W,U){var he,ae,se;if(typeof L=="string"&&s(L)===e){L=unescape(L);var Z=ie(L,!1);(Z!==""||(Z=i.loadFile(L,!0))!==void 0)&&(L=Z)}if(d(L)&&(L=p(L,R)),R=s(L,R),!h(R))throw new Error("addImage does not support files of type '"+R+"', please ensure that a plugin for '"+R+"' support is added.");if(((se=W)==null||se.length===0)&&(W=function(fe){return typeof fe=="string"||Q(fe)?S(fe):Q(fe.data)?S(fe.data):null}(L)),(he=f.call(this,W))||(B()&&(L instanceof Uint8Array||R==="RGBA"||(ae=L,L=q(L))),he=this["process"+R.toUpperCase()](L,c.call(this),W,function(fe){return fe&&typeof fe=="string"&&(fe=fe.toUpperCase()),fe in i.image_compression?fe:x.NONE}(U),ae)),!he)throw new Error("An unknown error occurred whilst processing the image.");return he},ie=i.__addimage__.convertBase64ToBinaryString=function(L,R){var W;R=typeof R!="boolean"||R;var U,he="";if(typeof L=="string"){U=(W=M(L))!==null?W.data:L;try{he=nc(U)}catch(ae){if(R)throw j(U)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ae.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return he};i.getImageProperties=function(L){var R,W,U="";if(d(L)&&(L=p(L)),typeof L=="string"&&s(L)===e&&((U=ie(L,!1))===""&&(U=i.loadFile(L)||""),L=U),W=s(L),!h(W))throw new Error("addImage does not support files of type '"+W+"', please ensure that a plugin for '"+W+"' support is added.");if(!B()||L instanceof Uint8Array||(L=q(L)),!(R=this["process"+W.toUpperCase()](L)))throw new Error("An unknown error occurred whilst processing the image");return R.fileType=W,R}})(Je.API),function(i){var e=function(t){if(t!==void 0&&t!="")return!0};Je.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),i.events.push(["putPage",function(t){for(var s,n,r,a=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(t.objId),c=t.pageContext.annotations,h=!1,d=0;d<c.length&&!h;d++)switch((s=c[d]).type){case"link":(e(s.options.url)||e(s.options.pageNumber))&&(h=!0);break;case"reference":case"text":case"freetext":h=!0}if(h!=0){this.internal.write("/Annots [");for(var p=0;p<c.length;p++){s=c[p];var f=this.internal.pdfEscape,v=this.internal.getEncryptor(t.objId);switch(s.type){case"reference":this.internal.write(" "+s.object.objId+" 0 R ");break;case"text":var w=this.internal.newAdditionalObject(),A=this.internal.newAdditionalObject(),x=this.internal.getEncryptor(w.objId),S=s.title||"Note";r="<</Type /Annot /Subtype /Text "+(n="/Rect ["+a(s.bounds.x)+" "+o(s.bounds.y+s.bounds.h)+" "+a(s.bounds.x+s.bounds.w)+" "+o(s.bounds.y)+"] ")+"/Contents ("+f(x(s.contents))+")",r+=" /Popup "+A.objId+" 0 R",r+=" /P "+l.objId+" 0 R",r+=" /T ("+f(x(S))+") >>",w.content=r;var j=w.objId+" 0 R";r="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+a(s.bounds.x+30)+" "+o(s.bounds.y+s.bounds.h)+" "+a(s.bounds.x+s.bounds.w+30)+" "+o(s.bounds.y)+"] ")+" /Parent "+j,s.open&&(r+=" /Open true"),r+=" >>",A.content=r,this.internal.write(w.objId,"0 R",A.objId,"0 R");break;case"freetext":n="/Rect ["+a(s.bounds.x)+" "+o(s.bounds.y)+" "+a(s.bounds.x+s.bounds.w)+" "+o(s.bounds.y+s.bounds.h)+"] ";var M=s.color||"#000000";r="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+f(v(s.contents))+")",r+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+M+")",r+=" /Border [0 0 0]",r+=" >>",this.internal.write(r);break;case"link":if(s.options.name){var B=this.annotations._nameMap[s.options.name];s.options.pageNumber=B.page,s.options.top=B.y}else s.options.top||(s.options.top=0);if(n="/Rect ["+s.finalBounds.x+" "+s.finalBounds.y+" "+s.finalBounds.w+" "+s.finalBounds.h+"] ",r="",s.options.url)r="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+f(v(s.options.url))+") >>";else if(s.options.pageNumber)switch(r="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(s.options.pageNumber).objId+" 0 R",s.options.magFactor=s.options.magFactor||"XYZ",s.options.magFactor){case"Fit":r+=" /Fit]";break;case"FitH":r+=" /FitH "+s.options.top+"]";break;case"FitV":s.options.left=s.options.left||0,r+=" /FitV "+s.options.left+"]";break;case"XYZ":default:var Q=o(s.options.top);s.options.left=s.options.left||0,s.options.zoom===void 0&&(s.options.zoom=0),r+=" /XYZ "+s.options.left+" "+Q+" "+s.options.zoom+"]"}r!=""&&(r+=" >>",this.internal.write(r))}}this.internal.write("]")}}]),i.createAnnotation=function(t){var s=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":s.pageContext.annotations.push(t)}},i.link=function(t,s,n,r,a){var o=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:l(t),y:c(s),w:l(t+n),h:c(s+r)},options:a,type:"link"})},i.textWithLink=function(t,s,n,r){var a,o,l=this.getTextWidth(t),c=this.internal.getLineHeight()/this.internal.scaleFactor;if(r.maxWidth!==void 0){o=r.maxWidth;var h=this.splitTextToSize(t,o).length;a=Math.ceil(c*h)}else o=l,a=c;return this.text(t,s,n,r),n+=.2*c,r.align==="center"&&(s-=l/2),r.align==="right"&&(s-=l),this.link(s,n-c,o,a,r),l},i.getTextWidth=function(t){var s=this.internal.getFontSize();return this.getStringUnitWidth(t)*s/this.internal.scaleFactor}}(Je.API),function(i){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},s={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},n=[1570,1571,1573,1575];i.__arabicParser__={};var r=i.__arabicParser__.isInArabicSubstitutionA=function(w){return e[w.charCodeAt(0)]!==void 0},a=i.__arabicParser__.isArabicLetter=function(w){return typeof w=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(w)},o=i.__arabicParser__.isArabicEndLetter=function(w){return a(w)&&r(w)&&e[w.charCodeAt(0)].length<=2},l=i.__arabicParser__.isArabicAlfLetter=function(w){return a(w)&&n.indexOf(w.charCodeAt(0))>=0};i.__arabicParser__.arabicLetterHasIsolatedForm=function(w){return a(w)&&r(w)&&e[w.charCodeAt(0)].length>=1};var c=i.__arabicParser__.arabicLetterHasFinalForm=function(w){return a(w)&&r(w)&&e[w.charCodeAt(0)].length>=2};i.__arabicParser__.arabicLetterHasInitialForm=function(w){return a(w)&&r(w)&&e[w.charCodeAt(0)].length>=3};var h=i.__arabicParser__.arabicLetterHasMedialForm=function(w){return a(w)&&r(w)&&e[w.charCodeAt(0)].length==4},d=i.__arabicParser__.resolveLigatures=function(w){var A=0,x=t,S="",j=0;for(A=0;A<w.length;A+=1)x[w.charCodeAt(A)]!==void 0?(j++,typeof(x=x[w.charCodeAt(A)])=="number"&&(S+=String.fromCharCode(x),x=t,j=0),A===w.length-1&&(x=t,S+=w.charAt(A-(j-1)),A-=j-1,j=0)):(x=t,S+=w.charAt(A-j),A-=j,j=0);return S};i.__arabicParser__.isArabicDiacritic=function(w){return w!==void 0&&s[w.charCodeAt(0)]!==void 0};var p=i.__arabicParser__.getCorrectForm=function(w,A,x){return a(w)?r(w)===!1?-1:!c(w)||!a(A)&&!a(x)||!a(x)&&o(A)||o(w)&&!a(A)||o(w)&&l(A)||o(w)&&o(A)?0:h(w)&&a(A)&&!o(A)&&a(x)&&c(x)?3:o(w)||!a(x)?1:2:-1},f=function(w){var A=0,x=0,S=0,j="",M="",B="",Q=(w=w||"").split("\\s+"),q=[];for(A=0;A<Q.length;A+=1){for(q.push(""),x=0;x<Q[A].length;x+=1)j=Q[A][x],M=Q[A][x-1],B=Q[A][x+1],a(j)?(S=p(j,M,B),q[A]+=S!==-1?String.fromCharCode(e[j.charCodeAt(0)][S]):j):q[A]+=j;q[A]=d(q[A])}return q.join(" ")},v=i.__arabicParser__.processArabic=i.processArabic=function(){var w,A=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,x=[];if(Array.isArray(A)){var S=0;for(x=[],S=0;S<A.length;S+=1)Array.isArray(A[S])?x.push([f(A[S][0]),A[S][1],A[S][2]]):x.push([f(A[S])]);w=x}else w=f(A);return typeof arguments[0]=="string"?w:(arguments[0].text=w,arguments[0])};i.events.push(["preProcessText",v])}(Je.API),Je.API.autoPrint=function(i){var e;switch((i=i||{}).variant=i.variant||"non-conform",i.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(i){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(o){t=o}});var s=150;Object.defineProperty(this,"width",{get:function(){return s},set:function(o){s=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=s+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var r=[];Object.defineProperty(this,"childNodes",{get:function(){return r},set:function(o){r=o}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(o){a=o}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,s){var n;if((t=t||"2d")!=="2d")return null;for(n in s)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=s[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},i.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(Je.API),function(i){var e={left:0,top:0,bottom:0,right:0},t=!1,s=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),n.call(this))},n=function(){this.internal.__cell__.lastCell=new r,this.internal.__cell__.pages=1},r=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(w){l=w}});var c=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return c},set:function(w){c=w}});var h=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return h},set:function(w){h=w}});var d=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return d},set:function(w){d=w}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(w){p=w}});var f=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return f},set:function(w){f=w}});var v=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return v},set:function(w){v=w}}),this};r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},r.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},i.setHeaderFunction=function(l){return s.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},i.getTextDimensions=function(l,c){s.call(this);var h=(c=c||{}).fontSize||this.getFontSize(),d=c.font||this.getFont(),p=c.scaleFactor||this.internal.scaleFactor,f=0,v=0,w=0,A=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var x=c.maxWidth;x>0?typeof l=="string"?l=this.splitTextToSize(l,x):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(j,M){return j.concat(A.splitTextToSize(M,x))},[])):l=Array.isArray(l)?l:[l];for(var S=0;S<l.length;S++)f<(w=this.getStringUnitWidth(l[S],{font:d})*h)&&(f=w);return f!==0&&(v=l.length),{w:f/=p,h:Math.max((v*h*this.getLineHeightFactor()-h*(this.getLineHeightFactor()-1))/p,0)}},i.cellAddPage=function(){s.call(this),this.addPage();var l=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new r(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var a=i.cell=function(){var l;l=arguments[0]instanceof r?arguments[0]:new r(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),s.call(this);var c=this.internal.__cell__.lastCell,h=this.internal.__cell__.padding,d=this.internal.__cell__.margins||e,p=this.internal.__cell__.tableHeaderRow,f=this.internal.__cell__.printHeaders;return c.lineNumber!==void 0&&(c.lineNumber===l.lineNumber?(l.x=(c.x||0)+(c.width||0),l.y=c.y||0):c.y+c.height+l.height+d.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=d.top,f&&p&&(this.printHeaderRow(l.lineNumber,!0),l.y+=p[0].height)):l.y=c.y+c.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,t===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-h,l.y+h,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+h,{align:"center",baseline:"top",maxWidth:l.width-h-h}):this.text(l.text,l.x+h,l.y+h,{align:"left",baseline:"top",maxWidth:l.width-h-h})),this.internal.__cell__.lastCell=l,this};i.table=function(l,c,h,d,p){if(s.call(this),!h)throw new Error("No data for PDF table.");var f,v,w,A,x=[],S=[],j=[],M={},B={},Q=[],q=[],O=(p=p||{}).autoSize||!1,G=p.printHeaders!==!1,ie=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,L=p.margins||Object.assign({width:this.getPageWidth()},e),R=typeof p.padding=="number"?p.padding:3,W=p.headerBackgroundColor||"#c8c8c8",U=p.headerTextColor||"#000";if(n.call(this),this.internal.__cell__.printHeaders=G,this.internal.__cell__.margins=L,this.internal.__cell__.table_font_size=ie,this.internal.__cell__.padding=R,this.internal.__cell__.headerBackgroundColor=W,this.internal.__cell__.headerTextColor=U,this.setFontSize(ie),d==null)S=x=Object.keys(h[0]),j=x.map(function(){return"left"});else if(Array.isArray(d)&&Bt(d[0])==="object")for(x=d.map(function(me){return me.name}),S=d.map(function(me){return me.prompt||me.name||""}),j=d.map(function(me){return me.align||"left"}),f=0;f<d.length;f+=1)B[d[f].name]=d[f].width*(19.049976/25.4);else Array.isArray(d)&&typeof d[0]=="string"&&(S=x=d,j=x.map(function(){return"left"}));if(O||Array.isArray(d)&&typeof d[0]=="string")for(f=0;f<x.length;f+=1){for(M[A=x[f]]=h.map(function(me){return me[A]}),this.setFont(void 0,"bold"),Q.push(this.getTextDimensions(S[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),v=M[A],this.setFont(void 0,"normal"),w=0;w<v.length;w+=1)Q.push(this.getTextDimensions(v[w],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);B[A]=Math.max.apply(null,Q)+R+R,Q=[]}if(G){var he={};for(f=0;f<x.length;f+=1)he[x[f]]={},he[x[f]].text=S[f],he[x[f]].align=j[f];var ae=o.call(this,he,B);q=x.map(function(me){return new r(l,c,B[me],ae,he[me].text,void 0,he[me].align)}),this.setTableHeaderRow(q),this.printHeaderRow(1,!1)}var se=d.reduce(function(me,ke){return me[ke.name]=ke.align,me},{});for(f=0;f<h.length;f+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:f,data:h[f]},this);var Z=o.call(this,h[f],B);for(w=0;w<x.length;w+=1){var fe=h[f][x[w]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:f,col:w,data:fe},this),a.call(this,new r(l,c,B[x[w]],Z,fe,f+2,se[x[w]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=c,this};var o=function(l,c){var h=this.internal.__cell__.padding,d=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(l).map(function(f){var v=l[f];return this.splitTextToSize(v.hasOwnProperty("text")?v.text:v,c[f]-h-h)},this).map(function(f){return this.getLineHeightFactor()*f.length*d/p+h+h},this).reduce(function(f,v){return Math.max(f,v)},0)};i.setTableHeaderRow=function(l){s.call(this),this.internal.__cell__.tableHeaderRow=l},i.printHeaderRow=function(l,c){if(s.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var h;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var d=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new r(d[0],d[1],d[2],d[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],f=0;f<this.internal.__cell__.tableHeaderRow.length;f+=1){h=this.internal.__cell__.tableHeaderRow[f].clone(),c&&(h.y=this.internal.__cell__.margins.top||0,p.push(h)),h.lineNumber=l;var v=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),a.call(this,h),this.setTextColor(v)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),t=!1}}(Je.API);var hb={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},ub=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Qf=cb(ub),db=[100,200,300,400,500,600,700,800,900],N3=cb(db);function ep(i){var e=i.family.replace(/"|'/g,"").toLowerCase(),t=function(r){return hb[r=r||"normal"]?r:"normal"}(i.style),s=function(r){if(!r)return 400;if(typeof r=="number")return r>=100&&r<=900&&r%100==0?r:400;if(/^\d00$/.test(r))return parseInt(r);switch(r){case"bold":return 700;case"normal":default:return 400}}(i.weight),n=function(r){return typeof Qf[r=r||"normal"]=="number"?r:"normal"}(i.stretch);return{family:e,style:t,weight:s,stretch:n,src:i.src||[],ref:i.ref||{name:e,style:[n,t,s].join(" ")}}}function Vg(i,e,t,s){var n;for(n=t;n>=0&&n<e.length;n+=s)if(i[e[n]])return i[e[n]];for(n=t;n>=0&&n<e.length;n-=s)if(i[e[n]])return i[e[n]]}var E3={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Gg={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Xg(i){return[i.stretch,i.style,i.weight,i.family].join(" ")}function k3(i,e,t){for(var s=(t=t||{}).defaultFontFamily||"times",n=Object.assign({},E3,t.genericFontFamilies||{}),r=null,a=null,o=0;o<e.length;++o)if(n[(r=ep(e[o])).family]&&(r.family=n[r.family]),i.hasOwnProperty(r.family)){a=i[r.family];break}if(!(a=a||i[s]))throw new Error("Could not find a font-family for the rule '"+Xg(r)+"' and default family '"+s+"'.");if(a=function(l,c){if(c[l])return c[l];var h=Qf[l],d=h<=Qf.normal?-1:1,p=Vg(c,ub,h,d);if(!p)throw new Error("Could not find a matching font-stretch value for "+l);return p}(r.stretch,a),a=function(l,c){if(c[l])return c[l];for(var h=hb[l],d=0;d<h.length;++d)if(c[h[d]])return c[h[d]];throw new Error("Could not find a matching font-style for "+l)}(r.style,a),!(a=function(l,c){if(c[l])return c[l];if(l===400&&c[500])return c[500];if(l===500&&c[400])return c[400];var h=N3[l],d=Vg(c,db,h,l<400?-1:1);if(!d)throw new Error("Could not find a matching font-weight for value "+l);return d}(r.weight,a)))throw new Error("Failed to resolve a font for the rule '"+Xg(r)+"'.");return a}function Yg(i){return i.trimLeft()}function C3(i,e){for(var t=0;t<i.length;){if(i.charAt(t)===e)return[i.substring(0,t),i.substring(t+1)];t+=1}return null}function P3(i){var e=i.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],i.substring(e[0].length)]}var Wh,Kg,Jg,pf=["times"];(function(i){var e,t,s,n,r,a,o,l,c,h=function(k){return k=k||{},this.isStrokeTransparent=k.isStrokeTransparent||!1,this.strokeOpacity=k.strokeOpacity||1,this.strokeStyle=k.strokeStyle||"#000000",this.fillStyle=k.fillStyle||"#000000",this.isFillTransparent=k.isFillTransparent||!1,this.fillOpacity=k.fillOpacity||1,this.font=k.font||"10px sans-serif",this.textBaseline=k.textBaseline||"alphabetic",this.textAlign=k.textAlign||"left",this.lineWidth=k.lineWidth||1,this.lineJoin=k.lineJoin||"miter",this.lineCap=k.lineCap||"butt",this.path=k.path||[],this.transform=k.transform!==void 0?k.transform.clone():new l,this.globalCompositeOperation=k.globalCompositeOperation||"normal",this.globalAlpha=k.globalAlpha||1,this.clip_path=k.clip_path||[],this.currentPoint=k.currentPoint||new a,this.miterLimit=k.miterLimit||10,this.lastPoint=k.lastPoint||new a,this.lineDashOffset=k.lineDashOffset||0,this.lineDash=k.lineDash||[],this.margin=k.margin||[0,0,0,0],this.prevPageLastElemOffset=k.prevPageLastElemOffset||0,this.ignoreClearRect=typeof k.ignoreClearRect!="boolean"||k.ignoreClearRect,this};i.events.push(["initialized",function(){this.context2d=new d(this),e=this.internal.f2,t=this.internal.getCoordinateString,s=this.internal.getVerticalCoordinateString,n=this.internal.getHorizontalCoordinate,r=this.internal.getVerticalCoordinate,a=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,c=new h}]);var d=function(k){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var D=k;Object.defineProperty(this,"pdf",{get:function(){return D}});var z=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return z},set:function(be){z=!!be}});var X=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return X},set:function(be){X=!!be}});var ee=0;Object.defineProperty(this,"posX",{get:function(){return ee},set:function(be){isNaN(be)||(ee=be)}});var re=0;Object.defineProperty(this,"posY",{get:function(){return re},set:function(be){isNaN(be)||(re=be)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(be){var H;typeof be=="number"?H=[be,be,be,be]:((H=new Array(4))[0]=be[0],H[1]=be.length>=2?be[1]:H[0],H[2]=be.length>=3?be[2]:H[0],H[3]=be.length>=4?be[3]:H[1]),c.margin=H}});var ue=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ue},set:function(be){ue=be}});var de=0;Object.defineProperty(this,"lastBreak",{get:function(){return de},set:function(be){de=be}});var Ee=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Ee},set:function(be){Ee=be}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(be){be instanceof h&&(c=be)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(be){c.path=be}});var Ne=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ne},set:function(be){Ne=be}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(be){var H;H=p(be),this.ctx.fillStyle=H.style,this.ctx.isFillTransparent=H.a===0,this.ctx.fillOpacity=H.a,this.pdf.setFillColor(H.r,H.g,H.b,{a:H.a}),this.pdf.setTextColor(H.r,H.g,H.b,{a:H.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(be){var H=p(be);this.ctx.strokeStyle=H.style,this.ctx.isStrokeTransparent=H.a===0,this.ctx.strokeOpacity=H.a,H.a===0?this.pdf.setDrawColor(255,255,255):(H.a,this.pdf.setDrawColor(H.r,H.g,H.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(be){["butt","round","square"].indexOf(be)!==-1&&(this.ctx.lineCap=be,this.pdf.setLineCap(be))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(be){isNaN(be)||(this.ctx.lineWidth=be,this.pdf.setLineWidth(be))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(be){["bevel","round","miter"].indexOf(be)!==-1&&(this.ctx.lineJoin=be,this.pdf.setLineJoin(be))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(be){isNaN(be)||(this.ctx.miterLimit=be,this.pdf.setMiterLimit(be))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(be){this.ctx.textBaseline=be}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(be){["right","end","center","left","start"].indexOf(be)!==-1&&(this.ctx.textAlign=be)}});var Re=null;function Le(be,H){if(Re===null){var lt=function(Ue){var Se=[];return Object.keys(Ue).forEach(function(Ce){Ue[Ce].forEach(function(Oe){var je=null;switch(Oe){case"bold":je={family:Ce,weight:"bold"};break;case"italic":je={family:Ce,style:"italic"};break;case"bolditalic":je={family:Ce,weight:"bold",style:"italic"};break;case"":case"normal":je={family:Ce}}je!==null&&(je.ref={name:Ce,style:Oe},Se.push(je))})}),Se}(be.getFontList());Re=function(Ue){for(var Se={},Ce=0;Ce<Ue.length;++Ce){var Oe=ep(Ue[Ce]),je=Oe.family,Ve=Oe.stretch,it=Oe.style,ft=Oe.weight;Se[je]=Se[je]||{},Se[je][Ve]=Se[je][Ve]||{},Se[je][Ve][it]=Se[je][Ve][it]||{},Se[je][Ve][it][ft]=Oe}return Se}(lt.concat(H))}return Re}var Ke=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ke},set:function(be){Re=null,Ke=be}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(be){var H;if(this.ctx.font=be,(H=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(be))!==null){var lt=H[1],Ue=(H[2],H[3]),Se=H[4],Ce=(H[5],H[6]),Oe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Se)[2];Se=Math.floor(Oe==="px"?parseFloat(Se)*this.pdf.internal.scaleFactor:Oe==="em"?parseFloat(Se)*this.pdf.getFontSize():parseFloat(Se)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Se);var je=function(tt){var wt,Me,zs=[],Tt=tt.trim();if(Tt==="")return pf;if(Tt in Gg)return[Gg[Tt]];for(;Tt!=="";){switch(Me=null,wt=(Tt=Yg(Tt)).charAt(0)){case'"':case"'":Me=C3(Tt.substring(1),wt);break;default:Me=P3(Tt)}if(Me===null||(zs.push(Me[0]),(Tt=Yg(Me[1]))!==""&&Tt.charAt(0)!==","))return pf;Tt=Tt.replace(/^,/,"")}return zs}(Ce);if(this.fontFaces){var Ve=k3(Le(this.pdf,this.fontFaces),je.map(function(tt){return{family:tt,stretch:"normal",weight:Ue,style:lt}}));this.pdf.setFont(Ve.ref.name,Ve.ref.style)}else{var it="";(Ue==="bold"||parseInt(Ue,10)>=700||lt==="bold")&&(it="bold"),lt==="italic"&&(it+="italic"),it.length===0&&(it="normal");for(var ft="",vt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Pt=0;Pt<je.length;Pt++){if(this.pdf.internal.getFont(je[Pt],it,{noFallback:!0,disableWarning:!0})!==void 0){ft=je[Pt];break}if(it==="bolditalic"&&this.pdf.internal.getFont(je[Pt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)ft=je[Pt],it="bold";else if(this.pdf.internal.getFont(je[Pt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){ft=je[Pt],it="normal";break}}if(ft===""){for(var qt=0;qt<je.length;qt++)if(vt[je[qt]]){ft=vt[je[qt]];break}}ft=ft===""?"Times":ft,this.pdf.setFont(ft,it)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(be){this.ctx.globalCompositeOperation=be}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(be){this.ctx.globalAlpha=be}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(be){this.ctx.lineDashOffset=be,ke.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(be){this.ctx.lineDash=be,ke.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(be){this.ctx.ignoreClearRect=!!be}})};d.prototype.setLineDash=function(k){this.lineDash=k},d.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},d.prototype.fill=function(){M.call(this,"fill",!1)},d.prototype.stroke=function(){M.call(this,"stroke",!1)},d.prototype.beginPath=function(){this.path=[{type:"begin"}]},d.prototype.moveTo=function(k,D){if(isNaN(k)||isNaN(D))throw Gt.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var z=this.ctx.transform.applyToPoint(new a(k,D));this.path.push({type:"mt",x:z.x,y:z.y}),this.ctx.lastPoint=new a(k,D)},d.prototype.closePath=function(){var k=new a(0,0),D=0;for(D=this.path.length-1;D!==-1;D--)if(this.path[D].type==="begin"&&Bt(this.path[D+1])==="object"&&typeof this.path[D+1].x=="number"){k=new a(this.path[D+1].x,this.path[D+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new a(k.x,k.y)},d.prototype.lineTo=function(k,D){if(isNaN(k)||isNaN(D))throw Gt.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var z=this.ctx.transform.applyToPoint(new a(k,D));this.path.push({type:"lt",x:z.x,y:z.y}),this.ctx.lastPoint=new a(z.x,z.y)},d.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),M.call(this,null,!0)},d.prototype.quadraticCurveTo=function(k,D,z,X){if(isNaN(z)||isNaN(X)||isNaN(k)||isNaN(D))throw Gt.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ee=this.ctx.transform.applyToPoint(new a(z,X)),re=this.ctx.transform.applyToPoint(new a(k,D));this.path.push({type:"qct",x1:re.x,y1:re.y,x:ee.x,y:ee.y}),this.ctx.lastPoint=new a(ee.x,ee.y)},d.prototype.bezierCurveTo=function(k,D,z,X,ee,re){if(isNaN(ee)||isNaN(re)||isNaN(k)||isNaN(D)||isNaN(z)||isNaN(X))throw Gt.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ue=this.ctx.transform.applyToPoint(new a(ee,re)),de=this.ctx.transform.applyToPoint(new a(k,D)),Ee=this.ctx.transform.applyToPoint(new a(z,X));this.path.push({type:"bct",x1:de.x,y1:de.y,x2:Ee.x,y2:Ee.y,x:ue.x,y:ue.y}),this.ctx.lastPoint=new a(ue.x,ue.y)},d.prototype.arc=function(k,D,z,X,ee,re){if(isNaN(k)||isNaN(D)||isNaN(z)||isNaN(X)||isNaN(ee))throw Gt.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(re=!!re,!this.ctx.transform.isIdentity){var ue=this.ctx.transform.applyToPoint(new a(k,D));k=ue.x,D=ue.y;var de=this.ctx.transform.applyToPoint(new a(0,z)),Ee=this.ctx.transform.applyToPoint(new a(0,0));z=Math.sqrt(Math.pow(de.x-Ee.x,2)+Math.pow(de.y-Ee.y,2))}Math.abs(ee-X)>=2*Math.PI&&(X=0,ee=2*Math.PI),this.path.push({type:"arc",x:k,y:D,radius:z,startAngle:X,endAngle:ee,counterclockwise:re})},d.prototype.arcTo=function(k,D,z,X,ee){throw new Error("arcTo not implemented.")},d.prototype.rect=function(k,D,z,X){if(isNaN(k)||isNaN(D)||isNaN(z)||isNaN(X))throw Gt.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(k,D),this.lineTo(k+z,D),this.lineTo(k+z,D+X),this.lineTo(k,D+X),this.lineTo(k,D),this.lineTo(k+z,D),this.lineTo(k,D)},d.prototype.fillRect=function(k,D,z,X){if(isNaN(k)||isNaN(D)||isNaN(z)||isNaN(X))throw Gt.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var ee={};this.lineCap!=="butt"&&(ee.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ee.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(k,D,z,X),this.fill(),ee.hasOwnProperty("lineCap")&&(this.lineCap=ee.lineCap),ee.hasOwnProperty("lineJoin")&&(this.lineJoin=ee.lineJoin)}},d.prototype.strokeRect=function(k,D,z,X){if(isNaN(k)||isNaN(D)||isNaN(z)||isNaN(X))throw Gt.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");v.call(this)||(this.beginPath(),this.rect(k,D,z,X),this.stroke())},d.prototype.clearRect=function(k,D,z,X){if(isNaN(k)||isNaN(D)||isNaN(z)||isNaN(X))throw Gt.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(k,D,z,X))},d.prototype.save=function(k){k=typeof k!="boolean"||k;for(var D=this.pdf.internal.getCurrentPageInfo().pageNumber,z=0;z<this.pdf.internal.getNumberOfPages();z++)this.pdf.setPage(z+1),this.pdf.internal.out("q");if(this.pdf.setPage(D),k){this.ctx.fontSize=this.pdf.internal.getFontSize();var X=new h(this.ctx);this.ctxStack.push(this.ctx),this.ctx=X}},d.prototype.restore=function(k){k=typeof k!="boolean"||k;for(var D=this.pdf.internal.getCurrentPageInfo().pageNumber,z=0;z<this.pdf.internal.getNumberOfPages();z++)this.pdf.setPage(z+1),this.pdf.internal.out("Q");this.pdf.setPage(D),k&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},d.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(k){var D,z,X,ee;if(k.isCanvasGradient===!0&&(k=k.getColor()),!k)return{r:0,g:0,b:0,a:0,style:k};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(k))D=0,z=0,X=0,ee=0;else{var re=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(k);if(re!==null)D=parseInt(re[1]),z=parseInt(re[2]),X=parseInt(re[3]),ee=1;else if((re=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(k))!==null)D=parseInt(re[1]),z=parseInt(re[2]),X=parseInt(re[3]),ee=parseFloat(re[4]);else{if(ee=1,typeof k=="string"&&k.charAt(0)!=="#"){var ue=new nb(k);k=ue.ok?ue.toHex():"#000000"}k.length===4?(D=k.substring(1,2),D+=D,z=k.substring(2,3),z+=z,X=k.substring(3,4),X+=X):(D=k.substring(1,3),z=k.substring(3,5),X=k.substring(5,7)),D=parseInt(D,16),z=parseInt(z,16),X=parseInt(X,16)}}return{r:D,g:z,b:X,a:ee,style:k}},f=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},v=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};d.prototype.fillText=function(k,D,z,X){if(isNaN(D)||isNaN(z)||typeof k!="string")throw Gt.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(X=isNaN(X)?void 0:X,!f.call(this)){var ee=Z(this.ctx.transform.rotation),re=this.ctx.transform.scaleX;R.call(this,{text:k,x:D,y:z,scale:re,angle:ee,align:this.textAlign,maxWidth:X})}},d.prototype.strokeText=function(k,D,z,X){if(isNaN(D)||isNaN(z)||typeof k!="string")throw Gt.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!v.call(this)){X=isNaN(X)?void 0:X;var ee=Z(this.ctx.transform.rotation),re=this.ctx.transform.scaleX;R.call(this,{text:k,x:D,y:z,scale:re,renderingMode:"stroke",angle:ee,align:this.textAlign,maxWidth:X})}},d.prototype.measureText=function(k){if(typeof k!="string")throw Gt.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var D=this.pdf,z=this.pdf.internal.scaleFactor,X=D.internal.getFontSize(),ee=D.getStringUnitWidth(k)*X/D.internal.scaleFactor,re=function(ue){var de=(ue=ue||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return de}}),this};return new re({width:ee*=Math.round(96*z/72*1e4)/1e4})},d.prototype.scale=function(k,D){if(isNaN(k)||isNaN(D))throw Gt.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var z=new l(k,0,0,D,0,0);this.ctx.transform=this.ctx.transform.multiply(z)},d.prototype.rotate=function(k){if(isNaN(k))throw Gt.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var D=new l(Math.cos(k),Math.sin(k),-Math.sin(k),Math.cos(k),0,0);this.ctx.transform=this.ctx.transform.multiply(D)},d.prototype.translate=function(k,D){if(isNaN(k)||isNaN(D))throw Gt.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var z=new l(1,0,0,1,k,D);this.ctx.transform=this.ctx.transform.multiply(z)},d.prototype.transform=function(k,D,z,X,ee,re){if(isNaN(k)||isNaN(D)||isNaN(z)||isNaN(X)||isNaN(ee)||isNaN(re))throw Gt.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ue=new l(k,D,z,X,ee,re);this.ctx.transform=this.ctx.transform.multiply(ue)},d.prototype.setTransform=function(k,D,z,X,ee,re){k=isNaN(k)?1:k,D=isNaN(D)?0:D,z=isNaN(z)?0:z,X=isNaN(X)?1:X,ee=isNaN(ee)?0:ee,re=isNaN(re)?0:re,this.ctx.transform=new l(k,D,z,X,ee,re)};var w=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};d.prototype.drawImage=function(k,D,z,X,ee,re,ue,de,Ee){var Ne=this.pdf.getImageProperties(k),Re=1,Le=1,Ke=1,be=1;X!==void 0&&de!==void 0&&(Ke=de/X,be=Ee/ee,Re=Ne.width/X*de/X,Le=Ne.height/ee*Ee/ee),re===void 0&&(re=D,ue=z,D=0,z=0),X!==void 0&&de===void 0&&(de=X,Ee=ee),X===void 0&&de===void 0&&(de=Ne.width,Ee=Ne.height);for(var H,lt=this.ctx.transform.decompose(),Ue=Z(lt.rotate.shx),Se=new l,Ce=(Se=(Se=(Se=Se.multiply(lt.translate)).multiply(lt.skew)).multiply(lt.scale)).applyToRectangle(new o(re-D*Ke,ue-z*be,X*Re,ee*Le)),Oe=A.call(this,Ce),je=[],Ve=0;Ve<Oe.length;Ve+=1)je.indexOf(Oe[Ve])===-1&&je.push(Oe[Ve]);if(j(je),this.autoPaging)for(var it=je[0],ft=je[je.length-1],vt=it;vt<ft+1;vt++){this.pdf.setPage(vt);var Pt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],qt=vt===1?this.posY+this.margin[0]:this.margin[0],tt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],wt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Me=vt===1?0:tt+(vt-2)*wt;if(this.ctx.clip_path.length!==0){var zs=this.path;H=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(H,this.posX+this.margin[3],-Me+qt+this.ctx.prevPageLastElemOffset),B.call(this,"fill",!0),this.path=zs}var Tt=JSON.parse(JSON.stringify(Ce));Tt=S([Tt],this.posX+this.margin[3],-Me+qt+this.ctx.prevPageLastElemOffset)[0];var Gn=(vt>it||vt<ft)&&w.call(this);Gn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Pt,wt,null).clip().discardPath()),this.pdf.addImage(k,"JPEG",Tt.x,Tt.y,Tt.w,Tt.h,null,null,Ue),Gn&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(k,"JPEG",Ce.x,Ce.y,Ce.w,Ce.h,null,null,Ue)};var A=function(k,D,z){var X=[];D=D||this.pdf.internal.pageSize.width,z=z||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ee=this.posY+this.ctx.prevPageLastElemOffset;switch(k.type){default:case"mt":case"lt":X.push(Math.floor((k.y+ee)/z)+1);break;case"arc":X.push(Math.floor((k.y+ee-k.radius)/z)+1),X.push(Math.floor((k.y+ee+k.radius)/z)+1);break;case"qct":var re=fe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,k.x1,k.y1,k.x,k.y);X.push(Math.floor((re.y+ee)/z)+1),X.push(Math.floor((re.y+re.h+ee)/z)+1);break;case"bct":var ue=me(this.ctx.lastPoint.x,this.ctx.lastPoint.y,k.x1,k.y1,k.x2,k.y2,k.x,k.y);X.push(Math.floor((ue.y+ee)/z)+1),X.push(Math.floor((ue.y+ue.h+ee)/z)+1);break;case"rect":X.push(Math.floor((k.y+ee)/z)+1),X.push(Math.floor((k.y+k.h+ee)/z)+1)}for(var de=0;de<X.length;de+=1)for(;this.pdf.internal.getNumberOfPages()<X[de];)x.call(this);return X},x=function(){var k=this.fillStyle,D=this.strokeStyle,z=this.font,X=this.lineCap,ee=this.lineWidth,re=this.lineJoin;this.pdf.addPage(),this.fillStyle=k,this.strokeStyle=D,this.font=z,this.lineCap=X,this.lineWidth=ee,this.lineJoin=re},S=function(k,D,z){for(var X=0;X<k.length;X++)switch(k[X].type){case"bct":k[X].x2+=D,k[X].y2+=z;case"qct":k[X].x1+=D,k[X].y1+=z;case"mt":case"lt":case"arc":default:k[X].x+=D,k[X].y+=z}return k},j=function(k){return k.sort(function(D,z){return D-z})},M=function(k,D){for(var z,X,ee=this.fillStyle,re=this.strokeStyle,ue=this.lineCap,de=this.lineWidth,Ee=Math.abs(de*this.ctx.transform.scaleX),Ne=this.lineJoin,Re=JSON.parse(JSON.stringify(this.path)),Le=JSON.parse(JSON.stringify(this.path)),Ke=[],be=0;be<Le.length;be++)if(Le[be].x!==void 0)for(var H=A.call(this,Le[be]),lt=0;lt<H.length;lt+=1)Ke.indexOf(H[lt])===-1&&Ke.push(H[lt]);for(var Ue=0;Ue<Ke.length;Ue++)for(;this.pdf.internal.getNumberOfPages()<Ke[Ue];)x.call(this);if(j(Ke),this.autoPaging)for(var Se=Ke[0],Ce=Ke[Ke.length-1],Oe=Se;Oe<Ce+1;Oe++){this.pdf.setPage(Oe),this.fillStyle=ee,this.strokeStyle=re,this.lineCap=ue,this.lineWidth=Ee,this.lineJoin=Ne;var je=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ve=Oe===1?this.posY+this.margin[0]:this.margin[0],it=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ft=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],vt=Oe===1?0:it+(Oe-2)*ft;if(this.ctx.clip_path.length!==0){var Pt=this.path;z=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(z,this.posX+this.margin[3],-vt+Ve+this.ctx.prevPageLastElemOffset),B.call(this,k,!0),this.path=Pt}if(X=JSON.parse(JSON.stringify(Re)),this.path=S(X,this.posX+this.margin[3],-vt+Ve+this.ctx.prevPageLastElemOffset),D===!1||Oe===0){var qt=(Oe>Se||Oe<Ce)&&w.call(this);qt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],je,ft,null).clip().discardPath()),B.call(this,k,D),qt&&this.pdf.restoreGraphicsState()}this.lineWidth=de}else this.lineWidth=Ee,B.call(this,k,D),this.lineWidth=de;this.path=Re},B=function(k,D){if((k!=="stroke"||D||!v.call(this))&&(k==="stroke"||D||!f.call(this))){for(var z,X,ee=[],re=this.path,ue=0;ue<re.length;ue++){var de=re[ue];switch(de.type){case"begin":ee.push({begin:!0});break;case"close":ee.push({close:!0});break;case"mt":ee.push({start:de,deltas:[],abs:[]});break;case"lt":var Ee=ee.length;if(re[ue-1]&&!isNaN(re[ue-1].x)&&(z=[de.x-re[ue-1].x,de.y-re[ue-1].y],Ee>0)){for(;Ee>=0;Ee--)if(ee[Ee-1].close!==!0&&ee[Ee-1].begin!==!0){ee[Ee-1].deltas.push(z),ee[Ee-1].abs.push(de);break}}break;case"bct":z=[de.x1-re[ue-1].x,de.y1-re[ue-1].y,de.x2-re[ue-1].x,de.y2-re[ue-1].y,de.x-re[ue-1].x,de.y-re[ue-1].y],ee[ee.length-1].deltas.push(z);break;case"qct":var Ne=re[ue-1].x+2/3*(de.x1-re[ue-1].x),Re=re[ue-1].y+2/3*(de.y1-re[ue-1].y),Le=de.x+2/3*(de.x1-de.x),Ke=de.y+2/3*(de.y1-de.y),be=de.x,H=de.y;z=[Ne-re[ue-1].x,Re-re[ue-1].y,Le-re[ue-1].x,Ke-re[ue-1].y,be-re[ue-1].x,H-re[ue-1].y],ee[ee.length-1].deltas.push(z);break;case"arc":ee.push({deltas:[],abs:[],arc:!0}),Array.isArray(ee[ee.length-1].abs)&&ee[ee.length-1].abs.push(de)}}X=D?null:k==="stroke"?"stroke":"fill";for(var lt=!1,Ue=0;Ue<ee.length;Ue++)if(ee[Ue].arc)for(var Se=ee[Ue].abs,Ce=0;Ce<Se.length;Ce++){var Oe=Se[Ce];Oe.type==="arc"?O.call(this,Oe.x,Oe.y,Oe.radius,Oe.startAngle,Oe.endAngle,Oe.counterclockwise,void 0,D,!lt):W.call(this,Oe.x,Oe.y),lt=!0}else if(ee[Ue].close===!0)this.pdf.internal.out("h"),lt=!1;else if(ee[Ue].begin!==!0){var je=ee[Ue].start.x,Ve=ee[Ue].start.y;U.call(this,ee[Ue].deltas,je,Ve),lt=!0}X&&G.call(this,X),D&&ie.call(this)}},Q=function(k){var D=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,z=D*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return k-z;case"top":return k+D-z;case"hanging":return k+D-2*z;case"middle":return k+D/2-z;case"ideographic":return k;case"alphabetic":default:return k}},q=function(k){return k+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};d.prototype.createLinearGradient=function(){var k=function(){};return k.colorStops=[],k.addColorStop=function(D,z){this.colorStops.push([D,z])},k.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},k.isCanvasGradient=!0,k},d.prototype.createPattern=function(){return this.createLinearGradient()},d.prototype.createRadialGradient=function(){return this.createLinearGradient()};var O=function(k,D,z,X,ee,re,ue,de,Ee){for(var Ne=ae.call(this,z,X,ee,re),Re=0;Re<Ne.length;Re++){var Le=Ne[Re];Re===0&&(Ee?L.call(this,Le.x1+k,Le.y1+D):W.call(this,Le.x1+k,Le.y1+D)),he.call(this,k,D,Le.x2,Le.y2,Le.x3,Le.y3,Le.x4,Le.y4)}de?ie.call(this):G.call(this,ue)},G=function(k){switch(k){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},ie=function(){this.pdf.clip(),this.pdf.discardPath()},L=function(k,D){this.pdf.internal.out(t(k)+" "+s(D)+" m")},R=function(k){var D;switch(k.align){case"right":case"end":D="right";break;case"center":D="center";break;case"left":case"start":default:D="left"}var z=this.pdf.getTextDimensions(k.text),X=Q.call(this,k.y),ee=q.call(this,X)-z.h,re=this.ctx.transform.applyToPoint(new a(k.x,X)),ue=this.ctx.transform.decompose(),de=new l;de=(de=(de=de.multiply(ue.translate)).multiply(ue.skew)).multiply(ue.scale);for(var Ee,Ne,Re,Le=this.ctx.transform.applyToRectangle(new o(k.x,X,z.w,z.h)),Ke=de.applyToRectangle(new o(k.x,ee,z.w,z.h)),be=A.call(this,Ke),H=[],lt=0;lt<be.length;lt+=1)H.indexOf(be[lt])===-1&&H.push(be[lt]);if(j(H),this.autoPaging)for(var Ue=H[0],Se=H[H.length-1],Ce=Ue;Ce<Se+1;Ce++){this.pdf.setPage(Ce);var Oe=Ce===1?this.posY+this.margin[0]:this.margin[0],je=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ve=this.pdf.internal.pageSize.height-this.margin[2],it=Ve-this.margin[0],ft=this.pdf.internal.pageSize.width-this.margin[1],vt=ft-this.margin[3],Pt=Ce===1?0:je+(Ce-2)*it;if(this.ctx.clip_path.length!==0){var qt=this.path;Ee=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(Ee,this.posX+this.margin[3],-1*Pt+Oe),B.call(this,"fill",!0),this.path=qt}var tt=S([JSON.parse(JSON.stringify(Ke))],this.posX+this.margin[3],-Pt+Oe+this.ctx.prevPageLastElemOffset)[0];k.scale>=.01&&(Ne=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ne*k.scale),Re=this.lineWidth,this.lineWidth=Re*k.scale);var wt=this.autoPaging!=="text";if(wt||tt.y+tt.h<=Ve){if(wt||tt.y>=Oe&&tt.x<=ft){var Me=wt?k.text:this.pdf.splitTextToSize(k.text,k.maxWidth||ft-tt.x)[0],zs=S([JSON.parse(JSON.stringify(Le))],this.posX+this.margin[3],-Pt+Oe+this.ctx.prevPageLastElemOffset)[0],Tt=wt&&(Ce>Ue||Ce<Se)&&w.call(this);Tt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],vt,it,null).clip().discardPath()),this.pdf.text(Me,zs.x,zs.y,{angle:k.angle,align:D,renderingMode:k.renderingMode}),Tt&&this.pdf.restoreGraphicsState()}}else tt.y<Ve&&(this.ctx.prevPageLastElemOffset+=Ve-tt.y);k.scale>=.01&&(this.pdf.setFontSize(Ne),this.lineWidth=Re)}else k.scale>=.01&&(Ne=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ne*k.scale),Re=this.lineWidth,this.lineWidth=Re*k.scale),this.pdf.text(k.text,re.x+this.posX,re.y+this.posY,{angle:k.angle,align:D,renderingMode:k.renderingMode,maxWidth:k.maxWidth}),k.scale>=.01&&(this.pdf.setFontSize(Ne),this.lineWidth=Re)},W=function(k,D,z,X){z=z||0,X=X||0,this.pdf.internal.out(t(k+z)+" "+s(D+X)+" l")},U=function(k,D,z){return this.pdf.lines(k,D,z,null,null)},he=function(k,D,z,X,ee,re,ue,de){this.pdf.internal.out([e(n(z+k)),e(r(X+D)),e(n(ee+k)),e(r(re+D)),e(n(ue+k)),e(r(de+D)),"c"].join(" "))},ae=function(k,D,z,X){for(var ee=2*Math.PI,re=Math.PI/2;D>z;)D-=ee;var ue=Math.abs(z-D);ue<ee&&X&&(ue=ee-ue);for(var de=[],Ee=X?-1:1,Ne=D;ue>1e-5;){var Re=Ne+Ee*Math.min(ue,re);de.push(se.call(this,k,Ne,Re)),ue-=Math.abs(Re-Ne),Ne=Re}return de},se=function(k,D,z){var X=(z-D)/2,ee=k*Math.cos(X),re=k*Math.sin(X),ue=ee,de=-re,Ee=ue*ue+de*de,Ne=Ee+ue*ee+de*re,Re=4/3*(Math.sqrt(2*Ee*Ne)-Ne)/(ue*re-de*ee),Le=ue-Re*de,Ke=de+Re*ue,be=Le,H=-Ke,lt=X+D,Ue=Math.cos(lt),Se=Math.sin(lt);return{x1:k*Math.cos(D),y1:k*Math.sin(D),x2:Le*Ue-Ke*Se,y2:Le*Se+Ke*Ue,x3:be*Ue-H*Se,y3:be*Se+H*Ue,x4:k*Math.cos(z),y4:k*Math.sin(z)}},Z=function(k){return 180*k/Math.PI},fe=function(k,D,z,X,ee,re){var ue=k+.5*(z-k),de=D+.5*(X-D),Ee=ee+.5*(z-ee),Ne=re+.5*(X-re),Re=Math.min(k,ee,ue,Ee),Le=Math.max(k,ee,ue,Ee),Ke=Math.min(D,re,de,Ne),be=Math.max(D,re,de,Ne);return new o(Re,Ke,Le-Re,be-Ke)},me=function(k,D,z,X,ee,re,ue,de){var Ee,Ne,Re,Le,Ke,be,H,lt,Ue,Se,Ce,Oe,je,Ve,it=z-k,ft=X-D,vt=ee-z,Pt=re-X,qt=ue-ee,tt=de-re;for(Ne=0;Ne<41;Ne++)Ue=(H=(Re=k+(Ee=Ne/40)*it)+Ee*((Ke=z+Ee*vt)-Re))+Ee*(Ke+Ee*(ee+Ee*qt-Ke)-H),Se=(lt=(Le=D+Ee*ft)+Ee*((be=X+Ee*Pt)-Le))+Ee*(be+Ee*(re+Ee*tt-be)-lt),Ne==0?(Ce=Ue,Oe=Se,je=Ue,Ve=Se):(Ce=Math.min(Ce,Ue),Oe=Math.min(Oe,Se),je=Math.max(je,Ue),Ve=Math.max(Ve,Se));return new o(Math.round(Ce),Math.round(Oe),Math.round(je-Ce),Math.round(Ve-Oe))},ke=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var k,D,z=(k=this.ctx.lineDash,D=this.ctx.lineDashOffset,JSON.stringify({lineDash:k,lineDashOffset:D}));this.prevLineDash!==z&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=z)}}})(Je.API),function(i){var e=function(r){var a,o,l,c,h,d,p,f,v,w;for(o=[],l=0,c=(r+=a="\0\0\0\0".slice(r.length%4||4)).length;c>l;l+=4)(h=(r.charCodeAt(l)<<24)+(r.charCodeAt(l+1)<<16)+(r.charCodeAt(l+2)<<8)+r.charCodeAt(l+3))!==0?(d=(h=((h=((h=((h=(h-(w=h%85))/85)-(v=h%85))/85)-(f=h%85))/85)-(p=h%85))/85)%85,o.push(d+33,p+33,f+33,v+33,w+33)):o.push(122);return function(A,x){for(var S=x;S>0;S--)A.pop()}(o,a.length),String.fromCharCode.apply(String,o)+"~>"},t=function(r){var a,o,l,c,h,d=String,p="length",f=255,v="charCodeAt",w="slice",A="replace";for(r[w](-2),r=r[w](0,-2)[A](/\s/g,"")[A]("z","!!!!!"),l=[],c=0,h=(r+=a="uuuuu"[w](r[p]%5||5))[p];h>c;c+=5)o=52200625*(r[v](c)-33)+614125*(r[v](c+1)-33)+7225*(r[v](c+2)-33)+85*(r[v](c+3)-33)+(r[v](c+4)-33),l.push(f&o>>24,f&o>>16,f&o>>8,f&o);return function(x,S){for(var j=S;j>0;j--)x.pop()}(l,a[p]),d.fromCharCode.apply(d,l)},s=function(r){var a=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((r=r.replace(/\s/g,"")).indexOf(">")!==-1&&(r=r.substr(0,r.indexOf(">"))),r.length%2&&(r+="0"),a.test(r)===!1)return"";for(var o="",l=0;l<r.length;l+=2)o+=String.fromCharCode("0x"+(r[l]+r[l+1]));return o},n=function(r){for(var a=new Uint8Array(r.length),o=r.length;o--;)a[o]=r.charCodeAt(o);return r=(a=Xf(a)).reduce(function(l,c){return l+String.fromCharCode(c)},"")};i.processDataByFilters=function(r,a){var o=0,l=r||"",c=[];for(typeof(a=a||[])=="string"&&(a=[a]),o=0;o<a.length;o+=1)switch(a[o]){case"ASCII85Decode":case"/ASCII85Decode":l=t(l),c.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":l=e(l),c.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":l=s(l),c.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":l=l.split("").map(function(h){return("0"+h.charCodeAt().toString(16)).slice(-2)}).join("")+">",c.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":l=n(l),c.push("/FlateDecode");break;default:throw new Error('The filter: "'+a[o]+'" is not implemented')}return{data:l,reverseChain:c.reverse().join(" ")}}}(Je.API),function(i){i.loadFile=function(e,t,s){return function(n,r,a){r=r!==!1,a=typeof a=="function"?a:function(){};var o=void 0;try{o=function(l,c,h){var d=new XMLHttpRequest,p=0,f=function(v){var w=v.length,A=[],x=String.fromCharCode;for(p=0;p<w;p+=1)A.push(x(255&v.charCodeAt(p)));return A.join("")};if(d.open("GET",l,!c),d.overrideMimeType("text/plain; charset=x-user-defined"),c===!1&&(d.onload=function(){d.status===200?h(f(this.responseText)):h(void 0)}),d.send(null),c&&d.status===200)return f(d.responseText)}(n,r,a)}catch{}return o}(e,t,s)},i.loadImageFile=i.loadFile}(Je.API),function(i){function e(){return(Ze.html2canvas?Promise.resolve(Ze.html2canvas):fr(()=>import("./html2canvas.esm-BfxBtG_O.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load html2canvas: "+a))}).then(function(a){return a.default?a.default:a})}function t(){return(Ze.DOMPurify?Promise.resolve(Ze.DOMPurify):fr(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load dompurify: "+a))}).then(function(a){return a.default?a.default:a})}var s=function(a){var o=Bt(a);return o==="undefined"?"undefined":o==="string"||a instanceof String?"string":o==="number"||a instanceof Number?"number":o==="function"||a instanceof Function?"function":a&&a.constructor===Array?"array":a&&a.nodeType===1?"element":o==="object"?"object":"unknown"},n=function(a,o){var l=document.createElement(a);for(var c in o.className&&(l.className=o.className),o.innerHTML&&o.dompurify&&(l.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)l.style[c]=o.style[c];return l},r=function a(o){var l=Object.assign(a.convert(Promise.resolve()),JSON.parse(JSON.stringify(a.template))),c=a.convert(Promise.resolve(),l);return c=(c=c.setProgress(1,a,1,[a])).set(o)};(r.prototype=Object.create(Promise.prototype)).constructor=r,r.convert=function(a,o){return a.__proto__=o||r.prototype,a},r.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},r.prototype.from=function(a,o){return this.then(function(){switch(o=o||function(l){switch(s(l)){case"string":return"string";case"element":return l.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(a)){case"string":return this.then(t).then(function(l){return this.set({src:n("div",{innerHTML:a,dompurify:l})})});case"element":return this.set({src:a});case"canvas":return this.set({canvas:a});case"img":return this.set({img:a});default:return this.error("Unknown source type.")}})},r.prototype.to=function(a){switch(a){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},r.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var a={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=function l(c,h){for(var d=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),p=c.firstChild;p;p=p.nextSibling)h!==!0&&p.nodeType===1&&p.nodeName==="SCRIPT"||d.appendChild(l(p,h));return c.nodeType===1&&(c.nodeName==="CANVAS"?(d.width=c.width,d.height=c.height,d.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(d.value=c.value),d.addEventListener("load",function(){d.scrollTop=c.scrollTop,d.scrollLeft=c.scrollLeft},!0)),d}(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(a.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=n("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=n("div",{className:"html2pdf__container",style:a}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(n("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},r.prototype.toCanvas=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(e).then(function(o){var l=Object.assign({},this.opt.html2canvas);return delete l.onrendered,o(this.prop.container,l)}).then(function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},r.prototype.toContext2d=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(e).then(function(o){var l=this.opt.jsPDF,c=this.opt.fontFaces,h=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,d=Object.assign({async:!0,allowTaint:!0,scale:h,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete d.onrendered,l.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,l.context2d.posX=this.opt.x,l.context2d.posY=this.opt.y,l.context2d.margin=this.opt.margin,l.context2d.fontFaces=c,c)for(var p=0;p<c.length;++p){var f=c[p],v=f.src.find(function(w){return w.format==="truetype"});v&&l.addFont(v.url,f.ref.name,f.ref.style)}return d.windowHeight=d.windowHeight||0,d.windowHeight=d.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):d.windowHeight,l.context2d.save(!0),o(this.prop.container,d)}).then(function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},r.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var a=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=a})},r.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},r.prototype.output=function(a,o,l){return(l=l||"pdf").toLowerCase()==="img"||l.toLowerCase()==="image"?this.outputImg(a,o):this.outputPdf(a,o)},r.prototype.outputPdf=function(a,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(a,o)})},r.prototype.outputImg=function(a){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(a){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+a+'" is not supported.'}})},r.prototype.save=function(a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(a?{filename:a}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},r.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},r.prototype.set=function(a){if(s(a)!=="object")return this;var o=Object.keys(a||{}).map(function(l){if(l in r.template.prop)return function(){this.prop[l]=a[l]};switch(l){case"margin":return this.setMargin.bind(this,a.margin);case"jsPDF":return function(){return this.opt.jsPDF=a.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,a.pageSize);default:return function(){this.opt[l]=a[l]}}},this);return this.then(function(){return this.thenList(o)})},r.prototype.get=function(a,o){return this.then(function(){var l=a in r.template.prop?this.prop[a]:this.opt[a];return o?o(l):l})},r.prototype.setMargin=function(a){return this.then(function(){switch(s(a)){case"number":a=[a,a,a,a];case"array":if(a.length===2&&(a=[a[0],a[1],a[0],a[1]]),a.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=a}).then(this.setPageSize)},r.prototype.setPageSize=function(a){function o(l,c){return Math.floor(l*c/72*96)}return this.then(function(){(a=a||Je.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(a.inner={width:a.width-this.opt.margin[1]-this.opt.margin[3],height:a.height-this.opt.margin[0]-this.opt.margin[2]},a.inner.px={width:o(a.inner.width,a.k),height:o(a.inner.height,a.k)},a.inner.ratio=a.inner.height/a.inner.width),this.prop.pageSize=a})},r.prototype.setProgress=function(a,o,l,c){return a!=null&&(this.progress.val=a),o!=null&&(this.progress.state=o),l!=null&&(this.progress.n=l),c!=null&&(this.progress.stack=c),this.progress.ratio=this.progress.val/this.progress.state,this},r.prototype.updateProgress=function(a,o,l,c){return this.setProgress(a?this.progress.val+a:null,o||null,l?this.progress.n+l:null,c?this.progress.stack.concat(c):null)},r.prototype.then=function(a,o){var l=this;return this.thenCore(a,o,function(c,h){return l.updateProgress(null,null,1,[c]),Promise.prototype.then.call(this,function(d){return l.updateProgress(null,c),d}).then(c,h).then(function(d){return l.updateProgress(1),d})})},r.prototype.thenCore=function(a,o,l){l=l||Promise.prototype.then,a&&(a=a.bind(this)),o&&(o=o.bind(this));var c=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:r.convert(Object.assign({},this),Promise.prototype),h=l.call(c,a,o);return r.convert(h,this.__proto__)},r.prototype.thenExternal=function(a,o){return Promise.prototype.then.call(this,a,o)},r.prototype.thenList=function(a){var o=this;return a.forEach(function(l){o=o.thenCore(l)}),o},r.prototype.catch=function(a){a&&(a=a.bind(this));var o=Promise.prototype.catch.call(this,a);return r.convert(o,this)},r.prototype.catchExternal=function(a){return Promise.prototype.catch.call(this,a)},r.prototype.error=function(a){return this.then(function(){throw new Error(a)})},r.prototype.using=r.prototype.set,r.prototype.saveAs=r.prototype.save,r.prototype.export=r.prototype.output,r.prototype.run=r.prototype.then,Je.getPageSize=function(a,o,l){if(Bt(a)==="object"){var c=a;a=c.orientation,o=c.unit||o,l=c.format||l}o=o||"mm",l=l||"a4",a=(""+(a||"P")).toLowerCase();var h,d=(""+l).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":h=1;break;case"mm":h=72/25.4;break;case"cm":h=72/2.54;break;case"in":h=72;break;case"px":h=.75;break;case"pc":case"em":h=12;break;case"ex":h=6;break;default:throw"Invalid unit: "+o}var f,v=0,w=0;if(p.hasOwnProperty(d))v=p[d][1]/h,w=p[d][0]/h;else try{v=l[1],w=l[0]}catch{throw new Error("Invalid format: "+l)}if(a==="p"||a==="portrait")a="p",w>v&&(f=w,w=v,v=f);else{if(a!=="l"&&a!=="landscape")throw"Invalid orientation: "+a;a="l",v>w&&(f=w,w=v,v=f)}return{width:w,height:v,unit:o,k:h,orientation:a}},i.html=function(a,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(ep):null;var l=new r(o);return o.worker?l:l.from(a).doCallback()}}(Je.API),Je.API.addJS=function(i){return Jg=i,this.internal.events.subscribe("postPutResources",function(){Wh=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Wh+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Kg=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Jg+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Wh!==void 0&&Kg!==void 0&&this.internal.out("/Names <</JavaScript "+Wh+" 0 R>>")}),this},function(i){var e;i.events.push(["postPutResources",function(){var t=this,s=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var n=t.outline.render().split(/\r\n/),r=0;r<n.length;r++){var a=n[r],o=s.exec(a);if(o!=null){var l=o[1];t.internal.newObjectDeferredBegin(l,!1)}t.internal.write(a)}if(this.outline.createNamedDestinations){var c=this.internal.pages.length,h=[];for(r=0;r<c;r++){var d=t.internal.newObject();h.push(d);var p=t.internal.getPageInfo(r+1);t.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var f=t.internal.newObject();for(t.internal.write("<< /Names [ "),r=0;r<h.length;r++)t.internal.write("(page_"+(r+1)+")"+h[r]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+f+" 0 R"),t.internal.write(">>","endobj")}}]),i.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),i.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(s,n,r){var a={title:n,options:r,children:[]};return s==null&&(s=this.root),s.children.push(a),a},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(s){s.id=t.internal.newObjectDeferred();for(var n=0;n<s.children.length;n++)this.genIds_r(s.children[n])},t.outline.renderRoot=function(s){this.objStart(s),this.line("/Type /Outlines"),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1]))),this.line("/Count "+this.count_r({count:0},s)),this.objEnd()},t.outline.renderItems=function(s){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,r=0;r<s.children.length;r++){var a=s.children[r];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(s)),r>0&&this.line("/Prev "+this.makeRef(s.children[r-1])),r<s.children.length-1&&this.line("/Next "+this.makeRef(s.children[r+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var o=this.count=this.count_r({count:0},a);if(o>0&&this.line("/Count "+o),a.options&&a.options.pageNumber){var l=t.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var c=0;c<s.children.length;c++)this.renderItems(s.children[c])},t.outline.line=function(s){this.ctx.val+=s+`\r
`},t.outline.makeRef=function(s){return s.id+" 0 R"},t.outline.makeString=function(s){return"("+t.internal.pdfEscape(s)+")"},t.outline.objStart=function(s){this.ctx.val+=`\r
`+s.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(s,n){for(var r=0;r<n.children.length;r++)s.count++,this.count_r(s,n.children[r]);return s.count}}])}(Je.API),function(i){var e=[192,193,194,195,196,197,198,199];i.processJPEG=function(t,s,n,r,a,o){var l,c=this.decode.DCT_DECODE,h=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=a||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,(l=function(d){for(var p,f=256*d.charCodeAt(4)+d.charCodeAt(5),v=d.length,w={width:0,height:0,numcomponents:1},A=4;A<v;A+=2){if(A+=f,e.indexOf(d.charCodeAt(A+1))!==-1){p=256*d.charCodeAt(A+5)+d.charCodeAt(A+6),w={width:256*d.charCodeAt(A+7)+d.charCodeAt(A+8),height:p,numcomponents:d.charCodeAt(A+9)};break}f=256*d.charCodeAt(A+2)+d.charCodeAt(A+3)}return w}(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}h={data:t,width:l.width,height:l.height,colorSpace:o,bitsPerComponent:8,filter:c,index:s,alias:n}}return h}}(Je.API);var go,Vh,Zg,Qg,e0,L3=function(){var i,e,t;function s(r){var a,o,l,c,h,d,p,f,v,w,A,x,S,j;for(this.data=r,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},d=null;;){switch(a=this.readUInt32(),v=function(){var M,B;for(B=[],M=0;M<4;++M)B.push(String.fromCharCode(this.data[this.pos++]));return B}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(a);break;case"fcTL":d&&this.animation.frames.push(d),this.pos+=4,d={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},h=this.readUInt16(),c=this.readUInt16()||100,d.delay=1e3*h/c,d.disposeOp=this.data[this.pos++],d.blendOp=this.data[this.pos++],d.data=[];break;case"IDAT":case"fdAT":for(v==="fdAT"&&(this.pos+=4,a-=4),r=d?.data||this.imgData,x=0;0<=a?x<a:x>a;0<=a?++x:--x)r.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(l=this.palette.length/3,this.transparency.indexed=this.read(a),this.transparency.indexed.length>l)throw new Error("More transparent colors than palette size");if((w=l-this.transparency.indexed.length)>0)for(S=0;0<=w?S<w:S>w;0<=w?++S:--S)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(a)[0];break;case 2:this.transparency.rgb=this.read(a)}break;case"tEXt":p=(A=this.read(a)).indexOf(0),f=String.fromCharCode.apply(String,A.slice(0,p)),this.text[f]=String.fromCharCode.apply(String,A.slice(p+1));break;case"IEND":return d&&this.animation.frames.push(d),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=(j=this.colorType)===4||j===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=a}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}s.prototype.read=function(r){var a,o;for(o=[],a=0;0<=r?a<r:a>r;0<=r?++a:--a)o.push(this.data[this.pos++]);return o},s.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},s.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},s.prototype.decodePixels=function(r){var a=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*a),l=0,c=this;if(r==null&&(r=this.imgData),r.length===0)return new Uint8Array(0);function h(d,p,f,v){var w,A,x,S,j,M,B,Q,q,O,G,ie,L,R,W,U,he,ae,se,Z,fe,me=Math.ceil((c.width-d)/f),ke=Math.ceil((c.height-p)/v),k=c.width==me&&c.height==ke;for(R=a*me,ie=k?o:new Uint8Array(R*ke),M=r.length,L=0,A=0;L<ke&&l<M;){switch(r[l++]){case 0:for(S=he=0;he<R;S=he+=1)ie[A++]=r[l++];break;case 1:for(S=ae=0;ae<R;S=ae+=1)w=r[l++],j=S<a?0:ie[A-a],ie[A++]=(w+j)%256;break;case 2:for(S=se=0;se<R;S=se+=1)w=r[l++],x=(S-S%a)/a,W=L&&ie[(L-1)*R+x*a+S%a],ie[A++]=(W+w)%256;break;case 3:for(S=Z=0;Z<R;S=Z+=1)w=r[l++],x=(S-S%a)/a,j=S<a?0:ie[A-a],W=L&&ie[(L-1)*R+x*a+S%a],ie[A++]=(w+Math.floor((j+W)/2))%256;break;case 4:for(S=fe=0;fe<R;S=fe+=1)w=r[l++],x=(S-S%a)/a,j=S<a?0:ie[A-a],L===0?W=U=0:(W=ie[(L-1)*R+x*a+S%a],U=x&&ie[(L-1)*R+(x-1)*a+S%a]),B=j+W-U,Q=Math.abs(B-j),O=Math.abs(B-W),G=Math.abs(B-U),q=Q<=O&&Q<=G?j:O<=G?W:U,ie[A++]=(w+q)%256;break;default:throw new Error("Invalid filter algorithm: "+r[l-1])}if(!k){var D=((p+L*v)*c.width+d)*a,z=L*R;for(S=0;S<me;S+=1){for(var X=0;X<a;X+=1)o[D++]=ie[z++];D+=(f-1)*a}}L++}}return r=l3(r),c.interlaceMethod==1?(h(0,0,8,8),h(4,0,8,8),h(0,4,4,8),h(2,0,4,4),h(0,2,2,4),h(1,0,2,2),h(0,1,1,2)):h(0,0,1,1),o},s.prototype.decodePalette=function(){var r,a,o,l,c,h,d,p,f;for(o=this.palette,h=this.transparency.indexed||[],c=new Uint8Array((h.length||0)+o.length),l=0,r=0,a=d=0,p=o.length;d<p;a=d+=3)c[l++]=o[a],c[l++]=o[a+1],c[l++]=o[a+2],c[l++]=(f=h[r++])!=null?f:255;return c},s.prototype.copyToImageData=function(r,a){var o,l,c,h,d,p,f,v,w,A,x;if(l=this.colors,w=null,o=this.hasAlphaChannel,this.palette.length&&(w=(x=this._decodedPalette)!=null?x:this._decodedPalette=this.decodePalette(),l=4,o=!0),v=(c=r.data||r).length,d=w||a,h=p=0,l===1)for(;h<v;)f=w?4*a[h/4]:p,A=d[f++],c[h++]=A,c[h++]=A,c[h++]=A,c[h++]=o?d[f++]:255,p=f;else for(;h<v;)f=w?4*a[h/4]:p,c[h++]=d[f++],c[h++]=d[f++],c[h++]=d[f++],c[h++]=o?d[f++]:255,p=f},s.prototype.decode=function(){var r;return r=new Uint8Array(this.width*this.height*4),this.copyToImageData(r,this.decodePixels()),r};var n=function(){if(Object.prototype.toString.call(Ze)==="[object Window]"){try{e=Ze.document.createElement("canvas"),t=e.getContext("2d")}catch{return!1}return!0}return!1};return n(),i=function(r){var a;if(n()===!0)return t.width=r.width,t.height=r.height,t.clearRect(0,0,r.width,r.height),t.putImageData(r,0,0),(a=new Image).src=e.toDataURL(),a;throw new Error("This method requires a Browser with Canvas-capability.")},s.prototype.decodeFrames=function(r){var a,o,l,c,h,d,p,f;if(this.animation){for(f=[],o=h=0,d=(p=this.animation.frames).length;h<d;o=++h)a=p[o],l=r.createImageData(a.width,a.height),c=this.decodePixels(new Uint8Array(a.data)),this.copyToImageData(l,c),a.imageData=l,f.push(a.image=i(l));return f}},s.prototype.renderFrame=function(r,a){var o,l,c;return o=(l=this.animation.frames)[a],c=l[a-1],a===0&&r.clearRect(0,0,this.width,this.height),c?.disposeOp===1?r.clearRect(c.xOffset,c.yOffset,c.width,c.height):c?.disposeOp===2&&r.putImageData(c.imageData,c.xOffset,c.yOffset),o.blendOp===0&&r.clearRect(o.xOffset,o.yOffset,o.width,o.height),r.drawImage(o.image,o.xOffset,o.yOffset)},s.prototype.animate=function(r){var a,o,l,c,h,d,p=this;return o=0,d=this.animation,c=d.numFrames,l=d.frames,h=d.numPlays,(a=function(){var f,v;if(f=o++%c,v=l[f],p.renderFrame(r,f),c>1&&o/c<h)return p.animation._timeout=setTimeout(a,v.delay)})()},s.prototype.stopAnimation=function(){var r;return clearTimeout((r=this.animation)!=null?r._timeout:void 0)},s.prototype.render=function(r){var a,o;return r._png&&r._png.stopAnimation(),r._png=this,r.width=this.width,r.height=this.height,a=r.getContext("2d"),this.animation?(this.decodeFrames(a),this.animate(a)):(o=a.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),a.putImageData(o,0,0))},s}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function T3(i){var e=0;if(i[e++]!==71||i[e++]!==73||i[e++]!==70||i[e++]!==56||(i[e++]+1&253)!=56||i[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=i[e++]|i[e++]<<8,s=i[e++]|i[e++]<<8,n=i[e++],r=n>>7,a=1<<(7&n)+1;i[e++],i[e++];var o=null,l=null;r&&(o=e,l=a,e+=3*a);var c=!0,h=[],d=0,p=null,f=0,v=null;for(this.width=t,this.height=s;c&&e<i.length;)switch(i[e++]){case 33:switch(i[e++]){case 255:if(i[e]!==11||i[e+1]==78&&i[e+2]==69&&i[e+3]==84&&i[e+4]==83&&i[e+5]==67&&i[e+6]==65&&i[e+7]==80&&i[e+8]==69&&i[e+9]==50&&i[e+10]==46&&i[e+11]==48&&i[e+12]==3&&i[e+13]==1&&i[e+16]==0)e+=14,v=i[e++]|i[e++]<<8,e++;else for(e+=12;;){if(!((L=i[e++])>=0))throw Error("Invalid block size");if(L===0)break;e+=L}break;case 249:if(i[e++]!==4||i[e+4]!==0)throw new Error("Invalid graphics extension block.");var w=i[e++];d=i[e++]|i[e++]<<8,p=i[e++],!(1&w)&&(p=null),f=w>>2&7,e++;break;case 254:for(;;){if(!((L=i[e++])>=0))throw Error("Invalid block size");if(L===0)break;e+=L}break;default:throw new Error("Unknown graphic control label: 0x"+i[e-1].toString(16))}break;case 44:var A=i[e++]|i[e++]<<8,x=i[e++]|i[e++]<<8,S=i[e++]|i[e++]<<8,j=i[e++]|i[e++]<<8,M=i[e++],B=M>>6&1,Q=1<<(7&M)+1,q=o,O=l,G=!1;M>>7&&(G=!0,q=e,O=Q,e+=3*Q);var ie=e;for(e++;;){var L;if(!((L=i[e++])>=0))throw Error("Invalid block size");if(L===0)break;e+=L}h.push({x:A,y:x,width:S,height:j,has_local_palette:G,palette_offset:q,palette_size:O,data_offset:ie,data_length:e-ie,transparent_index:p,interlaced:!!B,delay:d,disposal:f});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+i[e-1].toString(16))}this.numFrames=function(){return h.length},this.loopCount=function(){return v},this.frameInfo=function(R){if(R<0||R>=h.length)throw new Error("Frame index out of range.");return h[R]},this.decodeAndBlitFrameBGRA=function(R,W){var U=this.frameInfo(R),he=U.width*U.height,ae=new Uint8Array(he);t0(i,U.data_offset,ae,he);var se=U.palette_offset,Z=U.transparent_index;Z===null&&(Z=256);var fe=U.width,me=t-fe,ke=fe,k=4*(U.y*t+U.x),D=4*((U.y+U.height)*t+U.x),z=k,X=4*me;U.interlaced===!0&&(X+=4*t*7);for(var ee=8,re=0,ue=ae.length;re<ue;++re){var de=ae[re];if(ke===0&&(ke=fe,(z+=X)>=D&&(X=4*me+4*t*(ee-1),z=k+(fe+me)*(ee<<1),ee>>=1)),de===Z)z+=4;else{var Ee=i[se+3*de],Ne=i[se+3*de+1],Re=i[se+3*de+2];W[z++]=Re,W[z++]=Ne,W[z++]=Ee,W[z++]=255}--ke}},this.decodeAndBlitFrameRGBA=function(R,W){var U=this.frameInfo(R),he=U.width*U.height,ae=new Uint8Array(he);t0(i,U.data_offset,ae,he);var se=U.palette_offset,Z=U.transparent_index;Z===null&&(Z=256);var fe=U.width,me=t-fe,ke=fe,k=4*(U.y*t+U.x),D=4*((U.y+U.height)*t+U.x),z=k,X=4*me;U.interlaced===!0&&(X+=4*t*7);for(var ee=8,re=0,ue=ae.length;re<ue;++re){var de=ae[re];if(ke===0&&(ke=fe,(z+=X)>=D&&(X=4*me+4*t*(ee-1),z=k+(fe+me)*(ee<<1),ee>>=1)),de===Z)z+=4;else{var Ee=i[se+3*de],Ne=i[se+3*de+1],Re=i[se+3*de+2];W[z++]=Ee,W[z++]=Ne,W[z++]=Re,W[z++]=255}--ke}}}function t0(i,e,t,s){for(var n=i[e++],r=1<<n,a=r+1,o=a+1,l=n+1,c=(1<<l)-1,h=0,d=0,p=0,f=i[e++],v=new Int32Array(4096),w=null;;){for(;h<16&&f!==0;)d|=i[e++]<<h,h+=8,f===1?f=i[e++]:--f;if(h<l)break;var A=d&c;if(d>>=l,h-=l,A!==r){if(A===a)break;for(var x=A<o?A:w,S=0,j=x;j>r;)j=v[j]>>8,++S;var M=j;if(p+S+(x!==A?1:0)>s)return void Gt.log("Warning, gif stream longer than expected.");t[p++]=M;var B=p+=S;for(x!==A&&(t[p++]=M),j=x;S--;)j=v[j],t[--B]=255&j,j>>=8;w!==null&&o<4096&&(v[o++]=w<<8|M,o>=c+1&&l<12&&(++l,c=c<<1|1)),w=A}else o=a+1,c=(1<<(l=n+1))-1,w=null}return p!==s&&Gt.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function mf(i){var e,t,s,n,r,a=Math.floor,o=new Array(64),l=new Array(64),c=new Array(64),h=new Array(64),d=new Array(65535),p=new Array(65535),f=new Array(64),v=new Array(64),w=[],A=0,x=7,S=new Array(64),j=new Array(64),M=new Array(64),B=new Array(256),Q=new Array(2048),q=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],O=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],G=[0,1,2,3,4,5,6,7,8,9,10,11],ie=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],L=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],R=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],W=[0,1,2,3,4,5,6,7,8,9,10,11],U=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],he=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ae(k,D){for(var z=0,X=0,ee=new Array,re=1;re<=16;re++){for(var ue=1;ue<=k[re];ue++)ee[D[X]]=[],ee[D[X]][0]=z,ee[D[X]][1]=re,X++,z++;z*=2}return ee}function se(k){for(var D=k[0],z=k[1]-1;z>=0;)D&1<<z&&(A|=1<<x),z--,--x<0&&(A==255?(Z(255),Z(0)):Z(A),x=7,A=0)}function Z(k){w.push(k)}function fe(k){Z(k>>8&255),Z(255&k)}function me(k,D,z,X,ee){for(var re,ue=ee[0],de=ee[240],Ee=function(Se,Ce){var Oe,je,Ve,it,ft,vt,Pt,qt,tt,wt,Me=0;for(tt=0;tt<8;++tt){Oe=Se[Me],je=Se[Me+1],Ve=Se[Me+2],it=Se[Me+3],ft=Se[Me+4],vt=Se[Me+5],Pt=Se[Me+6];var zs=Oe+(qt=Se[Me+7]),Tt=Oe-qt,Gn=je+Pt,Wt=je-Pt,Qt=Ve+vt,_i=Ve-vt,It=it+ft,Kr=it-ft,is=zs+It,Xn=zs-It,Gi=Gn+Qt,rs=Gn-Qt;Se[Me]=is+Gi,Se[Me+4]=is-Gi;var rt=.707106781*(rs+Xn);Se[Me+2]=Xn+rt,Se[Me+6]=Xn-rt;var Rt=.382683433*((is=Kr+_i)-(rs=Wt+Tt)),Jr=.5411961*is+Rt,Ds=1.306562965*rs+Rt,Ai=.707106781*(Gi=_i+Wt),Si=Tt+Ai,Ye=Tt-Ai;Se[Me+5]=Ye+Jr,Se[Me+3]=Ye-Jr,Se[Me+1]=Si+Ds,Se[Me+7]=Si-Ds,Me+=8}for(Me=0,tt=0;tt<8;++tt){Oe=Se[Me],je=Se[Me+8],Ve=Se[Me+16],it=Se[Me+24],ft=Se[Me+32],vt=Se[Me+40],Pt=Se[Me+48];var Yn=Oe+(qt=Se[Me+56]),Ni=Oe-qt,hn=je+Pt,As=je-Pt,bs=Ve+vt,An=Ve-vt,Oa=it+ft,Xi=it-ft,Kn=Yn+Oa,Jn=Yn-Oa,Zn=hn+bs,Ei=hn-bs;Se[Me]=Kn+Zn,Se[Me+32]=Kn-Zn;var On=.707106781*(Ei+Jn);Se[Me+16]=Jn+On,Se[Me+48]=Jn-On;var ki=.382683433*((Kn=Xi+An)-(Ei=As+Ni)),Zr=.5411961*Kn+ki,Ma=1.306562965*Ei+ki,Fa=.707106781*(Zn=An+As),Da=Ni+Fa,Ba=Ni-Fa;Se[Me+40]=Ba+Zr,Se[Me+24]=Ba-Zr,Se[Me+8]=Da+Ma,Se[Me+56]=Da-Ma,Me++}for(tt=0;tt<64;++tt)wt=Se[tt]*Ce[tt],f[tt]=wt>0?wt+.5|0:wt-.5|0;return f}(k,D),Ne=0;Ne<64;++Ne)v[q[Ne]]=Ee[Ne];var Re=v[0]-z;z=v[0],Re==0?se(X[0]):(se(X[p[re=32767+Re]]),se(d[re]));for(var Le=63;Le>0&&v[Le]==0;)Le--;if(Le==0)return se(ue),z;for(var Ke,be=1;be<=Le;){for(var H=be;v[be]==0&&be<=Le;)++be;var lt=be-H;if(lt>=16){Ke=lt>>4;for(var Ue=1;Ue<=Ke;++Ue)se(de);lt&=15}re=32767+v[be],se(ee[(lt<<4)+p[re]]),se(d[re]),be++}return Le!=63&&se(ue),z}function ke(k){k=Math.min(Math.max(k,1),100),r!=k&&(function(D){for(var z=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],X=0;X<64;X++){var ee=a((z[X]*D+50)/100);ee=Math.min(Math.max(ee,1),255),o[q[X]]=ee}for(var re=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ue=0;ue<64;ue++){var de=a((re[ue]*D+50)/100);de=Math.min(Math.max(de,1),255),l[q[ue]]=de}for(var Ee=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ne=0,Re=0;Re<8;Re++)for(var Le=0;Le<8;Le++)c[Ne]=1/(o[q[Ne]]*Ee[Re]*Ee[Le]*8),h[Ne]=1/(l[q[Ne]]*Ee[Re]*Ee[Le]*8),Ne++}(k<50?Math.floor(5e3/k):Math.floor(200-2*k)),r=k)}this.encode=function(k,D){D&&ke(D),w=new Array,A=0,x=7,fe(65496),fe(65504),fe(16),Z(74),Z(70),Z(73),Z(70),Z(0),Z(1),Z(1),Z(0),fe(1),fe(1),Z(0),Z(0),function(){fe(65499),fe(132),Z(0);for(var je=0;je<64;je++)Z(o[je]);Z(1);for(var Ve=0;Ve<64;Ve++)Z(l[Ve])}(),function(je,Ve){fe(65472),fe(17),Z(8),fe(Ve),fe(je),Z(3),Z(1),Z(17),Z(0),Z(2),Z(17),Z(1),Z(3),Z(17),Z(1)}(k.width,k.height),function(){fe(65476),fe(418),Z(0);for(var je=0;je<16;je++)Z(O[je+1]);for(var Ve=0;Ve<=11;Ve++)Z(G[Ve]);Z(16);for(var it=0;it<16;it++)Z(ie[it+1]);for(var ft=0;ft<=161;ft++)Z(L[ft]);Z(1);for(var vt=0;vt<16;vt++)Z(R[vt+1]);for(var Pt=0;Pt<=11;Pt++)Z(W[Pt]);Z(17);for(var qt=0;qt<16;qt++)Z(U[qt+1]);for(var tt=0;tt<=161;tt++)Z(he[tt])}(),fe(65498),fe(12),Z(3),Z(1),Z(0),Z(2),Z(17),Z(3),Z(17),Z(0),Z(63),Z(0);var z=0,X=0,ee=0;A=0,x=7,this.encode.displayName="_encode_";for(var re,ue,de,Ee,Ne,Re,Le,Ke,be,H=k.data,lt=k.width,Ue=k.height,Se=4*lt,Ce=0;Ce<Ue;){for(re=0;re<Se;){for(Ne=Se*Ce+re,Le=-1,Ke=0,be=0;be<64;be++)Re=Ne+(Ke=be>>3)*Se+(Le=4*(7&be)),Ce+Ke>=Ue&&(Re-=Se*(Ce+1+Ke-Ue)),re+Le>=Se&&(Re-=re+Le-Se+4),ue=H[Re++],de=H[Re++],Ee=H[Re++],S[be]=(Q[ue]+Q[de+256>>0]+Q[Ee+512>>0]>>16)-128,j[be]=(Q[ue+768>>0]+Q[de+1024>>0]+Q[Ee+1280>>0]>>16)-128,M[be]=(Q[ue+1280>>0]+Q[de+1536>>0]+Q[Ee+1792>>0]>>16)-128;z=me(S,c,z,e,s),X=me(j,h,X,t,n),ee=me(M,h,ee,t,n),re+=32}Ce+=8}if(x>=0){var Oe=[];Oe[1]=x+1,Oe[0]=(1<<x+1)-1,se(Oe)}return fe(65497),new Uint8Array(w)},i=i||50,function(){for(var k=String.fromCharCode,D=0;D<256;D++)B[D]=k(D)}(),e=ae(O,G),t=ae(R,W),s=ae(ie,L),n=ae(U,he),function(){for(var k=1,D=2,z=1;z<=15;z++){for(var X=k;X<D;X++)p[32767+X]=z,d[32767+X]=[],d[32767+X][1]=z,d[32767+X][0]=X;for(var ee=-(D-1);ee<=-k;ee++)p[32767+ee]=z,d[32767+ee]=[],d[32767+ee][1]=z,d[32767+ee][0]=D-1+ee;k<<=1,D<<=1}}(),function(){for(var k=0;k<256;k++)Q[k]=19595*k,Q[k+256>>0]=38470*k,Q[k+512>>0]=7471*k+32768,Q[k+768>>0]=-11059*k,Q[k+1024>>0]=-21709*k,Q[k+1280>>0]=32768*k+8421375,Q[k+1536>>0]=-27439*k,Q[k+1792>>0]=-5329*k}(),ke(i)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function ri(i,e){if(this.pos=0,this.buffer=i,this.datav=new DataView(i.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function s0(i){function e(O){if(!O)throw Error("assert :P")}function t(O,G,ie){for(var L=0;4>L;L++)if(O[G+L]!=ie.charCodeAt(L))return!0;return!1}function s(O,G,ie,L,R){for(var W=0;W<R;W++)O[G+W]=ie[L+W]}function n(O,G,ie,L){for(var R=0;R<L;R++)O[G+R]=ie}function r(O){return new Int32Array(O)}function a(O,G){for(var ie=[],L=0;L<O;L++)ie.push(new G);return ie}function o(O,G){var ie=[];return function L(R,W,U){for(var he=U[W],ae=0;ae<he&&(R.push(U.length>W+1?[]:new G),!(U.length<W+1));ae++)L(R[ae],W+1,U)}(ie,0,O),ie}var l=function(){var O=this;function G(u,m){for(var y=1<<m-1>>>0;u&y;)y>>>=1;return y?(u&y-1)+y:u}function ie(u,m,y,_,N){e(!(_%y));do u[m+(_-=y)]=N;while(0<_)}function L(u,m,y,_,N){if(e(2328>=N),512>=N)var C=r(512);else if((C=r(N))==null)return 0;return function(P,T,I,F,K,le){var ce,ne,we=T,pe=1<<I,J=r(16),te=r(16);for(e(K!=0),e(F!=null),e(P!=null),e(0<I),ne=0;ne<K;++ne){if(15<F[ne])return 0;++J[F[ne]]}if(J[0]==K)return 0;for(te[1]=0,ce=1;15>ce;++ce){if(J[ce]>1<<ce)return 0;te[ce+1]=te[ce]+J[ce]}for(ne=0;ne<K;++ne)ce=F[ne],0<F[ne]&&(le[te[ce]++]=ne);if(te[15]==1)return(F=new R).g=0,F.value=le[0],ie(P,we,1,pe,F),pe;var ye,xe=-1,ve=pe-1,De=0,Pe=1,Xe=1,Te=1<<I;for(ne=0,ce=1,K=2;ce<=I;++ce,K<<=1){if(Pe+=Xe<<=1,0>(Xe-=J[ce]))return 0;for(;0<J[ce];--J[ce])(F=new R).g=ce,F.value=le[ne++],ie(P,we+De,K,Te,F),De=G(De,ce)}for(ce=I+1,K=2;15>=ce;++ce,K<<=1){if(Pe+=Xe<<=1,0>(Xe-=J[ce]))return 0;for(;0<J[ce];--J[ce]){if(F=new R,(De&ve)!=xe){for(we+=Te,ye=1<<(xe=ce)-I;15>xe&&!(0>=(ye-=J[xe]));)++xe,ye<<=1;pe+=Te=1<<(ye=xe-I),P[T+(xe=De&ve)].g=ye+I,P[T+xe].value=we-T-xe}F.g=ce-I,F.value=le[ne++],ie(P,we+(De>>I),K,Te,F),De=G(De,ce)}}return Pe!=2*te[15]-1?0:pe}(u,m,y,_,N,C)}function R(){this.value=this.g=0}function W(){this.value=this.g=0}function U(){this.G=a(5,R),this.H=r(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=a(Bs,W)}function he(u,m,y,_){e(u!=null),e(m!=null),e(2147483648>_),u.Ca=254,u.I=0,u.b=-8,u.Ka=0,u.oa=m,u.pa=y,u.Jd=m,u.Yc=y+_,u.Zc=4<=_?y+_-4+1:y,re(u)}function ae(u,m){for(var y=0;0<m--;)y|=de(u,128)<<m;return y}function se(u,m){var y=ae(u,m);return ue(u)?-y:y}function Z(u,m,y,_){var N,C=0;for(e(u!=null),e(m!=null),e(4294967288>_),u.Sb=_,u.Ra=0,u.u=0,u.h=0,4<_&&(_=4),N=0;N<_;++N)C+=m[y+N]<<8*N;u.Ra=C,u.bb=_,u.oa=m,u.pa=y}function fe(u){for(;8<=u.u&&u.bb<u.Sb;)u.Ra>>>=8,u.Ra+=u.oa[u.pa+u.bb]<<eo-8>>>0,++u.bb,u.u-=8;z(u)&&(u.h=1,u.u=0)}function me(u,m){if(e(0<=m),!u.h&&m<=Qa){var y=D(u)&Za[m];return u.u+=m,fe(u),y}return u.h=1,u.u=0}function ke(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function k(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function D(u){return u.Ra>>>(u.u&eo-1)>>>0}function z(u){return e(u.bb<=u.Sb),u.h||u.bb==u.Sb&&u.u>eo}function X(u,m){u.u=m,u.h=z(u)}function ee(u){u.u>=gl&&(e(u.u>=gl),fe(u))}function re(u){e(u!=null&&u.oa!=null),u.pa<u.Zc?(u.I=(u.oa[u.pa++]|u.I<<8)>>>0,u.b+=8):(e(u!=null&&u.oa!=null),u.pa<u.Yc?(u.b+=8,u.I=u.oa[u.pa++]|u.I<<8):u.Ka?u.b=0:(u.I<<=8,u.b+=8,u.Ka=1))}function ue(u){return ae(u,1)}function de(u,m){var y=u.Ca;0>u.b&&re(u);var _=u.b,N=y*m>>>8,C=(u.I>>>_>N)+0;for(C?(y-=N,u.I-=N+1<<_>>>0):y=N+1,_=y,N=0;256<=_;)N+=8,_>>=8;return _=7^N+dn[_],u.b-=_,u.Ca=(y<<_)-1,C}function Ee(u,m,y){u[m+0]=y>>24&255,u[m+1]=y>>16&255,u[m+2]=y>>8&255,u[m+3]=y>>0&255}function Ne(u,m){return u[m+0]<<0|u[m+1]<<8}function Re(u,m){return Ne(u,m)|u[m+2]<<16}function Le(u,m){return Ne(u,m)|Ne(u,m+2)<<16}function Ke(u,m){var y=1<<m;return e(u!=null),e(0<m),u.X=r(y),u.X==null?0:(u.Mb=32-m,u.Xa=m,1)}function be(u,m){e(u!=null),e(m!=null),e(u.Xa==m.Xa),s(m.X,0,u.X,0,1<<m.Xa)}function H(){this.X=[],this.Xa=this.Mb=0}function lt(u,m,y,_){e(y!=null),e(_!=null);var N=y[0],C=_[0];return N==0&&(N=(u*C+m/2)/m),C==0&&(C=(m*N+u/2)/u),0>=N||0>=C?0:(y[0]=N,_[0]=C,1)}function Ue(u,m){return u+(1<<m)-1>>>m}function Se(u,m){return((4278255360&u)+(4278255360&m)>>>0&4278255360)+((16711935&u)+(16711935&m)>>>0&16711935)>>>0}function Ce(u,m){O[m]=function(y,_,N,C,P,T,I){var F;for(F=0;F<P;++F){var K=O[u](T[I+F-1],N,C+F);T[I+F]=Se(y[_+F],K)}}}function Oe(){this.ud=this.hd=this.jd=0}function je(u,m){return((4278124286&(u^m))>>>1)+(u&m)>>>0}function Ve(u){return 0<=u&&256>u?u:0>u?0:255<u?255:void 0}function it(u,m){return Ve(u+(u-m+.5>>1))}function ft(u,m,y){return Math.abs(m-y)-Math.abs(u-y)}function vt(u,m,y,_,N,C,P){for(_=C[P-1],y=0;y<N;++y)C[P+y]=_=Se(u[m+y],_)}function Pt(u,m,y,_,N){var C;for(C=0;C<y;++C){var P=u[m+C],T=P>>8&255,I=16711935&(I=(I=16711935&P)+((T<<16)+T));_[N+C]=(4278255360&P)+I>>>0}}function qt(u,m){m.jd=u>>0&255,m.hd=u>>8&255,m.ud=u>>16&255}function tt(u,m,y,_,N,C){var P;for(P=0;P<_;++P){var T=m[y+P],I=T>>>8,F=T,K=255&(K=(K=T>>>16)+((u.jd<<24>>24)*(I<<24>>24)>>>5));F=255&(F=(F=F+((u.hd<<24>>24)*(I<<24>>24)>>>5))+((u.ud<<24>>24)*(K<<24>>24)>>>5)),N[C+P]=(4278255360&T)+(K<<16)+F}}function wt(u,m,y,_,N){O[m]=function(C,P,T,I,F,K,le,ce,ne){for(I=le;I<ce;++I)for(le=0;le<ne;++le)F[K++]=N(T[_(C[P++])])},O[u]=function(C,P,T,I,F,K,le){var ce=8>>C.b,ne=C.Ea,we=C.K[0],pe=C.w;if(8>ce)for(C=(1<<C.b)-1,pe=(1<<ce)-1;P<T;++P){var J,te=0;for(J=0;J<ne;++J)J&C||(te=_(I[F++])),K[le++]=N(we[te&pe]),te>>=ce}else O["VP8LMapColor"+y](I,F,we,pe,K,le,P,T,ne)}}function Me(u,m,y,_,N){for(y=m+y;m<y;){var C=u[m++];_[N++]=C>>16&255,_[N++]=C>>8&255,_[N++]=C>>0&255}}function zs(u,m,y,_,N){for(y=m+y;m<y;){var C=u[m++];_[N++]=C>>16&255,_[N++]=C>>8&255,_[N++]=C>>0&255,_[N++]=C>>24&255}}function Tt(u,m,y,_,N){for(y=m+y;m<y;){var C=(P=u[m++])>>16&240|P>>12&15,P=P>>0&240|P>>28&15;_[N++]=C,_[N++]=P}}function Gn(u,m,y,_,N){for(y=m+y;m<y;){var C=(P=u[m++])>>16&248|P>>13&7,P=P>>5&224|P>>3&31;_[N++]=C,_[N++]=P}}function Wt(u,m,y,_,N){for(y=m+y;m<y;){var C=u[m++];_[N++]=C>>0&255,_[N++]=C>>8&255,_[N++]=C>>16&255}}function Qt(u,m,y,_,N,C){if(C==0)for(y=m+y;m<y;)Ee(_,((C=u[m++])[0]>>24|C[1]>>8&65280|C[2]<<8&16711680|C[3]<<24)>>>0),N+=32;else s(_,N,u,m,y)}function _i(u,m){O[m][0]=O[u+"0"],O[m][1]=O[u+"1"],O[m][2]=O[u+"2"],O[m][3]=O[u+"3"],O[m][4]=O[u+"4"],O[m][5]=O[u+"5"],O[m][6]=O[u+"6"],O[m][7]=O[u+"7"],O[m][8]=O[u+"8"],O[m][9]=O[u+"9"],O[m][10]=O[u+"10"],O[m][11]=O[u+"11"],O[m][12]=O[u+"12"],O[m][13]=O[u+"13"],O[m][14]=O[u+"0"],O[m][15]=O[u+"0"]}function It(u){return u==jd||u==Id||u==vh||u==Rd}function Kr(){this.eb=[],this.size=this.A=this.fb=0}function is(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Xn(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Kr,this.f.kb=new is,this.sd=null}function Gi(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function rs(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function rt(u){return alert("todo:WebPSamplerProcessPlane"),u.T}function Rt(u,m){var y=u.T,_=m.ba.f.RGBA,N=_.eb,C=_.fb+u.ka*_.A,P=qn[m.ba.S],T=u.y,I=u.O,F=u.f,K=u.N,le=u.ea,ce=u.W,ne=m.cc,we=m.dc,pe=m.Mc,J=m.Nc,te=u.ka,ye=u.ka+u.T,xe=u.U,ve=xe+1>>1;for(te==0?P(T,I,null,null,F,K,le,ce,F,K,le,ce,N,C,null,null,xe):(P(m.ec,m.fc,T,I,ne,we,pe,J,F,K,le,ce,N,C-_.A,N,C,xe),++y);te+2<ye;te+=2)ne=F,we=K,pe=le,J=ce,K+=u.Rc,ce+=u.Rc,C+=2*_.A,P(T,(I+=2*u.fa)-u.fa,T,I,ne,we,pe,J,F,K,le,ce,N,C-_.A,N,C,xe);return I+=u.fa,u.j+ye<u.o?(s(m.ec,m.fc,T,I,xe),s(m.cc,m.dc,F,K,ve),s(m.Mc,m.Nc,le,ce,ve),y--):1&ye||P(T,I,null,null,F,K,le,ce,F,K,le,ce,N,C+_.A,null,null,xe),y}function Jr(u,m,y){var _=u.F,N=[u.J];if(_!=null){var C=u.U,P=m.ba.S,T=P==yh||P==vh;m=m.ba.f.RGBA;var I=[0],F=u.ka;I[0]=u.T,u.Kb&&(F==0?--I[0]:(--F,N[0]-=u.width),u.j+u.ka+u.T==u.o&&(I[0]=u.o-u.j-F));var K=m.eb;F=m.fb+F*m.A,u=Kt(_,N[0],u.width,C,I,K,F+(T?0:3),m.A),e(y==I),u&&It(P)&&Bn(K,F,T,C,I,m.A)}return 0}function Ds(u){var m=u.ma,y=m.ba.S,_=11>y,N=y==gh||y==bh||y==yh||y==Td||y==12||It(y);if(m.memory=null,m.Ib=null,m.Jb=null,m.Nd=null,!pl(m.Oa,u,N?11:12))return 0;if(N&&It(y)&&_e(),u.da)alert("todo:use_scaling");else{if(_){if(m.Ib=rt,u.Kb){if(y=u.U+1>>1,m.memory=r(u.U+2*y),m.memory==null)return 0;m.ec=m.memory,m.fc=0,m.cc=m.ec,m.dc=m.fc+u.U,m.Mc=m.cc,m.Nc=m.dc+y,m.Ib=Rt,_e()}}else alert("todo:EmitYUV");N&&(m.Jb=Jr,_&&oe())}if(_&&!Tm){for(u=0;256>u;++u)ly[u]=89858*(u-128)+xh>>wh,uy[u]=-22014*(u-128)+xh,hy[u]=-45773*(u-128),cy[u]=113618*(u-128)+xh>>wh;for(u=Al;u<Fd;++u)m=76283*(u-16)+xh>>wh,dy[u-Al]=Sn(m,255),fy[u-Al]=Sn(m+8>>4,15);Tm=1}return 1}function Ai(u){var m=u.ma,y=u.U,_=u.T;return e(!(1&u.ka)),0>=y||0>=_?0:(y=m.Ib(u,m),m.Jb!=null&&m.Jb(u,m,y),m.Dc+=y,1)}function Si(u){u.ma.memory=null}function Ye(u,m,y,_){return me(u,8)!=47?0:(m[0]=me(u,14)+1,y[0]=me(u,14)+1,_[0]=me(u,1),me(u,3)!=0?0:!u.h)}function Yn(u,m){if(4>u)return u+1;var y=u-2>>1;return(2+(1&u)<<y)+me(m,y)+1}function Ni(u,m){return 120<m?m-120:1<=(y=((y=X2[m-1])>>4)*u+(8-(15&y)))?y:1;var y}function hn(u,m,y){var _=D(y),N=u[m+=255&_].g-8;return 0<N&&(X(y,y.u+8),_=D(y),m+=u[m].value,m+=_&(1<<N)-1),X(y,y.u+u[m].g),u[m].value}function As(u,m,y){return y.g+=u.g,y.value+=u.value<<m>>>0,e(8>=y.g),u.g}function bs(u,m,y){var _=u.xc;return e((m=_==0?0:u.vc[u.md*(y>>_)+(m>>_)])<u.Wb),u.Ya[m]}function An(u,m,y,_){var N=u.ab,C=u.c*m,P=u.C;m=P+m;var T=y,I=_;for(_=u.Ta,y=u.Ua;0<N--;){var F=u.gc[N],K=P,le=m,ce=T,ne=I,we=(I=_,T=y,F.Ea);switch(e(K<le),e(le<=F.nc),F.hc){case 2:ch(ce,ne,(le-K)*we,I,T);break;case 0:var pe=K,J=le,te=I,ye=T,xe=(Te=F).Ea;pe==0&&(Pd(ce,ne,null,null,1,te,ye),vt(ce,ne+1,0,0,xe-1,te,ye+1),ne+=xe,ye+=xe,++pe);for(var ve=1<<Te.b,De=ve-1,Pe=Ue(xe,Te.b),Xe=Te.K,Te=Te.w+(pe>>Te.b)*Pe;pe<J;){var jt=Xe,Ot=Te,Lt=1;for(bl(ce,ne,te,ye-xe,1,te,ye);Lt<xe;){var _t=(Lt&~De)+ve;_t>xe&&(_t=xe),(0,vr[jt[Ot++]>>8&15])(ce,ne+ +Lt,te,ye+Lt-xe,_t-Lt,te,ye+Lt),Lt=_t}ne+=xe,ye+=xe,++pe&De||(Te+=Pe)}le!=F.nc&&s(I,T-we,I,T+(le-K-1)*we,we);break;case 1:for(we=ce,J=ne,xe=(ce=F.Ea)-(ye=ce&~(te=(ne=1<<F.b)-1)),pe=Ue(ce,F.b),ve=F.K,F=F.w+(K>>F.b)*pe;K<le;){for(De=ve,Pe=F,Xe=new Oe,Te=J+ye,jt=J+ce;J<Te;)qt(De[Pe++],Xe),na(Xe,we,J,ne,I,T),J+=ne,T+=ne;J<jt&&(qt(De[Pe++],Xe),na(Xe,we,J,xe,I,T),J+=xe,T+=xe),++K&te||(F+=pe)}break;case 3:if(ce==I&&ne==T&&0<F.b){for(J=I,ce=we=T+(le-K)*we-(ye=(le-K)*Ue(F.Ea,F.b)),ne=I,te=T,pe=[],ye=(xe=ye)-1;0<=ye;--ye)pe[ye]=ne[te+ye];for(ye=xe-1;0<=ye;--ye)J[ce+ye]=pe[ye];Mn(F,K,le,I,we,I,T)}else Mn(F,K,le,ce,ne,I,T)}T=_,I=y}I!=y&&s(_,y,T,I,C)}function Oa(u,m){var y=u.V,_=u.Ba+u.c*u.C,N=m-u.C;if(e(m<=u.l.o),e(16>=N),0<N){var C=u.l,P=u.Ta,T=u.Ua,I=C.width;if(An(u,N,y,_),N=T=[T],e((y=u.C)<(_=m)),e(C.v<C.va),_>C.o&&(_=C.o),y<C.j){var F=C.j-y;y=C.j,N[0]+=F*I}if(y>=_?y=0:(N[0]+=4*C.v,C.ka=y-C.j,C.U=C.va-C.v,C.T=_-y,y=1),y){if(T=T[0],11>(y=u.ca).S){var K=y.f.RGBA,le=(_=y.S,N=C.U,C=C.T,F=K.eb,K.A),ce=C;for(K=K.fb+u.Ma*K.A;0<ce--;){var ne=P,we=T,pe=N,J=F,te=K;switch(_){case mh:fn(ne,we,pe,J,te);break;case gh:tn(ne,we,pe,J,te);break;case jd:tn(ne,we,pe,J,te),Bn(J,te,0,pe,1,0);break;case xm:Zi(ne,we,pe,J,te);break;case bh:Qt(ne,we,pe,J,te,1);break;case Id:Qt(ne,we,pe,J,te,1),Bn(J,te,0,pe,1,0);break;case yh:Qt(ne,we,pe,J,te,0);break;case vh:Qt(ne,we,pe,J,te,0),Bn(J,te,1,pe,1,0);break;case Td:wr(ne,we,pe,J,te);break;case Rd:wr(ne,we,pe,J,te),Yt(J,te,pe,1,0);break;case _m:Ji(ne,we,pe,J,te);break;default:e(0)}T+=I,K+=le}u.Ma+=C}else alert("todo:EmitRescaledRowsYUVA");e(u.Ma<=y.height)}}u.C=m,e(u.C<=u.i)}function Xi(u){var m;if(0<u.ua)return 0;for(m=0;m<u.Wb;++m){var y=u.Ya[m].G,_=u.Ya[m].H;if(0<y[1][_[1]+0].g||0<y[2][_[2]+0].g||0<y[3][_[3]+0].g)return 0}return 1}function Kn(u,m,y,_,N,C){if(u.Z!=0){var P=u.qd,T=u.rd;for(e(Sr[u.Z]!=null);m<y;++m)Sr[u.Z](P,T,_,N,_,N,C),P=_,T=N,N+=C;u.qd=P,u.rd=T}}function Jn(u,m){var y=u.l.ma,_=y.Z==0||y.Z==1?u.l.j:u.C;if(_=u.C<_?_:u.C,e(m<=u.l.o),m>_){var N=u.l.width,C=y.ca,P=y.tb+N*_,T=u.V,I=u.Ba+u.c*_,F=u.gc;e(u.ab==1),e(F[0].hc==3),hh(F[0],_,m,T,I,C,P),Kn(y,_,m,C,P,N)}u.C=u.Ma=m}function Zn(u,m,y,_,N,C,P){var T=u.$/_,I=u.$%_,F=u.m,K=u.s,le=y+u.$,ce=le;N=y+_*N;var ne=y+_*C,we=280+K.ua,pe=u.Pb?T:16777216,J=0<K.ua?K.Wa:null,te=K.wc,ye=le<ne?bs(K,I,T):null;e(u.C<C),e(ne<=N);var xe=!1;e:for(;;){for(;xe||le<ne;){var ve=0;if(T>=pe){var De=le-y;e((pe=u).Pb),pe.wd=pe.m,pe.xd=De,0<pe.s.ua&&be(pe.s.Wa,pe.s.vb),pe=T+K2}if(I&te||(ye=bs(K,I,T)),e(ye!=null),ye.Qb&&(m[le]=ye.qb,xe=!0),!xe)if(ee(F),ye.jc){ve=F,De=m;var Pe=le,Xe=ye.pd[D(ve)&Bs-1];e(ye.jc),256>Xe.g?(X(ve,ve.u+Xe.g),De[Pe]=Xe.value,ve=0):(X(ve,ve.u+Xe.g-256),e(256<=Xe.value),ve=Xe.value),ve==0&&(xe=!0)}else ve=hn(ye.G[0],ye.H[0],F);if(F.h)break;if(xe||256>ve){if(!xe)if(ye.nd)m[le]=(ye.qb|ve<<8)>>>0;else{if(ee(F),xe=hn(ye.G[1],ye.H[1],F),ee(F),De=hn(ye.G[2],ye.H[2],F),Pe=hn(ye.G[3],ye.H[3],F),F.h)break;m[le]=(Pe<<24|xe<<16|ve<<8|De)>>>0}if(xe=!1,++le,++I>=_&&(I=0,++T,P!=null&&T<=C&&!(T%16)&&P(u,T),J!=null))for(;ce<le;)ve=m[ce++],J.X[(506832829*ve&4294967295)>>>J.Mb]=ve}else if(280>ve){if(ve=Yn(ve-256,F),De=hn(ye.G[4],ye.H[4],F),ee(F),De=Ni(_,De=Yn(De,F)),F.h)break;if(le-y<De||N-le<ve)break e;for(Pe=0;Pe<ve;++Pe)m[le+Pe]=m[le+Pe-De];for(le+=ve,I+=ve;I>=_;)I-=_,++T,P!=null&&T<=C&&!(T%16)&&P(u,T);if(e(le<=N),I&te&&(ye=bs(K,I,T)),J!=null)for(;ce<le;)ve=m[ce++],J.X[(506832829*ve&4294967295)>>>J.Mb]=ve}else{if(!(ve<we))break e;for(xe=ve-280,e(J!=null);ce<le;)ve=m[ce++],J.X[(506832829*ve&4294967295)>>>J.Mb]=ve;ve=le,e(!(xe>>>(De=J).Xa)),m[ve]=De.X[xe],xe=!0}xe||e(F.h==z(F))}if(u.Pb&&F.h&&le<N)e(u.m.h),u.a=5,u.m=u.wd,u.$=u.xd,0<u.s.ua&&be(u.s.vb,u.s.Wa);else{if(F.h)break e;P?.(u,T>C?C:T),u.a=0,u.$=le-y}return 1}return u.a=3,0}function Ei(u){e(u!=null),u.vc=null,u.yc=null,u.Ya=null;var m=u.Wa;m!=null&&(m.X=null),u.vb=null,e(u!=null)}function On(){var u=new Cd;return u==null?null:(u.a=0,u.xb=Nm,_i("Predictor","VP8LPredictors"),_i("Predictor","VP8LPredictors_C"),_i("PredictorAdd","VP8LPredictorsAdd"),_i("PredictorAdd","VP8LPredictorsAdd_C"),ch=Pt,na=tt,fn=Me,tn=zs,wr=Tt,Ji=Gn,Zi=Wt,O.VP8LMapColor32b=to,O.VP8LMapColor8b=uh,u)}function ki(u,m,y,_,N){var C=1,P=[u],T=[m],I=_.m,F=_.s,K=null,le=0;e:for(;;){if(y)for(;C&&me(I,1);){var ce=P,ne=T,we=_,pe=1,J=we.m,te=we.gc[we.ab],ye=me(J,2);if(we.Oc&1<<ye)C=0;else{switch(we.Oc|=1<<ye,te.hc=ye,te.Ea=ce[0],te.nc=ne[0],te.K=[null],++we.ab,e(4>=we.ab),ye){case 0:case 1:te.b=me(J,3)+2,pe=ki(Ue(te.Ea,te.b),Ue(te.nc,te.b),0,we,te.K),te.K=te.K[0];break;case 3:var xe,ve=me(J,8)+1,De=16<ve?0:4<ve?1:2<ve?2:3;if(ce[0]=Ue(te.Ea,De),te.b=De,xe=pe=ki(ve,1,0,we,te.K)){var Pe,Xe=ve,Te=te,jt=1<<(8>>Te.b),Ot=r(jt);if(Ot==null)xe=0;else{var Lt=Te.K[0],_t=Te.w;for(Ot[0]=Te.K[0][0],Pe=1;Pe<1*Xe;++Pe)Ot[Pe]=Se(Lt[_t+Pe],Ot[Pe-1]);for(;Pe<4*jt;++Pe)Ot[Pe]=0;Te.K[0]=null,Te.K[0]=Ot,xe=1}}pe=xe;break;case 2:break;default:e(0)}C=pe}}if(P=P[0],T=T[0],C&&me(I,1)&&!(C=1<=(le=me(I,4))&&11>=le)){_.a=3;break e}var Vt;if(Vt=C)t:{var Ut,ht,vs,pn=_,ws=P,mn=T,Mt=le,En=y,kn=pn.m,js=pn.s,$s=[null],nn=1,Un=0,Ti=Y2[Mt];s:for(;;){if(En&&me(kn,1)){var Is=me(kn,3)+2,sr=Ue(ws,Is),la=Ue(mn,Is),ao=sr*la;if(!ki(sr,la,0,pn,$s))break s;for($s=$s[0],js.xc=Is,Ut=0;Ut<ao;++Ut){var Nr=$s[Ut]>>8&65535;$s[Ut]=Nr,Nr>=nn&&(nn=Nr+1)}}if(kn.h)break s;for(ht=0;5>ht;++ht){var os=Am[ht];!ht&&0<Mt&&(os+=1<<Mt),Un<os&&(Un=os)}var Dd=a(nn*Ti,R),Rm=nn,Om=a(Rm,U);if(Om==null)var Ah=null;else e(65536>=Rm),Ah=Om;var Sl=r(Un);if(Ah==null||Sl==null||Dd==null){pn.a=1;break s}var Sh=Dd;for(Ut=vs=0;Ut<nn;++Ut){var ni=Ah[Ut],oo=ni.G,lo=ni.H,Mm=0,Nh=1,Fm=0;for(ht=0;5>ht;++ht){os=Am[ht],oo[ht]=Sh,lo[ht]=vs,!ht&&0<Mt&&(os+=1<<Mt);i:{var Eh,Bd=os,kh=pn,Nl=Sl,gy=Sh,by=vs,$d=0,Er=kh.m,yy=me(Er,1);if(n(Nl,0,0,Bd),yy){var vy=me(Er,1)+1,wy=me(Er,1),Dm=me(Er,wy==0?1:8);Nl[Dm]=1,vy==2&&(Nl[Dm=me(Er,8)]=1);var Ch=1}else{var Bm=r(19),$m=me(Er,4)+4;if(19<$m){kh.a=3;var Ph=0;break i}for(Eh=0;Eh<$m;++Eh)Bm[G2[Eh]]=me(Er,3);var qd=void 0,El=void 0,qm=kh,xy=Bm,Lh=Bd,Um=Nl,Ud=0,kr=qm.m,zm=8,Hm=a(128,R);n:for(;L(Hm,0,7,xy,19);){if(me(kr,1)){var _y=2+2*me(kr,3);if((qd=2+me(kr,_y))>Lh)break n}else qd=Lh;for(El=0;El<Lh&&qd--;){ee(kr);var Wm=Hm[0+(127&D(kr))];X(kr,kr.u+Wm.g);var co=Wm.value;if(16>co)Um[El++]=co,co!=0&&(zm=co);else{var Ay=co==16,Vm=co-16,Sy=W2[Vm],Gm=me(kr,H2[Vm])+Sy;if(El+Gm>Lh)break n;for(var Ny=Ay?zm:0;0<Gm--;)Um[El++]=Ny}}Ud=1;break n}Ud||(qm.a=3),Ch=Ud}(Ch=Ch&&!Er.h)&&($d=L(gy,by,8,Nl,Bd)),Ch&&$d!=0?Ph=$d:(kh.a=3,Ph=0)}if(Ph==0)break s;if(Nh&&V2[ht]==1&&(Nh=Sh[vs].g==0),Mm+=Sh[vs].g,vs+=Ph,3>=ht){var kl,zd=Sl[0];for(kl=1;kl<os;++kl)Sl[kl]>zd&&(zd=Sl[kl]);Fm+=zd}}if(ni.nd=Nh,ni.Qb=0,Nh&&(ni.qb=(oo[3][lo[3]+0].value<<24|oo[1][lo[1]+0].value<<16|oo[2][lo[2]+0].value)>>>0,Mm==0&&256>oo[0][lo[0]+0].value&&(ni.Qb=1,ni.qb+=oo[0][lo[0]+0].value<<8)),ni.jc=!ni.Qb&&6>Fm,ni.jc){var Th,nr=ni;for(Th=0;Th<Bs;++Th){var Cr=Th,Pr=nr.pd[Cr],jh=nr.G[0][nr.H[0]+Cr];256<=jh.value?(Pr.g=jh.g+256,Pr.value=jh.value):(Pr.g=0,Pr.value=0,Cr>>=As(jh,8,Pr),Cr>>=As(nr.G[1][nr.H[1]+Cr],16,Pr),Cr>>=As(nr.G[2][nr.H[2]+Cr],0,Pr),As(nr.G[3][nr.H[3]+Cr],24,Pr))}}}js.vc=$s,js.Wb=nn,js.Ya=Ah,js.yc=Dd,Vt=1;break t}Vt=0}if(!(C=Vt)){_.a=3;break e}if(0<le){if(F.ua=1<<le,!Ke(F.Wa,le)){_.a=1,C=0;break e}}else F.ua=0;var Hd=_,Xm=P,Ey=T,Wd=Hd.s,Vd=Wd.xc;if(Hd.c=Xm,Hd.i=Ey,Wd.md=Ue(Xm,Vd),Wd.wc=Vd==0?-1:(1<<Vd)-1,y){_.xb=ny;break e}if((K=r(P*T))==null){_.a=1,C=0;break e}C=(C=Zn(_,K,0,P,T,T,null))&&!I.h;break e}return C?(N!=null?N[0]=K:(e(K==null),e(y)),_.$=0,y||Ei(F)):Ei(F),C}function Zr(u,m){var y=u.c*u.i,_=y+m+16*m;return e(u.c<=m),u.V=r(_),u.V==null?(u.Ta=null,u.Ua=0,u.a=1,0):(u.Ta=u.V,u.Ua=u.Ba+y+m,1)}function Ma(u,m){var y=u.C,_=m-y,N=u.V,C=u.Ba+u.c*y;for(e(m<=u.l.o);0<_;){var P=16<_?16:_,T=u.l.ma,I=u.l.width,F=I*P,K=T.ca,le=T.tb+I*y,ce=u.Ta,ne=u.Ua;An(u,P,N,C),us(ce,ne,K,le,F),Kn(T,y,y+P,K,le,I),_-=P,N+=P*u.c,y+=P}e(y==m),u.C=u.Ma=m}function Fa(){this.ub=this.yd=this.td=this.Rb=0}function Da(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ba(){this.Fb=this.Bb=this.Cb=0,this.Zb=r(4),this.Lb=r(4)}function zc(){this.Yb=function(){var u=[];return function m(y,_,N){for(var C=N[_],P=0;P<C&&(y.push(N.length>_+1?[]:0),!(N.length<_+1));P++)m(y[P],_+1,N)}(u,0,[3,11]),u}()}function rd(){this.jb=r(3),this.Wc=o([4,8],zc),this.Xc=o([4,17],zc)}function ad(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new r(4),this.od=new r(4)}function $a(){this.ld=this.La=this.dd=this.tc=0}function Hc(){this.Na=this.la=0}function od(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Zo(){this.ad=r(384),this.Za=0,this.Ob=r(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function ld(){this.uc=this.M=this.Nb=0,this.wa=Array(new $a),this.Y=0,this.ya=Array(new Zo),this.aa=0,this.l=new qa}function Wc(){this.y=r(16),this.f=r(8),this.ea=r(8)}function cd(){this.cb=this.a=0,this.sc="",this.m=new ke,this.Od=new Fa,this.Kc=new Da,this.ed=new ad,this.Qa=new Ba,this.Ic=this.$c=this.Aa=0,this.D=new ld,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=a(8,ke),this.ia=0,this.pb=a(4,od),this.Pa=new rd,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Wc),this.Hd=0,this.rb=Array(new Hc),this.sb=0,this.wa=Array(new $a),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Zo),this.L=this.aa=0,this.gd=o([4,2],$a),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function qa(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function hd(){var u=new cd;return u!=null&&(u.a=0,u.sc="OK",u.cb=0,u.Xb=0,_l||(_l=Xc)),u}function cs(u,m,y){return u.a==0&&(u.a=m,u.sc=y,u.cb=0),0}function Vc(u,m,y){return 3<=y&&u[m+0]==157&&u[m+1]==1&&u[m+2]==42}function Gc(u,m){if(u==null)return 0;if(u.a=0,u.sc="OK",m==null)return cs(u,2,"null VP8Io passed to VP8GetHeaders()");var y=m.data,_=m.w,N=m.ha;if(4>N)return cs(u,7,"Truncated header.");var C=y[_+0]|y[_+1]<<8|y[_+2]<<16,P=u.Od;if(P.Rb=!(1&C),P.td=C>>1&7,P.yd=C>>4&1,P.ub=C>>5,3<P.td)return cs(u,3,"Incorrect keyframe parameters.");if(!P.yd)return cs(u,4,"Frame not displayable.");_+=3,N-=3;var T=u.Kc;if(P.Rb){if(7>N)return cs(u,7,"cannot parse picture header");if(!Vc(y,_,N))return cs(u,3,"Bad code word");T.c=16383&(y[_+4]<<8|y[_+3]),T.Td=y[_+4]>>6,T.i=16383&(y[_+6]<<8|y[_+5]),T.Ud=y[_+6]>>6,_+=7,N-=7,u.za=T.c+15>>4,u.Ub=T.i+15>>4,m.width=T.c,m.height=T.i,m.Da=0,m.j=0,m.v=0,m.va=m.width,m.o=m.height,m.da=0,m.ib=m.width,m.hb=m.height,m.U=m.width,m.T=m.height,n((C=u.Pa).jb,0,255,C.jb.length),e((C=u.Qa)!=null),C.Cb=0,C.Bb=0,C.Fb=1,n(C.Zb,0,0,C.Zb.length),n(C.Lb,0,0,C.Lb)}if(P.ub>N)return cs(u,7,"bad partition length");he(C=u.m,y,_,P.ub),_+=P.ub,N-=P.ub,P.Rb&&(T.Ld=ue(C),T.Kd=ue(C)),T=u.Qa;var I,F=u.Pa;if(e(C!=null),e(T!=null),T.Cb=ue(C),T.Cb){if(T.Bb=ue(C),ue(C)){for(T.Fb=ue(C),I=0;4>I;++I)T.Zb[I]=ue(C)?se(C,7):0;for(I=0;4>I;++I)T.Lb[I]=ue(C)?se(C,6):0}if(T.Bb)for(I=0;3>I;++I)F.jb[I]=ue(C)?ae(C,8):255}else T.Bb=0;if(C.Ka)return cs(u,3,"cannot parse segment header");if((T=u.ed).zd=ue(C),T.Tb=ae(C,6),T.wb=ae(C,3),T.Pc=ue(C),T.Pc&&ue(C)){for(F=0;4>F;++F)ue(C)&&(T.vd[F]=se(C,6));for(F=0;4>F;++F)ue(C)&&(T.od[F]=se(C,6))}if(u.L=T.Tb==0?0:T.zd?1:2,C.Ka)return cs(u,3,"cannot parse filter header");var K=N;if(N=I=_,_=I+K,T=K,u.Xb=(1<<ae(u.m,2))-1,K<3*(F=u.Xb))y=7;else{for(I+=3*F,T-=3*F,K=0;K<F;++K){var le=y[N+0]|y[N+1]<<8|y[N+2]<<16;le>T&&(le=T),he(u.Jc[+K],y,I,le),I+=le,T-=le,N+=3}he(u.Jc[+F],y,I,T),y=I<_?0:5}if(y!=0)return cs(u,y,"cannot parse partitions");for(y=ae(I=u.m,7),N=ue(I)?se(I,4):0,_=ue(I)?se(I,4):0,T=ue(I)?se(I,4):0,F=ue(I)?se(I,4):0,I=ue(I)?se(I,4):0,K=u.Qa,le=0;4>le;++le){if(K.Cb){var ce=K.Zb[le];K.Fb||(ce+=y)}else{if(0<le){u.pb[le]=u.pb[0];continue}ce=y}var ne=u.pb[le];ne.Sc[0]=Od[Sn(ce+N,127)],ne.Sc[1]=Md[Sn(ce+0,127)],ne.Eb[0]=2*Od[Sn(ce+_,127)],ne.Eb[1]=101581*Md[Sn(ce+T,127)]>>16,8>ne.Eb[1]&&(ne.Eb[1]=8),ne.Qc[0]=Od[Sn(ce+F,117)],ne.Qc[1]=Md[Sn(ce+I,127)],ne.lc=ce+I}if(!P.Rb)return cs(u,4,"Not a key frame.");for(ue(C),P=u.Pa,y=0;4>y;++y){for(N=0;8>N;++N)for(_=0;3>_;++_)for(T=0;11>T;++T)F=de(C,ty[y][N][_][T])?ae(C,8):Q2[y][N][_][T],P.Wc[y][N].Yb[_][T]=F;for(N=0;17>N;++N)P.Xc[y][N]=P.Wc[y][sy[N]]}return u.kc=ue(C),u.kc&&(u.Bd=ae(C,8)),u.cb=1}function Xc(u,m,y,_,N,C,P){var T=m[N].Yb[y];for(y=0;16>N;++N){if(!de(u,T[y+0]))return N;for(;!de(u,T[y+1]);)if(T=m[++N].Yb[0],y=0,N==16)return 16;var I=m[N+1].Yb;if(de(u,T[y+2])){var F=u,K=0;if(de(F,(ce=T)[(le=y)+3]))if(de(F,ce[le+6])){for(T=0,le=2*(K=de(F,ce[le+8]))+(ce=de(F,ce[le+9+K])),K=0,ce=J2[le];ce[T];++T)K+=K+de(F,ce[T]);K+=3+(8<<le)}else de(F,ce[le+7])?(K=7+2*de(F,165),K+=de(F,145)):K=5+de(F,159);else K=de(F,ce[le+4])?3+de(F,ce[le+5]):2;T=I[2]}else K=1,T=I[1];I=P+Z2[N],0>(F=u).b&&re(F);var le,ce=F.b,ne=(le=F.Ca>>1)-(F.I>>ce)>>31;--F.b,F.Ca+=ne,F.Ca|=1,F.I-=(le+1&ne)<<ce,C[I]=((K^ne)-ne)*_[(0<N)+0]}return 16}function Qo(u){var m=u.rb[u.sb-1];m.la=0,m.Na=0,n(u.zc,0,0,u.zc.length),u.ja=0}function ud(u,m){if(u==null)return 0;if(m==null)return cs(u,2,"NULL VP8Io parameter in VP8Decode().");if(!u.cb&&!Gc(u,m))return 0;if(e(u.cb),m.ac==null||m.ac(m)){m.ob&&(u.L=0);var y=_h[u.L];if(u.L==2?(u.yb=0,u.zb=0):(u.yb=m.v-y>>4,u.zb=m.j-y>>4,0>u.yb&&(u.yb=0),0>u.zb&&(u.zb=0)),u.Va=m.o+15+y>>4,u.Hb=m.va+15+y>>4,u.Hb>u.za&&(u.Hb=u.za),u.Va>u.Ub&&(u.Va=u.Ub),0<u.L){var _=u.ed;for(y=0;4>y;++y){var N;if(u.Qa.Cb){var C=u.Qa.Lb[y];u.Qa.Fb||(C+=_.Tb)}else C=_.Tb;for(N=0;1>=N;++N){var P=u.gd[y][N],T=C;if(_.Pc&&(T+=_.vd[0],N&&(T+=_.od[0])),0<(T=0>T?0:63<T?63:T)){var I=T;0<_.wb&&(I=4<_.wb?I>>2:I>>1)>9-_.wb&&(I=9-_.wb),1>I&&(I=1),P.dd=I,P.tc=2*T+I,P.ld=40<=T?2:15<=T?1:0}else P.tc=0;P.La=N}}}y=0}else cs(u,6,"Frame setup failed"),y=u.a;if(y=y==0){if(y){u.$c=0,0<u.Aa||(u.Ic=my);e:{y=u.Ic,_=4*(I=u.za);var F=32*I,K=I+1,le=0<u.L?I*(0<u.Aa?2:1):0,ce=(u.Aa==2?2:1)*I;if((P=_+832+(N=3*(16*y+_h[u.L])/2*F)+(C=u.Fa!=null&&0<u.Fa.length?u.Kc.c*u.Kc.i:0))!=P)y=0;else{if(P>u.Vb){if(u.Vb=0,u.Ec=r(P),u.Fc=0,u.Ec==null){y=cs(u,1,"no memory during frame initialization.");break e}u.Vb=P}P=u.Ec,T=u.Fc,u.Ac=P,u.Bc=T,T+=_,u.Gd=a(F,Wc),u.Hd=0,u.rb=a(K+1,Hc),u.sb=1,u.wa=le?a(le,$a):null,u.Y=0,u.D.Nb=0,u.D.wa=u.wa,u.D.Y=u.Y,0<u.Aa&&(u.D.Y+=I),e(!0),u.oc=P,u.pc=T,T+=832,u.ya=a(ce,Zo),u.aa=0,u.D.ya=u.ya,u.D.aa=u.aa,u.Aa==2&&(u.D.aa+=I),u.R=16*I,u.B=8*I,I=(F=_h[u.L])*u.R,F=F/2*u.B,u.sa=P,u.ta=T+I,u.qa=u.sa,u.ra=u.ta+16*y*u.R+F,u.Ha=u.qa,u.Ia=u.ra+8*y*u.B+F,u.$c=0,T+=N,u.mb=C?P:null,u.nb=C?T:null,e(T+C<=u.Fc+u.Vb),Qo(u),n(u.Ac,u.Bc,0,_),y=1}}if(y){if(m.ka=0,m.y=u.sa,m.O=u.ta,m.f=u.qa,m.N=u.ra,m.ea=u.Ha,m.Vd=u.Ia,m.fa=u.R,m.Rc=u.B,m.F=null,m.J=0,!fh){for(y=-255;255>=y;++y)Ss[255+y]=0>y?-y:y;for(y=-1020;1020>=y;++y)er[1020+y]=-128>y?-128:127<y?127:y;for(y=-112;112>=y;++y)xl[112+y]=-16>y?-16:15<y?15:y;for(y=-255;510>=y;++y)ro[255+y]=0>y?0:255<y?255:y;fh=1}so=pd,Qi=dd,yl=Kc,sn=fd,Fn=Jc,hs=Yc,no=rl,dh=ta,vl=kd,ia=al,ra=Ed,xr=Ga,aa=ol,io=ah,oa=rh,_r=Pi,wl=Ki,Dn=Nd,si[0]=Ci,si[1]=md,si[2]=vd,si[3]=wd,si[4]=eh,si[5]=Wa,si[6]=th,si[7]=sl,si[8]=_d,si[9]=xd,Ar[0]=Zc,Ar[1]=bd,Ar[2]=Yi,Ar[3]=za,Ar[4]=Hs,Ar[5]=yd,Ar[6]=Qc,tr[0]=gr,tr[1]=gd,tr[2]=Ad,tr[3]=nl,tr[4]=ea,tr[5]=Sd,tr[6]=il,y=1}else y=0}y&&(y=function(ne,we){for(ne.M=0;ne.M<ne.Va;++ne.M){var pe,J=ne.Jc[ne.M&ne.Xb],te=ne.m,ye=ne;for(pe=0;pe<ye.za;++pe){var xe=te,ve=ye,De=ve.Ac,Pe=ve.Bc+4*pe,Xe=ve.zc,Te=ve.ya[ve.aa+pe];if(ve.Qa.Bb?Te.$b=de(xe,ve.Pa.jb[0])?2+de(xe,ve.Pa.jb[2]):de(xe,ve.Pa.jb[1]):Te.$b=0,ve.kc&&(Te.Ad=de(xe,ve.Bd)),Te.Za=!de(xe,145)+0,Te.Za){var jt=Te.Ob,Ot=0;for(ve=0;4>ve;++ve){var Lt,_t=Xe[0+ve];for(Lt=0;4>Lt;++Lt){_t=ey[De[Pe+Lt]][_t];for(var Vt=Sm[de(xe,_t[0])];0<Vt;)Vt=Sm[2*Vt+de(xe,_t[Vt])];_t=-Vt,De[Pe+Lt]=_t}s(jt,Ot,De,Pe,4),Ot+=4,Xe[0+ve]=_t}}else _t=de(xe,156)?de(xe,128)?1:3:de(xe,163)?2:0,Te.Ob[0]=_t,n(De,Pe,_t,4),n(Xe,0,_t,4);Te.Dd=de(xe,142)?de(xe,114)?de(xe,183)?1:3:2:0}if(ye.m.Ka)return cs(ne,7,"Premature end-of-partition0 encountered.");for(;ne.ja<ne.za;++ne.ja){if(ye=J,xe=(te=ne).rb[te.sb-1],De=te.rb[te.sb+te.ja],pe=te.ya[te.aa+te.ja],Pe=te.kc?pe.Ad:0)xe.la=De.la=0,pe.Za||(xe.Na=De.Na=0),pe.Hc=0,pe.Gc=0,pe.ia=0;else{var Ut,ht;if(xe=De,De=ye,Pe=te.Pa.Xc,Xe=te.ya[te.aa+te.ja],Te=te.pb[Xe.$b],ve=Xe.ad,jt=0,Ot=te.rb[te.sb-1],_t=Lt=0,n(ve,jt,0,384),Xe.Za)var vs=0,pn=Pe[3];else{Vt=r(16);var ws=xe.Na+Ot.Na;if(ws=_l(De,Pe[1],ws,Te.Eb,0,Vt,0),xe.Na=Ot.Na=(0<ws)+0,1<ws)so(Vt,0,ve,jt);else{var mn=Vt[0]+3>>3;for(Vt=0;256>Vt;Vt+=16)ve[jt+Vt]=mn}vs=1,pn=Pe[0]}var Mt=15&xe.la,En=15&Ot.la;for(Vt=0;4>Vt;++Vt){var kn=1&En;for(mn=ht=0;4>mn;++mn)Mt=Mt>>1|(kn=(ws=_l(De,pn,ws=kn+(1&Mt),Te.Sc,vs,ve,jt))>vs)<<7,ht=ht<<2|(3<ws?3:1<ws?2:ve[jt+0]!=0),jt+=16;Mt>>=4,En=En>>1|kn<<7,Lt=(Lt<<8|ht)>>>0}for(pn=Mt,vs=En>>4,Ut=0;4>Ut;Ut+=2){for(ht=0,Mt=xe.la>>4+Ut,En=Ot.la>>4+Ut,Vt=0;2>Vt;++Vt){for(kn=1&En,mn=0;2>mn;++mn)ws=kn+(1&Mt),Mt=Mt>>1|(kn=0<(ws=_l(De,Pe[2],ws,Te.Qc,0,ve,jt)))<<3,ht=ht<<2|(3<ws?3:1<ws?2:ve[jt+0]!=0),jt+=16;Mt>>=2,En=En>>1|kn<<5}_t|=ht<<4*Ut,pn|=Mt<<4<<Ut,vs|=(240&En)<<Ut}xe.la=pn,Ot.la=vs,Xe.Hc=Lt,Xe.Gc=_t,Xe.ia=43690&_t?0:Te.ia,Pe=!(Lt|_t)}if(0<te.L&&(te.wa[te.Y+te.ja]=te.gd[pe.$b][pe.Za],te.wa[te.Y+te.ja].La|=!Pe),ye.Ka)return cs(ne,7,"Premature end-of-file encountered.")}if(Qo(ne),te=we,ye=1,pe=(J=ne).D,xe=0<J.L&&J.M>=J.zb&&J.M<=J.Va,J.Aa==0)e:{if(pe.M=J.M,pe.uc=xe,fl(J,pe),ye=1,pe=(ht=J.D).Nb,xe=(_t=_h[J.L])*J.R,De=_t/2*J.B,Vt=16*pe*J.R,mn=8*pe*J.B,Pe=J.sa,Xe=J.ta-xe+Vt,Te=J.qa,ve=J.ra-De+mn,jt=J.Ha,Ot=J.Ia-De+mn,En=(Mt=ht.M)==0,Lt=Mt>=J.Va-1,J.Aa==2&&fl(J,ht),ht.uc)for(kn=(ws=J).D.M,e(ws.D.uc),ht=ws.yb;ht<ws.Hb;++ht){vs=ht,pn=kn;var js=($s=(os=ws).D).Nb;Ut=os.R;var $s=$s.wa[$s.Y+vs],nn=os.sa,Un=os.ta+16*js*Ut+16*vs,Ti=$s.dd,Is=$s.tc;if(Is!=0)if(e(3<=Is),os.L==1)0<vs&&_r(nn,Un,Ut,Is+4),$s.La&&Dn(nn,Un,Ut,Is),0<pn&&oa(nn,Un,Ut,Is+4),$s.La&&wl(nn,Un,Ut,Is);else{var sr=os.B,la=os.qa,ao=os.ra+8*js*sr+8*vs,Nr=os.Ha,os=os.Ia+8*js*sr+8*vs;js=$s.ld,0<vs&&(dh(nn,Un,Ut,Is+4,Ti,js),ia(la,ao,Nr,os,sr,Is+4,Ti,js)),$s.La&&(xr(nn,Un,Ut,Is,Ti,js),io(la,ao,Nr,os,sr,Is,Ti,js)),0<pn&&(no(nn,Un,Ut,Is+4,Ti,js),vl(la,ao,Nr,os,sr,Is+4,Ti,js)),$s.La&&(ra(nn,Un,Ut,Is,Ti,js),aa(la,ao,Nr,os,sr,Is,Ti,js))}}if(J.ia&&alert("todo:DitherRow"),te.put!=null){if(ht=16*Mt,Mt=16*(Mt+1),En?(te.y=J.sa,te.O=J.ta+Vt,te.f=J.qa,te.N=J.ra+mn,te.ea=J.Ha,te.W=J.Ia+mn):(ht-=_t,te.y=Pe,te.O=Xe,te.f=Te,te.N=ve,te.ea=jt,te.W=Ot),Lt||(Mt-=_t),Mt>te.o&&(Mt=te.o),te.F=null,te.J=null,J.Fa!=null&&0<J.Fa.length&&ht<Mt&&(te.J=ul(J,te,ht,Mt-ht),te.F=J.mb,te.F==null&&te.F.length==0)){ye=cs(J,3,"Could not decode alpha data.");break e}ht<te.j&&(_t=te.j-ht,ht=te.j,e(!(1&_t)),te.O+=J.R*_t,te.N+=J.B*(_t>>1),te.W+=J.B*(_t>>1),te.F!=null&&(te.J+=te.width*_t)),ht<Mt&&(te.O+=te.v,te.N+=te.v>>1,te.W+=te.v>>1,te.F!=null&&(te.J+=te.v),te.ka=ht-te.j,te.U=te.va-te.v,te.T=Mt-ht,ye=te.put(te))}pe+1!=J.Ic||Lt||(s(J.sa,J.ta-xe,Pe,Xe+16*J.R,xe),s(J.qa,J.ra-De,Te,ve+8*J.B,De),s(J.Ha,J.Ia-De,jt,Ot+8*J.B,De))}if(!ye)return cs(ne,6,"Output aborted.")}return 1}(u,m)),m.bc!=null&&m.bc(m),y&=1}return y?(u.cb=0,y):0}function Qn(u,m,y,_,N){N=u[m+y+32*_]+(N>>3),u[m+y+32*_]=-256&N?0>N?0:255:N}function Ua(u,m,y,_,N,C){Qn(u,m,0,y,_+N),Qn(u,m,1,y,_+C),Qn(u,m,2,y,_-C),Qn(u,m,3,y,_-N)}function un(u){return(20091*u>>16)+u}function el(u,m,y,_){var N,C=0,P=r(16);for(N=0;4>N;++N){var T=u[m+0]+u[m+8],I=u[m+0]-u[m+8],F=(35468*u[m+4]>>16)-un(u[m+12]),K=un(u[m+4])+(35468*u[m+12]>>16);P[C+0]=T+K,P[C+1]=I+F,P[C+2]=I-F,P[C+3]=T-K,C+=4,m++}for(N=C=0;4>N;++N)T=(u=P[C+0]+4)+P[C+8],I=u-P[C+8],F=(35468*P[C+4]>>16)-un(P[C+12]),Qn(y,_,0,0,T+(K=un(P[C+4])+(35468*P[C+12]>>16))),Qn(y,_,1,0,I+F),Qn(y,_,2,0,I-F),Qn(y,_,3,0,T-K),C++,_+=32}function Yc(u,m,y,_){var N=u[m+0]+4,C=35468*u[m+4]>>16,P=un(u[m+4]),T=35468*u[m+1]>>16;Ua(y,_,0,N+P,u=un(u[m+1]),T),Ua(y,_,1,N+C,u,T),Ua(y,_,2,N-C,u,T),Ua(y,_,3,N-P,u,T)}function dd(u,m,y,_,N){el(u,m,y,_),N&&el(u,m+16,y,_+4)}function Kc(u,m,y,_){Qi(u,m+0,y,_,1),Qi(u,m+32,y,_+128,1)}function fd(u,m,y,_){var N;for(u=u[m+0]+4,N=0;4>N;++N)for(m=0;4>m;++m)Qn(y,_,m,N,u)}function Jc(u,m,y,_){u[m+0]&&sn(u,m+0,y,_),u[m+16]&&sn(u,m+16,y,_+4),u[m+32]&&sn(u,m+32,y,_+128),u[m+48]&&sn(u,m+48,y,_+128+4)}function pd(u,m,y,_){var N,C=r(16);for(N=0;4>N;++N){var P=u[m+0+N]+u[m+12+N],T=u[m+4+N]+u[m+8+N],I=u[m+4+N]-u[m+8+N],F=u[m+0+N]-u[m+12+N];C[0+N]=P+T,C[8+N]=P-T,C[4+N]=F+I,C[12+N]=F-I}for(N=0;4>N;++N)P=(u=C[0+4*N]+3)+C[3+4*N],T=C[1+4*N]+C[2+4*N],I=C[1+4*N]-C[2+4*N],F=u-C[3+4*N],y[_+0]=P+T>>3,y[_+16]=F+I>>3,y[_+32]=P-T>>3,y[_+48]=F-I>>3,_+=64}function tl(u,m,y){var _,N=m-32,C=Nn,P=255-u[N-1];for(_=0;_<y;++_){var T,I=C,F=P+u[m-1];for(T=0;T<y;++T)u[m+T]=I[F+u[N+T]];m+=32}}function md(u,m){tl(u,m,4)}function gd(u,m){tl(u,m,8)}function bd(u,m){tl(u,m,16)}function Yi(u,m){var y;for(y=0;16>y;++y)s(u,m+32*y,u,m-32,16)}function za(u,m){var y;for(y=16;0<y;--y)n(u,m,u[m-1],16),m+=32}function Ha(u,m,y){var _;for(_=0;16>_;++_)n(m,y+32*_,u,16)}function Zc(u,m){var y,_=16;for(y=0;16>y;++y)_+=u[m-1+32*y]+u[m+y-32];Ha(_>>5,u,m)}function Hs(u,m){var y,_=8;for(y=0;16>y;++y)_+=u[m-1+32*y];Ha(_>>4,u,m)}function yd(u,m){var y,_=8;for(y=0;16>y;++y)_+=u[m+y-32];Ha(_>>4,u,m)}function Qc(u,m){Ha(128,u,m)}function st(u,m,y){return u+2*m+y+2>>2}function vd(u,m){var y,_=m-32;for(_=new Uint8Array([st(u[_-1],u[_+0],u[_+1]),st(u[_+0],u[_+1],u[_+2]),st(u[_+1],u[_+2],u[_+3]),st(u[_+2],u[_+3],u[_+4])]),y=0;4>y;++y)s(u,m+32*y,_,0,_.length)}function wd(u,m){var y=u[m-1],_=u[m-1+32],N=u[m-1+64],C=u[m-1+96];Ee(u,m+0,16843009*st(u[m-1-32],y,_)),Ee(u,m+32,16843009*st(y,_,N)),Ee(u,m+64,16843009*st(_,N,C)),Ee(u,m+96,16843009*st(N,C,C))}function Ci(u,m){var y,_=4;for(y=0;4>y;++y)_+=u[m+y-32]+u[m-1+32*y];for(_>>=3,y=0;4>y;++y)n(u,m+32*y,_,4)}function eh(u,m){var y=u[m-1+0],_=u[m-1+32],N=u[m-1+64],C=u[m-1-32],P=u[m+0-32],T=u[m+1-32],I=u[m+2-32],F=u[m+3-32];u[m+0+96]=st(_,N,u[m-1+96]),u[m+1+96]=u[m+0+64]=st(y,_,N),u[m+2+96]=u[m+1+64]=u[m+0+32]=st(C,y,_),u[m+3+96]=u[m+2+64]=u[m+1+32]=u[m+0+0]=st(P,C,y),u[m+3+64]=u[m+2+32]=u[m+1+0]=st(T,P,C),u[m+3+32]=u[m+2+0]=st(I,T,P),u[m+3+0]=st(F,I,T)}function th(u,m){var y=u[m+1-32],_=u[m+2-32],N=u[m+3-32],C=u[m+4-32],P=u[m+5-32],T=u[m+6-32],I=u[m+7-32];u[m+0+0]=st(u[m+0-32],y,_),u[m+1+0]=u[m+0+32]=st(y,_,N),u[m+2+0]=u[m+1+32]=u[m+0+64]=st(_,N,C),u[m+3+0]=u[m+2+32]=u[m+1+64]=u[m+0+96]=st(N,C,P),u[m+3+32]=u[m+2+64]=u[m+1+96]=st(C,P,T),u[m+3+64]=u[m+2+96]=st(P,T,I),u[m+3+96]=st(T,I,I)}function Wa(u,m){var y=u[m-1+0],_=u[m-1+32],N=u[m-1+64],C=u[m-1-32],P=u[m+0-32],T=u[m+1-32],I=u[m+2-32],F=u[m+3-32];u[m+0+0]=u[m+1+64]=C+P+1>>1,u[m+1+0]=u[m+2+64]=P+T+1>>1,u[m+2+0]=u[m+3+64]=T+I+1>>1,u[m+3+0]=I+F+1>>1,u[m+0+96]=st(N,_,y),u[m+0+64]=st(_,y,C),u[m+0+32]=u[m+1+96]=st(y,C,P),u[m+1+32]=u[m+2+96]=st(C,P,T),u[m+2+32]=u[m+3+96]=st(P,T,I),u[m+3+32]=st(T,I,F)}function sl(u,m){var y=u[m+0-32],_=u[m+1-32],N=u[m+2-32],C=u[m+3-32],P=u[m+4-32],T=u[m+5-32],I=u[m+6-32],F=u[m+7-32];u[m+0+0]=y+_+1>>1,u[m+1+0]=u[m+0+64]=_+N+1>>1,u[m+2+0]=u[m+1+64]=N+C+1>>1,u[m+3+0]=u[m+2+64]=C+P+1>>1,u[m+0+32]=st(y,_,N),u[m+1+32]=u[m+0+96]=st(_,N,C),u[m+2+32]=u[m+1+96]=st(N,C,P),u[m+3+32]=u[m+2+96]=st(C,P,T),u[m+3+64]=st(P,T,I),u[m+3+96]=st(T,I,F)}function xd(u,m){var y=u[m-1+0],_=u[m-1+32],N=u[m-1+64],C=u[m-1+96];u[m+0+0]=y+_+1>>1,u[m+2+0]=u[m+0+32]=_+N+1>>1,u[m+2+32]=u[m+0+64]=N+C+1>>1,u[m+1+0]=st(y,_,N),u[m+3+0]=u[m+1+32]=st(_,N,C),u[m+3+32]=u[m+1+64]=st(N,C,C),u[m+3+64]=u[m+2+64]=u[m+0+96]=u[m+1+96]=u[m+2+96]=u[m+3+96]=C}function _d(u,m){var y=u[m-1+0],_=u[m-1+32],N=u[m-1+64],C=u[m-1+96],P=u[m-1-32],T=u[m+0-32],I=u[m+1-32],F=u[m+2-32];u[m+0+0]=u[m+2+32]=y+P+1>>1,u[m+0+32]=u[m+2+64]=_+y+1>>1,u[m+0+64]=u[m+2+96]=N+_+1>>1,u[m+0+96]=C+N+1>>1,u[m+3+0]=st(T,I,F),u[m+2+0]=st(P,T,I),u[m+1+0]=u[m+3+32]=st(y,P,T),u[m+1+32]=u[m+3+64]=st(_,y,P),u[m+1+64]=u[m+3+96]=st(N,_,y),u[m+1+96]=st(C,N,_)}function Ad(u,m){var y;for(y=0;8>y;++y)s(u,m+32*y,u,m-32,8)}function nl(u,m){var y;for(y=0;8>y;++y)n(u,m,u[m-1],8),m+=32}function Qr(u,m,y){var _;for(_=0;8>_;++_)n(m,y+32*_,u,8)}function gr(u,m){var y,_=8;for(y=0;8>y;++y)_+=u[m+y-32]+u[m-1+32*y];Qr(_>>4,u,m)}function Sd(u,m){var y,_=4;for(y=0;8>y;++y)_+=u[m+y-32];Qr(_>>3,u,m)}function ea(u,m){var y,_=4;for(y=0;8>y;++y)_+=u[m-1+32*y];Qr(_>>3,u,m)}function il(u,m){Qr(128,u,m)}function Va(u,m,y){var _=u[m-y],N=u[m+0],C=3*(N-_)+Ld[1020+u[m-2*y]-u[m+y]],P=ph[112+(C+4>>3)];u[m-y]=Nn[255+_+ph[112+(C+3>>3)]],u[m+0]=Nn[255+N-P]}function sh(u,m,y,_){var N=u[m+0],C=u[m+y];return $n[255+u[m-2*y]-u[m-y]]>_||$n[255+C-N]>_}function nh(u,m,y,_){return 4*$n[255+u[m-y]-u[m+0]]+$n[255+u[m-2*y]-u[m+y]]<=_}function ih(u,m,y,_,N){var C=u[m-3*y],P=u[m-2*y],T=u[m-y],I=u[m+0],F=u[m+y],K=u[m+2*y],le=u[m+3*y];return 4*$n[255+T-I]+$n[255+P-F]>_?0:$n[255+u[m-4*y]-C]<=N&&$n[255+C-P]<=N&&$n[255+P-T]<=N&&$n[255+le-K]<=N&&$n[255+K-F]<=N&&$n[255+F-I]<=N}function rh(u,m,y,_){var N=2*_+1;for(_=0;16>_;++_)nh(u,m+_,y,N)&&Va(u,m+_,y)}function Pi(u,m,y,_){var N=2*_+1;for(_=0;16>_;++_)nh(u,m+_*y,1,N)&&Va(u,m+_*y,1)}function Ki(u,m,y,_){var N;for(N=3;0<N;--N)rh(u,m+=4*y,y,_)}function Nd(u,m,y,_){var N;for(N=3;0<N;--N)Pi(u,m+=4,y,_)}function br(u,m,y,_,N,C,P,T){for(C=2*C+1;0<N--;){if(ih(u,m,y,C,P))if(sh(u,m,y,T))Va(u,m,y);else{var I=u,F=m,K=y,le=I[F-2*K],ce=I[F-K],ne=I[F+0],we=I[F+K],pe=I[F+2*K],J=27*(ye=Ld[1020+3*(ne-ce)+Ld[1020+le-we]])+63>>7,te=18*ye+63>>7,ye=9*ye+63>>7;I[F-3*K]=Nn[255+I[F-3*K]+ye],I[F-2*K]=Nn[255+le+te],I[F-K]=Nn[255+ce+J],I[F+0]=Nn[255+ne-J],I[F+K]=Nn[255+we-te],I[F+2*K]=Nn[255+pe-ye]}m+=_}}function ei(u,m,y,_,N,C,P,T){for(C=2*C+1;0<N--;){if(ih(u,m,y,C,P))if(sh(u,m,y,T))Va(u,m,y);else{var I=u,F=m,K=y,le=I[F-K],ce=I[F+0],ne=I[F+K],we=ph[112+((pe=3*(ce-le))+4>>3)],pe=ph[112+(pe+3>>3)],J=we+1>>1;I[F-2*K]=Nn[255+I[F-2*K]+J],I[F-K]=Nn[255+le+pe],I[F+0]=Nn[255+ce-we],I[F+K]=Nn[255+ne-J]}m+=_}}function rl(u,m,y,_,N,C){br(u,m,y,1,16,_,N,C)}function ta(u,m,y,_,N,C){br(u,m,1,y,16,_,N,C)}function Ed(u,m,y,_,N,C){var P;for(P=3;0<P;--P)ei(u,m+=4*y,y,1,16,_,N,C)}function Ga(u,m,y,_,N,C){var P;for(P=3;0<P;--P)ei(u,m+=4,1,y,16,_,N,C)}function kd(u,m,y,_,N,C,P,T){br(u,m,N,1,8,C,P,T),br(y,_,N,1,8,C,P,T)}function al(u,m,y,_,N,C,P,T){br(u,m,1,N,8,C,P,T),br(y,_,1,N,8,C,P,T)}function ol(u,m,y,_,N,C,P,T){ei(u,m+4*N,N,1,8,C,P,T),ei(y,_+4*N,N,1,8,C,P,T)}function ah(u,m,y,_,N,C,P,T){ei(u,m+4,1,N,8,C,P,T),ei(y,_+4,1,N,8,C,P,T)}function Xa(){this.ba=new Xn,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new rs,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function ll(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function cl(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function oh(){this.ua=0,this.Wa=new H,this.vb=new H,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new U,this.yc=new R}function Cd(){this.xb=this.a=0,this.l=new qa,this.ca=new Xn,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new k,this.Pb=0,this.wd=new k,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new oh,this.ab=0,this.gc=a(4,cl),this.Oc=0}function Ya(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new qa,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function sa(u,m,y,_,N,C,P){for(u=u==null?0:u[m+0],m=0;m<P;++m)N[C+m]=u+y[_+m]&255,u=N[C+m]}function hl(u,m,y,_,N,C,P){var T;if(u==null)sa(null,null,y,_,N,C,P);else for(T=0;T<P;++T)N[C+T]=u[m+T]+y[_+T]&255}function yr(u,m,y,_,N,C,P){if(u==null)sa(null,null,y,_,N,C,P);else{var T,I=u[m+0],F=I,K=I;for(T=0;T<P;++T)F=K+(I=u[m+T])-F,K=y[_+T]+(-256&F?0>F?0:255:F)&255,F=I,N[C+T]=K}}function ul(u,m,y,_){var N=m.width,C=m.o;if(e(u!=null&&m!=null),0>y||0>=_||y+_>C)return null;if(!u.Cc){if(u.ga==null){var P;if(u.ga=new Ya,(P=u.ga==null)||(P=m.width*m.o,e(u.Gb.length==0),u.Gb=r(P),u.Uc=0,u.Gb==null?P=0:(u.mb=u.Gb,u.nb=u.Uc,u.rc=null,P=1),P=!P),!P){P=u.ga;var T=u.Fa,I=u.P,F=u.qc,K=u.mb,le=u.nb,ce=I+1,ne=F-1,we=P.l;if(e(T!=null&&K!=null&&m!=null),Sr[0]=null,Sr[1]=sa,Sr[2]=hl,Sr[3]=yr,P.ca=K,P.tb=le,P.c=m.width,P.i=m.height,e(0<P.c&&0<P.i),1>=F)m=0;else if(P.$a=T[I+0]>>0&3,P.Z=T[I+0]>>2&3,P.Lc=T[I+0]>>4&3,I=T[I+0]>>6&3,0>P.$a||1<P.$a||4<=P.Z||1<P.Lc||I)m=0;else if(we.put=Ai,we.ac=Ds,we.bc=Si,we.ma=P,we.width=m.width,we.height=m.height,we.Da=m.Da,we.v=m.v,we.va=m.va,we.j=m.j,we.o=m.o,P.$a)e:{e(P.$a==1),m=On();t:for(;;){if(m==null){m=0;break e}if(e(P!=null),P.mc=m,m.c=P.c,m.i=P.i,m.l=P.l,m.l.ma=P,m.l.width=P.c,m.l.height=P.i,m.a=0,Z(m.m,T,ce,ne),!ki(P.c,P.i,1,m,null)||(m.ab==1&&m.gc[0].hc==3&&Xi(m.s)?(P.ic=1,T=m.c*m.i,m.Ta=null,m.Ua=0,m.V=r(T),m.Ba=0,m.V==null?(m.a=1,m=0):m=1):(P.ic=0,m=Zr(m,P.c)),!m))break t;m=1;break e}P.mc=null,m=0}else m=ne>=P.c*P.i;P=!m}if(P)return null;u.ga.Lc!=1?u.Ga=0:_=C-y}e(u.ga!=null),e(y+_<=C);e:{if(m=(T=u.ga).c,C=T.l.o,T.$a==0){if(ce=u.rc,ne=u.Vc,we=u.Fa,I=u.P+1+y*m,F=u.mb,K=u.nb+y*m,e(I<=u.P+u.qc),T.Z!=0)for(e(Sr[T.Z]!=null),P=0;P<_;++P)Sr[T.Z](ce,ne,we,I,F,K,m),ce=F,ne=K,K+=m,I+=m;else for(P=0;P<_;++P)s(F,K,we,I,m),ce=F,ne=K,K+=m,I+=m;u.rc=ce,u.Vc=ne}else{if(e(T.mc!=null),m=y+_,e((P=T.mc)!=null),e(m<=P.i),P.C>=m)m=1;else if(T.ic||oe(),T.ic){T=P.V,ce=P.Ba,ne=P.c;var pe=P.i,J=(we=1,I=P.$/ne,F=P.$%ne,K=P.m,le=P.s,P.$),te=ne*pe,ye=ne*m,xe=le.wc,ve=J<ye?bs(le,F,I):null;e(J<=te),e(m<=pe),e(Xi(le));t:for(;;){for(;!K.h&&J<ye;){if(F&xe||(ve=bs(le,F,I)),e(ve!=null),ee(K),256>(pe=hn(ve.G[0],ve.H[0],K)))T[ce+J]=pe,++J,++F>=ne&&(F=0,++I<=m&&!(I%16)&&Jn(P,I));else{if(!(280>pe)){we=0;break t}pe=Yn(pe-256,K);var De,Pe=hn(ve.G[4],ve.H[4],K);if(ee(K),!(J>=(Pe=Ni(ne,Pe=Yn(Pe,K)))&&te-J>=pe)){we=0;break t}for(De=0;De<pe;++De)T[ce+J+De]=T[ce+J+De-Pe];for(J+=pe,F+=pe;F>=ne;)F-=ne,++I<=m&&!(I%16)&&Jn(P,I);J<ye&&F&xe&&(ve=bs(le,F,I))}e(K.h==z(K))}Jn(P,I>m?m:I);break t}!we||K.h&&J<te?(we=0,P.a=K.h?5:3):P.$=J,m=we}else m=Zn(P,P.V,P.Ba,P.c,P.i,m,Ma);if(!m){_=0;break e}}y+_>=C&&(u.Cc=1),_=1}if(!_)return null;if(u.Cc&&((_=u.ga)!=null&&(_.mc=null),u.ga=null,0<u.Ga))return alert("todo:WebPDequantizeLevels"),null}return u.nb+y*N}function b(u,m,y,_,N,C){for(;0<N--;){var P,T=u,I=m+(y?1:0),F=u,K=m+(y?0:3);for(P=0;P<_;++P){var le=F[K+4*P];le!=255&&(le*=32897,T[I+4*P+0]=T[I+4*P+0]*le>>23,T[I+4*P+1]=T[I+4*P+1]*le>>23,T[I+4*P+2]=T[I+4*P+2]*le>>23)}m+=C}}function E(u,m,y,_,N){for(;0<_--;){var C;for(C=0;C<y;++C){var P=u[m+2*C+0],T=15&(F=u[m+2*C+1]),I=4369*T,F=(240&F|F>>4)*I>>16;u[m+2*C+0]=(240&P|P>>4)*I>>16&240|(15&P|P<<4)*I>>16>>4&15,u[m+2*C+1]=240&F|T}m+=N}}function $(u,m,y,_,N,C,P,T){var I,F,K=255;for(F=0;F<N;++F){for(I=0;I<_;++I){var le=u[m+I];C[P+4*I]=le,K&=le}m+=y,P+=T}return K!=255}function Y(u,m,y,_,N){var C;for(C=0;C<N;++C)y[_+C]=u[m+C]>>8}function oe(){Bn=b,Yt=E,Kt=$,us=Y}function ge(u,m,y){O[u]=function(_,N,C,P,T,I,F,K,le,ce,ne,we,pe,J,te,ye,xe){var ve,De=xe-1>>1,Pe=T[I+0]|F[K+0]<<16,Xe=le[ce+0]|ne[we+0]<<16;e(_!=null);var Te=3*Pe+Xe+131074>>2;for(m(_[N+0],255&Te,Te>>16,pe,J),C!=null&&(Te=3*Xe+Pe+131074>>2,m(C[P+0],255&Te,Te>>16,te,ye)),ve=1;ve<=De;++ve){var jt=T[I+ve]|F[K+ve]<<16,Ot=le[ce+ve]|ne[we+ve]<<16,Lt=Pe+jt+Xe+Ot+524296,_t=Lt+2*(jt+Xe)>>3;Te=_t+Pe>>1,Pe=(Lt=Lt+2*(Pe+Ot)>>3)+jt>>1,m(_[N+2*ve-1],255&Te,Te>>16,pe,J+(2*ve-1)*y),m(_[N+2*ve-0],255&Pe,Pe>>16,pe,J+(2*ve-0)*y),C!=null&&(Te=Lt+Xe>>1,Pe=_t+Ot>>1,m(C[P+2*ve-1],255&Te,Te>>16,te,ye+(2*ve-1)*y),m(C[P+2*ve+0],255&Pe,Pe>>16,te,ye+(2*ve+0)*y)),Pe=jt,Xe=Ot}1&xe||(Te=3*Pe+Xe+131074>>2,m(_[N+xe-1],255&Te,Te>>16,pe,J+(xe-1)*y),C!=null&&(Te=3*Xe+Pe+131074>>2,m(C[P+xe-1],255&Te,Te>>16,te,ye+(xe-1)*y)))}}function _e(){qn[mh]=iy,qn[gh]=Em,qn[xm]=ry,qn[bh]=km,qn[yh]=Cm,qn[Td]=Pm,qn[_m]=ay,qn[jd]=Em,qn[Id]=km,qn[vh]=Cm,qn[Rd]=Pm}function Fe(u){return u&~oy?0>u?0:255:u>>Lm}function Ge(u,m){return Fe((19077*u>>8)+(26149*m>>8)-14234)}function ct(u,m,y){return Fe((19077*u>>8)-(6419*m>>8)-(13320*y>>8)+8708)}function at(u,m){return Fe((19077*u>>8)+(33050*m>>8)-17685)}function kt(u,m,y,_,N){_[N+0]=Ge(u,y),_[N+1]=ct(u,m,y),_[N+2]=at(u,m)}function ts(u,m,y,_,N){_[N+0]=at(u,m),_[N+1]=ct(u,m,y),_[N+2]=Ge(u,y)}function as(u,m,y,_,N){var C=ct(u,m,y);m=C<<3&224|at(u,m)>>3,_[N+0]=248&Ge(u,y)|C>>5,_[N+1]=m}function ys(u,m,y,_,N){var C=240&at(u,m)|15;_[N+0]=240&Ge(u,y)|ct(u,m,y)>>4,_[N+1]=C}function Ws(u,m,y,_,N){_[N+0]=255,kt(u,m,y,_,N+1)}function Ts(u,m,y,_,N){ts(u,m,y,_,N),_[N+3]=255}function ti(u,m,y,_,N){kt(u,m,y,_,N),_[N+3]=255}function Sn(u,m){return 0>u?0:u>m?m:u}function Li(u,m,y){O[u]=function(_,N,C,P,T,I,F,K,le){for(var ce=K+(-2&le)*y;K!=ce;)m(_[N+0],C[P+0],T[I+0],F,K),m(_[N+1],C[P+0],T[I+0],F,K+y),N+=2,++P,++I,K+=2*y;1&le&&m(_[N+0],C[P+0],T[I+0],F,K)}}function lh(u,m,y){return y==0?u==0?m==0?6:5:m==0?4:0:y}function dl(u,m,y,_,N){switch(u>>>30){case 3:Qi(m,y,_,N,0);break;case 2:hs(m,y,_,N);break;case 1:sn(m,y,_,N)}}function fl(u,m){var y,_,N=m.M,C=m.Nb,P=u.oc,T=u.pc+40,I=u.oc,F=u.pc+584,K=u.oc,le=u.pc+600;for(y=0;16>y;++y)P[T+32*y-1]=129;for(y=0;8>y;++y)I[F+32*y-1]=129,K[le+32*y-1]=129;for(0<N?P[T-1-32]=I[F-1-32]=K[le-1-32]=129:(n(P,T-32-1,127,21),n(I,F-32-1,127,9),n(K,le-32-1,127,9)),_=0;_<u.za;++_){var ce=m.ya[m.aa+_];if(0<_){for(y=-1;16>y;++y)s(P,T+32*y-4,P,T+32*y+12,4);for(y=-1;8>y;++y)s(I,F+32*y-4,I,F+32*y+4,4),s(K,le+32*y-4,K,le+32*y+4,4)}var ne=u.Gd,we=u.Hd+_,pe=ce.ad,J=ce.Hc;if(0<N&&(s(P,T-32,ne[we].y,0,16),s(I,F-32,ne[we].f,0,8),s(K,le-32,ne[we].ea,0,8)),ce.Za){var te=P,ye=T-32+16;for(0<N&&(_>=u.za-1?n(te,ye,ne[we].y[15],4):s(te,ye,ne[we+1].y,0,4)),y=0;4>y;y++)te[ye+128+y]=te[ye+256+y]=te[ye+384+y]=te[ye+0+y];for(y=0;16>y;++y,J<<=2)te=P,ye=T+jm[y],si[ce.Ob[y]](te,ye),dl(J,pe,16*+y,te,ye)}else if(te=lh(_,N,ce.Ob[0]),Ar[te](P,T),J!=0)for(y=0;16>y;++y,J<<=2)dl(J,pe,16*+y,P,T+jm[y]);for(y=ce.Gc,te=lh(_,N,ce.Dd),tr[te](I,F),tr[te](K,le),J=pe,te=I,ye=F,255&(ce=y>>0)&&(170&ce?yl(J,256,te,ye):Fn(J,256,te,ye)),ce=K,J=le,255&(y>>=8)&&(170&y?yl(pe,320,ce,J):Fn(pe,320,ce,J)),N<u.Ub-1&&(s(ne[we].y,0,P,T+480,16),s(ne[we].f,0,I,F+224,8),s(ne[we].ea,0,K,le+224,8)),y=8*C*u.B,ne=u.sa,we=u.ta+16*_+16*C*u.R,pe=u.qa,ce=u.ra+8*_+y,J=u.Ha,te=u.Ia+8*_+y,y=0;16>y;++y)s(ne,we+y*u.R,P,T+32*y,16);for(y=0;8>y;++y)s(pe,ce+y*u.B,I,F+32*y,8),s(J,te+y*u.B,K,le+32*y,8)}}function Ka(u,m,y,_,N,C,P,T,I){var F=[0],K=[0],le=0,ce=I!=null?I.kd:0,ne=I??new ll;if(u==null||12>y)return 7;ne.data=u,ne.w=m,ne.ha=y,m=[m],y=[y],ne.gb=[ne.gb];e:{var we=m,pe=y,J=ne.gb;if(e(u!=null),e(pe!=null),e(J!=null),J[0]=0,12<=pe[0]&&!t(u,we[0],"RIFF")){if(t(u,we[0]+8,"WEBP")){J=3;break e}var te=Le(u,we[0]+4);if(12>te||4294967286<te){J=3;break e}if(ce&&te>pe[0]-8){J=7;break e}J[0]=te,we[0]+=12,pe[0]-=12}J=0}if(J!=0)return J;for(te=0<ne.gb[0],y=y[0];;){e:{var ye=u;pe=m,J=y;var xe=F,ve=K,De=we=[0];if((Te=le=[le])[0]=0,8>J[0])J=7;else{if(!t(ye,pe[0],"VP8X")){if(Le(ye,pe[0]+4)!=10){J=3;break e}if(18>J[0]){J=7;break e}var Pe=Le(ye,pe[0]+8),Xe=1+Re(ye,pe[0]+12);if(2147483648<=Xe*(ye=1+Re(ye,pe[0]+15))){J=3;break e}De!=null&&(De[0]=Pe),xe!=null&&(xe[0]=Xe),ve!=null&&(ve[0]=ye),pe[0]+=18,J[0]-=18,Te[0]=1}J=0}}if(le=le[0],we=we[0],J!=0)return J;if(pe=!!(2&we),!te&&le)return 3;if(C!=null&&(C[0]=!!(16&we)),P!=null&&(P[0]=pe),T!=null&&(T[0]=0),P=F[0],we=K[0],le&&pe&&I==null){J=0;break}if(4>y){J=7;break}if(te&&le||!te&&!le&&!t(u,m[0],"ALPH")){y=[y],ne.na=[ne.na],ne.P=[ne.P],ne.Sa=[ne.Sa];e:{Pe=u,J=m,te=y;var Te=ne.gb;xe=ne.na,ve=ne.P,De=ne.Sa,Xe=22,e(Pe!=null),e(te!=null),ye=J[0];var jt=te[0];for(e(xe!=null),e(De!=null),xe[0]=null,ve[0]=null,De[0]=0;;){if(J[0]=ye,te[0]=jt,8>jt){J=7;break e}var Ot=Le(Pe,ye+4);if(4294967286<Ot){J=3;break e}var Lt=8+Ot+1&-2;if(Xe+=Lt,0<Te&&Xe>Te){J=3;break e}if(!t(Pe,ye,"VP8 ")||!t(Pe,ye,"VP8L")){J=0;break e}if(jt[0]<Lt){J=7;break e}t(Pe,ye,"ALPH")||(xe[0]=Pe,ve[0]=ye+8,De[0]=Ot),ye+=Lt,jt-=Lt}}if(y=y[0],ne.na=ne.na[0],ne.P=ne.P[0],ne.Sa=ne.Sa[0],J!=0)break}y=[y],ne.Ja=[ne.Ja],ne.xa=[ne.xa];e:if(Te=u,J=m,te=y,xe=ne.gb[0],ve=ne.Ja,De=ne.xa,Pe=J[0],ye=!t(Te,Pe,"VP8 "),Xe=!t(Te,Pe,"VP8L"),e(Te!=null),e(te!=null),e(ve!=null),e(De!=null),8>te[0])J=7;else{if(ye||Xe){if(Te=Le(Te,Pe+4),12<=xe&&Te>xe-12){J=3;break e}if(ce&&Te>te[0]-8){J=7;break e}ve[0]=Te,J[0]+=8,te[0]-=8,De[0]=Xe}else De[0]=5<=te[0]&&Te[Pe+0]==47&&!(Te[Pe+4]>>5),ve[0]=te[0];J=0}if(y=y[0],ne.Ja=ne.Ja[0],ne.xa=ne.xa[0],m=m[0],J!=0)break;if(4294967286<ne.Ja)return 3;if(T==null||pe||(T[0]=ne.xa?2:1),P=[P],we=[we],ne.xa){if(5>y){J=7;break}T=P,ce=we,pe=C,u==null||5>y?u=0:5<=y&&u[m+0]==47&&!(u[m+4]>>5)?(te=[0],Te=[0],xe=[0],Z(ve=new k,u,m,y),Ye(ve,te,Te,xe)?(T!=null&&(T[0]=te[0]),ce!=null&&(ce[0]=Te[0]),pe!=null&&(pe[0]=xe[0]),u=1):u=0):u=0}else{if(10>y){J=7;break}T=we,u==null||10>y||!Vc(u,m+3,y-3)?u=0:(ce=u[m+0]|u[m+1]<<8|u[m+2]<<16,pe=16383&(u[m+7]<<8|u[m+6]),u=16383&(u[m+9]<<8|u[m+8]),1&ce||3<(ce>>1&7)||!(ce>>4&1)||ce>>5>=ne.Ja||!pe||!u?u=0:(P&&(P[0]=pe),T&&(T[0]=u),u=1))}if(!u||(P=P[0],we=we[0],le&&(F[0]!=P||K[0]!=we)))return 3;I!=null&&(I[0]=ne,I.offset=m-I.w,e(4294967286>m-I.w),e(I.offset==I.ha-y));break}return J==0||J==7&&le&&I==null?(C!=null&&(C[0]|=ne.na!=null&&0<ne.na.length),_!=null&&(_[0]=P),N!=null&&(N[0]=we),0):J}function pl(u,m,y){var _=m.width,N=m.height,C=0,P=0,T=_,I=N;if(m.Da=u!=null&&0<u.Da,m.Da&&(T=u.cd,I=u.bd,C=u.v,P=u.j,11>y||(C&=-2,P&=-2),0>C||0>P||0>=T||0>=I||C+T>_||P+I>N))return 0;if(m.v=C,m.j=P,m.va=C+T,m.o=P+I,m.U=T,m.T=I,m.da=u!=null&&0<u.da,m.da){if(!lt(T,I,y=[u.ib],C=[u.hb]))return 0;m.ib=y[0],m.hb=C[0]}return m.ob=u!=null&&u.ob,m.Kb=u==null||!u.Sd,m.da&&(m.ob=m.ib<3*_/4&&m.hb<3*N/4,m.Kb=0),1}function ml(u){if(u==null)return 2;if(11>u.S){var m=u.f.RGBA;m.fb+=(u.height-1)*m.A,m.A=-m.A}else m=u.f.kb,u=u.height,m.O+=(u-1)*m.fa,m.fa=-m.fa,m.N+=(u-1>>1)*m.Ab,m.Ab=-m.Ab,m.W+=(u-1>>1)*m.Db,m.Db=-m.Db,m.F!=null&&(m.J+=(u-1)*m.lb,m.lb=-m.lb);return 0}function Ja(u,m,y,_){if(_==null||0>=u||0>=m)return 2;if(y!=null){if(y.Da){var N=y.cd,C=y.bd,P=-2&y.v,T=-2&y.j;if(0>P||0>T||0>=N||0>=C||P+N>u||T+C>m)return 2;u=N,m=C}if(y.da){if(!lt(u,m,N=[y.ib],C=[y.hb]))return 2;u=N[0],m=C[0]}}_.width=u,_.height=m;e:{var I=_.width,F=_.height;if(u=_.S,0>=I||0>=F||!(u>=mh&&13>u))u=2;else{if(0>=_.Rd&&_.sd==null){P=C=N=m=0;var K=(T=I*Im[u])*F;if(11>u||(C=(F+1)/2*(m=(I+1)/2),u==12&&(P=(N=I)*F)),(F=r(K+2*C+P))==null){u=1;break e}_.sd=F,11>u?((I=_.f.RGBA).eb=F,I.fb=0,I.A=T,I.size=K):((I=_.f.kb).y=F,I.O=0,I.fa=T,I.Fd=K,I.f=F,I.N=0+K,I.Ab=m,I.Cd=C,I.ea=F,I.W=0+K+C,I.Db=m,I.Ed=C,u==12&&(I.F=F,I.J=0+K+2*C),I.Tc=P,I.lb=N)}if(m=1,N=_.S,C=_.width,P=_.height,N>=mh&&13>N)if(11>N)u=_.f.RGBA,m&=(T=Math.abs(u.A))*(P-1)+C<=u.size,m&=T>=C*Im[N],m&=u.eb!=null;else{u=_.f.kb,T=(C+1)/2,K=(P+1)/2,I=Math.abs(u.fa),F=Math.abs(u.Ab);var le=Math.abs(u.Db),ce=Math.abs(u.lb),ne=ce*(P-1)+C;m&=I*(P-1)+C<=u.Fd,m&=F*(K-1)+T<=u.Cd,m=(m&=le*(K-1)+T<=u.Ed)&I>=C&F>=T&le>=T,m&=u.y!=null,m&=u.f!=null,m&=u.ea!=null,N==12&&(m&=ce>=C,m&=ne<=u.Tc,m&=u.F!=null)}else m=0;u=m?0:2}}return u!=0||y!=null&&y.fd&&(u=ml(_)),u}var Bs=64,Za=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Qa=24,eo=32,gl=8,dn=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ce("Predictor0","PredictorAdd0"),O.Predictor0=function(){return 4278190080},O.Predictor1=function(u){return u},O.Predictor2=function(u,m,y){return m[y+0]},O.Predictor3=function(u,m,y){return m[y+1]},O.Predictor4=function(u,m,y){return m[y-1]},O.Predictor5=function(u,m,y){return je(je(u,m[y+1]),m[y+0])},O.Predictor6=function(u,m,y){return je(u,m[y-1])},O.Predictor7=function(u,m,y){return je(u,m[y+0])},O.Predictor8=function(u,m,y){return je(m[y-1],m[y+0])},O.Predictor9=function(u,m,y){return je(m[y+0],m[y+1])},O.Predictor10=function(u,m,y){return je(je(u,m[y-1]),je(m[y+0],m[y+1]))},O.Predictor11=function(u,m,y){var _=m[y+0];return 0>=ft(_>>24&255,u>>24&255,(m=m[y-1])>>24&255)+ft(_>>16&255,u>>16&255,m>>16&255)+ft(_>>8&255,u>>8&255,m>>8&255)+ft(255&_,255&u,255&m)?_:u},O.Predictor12=function(u,m,y){var _=m[y+0];return(Ve((u>>24&255)+(_>>24&255)-((m=m[y-1])>>24&255))<<24|Ve((u>>16&255)+(_>>16&255)-(m>>16&255))<<16|Ve((u>>8&255)+(_>>8&255)-(m>>8&255))<<8|Ve((255&u)+(255&_)-(255&m)))>>>0},O.Predictor13=function(u,m,y){var _=m[y-1];return(it((u=je(u,m[y+0]))>>24&255,_>>24&255)<<24|it(u>>16&255,_>>16&255)<<16|it(u>>8&255,_>>8&255)<<8|it(u>>0&255,_>>0&255))>>>0};var Pd=O.PredictorAdd0;O.PredictorAdd1=vt,Ce("Predictor2","PredictorAdd2"),Ce("Predictor3","PredictorAdd3"),Ce("Predictor4","PredictorAdd4"),Ce("Predictor5","PredictorAdd5"),Ce("Predictor6","PredictorAdd6"),Ce("Predictor7","PredictorAdd7"),Ce("Predictor8","PredictorAdd8"),Ce("Predictor9","PredictorAdd9"),Ce("Predictor10","PredictorAdd10"),Ce("Predictor11","PredictorAdd11"),Ce("Predictor12","PredictorAdd12"),Ce("Predictor13","PredictorAdd13");var bl=O.PredictorAdd2;wt("ColorIndexInverseTransform","MapARGB","32b",function(u){return u>>8&255},function(u){return u}),wt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(u){return u},function(u){return u>>8&255});var ch,Mn=O.ColorIndexInverseTransform,to=O.MapARGB,hh=O.VP8LColorIndexInverseTransformAlpha,uh=O.MapAlpha,vr=O.VP8LPredictorsAdd=[];vr.length=16,(O.VP8LPredictors=[]).length=16,(O.VP8LPredictorsAdd_C=[]).length=16,(O.VP8LPredictors_C=[]).length=16;var na,fn,tn,wr,Ji,Zi,so,Qi,hs,yl,sn,Fn,no,dh,vl,ia,ra,xr,aa,io,oa,_r,wl,Dn,Bn,Yt,Kt,us,Ss=r(511),er=r(2041),xl=r(225),ro=r(767),fh=0,Ld=er,ph=xl,Nn=ro,$n=Ss,mh=0,gh=1,xm=2,bh=3,yh=4,Td=5,_m=6,jd=7,Id=8,vh=9,Rd=10,H2=[2,3,7],W2=[3,3,11],Am=[280,256,256,256,40],V2=[0,1,1,1,0],G2=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],X2=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Y2=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],K2=8,Od=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Md=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],_l=null,J2=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Z2=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Sm=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Q2=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],ey=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],ty=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],sy=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Ar=[],si=[],tr=[],ny=1,Nm=2,Sr=[],qn=[];ge("UpsampleRgbLinePair",kt,3),ge("UpsampleBgrLinePair",ts,3),ge("UpsampleRgbaLinePair",ti,4),ge("UpsampleBgraLinePair",Ts,4),ge("UpsampleArgbLinePair",Ws,4),ge("UpsampleRgba4444LinePair",ys,2),ge("UpsampleRgb565LinePair",as,2);var iy=O.UpsampleRgbLinePair,ry=O.UpsampleBgrLinePair,Em=O.UpsampleRgbaLinePair,km=O.UpsampleBgraLinePair,Cm=O.UpsampleArgbLinePair,Pm=O.UpsampleRgba4444LinePair,ay=O.UpsampleRgb565LinePair,wh=16,xh=1<<wh-1,Al=-227,Fd=482,Lm=6,oy=(256<<Lm)-1,Tm=0,ly=r(256),cy=r(256),hy=r(256),uy=r(256),dy=r(Fd-Al),fy=r(Fd-Al);Li("YuvToRgbRow",kt,3),Li("YuvToBgrRow",ts,3),Li("YuvToRgbaRow",ti,4),Li("YuvToBgraRow",Ts,4),Li("YuvToArgbRow",Ws,4),Li("YuvToRgba4444Row",ys,2),Li("YuvToRgb565Row",as,2);var jm=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],_h=[0,2,8],py=[8,7,6,4,4,2,2,2,1,1,1,1],my=1;this.WebPDecodeRGBA=function(u,m,y,_,N){var C=gh,P=new Xa,T=new Xn;P.ba=T,T.S=C,T.width=[T.width],T.height=[T.height];var I=T.width,F=T.height,K=new Gi;if(K==null||u==null)var le=2;else e(K!=null),le=Ka(u,m,y,K.width,K.height,K.Pd,K.Qd,K.format,null);if(le!=0?I=0:(I!=null&&(I[0]=K.width[0]),F!=null&&(F[0]=K.height[0]),I=1),I){T.width=T.width[0],T.height=T.height[0],_!=null&&(_[0]=T.width),N!=null&&(N[0]=T.height);e:{if(_=new qa,(N=new ll).data=u,N.w=m,N.ha=y,N.kd=1,m=[0],e(N!=null),((u=Ka(N.data,N.w,N.ha,null,null,null,m,null,N))==0||u==7)&&m[0]&&(u=4),(m=u)==0){if(e(P!=null),_.data=N.data,_.w=N.w+N.offset,_.ha=N.ha-N.offset,_.put=Ai,_.ac=Ds,_.bc=Si,_.ma=P,N.xa){if((u=On())==null){P=1;break e}if(function(ce,ne){var we=[0],pe=[0],J=[0];t:for(;;){if(ce==null)return 0;if(ne==null)return ce.a=2,0;if(ce.l=ne,ce.a=0,Z(ce.m,ne.data,ne.w,ne.ha),!Ye(ce.m,we,pe,J)){ce.a=3;break t}if(ce.xb=Nm,ne.width=we[0],ne.height=pe[0],!ki(we[0],pe[0],1,ce,null))break t;return 1}return e(ce.a!=0),0}(u,_)){if(_=(m=Ja(_.width,_.height,P.Oa,P.ba))==0){t:{_=u;s:for(;;){if(_==null){_=0;break t}if(e(_.s.yc!=null),e(_.s.Ya!=null),e(0<_.s.Wb),e((y=_.l)!=null),e((N=y.ma)!=null),_.xb!=0){if(_.ca=N.ba,_.tb=N.tb,e(_.ca!=null),!pl(N.Oa,y,bh)){_.a=2;break s}if(!Zr(_,y.width)||y.da)break s;if((y.da||It(_.ca.S))&&oe(),11>_.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),_.ca.f.kb.F!=null&&oe()),_.Pb&&0<_.s.ua&&_.s.vb.X==null&&!Ke(_.s.vb,_.s.Wa.Xa)){_.a=1;break s}_.xb=0}if(!Zn(_,_.V,_.Ba,_.c,_.i,y.o,Oa))break s;N.Dc=_.Ma,_=1;break t}e(_.a!=0),_=0}_=!_}_&&(m=u.a)}else m=u.a}else{if((u=new hd)==null){P=1;break e}if(u.Fa=N.na,u.P=N.P,u.qc=N.Sa,Gc(u,_)){if((m=Ja(_.width,_.height,P.Oa,P.ba))==0){if(u.Aa=0,y=P.Oa,e((N=u)!=null),y!=null){if(0<(I=0>(I=y.Md)?0:100<I?255:255*I/100)){for(F=K=0;4>F;++F)12>(le=N.pb[F]).lc&&(le.ia=I*py[0>le.lc?0:le.lc]>>3),K|=le.ia;K&&(alert("todo:VP8InitRandom"),N.ia=1)}N.Ga=y.Id,100<N.Ga?N.Ga=100:0>N.Ga&&(N.Ga=0)}ud(u,_)||(m=u.a)}}else m=u.a}m==0&&P.Oa!=null&&P.Oa.fd&&(m=ml(P.ba))}P=m}C=P!=0?null:11>C?T.f.RGBA.eb:T.f.kb.y}else C=null;return C};var Im=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(O,G){for(var ie="",L=0;L<4;L++)ie+=String.fromCharCode(O[G++]);return ie}function h(O,G){return(O[G+0]<<0|O[G+1]<<8|O[G+2]<<16)>>>0}function d(O,G){return(O[G+0]<<0|O[G+1]<<8|O[G+2]<<16|O[G+3]<<24)>>>0}new l;var p=[0],f=[0],v=[],w=new l,A=i,x=function(O,G){var ie={},L=0,R=!1,W=0,U=0;if(ie.frames=[],!function(D,z,X,ee){for(var re=0;re<ee;re++)if(D[z+re]!=X.charCodeAt(re))return!0;return!1}(O,G,"RIFF",4)){var he,ae;for(d(O,G+=4),G+=8;G<O.length;){var se=c(O,G),Z=d(O,G+=4);G+=4;var fe=Z+(1&Z);switch(se){case"VP8 ":case"VP8L":ie.frames[L]===void 0&&(ie.frames[L]={}),(k=ie.frames[L]).src_off=R?U:G-8,k.src_size=W+Z+8,L++,R&&(R=!1,W=0,U=0);break;case"VP8X":(k=ie.header={}).feature_flags=O[G];var me=G+4;k.canvas_width=1+h(O,me),me+=3,k.canvas_height=1+h(O,me),me+=3;break;case"ALPH":R=!0,W=fe+8,U=G-8;break;case"ANIM":(k=ie.header).bgcolor=d(O,G),me=G+4,k.loop_count=(he=O)[(ae=me)+0]<<0|he[ae+1]<<8,me+=2;break;case"ANMF":var ke,k;(k=ie.frames[L]={}).offset_x=2*h(O,G),G+=3,k.offset_y=2*h(O,G),G+=3,k.width=1+h(O,G),G+=3,k.height=1+h(O,G),G+=3,k.duration=h(O,G),G+=3,ke=O[G++],k.dispose=1&ke,k.blend=ke>>1&1}se!="ANMF"&&(G+=fe)}return ie}}(A,0);x.response=A,x.rgbaoutput=!0,x.dataurl=!1;var S=x.header?x.header:null,j=x.frames?x.frames:null;if(S){S.loop_counter=S.loop_count,p=[S.canvas_height],f=[S.canvas_width];for(var M=0;M<j.length&&j[M].blend!=0;M++);}var B=j[0],Q=w.WebPDecodeRGBA(A,B.src_off,B.src_size,f,p);B.rgba=Q,B.imgwidth=f[0],B.imgheight=p[0];for(var q=0;q<f[0]*p[0]*4;q++)v[q]=Q[q];return this.width=f,this.height=p,this.data=v,this}(function(i){var e=function(){return typeof Xf=="function"},t=function(p,f,v,w){var A=4,x=a;switch(w){case i.image_compression.FAST:A=1,x=r;break;case i.image_compression.MEDIUM:A=6,x=o;break;case i.image_compression.SLOW:A=9,x=l}p=s(p,f,v,x);var S=Xf(p,{level:A});return i.__addimage__.arrayBufferToBinaryString(S)},s=function(p,f,v,w){for(var A,x,S,j=p.length/f,M=new Uint8Array(p.length+j),B=h(),Q=0;Q<j;Q+=1){if(S=Q*f,A=p.subarray(S,S+f),w)M.set(w(A,v,x),S+Q);else{for(var q,O=B.length,G=[];q<O;q+=1)G[q]=B[q](A,v,x);var ie=d(G.concat());M.set(G[ie],S+Q)}x=A}return M},n=function(p){var f=Array.apply([],p);return f.unshift(0),f},r=function(p,f){var v,w=[],A=p.length;w[0]=1;for(var x=0;x<A;x+=1)v=p[x-f]||0,w[x+1]=p[x]-v+256&255;return w},a=function(p,f,v){var w,A=[],x=p.length;A[0]=2;for(var S=0;S<x;S+=1)w=v&&v[S]||0,A[S+1]=p[S]-w+256&255;return A},o=function(p,f,v){var w,A,x=[],S=p.length;x[0]=3;for(var j=0;j<S;j+=1)w=p[j-f]||0,A=v&&v[j]||0,x[j+1]=p[j]+256-(w+A>>>1)&255;return x},l=function(p,f,v){var w,A,x,S,j=[],M=p.length;j[0]=4;for(var B=0;B<M;B+=1)w=p[B-f]||0,A=v&&v[B]||0,x=v&&v[B-f]||0,S=c(w,A,x),j[B+1]=p[B]-S+256&255;return j},c=function(p,f,v){if(p===f&&f===v)return p;var w=Math.abs(f-v),A=Math.abs(p-v),x=Math.abs(p+f-v-v);return w<=A&&w<=x?p:A<=x?f:v},h=function(){return[n,r,a,o,l]},d=function(p){var f=p.map(function(v){return v.reduce(function(w,A){return w+Math.abs(A)},0)});return f.indexOf(Math.min.apply(null,f))};i.processPNG=function(p,f,v,w){var A,x,S,j,M,B,Q,q,O,G,ie,L,R,W,U,he=this.decode.FLATE_DECODE,ae="";if(this.__addimage__.isArrayBuffer(p)&&(p=new Uint8Array(p)),this.__addimage__.isArrayBufferView(p)){if(p=(S=new L3(p)).imgData,x=S.bits,A=S.colorSpace,M=S.colors,[4,6].indexOf(S.colorType)!==-1){if(S.bits===8){O=(q=S.pixelBitlength==32?new Uint32Array(S.decodePixels().buffer):S.pixelBitlength==16?new Uint16Array(S.decodePixels().buffer):new Uint8Array(S.decodePixels().buffer)).length,ie=new Uint8Array(O*S.colors),G=new Uint8Array(O);var se,Z=S.pixelBitlength-S.bits;for(W=0,U=0;W<O;W++){for(R=q[W],se=0;se<Z;)ie[U++]=R>>>se&255,se+=S.bits;G[W]=R>>>se&255}}if(S.bits===16){O=(q=new Uint32Array(S.decodePixels().buffer)).length,ie=new Uint8Array(O*(32/S.pixelBitlength)*S.colors),G=new Uint8Array(O*(32/S.pixelBitlength)),L=S.colors>1,W=0,U=0;for(var fe=0;W<O;)R=q[W++],ie[U++]=R>>>0&255,L&&(ie[U++]=R>>>16&255,R=q[W++],ie[U++]=R>>>0&255),G[fe++]=R>>>16&255;x=8}w!==i.image_compression.NONE&&e()?(p=t(ie,S.width*S.colors,S.colors,w),Q=t(G,S.width,1,w)):(p=ie,Q=G,he=void 0)}if(S.colorType===3&&(A=this.color_spaces.INDEXED,B=S.palette,S.transparency.indexed)){var me=S.transparency.indexed,ke=0;for(W=0,O=me.length;W<O;++W)ke+=me[W];if((ke/=255)===O-1&&me.indexOf(0)!==-1)j=[me.indexOf(0)];else if(ke!==O){for(q=S.decodePixels(),G=new Uint8Array(q.length),W=0,O=q.length;W<O;W++)G[W]=me[q[W]];Q=t(G,S.width,1)}}var k=function(D){var z;switch(D){case i.image_compression.FAST:z=11;break;case i.image_compression.MEDIUM:z=13;break;case i.image_compression.SLOW:z=14;break;default:z=12}return z}(w);return he===this.decode.FLATE_DECODE&&(ae="/Predictor "+k+" "),ae+="/Colors "+M+" /BitsPerComponent "+x+" /Columns "+S.width,(this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),(Q&&this.__addimage__.isArrayBuffer(Q)||this.__addimage__.isArrayBufferView(Q))&&(Q=this.__addimage__.arrayBufferToBinaryString(Q)),{alias:v,data:p,index:f,filter:he,decodeParameters:ae,transparency:j,palette:B,sMask:Q,predictor:k,width:S.width,height:S.height,bitsPerComponent:x,colorSpace:A}}}})(Je.API),function(i){i.processGIF89A=function(e,t,s,n){var r=new T3(e),a=r.width,o=r.height,l=[];r.decodeAndBlitFrameRGBA(0,l);var c={data:l,width:a,height:o},h=new mf(100).encode(c,100);return i.processJPEG.call(this,h,t,s,n)},i.processGIF87A=i.processGIF89A}(Je.API),ri.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var i=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(i);for(var e=0;e<i;e++){var t=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:n,green:s,blue:t,quad:r}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},ri.prototype.parseBGR=function(){this.pos=this.offset;try{var i="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[i]()}catch(t){Gt.log("bit decode error:"+t)}},ri.prototype.bit1=function(){var i,e=Math.ceil(this.width/8),t=e%4;for(i=this.height-1;i>=0;i--){for(var s=this.bottom_up?i:this.height-1-i,n=0;n<e;n++)for(var r=this.datav.getUint8(this.pos++,!0),a=s*this.width*4+8*n*4,o=0;o<8&&8*n+o<this.width;o++){var l=this.palette[r>>7-o&1];this.data[a+4*o]=l.blue,this.data[a+4*o+1]=l.green,this.data[a+4*o+2]=l.red,this.data[a+4*o+3]=255}t!==0&&(this.pos+=4-t)}},ri.prototype.bit4=function(){for(var i=Math.ceil(this.width/2),e=i%4,t=this.height-1;t>=0;t--){for(var s=this.bottom_up?t:this.height-1-t,n=0;n<i;n++){var r=this.datav.getUint8(this.pos++,!0),a=s*this.width*4+2*n*4,o=r>>4,l=15&r,c=this.palette[o];if(this.data[a]=c.blue,this.data[a+1]=c.green,this.data[a+2]=c.red,this.data[a+3]=255,2*n+1>=this.width)break;c=this.palette[l],this.data[a+4]=c.blue,this.data[a+4+1]=c.green,this.data[a+4+2]=c.red,this.data[a+4+3]=255}e!==0&&(this.pos+=4-e)}},ri.prototype.bit8=function(){for(var i=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,s=0;s<this.width;s++){var n=this.datav.getUint8(this.pos++,!0),r=t*this.width*4+4*s;if(n<this.palette.length){var a=this.palette[n];this.data[r]=a.red,this.data[r+1]=a.green,this.data[r+2]=a.blue,this.data[r+3]=255}else this.data[r]=255,this.data[r+1]=255,this.data[r+2]=255,this.data[r+3]=255}i!==0&&(this.pos+=4-i)}},ri.prototype.bit15=function(){for(var i=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var s=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(r&e)/e*255|0,o=(r>>5&e)/e*255|0,l=(r>>10&e)/e*255|0,c=r>>15?255:0,h=s*this.width*4+4*n;this.data[h]=l,this.data[h+1]=o,this.data[h+2]=a,this.data[h+3]=c}this.pos+=i}},ri.prototype.bit16=function(){for(var i=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),s=this.height-1;s>=0;s--){for(var n=this.bottom_up?s:this.height-1-s,r=0;r<this.width;r++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&e)/e*255|0,l=(a>>5&t)/t*255|0,c=(a>>11)/e*255|0,h=n*this.width*4+4*r;this.data[h]=c,this.data[h+1]=l,this.data[h+2]=o,this.data[h+3]=255}this.pos+=i}},ri.prototype.bit24=function(){for(var i=this.height-1;i>=0;i--){for(var e=this.bottom_up?i:this.height-1-i,t=0;t<this.width;t++){var s=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*t;this.data[a]=r,this.data[a+1]=n,this.data[a+2]=s,this.data[a+3]=255}this.pos+=this.width%4}},ri.prototype.bit32=function(){for(var i=this.height-1;i>=0;i--)for(var e=this.bottom_up?i:this.height-1-i,t=0;t<this.width;t++){var s=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*t;this.data[o]=r,this.data[o+1]=n,this.data[o+2]=s,this.data[o+3]=a}},ri.prototype.getData=function(){return this.data},function(i){i.processBMP=function(e,t,s,n){var r=new ri(e,!1),a=r.width,o=r.height,l={data:r.getData(),width:a,height:o},c=new mf(100).encode(l,100);return i.processJPEG.call(this,c,t,s,n)}}(Je.API),s0.prototype.getData=function(){return this.data},function(i){i.processWEBP=function(e,t,s,n){var r=new s0(e),a=r.width,o=r.height,l={data:r.getData(),width:a,height:o},c=new mf(100).encode(l,100);return i.processJPEG.call(this,c,t,s,n)}}(Je.API),Je.API.processRGBA=function(i,e,t){for(var s=i.data,n=s.length,r=new Uint8Array(n/4*3),a=new Uint8Array(n/4),o=0,l=0,c=0;c<n;c+=4){var h=s[c],d=s[c+1],p=s[c+2],f=s[c+3];r[o++]=h,r[o++]=d,r[o++]=p,a[l++]=f}var v=this.__addimage__.arrayBufferToBinaryString(r);return{alpha:this.__addimage__.arrayBufferToBinaryString(a),data:v,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:i.width,height:i.height}},Je.API.setLanguage=function(i){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[i]!==void 0&&(this.internal.languageSettings.languageCode=i,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},go=Je.API,Vh=go.getCharWidthsArray=function(i,e){var t,s,n=(e=e||{}).font||this.internal.getFont(),r=e.fontSize||this.internal.getFontSize(),a=e.charSpace||this.internal.getCharSpace(),o=e.widths?e.widths:n.metadata.Unicode.widths,l=o.fof?o.fof:1,c=e.kerning?e.kerning:n.metadata.Unicode.kerning,h=c.fof?c.fof:1,d=e.doKerning!==!1,p=0,f=i.length,v=0,w=o[0]||l,A=[];for(t=0;t<f;t++)s=i.charCodeAt(t),typeof n.metadata.widthOfString=="function"?A.push((n.metadata.widthOfGlyph(n.metadata.characterToGlyph(s))+a*(1e3/r)||0)/1e3):(p=d&&Bt(c[s])==="object"&&!isNaN(parseInt(c[s][v],10))?c[s][v]/h:0,A.push((o[s]||w)/l+p)),v=s;return A},Zg=go.getStringUnitWidth=function(i,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),s=e.font||this.internal.getFont(),n=e.charSpace||this.internal.getCharSpace();return go.processArabic&&(i=go.processArabic(i)),typeof s.metadata.widthOfString=="function"?s.metadata.widthOfString(i,t,n)/t:Vh.apply(this,arguments).reduce(function(r,a){return r+a},0)},Qg=function(i,e,t,s){for(var n=[],r=0,a=i.length,o=0;r!==a&&o+e[r]<t;)o+=e[r],r++;n.push(i.slice(0,r));var l=r;for(o=0;r!==a;)o+e[r]>s&&(n.push(i.slice(l,r)),o=0,l=r),o+=e[r],r++;return l!==r&&n.push(i.slice(l,r)),n},e0=function(i,e,t){t||(t={});var s,n,r,a,o,l,c,h=[],d=[h],p=t.textIndent||0,f=0,v=0,w=i.split(" "),A=Vh.apply(this,[" ",t])[0];if(l=t.lineIndent===-1?w[0].length+2:t.lineIndent||0){var x=Array(l).join(" "),S=[];w.map(function(M){(M=M.split(/\s*\n/)).length>1?S=S.concat(M.map(function(B,Q){return(Q&&B.length?`
`:"")+B})):S.push(M[0])}),w=S,l=Zg.apply(this,[x,t])}for(r=0,a=w.length;r<a;r++){var j=0;if(s=w[r],l&&s[0]==`
`&&(s=s.substr(1),j=1),p+f+(v=(n=Vh.apply(this,[s,t])).reduce(function(M,B){return M+B},0))>e||j){if(v>e){for(o=Qg.apply(this,[s,n,e-(p+f),e]),h.push(o.shift()),h=[o.pop()];o.length;)d.push([o.shift()]);v=n.slice(s.length-(h[0]?h[0].length:0)).reduce(function(M,B){return M+B},0)}else h=[s];d.push(h),p=v+l,f=A}else h.push(s),p+=f+v,f=A}return c=l?function(M,B){return(B?x:"")+M.join(" ")}:function(M){return M.join(" ")},d.map(c)},go.splitTextToSize=function(i,e,t){var s,n=(t=t||{}).fontSize||this.internal.getFontSize(),r=function(h){if(h.widths&&h.kerning)return{widths:h.widths,kerning:h.kerning};var d=this.internal.getFont(h.fontName,h.fontStyle);return d.metadata.Unicode?{widths:d.metadata.Unicode.widths||{0:1},kerning:d.metadata.Unicode.kerning||{}}:{font:d.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,t);s=Array.isArray(i)?i:String(i).split(/\r?\n/);var a=1*this.internal.scaleFactor*e/n;r.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/n:0,r.lineIndent=t.lineIndent;var o,l,c=[];for(o=0,l=s.length;o<l;o++)c=c.concat(e0.apply(this,[s[o],a,r]));return c},function(i){i.__fontmetrics__=i.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",t={},s={},n=0;n<e.length;n++)t[e[n]]="0123456789abcdef"[n],s["0123456789abcdef"[n]]=e[n];var r=function(d){return"0x"+parseInt(d,10).toString(16)},a=i.__fontmetrics__.compress=function(d){var p,f,v,w,A=["{"];for(var x in d){if(p=d[x],isNaN(parseInt(x,10))?f="'"+x+"'":(x=parseInt(x,10),f=(f=r(x).slice(2)).slice(0,-1)+s[f.slice(-1)]),typeof p=="number")p<0?(v=r(p).slice(3),w="-"):(v=r(p).slice(2),w=""),v=w+v.slice(0,-1)+s[v.slice(-1)];else{if(Bt(p)!=="object")throw new Error("Don't know what to do with value type "+Bt(p)+".");v=a(p)}A.push(f+v)}return A.push("}"),A.join("")},o=i.__fontmetrics__.uncompress=function(d){if(typeof d!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,f,v,w,A={},x=1,S=A,j=[],M="",B="",Q=d.length-1,q=1;q<Q;q+=1)(w=d[q])=="'"?p?(v=p.join(""),p=void 0):p=[]:p?p.push(w):w=="{"?(j.push([S,v]),S={},v=void 0):w=="}"?((f=j.pop())[0][f[1]]=S,v=void 0,S=f[0]):w=="-"?x=-1:v===void 0?t.hasOwnProperty(w)?(M+=t[w],v=parseInt(M,16)*x,x=1,M=""):M+=w:t.hasOwnProperty(w)?(B+=t[w],S[v]=parseInt(B,16)*x,x=1,v=void 0,B=""):B+=w;return A},l={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},c={Unicode:{Courier:l,"Courier-Bold":l,"Courier-BoldOblique":l,"Courier-Oblique":l,Helvetica:l,"Helvetica-Bold":l,"Helvetica-BoldOblique":l,"Helvetica-Oblique":l,"Times-Roman":l,"Times-Bold":l,"Times-BoldItalic":l,"Times-Italic":l}},h={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};i.events.push(["addFont",function(d){var p=d.font,f=h.Unicode[p.postScriptName];f&&(p.metadata.Unicode={},p.metadata.Unicode.widths=f.widths,p.metadata.Unicode.kerning=f.kerning);var v=c.Unicode[p.postScriptName];v&&(p.metadata.Unicode.encoding=v,p.encoding=v.codePages[0])}])}(Je.API),function(i){var e=function(t){for(var s=t.length,n=new Uint8Array(s),r=0;r<s;r++)n[r]=t.charCodeAt(r);return n};i.API.events.push(["addFont",function(t){var s=void 0,n=t.font,r=t.instance;if(!n.isStandardFont){if(r===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");if(typeof(s=r.existsFileInVFS(n.postScriptName)===!1?r.loadFile(n.postScriptName):r.getFileFromVFS(n.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");(function(a,o){o=/^\x00\x01\x00\x00/.test(o)?e(o):e(nc(o)),a.metadata=i.API.TTFFont.open(o),a.metadata.Unicode=a.metadata.Unicode||{encoding:{},kerning:{},widths:[]},a.metadata.glyIdsUsed=[0]})(n,s)}}])}(Je),function(i){function e(){return(Ze.canvg?Promise.resolve(Ze.canvg):fr(()=>import("./index.es-DdjfvInn.js"),__vite__mapDeps([2,1,3]))).catch(function(t){return Promise.reject(new Error("Could not load canvg: "+t))}).then(function(t){return t.default?t.default:t})}Je.API.addSvgAsImage=function(t,s,n,r,a,o,l,c){if(isNaN(s)||isNaN(n))throw Gt.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(r)||isNaN(a))throw Gt.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var h=document.createElement("canvas");h.width=r,h.height=a;var d=h.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,h.width,h.height);var p={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return e().then(function(v){return v.fromString(d,t,p)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(v){return v.render(p)}).then(function(){f.addImage(h.toDataURL("image/jpeg",1),s,n,r,a,l,c)})}}(),Je.API.putTotalPages=function(i){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(i,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(i,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var s=1;s<=this.internal.getNumberOfPages();s++)for(var n=0;n<this.internal.pages[s].length;n++)this.internal.pages[s][n]=this.internal.pages[s][n].replace(e,t);return this},Je.API.viewerPreferences=function(i,e){var t;i=i||{},e=e||!1;var s,n,r,a={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(a),l=[],c=0,h=0,d=0;function p(v,w){var A,x=!1;for(A=0;A<v.length;A+=1)v[A]===w&&(x=!0);return x}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(a)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,i==="reset"||e===!0){var f=o.length;for(d=0;d<f;d+=1)t[o[d]].value=t[o[d]].defaultValue,t[o[d]].explicitSet=!1}if(Bt(i)==="object"){for(n in i)if(r=i[n],p(o,n)&&r!==void 0){if(t[n].type==="boolean"&&typeof r=="boolean")t[n].value=r;else if(t[n].type==="name"&&p(t[n].valueSet,r))t[n].value=r;else if(t[n].type==="integer"&&Number.isInteger(r))t[n].value=r;else if(t[n].type==="array"){for(c=0;c<r.length;c+=1)if(s=!0,r[c].length===1&&typeof r[c][0]=="number")l.push(String(r[c]-1));else if(r[c].length>1){for(h=0;h<r[c].length;h+=1)typeof r[c][h]!="number"&&(s=!1);s===!0&&l.push([r[c][0]-1,r[c][1]-1].join(" "))}t[n].value="["+l.join(" ")+"]"}else t[n].value=t[n].defaultValue;t[n].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var v,w=[];for(v in t)t[v].explicitSet===!0&&(t[v].type==="name"?w.push("/"+v+" /"+t[v].value):w.push("/"+v+" "+t[v].value));w.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+w.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},function(i){var e=function(){var s='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',n=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),r=unescape(encodeURIComponent(s)),a=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),c=r.length+a.length+o.length+n.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+c+" >>"),this.internal.write("stream"),this.internal.write(n+r+a+o+l),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};i.addMetadata=function(s,n){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:s,namespaceuri:n||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}}(Je.API),function(i){var e=i.API,t=e.pdfEscape16=function(r,a){for(var o,l=a.metadata.Unicode.widths,c=["","0","00","000","0000"],h=[""],d=0,p=r.length;d<p;++d){if(o=a.metadata.characterToGlyph(r.charCodeAt(d)),a.metadata.glyIdsUsed.push(o),a.metadata.toUnicode[o]=r.charCodeAt(d),l.indexOf(o)==-1&&(l.push(o),l.push([parseInt(a.metadata.widthOfGlyph(o),10)])),o=="0")return h.join("");o=o.toString(16),h.push(c[4-o.length],o)}return h.join("")},s=function(r){var a,o,l,c,h,d,p;for(h=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],d=0,p=(o=Object.keys(r).sort(function(f,v){return f-v})).length;d<p;d++)a=o[d],l.length>=100&&(h+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),r[a]!==void 0&&r[a]!==null&&typeof r[a].toString=="function"&&(c=("0000"+r[a].toString(16)).slice(-4),a=("0000"+(+a).toString(16)).slice(-4),l.push("<"+a+"><"+c+">"));return l.length&&(h+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),h+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(r){(function(a){var o=a.font,l=a.out,c=a.newObject,h=a.putStream;if(o.metadata instanceof i.API.TTFFont&&o.encoding==="Identity-H"){for(var d=o.metadata.Unicode.widths,p=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),f="",v=0;v<p.length;v++)f+=String.fromCharCode(p[v]);var w=c();h({data:f,addLength1:!0,objectId:w}),l("endobj");var A=c();h({data:s(o.metadata.toUnicode),addLength1:!0,objectId:A}),l("endobj");var x=c();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+xo(o.fontName)),l("/FontFile2 "+w+" 0 R"),l("/FontBBox "+i.API.PDFObject.convert(o.metadata.bbox)),l("/Flags "+o.metadata.flags),l("/StemV "+o.metadata.stemV),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l(">>"),l("endobj");var S=c();l("<<"),l("/Type /Font"),l("/BaseFont /"+xo(o.fontName)),l("/FontDescriptor "+x+" 0 R"),l("/W "+i.API.PDFObject.convert(d)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+o.encoding+")"),l(">>"),l(">>"),l("endobj"),o.objectNumber=c(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+A+" 0 R"),l("/BaseFont /"+xo(o.fontName)),l("/Encoding /"+o.encoding),l("/DescendantFonts ["+S+" 0 R]"),l(">>"),l("endobj"),o.isAlreadyPutted=!0}})(r)}]),e.events.push(["putFont",function(r){(function(a){var o=a.font,l=a.out,c=a.newObject,h=a.putStream;if(o.metadata instanceof i.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var d=o.metadata.rawData,p="",f=0;f<d.length;f++)p+=String.fromCharCode(d[f]);var v=c();h({data:p,addLength1:!0,objectId:v}),l("endobj");var w=c();h({data:s(o.metadata.toUnicode),addLength1:!0,objectId:w}),l("endobj");var A=c();l("<<"),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l("/StemV "+o.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+v+" 0 R"),l("/Flags 96"),l("/FontBBox "+i.API.PDFObject.convert(o.metadata.bbox)),l("/FontName /"+xo(o.fontName)),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l(">>"),l("endobj"),o.objectNumber=c();for(var x=0;x<o.metadata.hmtx.widths.length;x++)o.metadata.hmtx.widths[x]=parseInt(o.metadata.hmtx.widths[x]*(1e3/o.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+w+" 0 R/BaseFont/"+xo(o.fontName)+"/FontDescriptor "+A+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+i.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),l("endobj"),o.isAlreadyPutted=!0}})(r)}]);var n=function(r){var a,o=r.text||"",l=r.x,c=r.y,h=r.options||{},d=r.mutex||{},p=d.pdfEscape,f=d.activeFontKey,v=d.fonts,w=f,A="",x=0,S="",j=v[w].encoding;if(v[w].encoding!=="Identity-H")return{text:o,x:l,y:c,options:h,mutex:d};for(S=o,w=f,Array.isArray(o)&&(S=o[0]),x=0;x<S.length;x+=1)v[w].metadata.hasOwnProperty("cmap")&&(a=v[w].metadata.cmap.unicode.codeMap[S[x].charCodeAt(0)]),a||S[x].charCodeAt(0)<256&&v[w].metadata.hasOwnProperty("Unicode")?A+=S[x]:A+="";var M="";return parseInt(w.slice(1))<14||j==="WinAnsiEncoding"?M=p(A,w).split("").map(function(B){return B.charCodeAt(0).toString(16)}).join(""):j==="Identity-H"&&(M=t(A,v[w])),d.isHex=!0,{text:M,x:l,y:c,options:h,mutex:d}};e.events.push(["postProcessText",function(r){var a=r.text||"",o=[],l={text:a,x:r.x,y:r.y,options:r.options,mutex:r.mutex};if(Array.isArray(a)){var c=0;for(c=0;c<a.length;c+=1)Array.isArray(a[c])&&a[c].length===3?o.push([n(Object.assign({},l,{text:a[c][0]})).text,a[c][1],a[c][2]]):o.push(n(Object.assign({},l,{text:a[c]})).text);r.text=o}else r.text=n(Object.assign({},l,{text:a})).text}])}(Je),function(i){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};i.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},i.addFileToVFS=function(t,s){return e.call(this),this.internal.vFS[t]=s,this},i.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}}(Je.API),function(i){i.__bidiEngine__=i.prototype.__bidiEngine__=function(s){var n,r,a,o,l,c,h,d=e,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],f=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],v={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},w={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},A=["(",")","(","<",">","<","[","]","[","{","}","{","Â«","Â»","Â«","â€¹","â€º","â€¹","â…","â†","â…","â½","â¾","â½","â‚","â‚Ž","â‚","â‰¤","â‰¥","â‰¤","âŒ©","âŒª","âŒ©","ï¹™","ï¹š","ï¹™","ï¹›","ï¹œ","ï¹›","ï¹","ï¹ž","ï¹","ï¹¤","ï¹¥","ï¹¤"],x=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),S=!1,j=0;this.__bidiEngine__={};var M=function(L){var R=L.charCodeAt(),W=R>>8,U=w[W];return U!==void 0?d[256*U+(255&R)]:W===252||W===253?"AL":x.test(W)?"L":W===8?"R":"N"},B=function(L){for(var R,W=0;W<L.length;W++){if((R=M(L.charAt(W)))==="L")return!1;if(R==="R")return!0}return!1},Q=function(L,R,W,U){var he,ae,se,Z,fe=R[U];switch(fe){case"L":case"R":S=!1;break;case"N":case"AN":break;case"EN":S&&(fe="AN");break;case"AL":S=!0,fe="R";break;case"WS":fe="N";break;case"CS":U<1||U+1>=R.length||(he=W[U-1])!=="EN"&&he!=="AN"||(ae=R[U+1])!=="EN"&&ae!=="AN"?fe="N":S&&(ae="AN"),fe=ae===he?ae:"N";break;case"ES":fe=(he=U>0?W[U-1]:"B")==="EN"&&U+1<R.length&&R[U+1]==="EN"?"EN":"N";break;case"ET":if(U>0&&W[U-1]==="EN"){fe="EN";break}if(S){fe="N";break}for(se=U+1,Z=R.length;se<Z&&R[se]==="ET";)se++;fe=se<Z&&R[se]==="EN"?"EN":"N";break;case"NSM":if(a&&!o){for(Z=R.length,se=U+1;se<Z&&R[se]==="NSM";)se++;if(se<Z){var me=L[U],ke=me>=1425&&me<=2303||me===64286;if(he=R[se],ke&&(he==="R"||he==="AL")){fe="R";break}}}fe=U<1||(he=R[U-1])==="B"?"N":W[U-1];break;case"B":S=!1,n=!0,fe=j;break;case"S":r=!0,fe="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":S=!1;break;case"BN":fe="N"}return fe},q=function(L,R,W){var U=L.split("");return W&&O(U,W,{hiLevel:j}),U.reverse(),R&&R.reverse(),U.join("")},O=function(L,R,W){var U,he,ae,se,Z,fe=-1,me=L.length,ke=0,k=[],D=j?f:p,z=[];for(S=!1,n=!1,r=!1,he=0;he<me;he++)z[he]=M(L[he]);for(ae=0;ae<me;ae++){if(Z=ke,k[ae]=Q(L,z,k,ae),U=240&(ke=D[Z][v[k[ae]]]),ke&=15,R[ae]=se=D[ke][5],U>0)if(U===16){for(he=fe;he<ae;he++)R[he]=1;fe=-1}else fe=-1;if(D[ke][6])fe===-1&&(fe=ae);else if(fe>-1){for(he=fe;he<ae;he++)R[he]=se;fe=-1}z[ae]==="B"&&(R[ae]=0),W.hiLevel|=se}r&&function(X,ee,re){for(var ue=0;ue<re;ue++)if(X[ue]==="S"){ee[ue]=j;for(var de=ue-1;de>=0&&X[de]==="WS";de--)ee[de]=j}}(z,R,me)},G=function(L,R,W,U,he){if(!(he.hiLevel<L)){if(L===1&&j===1&&!n)return R.reverse(),void(W&&W.reverse());for(var ae,se,Z,fe,me=R.length,ke=0;ke<me;){if(U[ke]>=L){for(Z=ke+1;Z<me&&U[Z]>=L;)Z++;for(fe=ke,se=Z-1;fe<se;fe++,se--)ae=R[fe],R[fe]=R[se],R[se]=ae,W&&(ae=W[fe],W[fe]=W[se],W[se]=ae);ke=Z}ke++}}},ie=function(L,R,W){var U=L.split(""),he={hiLevel:j};return W||(W=[]),O(U,W,he),function(ae,se,Z){if(Z.hiLevel!==0&&h)for(var fe,me=0;me<ae.length;me++)se[me]===1&&(fe=A.indexOf(ae[me]))>=0&&(ae[me]=A[fe+1])}(U,W,he),G(2,U,R,W,he),G(1,U,R,W,he),U.join("")};return this.__bidiEngine__.doBidiReorder=function(L,R,W){if(function(he,ae){if(ae)for(var se=0;se<he.length;se++)ae[se]=se;o===void 0&&(o=B(he)),c===void 0&&(c=B(he))}(L,R),a||!l||c)if(a&&l&&o^c)j=o?1:0,L=q(L,R,W);else if(!a&&l&&c)j=o?1:0,L=ie(L,R,W),L=q(L,R);else if(!a||o||l||c){if(a&&!l&&o^c)L=q(L,R),o?(j=0,L=ie(L,R,W)):(j=1,L=ie(L,R,W),L=q(L,R));else if(a&&o&&!l&&c)j=1,L=ie(L,R,W),L=q(L,R);else if(!a&&!l&&o^c){var U=h;o?(j=1,L=ie(L,R,W),j=0,h=!1,L=ie(L,R,W),h=U):(j=0,L=ie(L,R,W),L=q(L,R),j=1,h=!1,L=ie(L,R,W),h=U,L=q(L,R))}}else j=0,L=ie(L,R,W);else j=o?1:0,L=ie(L,R,W);return L},this.__bidiEngine__.setOptions=function(L){L&&(a=L.isInputVisual,l=L.isOutputVisual,o=L.isInputRtl,c=L.isOutputRtl,h=L.isSymmetricSwapping)},this.__bidiEngine__.setOptions(s),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new i.__bidiEngine__({isInputVisual:!0});i.API.events.push(["postProcessText",function(s){var n=s.text,r=(s.x,s.y,s.options||{}),a=(s.mutex,r.lang,[]);if(r.isInputVisual=typeof r.isInputVisual!="boolean"||r.isInputVisual,t.setOptions(r),Object.prototype.toString.call(n)==="[object Array]"){var o=0;for(a=[],o=0;o<n.length;o+=1)Object.prototype.toString.call(n[o])==="[object Array]"?a.push([t.doBidiReorder(n[o][0]),n[o][1],n[o][2]]):a.push([t.doBidiReorder(n[o])]);s.text=a}else s.text=t.doBidiReorder(n);t.setOptions({isInputVisual:!0})}])}(Je),Je.API.TTFFont=function(){function i(e){var t;if(this.rawData=e,t=this.contents=new Hr(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new V3(this),this.registerTTF()}return i.open=function(e){return new i(e)},i.prototype.parse=function(){return this.directory=new j3(this.contents),this.head=new R3(this),this.name=new B3(this),this.cmap=new fb(this),this.toUnicode={},this.hhea=new O3(this),this.maxp=new $3(this),this.hmtx=new q3(this),this.post=new F3(this),this.os2=new M3(this),this.loca=new W3(this),this.glyf=new U3(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},i.prototype.registerTTF=function(){var e,t,s,n,r;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var a,o,l,c;for(c=[],a=0,o=(l=this.bbox).length;a<o;a++)e=l[a],c.push(Math.round(e*this.scaleFactor));return c}.call(this),this.stemV=0,this.post.exists?(s=255&(n=this.post.italic_angle),32768&(t=n>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+s)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(r=this.familyClass)===1||r===2||r===3||r===4||r===5||r===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},i.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},i.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},i.prototype.widthOfString=function(e,t,s){var n,r,a,o;for(a=0,r=0,o=(e=""+e).length;0<=o?r<o:r>o;r=0<=o?++r:--r)n=e.charCodeAt(r),a+=this.widthOfGlyph(this.characterToGlyph(n))+s*(1e3/t)||0;return a*(t/1e3)},i.prototype.lineHeight=function(e,t){var s;return t==null&&(t=!1),s=t?this.lineGap:0,(this.ascender+s-this.decender)/1e3*e},i}();var wi,Hr=function(){function i(e){this.data=e??[],this.pos=0,this.length=this.data.length}return i.prototype.readByte=function(){return this.data[this.pos++]},i.prototype.writeByte=function(e){return this.data[this.pos++]=e},i.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},i.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},i.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},i.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},i.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},i.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},i.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},i.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},i.prototype.readString=function(e){var t,s;for(s=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)s[t]=String.fromCharCode(this.readByte());return s.join("")},i.prototype.writeString=function(e){var t,s,n;for(n=[],t=0,s=e.length;0<=s?t<s:t>s;t=0<=s?++t:--t)n.push(this.writeByte(e.charCodeAt(t)));return n},i.prototype.readShort=function(){return this.readInt16()},i.prototype.writeShort=function(e){return this.writeInt16(e)},i.prototype.readLongLong=function(){var e,t,s,n,r,a,o,l;return e=this.readByte(),t=this.readByte(),s=this.readByte(),n=this.readByte(),r=this.readByte(),a=this.readByte(),o=this.readByte(),l=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^s)+4294967296*(255^n)+16777216*(255^r)+65536*(255^a)+256*(255^o)+(255^l)+1):72057594037927940*e+281474976710656*t+1099511627776*s+4294967296*n+16777216*r+65536*a+256*o+l},i.prototype.writeLongLong=function(e){var t,s;return t=Math.floor(e/4294967296),s=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(s>>24&255),this.writeByte(s>>16&255),this.writeByte(s>>8&255),this.writeByte(255&s)},i.prototype.readInt=function(){return this.readInt32()},i.prototype.writeInt=function(e){return this.writeInt32(e)},i.prototype.read=function(e){var t,s;for(t=[],s=0;0<=e?s<e:s>e;s=0<=e?++s:--s)t.push(this.readByte());return t},i.prototype.write=function(e){var t,s,n,r;for(r=[],s=0,n=e.length;s<n;s++)t=e[s],r.push(this.writeByte(t));return r},i}(),j3=function(){var i;function e(t){var s,n,r;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},n=0,r=this.tableCount;0<=r?n<r:n>r;n=0<=r?++n:--n)s={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[s.tag]=s}return e.prototype.encode=function(t){var s,n,r,a,o,l,c,h,d,p,f,v,w;for(w in f=Object.keys(t).length,l=Math.log(2),d=16*Math.floor(Math.log(f)/l),a=Math.floor(d/l),h=16*f-d,(n=new Hr).writeInt(this.scalarType),n.writeShort(f),n.writeShort(d),n.writeShort(a),n.writeShort(h),r=16*f,c=n.pos+r,o=null,v=[],t)for(p=t[w],n.writeString(w),n.writeInt(i(p)),n.writeInt(c),n.writeInt(p.length),v=v.concat(p),w==="head"&&(o=c),c+=p.length;c%4;)v.push(0),c++;return n.write(v),s=2981146554-i(n.data),n.pos=o+8,n.writeUInt32(s),n.data},i=function(t){var s,n,r,a;for(t=pb.call(t);t.length%4;)t.push(0);for(r=new Hr(t),n=0,s=0,a=t.length;s<a;s=s+=4)n+=r.readUInt32();return 4294967295&n},e}(),I3={}.hasOwnProperty,Vi=function(i,e){for(var t in e)I3.call(e,t)&&(i[t]=e[t]);function s(){this.constructor=i}return s.prototype=e.prototype,i.prototype=new s,i.__super__=e.prototype,i};wi=function(){function i(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return i.prototype.parse=function(){},i.prototype.encode=function(){},i.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},i}();var R3=function(i){function e(){return e.__super__.constructor.apply(this,arguments)}return Vi(e,wi),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var s;return(s=new Hr).writeInt(this.version),s.writeInt(this.revision),s.writeInt(this.checkSumAdjustment),s.writeInt(this.magicNumber),s.writeShort(this.flags),s.writeShort(this.unitsPerEm),s.writeLongLong(this.created),s.writeLongLong(this.modified),s.writeShort(this.xMin),s.writeShort(this.yMin),s.writeShort(this.xMax),s.writeShort(this.yMax),s.writeShort(this.macStyle),s.writeShort(this.lowestRecPPEM),s.writeShort(this.fontDirectionHint),s.writeShort(t),s.writeShort(this.glyphDataFormat),s.data},e}(),n0=function(){function i(e,t){var s,n,r,a,o,l,c,h,d,p,f,v,w,A,x,S,j;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),d=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=e.readByte();break;case 4:for(f=e.readUInt16(),p=f/2,e.pos+=6,r=function(){var M,B;for(B=[],l=M=0;0<=p?M<p:M>p;l=0<=p?++M:--M)B.push(e.readUInt16());return B}(),e.pos+=2,w=function(){var M,B;for(B=[],l=M=0;0<=p?M<p:M>p;l=0<=p?++M:--M)B.push(e.readUInt16());return B}(),c=function(){var M,B;for(B=[],l=M=0;0<=p?M<p:M>p;l=0<=p?++M:--M)B.push(e.readUInt16());return B}(),h=function(){var M,B;for(B=[],l=M=0;0<=p?M<p:M>p;l=0<=p?++M:--M)B.push(e.readUInt16());return B}(),n=(this.length-e.pos+this.offset)/2,o=function(){var M,B;for(B=[],l=M=0;0<=n?M<n:M>n;l=0<=n?++M:--M)B.push(e.readUInt16());return B}(),l=x=0,j=r.length;x<j;l=++x)for(A=r[l],s=S=v=w[l];v<=A?S<=A:S>=A;s=v<=A?++S:--S)h[l]===0?a=s+c[l]:(a=o[h[l]/2+(s-v)-(p-l)]||0)!==0&&(a+=c[l]),this.codeMap[s]=65535&a}e.pos=d}return i.encode=function(e,t){var s,n,r,a,o,l,c,h,d,p,f,v,w,A,x,S,j,M,B,Q,q,O,G,ie,L,R,W,U,he,ae,se,Z,fe,me,ke,k,D,z,X,ee,re,ue,de,Ee,Ne,Re;switch(U=new Hr,a=Object.keys(e).sort(function(Le,Ke){return Le-Ke}),t){case"macroman":for(w=0,A=function(){var Le=[];for(v=0;v<256;++v)Le.push(0);return Le}(),S={0:0},r={},he=0,fe=a.length;he<fe;he++)S[de=e[n=a[he]]]==null&&(S[de]=++w),r[n]={old:e[n],new:S[e[n]]},A[n]=S[e[n]];return U.writeUInt16(1),U.writeUInt16(0),U.writeUInt32(12),U.writeUInt16(0),U.writeUInt16(262),U.writeUInt16(0),U.write(A),{charMap:r,subtable:U.data,maxGlyphID:w+1};case"unicode":for(R=[],d=[],j=0,S={},s={},x=c=null,ae=0,me=a.length;ae<me;ae++)S[B=e[n=a[ae]]]==null&&(S[B]=++j),s[n]={old:B,new:S[B]},o=S[B]-n,x!=null&&o===c||(x&&d.push(x),R.push(n),c=o),x=n;for(x&&d.push(x),d.push(65535),R.push(65535),ie=2*(G=R.length),O=2*Math.pow(Math.log(G)/Math.LN2,2),p=Math.log(O/2)/Math.LN2,q=2*G-O,l=[],Q=[],f=[],v=se=0,ke=R.length;se<ke;v=++se){if(L=R[v],h=d[v],L===65535){l.push(0),Q.push(0);break}if(L-(W=s[L].new)>=32768)for(l.push(0),Q.push(2*(f.length+G-v)),n=Z=L;L<=h?Z<=h:Z>=h;n=L<=h?++Z:--Z)f.push(s[n].new);else l.push(W-L),Q.push(0)}for(U.writeUInt16(3),U.writeUInt16(1),U.writeUInt32(12),U.writeUInt16(4),U.writeUInt16(16+8*G+2*f.length),U.writeUInt16(0),U.writeUInt16(ie),U.writeUInt16(O),U.writeUInt16(p),U.writeUInt16(q),re=0,k=d.length;re<k;re++)n=d[re],U.writeUInt16(n);for(U.writeUInt16(0),ue=0,D=R.length;ue<D;ue++)n=R[ue],U.writeUInt16(n);for(Ee=0,z=l.length;Ee<z;Ee++)o=l[Ee],U.writeUInt16(o);for(Ne=0,X=Q.length;Ne<X;Ne++)M=Q[Ne],U.writeUInt16(M);for(Re=0,ee=f.length;Re<ee;Re++)w=f[Re],U.writeUInt16(w);return{charMap:s,subtable:U.data,maxGlyphID:j+1}}},i}(),fb=function(i){function e(){return e.__super__.constructor.apply(this,arguments)}return Vi(e,wi),e.prototype.tag="cmap",e.prototype.parse=function(t){var s,n,r;for(t.pos=this.offset,this.version=t.readUInt16(),r=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=r?n<r:n>r;n=0<=r?++n:--n)s=new n0(t,this.offset),this.tables.push(s),s.isUnicode&&this.unicode==null&&(this.unicode=s);return!0},e.encode=function(t,s){var n,r;return s==null&&(s="macroman"),n=n0.encode(t,s),(r=new Hr).writeUInt16(0),r.writeUInt16(1),n.table=r.data.concat(n.subtable),n},e}(),O3=function(i){function e(){return e.__super__.constructor.apply(this,arguments)}return Vi(e,wi),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),M3=function(i){function e(){return e.__super__.constructor.apply(this,arguments)}return Vi(e,wi),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var s,n;for(n=[],s=0;s<10;++s)n.push(t.readByte());return n}(),this.charRange=function(){var s,n;for(n=[],s=0;s<4;++s)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var s,n;for(n=[],s=0;s<2;s=++s)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),F3=function(i){function e(){return e.__super__.constructor.apply(this,arguments)}return Vi(e,wi),e.prototype.tag="post",e.prototype.parse=function(t){var s,n,r;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:break;case 131072:var a;for(n=t.readUInt16(),this.glyphNameIndex=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],r=[];t.pos<this.offset+this.length;)s=t.readByte(),r.push(this.names.push(t.readString(s)));return r;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 196608:break;case 262144:return this.map=function(){var o,l,c;for(c=[],a=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;a=0<=l?++o:--o)c.push(t.readUInt32());return c}.call(this)}},e}(),D3=function(i,e){this.raw=i,this.length=i.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},B3=function(i){function e(){return e.__super__.constructor.apply(this,arguments)}return Vi(e,wi),e.prototype.tag="name",e.prototype.parse=function(t){var s,n,r,a,o,l,c,h,d,p,f;for(t.pos=this.offset,t.readShort(),s=t.readShort(),l=t.readShort(),n=[],a=0;0<=s?a<s:a>s;a=0<=s?++a:--a)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+l+t.readShort()});for(c={},a=d=0,p=n.length;d<p;a=++d)r=n[a],t.pos=r.offset,h=t.readString(r.length),o=new D3(h,r),c[f=r.nameID]==null&&(c[f]=[]),c[r.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},e}(),$3=function(i){function e(){return e.__super__.constructor.apply(this,arguments)}return Vi(e,wi),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),q3=function(i){function e(){return e.__super__.constructor.apply(this,arguments)}return Vi(e,wi),e.prototype.tag="hmtx",e.prototype.parse=function(t){var s,n,r,a,o,l,c;for(t.pos=this.offset,this.metrics=[],s=0,l=this.file.hhea.numberOfMetrics;0<=l?s<l:s>l;s=0<=l?++s:--s)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(r=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var h,d;for(d=[],s=h=0;0<=r?h<r:h>r;s=0<=r?++h:--h)d.push(t.readInt16());return d}(),this.widths=function(){var h,d,p,f;for(f=[],h=0,d=(p=this.metrics).length;h<d;h++)a=p[h],f.push(a.advance);return f}.call(this),n=this.widths[this.widths.length-1],c=[],s=o=0;0<=r?o<r:o>r;s=0<=r?++o:--o)c.push(this.widths.push(n));return c},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),pb=[].slice,U3=function(i){function e(){return e.__super__.constructor.apply(this,arguments)}return Vi(e,wi),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var s,n,r,a,o,l,c,h,d,p;return t in this.cache?this.cache[t]:(a=this.file.loca,s=this.file.contents,n=a.indexOf(t),(r=a.lengthOf(t))===0?this.cache[t]=null:(s.pos=this.offset+n,o=(l=new Hr(s.read(r))).readShort(),h=l.readShort(),p=l.readShort(),c=l.readShort(),d=l.readShort(),this.cache[t]=o===-1?new H3(l,h,p,c,d):new z3(l,o,h,p,c,d),this.cache[t]))},e.prototype.encode=function(t,s,n){var r,a,o,l,c;for(o=[],a=[],l=0,c=s.length;l<c;l++)r=t[s[l]],a.push(o.length),r&&(o=o.concat(r.encode(n)));return a.push(o.length),{table:o,offsets:a}},e}(),z3=function(){function i(e,t,s,n,r,a){this.raw=e,this.numberOfContours=t,this.xMin=s,this.yMin=n,this.xMax=r,this.yMax=a,this.compound=!1}return i.prototype.encode=function(){return this.raw.data},i}(),H3=function(){function i(e,t,s,n,r){var a,o;for(this.raw=e,this.xMin=t,this.yMin=s,this.xMax=n,this.yMax=r,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],a=this.raw;o=a.readShort(),this.glyphOffsets.push(a.pos),this.glyphIDs.push(a.readUInt16()),32&o;)a.pos+=1&o?4:2,128&o?a.pos+=8:64&o?a.pos+=4:8&o&&(a.pos+=2)}return i.prototype.encode=function(){var e,t,s;for(t=new Hr(pb.call(this.raw.data)),e=0,s=this.glyphIDs.length;e<s;++e)t.pos=this.glyphOffsets[e];return t.data},i}(),W3=function(i){function e(){return e.__super__.constructor.apply(this,arguments)}return Vi(e,wi),e.prototype.tag="loca",e.prototype.parse=function(t){var s,n;return t.pos=this.offset,s=this.file.head.indexToLocFormat,this.offsets=s===0?function(){var r,a;for(a=[],n=0,r=this.length;n<r;n+=2)a.push(2*t.readUInt16());return a}.call(this):function(){var r,a;for(a=[],n=0,r=this.length;n<r;n+=4)a.push(t.readUInt32());return a}.call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,s){for(var n=new Uint32Array(this.offsets.length),r=0,a=0,o=0;o<n.length;++o)if(n[o]=r,a<s.length&&s[a]==o){++a,n[o]=r;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(r+=c)}for(var h=new Array(4*n.length),d=0;d<n.length;++d)h[4*d+3]=255&n[d],h[4*d+2]=(65280&n[d])>>8,h[4*d+1]=(16711680&n[d])>>16,h[4*d]=(4278190080&n[d])>>24;return h},e}(),V3=function(){function i(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return i.prototype.generateCmap=function(){var e,t,s,n,r;for(t in n=this.font.cmap.tables[0].codeMap,e={},r=this.subset)s=r[t],e[t]=n[s];return e},i.prototype.glyphsFor=function(e){var t,s,n,r,a,o,l;for(n={},a=0,o=e.length;a<o;a++)n[r=e[a]]=this.font.glyf.glyphFor(r);for(r in t=[],n)(s=n[r])!=null&&s.compound&&t.push.apply(t,s.glyphIDs);if(t.length>0)for(r in l=this.glyphsFor(t))s=l[r],n[r]=s;return n},i.prototype.encode=function(e,t){var s,n,r,a,o,l,c,h,d,p,f,v,w,A,x;for(n in s=fb.encode(this.generateCmap(),"unicode"),a=this.glyphsFor(e),f={0:0},x=s.charMap)f[(l=x[n]).old]=l.new;for(v in p=s.maxGlyphID,a)v in f||(f[v]=p++);return h=function(S){var j,M;for(j in M={},S)M[S[j]]=j;return M}(f),d=Object.keys(h).sort(function(S,j){return S-j}),w=function(){var S,j,M;for(M=[],S=0,j=d.length;S<j;S++)o=d[S],M.push(h[o]);return M}(),r=this.font.glyf.encode(a,w,f),c=this.font.loca.encode(r.offsets,w),A={cmap:this.font.cmap.raw(),glyf:r.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(A["OS/2"]=this.font.os2.raw()),this.font.directory.encode(A)},i}();Je.API.PDFObject=function(){var i;function e(){}return i=function(t,s){return(Array(s+1).join("0")+t).slice(-s)},e.convert=function(t){var s,n,r,a;if(Array.isArray(t))return"["+function(){var o,l,c;for(c=[],o=0,l=t.length;o<l;o++)s=t[o],c.push(e.convert(s));return c}().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t?.isString)return"("+t+")";if(t instanceof Date)return"(D:"+i(t.getUTCFullYear(),4)+i(t.getUTCMonth(),2)+i(t.getUTCDate(),2)+i(t.getUTCHours(),2)+i(t.getUTCMinutes(),2)+i(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(n in r=["<<"],t)a=t[n],r.push("/"+n+" "+e.convert(a));return r.push(">>"),r.join(`
`)}return""+t},e}();async function G3(i){const{data:e}=await ut.from("candidates").select("name").eq("id",i.candidate_id).single(),{data:t}=await ut.from("jobs").select("title").eq("id",i.job_id).single(),s=new Je,n=s.internal.pageSize.getWidth(),r=s.internal.pageSize.getHeight();let a=30;const o=25,l=8;let c=1;const h={title:24,subTitle:18,heading:16,subHeading:14,normal:12,small:10},d=(q,O=!1)=>{s.setFontSize(q),s.setTextColor(0,0,0),s.setFont("helvetica",O?"bold":"normal")},p=(q,O,G=n-2*o)=>{const ie=s.splitTextToSize(q,G);let L=O;for(let R=0;R<ie.length;R++)L>r-40&&(v(c),s.addPage(),c++,f(),d(h.normal),L=30),s.text(ie[R],o,L),L+=l;return L},f=()=>{s.setTextColor(220,220,220),s.setFontSize(50),s.text("TopMatchTalent.com",n/2,r/2,{align:"center",angle:45}),d(h.normal)},v=q=>{s.setFontSize(h.small),s.setTextColor(128,128,128),s.text(`Page ${q}`,n/2,r-15,{align:"center"}),d(h.normal)},w=q=>{if(typeof q=="string"){const O=q.replace(/^RISK_FACTORS:\s*/i,"").trim();try{const U=JSON.parse(O);if(U&&typeof U=="object")return{severity:(U.severity||"MEDIUM").toUpperCase(),description:U.description||"",mitigation:U.mitigation||void 0}}catch{}const G=/^-\s*Severity:\s*\[?(HIGH|MEDIUM|LOW)\]?\s*\n\s*\*\s*Description:\s*\[?([^\n\]]+)\]?\s*\n\s*\*\s*Mitigation:\s*\[?([^\n\]]+)\]?/im,ie=O.match(G);if(ie){const[,U,he,ae]=ie;return{severity:U.toUpperCase(),description:he.trim(),mitigation:ae?.trim()}}const L=O.match(/Severity:\s*\[?(HIGH|MEDIUM|LOW)\]?/i),R=O.match(/Description:\s*\[?([^\n\]]+)\]?/i),W=O.match(/Mitigation:\s*\[?([^\n\]]+)\]?/i);return L||R?{severity:L?.[1]?.toUpperCase()||"MEDIUM",description:R?.[1]?.trim()||O,mitigation:W?.[1]?.trim()}:{severity:"MEDIUM",description:O}}return q};f(),d(h.title,!0),s.text("Analysis Report",o,a),a+=20,d(h.subTitle,!0);const A=e?.name||`Candidate ID: ${i.candidate_id}`;s.text(`Candidate: ${A}`,o,a),a+=10;const x=t?.title||`Job ID: ${i.job_id}`;if(s.text(`Position: ${x}`,o,a),a+=20,d(h.normal),s.text("Date: "+new Date(i.created_at??"").toLocaleDateString(),o,a),a+=25,d(h.subHeading,!0),s.text("Fit Score:",o,a),d(h.subTitle),s.text(i.fit_score+"/10",o+70,a),a+=15,d(h.subHeading,!0),s.text("Verdict:",o,a),d(h.subTitle),s.text(i.verdict.replace(/_/g," "),o+70,a),a+=25,d(h.heading,!0),s.text("Key Findings",o,a),a+=10,d(h.normal),i.reasoning.forEach(q=>{a=p("â€¢ "+q,a),a+=5}),a+=15,d(h.heading,!0),s.text("Risk Factors",o,a),a+=10,d(h.normal),!i.risk_factors||i.risk_factors.length===0)a=p("No significant risk factors identified.",a);else{const q=i.risk_factors.map(O=>w(O)).filter(O=>O!==null);q.length===0?a=p("No significant risk factors identified.",a):q.forEach(O=>{d(h.normal,!0),a=p(`â€¢ ${O.severity}:`,a),d(h.normal),a=p(O.description,a),O.mitigation&&(a=p(`  Mitigation: ${O.mitigation}`,a)),a+=5})}a+=15,d(h.heading,!0),s.text("Interview Plan",o,a),a+=10,d(h.normal),a=p(i.interview_plan,a),v(c),s.setFontSize(h.small),s.setTextColor(100,100,100),s.text("Generated by TopMatchTalent.com",n/2,r-25,{align:"center"});const j=new Date().toISOString().split("T")[0],M=e?.name?.replace(/[^a-z0-9]/gi,"_").toLowerCase()||"unnamed",B=t?.title?.replace(/[^a-z0-9]/gi,"_").toLowerCase()||"no_position",Q=`analysis_report_${M}_x_${B}_${j}.pdf`;s.save(Q)}function mb({analysis:i}){const[e,t]=V.useState(!1),s=async()=>{try{t(!0),await G3(i)}catch(n){console.error("Failed to export PDF:",n)}finally{t(!1)}};return g.jsxs("button",{onClick:s,disabled:e,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[g.jsx(Dy,{className:`h-5 w-5 mr-2 ${e?"animate-bounce":"text-gray-500"}`}),e?"Exporting...":"Export PDF"]})}function X3({verdict:i,reasoning:e}){const s={STRONG_FIT:{border:"border-green-200",bg:"bg-green-50",icon:tv,iconColor:"text-green-600",title:"Strong Fit",titleColor:"text-green-800",textColor:"text-green-700",dotColor:"bg-green-600"},POTENTIAL_FIT:{border:"border-yellow-200",bg:"bg-yellow-50",icon:Km,iconColor:"text-yellow-600",title:"Potential Fit",titleColor:"text-yellow-800",textColor:"text-yellow-700",dotColor:"bg-yellow-600"},NEEDS_CONSIDERATION:{border:"border-yellow-200",bg:"bg-yellow-50",icon:Km,iconColor:"text-yellow-600",title:"Needs Consideration",titleColor:"text-yellow-800",textColor:"text-yellow-700",dotColor:"bg-yellow-600"},NOT_RECOMMENDED:{border:"border-red-200",bg:"bg-red-50",icon:jv,iconColor:"text-red-600",title:"Not Recommended",titleColor:"text-red-800",textColor:"text-red-700",dotColor:"bg-red-600"}}[i],n=s.icon;return g.jsxs("div",{className:`p-6 rounded-lg border ${s.border} ${s.bg}`,children:[g.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[g.jsx(n,{className:`h-6 w-6 ${s.iconColor}`}),g.jsx("h3",{className:`font-semibold ${s.titleColor}`,children:s.title})]}),g.jsx("div",{className:"space-y-2",children:e.map((r,a)=>g.jsxs("div",{className:"flex items-start space-x-2",children:[g.jsx("span",{className:`mt-1.5 h-1.5 w-1.5 rounded-full ${s.dotColor}`}),g.jsx("p",{className:`text-sm ${s.textColor}`,children:r})]},a))})]})}function Dl({title:i,children:e,defaultExpanded:t=!1}){const[s,n]=V.useState(t),[r,a]=V.useState(!1);return g.jsxs("div",{className:`bg-white rounded-xl border border-gray-200 shadow-sm 
        ${s?"ring-2 ring-blue-100":""} 
        ${r?"border-blue-200":""}
        transition-all duration-200 ease-in-out hover:shadow-md`,onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),children:[g.jsxs("button",{onClick:()=>n(!s),className:"w-full flex justify-between items-center text-left p-6",children:[g.jsxs("div",{className:"flex items-center space-x-3",children:[s?g.jsx(Tu,{className:`h-5 w-5 ${r?"text-blue-500":"text-gray-400"} transition-colors`}):g.jsx(Vo,{className:`h-5 w-5 ${r?"text-blue-500":"text-gray-400"} transition-colors`}),g.jsx("h3",{className:`text-lg font-semibold ${r?"text-blue-600":"text-gray-900"} transition-colors`,children:i})]}),g.jsx("div",{className:`text-xs font-medium px-2 py-1 rounded-full 
          ${s?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-600"} 
          transition-colors`,children:s?"Hide":"Show"})]}),g.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out
          ${s?"max-h-[2000px] opacity-100":"max-h-0 opacity-0"}`,children:g.jsx("div",{className:`px-6 pb-6 border-t border-gray-100 
          ${s?"pt-4":""}`,children:e})})]})}function gb({analysis:i}){return g.jsxs("div",{className:"space-y-6",children:[g.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50 rounded-xl p-6 shadow-sm",children:[g.jsx(BS,{score:i.fit_score,verdict:i.verdict}),g.jsx("div",{className:"mt-6",children:g.jsx(X3,{verdict:i.verdict,reasoning:i.reasoning})})]}),g.jsxs("div",{className:"space-y-4",children:[g.jsx(Dl,{title:"Candidate X Position",defaultExpanded:!1,children:g.jsx(HS,{analysis:i})}),g.jsx(Dl,{title:"Technical Analysis",defaultExpanded:!1,children:g.jsx($S,{analysis:i})}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[g.jsx(Dl,{title:"Risk Factors",defaultExpanded:!1,children:g.jsx(qS,{factors:i.risk_factors})}),g.jsx(Dl,{title:"Growth Potential",defaultExpanded:!1,children:g.jsx(US,{potential:i.growth_potential})})]}),g.jsx(Dl,{title:"Interview Plan",defaultExpanded:!1,children:g.jsx(zS,{plan:i.interview_plan})})]}),g.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50 rounded-xl p-6 shadow-sm",children:[g.jsx(YS,{analysis:i}),g.jsx("div",{className:"mt-6",children:g.jsx(mb,{analysis:i})})]})]})}var Ct;(function(i){i.assertEqual=n=>n;function e(n){}i.assertIs=e;function t(n){throw new Error}i.assertNever=t,i.arrayToEnum=n=>{const r={};for(const a of n)r[a]=a;return r},i.getValidEnumValues=n=>{const r=i.objectKeys(n).filter(o=>typeof n[n[o]]!="number"),a={};for(const o of r)a[o]=n[o];return i.objectValues(a)},i.objectValues=n=>i.objectKeys(n).map(function(r){return n[r]}),i.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{const r=[];for(const a in n)Object.prototype.hasOwnProperty.call(n,a)&&r.push(a);return r},i.find=(n,r)=>{for(const a of n)if(r(a))return a},i.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function s(n,r=" | "){return n.map(a=>typeof a=="string"?`'${a}'`:a).join(r)}i.joinValues=s,i.jsonStringifyReplacer=(n,r)=>typeof r=="bigint"?r.toString():r})(Ct||(Ct={}));var tp;(function(i){i.mergeShapes=(e,t)=>({...e,...t})})(tp||(tp={}));const Be=Ct.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),dr=i=>{switch(typeof i){case"undefined":return Be.undefined;case"string":return Be.string;case"number":return isNaN(i)?Be.nan:Be.number;case"boolean":return Be.boolean;case"function":return Be.function;case"bigint":return Be.bigint;case"symbol":return Be.symbol;case"object":return Array.isArray(i)?Be.array:i===null?Be.null:i.then&&typeof i.then=="function"&&i.catch&&typeof i.catch=="function"?Be.promise:typeof Map<"u"&&i instanceof Map?Be.map:typeof Set<"u"&&i instanceof Set?Be.set:typeof Date<"u"&&i instanceof Date?Be.date:Be.object;default:return Be.unknown}},Ae=Ct.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Y3=i=>JSON.stringify(i,null,2).replace(/"([^"]+)":/g,"$1:");class Rn extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(r){return r.message},s={_errors:[]},n=r=>{for(const a of r.issues)if(a.code==="invalid_union")a.unionErrors.map(n);else if(a.code==="invalid_return_type")n(a.returnTypeError);else if(a.code==="invalid_arguments")n(a.argumentsError);else if(a.path.length===0)s._errors.push(t(a));else{let o=s,l=0;for(;l<a.path.length;){const c=a.path[l];l===a.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(t(a))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return n(this),s}static assert(e){if(!(e instanceof Rn))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ct.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},s=[];for(const n of this.issues)n.path.length>0?(t[n.path[0]]=t[n.path[0]]||[],t[n.path[0]].push(e(n))):s.push(e(n));return{formErrors:s,fieldErrors:t}}get formErrors(){return this.flatten()}}Rn.create=i=>new Rn(i);const Uo=(i,e)=>{let t;switch(i.code){case Ae.invalid_type:i.received===Be.undefined?t="Required":t=`Expected ${i.expected}, received ${i.received}`;break;case Ae.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(i.expected,Ct.jsonStringifyReplacer)}`;break;case Ae.unrecognized_keys:t=`Unrecognized key(s) in object: ${Ct.joinValues(i.keys,", ")}`;break;case Ae.invalid_union:t="Invalid input";break;case Ae.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${Ct.joinValues(i.options)}`;break;case Ae.invalid_enum_value:t=`Invalid enum value. Expected ${Ct.joinValues(i.options)}, received '${i.received}'`;break;case Ae.invalid_arguments:t="Invalid function arguments";break;case Ae.invalid_return_type:t="Invalid function return type";break;case Ae.invalid_date:t="Invalid date";break;case Ae.invalid_string:typeof i.validation=="object"?"includes"in i.validation?(t=`Invalid input: must include "${i.validation.includes}"`,typeof i.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${i.validation.position}`)):"startsWith"in i.validation?t=`Invalid input: must start with "${i.validation.startsWith}"`:"endsWith"in i.validation?t=`Invalid input: must end with "${i.validation.endsWith}"`:Ct.assertNever(i.validation):i.validation!=="regex"?t=`Invalid ${i.validation}`:t="Invalid";break;case Ae.too_small:i.type==="array"?t=`Array must contain ${i.exact?"exactly":i.inclusive?"at least":"more than"} ${i.minimum} element(s)`:i.type==="string"?t=`String must contain ${i.exact?"exactly":i.inclusive?"at least":"over"} ${i.minimum} character(s)`:i.type==="number"?t=`Number must be ${i.exact?"exactly equal to ":i.inclusive?"greater than or equal to ":"greater than "}${i.minimum}`:i.type==="date"?t=`Date must be ${i.exact?"exactly equal to ":i.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(i.minimum))}`:t="Invalid input";break;case Ae.too_big:i.type==="array"?t=`Array must contain ${i.exact?"exactly":i.inclusive?"at most":"less than"} ${i.maximum} element(s)`:i.type==="string"?t=`String must contain ${i.exact?"exactly":i.inclusive?"at most":"under"} ${i.maximum} character(s)`:i.type==="number"?t=`Number must be ${i.exact?"exactly":i.inclusive?"less than or equal to":"less than"} ${i.maximum}`:i.type==="bigint"?t=`BigInt must be ${i.exact?"exactly":i.inclusive?"less than or equal to":"less than"} ${i.maximum}`:i.type==="date"?t=`Date must be ${i.exact?"exactly":i.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(i.maximum))}`:t="Invalid input";break;case Ae.custom:t="Invalid input";break;case Ae.invalid_intersection_types:t="Intersection results could not be merged";break;case Ae.not_multiple_of:t=`Number must be a multiple of ${i.multipleOf}`;break;case Ae.not_finite:t="Number must be finite";break;default:t=e.defaultError,Ct.assertNever(i)}return{message:t}};let bb=Uo;function K3(i){bb=i}function vu(){return bb}const wu=i=>{const{data:e,path:t,errorMaps:s,issueData:n}=i,r=[...t,...n.path||[]],a={...n,path:r};if(n.message!==void 0)return{...n,path:r,message:n.message};let o="";const l=s.filter(c=>!!c).slice().reverse();for(const c of l)o=c(a,{data:e,defaultError:o}).message;return{...n,path:r,message:o}},J3=[];function Ie(i,e){const t=vu(),s=wu({issueData:e,data:i.data,path:i.path,errorMaps:[i.common.contextualErrorMap,i.schemaErrorMap,t,t===Uo?void 0:Uo].filter(n=>!!n)});i.common.issues.push(s)}class en{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const s=[];for(const n of t){if(n.status==="aborted")return et;n.status==="dirty"&&e.dirty(),s.push(n.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,t){const s=[];for(const n of t){const r=await n.key,a=await n.value;s.push({key:r,value:a})}return en.mergeObjectSync(e,s)}static mergeObjectSync(e,t){const s={};for(const n of t){const{key:r,value:a}=n;if(r.status==="aborted"||a.status==="aborted")return et;r.status==="dirty"&&e.dirty(),a.status==="dirty"&&e.dirty(),r.value!=="__proto__"&&(typeof a.value<"u"||n.alwaysSet)&&(s[r.value]=a.value)}return{status:e.value,value:s}}}const et=Object.freeze({status:"aborted"}),ko=i=>({status:"dirty",value:i}),cn=i=>({status:"valid",value:i}),sp=i=>i.status==="aborted",np=i=>i.status==="dirty",Na=i=>i.status==="valid",pc=i=>typeof Promise<"u"&&i instanceof Promise;function xu(i,e,t,s){if(typeof e=="function"?i!==e||!s:!e.has(i))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(i)}function yb(i,e,t,s,n){if(typeof e=="function"?i!==e||!n:!e.has(i))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(i,t),t}var ze;(function(i){i.errToObj=e=>typeof e=="string"?{message:e}:e||{},i.toString=e=>typeof e=="string"?e:e?.message})(ze||(ze={}));var Hl,Wl;class Hi{constructor(e,t,s,n){this._cachedPath=[],this.parent=e,this.data=t,this._path=s,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const i0=(i,e)=>{if(Na(e))return{success:!0,data:e.value};if(!i.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new Rn(i.common.issues);return this._error=t,this._error}}};function dt(i){if(!i)return{};const{errorMap:e,invalid_type_error:t,required_error:s,description:n}=i;if(e&&(t||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:(a,o)=>{var l,c;const{message:h}=i;return a.code==="invalid_enum_value"?{message:h??o.defaultError}:typeof o.data>"u"?{message:(l=h??s)!==null&&l!==void 0?l:o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:(c=h??t)!==null&&c!==void 0?c:o.defaultError}},description:n}}class gt{get description(){return this._def.description}_getType(e){return dr(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:dr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new en,ctx:{common:e.parent.common,data:e.data,parsedType:dr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(pc(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const s=this.safeParse(e,t);if(s.success)return s.data;throw s.error}safeParse(e,t){var s;const n={common:{issues:[],async:(s=t?.async)!==null&&s!==void 0?s:!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:dr(e)},r=this._parseSync({data:e,path:n.path,parent:n});return i0(n,r)}"~validate"(e){var t,s;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:dr(e)};if(!this["~standard"].async)try{const r=this._parseSync({data:e,path:[],parent:n});return Na(r)?{value:r.value}:{issues:n.common.issues}}catch(r){!((s=(t=r?.message)===null||t===void 0?void 0:t.toLowerCase())===null||s===void 0)&&s.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(r=>Na(r)?{value:r.value}:{issues:n.common.issues})}async parseAsync(e,t){const s=await this.safeParseAsync(e,t);if(s.success)return s.data;throw s.error}async safeParseAsync(e,t){const s={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:dr(e)},n=this._parse({data:e,path:s.path,parent:s}),r=await(pc(n)?n:Promise.resolve(n));return i0(s,r)}refine(e,t){const s=n=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(n):t;return this._refinement((n,r)=>{const a=e(n),o=()=>r.addIssue({code:Ae.custom,...s(n)});return typeof Promise<"u"&&a instanceof Promise?a.then(l=>l?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(e,t){return this._refinement((s,n)=>e(s)?!0:(n.addIssue(typeof t=="function"?t(s,n):t),!1))}_refinement(e){return new yi({schema:this,typeName:Qe.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return zi.create(this,this._def)}nullable(){return Xr.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return gi.create(this)}promise(){return Ho.create(this,this._def)}or(e){return yc.create([this,e],this._def)}and(e){return vc.create(this,e,this._def)}transform(e){return new yi({...dt(this._def),schema:this,typeName:Qe.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new Sc({...dt(this._def),innerType:this,defaultValue:t,typeName:Qe.ZodDefault})}brand(){return new Yp({typeName:Qe.ZodBranded,type:this,...dt(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new Nc({...dt(this._def),innerType:this,catchValue:t,typeName:Qe.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return Fc.create(this,e)}readonly(){return Ec.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Z3=/^c[^\s-]{8,}$/i,Q3=/^[0-9a-z]+$/,e4=/^[0-9A-HJKMNP-TV-Z]{26}$/i,t4=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,s4=/^[a-z0-9_-]{21}$/i,n4=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,i4=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,r4=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,a4="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let gf;const o4=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,l4=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,c4=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,h4=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,u4=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,d4=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,vb="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",f4=new RegExp(`^${vb}$`);function wb(i){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return i.precision?e=`${e}\\.\\d{${i.precision}}`:i.precision==null&&(e=`${e}(\\.\\d+)?`),e}function p4(i){return new RegExp(`^${wb(i)}$`)}function xb(i){let e=`${vb}T${wb(i)}`;const t=[];return t.push(i.local?"Z?":"Z"),i.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function m4(i,e){return!!((e==="v4"||!e)&&o4.test(i)||(e==="v6"||!e)&&c4.test(i))}function g4(i,e){if(!n4.test(i))return!1;try{const[t]=i.split("."),s=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),n=JSON.parse(atob(s));return!(typeof n!="object"||n===null||!n.typ||!n.alg||e&&n.alg!==e)}catch{return!1}}function b4(i,e){return!!((e==="v4"||!e)&&l4.test(i)||(e==="v6"||!e)&&h4.test(i))}class fi extends gt{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==Be.string){const r=this._getOrReturnCtx(e);return Ie(r,{code:Ae.invalid_type,expected:Be.string,received:r.parsedType}),et}const s=new en;let n;for(const r of this._def.checks)if(r.kind==="min")e.data.length<r.value&&(n=this._getOrReturnCtx(e,n),Ie(n,{code:Ae.too_small,minimum:r.value,type:"string",inclusive:!0,exact:!1,message:r.message}),s.dirty());else if(r.kind==="max")e.data.length>r.value&&(n=this._getOrReturnCtx(e,n),Ie(n,{code:Ae.too_big,maximum:r.value,type:"string",inclusive:!0,exact:!1,message:r.message}),s.dirty());else if(r.kind==="length"){const a=e.data.length>r.value,o=e.data.length<r.value;(a||o)&&(n=this._getOrReturnCtx(e,n),a?Ie(n,{code:Ae.too_big,maximum:r.value,type:"string",inclusive:!0,exact:!0,message:r.message}):o&&Ie(n,{code:Ae.too_small,minimum:r.value,type:"string",inclusive:!0,exact:!0,message:r.message}),s.dirty())}else if(r.kind==="email")r4.test(e.data)||(n=this._getOrReturnCtx(e,n),Ie(n,{validation:"email",code:Ae.invalid_string,message:r.message}),s.dirty());else if(r.kind==="emoji")gf||(gf=new RegExp(a4,"u")),gf.test(e.data)||(n=this._getOrReturnCtx(e,n),Ie(n,{validation:"emoji",code:Ae.invalid_string,message:r.message}),s.dirty());else if(r.kind==="uuid")t4.test(e.data)||(n=this._getOrReturnCtx(e,n),Ie(n,{validation:"uuid",code:Ae.invalid_string,message:r.message}),s.dirty());else if(r.kind==="nanoid")s4.test(e.data)||(n=this._getOrReturnCtx(e,n),Ie(n,{validation:"nanoid",code:Ae.invalid_string,message:r.message}),s.dirty());else if(r.kind==="cuid")Z3.test(e.data)||(n=this._getOrReturnCtx(e,n),Ie(n,{validation:"cuid",code:Ae.invalid_string,message:r.message}),s.dirty());else if(r.kind==="cuid2")Q3.test(e.data)||(n=this._getOrReturnCtx(e,n),Ie(n,{validation:"cuid2",code:Ae.invalid_string,message:r.message}),s.dirty());else if(r.kind==="ulid")e4.test(e.data)||(n=this._getOrReturnCtx(e,n),Ie(n,{validation:"ulid",code:Ae.invalid_string,message:r.message}),s.dirty());else if(r.kind==="url")try{new URL(e.data)}catch{n=this._getOrReturnCtx(e,n),Ie(n,{validation:"url",code:Ae.invalid_string,message:r.message}),s.dirty()}else r.kind==="regex"?(r.regex.lastIndex=0,r.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),Ie(n,{validation:"regex",code:Ae.invalid_string,message:r.message}),s.dirty())):r.kind==="trim"?e.data=e.data.trim():r.kind==="includes"?e.data.includes(r.value,r.position)||(n=this._getOrReturnCtx(e,n),Ie(n,{code:Ae.invalid_string,validation:{includes:r.value,position:r.position},message:r.message}),s.dirty()):r.kind==="toLowerCase"?e.data=e.data.toLowerCase():r.kind==="toUpperCase"?e.data=e.data.toUpperCase():r.kind==="startsWith"?e.data.startsWith(r.value)||(n=this._getOrReturnCtx(e,n),Ie(n,{code:Ae.invalid_string,validation:{startsWith:r.value},message:r.message}),s.dirty()):r.kind==="endsWith"?e.data.endsWith(r.value)||(n=this._getOrReturnCtx(e,n),Ie(n,{code:Ae.invalid_string,validation:{endsWith:r.value},message:r.message}),s.dirty()):r.kind==="datetime"?xb(r).test(e.data)||(n=this._getOrReturnCtx(e,n),Ie(n,{code:Ae.invalid_string,validation:"datetime",message:r.message}),s.dirty()):r.kind==="date"?f4.test(e.data)||(n=this._getOrReturnCtx(e,n),Ie(n,{code:Ae.invalid_string,validation:"date",message:r.message}),s.dirty()):r.kind==="time"?p4(r).test(e.data)||(n=this._getOrReturnCtx(e,n),Ie(n,{code:Ae.invalid_string,validation:"time",message:r.message}),s.dirty()):r.kind==="duration"?i4.test(e.data)||(n=this._getOrReturnCtx(e,n),Ie(n,{validation:"duration",code:Ae.invalid_string,message:r.message}),s.dirty()):r.kind==="ip"?m4(e.data,r.version)||(n=this._getOrReturnCtx(e,n),Ie(n,{validation:"ip",code:Ae.invalid_string,message:r.message}),s.dirty()):r.kind==="jwt"?g4(e.data,r.alg)||(n=this._getOrReturnCtx(e,n),Ie(n,{validation:"jwt",code:Ae.invalid_string,message:r.message}),s.dirty()):r.kind==="cidr"?b4(e.data,r.version)||(n=this._getOrReturnCtx(e,n),Ie(n,{validation:"cidr",code:Ae.invalid_string,message:r.message}),s.dirty()):r.kind==="base64"?u4.test(e.data)||(n=this._getOrReturnCtx(e,n),Ie(n,{validation:"base64",code:Ae.invalid_string,message:r.message}),s.dirty()):r.kind==="base64url"?d4.test(e.data)||(n=this._getOrReturnCtx(e,n),Ie(n,{validation:"base64url",code:Ae.invalid_string,message:r.message}),s.dirty()):Ct.assertNever(r);return{status:s.value,value:e.data}}_regex(e,t,s){return this.refinement(n=>e.test(n),{validation:t,code:Ae.invalid_string,...ze.errToObj(s)})}_addCheck(e){return new fi({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...ze.errToObj(e)})}url(e){return this._addCheck({kind:"url",...ze.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...ze.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...ze.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...ze.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...ze.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...ze.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...ze.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...ze.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...ze.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...ze.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...ze.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...ze.errToObj(e)})}datetime(e){var t,s;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(t=e?.offset)!==null&&t!==void 0?t:!1,local:(s=e?.local)!==null&&s!==void 0?s:!1,...ze.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...ze.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...ze.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...ze.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...ze.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...ze.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...ze.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...ze.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...ze.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...ze.errToObj(t)})}nonempty(e){return this.min(1,ze.errToObj(e))}trim(){return new fi({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new fi({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new fi({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}fi.create=i=>{var e;return new fi({checks:[],typeName:Qe.ZodString,coerce:(e=i?.coerce)!==null&&e!==void 0?e:!1,...dt(i)})};function y4(i,e){const t=(i.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,n=t>s?t:s,r=parseInt(i.toFixed(n).replace(".","")),a=parseInt(e.toFixed(n).replace(".",""));return r%a/Math.pow(10,n)}class Wr extends gt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==Be.number){const r=this._getOrReturnCtx(e);return Ie(r,{code:Ae.invalid_type,expected:Be.number,received:r.parsedType}),et}let s;const n=new en;for(const r of this._def.checks)r.kind==="int"?Ct.isInteger(e.data)||(s=this._getOrReturnCtx(e,s),Ie(s,{code:Ae.invalid_type,expected:"integer",received:"float",message:r.message}),n.dirty()):r.kind==="min"?(r.inclusive?e.data<r.value:e.data<=r.value)&&(s=this._getOrReturnCtx(e,s),Ie(s,{code:Ae.too_small,minimum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),n.dirty()):r.kind==="max"?(r.inclusive?e.data>r.value:e.data>=r.value)&&(s=this._getOrReturnCtx(e,s),Ie(s,{code:Ae.too_big,maximum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),n.dirty()):r.kind==="multipleOf"?y4(e.data,r.value)!==0&&(s=this._getOrReturnCtx(e,s),Ie(s,{code:Ae.not_multiple_of,multipleOf:r.value,message:r.message}),n.dirty()):r.kind==="finite"?Number.isFinite(e.data)||(s=this._getOrReturnCtx(e,s),Ie(s,{code:Ae.not_finite,message:r.message}),n.dirty()):Ct.assertNever(r);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,ze.toString(t))}gt(e,t){return this.setLimit("min",e,!1,ze.toString(t))}lte(e,t){return this.setLimit("max",e,!0,ze.toString(t))}lt(e,t){return this.setLimit("max",e,!1,ze.toString(t))}setLimit(e,t,s,n){return new Wr({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:s,message:ze.toString(n)}]})}_addCheck(e){return new Wr({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:ze.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ze.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ze.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ze.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ze.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:ze.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:ze.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ze.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ze.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Ct.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(t===null||s.value>t)&&(t=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(t)&&Number.isFinite(e)}}Wr.create=i=>new Wr({checks:[],typeName:Qe.ZodNumber,coerce:i?.coerce||!1,...dt(i)});class Vr extends gt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==Be.bigint)return this._getInvalidInput(e);let s;const n=new en;for(const r of this._def.checks)r.kind==="min"?(r.inclusive?e.data<r.value:e.data<=r.value)&&(s=this._getOrReturnCtx(e,s),Ie(s,{code:Ae.too_small,type:"bigint",minimum:r.value,inclusive:r.inclusive,message:r.message}),n.dirty()):r.kind==="max"?(r.inclusive?e.data>r.value:e.data>=r.value)&&(s=this._getOrReturnCtx(e,s),Ie(s,{code:Ae.too_big,type:"bigint",maximum:r.value,inclusive:r.inclusive,message:r.message}),n.dirty()):r.kind==="multipleOf"?e.data%r.value!==BigInt(0)&&(s=this._getOrReturnCtx(e,s),Ie(s,{code:Ae.not_multiple_of,multipleOf:r.value,message:r.message}),n.dirty()):Ct.assertNever(r);return{status:n.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return Ie(t,{code:Ae.invalid_type,expected:Be.bigint,received:t.parsedType}),et}gte(e,t){return this.setLimit("min",e,!0,ze.toString(t))}gt(e,t){return this.setLimit("min",e,!1,ze.toString(t))}lte(e,t){return this.setLimit("max",e,!0,ze.toString(t))}lt(e,t){return this.setLimit("max",e,!1,ze.toString(t))}setLimit(e,t,s,n){return new Vr({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:s,message:ze.toString(n)}]})}_addCheck(e){return new Vr({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ze.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ze.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ze.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ze.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:ze.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Vr.create=i=>{var e;return new Vr({checks:[],typeName:Qe.ZodBigInt,coerce:(e=i?.coerce)!==null&&e!==void 0?e:!1,...dt(i)})};class mc extends gt{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Be.boolean){const s=this._getOrReturnCtx(e);return Ie(s,{code:Ae.invalid_type,expected:Be.boolean,received:s.parsedType}),et}return cn(e.data)}}mc.create=i=>new mc({typeName:Qe.ZodBoolean,coerce:i?.coerce||!1,...dt(i)});class Ea extends gt{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==Be.date){const r=this._getOrReturnCtx(e);return Ie(r,{code:Ae.invalid_type,expected:Be.date,received:r.parsedType}),et}if(isNaN(e.data.getTime())){const r=this._getOrReturnCtx(e);return Ie(r,{code:Ae.invalid_date}),et}const s=new en;let n;for(const r of this._def.checks)r.kind==="min"?e.data.getTime()<r.value&&(n=this._getOrReturnCtx(e,n),Ie(n,{code:Ae.too_small,message:r.message,inclusive:!0,exact:!1,minimum:r.value,type:"date"}),s.dirty()):r.kind==="max"?e.data.getTime()>r.value&&(n=this._getOrReturnCtx(e,n),Ie(n,{code:Ae.too_big,message:r.message,inclusive:!0,exact:!1,maximum:r.value,type:"date"}),s.dirty()):Ct.assertNever(r);return{status:s.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Ea({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:ze.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:ze.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}Ea.create=i=>new Ea({checks:[],coerce:i?.coerce||!1,typeName:Qe.ZodDate,...dt(i)});class _u extends gt{_parse(e){if(this._getType(e)!==Be.symbol){const s=this._getOrReturnCtx(e);return Ie(s,{code:Ae.invalid_type,expected:Be.symbol,received:s.parsedType}),et}return cn(e.data)}}_u.create=i=>new _u({typeName:Qe.ZodSymbol,...dt(i)});class gc extends gt{_parse(e){if(this._getType(e)!==Be.undefined){const s=this._getOrReturnCtx(e);return Ie(s,{code:Ae.invalid_type,expected:Be.undefined,received:s.parsedType}),et}return cn(e.data)}}gc.create=i=>new gc({typeName:Qe.ZodUndefined,...dt(i)});class bc extends gt{_parse(e){if(this._getType(e)!==Be.null){const s=this._getOrReturnCtx(e);return Ie(s,{code:Ae.invalid_type,expected:Be.null,received:s.parsedType}),et}return cn(e.data)}}bc.create=i=>new bc({typeName:Qe.ZodNull,...dt(i)});class zo extends gt{constructor(){super(...arguments),this._any=!0}_parse(e){return cn(e.data)}}zo.create=i=>new zo({typeName:Qe.ZodAny,...dt(i)});class _a extends gt{constructor(){super(...arguments),this._unknown=!0}_parse(e){return cn(e.data)}}_a.create=i=>new _a({typeName:Qe.ZodUnknown,...dt(i)});class pr extends gt{_parse(e){const t=this._getOrReturnCtx(e);return Ie(t,{code:Ae.invalid_type,expected:Be.never,received:t.parsedType}),et}}pr.create=i=>new pr({typeName:Qe.ZodNever,...dt(i)});class Au extends gt{_parse(e){if(this._getType(e)!==Be.undefined){const s=this._getOrReturnCtx(e);return Ie(s,{code:Ae.invalid_type,expected:Be.void,received:s.parsedType}),et}return cn(e.data)}}Au.create=i=>new Au({typeName:Qe.ZodVoid,...dt(i)});class gi extends gt{_parse(e){const{ctx:t,status:s}=this._processInputParams(e),n=this._def;if(t.parsedType!==Be.array)return Ie(t,{code:Ae.invalid_type,expected:Be.array,received:t.parsedType}),et;if(n.exactLength!==null){const a=t.data.length>n.exactLength.value,o=t.data.length<n.exactLength.value;(a||o)&&(Ie(t,{code:a?Ae.too_big:Ae.too_small,minimum:o?n.exactLength.value:void 0,maximum:a?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),s.dirty())}if(n.minLength!==null&&t.data.length<n.minLength.value&&(Ie(t,{code:Ae.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),s.dirty()),n.maxLength!==null&&t.data.length>n.maxLength.value&&(Ie(t,{code:Ae.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),s.dirty()),t.common.async)return Promise.all([...t.data].map((a,o)=>n.type._parseAsync(new Hi(t,a,t.path,o)))).then(a=>en.mergeArray(s,a));const r=[...t.data].map((a,o)=>n.type._parseSync(new Hi(t,a,t.path,o)));return en.mergeArray(s,r)}get element(){return this._def.type}min(e,t){return new gi({...this._def,minLength:{value:e,message:ze.toString(t)}})}max(e,t){return new gi({...this._def,maxLength:{value:e,message:ze.toString(t)}})}length(e,t){return new gi({...this._def,exactLength:{value:e,message:ze.toString(t)}})}nonempty(e){return this.min(1,e)}}gi.create=(i,e)=>new gi({type:i,minLength:null,maxLength:null,exactLength:null,typeName:Qe.ZodArray,...dt(e)});function _o(i){if(i instanceof ns){const e={};for(const t in i.shape){const s=i.shape[t];e[t]=zi.create(_o(s))}return new ns({...i._def,shape:()=>e})}else return i instanceof gi?new gi({...i._def,type:_o(i.element)}):i instanceof zi?zi.create(_o(i.unwrap())):i instanceof Xr?Xr.create(_o(i.unwrap())):i instanceof Wi?Wi.create(i.items.map(e=>_o(e))):i}class ns extends gt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=Ct.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==Be.object){const c=this._getOrReturnCtx(e);return Ie(c,{code:Ae.invalid_type,expected:Be.object,received:c.parsedType}),et}const{status:s,ctx:n}=this._processInputParams(e),{shape:r,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof pr&&this._def.unknownKeys==="strip"))for(const c in n.data)a.includes(c)||o.push(c);const l=[];for(const c of a){const h=r[c],d=n.data[c];l.push({key:{status:"valid",value:c},value:h._parse(new Hi(n,d,n.path,c)),alwaysSet:c in n.data})}if(this._def.catchall instanceof pr){const c=this._def.unknownKeys;if(c==="passthrough")for(const h of o)l.push({key:{status:"valid",value:h},value:{status:"valid",value:n.data[h]}});else if(c==="strict")o.length>0&&(Ie(n,{code:Ae.unrecognized_keys,keys:o}),s.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const h of o){const d=n.data[h];l.push({key:{status:"valid",value:h},value:c._parse(new Hi(n,d,n.path,h)),alwaysSet:h in n.data})}}return n.common.async?Promise.resolve().then(async()=>{const c=[];for(const h of l){const d=await h.key,p=await h.value;c.push({key:d,value:p,alwaysSet:h.alwaysSet})}return c}).then(c=>en.mergeObjectSync(s,c)):en.mergeObjectSync(s,l)}get shape(){return this._def.shape()}strict(e){return ze.errToObj,new ns({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,s)=>{var n,r,a,o;const l=(a=(r=(n=this._def).errorMap)===null||r===void 0?void 0:r.call(n,t,s).message)!==null&&a!==void 0?a:s.defaultError;return t.code==="unrecognized_keys"?{message:(o=ze.errToObj(e).message)!==null&&o!==void 0?o:l}:{message:l}}}:{}})}strip(){return new ns({...this._def,unknownKeys:"strip"})}passthrough(){return new ns({...this._def,unknownKeys:"passthrough"})}extend(e){return new ns({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new ns({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Qe.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new ns({...this._def,catchall:e})}pick(e){const t={};return Ct.objectKeys(e).forEach(s=>{e[s]&&this.shape[s]&&(t[s]=this.shape[s])}),new ns({...this._def,shape:()=>t})}omit(e){const t={};return Ct.objectKeys(this.shape).forEach(s=>{e[s]||(t[s]=this.shape[s])}),new ns({...this._def,shape:()=>t})}deepPartial(){return _o(this)}partial(e){const t={};return Ct.objectKeys(this.shape).forEach(s=>{const n=this.shape[s];e&&!e[s]?t[s]=n:t[s]=n.optional()}),new ns({...this._def,shape:()=>t})}required(e){const t={};return Ct.objectKeys(this.shape).forEach(s=>{if(e&&!e[s])t[s]=this.shape[s];else{let r=this.shape[s];for(;r instanceof zi;)r=r._def.innerType;t[s]=r}}),new ns({...this._def,shape:()=>t})}keyof(){return _b(Ct.objectKeys(this.shape))}}ns.create=(i,e)=>new ns({shape:()=>i,unknownKeys:"strip",catchall:pr.create(),typeName:Qe.ZodObject,...dt(e)});ns.strictCreate=(i,e)=>new ns({shape:()=>i,unknownKeys:"strict",catchall:pr.create(),typeName:Qe.ZodObject,...dt(e)});ns.lazycreate=(i,e)=>new ns({shape:i,unknownKeys:"strip",catchall:pr.create(),typeName:Qe.ZodObject,...dt(e)});class yc extends gt{_parse(e){const{ctx:t}=this._processInputParams(e),s=this._def.options;function n(r){for(const o of r)if(o.result.status==="valid")return o.result;for(const o of r)if(o.result.status==="dirty")return t.common.issues.push(...o.ctx.common.issues),o.result;const a=r.map(o=>new Rn(o.ctx.common.issues));return Ie(t,{code:Ae.invalid_union,unionErrors:a}),et}if(t.common.async)return Promise.all(s.map(async r=>{const a={...t,common:{...t.common,issues:[]},parent:null};return{result:await r._parseAsync({data:t.data,path:t.path,parent:a}),ctx:a}})).then(n);{let r;const a=[];for(const l of s){const c={...t,common:{...t.common,issues:[]},parent:null},h=l._parseSync({data:t.data,path:t.path,parent:c});if(h.status==="valid")return h;h.status==="dirty"&&!r&&(r={result:h,ctx:c}),c.common.issues.length&&a.push(c.common.issues)}if(r)return t.common.issues.push(...r.ctx.common.issues),r.result;const o=a.map(l=>new Rn(l));return Ie(t,{code:Ae.invalid_union,unionErrors:o}),et}}get options(){return this._def.options}}yc.create=(i,e)=>new yc({options:i,typeName:Qe.ZodUnion,...dt(e)});const lr=i=>i instanceof xc?lr(i.schema):i instanceof yi?lr(i.innerType()):i instanceof _c?[i.value]:i instanceof Gr?i.options:i instanceof Ac?Ct.objectValues(i.enum):i instanceof Sc?lr(i._def.innerType):i instanceof gc?[void 0]:i instanceof bc?[null]:i instanceof zi?[void 0,...lr(i.unwrap())]:i instanceof Xr?[null,...lr(i.unwrap())]:i instanceof Yp||i instanceof Ec?lr(i.unwrap()):i instanceof Nc?lr(i._def.innerType):[];class ed extends gt{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Be.object)return Ie(t,{code:Ae.invalid_type,expected:Be.object,received:t.parsedType}),et;const s=this.discriminator,n=t.data[s],r=this.optionsMap.get(n);return r?t.common.async?r._parseAsync({data:t.data,path:t.path,parent:t}):r._parseSync({data:t.data,path:t.path,parent:t}):(Ie(t,{code:Ae.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),et)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,s){const n=new Map;for(const r of t){const a=lr(r.shape[e]);if(!a.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of a){if(n.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);n.set(o,r)}}return new ed({typeName:Qe.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:n,...dt(s)})}}function ip(i,e){const t=dr(i),s=dr(e);if(i===e)return{valid:!0,data:i};if(t===Be.object&&s===Be.object){const n=Ct.objectKeys(e),r=Ct.objectKeys(i).filter(o=>n.indexOf(o)!==-1),a={...i,...e};for(const o of r){const l=ip(i[o],e[o]);if(!l.valid)return{valid:!1};a[o]=l.data}return{valid:!0,data:a}}else if(t===Be.array&&s===Be.array){if(i.length!==e.length)return{valid:!1};const n=[];for(let r=0;r<i.length;r++){const a=i[r],o=e[r],l=ip(a,o);if(!l.valid)return{valid:!1};n.push(l.data)}return{valid:!0,data:n}}else return t===Be.date&&s===Be.date&&+i==+e?{valid:!0,data:i}:{valid:!1}}class vc extends gt{_parse(e){const{status:t,ctx:s}=this._processInputParams(e),n=(r,a)=>{if(sp(r)||sp(a))return et;const o=ip(r.value,a.value);return o.valid?((np(r)||np(a))&&t.dirty(),{status:t.value,value:o.data}):(Ie(s,{code:Ae.invalid_intersection_types}),et)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([r,a])=>n(r,a)):n(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}}vc.create=(i,e,t)=>new vc({left:i,right:e,typeName:Qe.ZodIntersection,...dt(t)});class Wi extends gt{_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==Be.array)return Ie(s,{code:Ae.invalid_type,expected:Be.array,received:s.parsedType}),et;if(s.data.length<this._def.items.length)return Ie(s,{code:Ae.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),et;!this._def.rest&&s.data.length>this._def.items.length&&(Ie(s,{code:Ae.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const r=[...s.data].map((a,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new Hi(s,a,s.path,o)):null}).filter(a=>!!a);return s.common.async?Promise.all(r).then(a=>en.mergeArray(t,a)):en.mergeArray(t,r)}get items(){return this._def.items}rest(e){return new Wi({...this._def,rest:e})}}Wi.create=(i,e)=>{if(!Array.isArray(i))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Wi({items:i,typeName:Qe.ZodTuple,rest:null,...dt(e)})};class wc extends gt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==Be.object)return Ie(s,{code:Ae.invalid_type,expected:Be.object,received:s.parsedType}),et;const n=[],r=this._def.keyType,a=this._def.valueType;for(const o in s.data)n.push({key:r._parse(new Hi(s,o,s.path,o)),value:a._parse(new Hi(s,s.data[o],s.path,o)),alwaysSet:o in s.data});return s.common.async?en.mergeObjectAsync(t,n):en.mergeObjectSync(t,n)}get element(){return this._def.valueType}static create(e,t,s){return t instanceof gt?new wc({keyType:e,valueType:t,typeName:Qe.ZodRecord,...dt(s)}):new wc({keyType:fi.create(),valueType:e,typeName:Qe.ZodRecord,...dt(t)})}}class Su extends gt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==Be.map)return Ie(s,{code:Ae.invalid_type,expected:Be.map,received:s.parsedType}),et;const n=this._def.keyType,r=this._def.valueType,a=[...s.data.entries()].map(([o,l],c)=>({key:n._parse(new Hi(s,o,s.path,[c,"key"])),value:r._parse(new Hi(s,l,s.path,[c,"value"]))}));if(s.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of a){const c=await l.key,h=await l.value;if(c.status==="aborted"||h.status==="aborted")return et;(c.status==="dirty"||h.status==="dirty")&&t.dirty(),o.set(c.value,h.value)}return{status:t.value,value:o}})}else{const o=new Map;for(const l of a){const c=l.key,h=l.value;if(c.status==="aborted"||h.status==="aborted")return et;(c.status==="dirty"||h.status==="dirty")&&t.dirty(),o.set(c.value,h.value)}return{status:t.value,value:o}}}}Su.create=(i,e,t)=>new Su({valueType:e,keyType:i,typeName:Qe.ZodMap,...dt(t)});class ka extends gt{_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==Be.set)return Ie(s,{code:Ae.invalid_type,expected:Be.set,received:s.parsedType}),et;const n=this._def;n.minSize!==null&&s.data.size<n.minSize.value&&(Ie(s,{code:Ae.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),t.dirty()),n.maxSize!==null&&s.data.size>n.maxSize.value&&(Ie(s,{code:Ae.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),t.dirty());const r=this._def.valueType;function a(l){const c=new Set;for(const h of l){if(h.status==="aborted")return et;h.status==="dirty"&&t.dirty(),c.add(h.value)}return{status:t.value,value:c}}const o=[...s.data.values()].map((l,c)=>r._parse(new Hi(s,l,s.path,c)));return s.common.async?Promise.all(o).then(l=>a(l)):a(o)}min(e,t){return new ka({...this._def,minSize:{value:e,message:ze.toString(t)}})}max(e,t){return new ka({...this._def,maxSize:{value:e,message:ze.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}ka.create=(i,e)=>new ka({valueType:i,minSize:null,maxSize:null,typeName:Qe.ZodSet,...dt(e)});class Mo extends gt{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Be.function)return Ie(t,{code:Ae.invalid_type,expected:Be.function,received:t.parsedType}),et;function s(o,l){return wu({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,vu(),Uo].filter(c=>!!c),issueData:{code:Ae.invalid_arguments,argumentsError:l}})}function n(o,l){return wu({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,vu(),Uo].filter(c=>!!c),issueData:{code:Ae.invalid_return_type,returnTypeError:l}})}const r={errorMap:t.common.contextualErrorMap},a=t.data;if(this._def.returns instanceof Ho){const o=this;return cn(async function(...l){const c=new Rn([]),h=await o._def.args.parseAsync(l,r).catch(f=>{throw c.addIssue(s(l,f)),c}),d=await Reflect.apply(a,this,h);return await o._def.returns._def.type.parseAsync(d,r).catch(f=>{throw c.addIssue(n(d,f)),c})})}else{const o=this;return cn(function(...l){const c=o._def.args.safeParse(l,r);if(!c.success)throw new Rn([s(l,c.error)]);const h=Reflect.apply(a,this,c.data),d=o._def.returns.safeParse(h,r);if(!d.success)throw new Rn([n(h,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Mo({...this._def,args:Wi.create(e).rest(_a.create())})}returns(e){return new Mo({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,s){return new Mo({args:e||Wi.create([]).rest(_a.create()),returns:t||_a.create(),typeName:Qe.ZodFunction,...dt(s)})}}class xc extends gt{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}xc.create=(i,e)=>new xc({getter:i,typeName:Qe.ZodLazy,...dt(e)});class _c extends gt{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return Ie(t,{received:t.data,code:Ae.invalid_literal,expected:this._def.value}),et}return{status:"valid",value:e.data}}get value(){return this._def.value}}_c.create=(i,e)=>new _c({value:i,typeName:Qe.ZodLiteral,...dt(e)});function _b(i,e){return new Gr({values:i,typeName:Qe.ZodEnum,...dt(e)})}class Gr extends gt{constructor(){super(...arguments),Hl.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),s=this._def.values;return Ie(t,{expected:Ct.joinValues(s),received:t.parsedType,code:Ae.invalid_type}),et}if(xu(this,Hl)||yb(this,Hl,new Set(this._def.values)),!xu(this,Hl).has(e.data)){const t=this._getOrReturnCtx(e),s=this._def.values;return Ie(t,{received:t.data,code:Ae.invalid_enum_value,options:s}),et}return cn(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Gr.create(e,{...this._def,...t})}exclude(e,t=this._def){return Gr.create(this.options.filter(s=>!e.includes(s)),{...this._def,...t})}}Hl=new WeakMap;Gr.create=_b;class Ac extends gt{constructor(){super(...arguments),Wl.set(this,void 0)}_parse(e){const t=Ct.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==Be.string&&s.parsedType!==Be.number){const n=Ct.objectValues(t);return Ie(s,{expected:Ct.joinValues(n),received:s.parsedType,code:Ae.invalid_type}),et}if(xu(this,Wl)||yb(this,Wl,new Set(Ct.getValidEnumValues(this._def.values))),!xu(this,Wl).has(e.data)){const n=Ct.objectValues(t);return Ie(s,{received:s.data,code:Ae.invalid_enum_value,options:n}),et}return cn(e.data)}get enum(){return this._def.values}}Wl=new WeakMap;Ac.create=(i,e)=>new Ac({values:i,typeName:Qe.ZodNativeEnum,...dt(e)});class Ho extends gt{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Be.promise&&t.common.async===!1)return Ie(t,{code:Ae.invalid_type,expected:Be.promise,received:t.parsedType}),et;const s=t.parsedType===Be.promise?t.data:Promise.resolve(t.data);return cn(s.then(n=>this._def.type.parseAsync(n,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Ho.create=(i,e)=>new Ho({type:i,typeName:Qe.ZodPromise,...dt(e)});class yi extends gt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Qe.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:s}=this._processInputParams(e),n=this._def.effect||null,r={addIssue:a=>{Ie(s,a),a.fatal?t.abort():t.dirty()},get path(){return s.path}};if(r.addIssue=r.addIssue.bind(r),n.type==="preprocess"){const a=n.transform(s.data,r);if(s.common.async)return Promise.resolve(a).then(async o=>{if(t.value==="aborted")return et;const l=await this._def.schema._parseAsync({data:o,path:s.path,parent:s});return l.status==="aborted"?et:l.status==="dirty"||t.value==="dirty"?ko(l.value):l});{if(t.value==="aborted")return et;const o=this._def.schema._parseSync({data:a,path:s.path,parent:s});return o.status==="aborted"?et:o.status==="dirty"||t.value==="dirty"?ko(o.value):o}}if(n.type==="refinement"){const a=o=>{const l=n.refinement(o,r);if(s.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(s.common.async===!1){const o=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return o.status==="aborted"?et:(o.status==="dirty"&&t.dirty(),a(o.value),{status:t.value,value:o.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(o=>o.status==="aborted"?et:(o.status==="dirty"&&t.dirty(),a(o.value).then(()=>({status:t.value,value:o.value}))))}if(n.type==="transform")if(s.common.async===!1){const a=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!Na(a))return a;const o=n.transform(a.value,r);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:o}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(a=>Na(a)?Promise.resolve(n.transform(a.value,r)).then(o=>({status:t.value,value:o})):a);Ct.assertNever(n)}}yi.create=(i,e,t)=>new yi({schema:i,typeName:Qe.ZodEffects,effect:e,...dt(t)});yi.createWithPreprocess=(i,e,t)=>new yi({schema:e,effect:{type:"preprocess",transform:i},typeName:Qe.ZodEffects,...dt(t)});class zi extends gt{_parse(e){return this._getType(e)===Be.undefined?cn(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}zi.create=(i,e)=>new zi({innerType:i,typeName:Qe.ZodOptional,...dt(e)});class Xr extends gt{_parse(e){return this._getType(e)===Be.null?cn(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Xr.create=(i,e)=>new Xr({innerType:i,typeName:Qe.ZodNullable,...dt(e)});class Sc extends gt{_parse(e){const{ctx:t}=this._processInputParams(e);let s=t.data;return t.parsedType===Be.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Sc.create=(i,e)=>new Sc({innerType:i,typeName:Qe.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...dt(e)});class Nc extends gt{_parse(e){const{ctx:t}=this._processInputParams(e),s={...t,common:{...t.common,issues:[]}},n=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return pc(n)?n.then(r=>({status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new Rn(s.common.issues)},input:s.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new Rn(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}}Nc.create=(i,e)=>new Nc({innerType:i,typeName:Qe.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...dt(e)});class Nu extends gt{_parse(e){if(this._getType(e)!==Be.nan){const s=this._getOrReturnCtx(e);return Ie(s,{code:Ae.invalid_type,expected:Be.nan,received:s.parsedType}),et}return{status:"valid",value:e.data}}}Nu.create=i=>new Nu({typeName:Qe.ZodNaN,...dt(i)});const v4=Symbol("zod_brand");class Yp extends gt{_parse(e){const{ctx:t}=this._processInputParams(e),s=t.data;return this._def.type._parse({data:s,path:t.path,parent:t})}unwrap(){return this._def.type}}class Fc extends gt{_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{const r=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return r.status==="aborted"?et:r.status==="dirty"?(t.dirty(),ko(r.value)):this._def.out._parseAsync({data:r.value,path:s.path,parent:s})})();{const n=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?et:n.status==="dirty"?(t.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:s.path,parent:s})}}static create(e,t){return new Fc({in:e,out:t,typeName:Qe.ZodPipeline})}}class Ec extends gt{_parse(e){const t=this._def.innerType._parse(e),s=n=>(Na(n)&&(n.value=Object.freeze(n.value)),n);return pc(t)?t.then(n=>s(n)):s(t)}unwrap(){return this._def.innerType}}Ec.create=(i,e)=>new Ec({innerType:i,typeName:Qe.ZodReadonly,...dt(e)});function Ab(i,e={},t){return i?zo.create().superRefine((s,n)=>{var r,a;if(!i(s)){const o=typeof e=="function"?e(s):typeof e=="string"?{message:e}:e,l=(a=(r=o.fatal)!==null&&r!==void 0?r:t)!==null&&a!==void 0?a:!0,c=typeof o=="string"?{message:o}:o;n.addIssue({code:"custom",...c,fatal:l})}}):zo.create()}const w4={object:ns.lazycreate};var Qe;(function(i){i.ZodString="ZodString",i.ZodNumber="ZodNumber",i.ZodNaN="ZodNaN",i.ZodBigInt="ZodBigInt",i.ZodBoolean="ZodBoolean",i.ZodDate="ZodDate",i.ZodSymbol="ZodSymbol",i.ZodUndefined="ZodUndefined",i.ZodNull="ZodNull",i.ZodAny="ZodAny",i.ZodUnknown="ZodUnknown",i.ZodNever="ZodNever",i.ZodVoid="ZodVoid",i.ZodArray="ZodArray",i.ZodObject="ZodObject",i.ZodUnion="ZodUnion",i.ZodDiscriminatedUnion="ZodDiscriminatedUnion",i.ZodIntersection="ZodIntersection",i.ZodTuple="ZodTuple",i.ZodRecord="ZodRecord",i.ZodMap="ZodMap",i.ZodSet="ZodSet",i.ZodFunction="ZodFunction",i.ZodLazy="ZodLazy",i.ZodLiteral="ZodLiteral",i.ZodEnum="ZodEnum",i.ZodEffects="ZodEffects",i.ZodNativeEnum="ZodNativeEnum",i.ZodOptional="ZodOptional",i.ZodNullable="ZodNullable",i.ZodDefault="ZodDefault",i.ZodCatch="ZodCatch",i.ZodPromise="ZodPromise",i.ZodBranded="ZodBranded",i.ZodPipeline="ZodPipeline",i.ZodReadonly="ZodReadonly"})(Qe||(Qe={}));const x4=(i,e={message:`Input not instance of ${i.name}`})=>Ab(t=>t instanceof i,e),Sb=fi.create,Nb=Wr.create,_4=Nu.create,A4=Vr.create,Eb=mc.create,S4=Ea.create,N4=_u.create,E4=gc.create,k4=bc.create,C4=zo.create,P4=_a.create,L4=pr.create,T4=Au.create,j4=gi.create,I4=ns.create,R4=ns.strictCreate,O4=yc.create,M4=ed.create,F4=vc.create,D4=Wi.create,B4=wc.create,$4=Su.create,q4=ka.create,U4=Mo.create,z4=xc.create,H4=_c.create,W4=Gr.create,V4=Ac.create,G4=Ho.create,r0=yi.create,X4=zi.create,Y4=Xr.create,K4=yi.createWithPreprocess,J4=Fc.create,Z4=()=>Sb().optional(),Q4=()=>Nb().optional(),eN=()=>Eb().optional(),tN={string:i=>fi.create({...i,coerce:!0}),number:i=>Wr.create({...i,coerce:!0}),boolean:i=>mc.create({...i,coerce:!0}),bigint:i=>Vr.create({...i,coerce:!0}),date:i=>Ea.create({...i,coerce:!0})},sN=et;var Ls=Object.freeze({__proto__:null,defaultErrorMap:Uo,setErrorMap:K3,getErrorMap:vu,makeIssue:wu,EMPTY_PATH:J3,addIssueToContext:Ie,ParseStatus:en,INVALID:et,DIRTY:ko,OK:cn,isAborted:sp,isDirty:np,isValid:Na,isAsync:pc,get util(){return Ct},get objectUtil(){return tp},ZodParsedType:Be,getParsedType:dr,ZodType:gt,datetimeRegex:xb,ZodString:fi,ZodNumber:Wr,ZodBigInt:Vr,ZodBoolean:mc,ZodDate:Ea,ZodSymbol:_u,ZodUndefined:gc,ZodNull:bc,ZodAny:zo,ZodUnknown:_a,ZodNever:pr,ZodVoid:Au,ZodArray:gi,ZodObject:ns,ZodUnion:yc,ZodDiscriminatedUnion:ed,ZodIntersection:vc,ZodTuple:Wi,ZodRecord:wc,ZodMap:Su,ZodSet:ka,ZodFunction:Mo,ZodLazy:xc,ZodLiteral:_c,ZodEnum:Gr,ZodNativeEnum:Ac,ZodPromise:Ho,ZodEffects:yi,ZodTransformer:yi,ZodOptional:zi,ZodNullable:Xr,ZodDefault:Sc,ZodCatch:Nc,ZodNaN:Nu,BRAND:v4,ZodBranded:Yp,ZodPipeline:Fc,ZodReadonly:Ec,custom:Ab,Schema:gt,ZodSchema:gt,late:w4,get ZodFirstPartyTypeKind(){return Qe},coerce:tN,any:C4,array:j4,bigint:A4,boolean:Eb,date:S4,discriminatedUnion:M4,effect:r0,enum:W4,function:U4,instanceof:x4,intersection:F4,lazy:z4,literal:H4,map:$4,nan:_4,nativeEnum:V4,never:L4,null:k4,nullable:Y4,number:Nb,object:I4,oboolean:eN,onumber:Q4,optional:X4,ostring:Z4,pipeline:J4,preprocess:K4,promise:G4,record:B4,set:q4,strictObject:R4,string:Sb,symbol:N4,transformer:r0,tuple:D4,undefined:E4,union:O4,unknown:P4,void:T4,NEVER:sN,ZodIssueCode:Ae,quotelessJson:Y3,ZodError:Rn});function nN({initialValues:i,validationSchema:e,onSubmit:t}){const[s,n]=V.useState({values:i,errors:{},touched:{}}),r=V.useCallback((l,c)=>{n(h=>({...h,values:{...h.values,[l]:c},touched:{...h.touched,[l]:!0}}))},[]),a=V.useCallback((l,c)=>{if(!e)return"";try{return Ls.object({[l]:e._def.shape[l]}).parse({[l]:c}),""}catch(h){return h instanceof Ls.ZodError&&h.errors[0]?.message||""}},[e]),o=V.useCallback(async l=>{if(l.preventDefault(),e)try{e.parse(s.values)}catch(c){if(c instanceof Ls.ZodError){const h={};c.errors.forEach(d=>{d.path[0]&&(h[d.path[0]]=d.message)}),n(d=>({...d,errors:h}));return}}await t(s.values)},[s.values,e,t]);return{values:s.values,errors:s.errors,touched:s.touched,setFieldValue:r,validateField:a,handleSubmit:o}}function iN(i=!1){const[e,t]=V.useState(i),[s,n]=V.useState(null),r=V.useCallback(async a=>{t(!0),n(null);try{return await a}catch(o){const l=o instanceof Error?o.message:"An unexpected error occurred";throw n(l),o}finally{t(!1)}},[]);return{isLoading:e,error:s,withLoading:r}}const rp="RFC3986",ap={RFC1738:i=>String(i).replace(/%20/g,"+"),RFC3986:i=>String(i)},rN="RFC1738",aN=Array.isArray,Ri=(()=>{const i=[];for(let e=0;e<256;++e)i.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return i})(),bf=1024,oN=(i,e,t,s,n)=>{if(i.length===0)return i;let r=i;if(typeof i=="symbol"?r=Symbol.prototype.toString.call(i):typeof i!="string"&&(r=String(i)),t==="iso-8859-1")return escape(r).replace(/%u[0-9a-f]{4}/gi,function(o){return"%26%23"+parseInt(o.slice(2),16)+"%3B"});let a="";for(let o=0;o<r.length;o+=bf){const l=r.length>=bf?r.slice(o,o+bf):r,c=[];for(let h=0;h<l.length;++h){let d=l.charCodeAt(h);if(d===45||d===46||d===95||d===126||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||n===rN&&(d===40||d===41)){c[c.length]=l.charAt(h);continue}if(d<128){c[c.length]=Ri[d];continue}if(d<2048){c[c.length]=Ri[192|d>>6]+Ri[128|d&63];continue}if(d<55296||d>=57344){c[c.length]=Ri[224|d>>12]+Ri[128|d>>6&63]+Ri[128|d&63];continue}h+=1,d=65536+((d&1023)<<10|l.charCodeAt(h)&1023),c[c.length]=Ri[240|d>>18]+Ri[128|d>>12&63]+Ri[128|d>>6&63]+Ri[128|d&63]}a+=c.join("")}return a};function lN(i){return!i||typeof i!="object"?!1:!!(i.constructor&&i.constructor.isBuffer&&i.constructor.isBuffer(i))}function a0(i,e){if(aN(i)){const t=[];for(let s=0;s<i.length;s+=1)t.push(e(i[s]));return t}return e(i)}const cN=Object.prototype.hasOwnProperty,kb={brackets(i){return String(i)+"[]"},comma:"comma",indices(i,e){return String(i)+"["+e+"]"},repeat(i){return String(i)}},Fi=Array.isArray,hN=Array.prototype.push,Cb=function(i,e){hN.apply(i,Fi(e)?e:[e])},uN=Date.prototype.toISOString,Cs={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:oN,encodeValuesOnly:!1,format:rp,formatter:ap[rp],indices:!1,serializeDate(i){return uN.call(i)},skipNulls:!1,strictNullHandling:!1};function dN(i){return typeof i=="string"||typeof i=="number"||typeof i=="boolean"||typeof i=="symbol"||typeof i=="bigint"}const yf={};function Pb(i,e,t,s,n,r,a,o,l,c,h,d,p,f,v,w,A,x){let S=i,j=x,M=0,B=!1;for(;(j=j.get(yf))!==void 0&&!B;){const ie=j.get(i);if(M+=1,typeof ie<"u"){if(ie===M)throw new RangeError("Cyclic object value");B=!0}typeof j.get(yf)>"u"&&(M=0)}if(typeof c=="function"?S=c(e,S):S instanceof Date?S=p?.(S):t==="comma"&&Fi(S)&&(S=a0(S,function(ie){return ie instanceof Date?p?.(ie):ie})),S===null){if(r)return l&&!w?l(e,Cs.encoder,A,"key",f):e;S=""}if(dN(S)||lN(S)){if(l){const ie=w?e:l(e,Cs.encoder,A,"key",f);return[v?.(ie)+"="+v?.(l(S,Cs.encoder,A,"value",f))]}return[v?.(e)+"="+v?.(String(S))]}const Q=[];if(typeof S>"u")return Q;let q;if(t==="comma"&&Fi(S))w&&l&&(S=a0(S,l)),q=[{value:S.length>0?S.join(",")||null:void 0}];else if(Fi(c))q=c;else{const ie=Object.keys(S);q=h?ie.sort(h):ie}const O=o?String(e).replace(/\./g,"%2E"):String(e),G=s&&Fi(S)&&S.length===1?O+"[]":O;if(n&&Fi(S)&&S.length===0)return G+"[]";for(let ie=0;ie<q.length;++ie){const L=q[ie],R=typeof L=="object"&&typeof L.value<"u"?L.value:S[L];if(a&&R===null)continue;const W=d&&o?L.replace(/\./g,"%2E"):L,U=Fi(S)?typeof t=="function"?t(G,W):G:G+(d?"."+W:"["+W+"]");x.set(i,M);const he=new WeakMap;he.set(yf,x),Cb(Q,Pb(R,U,t,s,n,r,a,o,t==="comma"&&w&&Fi(S)?null:l,c,h,d,p,f,v,w,A,he))}return Q}function fN(i=Cs){if(typeof i.allowEmptyArrays<"u"&&typeof i.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof i.encodeDotInKeys<"u"&&typeof i.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(i.encoder!==null&&typeof i.encoder<"u"&&typeof i.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=i.charset||Cs.charset;if(typeof i.charset<"u"&&i.charset!=="utf-8"&&i.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=rp;if(typeof i.format<"u"){if(!cN.call(ap,i.format))throw new TypeError("Unknown format option provided.");t=i.format}const s=ap[t];let n=Cs.filter;(typeof i.filter=="function"||Fi(i.filter))&&(n=i.filter);let r;if(i.arrayFormat&&i.arrayFormat in kb?r=i.arrayFormat:"indices"in i?r=i.indices?"indices":"repeat":r=Cs.arrayFormat,"commaRoundTrip"in i&&typeof i.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const a=typeof i.allowDots>"u"?i.encodeDotInKeys?!0:Cs.allowDots:!!i.allowDots;return{addQueryPrefix:typeof i.addQueryPrefix=="boolean"?i.addQueryPrefix:Cs.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof i.allowEmptyArrays=="boolean"?!!i.allowEmptyArrays:Cs.allowEmptyArrays,arrayFormat:r,charset:e,charsetSentinel:typeof i.charsetSentinel=="boolean"?i.charsetSentinel:Cs.charsetSentinel,commaRoundTrip:!!i.commaRoundTrip,delimiter:typeof i.delimiter>"u"?Cs.delimiter:i.delimiter,encode:typeof i.encode=="boolean"?i.encode:Cs.encode,encodeDotInKeys:typeof i.encodeDotInKeys=="boolean"?i.encodeDotInKeys:Cs.encodeDotInKeys,encoder:typeof i.encoder=="function"?i.encoder:Cs.encoder,encodeValuesOnly:typeof i.encodeValuesOnly=="boolean"?i.encodeValuesOnly:Cs.encodeValuesOnly,filter:n,format:t,formatter:s,serializeDate:typeof i.serializeDate=="function"?i.serializeDate:Cs.serializeDate,skipNulls:typeof i.skipNulls=="boolean"?i.skipNulls:Cs.skipNulls,sort:typeof i.sort=="function"?i.sort:null,strictNullHandling:typeof i.strictNullHandling=="boolean"?i.strictNullHandling:Cs.strictNullHandling}}function pN(i,e={}){let t=i;const s=fN(e);let n,r;typeof s.filter=="function"?(r=s.filter,t=r("",t)):Fi(s.filter)&&(r=s.filter,n=r);const a=[];if(typeof t!="object"||t===null)return"";const o=kb[s.arrayFormat],l=o==="comma"&&s.commaRoundTrip;n||(n=Object.keys(t)),s.sort&&n.sort(s.sort);const c=new WeakMap;for(let p=0;p<n.length;++p){const f=n[p];s.skipNulls&&t[f]===null||Cb(a,Pb(t[f],f,o,l,s.allowEmptyArrays,s.strictNullHandling,s.skipNulls,s.encodeDotInKeys,s.encode?s.encoder:null,s.filter,s.sort,s.allowDots,s.serializeDate,s.format,s.formatter,s.encodeValuesOnly,s.charset,c))}const h=a.join(s.delimiter);let d=s.addQueryPrefix===!0?"?":"";return s.charsetSentinel&&(s.charset==="iso-8859-1"?d+="utf8=%26%2310003%3B&":d+="utf8=%E2%9C%93&"),h.length>0?d+h:""}const Ao="4.76.3";let o0=!1,ic,Lb,Tb,op,jb,Ib,Rb,Ob,Mb;function mN(i,e={auto:!1}){if(o0)throw new Error(`you must \`import 'openai/shims/${i.kind}'\` before importing anything else from openai`);if(ic)throw new Error(`can't \`import 'openai/shims/${i.kind}'\` after \`import 'openai/shims/${ic}'\``);o0=e.auto,ic=i.kind,Lb=i.fetch,Tb=i.FormData,op=i.File,jb=i.ReadableStream,Ib=i.getMultipartRequestOptions,Rb=i.getDefaultAgent,Ob=i.fileFromPath,Mb=i.isFsReadStream}class gN{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function bN({manuallyImported:i}={}){const e=i?"You may need to use polyfills":"Add one of these imports before your first `import â€¦ from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let t,s,n,r;try{t=fetch,s=Request,n=Response,r=Headers}catch(a){throw new Error(`this environment is missing the following Web Fetch API type: ${a.message}. ${e}`)}return{kind:"web",fetch:t,Request:s,Response:n,Headers:r,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(a,o)=>({...o,body:new gN(a)}),getDefaultAgent:a=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:a=>!1}}ic||mN(bN(),{auto:!0});class At extends Error{}class Us extends At{constructor(e,t,s,n){super(`${Us.makeMessage(e,t,s)}`),this.status=e,this.headers=n,this.request_id=n?.["x-request-id"],this.error=t;const r=t;this.code=r?.code,this.param=r?.param,this.type=r?.type}static makeMessage(e,t,s){const n=t?.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):s;return e&&n?`${e} ${n}`:e?`${e} status code (no body)`:n||"(no status code or body)"}static generate(e,t,s,n){if(!e||!n)return new td({message:s,cause:cp(t)});const r=t?.error;return e===400?new Fb(e,r,s,n):e===401?new Db(e,r,s,n):e===403?new Bb(e,r,s,n):e===404?new $b(e,r,s,n):e===409?new qb(e,r,s,n):e===422?new Ub(e,r,s,n):e===429?new zb(e,r,s,n):e>=500?new Hb(e,r,s,n):new Us(e,r,s,n)}}class pi extends Us{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class td extends Us{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class Kp extends td{constructor({message:e}={}){super({message:e??"Request timed out."})}}class Fb extends Us{}class Db extends Us{}class Bb extends Us{}class $b extends Us{}class qb extends Us{}class Ub extends Us{}class zb extends Us{}class Hb extends Us{}class Wb extends At{constructor(){super("Could not parse response content as the length limit was reached")}}class Vb extends At{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class Ca{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];const s=Ca.NEWLINE_CHARS.has(t[t.length-1]||"");let n=t.split(Ca.NEWLINE_REGEXP);return s&&n.pop(),n.length===1&&!s?(this.buffer.push(n[0]),[]):(this.buffer.length>0&&(n=[this.buffer.join("")+n[0],...n.slice(1)],this.buffer=[]),s||(this.buffer=[n.pop()||""]),n)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new At(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new At(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new At("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}Ca.NEWLINE_CHARS=new Set([`
`,"\r"]);Ca.NEWLINE_REGEXP=/\r\n|[\n\r]/g;class $i{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let s=!1;async function*n(){if(s)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let r=!1;try{for await(const a of yN(e,t))if(!r){if(a.data.startsWith("[DONE]")){r=!0;continue}if(a.event===null){let o;try{o=JSON.parse(a.data)}catch(l){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),l}if(o&&o.error)throw new Us(void 0,o.error,void 0,void 0);yield o}else{let o;try{o=JSON.parse(a.data)}catch(l){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),l}if(a.event=="error")throw new Us(void 0,o.error,o.message,void 0);yield{event:a.event,data:o}}}r=!0}catch(a){if(a instanceof Error&&a.name==="AbortError")return;throw a}finally{r||t.abort()}}return new $i(n,t)}static fromReadableStream(e,t){let s=!1;async function*n(){const a=new Ca,o=Gb(e);for await(const l of o)for(const c of a.decode(l))yield c;for(const l of a.flush())yield l}async function*r(){if(s)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let a=!1;try{for await(const o of n())a||o&&(yield JSON.parse(o));a=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{a||t.abort()}}return new $i(r,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],s=this.iterator(),n=r=>({next:()=>{if(r.length===0){const a=s.next();e.push(a),t.push(a)}return r.shift()}});return[new $i(()=>n(e),this.controller),new $i(()=>n(t),this.controller)]}toReadableStream(){const e=this;let t;const s=new TextEncoder;return new jb({async start(){t=e[Symbol.asyncIterator]()},async pull(n){try{const{value:r,done:a}=await t.next();if(a)return n.close();const o=s.encode(JSON.stringify(r)+`
`);n.enqueue(o)}catch(r){n.error(r)}},async cancel(){await t.return?.()}})}}async function*yN(i,e){if(!i.body)throw e.abort(),new At("Attempted to iterate over a response with no body");const t=new xN,s=new Ca,n=Gb(i.body);for await(const r of vN(n))for(const a of s.decode(r)){const o=t.decode(a);o&&(yield o)}for(const r of s.flush()){const a=t.decode(r);a&&(yield a)}}async function*vN(i){let e=new Uint8Array;for await(const t of i){if(t==null)continue;const s=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let n=new Uint8Array(e.length+s.length);n.set(e),n.set(s,e.length),e=n;let r;for(;(r=wN(e))!==-1;)yield e.slice(0,r),e=e.slice(r)}e.length>0&&(yield e)}function wN(i){for(let s=0;s<i.length-2;s++){if(i[s]===10&&i[s+1]===10||i[s]===13&&i[s+1]===13)return s+2;if(i[s]===13&&i[s+1]===10&&s+3<i.length&&i[s+2]===13&&i[s+3]===10)return s+4}return-1}class xN{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const r={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],r}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,s,n]=_N(e,":");return n.startsWith(" ")&&(n=n.substring(1)),t==="event"?this.event=n:t==="data"&&this.data.push(n),null}}function _N(i,e){const t=i.indexOf(e);return t!==-1?[i.substring(0,t),e,i.substring(t+e.length)]:[i,"",""]}function Gb(i){if(i[Symbol.asyncIterator])return i;const e=i.getReader();return{async next(){try{const t=await e.read();return t?.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const Xb=i=>i!=null&&typeof i=="object"&&typeof i.url=="string"&&typeof i.blob=="function",Yb=i=>i!=null&&typeof i=="object"&&typeof i.name=="string"&&typeof i.lastModified=="number"&&sd(i),sd=i=>i!=null&&typeof i=="object"&&typeof i.size=="number"&&typeof i.type=="string"&&typeof i.text=="function"&&typeof i.slice=="function"&&typeof i.arrayBuffer=="function",AN=i=>Yb(i)||Xb(i)||Mb(i);async function Kb(i,e,t){if(i=await i,Yb(i))return i;if(Xb(i)){const n=await i.blob();e||(e=new URL(i.url).pathname.split(/[\\/]/).pop()??"unknown_file");const r=sd(n)?[await n.arrayBuffer()]:[n];return new op(r,e,t)}const s=await SN(i);if(e||(e=EN(i)??"unknown_file"),!t?.type){const n=s[0]?.type;typeof n=="string"&&(t={...t,type:n})}return new op(s,e,t)}async function SN(i){let e=[];if(typeof i=="string"||ArrayBuffer.isView(i)||i instanceof ArrayBuffer)e.push(i);else if(sd(i))e.push(await i.arrayBuffer());else if(kN(i))for await(const t of i)e.push(t);else throw new Error(`Unexpected data type: ${typeof i}; constructor: ${i?.constructor?.name}; props: ${NN(i)}`);return e}function NN(i){return`[${Object.getOwnPropertyNames(i).map(t=>`"${t}"`).join(", ")}]`}function EN(i){return vf(i.name)||vf(i.filename)||vf(i.path)?.split(/[\\/]/).pop()}const vf=i=>{if(typeof i=="string")return i;if(typeof Buffer<"u"&&i instanceof Buffer)return String(i)},kN=i=>i!=null&&typeof i=="object"&&typeof i[Symbol.asyncIterator]=="function",l0=i=>i&&typeof i=="object"&&i.body&&i[Symbol.toStringTag]==="MultipartBody",Wo=async i=>{const e=await CN(i.body);return Ib(e,i)},CN=async i=>{const e=new Tb;return await Promise.all(Object.entries(i||{}).map(([t,s])=>lp(e,t,s))),e},lp=async(i,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")i.append(e,String(t));else if(AN(t)){const s=await Kb(t);i.append(e,s)}else if(Array.isArray(t))await Promise.all(t.map(s=>lp(i,e+"[]",s)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([s,n])=>lp(i,`${e}[${s}]`,n)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}};var Jb={},PN=function(i,e,t,s,n){if(typeof e=="function"?i!==e||!n:!e.has(i))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(i,t),t},LN=function(i,e,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?i!==e||!s:!e.has(i))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(i):s?s.value:e.get(i)},Gh;async function Zb(i){const{response:e}=i;if(i.options.stream)return Fo("response",e.status,e.url,e.headers,e.body),i.options.__streamClass?i.options.__streamClass.fromSSEResponse(e,i.controller):$i.fromSSEResponse(e,i.controller);if(e.status===204)return null;if(i.options.__binaryResponse)return e;const t=e.headers.get("content-type");if(t?.includes("application/json")||t?.includes("application/vnd.api+json")){const r=await e.json();return Fo("response",e.status,e.url,e.headers,r),Qb(r,e)}const n=await e.text();return Fo("response",e.status,e.url,e.headers,n),n}function Qb(i,e){return!i||typeof i!="object"||Array.isArray(i)?i:Object.defineProperty(i,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class nd extends Promise{constructor(e,t=Zb){super(s=>{s(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new nd(this.responsePromise,async t=>Qb(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class TN{constructor({baseURL:e,maxRetries:t=2,timeout:s=6e5,httpAgent:n,fetch:r}){this.baseURL=e,this.maxRetries=wf("maxRetries",t),this.timeout=wf("timeout",s),this.httpAgent=n,this.fetch=r??Lb}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...FN(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${qN()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,s){return this.request(Promise.resolve(s).then(async n=>{const r=n&&sd(n?.body)?new DataView(await n.body.arrayBuffer()):n?.body instanceof DataView?n.body:n?.body instanceof ArrayBuffer?new DataView(n.body):n&&ArrayBuffer.isView(n?.body)?new DataView(n.body.buffer):n?.body;return{method:e,path:t,...n,body:r}}))}getAPIList(e,t,s){return this.requestAPIList(t,{method:"get",path:e,...s})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){const{method:s,path:n,query:r,headers:a={}}=e,o=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:l0(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,l=this.calculateContentLength(o),c=this.buildURL(n,r);"timeout"in e&&wf("timeout",e.timeout);const h=e.timeout??this.timeout,d=e.httpAgent??this.httpAgent??Rb(c),p=h+1e3;typeof d?.options?.timeout=="number"&&p>(d.options.timeout??0)&&(d.options.timeout=p),this.idempotencyHeader&&s!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const f=this.buildHeaders({options:e,headers:a,contentLength:l,retryCount:t});return{req:{method:s,...o&&{body:o},headers:f,...d&&{agent:d},signal:e.signal??null},url:c,timeout:h}}buildHeaders({options:e,headers:t,contentLength:s,retryCount:n}){const r={};s&&(r["content-length"]=s);const a=this.defaultHeaders(e);return d0(r,a),d0(r,t),l0(e.body)&&ic!=="node"&&delete r["content-type"],f0(a,"x-stainless-retry-count")===void 0&&f0(t,"x-stainless-retry-count")===void 0&&(r["x-stainless-retry-count"]=String(n)),this.validateHeaders(r,t),r}async prepareOptions(e){}async prepareRequest(e,{url:t,options:s}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,s,n){return Us.generate(e,t,s,n)}request(e,t=null){return new nd(this.makeRequest(e,t))}async makeRequest(e,t){const s=await e,n=s.maxRetries??this.maxRetries;t==null&&(t=n),await this.prepareOptions(s);const{req:r,url:a,timeout:o}=this.buildRequest(s,{retryCount:n-t});if(await this.prepareRequest(r,{url:a,options:s}),Fo("request",a,s,r.headers),s.signal?.aborted)throw new pi;const l=new AbortController,c=await this.fetchWithTimeout(a,r,o,l).catch(cp);if(c instanceof Error){if(s.signal?.aborted)throw new pi;if(t)return this.retryRequest(s,t);throw c.name==="AbortError"?new Kp:new td({cause:c})}const h=IN(c.headers);if(!c.ok){if(t&&this.shouldRetry(c)){const A=`retrying, ${t} attempts remaining`;return Fo(`response (error; ${A})`,c.status,a,h),this.retryRequest(s,t,h)}const d=await c.text().catch(A=>cp(A).message),p=DN(d),f=p?void 0:d;throw Fo(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,c.status,a,h,f),this.makeStatusError(c.status,p,f,h)}return{response:c,options:s,controller:l}}requestAPIList(e,t){const s=this.makeRequest(t,null);return new jN(this,s,e)}buildURL(e,t){const s=$N(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),n=this.defaultQuery();return t2(n)||(t={...n,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(s.search=this.stringifyQuery(t)),s.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,s])=>typeof s<"u").map(([t,s])=>{if(typeof s=="string"||typeof s=="number"||typeof s=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(s)}`;if(s===null)return`${encodeURIComponent(t)}=`;throw new At(`Cannot stringify type ${typeof s}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,s,n){const{signal:r,...a}=t||{};r&&r.addEventListener("abort",()=>n.abort());const o=setTimeout(()=>n.abort(),s);return this.fetch.call(void 0,e,{signal:n.signal,...a}).finally(()=>{clearTimeout(o)})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,s){let n;const r=s?.["retry-after-ms"];if(r){const o=parseFloat(r);Number.isNaN(o)||(n=o)}const a=s?.["retry-after"];if(a&&!n){const o=parseFloat(a);Number.isNaN(o)?n=Date.parse(a)-Date.now():n=o*1e3}if(!(n&&0<=n&&n<60*1e3)){const o=e.maxRetries??this.maxRetries;n=this.calculateDefaultRetryTimeoutMillis(t,o)}return await Dc(n),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const r=t-e,a=Math.min(.5*Math.pow(2,r),8),o=1-Math.random()*.25;return a*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Ao}`}}class e2{constructor(e,t,s,n){Gh.set(this,void 0),PN(this,Gh,e),this.options=n,this.response=t,this.body=s}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new At("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&typeof t.query=="object")t.query={...t.query,...e.params};else if("url"in e){const s=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[n,r]of s)e.url.searchParams.set(n,r);t.query=void 0,t.path=e.url.toString()}return await LN(this,Gh,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Gh=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class jN extends nd{constructor(e,t,s){super(t,async n=>new s(e,n.response,await Zb(n),n.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}}const IN=i=>new Proxy(Object.fromEntries(i.entries()),{get(e,t){const s=t.toString();return e[s.toLowerCase()]||e[s]}}),RN={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},xn=i=>typeof i=="object"&&i!==null&&!t2(i)&&Object.keys(i).every(e=>s2(RN,e)),ON=()=>{if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ao,"X-Stainless-OS":h0(Deno.build.os),"X-Stainless-Arch":c0(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:Deno.version?.deno??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ao,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ao,"X-Stainless-OS":h0(process.platform),"X-Stainless-Arch":c0(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const i=MN();return i?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ao,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${i.browser}`,"X-Stainless-Runtime-Version":i.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ao,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function MN(){if(typeof navigator>"u"||!navigator)return null;const i=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of i){const s=t.exec(navigator.userAgent);if(s){const n=s[1]||0,r=s[2]||0,a=s[3]||0;return{browser:e,version:`${n}.${r}.${a}`}}}return null}const c0=i=>i==="x32"?"x32":i==="x86_64"||i==="x64"?"x64":i==="arm"?"arm":i==="aarch64"||i==="arm64"?"arm64":i?`other:${i}`:"unknown",h0=i=>(i=i.toLowerCase(),i.includes("ios")?"iOS":i==="android"?"Android":i==="darwin"?"MacOS":i==="win32"?"Windows":i==="freebsd"?"FreeBSD":i==="openbsd"?"OpenBSD":i==="linux"?"Linux":i?`Other:${i}`:"Unknown");let u0;const FN=()=>u0??(u0=ON()),DN=i=>{try{return JSON.parse(i)}catch{return}},BN=/^[a-z][a-z0-9+.-]*:/i,$N=i=>BN.test(i),Dc=i=>new Promise(e=>setTimeout(e,i)),wf=(i,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new At(`${i} must be an integer`);if(e<0)throw new At(`${i} must be a positive integer`);return e},cp=i=>{if(i instanceof Error)return i;if(typeof i=="object"&&i!==null)try{return new Error(JSON.stringify(i))}catch{}return new Error(i)},Xh=i=>{if(typeof process<"u")return Jb?.[i]?.trim()??void 0;if(typeof Deno<"u")return Deno.env?.get?.(i)?.trim()};function t2(i){if(!i)return!0;for(const e in i)return!1;return!0}function s2(i,e){return Object.prototype.hasOwnProperty.call(i,e)}function d0(i,e){for(const t in e){if(!s2(e,t))continue;const s=t.toLowerCase();if(!s)continue;const n=e[t];n===null?delete i[s]:n!==void 0&&(i[s]=n)}}function Fo(i,...e){typeof process<"u"&&Jb?.DEBUG==="true"&&console.log(`OpenAI:DEBUG:${i}`,...e)}const qN=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,i=>{const e=Math.random()*16|0;return(i==="x"?e:e&3|8).toString(16)}),UN=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",zN=i=>typeof i?.get=="function",f0=(i,e)=>{const t=e.toLowerCase();if(zN(i)){const s=e[0]?.toUpperCase()+e.substring(1).replace(/([^\w])(\w)/g,(n,r,a)=>r+a.toUpperCase());for(const n of[e,t,e.toUpperCase(),s]){const r=i.get(n);if(r)return r}}for(const[s,n]of Object.entries(i))if(s.toLowerCase()===t)return Array.isArray(n)?(n.length<=1||console.warn(`Received ${n.length} entries for the ${e} header, using the first entry.`),n[0]):n};function xf(i){return i!=null&&typeof i=="object"&&!Array.isArray(i)}class HN extends e2{constructor(e,t,s,n){super(e,t,s,n),this.data=s.data||[],this.object=s.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class xi extends e2{constructor(e,t,s,n){super(e,t,s,n),this.data=s.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){const e=this.getPaginatedItems();if(!e.length)return null;const t=e[e.length-1]?.id;return t?{params:{after:t}}:null}}class $t{constructor(e){this._client=e}}let n2=class extends $t{create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}},Jp=class extends $t{constructor(){super(...arguments),this.completions=new n2(this._client)}};Jp.Completions=n2;class i2 extends $t{create(e,t){return this._client.post("/audio/speech",{body:e,...t,__binaryResponse:!0})}}class r2 extends $t{create(e,t){return this._client.post("/audio/transcriptions",Wo({body:e,...t}))}}class a2 extends $t{create(e,t){return this._client.post("/audio/translations",Wo({body:e,...t}))}}class Bc extends $t{constructor(){super(...arguments),this.transcriptions=new r2(this._client),this.translations=new a2(this._client),this.speech=new i2(this._client)}}Bc.Transcriptions=r2;Bc.Translations=a2;Bc.Speech=i2;class Zp extends $t{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return xn(e)?this.list({},e):this._client.getAPIList("/batches",Qp,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}}class Qp extends xi{}Zp.BatchesPage=Qp;class em extends $t{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,s){return this._client.post(`/assistants/${e}`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}list(e={},t){return xn(e)?this.list({},e):this._client.getAPIList("/assistants",tm,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class tm extends xi{}em.AssistantsPage=tm;function p0(i){return typeof i.parse=="function"}const Do=i=>i?.role==="assistant",o2=i=>i?.role==="function",l2=i=>i?.role==="tool";var oi=function(i,e,t,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?i!==e||!n:!e.has(i))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(i,t):n?n.value=t:e.set(i,t),t},ss=function(i,e,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?i!==e||!s:!e.has(i))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(i):s?s.value:e.get(i)},hp,au,ou,Vl,Gl,lu,Xl,cr,Yl,Eu,ku,So,c2;class h2{constructor(){hp.add(this),this.controller=new AbortController,au.set(this,void 0),ou.set(this,()=>{}),Vl.set(this,()=>{}),Gl.set(this,void 0),lu.set(this,()=>{}),Xl.set(this,()=>{}),cr.set(this,{}),Yl.set(this,!1),Eu.set(this,!1),ku.set(this,!1),So.set(this,!1),oi(this,au,new Promise((e,t)=>{oi(this,ou,e,"f"),oi(this,Vl,t,"f")}),"f"),oi(this,Gl,new Promise((e,t)=>{oi(this,lu,e,"f"),oi(this,Xl,t,"f")}),"f"),ss(this,au,"f").catch(()=>{}),ss(this,Gl,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},ss(this,hp,"m",c2).bind(this))},0)}_connected(){this.ended||(ss(this,ou,"f").call(this),this._emit("connect"))}get ended(){return ss(this,Yl,"f")}get errored(){return ss(this,Eu,"f")}get aborted(){return ss(this,ku,"f")}abort(){this.controller.abort()}on(e,t){return(ss(this,cr,"f")[e]||(ss(this,cr,"f")[e]=[])).push({listener:t}),this}off(e,t){const s=ss(this,cr,"f")[e];if(!s)return this;const n=s.findIndex(r=>r.listener===t);return n>=0&&s.splice(n,1),this}once(e,t){return(ss(this,cr,"f")[e]||(ss(this,cr,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,s)=>{oi(this,So,!0,"f"),e!=="error"&&this.once("error",s),this.once(e,t)})}async done(){oi(this,So,!0,"f"),await ss(this,Gl,"f")}_emit(e,...t){if(ss(this,Yl,"f"))return;e==="end"&&(oi(this,Yl,!0,"f"),ss(this,lu,"f").call(this));const s=ss(this,cr,"f")[e];if(s&&(ss(this,cr,"f")[e]=s.filter(n=>!n.once),s.forEach(({listener:n})=>n(...t))),e==="abort"){const n=t[0];!ss(this,So,"f")&&!s?.length&&Promise.reject(n),ss(this,Vl,"f").call(this,n),ss(this,Xl,"f").call(this,n),this._emit("end");return}if(e==="error"){const n=t[0];!ss(this,So,"f")&&!s?.length&&Promise.reject(n),ss(this,Vl,"f").call(this,n),ss(this,Xl,"f").call(this,n),this._emit("end")}}_emitFinal(){}}au=new WeakMap,ou=new WeakMap,Vl=new WeakMap,Gl=new WeakMap,lu=new WeakMap,Xl=new WeakMap,cr=new WeakMap,Yl=new WeakMap,Eu=new WeakMap,ku=new WeakMap,So=new WeakMap,hp=new WeakSet,c2=function(e){if(oi(this,Eu,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new pi),e instanceof pi)return oi(this,ku,!0,"f"),this._emit("abort",e);if(e instanceof At)return this._emit("error",e);if(e instanceof Error){const t=new At(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new At(String(e)))};function u2(i){return i?.$brand==="auto-parseable-response-format"}function $c(i){return i?.$brand==="auto-parseable-tool"}function WN(i,e){return!e||!d2(e)?{...i,choices:i.choices.map(t=>({...t,message:{...t.message,parsed:null,tool_calls:t.message.tool_calls??[]}}))}:sm(i,e)}function sm(i,e){const t=i.choices.map(s=>{if(s.finish_reason==="length")throw new Wb;if(s.finish_reason==="content_filter")throw new Vb;return{...s,message:{...s.message,tool_calls:s.message.tool_calls?.map(n=>GN(e,n))??[],parsed:s.message.content&&!s.message.refusal?VN(e,s.message.content):null}}});return{...i,choices:t}}function VN(i,e){return i.response_format?.type!=="json_schema"?null:i.response_format?.type==="json_schema"?"$parseRaw"in i.response_format?i.response_format.$parseRaw(e):JSON.parse(e):null}function GN(i,e){const t=i.tools?.find(s=>s.function?.name===e.function.name);return{...e,function:{...e.function,parsed_arguments:$c(t)?t.$parseRaw(e.function.arguments):t?.function.strict?JSON.parse(e.function.arguments):null}}}function XN(i,e){if(!i)return!1;const t=i.tools?.find(s=>s.function?.name===e.function.name);return $c(t)||t?.function.strict||!1}function d2(i){return u2(i.response_format)?!0:i.tools?.some(e=>$c(e)||e.type==="function"&&e.function.strict===!0)??!1}function YN(i){for(const e of i??[]){if(e.type!=="function")throw new At(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new At(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var yn=function(i,e,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?i!==e||!s:!e.has(i))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(i):s?s.value:e.get(i)},Js,up,Cu,dp,fp,pp,f2,mp;const m0=10;class p2 extends h2{constructor(){super(...arguments),Js.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=e.choices[0]?.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),(o2(e)||l2(e))&&e.content)this._emit("functionCallResult",e.content);else if(Do(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(Do(e)&&e.tool_calls)for(const s of e.tool_calls)s.type==="function"&&this._emit("functionCall",s.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new At("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),yn(this,Js,"m",up).call(this)}async finalMessage(){return await this.done(),yn(this,Js,"m",Cu).call(this)}async finalFunctionCall(){return await this.done(),yn(this,Js,"m",dp).call(this)}async finalFunctionCallResult(){return await this.done(),yn(this,Js,"m",fp).call(this)}async totalUsage(){return await this.done(),yn(this,Js,"m",pp).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=yn(this,Js,"m",Cu).call(this);t&&this._emit("finalMessage",t);const s=yn(this,Js,"m",up).call(this);s&&this._emit("finalContent",s);const n=yn(this,Js,"m",dp).call(this);n&&this._emit("finalFunctionCall",n);const r=yn(this,Js,"m",fp).call(this);r!=null&&this._emit("finalFunctionCallResult",r),this._chatCompletions.some(a=>a.usage)&&this._emit("totalUsage",yn(this,Js,"m",pp).call(this))}async _createChatCompletion(e,t,s){const n=s?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),yn(this,Js,"m",f2).call(this,t);const r=await e.chat.completions.create({...t,stream:!1},{...s,signal:this.controller.signal});return this._connected(),this._addChatCompletion(sm(r,t))}async _runChatCompletion(e,t,s){for(const n of t.messages)this._addMessage(n,!1);return await this._createChatCompletion(e,t,s)}async _runFunctions(e,t,s){const n="function",{function_call:r="auto",stream:a,...o}=t,l=typeof r!="string"&&r?.name,{maxChatCompletions:c=m0}=s||{},h={};for(const p of t.functions)h[p.name||p.function.name]=p;const d=t.functions.map(p=>({name:p.name||p.function.name,parameters:p.parameters,description:p.description}));for(const p of t.messages)this._addMessage(p,!1);for(let p=0;p<c;++p){const v=(await this._createChatCompletion(e,{...o,function_call:r,functions:d,messages:[...this.messages]},s)).choices[0]?.message;if(!v)throw new At("missing message in ChatCompletion response");if(!v.function_call)return;const{name:w,arguments:A}=v.function_call,x=h[w];if(x){if(l&&l!==w){const B=`Invalid function_call: ${JSON.stringify(w)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:n,name:w,content:B});continue}}else{const B=`Invalid function_call: ${JSON.stringify(w)}. Available options are: ${d.map(Q=>JSON.stringify(Q.name)).join(", ")}. Please try again`;this._addMessage({role:n,name:w,content:B});continue}let S;try{S=p0(x)?await x.parse(A):A}catch(B){this._addMessage({role:n,name:w,content:B instanceof Error?B.message:String(B)});continue}const j=await x.function(S,this),M=yn(this,Js,"m",mp).call(this,j);if(this._addMessage({role:n,name:w,content:M}),l)return}}async _runTools(e,t,s){const n="tool",{tool_choice:r="auto",stream:a,...o}=t,l=typeof r!="string"&&r?.function?.name,{maxChatCompletions:c=m0}=s||{},h=t.tools.map(f=>{if($c(f)){if(!f.$callback)throw new At("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:f.$callback,name:f.function.name,description:f.function.description||"",parameters:f.function.parameters,parse:f.$parseRaw,strict:!0}}}return f}),d={};for(const f of h)f.type==="function"&&(d[f.function.name||f.function.function.name]=f.function);const p="tools"in t?h.map(f=>f.type==="function"?{type:"function",function:{name:f.function.name||f.function.function.name,parameters:f.function.parameters,description:f.function.description,strict:f.function.strict}}:f):void 0;for(const f of t.messages)this._addMessage(f,!1);for(let f=0;f<c;++f){const w=(await this._createChatCompletion(e,{...o,tool_choice:r,tools:p,messages:[...this.messages]},s)).choices[0]?.message;if(!w)throw new At("missing message in ChatCompletion response");if(!w.tool_calls?.length)return;for(const A of w.tool_calls){if(A.type!=="function")continue;const x=A.id,{name:S,arguments:j}=A.function,M=d[S];if(M){if(l&&l!==S){const O=`Invalid tool_call: ${JSON.stringify(S)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:n,tool_call_id:x,content:O});continue}}else{const O=`Invalid tool_call: ${JSON.stringify(S)}. Available options are: ${Object.keys(d).map(G=>JSON.stringify(G)).join(", ")}. Please try again`;this._addMessage({role:n,tool_call_id:x,content:O});continue}let B;try{B=p0(M)?await M.parse(j):j}catch(O){const G=O instanceof Error?O.message:String(O);this._addMessage({role:n,tool_call_id:x,content:G});continue}const Q=await M.function(B,this),q=yn(this,Js,"m",mp).call(this,Q);if(this._addMessage({role:n,tool_call_id:x,content:q}),l)return}}}}Js=new WeakSet,up=function(){return yn(this,Js,"m",Cu).call(this).content??null},Cu=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(Do(t)){const{function_call:s,...n}=t,r={...n,content:t.content??null,refusal:t.refusal??null};return s&&(r.function_call=s),r}}throw new At("stream ended without producing a ChatCompletionMessage with role=assistant")},dp=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(Do(t)&&t?.function_call)return t.function_call;if(Do(t)&&t?.tool_calls?.length)return t.tool_calls.at(-1)?.function}},fp=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(o2(t)&&t.content!=null||l2(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(s=>s.role==="assistant"&&s.tool_calls?.some(n=>n.type==="function"&&n.id===t.tool_call_id)))return t.content}},pp=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},f2=function(e){if(e.n!=null&&e.n>1)throw new At("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},mp=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class kc extends p2{static runFunctions(e,t,s){const n=new kc,r={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return n._run(()=>n._runFunctions(e,t,r)),n}static runTools(e,t,s){const n=new kc,r={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runTools"}};return n._run(()=>n._runTools(e,t,r)),n}_addMessage(e,t=!0){super._addMessage(e,t),Do(e)&&e.content&&this._emit("content",e.content)}}const m2=1,g2=2,b2=4,y2=8,v2=16,w2=32,x2=64,_2=128,A2=256,S2=_2|A2,N2=v2|w2|S2|x2,E2=m2|g2|N2,k2=b2|y2,KN=E2|k2,Rs={STR:m2,NUM:g2,ARR:b2,OBJ:y2,NULL:v2,BOOL:w2,NAN:x2,INFINITY:_2,MINUS_INFINITY:A2,INF:S2,SPECIAL:N2,ATOM:E2,COLLECTION:k2,ALL:KN};class JN extends Error{}class ZN extends Error{}function QN(i,e=Rs.ALL){if(typeof i!="string")throw new TypeError(`expecting str, got ${typeof i}`);if(!i.trim())throw new Error(`${i} is empty`);return eE(i.trim(),e)}const eE=(i,e)=>{const t=i.length;let s=0;const n=p=>{throw new JN(`${p} at position ${s}`)},r=p=>{throw new ZN(`${p} at position ${s}`)},a=()=>(d(),s>=t&&n("Unexpected end of input"),i[s]==='"'?o():i[s]==="{"?l():i[s]==="["?c():i.substring(s,s+4)==="null"||Rs.NULL&e&&t-s<4&&"null".startsWith(i.substring(s))?(s+=4,null):i.substring(s,s+4)==="true"||Rs.BOOL&e&&t-s<4&&"true".startsWith(i.substring(s))?(s+=4,!0):i.substring(s,s+5)==="false"||Rs.BOOL&e&&t-s<5&&"false".startsWith(i.substring(s))?(s+=5,!1):i.substring(s,s+8)==="Infinity"||Rs.INFINITY&e&&t-s<8&&"Infinity".startsWith(i.substring(s))?(s+=8,1/0):i.substring(s,s+9)==="-Infinity"||Rs.MINUS_INFINITY&e&&1<t-s&&t-s<9&&"-Infinity".startsWith(i.substring(s))?(s+=9,-1/0):i.substring(s,s+3)==="NaN"||Rs.NAN&e&&t-s<3&&"NaN".startsWith(i.substring(s))?(s+=3,NaN):h()),o=()=>{const p=s;let f=!1;for(s++;s<t&&(i[s]!=='"'||f&&i[s-1]==="\\");)f=i[s]==="\\"?!f:!1,s++;if(i.charAt(s)=='"')try{return JSON.parse(i.substring(p,++s-Number(f)))}catch(v){r(String(v))}else if(Rs.STR&e)try{return JSON.parse(i.substring(p,s-Number(f))+'"')}catch{return JSON.parse(i.substring(p,i.lastIndexOf("\\"))+'"')}n("Unterminated string literal")},l=()=>{s++,d();const p={};try{for(;i[s]!=="}";){if(d(),s>=t&&Rs.OBJ&e)return p;const f=o();d(),s++;try{const v=a();Object.defineProperty(p,f,{value:v,writable:!0,enumerable:!0,configurable:!0})}catch(v){if(Rs.OBJ&e)return p;throw v}d(),i[s]===","&&s++}}catch{if(Rs.OBJ&e)return p;n("Expected '}' at end of object")}return s++,p},c=()=>{s++;const p=[];try{for(;i[s]!=="]";)p.push(a()),d(),i[s]===","&&s++}catch{if(Rs.ARR&e)return p;n("Expected ']' at end of array")}return s++,p},h=()=>{if(s===0){i==="-"&&Rs.NUM&e&&n("Not sure what '-' is");try{return JSON.parse(i)}catch(f){if(Rs.NUM&e)try{return i[i.length-1]==="."?JSON.parse(i.substring(0,i.lastIndexOf("."))):JSON.parse(i.substring(0,i.lastIndexOf("e")))}catch{}r(String(f))}}const p=s;for(i[s]==="-"&&s++;i[s]&&!",]}".includes(i[s]);)s++;s==t&&!(Rs.NUM&e)&&n("Unterminated number literal");try{return JSON.parse(i.substring(p,s))}catch{i.substring(p,s)==="-"&&Rs.NUM&e&&n("Not sure what '-' is");try{return JSON.parse(i.substring(p,i.lastIndexOf("e")))}catch(v){r(String(v))}}},d=()=>{for(;s<t&&` 
\r	`.includes(i[s]);)s++};return a()},g0=i=>QN(i,Rs.ALL^Rs.NUM);var bo=function(i,e,t,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?i!==e||!n:!e.has(i))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(i,t):n?n.value=t:e.set(i,t),t},zt=function(i,e,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?i!==e||!s:!e.has(i))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(i):s?s.value:e.get(i)},Ns,ar,yo,Ir,_f,Yh,Af,Sf,Nf,Kh,Ef,b0;class Cc extends p2{constructor(e){super(),Ns.add(this),ar.set(this,void 0),yo.set(this,void 0),Ir.set(this,void 0),bo(this,ar,e,"f"),bo(this,yo,[],"f")}get currentChatCompletionSnapshot(){return zt(this,Ir,"f")}static fromReadableStream(e){const t=new Cc(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,s){const n=new Cc(t);return n._run(()=>n._runChatCompletion(e,{...t,stream:!0},{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),n}async _createChatCompletion(e,t,s){super._createChatCompletion;const n=s?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),zt(this,Ns,"m",_f).call(this);const r=await e.chat.completions.create({...t,stream:!0},{...s,signal:this.controller.signal});this._connected();for await(const a of r)zt(this,Ns,"m",Af).call(this,a);if(r.controller.signal?.aborted)throw new pi;return this._addChatCompletion(zt(this,Ns,"m",Kh).call(this))}async _fromReadableStream(e,t){const s=t?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),zt(this,Ns,"m",_f).call(this),this._connected();const n=$i.fromReadableStream(e,this.controller);let r;for await(const a of n)r&&r!==a.id&&this._addChatCompletion(zt(this,Ns,"m",Kh).call(this)),zt(this,Ns,"m",Af).call(this,a),r=a.id;if(n.controller.signal?.aborted)throw new pi;return this._addChatCompletion(zt(this,Ns,"m",Kh).call(this))}[(ar=new WeakMap,yo=new WeakMap,Ir=new WeakMap,Ns=new WeakSet,_f=function(){this.ended||bo(this,Ir,void 0,"f")},Yh=function(t){let s=zt(this,yo,"f")[t.index];return s||(s={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},zt(this,yo,"f")[t.index]=s,s)},Af=function(t){if(this.ended)return;const s=zt(this,Ns,"m",b0).call(this,t);this._emit("chunk",t,s);for(const n of t.choices){const r=s.choices[n.index];n.delta.content!=null&&r.message?.role==="assistant"&&r.message?.content&&(this._emit("content",n.delta.content,r.message.content),this._emit("content.delta",{delta:n.delta.content,snapshot:r.message.content,parsed:r.message.parsed})),n.delta.refusal!=null&&r.message?.role==="assistant"&&r.message?.refusal&&this._emit("refusal.delta",{delta:n.delta.refusal,snapshot:r.message.refusal}),n.logprobs?.content!=null&&r.message?.role==="assistant"&&this._emit("logprobs.content.delta",{content:n.logprobs?.content,snapshot:r.logprobs?.content??[]}),n.logprobs?.refusal!=null&&r.message?.role==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:n.logprobs?.refusal,snapshot:r.logprobs?.refusal??[]});const a=zt(this,Ns,"m",Yh).call(this,r);r.finish_reason&&(zt(this,Ns,"m",Nf).call(this,r),a.current_tool_call_index!=null&&zt(this,Ns,"m",Sf).call(this,r,a.current_tool_call_index));for(const o of n.delta.tool_calls??[])a.current_tool_call_index!==o.index&&(zt(this,Ns,"m",Nf).call(this,r),a.current_tool_call_index!=null&&zt(this,Ns,"m",Sf).call(this,r,a.current_tool_call_index)),a.current_tool_call_index=o.index;for(const o of n.delta.tool_calls??[]){const l=r.message.tool_calls?.[o.index];l?.type&&(l?.type==="function"?this._emit("tool_calls.function.arguments.delta",{name:l.function?.name,index:o.index,arguments:l.function.arguments,parsed_arguments:l.function.parsed_arguments,arguments_delta:o.function?.arguments??""}):(l?.type,void 0))}}},Sf=function(t,s){if(zt(this,Ns,"m",Yh).call(this,t).done_tool_calls.has(s))return;const r=t.message.tool_calls?.[s];if(!r)throw new Error("no tool call snapshot");if(!r.type)throw new Error("tool call snapshot missing `type`");if(r.type==="function"){const a=zt(this,ar,"f")?.tools?.find(o=>o.type==="function"&&o.function.name===r.function.name);this._emit("tool_calls.function.arguments.done",{name:r.function.name,index:s,arguments:r.function.arguments,parsed_arguments:$c(a)?a.$parseRaw(r.function.arguments):a?.function.strict?JSON.parse(r.function.arguments):null})}else r.type},Nf=function(t){const s=zt(this,Ns,"m",Yh).call(this,t);if(t.message.content&&!s.content_done){s.content_done=!0;const n=zt(this,Ns,"m",Ef).call(this);this._emit("content.done",{content:t.message.content,parsed:n?n.$parseRaw(t.message.content):null})}t.message.refusal&&!s.refusal_done&&(s.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),t.logprobs?.content&&!s.logprobs_content_done&&(s.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),t.logprobs?.refusal&&!s.logprobs_refusal_done&&(s.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},Kh=function(){if(this.ended)throw new At("stream has ended, this shouldn't happen");const t=zt(this,Ir,"f");if(!t)throw new At("request ended without sending any chunks");return bo(this,Ir,void 0,"f"),bo(this,yo,[],"f"),tE(t,zt(this,ar,"f"))},Ef=function(){const t=zt(this,ar,"f")?.response_format;return u2(t)?t:null},b0=function(t){var s,n,r,a;let o=zt(this,Ir,"f");const{choices:l,...c}=t;o?Object.assign(o,c):o=bo(this,Ir,{...c,choices:[]},"f");for(const{delta:h,finish_reason:d,index:p,logprobs:f=null,...v}of t.choices){let w=o.choices[p];if(w||(w=o.choices[p]={finish_reason:d,index:p,message:{},logprobs:f,...v}),f)if(!w.logprobs)w.logprobs=Object.assign({},f);else{const{content:Q,refusal:q,...O}=f;Object.assign(w.logprobs,O),Q&&((s=w.logprobs).content??(s.content=[]),w.logprobs.content.push(...Q)),q&&((n=w.logprobs).refusal??(n.refusal=[]),w.logprobs.refusal.push(...q))}if(d&&(w.finish_reason=d,zt(this,ar,"f")&&d2(zt(this,ar,"f")))){if(d==="length")throw new Wb;if(d==="content_filter")throw new Vb}if(Object.assign(w,v),!h)continue;const{content:A,refusal:x,function_call:S,role:j,tool_calls:M,...B}=h;if(Object.assign(w.message,B),x&&(w.message.refusal=(w.message.refusal||"")+x),j&&(w.message.role=j),S&&(w.message.function_call?(S.name&&(w.message.function_call.name=S.name),S.arguments&&((r=w.message.function_call).arguments??(r.arguments=""),w.message.function_call.arguments+=S.arguments)):w.message.function_call=S),A&&(w.message.content=(w.message.content||"")+A,!w.message.refusal&&zt(this,Ns,"m",Ef).call(this)&&(w.message.parsed=g0(w.message.content))),M){w.message.tool_calls||(w.message.tool_calls=[]);for(const{index:Q,id:q,type:O,function:G,...ie}of M){const L=(a=w.message.tool_calls)[Q]??(a[Q]={});Object.assign(L,ie),q&&(L.id=q),O&&(L.type=O),G&&(L.function??(L.function={name:G.name??"",arguments:""})),G?.name&&(L.function.name=G.name),G?.arguments&&(L.function.arguments+=G.arguments,XN(zt(this,ar,"f"),L)&&(L.function.parsed_arguments=g0(L.function.arguments)))}}}return o},Symbol.asyncIterator)](){const e=[],t=[];let s=!1;return this.on("chunk",n=>{const r=t.shift();r?r.resolve(n):e.push(n)}),this.on("end",()=>{s=!0;for(const n of t)n.resolve(void 0);t.length=0}),this.on("abort",n=>{s=!0;for(const r of t)r.reject(n);t.length=0}),this.on("error",n=>{s=!0;for(const r of t)r.reject(n);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((r,a)=>t.push({resolve:r,reject:a})).then(r=>r?{value:r,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new $i(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function tE(i,e){const{id:t,choices:s,created:n,model:r,system_fingerprint:a,...o}=i,l={...o,id:t,choices:s.map(({message:c,finish_reason:h,index:d,logprobs:p,...f})=>{if(!h)throw new At(`missing finish_reason for choice ${d}`);const{content:v=null,function_call:w,tool_calls:A,...x}=c,S=c.role;if(!S)throw new At(`missing role for choice ${d}`);if(w){const{arguments:j,name:M}=w;if(j==null)throw new At(`missing function_call.arguments for choice ${d}`);if(!M)throw new At(`missing function_call.name for choice ${d}`);return{...f,message:{content:v,function_call:{arguments:j,name:M},role:S,refusal:c.refusal??null},finish_reason:h,index:d,logprobs:p}}return A?{...f,index:d,finish_reason:h,logprobs:p,message:{...x,role:S,content:v,refusal:c.refusal??null,tool_calls:A.map((j,M)=>{const{function:B,type:Q,id:q,...O}=j,{arguments:G,name:ie,...L}=B||{};if(q==null)throw new At(`missing choices[${d}].tool_calls[${M}].id
${Jh(i)}`);if(Q==null)throw new At(`missing choices[${d}].tool_calls[${M}].type
${Jh(i)}`);if(ie==null)throw new At(`missing choices[${d}].tool_calls[${M}].function.name
${Jh(i)}`);if(G==null)throw new At(`missing choices[${d}].tool_calls[${M}].function.arguments
${Jh(i)}`);return{...O,id:q,type:Q,function:{...L,name:ie,arguments:G}}})}}:{...f,message:{...x,content:v,role:S,refusal:c.refusal??null},finish_reason:h,index:d,logprobs:p}}),created:n,model:r,object:"chat.completion",...a?{system_fingerprint:a}:{}};return WN(l,e)}function Jh(i){return JSON.stringify(i)}class Bo extends Cc{static fromReadableStream(e){const t=new Bo(null);return t._run(()=>t._fromReadableStream(e)),t}static runFunctions(e,t,s){const n=new Bo(null),r={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return n._run(()=>n._runFunctions(e,t,r)),n}static runTools(e,t,s){const n=new Bo(t),r={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runTools"}};return n._run(()=>n._runTools(e,t,r)),n}}let C2=class extends $t{parse(e,t){return YN(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t?.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(s=>sm(s,e))}runFunctions(e,t){return e.stream?Bo.runFunctions(this._client,e,t):kc.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?Bo.runTools(this._client,e,t):kc.runTools(this._client,e,t)}stream(e,t){return Cc.createChatCompletion(this._client,e,t)}};class gp extends $t{constructor(){super(...arguments),this.completions=new C2(this._client)}}(function(i){i.Completions=C2})(gp||(gp={}));var We=function(i,e,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?i!==e||!s:!e.has(i))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(i):s?s.value:e.get(i)},Cn=function(i,e,t,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?i!==e||!n:!e.has(i))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(i,t):n?n.value=t:e.set(i,t),t},qs,bp,Di,cu,hi,va,Co,ba,Pu,Ln,hu,uu,rc,Kl,Jl,y0,v0,w0,x0,_0,A0,S0;class mi extends h2{constructor(){super(...arguments),qs.add(this),bp.set(this,[]),Di.set(this,{}),cu.set(this,{}),hi.set(this,void 0),va.set(this,void 0),Co.set(this,void 0),ba.set(this,void 0),Pu.set(this,void 0),Ln.set(this,void 0),hu.set(this,void 0),uu.set(this,void 0),rc.set(this,void 0)}[(bp=new WeakMap,Di=new WeakMap,cu=new WeakMap,hi=new WeakMap,va=new WeakMap,Co=new WeakMap,ba=new WeakMap,Pu=new WeakMap,Ln=new WeakMap,hu=new WeakMap,uu=new WeakMap,rc=new WeakMap,qs=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let s=!1;return this.on("event",n=>{const r=t.shift();r?r.resolve(n):e.push(n)}),this.on("end",()=>{s=!0;for(const n of t)n.resolve(void 0);t.length=0}),this.on("abort",n=>{s=!0;for(const r of t)r.reject(n);t.length=0}),this.on("error",n=>{s=!0;for(const r of t)r.reject(n);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((r,a)=>t.push({resolve:r,reject:a})).then(r=>r?{value:r,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new mi;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){const s=t?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),this._connected();const n=$i.fromReadableStream(e,this.controller);for await(const r of n)We(this,qs,"m",Kl).call(this,r);if(n.controller.signal?.aborted)throw new pi;return this._addRun(We(this,qs,"m",Jl).call(this))}toReadableStream(){return new $i(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,s,n,r){const a=new mi;return a._run(()=>a._runToolAssistantStream(e,t,s,n,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createToolAssistantStream(e,t,s,n,r){const a=r?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o={...n,stream:!0},l=await e.submitToolOutputs(t,s,o,{...r,signal:this.controller.signal});this._connected();for await(const c of l)We(this,qs,"m",Kl).call(this,c);if(l.controller.signal?.aborted)throw new pi;return this._addRun(We(this,qs,"m",Jl).call(this))}static createThreadAssistantStream(e,t,s){const n=new mi;return n._run(()=>n._threadAssistantStream(e,t,{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),n}static createAssistantStream(e,t,s,n){const r=new mi;return r._run(()=>r._runAssistantStream(e,t,s,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),r}currentEvent(){return We(this,hu,"f")}currentRun(){return We(this,uu,"f")}currentMessageSnapshot(){return We(this,hi,"f")}currentRunStepSnapshot(){return We(this,rc,"f")}async finalRunSteps(){return await this.done(),Object.values(We(this,Di,"f"))}async finalMessages(){return await this.done(),Object.values(We(this,cu,"f"))}async finalRun(){if(await this.done(),!We(this,va,"f"))throw Error("Final run was not received.");return We(this,va,"f")}async _createThreadAssistantStream(e,t,s){const n=s?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort()));const r={...t,stream:!0},a=await e.createAndRun(r,{...s,signal:this.controller.signal});this._connected();for await(const o of a)We(this,qs,"m",Kl).call(this,o);if(a.controller.signal?.aborted)throw new pi;return this._addRun(We(this,qs,"m",Jl).call(this))}async _createAssistantStream(e,t,s,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort()));const a={...s,stream:!0},o=await e.create(t,a,{...n,signal:this.controller.signal});this._connected();for await(const l of o)We(this,qs,"m",Kl).call(this,l);if(o.controller.signal?.aborted)throw new pi;return this._addRun(We(this,qs,"m",Jl).call(this))}static accumulateDelta(e,t){for(const[s,n]of Object.entries(t)){if(!e.hasOwnProperty(s)){e[s]=n;continue}let r=e[s];if(r==null){e[s]=n;continue}if(s==="index"||s==="type"){e[s]=n;continue}if(typeof r=="string"&&typeof n=="string")r+=n;else if(typeof r=="number"&&typeof n=="number")r+=n;else if(xf(r)&&xf(n))r=this.accumulateDelta(r,n);else if(Array.isArray(r)&&Array.isArray(n)){if(r.every(a=>typeof a=="string"||typeof a=="number")){r.push(...n);continue}for(const a of n){if(!xf(a))throw new Error(`Expected array delta entry to be an object but got: ${a}`);const o=a.index;if(o==null)throw console.error(a),new Error("Expected array delta entry to have an `index` property");if(typeof o!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${o}`);const l=r[o];l==null?r.push(a):r[o]=this.accumulateDelta(l,a)}continue}else throw Error(`Unhandled record type: ${s}, deltaValue: ${n}, accValue: ${r}`);e[s]=r}return e}_addRun(e){return e}async _threadAssistantStream(e,t,s){return await this._createThreadAssistantStream(t,e,s)}async _runAssistantStream(e,t,s,n){return await this._createAssistantStream(t,e,s,n)}async _runToolAssistantStream(e,t,s,n,r){return await this._createToolAssistantStream(s,e,t,n,r)}}Kl=function(e){if(!this.ended)switch(Cn(this,hu,e,"f"),We(this,qs,"m",w0).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":We(this,qs,"m",S0).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":We(this,qs,"m",v0).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":We(this,qs,"m",y0).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Jl=function(){if(this.ended)throw new At("stream has ended, this shouldn't happen");if(!We(this,va,"f"))throw Error("Final run has not been received");return We(this,va,"f")},y0=function(e){const[t,s]=We(this,qs,"m",_0).call(this,e,We(this,hi,"f"));Cn(this,hi,t,"f"),We(this,cu,"f")[t.id]=t;for(const n of s){const r=t.content[n.index];r?.type=="text"&&this._emit("textCreated",r.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const n of e.data.delta.content){if(n.type=="text"&&n.text){let r=n.text,a=t.content[n.index];if(a&&a.type=="text")this._emit("textDelta",r,a.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(n.index!=We(this,Co,"f")){if(We(this,ba,"f"))switch(We(this,ba,"f").type){case"text":this._emit("textDone",We(this,ba,"f").text,We(this,hi,"f"));break;case"image_file":this._emit("imageFileDone",We(this,ba,"f").image_file,We(this,hi,"f"));break}Cn(this,Co,n.index,"f")}Cn(this,ba,t.content[n.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(We(this,Co,"f")!==void 0){const n=e.data.content[We(this,Co,"f")];if(n)switch(n.type){case"image_file":this._emit("imageFileDone",n.image_file,We(this,hi,"f"));break;case"text":this._emit("textDone",n.text,We(this,hi,"f"));break}}We(this,hi,"f")&&this._emit("messageDone",e.data),Cn(this,hi,void 0,"f")}},v0=function(e){const t=We(this,qs,"m",x0).call(this,e);switch(Cn(this,rc,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const s=e.data.delta;if(s.step_details&&s.step_details.type=="tool_calls"&&s.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const r of s.step_details.tool_calls)r.index==We(this,Pu,"f")?this._emit("toolCallDelta",r,t.step_details.tool_calls[r.index]):(We(this,Ln,"f")&&this._emit("toolCallDone",We(this,Ln,"f")),Cn(this,Pu,r.index,"f"),Cn(this,Ln,t.step_details.tool_calls[r.index],"f"),We(this,Ln,"f")&&this._emit("toolCallCreated",We(this,Ln,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Cn(this,rc,void 0,"f"),e.data.step_details.type=="tool_calls"&&We(this,Ln,"f")&&(this._emit("toolCallDone",We(this,Ln,"f")),Cn(this,Ln,void 0,"f")),this._emit("runStepDone",e.data,t);break}},w0=function(e){We(this,bp,"f").push(e),this._emit("event",e)},x0=function(e){switch(e.event){case"thread.run.step.created":return We(this,Di,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=We(this,Di,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let s=e.data;if(s.delta){const n=mi.accumulateDelta(t,s.delta);We(this,Di,"f")[e.data.id]=n}return We(this,Di,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":We(this,Di,"f")[e.data.id]=e.data;break}if(We(this,Di,"f")[e.data.id])return We(this,Di,"f")[e.data.id];throw new Error("No snapshot available")},_0=function(e,t){let s=[];switch(e.event){case"thread.message.created":return[e.data,s];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let n=e.data;if(n.delta.content)for(const r of n.delta.content)if(r.index in t.content){let a=t.content[r.index];t.content[r.index]=We(this,qs,"m",A0).call(this,r,a)}else t.content[r.index]=r,s.push(r);return[t,s];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,s];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},A0=function(e,t){return mi.accumulateDelta(t,e)},S0=function(e){switch(Cn(this,uu,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":Cn(this,va,e.data,"f"),We(this,Ln,"f")&&(this._emit("toolCallDone",We(this,Ln,"f")),Cn(this,Ln,void 0,"f"));break}};class nm extends $t{create(e,t,s){return this._client.post(`/threads/${e}/messages`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}retrieve(e,t,s){return this._client.get(`/threads/${e}/messages/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}update(e,t,s,n){return this._client.post(`/threads/${e}/messages/${t}`,{body:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e,t={},s){return xn(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,im,{query:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}del(e,t,s){return this._client.delete(`/threads/${e}/messages/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}}class im extends xi{}nm.MessagesPage=im;class rm extends $t{retrieve(e,t,s,n={},r){return xn(n)?this.retrieve(e,t,s,{},n):this._client.get(`/threads/${e}/runs/${t}/steps/${s}`,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e,t,s={},n){return xn(s)?this.list(e,t,{},s):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,am,{query:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}class am extends xi{}rm.RunStepsPage=am;class qc extends $t{constructor(){super(...arguments),this.steps=new rm(this._client)}create(e,t,s){const{include:n,...r}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:n},body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers},stream:t.stream??!1})}retrieve(e,t,s){return this._client.get(`/threads/${e}/runs/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}update(e,t,s,n){return this._client.post(`/threads/${e}/runs/${t}`,{body:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e,t={},s){return xn(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,om,{query:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}cancel(e,t,s){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}async createAndPoll(e,t,s){const n=await this.create(e,t,s);return await this.poll(e,n.id,s)}createAndStream(e,t,s){return mi.createAssistantStream(e,this._client.beta.threads.runs,t,s)}async poll(e,t,s){const n={...s?.headers,"X-Stainless-Poll-Helper":"true"};for(s?.pollIntervalMs&&(n["X-Stainless-Custom-Poll-Interval"]=s.pollIntervalMs.toString());;){const{data:r,response:a}=await this.retrieve(e,t,{...s,headers:{...s?.headers,...n}}).withResponse();switch(r.status){case"queued":case"in_progress":case"cancelling":let o=5e3;if(s?.pollIntervalMs)o=s.pollIntervalMs;else{const l=a.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(o=c)}}await Dc(o);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return r}}}stream(e,t,s){return mi.createAssistantStream(e,this._client.beta.threads.runs,t,s)}submitToolOutputs(e,t,s,n){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers},stream:s.stream??!1})}async submitToolOutputsAndPoll(e,t,s,n){const r=await this.submitToolOutputs(e,t,s,n);return await this.poll(e,r.id,n)}submitToolOutputsStream(e,t,s,n){return mi.createToolAssistantStream(e,t,this._client.beta.threads.runs,s,n)}}class om extends xi{}qc.RunsPage=om;qc.Steps=rm;qc.RunStepsPage=am;class Yo extends $t{constructor(){super(...arguments),this.runs=new qc(this._client),this.messages=new nm(this._client)}create(e={},t){return xn(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,s){return this._client.post(`/threads/${e}`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){const s=await this.createAndRun(e,t);return await this.runs.poll(s.thread_id,s.id,t)}createAndRunStream(e,t){return mi.createThreadAssistantStream(e,this._client.beta.threads,t)}}Yo.Runs=qc;Yo.RunsPage=om;Yo.Messages=nm;Yo.MessagesPage=im;const sE=async i=>{const e=await Promise.allSettled(i),t=e.filter(n=>n.status==="rejected");if(t.length){for(const n of t)console.error(n.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const s=[];for(const n of e)n.status==="fulfilled"&&s.push(n.value);return s};let lm=class extends $t{create(e,t,s){return this._client.post(`/vector_stores/${e}/files`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}retrieve(e,t,s){return this._client.get(`/vector_stores/${e}/files/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}list(e,t={},s){return xn(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,id,{query:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}del(e,t,s){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}async createAndPoll(e,t,s){const n=await this.create(e,t,s);return await this.poll(e,n.id,s)}async poll(e,t,s){const n={...s?.headers,"X-Stainless-Poll-Helper":"true"};for(s?.pollIntervalMs&&(n["X-Stainless-Custom-Poll-Interval"]=s.pollIntervalMs.toString());;){const r=await this.retrieve(e,t,{...s,headers:n}).withResponse(),a=r.data;switch(a.status){case"in_progress":let o=5e3;if(s?.pollIntervalMs)o=s.pollIntervalMs;else{const l=r.response.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(o=c)}}await Dc(o);break;case"failed":case"completed":return a}}}async upload(e,t,s){const n=await this._client.files.create({file:t,purpose:"assistants"},s);return this.create(e,{file_id:n.id},s)}async uploadAndPoll(e,t,s){const n=await this.upload(e,t,s);return await this.poll(e,n.id,s)}};class id extends xi{}lm.VectorStoreFilesPage=id;class P2 extends $t{create(e,t,s){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}retrieve(e,t,s){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}cancel(e,t,s){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}async createAndPoll(e,t,s){const n=await this.create(e,t);return await this.poll(e,n.id,s)}listFiles(e,t,s={},n){return xn(s)?this.listFiles(e,t,{},s):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,id,{query:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async poll(e,t,s){const n={...s?.headers,"X-Stainless-Poll-Helper":"true"};for(s?.pollIntervalMs&&(n["X-Stainless-Custom-Poll-Interval"]=s.pollIntervalMs.toString());;){const{data:r,response:a}=await this.retrieve(e,t,{...s,headers:n}).withResponse();switch(r.status){case"in_progress":let o=5e3;if(s?.pollIntervalMs)o=s.pollIntervalMs;else{const l=a.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(o=c)}}await Dc(o);break;case"failed":case"cancelled":case"completed":return r}}}async uploadAndPoll(e,{files:t,fileIds:s=[]},n){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const r=n?.maxConcurrency??5,a=Math.min(r,t.length),o=this._client,l=t.values(),c=[...s];async function h(p){for(let f of p){const v=await o.files.create({file:f,purpose:"assistants"},n);c.push(v.id)}}const d=Array(a).fill(l).map(h);return await sE(d),await this.createAndPoll(e,{file_ids:c})}}class Ko extends $t{constructor(){super(...arguments),this.files=new lm(this._client),this.fileBatches=new P2(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,s){return this._client.post(`/vector_stores/${e}`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}list(e={},t){return xn(e)?this.list({},e):this._client.getAPIList("/vector_stores",cm,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class cm extends xi{}Ko.VectorStoresPage=cm;Ko.Files=lm;Ko.VectorStoreFilesPage=id;Ko.FileBatches=P2;class Ra extends $t{constructor(){super(...arguments),this.vectorStores=new Ko(this._client),this.chat=new gp(this._client),this.assistants=new em(this._client),this.threads=new Yo(this._client)}}Ra.VectorStores=Ko;Ra.VectorStoresPage=cm;Ra.Assistants=em;Ra.AssistantsPage=tm;Ra.Threads=Yo;class L2 extends $t{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}class T2 extends $t{create(e,t){return this._client.post("/embeddings",{body:e,...t})}}class hm extends $t{create(e,t){return this._client.post("/files",Wo({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return xn(e)?this.list({},e):this._client.getAPIList("/files",um,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/json",...t?.headers}})}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:s=30*60*1e3}={}){const n=new Set(["processed","error","deleted"]),r=Date.now();let a=await this.retrieve(e);for(;!a.status||!n.has(a.status);)if(await Dc(t),a=await this.retrieve(e),Date.now()-r>s)throw new Kp({message:`Giving up on waiting for file ${e} to finish processing after ${s} milliseconds.`});return a}}class um extends xi{}hm.FileObjectsPage=um;class dm extends $t{list(e,t={},s){return xn(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,fm,{query:t,...s})}}class fm extends xi{}dm.FineTuningJobCheckpointsPage=fm;class Jo extends $t{constructor(){super(...arguments),this.checkpoints=new dm(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return xn(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",pm,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},s){return xn(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,mm,{query:t,...s})}}class pm extends xi{}class mm extends xi{}Jo.FineTuningJobsPage=pm;Jo.FineTuningJobEventsPage=mm;Jo.Checkpoints=dm;Jo.FineTuningJobCheckpointsPage=fm;class Uc extends $t{constructor(){super(...arguments),this.jobs=new Jo(this._client)}}Uc.Jobs=Jo;Uc.FineTuningJobsPage=pm;Uc.FineTuningJobEventsPage=mm;class j2 extends $t{createVariation(e,t){return this._client.post("/images/variations",Wo({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",Wo({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}class gm extends $t{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",bm,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}class bm extends HN{}gm.ModelsPage=bm;class I2 extends $t{create(e,t){return this._client.post("/moderations",{body:e,...t})}}class R2 extends $t{create(e,t,s){return this._client.post(`/uploads/${e}/parts`,Wo({body:t,...s}))}}class ym extends $t{constructor(){super(...arguments),this.parts=new R2(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,s){return this._client.post(`/uploads/${e}/complete`,{body:t,...s})}}ym.Parts=R2;var O2;class Et extends TN{constructor({baseURL:e=Xh("OPENAI_BASE_URL"),apiKey:t=Xh("OPENAI_API_KEY"),organization:s=Xh("OPENAI_ORG_ID")??null,project:n=Xh("OPENAI_PROJECT_ID")??null,...r}={}){if(t===void 0)throw new At("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const a={apiKey:t,organization:s,project:n,...r,baseURL:e||"https://api.openai.com/v1"};if(!a.dangerouslyAllowBrowser&&UN())throw new At(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:a.baseURL,timeout:a.timeout??6e5,httpAgent:a.httpAgent,maxRetries:a.maxRetries,fetch:a.fetch}),this.completions=new L2(this),this.chat=new Jp(this),this.embeddings=new T2(this),this.files=new hm(this),this.images=new j2(this),this.audio=new Bc(this),this.moderations=new I2(this),this.models=new gm(this),this.fineTuning=new Uc(this),this.beta=new Ra(this),this.batches=new Zp(this),this.uploads=new ym(this),this._options=a,this.apiKey=t,this.organization=s,this.project=n}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return pN(e,{arrayFormat:"brackets"})}}O2=Et;Et.OpenAI=O2;Et.DEFAULT_TIMEOUT=6e5;Et.OpenAIError=At;Et.APIError=Us;Et.APIConnectionError=td;Et.APIConnectionTimeoutError=Kp;Et.APIUserAbortError=pi;Et.NotFoundError=$b;Et.ConflictError=qb;Et.RateLimitError=zb;Et.BadRequestError=Fb;Et.AuthenticationError=Db;Et.InternalServerError=Hb;Et.PermissionDeniedError=Bb;Et.UnprocessableEntityError=Ub;Et.toFile=Kb;Et.fileFromPath=Ob;Et.Completions=L2;Et.Chat=Jp;Et.Embeddings=T2;Et.Files=hm;Et.FileObjectsPage=um;Et.Images=j2;Et.Audio=Bc;Et.Moderations=I2;Et.Models=gm;Et.ModelsPage=bm;Et.FineTuning=Uc;Et.Beta=Ra;Et.Batches=Zp;Et.BatchesPage=Qp;Et.Uploads=ym;const Po={GPT_4:"gpt-4",GPT_4_TURBO:"gpt-4-turbo-preview",GPT_3_5_TURBO:"gpt-3.5-turbo",GPT_4O_MINI:"gpt-4o-mini"},nE={[Po.GPT_4]:{maxTokens:4e3,temperature:.7,presencePenalty:.1,frequencyPenalty:.1},[Po.GPT_4_TURBO]:{maxTokens:4e3,temperature:.7,presencePenalty:.1,frequencyPenalty:.1},[Po.GPT_3_5_TURBO]:{maxTokens:2e3,temperature:.7,presencePenalty:0,frequencyPenalty:0},[Po.GPT_4O_MINI]:{maxTokens:4e3,temperature:.7,presencePenalty:.1,frequencyPenalty:.1}},iE=`You are a world-class Talent Assessment Expert with over 20 years of experience as a Technical Recruiter and HR Leader at top Silicon Valley companies and Fortune 100 enterprises. Throughout your illustrious career, you have personally evaluated over 10,000 candidates, consistently identifying exceptional talent that propels organizational success and innovation.

Your mission is to perform a comprehensive, evidence-based analysis comparing a candidate's CV against a specific job description. Leveraging your deep expertise in technical skills evaluation, behavioral assessment, and predictive hiring, you will:

Technical Skills Evaluation:

Identify and assess the candidate's proficiency in required technical skills and technologies.
Evaluate the relevance and depth of their technical experience in relation to the job's demands.
Highlight any gaps or additional strengths that may benefit the role.
Behavioral Assessment:

Analyze the candidate's behavioral traits and soft skills based on their CV and any supplementary information.
Determine cultural fit and alignment with the company's core values and team dynamics.
Provide insights into the candidate's potential for leadership, collaboration, and adaptability.
Predictive Hiring Insights:

Utilize industry best practices and rigorous analytical frameworks to predict the candidate's future performance and long-term potential within the organization.
Assess indicators of sustained success, such as career progression, continuous learning, and achievement of past objectives.
Your analysis will include:

A detailed comparison between the candidate's qualifications and the job requirements.
Strengths and areas for improvement for the candidate relative to the role.
Actionable recommendations for hiring decisions, interview focus areas, and potential development paths.
Approach this task with a meticulous, data-driven mindset, ensuring that every insight is backed by evidence and aligned with the latest industry standards. Your goal is to provide a clear, objective, and thorough evaluation that empowers hiring teams to make informed, strategic decisions.
Analyze and quantify these key areas:

1. Technical Skills Match (with proficiency levels)
2. Experience Alignment (years and relevance)
3. Cultural Fit Indicators (based on achievements and communication style)
4. Growth Potential (learning velocity and adaptability)
5. Risk Factors (gaps, retention risks, skill mismatches)

Format your response exactly as follows:

FIT_SCORE: [1-10, with decimal precision]
VERDICT: [STRONG_FIT|POTENTIAL_FIT|NEEDS_CONSIDERATION|NOT_RECOMMENDED]

REASONING:
- [Key observation with specific evidence]
- [Impact assessment]
- [Alignment with company needs]
...

TECHNICAL_SKILLS:
- Skill: [Skill Category]
  * Proficiency: [EXPERT]
  * Evidence: [Specific projects/achievements]
  * Currency: [How recent/relevant]
- Skill: [Skill Category]
  * Proficiency: [ADVANCED]
  * Evidence: [Specific projects/achievements]
  * Currency: [How recent/relevant]
- Skill: [Skill Category]
  * Proficiency: [INTERMEDIATE]
  * Evidence: [Specific projects/achievements]
  * Currency: [How recent/relevant]
- Skill: [Skill Category]
  * Proficiency: [BASIC]
  * Evidence: [Specific projects/achievements]
  * Currency: [How recent/relevant]
- Skill: [Skill Category]
  * Proficiency: [BEGINNER]
  * Evidence: [Specific projects/achievements]
  * Currency: [How recent/relevant]

RISK_FACTORS:
- Severity: [HIGH]
  * Description: [Specific risk]
  * Mitigation: [Possible solutions]
- Severity: [MEDIUM] 
  * Description: [Additional risk identified]
  * Mitigation: [Mitigation strategy]
- Severity: [LOW]
  * Description: [Further risk if applicable] 
  * Mitigation: [Corresponding mitigation plan]
...

GROWTH_POTENTIAL:
Areas:
- [Growth area]: [Current level â†’ Potential level]
- [Supporting evidence]
...
Recommendations:
- Short-term: [0-6 months actions]
- Long-term: [6-18 months pathway]
...

INTERVIEW_PLAN:
Provide 3-5 key interview questions across these categories:

- Technical Questions:
  1. Question Category: Technical (XX minutes)
  Primary Question: [Detailed, specific question targeting core competency]
  Expected Answer: [Key points that demonstrate competency]
  Follow-up Questions:
  - [Deeper technical probe]
  - [Edge case consideration]
  - [Implementation details]
  Red Flags:
  - [Specific warning signs]
  - [Knowledge gaps] 
  Green Flags:
  - [Ideal response indicators]
  - [Advanced understanding signals]
  Evaluation Criteria:
  - [Specific technical requirements]
  - [Communication clarity]
  - [Problem-solving approach]

- Behavioral Questions:
  2. Question Category: Behavioral (XX minutes)
  Primary Question: [Detailed, specific question targeting core competency]
  Expected Answer: [Key points that demonstrate competency]
  Follow-up Questions:
  - [Deeper behavioral probe]
  - [Situational consideration]
  - [Motivation assessment]
  Red Flags:
  - [Specific warning signs]
  - [Behavioral gaps]
  Green Flags:
  - [Ideal response indicators]
  - [Maturity signals]
  Evaluation Criteria:
  - [Specific behavioral requirements]
  - [Communication style]
  - [Cultural fit indicators]

- Problem Solving Questions:
  3. Question Category: Problem Solving (XX minutes)
  Primary Question: [Detailed, specific question targeting core competency]
  Expected Answer: [Key points that demonstrate competency]
  Follow-up Questions:
  - [Deeper analytical probe]
  - [Edge case consideration]
  - [Process details]
  Red Flags:
  - [Specific warning signs]
  - [Analytical gaps]
  Green Flags:
  - [Ideal response indicators]
  - [Advanced reasoning signals]
  Evaluation Criteria:
  - [Specific analytical requirements]
  - [Problem approach]
  - [Solution quality]
...`,rE="your-production-openai-key",aE=new Et({apiKey:rE,dangerouslyAllowBrowser:!0});async function oE(i,e,t="gpt-4o-mini"){if(!i?.trim())throw new Dt("CV text is required",400);if(!e?.trim())throw new Dt("Job description is required",400);if(!Object.values(Po).includes(t))throw new Dt(`Invalid model. Must be one of: ${Object.values(Po).join(", ")}`,400);try{const s=nE[t];if(i.length+e.length>s.maxTokens*4)throw new Dt("Input text is too long for the selected model",400);const r=await aE.chat.completions.create({model:t,messages:[{role:"system",content:iE},{role:"user",content:`CV:
${i}

Job Description:
${e}`}],temperature:s.temperature,presence_penalty:s.presencePenalty,frequency_penalty:s.frequencyPenalty,max_tokens:s.maxTokens});if(!r?.choices?.length)throw new Dt("Invalid response from OpenAI",500);const a=r.choices[0]?.message?.content;if(!a)throw new Dt("Empty response from OpenAI",500);return a}catch(s){if(s instanceof Dt)throw s;if(s instanceof Et.APIError)switch(s.status){case 400:throw new Dt("Invalid request to OpenAI API: "+s.message,400);case 401:throw new Dt("Invalid OpenAI API key",401);case 429:throw new Dt("OpenAI API rate limit exceeded. Please try again later.",429);case 500:throw new Dt("OpenAI service error. Please try again later.",500);default:throw new Dt("OpenAI API error: "+s.message,s.status||500)}throw s instanceof Error?new Dt("Failed to communicate with OpenAI: "+s.message,500):new Dt("An unexpected error occurred during analysis",500)}}const lE=!1;function cE(i){const s=["FIT_SCORE","VERDICT","REASONING","TECHNICAL_SKILLS","RISK_FACTORS","GROWTH_POTENTIAL","INTERVIEW_PLAN"].map(r=>{const a=i.includes(r+":");return{section:r,found:a}}).find(r=>!r.found);if(s)throw new Error(`Invalid response format from OpenAI: Missing ${s.section} section`);return[{check:/FIT_SCORE:\s*(\d+(\.\d+)?)/i,message:"FIT_SCORE must be a number"},{check:/VERDICT:\s*(STRONG_FIT|POTENTIAL_FIT|NEEDS_CONSIDERATION|NOT_RECOMMENDED)/i,message:"VERDICT must be one of: STRONG_FIT, POTENTIAL_FIT, NEEDS_CONSIDERATION, NOT_RECOMMENDED"},{check:/REASONING:[\s\S]*?(-\s+.+(\n|$))+/,message:"REASONING must contain bullet points"}].forEach(({check:r,message:a})=>{if(!r.test(i))throw new Error(`Invalid response format from OpenAI: ${a}`)}),!0}const hE=i=>i?i.split(/(?=^-\s*Severity:)/m).filter(Boolean).map(e=>{const t=e.match(/Severity:\s*\[?(HIGH|MEDIUM|LOW)\]?/i),s=e.match(/\*\s*Description:\s*\[?([^\n\]]+)\]?/i),n=e.match(/\*\s*Mitigation:\s*\[?([^\n\]]+)\]?/i);return t&&s?{severity:t[1].toUpperCase(),description:s[1].trim(),mitigation:n?.[1]?.trim()}:null}).filter(e=>e!==null):[];function uE(i){try{cE(i);const e=i.match(/FIT_SCORE:\s*(\d+(\.\d+)?)/i),t=i.match(/VERDICT:\s*(STRONG_FIT|POTENTIAL_FIT|NEEDS_CONSIDERATION|NOT_RECOMMENDED)/i),s=i.match(/REASONING:([\s\S]*?)(?=TECHNICAL_SKILLS:)/i),n=i.match(/TECHNICAL_SKILLS:([\s\S]*?)(?=RISK_FACTORS:)/i),r=i.match(/RISK_FACTORS:([\s\S]*?)(?=GROWTH_POTENTIAL:)/i),a=i.match(/GROWTH_POTENTIAL:([\s\S]*?)(?=INTERVIEW_PLAN:)/i),o=i.match(/INTERVIEW_PLAN:([\s\S]*$)/i);if(!e||!t||!s||!o){const h=[!e&&"FIT_SCORE",!t&&"VERDICT",!s&&"REASONING",!o&&"INTERVIEW_PLAN"].filter(Boolean);throw new Error(`Invalid response format from OpenAI: Missing ${h.join(", ")}`)}const l=h=>h.split(`
`).map(d=>d.trim()).filter(d=>d.startsWith("-")).map(d=>d.slice(1).trim()),c=h=>{const d=h.match(/Areas:([\s\S]*?)(?=Recommendations:)/i)?.[1]||"",p=h.match(/Recommendations:([\s\S]*$)/i)?.[1]||"";return{areas:l(d),recommendations:l(p)}};return{fit_score:parseInt(e[1],10),verdict:t[1],reasoning:l(s[1]),technical_skills:dE(n?.[1]||""),risk_factors:hE(r?.[1]||""),growth_potential:c(a?.[1]||""),interview_plan:o[1].trim(),cv_summary:"",job_requirements:"",questions_used:[],suggestions:[],status:"pending"}}catch(e){throw e}}function dE(i){if(!i)return[];const e=[],t=i.matchAll(/- Skill: (.*?)\n\s*\* Proficiency: (.*?)\n\s*\* Evidence: (.*?)\n\s*\* Currency: (.*?)(?=\n-|\n\n|$)/gs);for(const s of t){const[,n,r,a,o]=s;if(n&&r&&a&&o){const l=r.trim().replace(/[\[\]]/g,"").toUpperCase();["EXPERT","ADVANCED","INTERMEDIATE","BASIC","BEGINNER"].includes(l)&&e.push({skill:n.trim(),proficiency:l,evidence:a.trim(),currency:o.trim()})}}return e}const vm={FREE:4,PRO:1e3},N0={WARNING:.8,CRITICAL:.95};function fE(i,e){const t=performance.now();return i().finally(()=>{const s=performance.now()-t;oc.trackEvent("performance_measure",{operation:e,duration_ms:Math.round(s)})})}async function pE({candidateId:i,jobId:e}){return fE(async()=>{try{const[t,s]=await Promise.all([ut.from("candidates").select("*").eq("id",i).single(),ut.from("jobs").select("*").eq("id",e).single()]);if(t.error)throw new Error("Candidate not found");if(s.error)throw new Error("Job not found");const n=await oE(t.data.cv_text,s.data.jd_text),r=uE(n),{data:{user:a}}=await ut.auth.getUser();if(!a)throw new Error("User not authenticated");const{data:o,error:l}=await ut.from("analysis").insert([{candidate_id:i,job_id:e,user_id:a.id,...r,created_at:new Date().toISOString()}]).select().single();if(l)throw l;return o}catch(t){throw Np(t)}},"analyze_candidate_job")}async function M2(i){if(!i)throw new Error("User ID is required");try{const{data:e,error:t}=await ut.from("subscriptions").select("status, plan, analysis_count, current_period_end").eq("user_id",i).maybeSingle();if(t)throw console.error("Supabase error:",t),new Error(`Database error: ${t.message}`);return e?{status:e.status||"active",plan:e.plan||"free",analysisCount:e.analysis_count||0,currentPeriodEnd:e.current_period_end||new Date(Date.now()+30*24*60*60*1e3).toISOString()}:{status:"active",plan:"free",analysisCount:0,currentPeriodEnd:new Date(Date.now()+30*24*60*60*1e3).toISOString()}}catch(e){return console.error("Subscription error:",e),{status:"active",plan:"free",analysisCount:0,currentPeriodEnd:new Date(Date.now()+30*24*60*60*1e3).toISOString()}}}async function F2(i){try{const e=i.plan.toUpperCase(),t=vm[e];return Math.max(0,t-(i.analysisCount||0))}catch(e){return console.error("Error calculating remaining analyses:",e),0}}function D2(i){try{if(!i||i.status!=="active")return!1;const e=i.plan.toUpperCase(),t=vm[e];return(i.analysisCount||0)<t}catch(e){return console.error("Error checking analysis permission:",e),!1}}var B2="https://js.stripe.com/v3",mE=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,E0="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",gE=function(){for(var e=document.querySelectorAll('script[src^="'.concat(B2,'"]')),t=0;t<e.length;t++){var s=e[t];if(mE.test(s.src))return s}return null},k0=function(e){var t="",s=document.createElement("script");s.src="".concat(B2).concat(t);var n=document.head||document.body;if(!n)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return n.appendChild(s),s},bE=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"2.4.0",startTime:t})},Bl=null,Zh=null,Qh=null,yE=function(e){return function(){e(new Error("Failed to load Stripe.js"))}},vE=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}},wE=function(e){return Bl!==null?Bl:(Bl=new Promise(function(t,s){if(typeof window>"u"||typeof document>"u"){t(null);return}if(window.Stripe&&e&&console.warn(E0),window.Stripe){t(window.Stripe);return}try{var n=gE();if(n&&e)console.warn(E0);else if(!n)n=k0(e);else if(n&&Qh!==null&&Zh!==null){var r;n.removeEventListener("load",Qh),n.removeEventListener("error",Zh),(r=n.parentNode)===null||r===void 0||r.removeChild(n),n=k0(e)}Qh=vE(t,s),Zh=yE(s),n.addEventListener("load",Qh),n.addEventListener("error",Zh)}catch(a){s(a);return}}),Bl.catch(function(t){return Bl=null,Promise.reject(t)}))},xE=function(e,t,s){if(e===null)return null;var n=e.apply(void 0,t);return bE(n,s),n},$l,$2=!1,q2=function(){return $l||($l=wE(null).catch(function(e){return $l=null,Promise.reject(e)}),$l)};Promise.resolve().then(function(){return q2()}).catch(function(i){$2||console.warn(i)});var wm=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];$2=!0;var n=Date.now();return q2().then(function(r){return xE(r,t,n)})};const _E="your-production-stripe-key";wm(_E);function AE(){const[i,e]=V.useState(null),[t,s]=V.useState(null),{isLoading:n,withLoading:r}=iN(),{addToast:a}=Wp(),o=async l=>{try{const{data:{session:c}}=await ut.auth.getSession();if(!c?.user)throw new Dt("Not authenticated",401);console.log("Auth check:",{userId:c.user.id,isAuthenticated:!0});const h=await dx({name:l.candidateName,cv_text:l.cvText,created_at:new Date().toISOString()}),d=await OS(l.jobTitle,l.jobDescription);console.log("Starting analysis with:",{candidateId:h.id,jobId:d.id});const p=await pE({candidateId:h.id,jobId:d.id});return console.log("Analysis completed:",p),e(p),s(null),a("Analysis completed successfully","success"),p}catch(c){console.error("Analysis error:",{error:c,type:c instanceof Dt?"ApiError":typeof c,message:c.message,status:c.status,details:c.details});const h=c instanceof Dt?c.message:"An unexpected error occurred. Please try again.";throw s(h),a(h,"error"),c}};return{analysis:i,error:t,isLoading:n,analyze:l=>r(o(l))}}Ls.string().email("Invalid email address");Ls.string().min(8,"Password must be at least 8 characters");const C0=Ls.object({name:Ls.string().min(1,"Name is required"),cv_text:Ls.string().min(100,"CV text must be at least 100 characters")}),P0=Ls.object({title:Ls.string().min(1,"Job title is required"),jd_text:Ls.string().min(100,"Job description must be at least 100 characters")});Ls.object({cvText:Ls.string().min(100,"CV text must be at least 100 characters"),jobDescription:Ls.string().min(100,"Job description must be at least 100 characters")});Ls.object({plan:Ls.enum(["free","pro"]),status:Ls.enum(["active","trialing","past_due","canceled"]),analysisCount:Ls.number().min(0)});const SE=Ls.object({candidateName:C0.shape.name,cvText:C0.shape.cv_text,jobTitle:P0.shape.title,jobDescription:P0.shape.jd_text}),NE={candidateName:"",cvText:"",jobTitle:"",jobDescription:""};function EE(){const{analyze:i,analysis:e,isLoading:t}=AE();return{...nN({initialValues:NE,validationSchema:SE,onSubmit:async n=>{await i({candidateName:n.candidateName,cvText:n.cvText,jobTitle:n.jobTitle,jobDescription:n.jobDescription})}}),analysis:e,isLoading:t}}function U2(){const[i,e]=V.useState(null),[t,s]=V.useState(!0);return V.useEffect(()=>{ut.auth.getSession().then(({data:{session:a}})=>{e(a),s(!1)});const{data:{subscription:r}}=ut.auth.onAuthStateChange((a,o)=>{e(o),o&&oc.trackEvent("user_signed_in")});return()=>r.unsubscribe()},[]),{session:i,loading:t,signOut:async()=>{try{const{error:r}=await ut.auth.signOut();if(r)throw r;oc.trackEvent("user_signed_out")}catch(r){Np(r)}}}}function kE(){const{session:i}=U2(),[e,t]=V.useState(null),[s,n]=V.useState(!0),[r,a]=V.useState(null);return V.useEffect(()=>{let o=!0;async function l(){if(!i?.user){o&&(t(null),n(!1));return}try{await new Promise(h=>setTimeout(h,100));const c=await M2(i.user.id);o&&(t(c),a(null))}catch(c){console.error("Subscription fetch error:",c),o&&(a(c instanceof Error?c:new Error("Failed to fetch subscription")),t({status:"active",plan:"free",analysisCount:0,currentPeriodEnd:new Date(Date.now()+30*24*60*60*1e3).toISOString()}))}finally{o&&n(!1)}}return l(),()=>{o=!1}},[i]),{subscription:e,loading:s,error:r,canAnalyze:e?D2(e):!1,remainingAnalyses:e?F2(e):0}}function CE(){const{session:i}=U2(),[e,t]=V.useState(null),[s,n]=V.useState(!0),[r,a]=V.useState(null);return V.useEffect(()=>{async function o(){if(!i?.user){t(null),n(!1);return}try{const l=await M2(i.user.id);if(typeof l=="object"&&l!==null)t(l),a(null);else throw new Error("Invalid subscription response format")}catch(l){const c=l instanceof Error?l.message:"Failed to fetch subscription";a(new Error(c)),console.error("Error fetching subscription:",l),t(null)}finally{n(!1)}}o()},[i]),{subscription:e,loading:s,error:r,canAnalyze:e?D2(e):!1,remainingAnalyses:e?F2(e):0}}function PE(i){const e=vm[i.plan.toUpperCase()],t=i.analysisCount,s=Math.max(0,e-t),n=t/e*100;return{limit:e,used:t,remaining:s,usagePercentage:n,isWarning:n>=N0.WARNING*100,isCritical:n>=N0.CRITICAL*100}}function LE(){const{subscription:i}=CE();if(!i)return null;const e=PE(i),t=e.isCritical?"bg-red-600":e.isWarning?"bg-yellow-500":"bg-green-600";return g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex justify-between text-sm",children:[g.jsxs("span",{className:"text-gray-600",children:[e.used," / ",e.limit," analyses used"]}),g.jsxs("span",{className:"text-gray-600",children:[e.remaining," remaining"]})]}),g.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:g.jsx("div",{className:`h-full ${t} transition-all duration-500`,style:{width:`${Math.min(100,e.usagePercentage)}%`}})}),(e.isWarning||e.isCritical)&&g.jsx("p",{className:`text-sm ${e.isCritical?"text-red-600":"text-yellow-600"}`,children:e.isCritical?"You're almost out of analyses. Upgrade to continue analyzing.":"You're approaching your analysis limit. Consider upgrading soon."})]})}function TE(){const{values:i,errors:e,setFieldValue:t,handleSubmit:s,analysis:n,isLoading:r}=EE(),{canAnalyze:a}=kE();return a?g.jsxs("div",{className:"space-y-8",children:[g.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 sm:gap-0 bg-gradient-to-r from-blue-50 to-blue-100/50 rounded-xl p-6 border border-blue-100",children:[g.jsxs("div",{children:[g.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[g.jsx(D0,{className:"w-6 h-6 text-blue-600"}),"New Analysis"]}),g.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Upload a CV and Job Description to get started"})]}),g.jsx(LE,{})]}),g.jsxs("form",{onSubmit:s,className:"space-y-8",children:[g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[g.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:g.jsx(RS,{candidateName:i.candidateName,cvText:i.cvText,onNameChange:o=>t("candidateName",o),onCvTextChange:o=>t("cvText",o),errors:{name:e.candidateName,cvText:e.cvText}})}),g.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:g.jsx(DS,{jobTitle:i.jobTitle,jobDescription:i.jobDescription,onTitleChange:o=>t("jobTitle",o),onDescriptionChange:o=>t("jobDescription",o),errors:{title:e.jobTitle,description:e.jobDescription}})})]}),g.jsxs("div",{className:"flex justify-end space-x-4 sticky bottom-6 bg-white/80 backdrop-blur-sm p-4 rounded-xl border border-gray-100 shadow-sm",children:[g.jsxs(qi,{type:"button",variant:"secondary",onClick:()=>{t("candidateName",""),t("cvText",""),t("jobTitle",""),t("jobDescription","")},disabled:r,className:"flex items-center gap-2",children:[g.jsx($y,{className:"w-4 h-4"}),"Clear Form"]}),g.jsx(qi,{type:"submit",isLoading:r,className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800",children:r?"Analyzing...":"Analyze CV"})]})]}),n&&g.jsx("div",{className:"mt-8",children:g.jsx(gb,{analysis:n})})]}):g.jsx("div",{className:"text-center py-16 px-4",children:g.jsxs("div",{className:"max-w-md mx-auto bg-white rounded-2xl shadow-sm p-8 border border-gray-100",children:[g.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-6",children:g.jsx("svg",{className:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),g.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Upgrade Your Plan"}),g.jsx("p",{className:"text-gray-600 mb-8 leading-relaxed",children:"You've reached the limit of your free analyses. Upgrade to Pro for unlimited analyses and advanced features."}),g.jsx(Ps,{to:"/pricing",className:"inline-flex items-center px-6 py-3 border border-transparent rounded-xl shadow-sm text-base font-medium text-white bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 transition-all duration-200",children:"View Pricing Plans"})]})})}function z2(){const{data:i,isLoading:e,error:t,refetch:s}=Tc(VS);return{analyses:i||[],isLoading:e,error:t,refetch:s}}function jE({analysis:i,onClick:e}){const[t,s]=V.useState(""),[n,r]=V.useState("");V.useEffect(()=>{async function o(){const{data:l}=await ut.from("candidates").select("name").eq("id",i.candidate_id).single(),{data:c}=await ut.from("jobs").select("title").eq("id",i.job_id).single();s(l?.name||"Unknown Candidate"),r(c?.title||"Unknown Position")}o()},[i.candidate_id,i.job_id]);const a=o=>o>=8?"bg-green-100 text-green-800":o>=6?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800";return g.jsx("div",{onClick:e,className:`p-4 border rounded-lg ${e?"hover:bg-gray-50 cursor-pointer":""} transition-colors`,children:g.jsxs("div",{className:"flex justify-between items-start",children:[g.jsxs("div",{children:[g.jsx("h3",{className:"font-medium",children:`${t} Ã— ${n} Report`}),g.jsx("p",{className:"text-sm text-gray-500",children:new Date(i.created_at??"").toLocaleDateString()})]}),g.jsxs("div",{className:`px-2 py-1 rounded text-sm ${a(i.fit_score)}`,children:["Score: ",i.fit_score,"/10"]})]})})}function IE(i){const[e,t]=V.useState(!1),{data:s,isLoading:n,error:r,refetch:a}=Tc(()=>WS(i),{enabled:!!i});return{analysis:s,isLoading:n,error:r,refetch:a,isExpanded:e,toggleExpanded:()=>t(o=>!o)}}function RE({analysisId:i,onClose:e}){const{analysis:t,isLoading:s,error:n}=IE(i),[r,a]=V.useState(""),[o,l]=V.useState("");return V.useEffect(()=>{async function c(){if(!t)return;const{data:h}=await ut.from("candidates").select("name").eq("id",t.candidate_id).single(),{data:d}=await ut.from("jobs").select("title").eq("id",t.job_id).single();a(h?.name||"Unknown Candidate"),l(d?.title||"Unknown Position")}c()},[t]),s?g.jsx("div",{className:"flex justify-center py-12",children:g.jsx(mr,{size:"lg"})}):n||!t?g.jsxs("div",{className:"text-center py-12",children:[g.jsx("p",{className:"text-red-600 mb-4",children:n||"Analysis not found"}),g.jsx(qi,{variant:"secondary",onClick:e,children:"Go Back"})]}):g.jsxs("div",{className:"space-y-6",children:[g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("h2",{className:"text-xl font-semibold",children:`${r} Ã— ${o} Report`}),g.jsxs("div",{className:"flex gap-3",children:[g.jsx(mb,{analysis:t}),g.jsx(qi,{variant:"secondary",onClick:e,children:"Close"})]})]}),g.jsx(gb,{analysis:t})]})}function ac({title:i,description:e,action:t}){return g.jsxs("div",{className:"text-center py-12",children:[g.jsx("div",{className:"rounded-full bg-blue-100 p-3 mx-auto w-12 h-12 flex items-center justify-center",children:g.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),g.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:i}),g.jsx("p",{className:"mt-2 text-sm text-gray-500",children:e}),t&&g.jsx("div",{className:"mt-6",children:t})]})}const OE=[{label:"All Time",value:"all"},{label:"Last 7 Days",value:"7days"},{label:"Last 30 Days",value:"30days"},{label:"Last 90 Days",value:"90days"}];function ME(){const{isLoading:i,error:e}=z2(),[t,s]=V.useState(null),[n,r]=V.useState([]),[a,o]=V.useState(""),[l,c]=V.useState("all"),h=async()=>{try{const{data:{user:p}}=await ut.auth.getUser();if(!p)throw new Dt("User not authenticated",401);const{data:f,error:v}=await ut.from("analysis").select("*, candidates(name), jobs(title)").eq("user_id",p.id).order("created_at",{ascending:!1});if(v)throw v;r(f||[])}catch(p){console.error("Error fetching user analyses:",p)}};V.useEffect(()=>{h()},[]);const d=V.useMemo(()=>n.filter(p=>{const f=a.toLowerCase(),v=p.candidates?.name?.toLowerCase()||"",w=p.jobs?.title?.toLowerCase()||"",A=!a||v.includes(f)||w.includes(f),x=new Date(p.created_at),j=Math.floor((new Date().getTime()-x.getTime())/(1e3*60*60*24));let M=!0;return l==="7days"&&(M=j<=7),l==="30days"&&(M=j<=30),l==="90days"&&(M=j<=90),A&&M}),[n,a,l]);return i?g.jsx("div",{className:"flex justify-center items-center min-h-[400px]",children:g.jsx(mr,{size:"lg"})}):e?g.jsx(ac,{title:"Error loading analyses",description:e}):n.length?t?g.jsxs("div",{className:"space-y-6",children:[g.jsxs("button",{onClick:()=>s(null),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors duration-200",children:[g.jsx(rv,{className:"w-5 h-5"}),g.jsx("span",{children:"Back to History"})]}),g.jsx(RE,{analysisId:t,onClose:()=>s(null)})]}):g.jsxs("div",{className:"space-y-6",children:[g.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-purple-100/50 rounded-xl p-6 border border-purple-100",children:[g.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[g.jsx(F0,{className:"w-6 h-6 text-purple-600"}),"Analysis History"]}),g.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"View and compare your previous analyses"})]}),g.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center bg-white p-4 rounded-xl shadow-sm border border-gray-100",children:[g.jsxs("div",{className:"relative flex-1",children:[g.jsx(yv,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),g.jsx("input",{type:"text",placeholder:"Search by candidate name or position...",value:a,onChange:p=>o(p.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),g.jsxs("div",{className:"flex items-center gap-2 min-w-[200px]",children:[g.jsx(pv,{className:"w-5 h-5 text-gray-400"}),g.jsx("select",{value:l,onChange:p=>c(p.target.value),className:"flex-1 border border-gray-200 rounded-lg py-2 px-3 focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:OE.map(p=>g.jsx("option",{value:p.value,children:p.label},p.value))})]})]}),d.length===0?g.jsx(ac,{title:"No matching analyses",description:"Try adjusting your search or filter criteria"}):g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:d.map(p=>g.jsx("div",{className:"transform transition-all duration-200 hover:scale-[1.02]",children:g.jsx(jE,{analysis:p,onClick:()=>s(p.id??null)})},p.id))})]}):g.jsx(ac,{title:"No analyses yet",description:"Start by analyzing a candidate's CV against a job description."})}function FE(){const{candidates:i,isLoading:e}=kp(),[t,s]=V.useState(null),n=i.reduce((a,o)=>{const l=a.findIndex(c=>hc(o.name,o.cv_text,[c]));return l>=0?(a[l].duplicateCount+=1,a[l].lastSubmitted=new Date(Math.max(new Date(a[l].lastSubmitted).getTime(),new Date(o.created_at).getTime())).toISOString()):a.push({...o,duplicateCount:1,lastSubmitted:o.created_at}),a},[]),r=a=>a.split(/\n\s*\n/).map(o=>o.trim()).filter(o=>o.length>0).map(o=>o.replace(/\s+/g," ")).join(`

`);return e?g.jsx("div",{className:"flex justify-center items-center min-h-[400px] bg-white/50 rounded-xl backdrop-blur-sm",children:g.jsx(mr,{size:"lg"})}):i.length?g.jsxs("div",{className:"space-y-6",children:[g.jsx("div",{className:"bg-gradient-to-r from-emerald-50 to-emerald-100/50 rounded-xl p-6 border border-emerald-100",children:g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx(Lv,{className:"w-6 h-6 text-emerald-600"}),g.jsxs("div",{children:[g.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Candidate History"}),g.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[n.length," unique candidate",n.length!==1?"s":""," found"]})]})]})}),g.jsx("div",{className:"grid gap-4",children:n.map((a,o)=>g.jsx("div",{className:"group bg-white rounded-xl border border-gray-200 hover:border-emerald-200 shadow-sm hover:shadow-md transition-all duration-200",style:{animationDelay:`${o*50}ms`,animation:"fadeInUp 0.5s ease-out forwards"},children:g.jsxs("div",{className:"p-6 cursor-pointer",onClick:()=>s(t===a.id?null:a.id),role:"button",tabIndex:0,onKeyDown:l=>{(l.key==="Enter"||l.key===" ")&&(l.preventDefault(),s(t===a.id?null:a.id))},children:[g.jsxs("div",{className:"flex justify-between items-start",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:a.name}),a.duplicateCount>1&&g.jsxs("span",{className:"flex items-center gap-1 text-xs px-3 py-1 bg-emerald-50 text-emerald-700 rounded-full",children:[g.jsx(B0,{className:"w-3 h-3"}),a.duplicateCount,"x"]})]}),t===a.id?g.jsx(Tu,{className:"w-5 h-5 text-gray-400 group-hover:text-emerald-500 transition-colors"}):g.jsx(Vo,{className:"w-5 h-5 text-gray-400 group-hover:text-emerald-500 transition-colors"})]}),g.jsxs("p",{className:"text-sm text-gray-500 mt-2 flex items-center gap-2",children:[g.jsx("span",{className:"inline-block w-2 h-2 rounded-full bg-emerald-400"}),"Last submitted ",b1(a.lastSubmitted)]}),g.jsx("div",{className:`mt-4 text-sm text-gray-600 space-y-3
                  ${t===a.id?"":"line-clamp-2"}`,children:r(a.cv_text).split(`

`).map((l,c)=>g.jsx("p",{className:"leading-relaxed",children:l},c))}),g.jsx("div",{className:"mt-4 text-sm text-emerald-600 font-medium",children:t===a.id?"Show less":"Show more"})]})},a.id))}),g.jsx("style",{children:`
        @keyframes fadeInUp {
          from {
            opacity: 0;
            transform: translateY(10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
      `})]}):g.jsx(ac,{title:"No candidates yet",description:"Previous candidates will appear here once you analyze their CVs."})}function DE(){const{jobs:i,isLoading:e}=Hp(),[t,s]=V.useState(null),n=i.reduce((a,o)=>{const l=a.findIndex(c=>uc(o.title,o.jd_text,[c]));return l>=0?(a[l].duplicateCount+=1,a[l].lastSubmitted=new Date(Math.max(new Date(a[l].lastSubmitted).getTime(),new Date(o.created_at).getTime())).toISOString()):a.push({...o,duplicateCount:1,lastSubmitted:o.created_at}),a},[]),r=a=>a.split(/\n\s*\n/).map(o=>o.trim()).filter(o=>o.length>0).map(o=>o.replace(/\s+/g," ")).join(`

`);return e?g.jsx("div",{className:"flex justify-center items-center min-h-[400px] bg-white/50 rounded-xl backdrop-blur-sm",children:g.jsx(mr,{size:"lg"})}):i.length?g.jsxs("div",{className:"space-y-6",children:[g.jsx("div",{className:"bg-gradient-to-r from-amber-50 to-amber-100/50 rounded-xl p-6 border border-amber-100",children:g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx(yp,{className:"w-6 h-6 text-amber-600"}),g.jsxs("div",{children:[g.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Job History"}),g.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[n.length," unique position",n.length!==1?"s":""," found"]})]})]})}),g.jsx("div",{className:"grid gap-4",children:n.map((a,o)=>g.jsx("div",{className:"group bg-white rounded-xl border border-gray-200 hover:border-amber-200 shadow-sm hover:shadow-md transition-all duration-200",style:{animationDelay:`${o*50}ms`,animation:"fadeInUp 0.5s ease-out forwards"},children:g.jsxs("div",{className:"p-6 cursor-pointer",onClick:()=>s(t===a.id?null:a.id),role:"button",tabIndex:0,onKeyDown:l=>{(l.key==="Enter"||l.key===" ")&&(l.preventDefault(),s(t===a.id?null:a.id))},children:[g.jsxs("div",{className:"flex justify-between items-start",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:a.title}),a.duplicateCount>1&&g.jsxs("span",{className:"flex items-center gap-1 text-xs px-3 py-1 bg-amber-50 text-amber-700 rounded-full",children:[g.jsx(B0,{className:"w-3 h-3"}),a.duplicateCount,"x"]})]}),t===a.id?g.jsx(Tu,{className:"w-5 h-5 text-gray-400 group-hover:text-amber-500 transition-colors"}):g.jsx(Vo,{className:"w-5 h-5 text-gray-400 group-hover:text-amber-500 transition-colors"})]}),g.jsxs("p",{className:"text-sm text-gray-500 mt-2 flex items-center gap-2",children:[g.jsx("span",{className:"inline-block w-2 h-2 rounded-full bg-amber-400"}),"Last submitted ",b1(a.lastSubmitted)]}),g.jsx("div",{className:`mt-4 text-sm text-gray-600 space-y-3
                  ${t===a.id?"":"line-clamp-2"}`,children:r(a.jd_text).split(`

`).map((l,c)=>g.jsx("p",{className:"leading-relaxed",children:l},c))}),g.jsx("div",{className:"mt-4 text-sm text-amber-600 font-medium",children:t===a.id?"Show less":"Show more"})]})},a.id))}),g.jsx("style",{children:`
        @keyframes fadeInUp {
          from {
            opacity: 0;
            transform: translateY(10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
      `})]}):g.jsx(ac,{title:"No jobs yet",description:"Previous job descriptions will appear here once you analyze them."})}function BE({tabs:i,activeTab:e,onChange:t}){return g.jsx("div",{className:"relative",children:g.jsxs("div",{className:"flex items-center",children:[g.jsx("div",{className:"flex space-x-1 rounded-xl bg-gray-100/60 p-1",children:i.map(s=>{const n=e===s.id;return g.jsxs("button",{onClick:()=>t(s.id),"data-tab":s.id,className:`
                  relative px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200
                  ${n?"text-white shadow-sm":"text-gray-600 hover:text-gray-900 hover:bg-white/60"}
                `,children:[n&&g.jsx("span",{className:"absolute inset-0 rounded-lg bg-gradient-to-r from-blue-600 to-blue-700 shadow-sm transition-all duration-200",style:{zIndex:0}}),g.jsx("span",{className:"relative z-10",children:s.label}),n&&g.jsx("span",{className:"absolute -bottom-px left-0 right-0 h-px bg-gradient-to-r from-blue-400/0 via-blue-400/70 to-blue-400/0"})]},s.id)})}),g.jsx("div",{className:"hidden md:block ml-6 h-px flex-1 bg-gradient-to-r from-gray-200 to-transparent"})]})})}async function $E(){try{const i=new Date;i.setDate(i.getDate()-7);const{data:{user:e}}=await ut.auth.getUser();if(!e)throw new Dt("User not authenticated",401);const[{count:t},{data:s},{data:n},{count:r}]=await Promise.all([ut.from("analysis").select("*",{count:"exact",head:!0}).eq("user_id",e.id),ut.from("candidates").select("id, name, cv_text").eq("user_id",e.id),ut.from("jobs").select("id, title, jd_text").eq("user_id",e.id),ut.from("analysis").select("*",{count:"exact",head:!0}).eq("user_id",e.id).gte("created_at",i.toISOString())]),a=s?.reduce((l,c)=>(l.some(d=>hc(c.name,c.cv_text,[d]))||l.push(c),l),[])||[],o=n?.reduce((l,c)=>(l.some(d=>uc(c.title,c.jd_text,[d]))||l.push(c),l),[])||[];return{totalAnalyses:t||0,uniqueCandidates:a.length,uniqueJobs:o.length,recentAnalyses:r||0,totalCandidates:a.length,totalJobs:o.length}}catch(i){throw console.error("Dashboard stats error:",i),new Dt("Failed to fetch dashboard stats",500)}}function qE(){const{data:i,isLoading:e,error:t,refetch:s}=Tc($E);return{stats:i||{totalAnalyses:0,totalCandidates:0,totalJobs:0,recentAnalyses:0},isLoading:e,error:t,refetch:s}}function UE(){const{stats:i,isLoading:e}=qE();if(e)return g.jsx("div",{className:"flex justify-center py-8",children:g.jsx(mr,{})});const t=[{label:"Total Analyses",value:i.totalAnalyses,icon:M0,color:"from-blue-500 to-indigo-600",textColor:"text-blue-600"},{label:"Candidates",value:i.totalCandidates,icon:ju,color:"from-emerald-500 to-teal-600",textColor:"text-emerald-600"},{label:"Job Descriptions",value:i.totalJobs,icon:yp,color:"from-violet-500 to-purple-600",textColor:"text-violet-600"}];return g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(s=>g.jsxs("div",{className:"relative bg-white rounded-xl shadow-sm hover:shadow-xl transition-all duration-300 overflow-hidden group",children:[g.jsx("div",{className:"absolute inset-0 bg-gradient-to-br opacity-5 from-gray-100 to-gray-200"}),g.jsxs("div",{className:"relative p-6",children:[g.jsx("div",{className:`bg-gradient-to-br ${s.color} w-16 h-16 rounded-xl flex items-center justify-center shadow-lg mb-6 group-hover:scale-110 transition-transform duration-300`,children:g.jsx(s.icon,{className:"h-8 w-8 text-white"})}),g.jsxs("div",{className:"space-y-2",children:[g.jsx("p",{className:`text-4xl font-bold ${s.textColor} tracking-tight transition-colors duration-300`,children:s.value.toLocaleString()}),g.jsx("p",{className:"text-sm font-medium text-gray-600",children:s.label})]}),g.jsx("div",{className:`absolute top-0 right-0 w-32 h-32 -mr-16 -mt-16 bg-gradient-to-br ${s.color} opacity-10 rounded-full transform rotate-45`})]})]},s.label))})}function zE({user:i}){const e=i?.email?.split("@")[0],t=i?.email;return i?g.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-800 rounded-xl shadow-lg p-8",children:g.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 sm:gap-0",children:[g.jsxs("div",{className:"text-white",children:[g.jsxs("h1",{className:"text-3xl font-bold",children:["Welcome back, ",e,"! ðŸ‘‹"]}),g.jsx("p",{className:"mt-2 text-blue-100 font-medium",children:"Here's your recruitment analysis overview"})]}),g.jsxs("div",{className:"flex items-center space-x-6",children:[g.jsxs("button",{className:"relative p-2 text-blue-100 hover:text-white transition-colors duration-200","aria-label":"Notifications",children:[g.jsx(Jy,{className:"h-6 w-6"}),g.jsx("span",{className:"absolute top-0 right-0 block h-3 w-3 rounded-full bg-red-500 ring-2 ring-blue-600"})]}),g.jsxs("div",{className:"flex items-center bg-white/10 rounded-lg p-2 backdrop-blur-sm",children:[i.user_metadata?.avatar_url?g.jsx("img",{src:i.user_metadata.avatar_url,alt:"Profile",className:"h-10 w-10 rounded-lg shadow-sm"}):g.jsx($0,{className:"h-10 w-10 text-blue-100"}),g.jsxs("div",{className:"ml-3",children:[g.jsx("p",{className:"text-sm font-medium text-white",children:t}),g.jsx("p",{className:"text-xs text-blue-100",children:"View Profile"})]})]})]})]})}):null}function HE(){const{analyses:i,isLoading:e}=z2(),[t,s]=V.useState([]),[n,r]=V.useState(!0);return V.useEffect(()=>{async function a(){if(!i.length){r(!1);return}const o=await Promise.all(i.slice(0,10).map(async l=>{const{data:c}=await ut.from("candidates").select("name").eq("id",l.candidate_id).single(),{data:h}=await ut.from("jobs").select("title").eq("id",l.job_id).single();return{...l,candidateName:c?.name||"Unknown Candidate",jobTitle:h?.title||"Unknown Position"}}));s(o),r(!1)}i.length&&a()},[i]),g.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 h-[400px] flex flex-col",children:[g.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center flex-shrink-0",children:[g.jsx("span",{className:"w-2 h-6 bg-blue-600 rounded-full mr-3"}),"Recent Activity"]}),e||n?g.jsx("div",{className:"flex-1 flex justify-center items-center",children:g.jsx(mr,{})}):g.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-200 scrollbar-track-gray-50 pr-2 -mr-2",children:g.jsx("div",{className:"space-y-4",children:t.length>0?t.map(a=>g.jsxs("div",{className:"flex items-start space-x-4 p-4 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:[g.jsx("div",{className:"flex-shrink-0",children:g.jsx("div",{className:"h-10 w-10 rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center shadow-sm",children:g.jsxs("span",{className:"text-sm font-semibold text-white",children:[a.fit_score,"/10"]})})}),g.jsxs("div",{className:"min-w-0 flex-1",children:[g.jsxs("p",{className:"text-sm font-semibold text-gray-900 truncate",children:[a.candidateName," â†’ ",a.jobTitle]}),g.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Analysis completed ",L_(a.created_at??"")]})]})]},a.id)):g.jsx("div",{className:"text-center text-gray-500 py-4",children:"No recent activity"})})})]})}const WE=[{id:"new",label:"New Analysis"},{id:"history",label:"Analysis History"},{id:"candidates",label:"Previous Candidates"},{id:"jobs",label:"Previous Jobs"}];function VE(){const[i,e]=V.useState("new"),{session:t}=$u();return g.jsxs("div",{className:"space-y-8",children:[g.jsx(zE,{user:t?.user}),g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[g.jsx("div",{className:"lg:col-span-2",children:g.jsx(UE,{})}),g.jsx("div",{className:"lg:col-span-1",children:g.jsx(HE,{})})]}),g.jsx("div",{className:"bg-white rounded-xl shadow-sm",children:g.jsxs("div",{className:"p-6",children:[g.jsx(BE,{tabs:WE,activeTab:i,onChange:e}),g.jsxs("div",{className:"mt-8",children:[i==="new"&&g.jsx(TE,{}),i==="history"&&g.jsx(ME,{}),i==="candidates"&&g.jsx(FE,{}),i==="jobs"&&g.jsx(DE,{})]})]})})]})}class GE extends V.Component{state={hasError:!1};static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Uncaught error:",e,t)}render(){return this.state.hasError?this.props.fallback||g.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:g.jsxs("div",{className:"max-w-md w-full bg-white p-8 rounded-lg shadow-md",children:[g.jsx("h2",{className:"text-2xl font-bold text-red-600 mb-4",children:"Something went wrong"}),g.jsx("p",{className:"text-gray-600 mb-4",children:this.state.error?.message||"An unexpected error occurred"}),g.jsx("button",{onClick:()=>this.setState({hasError:!1}),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"Try again"})]})}):this.props.children}}function XE(){return g.jsxs("div",{className:"min-h-screen bg-gray-50",children:[g.jsx(ux,{}),g.jsx("main",{className:"py-8",children:g.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:g.jsx(GE,{children:g.jsx(j0,{children:g.jsx(ha,{path:"/",element:g.jsx(VE,{})})})})})})]})}const YE="your-production-stripe-key",KE=wm(YE),JE={PRICES:{PRO:"price_mock_monthly_pro_plan"},MAX_FREE_ANALYSES:4};function L0({plan:i}){const[e,t]=V.useState(!1),{session:s}=$u(),{addToast:n}=Wp(),r=T0(),a=async()=>{if(!s){r("/login");return}if(i==="free"){r("/dashboard");return}t(!0);try{const o=await KE;if(!o)throw new Error("Stripe not initialized");const{error:l}=await o.redirectToCheckout({lineItems:[{price:JE.PRICES.PRO,quantity:1}],mode:"subscription",successUrl:`${window.location.origin}/dashboard`,cancelUrl:`${window.location.origin}/pricing`});if(l)throw l}catch(o){n("Failed to start subscription process","error"),console.error("Subscription error:",o)}finally{t(!1)}};return g.jsx(qi,{onClick:a,isLoading:e,variant:i==="pro"?"primary":"secondary",className:"w-full",children:i==="free"?"Start Free Trial":"Subscribe Now"})}const ZE="your-production-stripe-key";wm(ZE);const QE=4;function ek(){return g.jsxs("div",{className:"relative bg-white py-24 overflow-hidden border border-blue-500/20 rounded-lg",children:[g.jsxs("div",{className:"absolute inset-0",children:[g.jsx("div",{className:"absolute inset-0 bg-[url('/grid.svg')] opacity-[0.02]"}),g.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-blue-100 rounded-full blur-3xl opacity-30 animate-pulse"}),g.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-indigo-100 rounded-full blur-3xl opacity-30 animate-pulse delay-1000"})]}),g.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[g.jsxs("div",{className:"text-center mb-16",children:[g.jsx("p",{className:"inline-flex items-center px-4 py-1.5 rounded-full border border-blue-400/30 bg-blue-500/10 backdrop-blur-sm text-blue-600 text-sm font-medium mb-4",children:"Flexible Plans"}),g.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Simple, Transparent Pricing"}),g.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Choose the plan that's right for your recruitment needs"})]}),g.jsxs("div",{className:"max-w-5xl mx-auto grid md:grid-cols-2 gap-8",children:[g.jsxs("div",{className:"group relative bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-200 hover:border-blue-300 transition-all duration-300 transform hover:-translate-y-1",children:[g.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-50 to-blue-50 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),g.jsxs("div",{className:"relative p-8",children:[g.jsx("h3",{className:"text-2xl font-bold text-gray-900 text-center mb-2",children:jn.FREE.name}),g.jsx("p",{className:"text-center text-gray-600 mb-6",children:"Perfect for trying out our service"}),g.jsxs("div",{className:"text-center mb-8",children:[g.jsx("span",{className:"text-5xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-gray-900 to-gray-600",children:"$0"}),g.jsx("span",{className:"text-gray-600",children:"/month"}),g.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Up to ",QE," CV analyses"]})]}),g.jsx("ul",{className:"space-y-4 mb-8",children:jn.FREE.features.map((i,e)=>g.jsxs("li",{className:"flex items-start group/item",children:[g.jsx(du,{className:"h-5 w-5 text-green-500 flex-shrink-0 mt-0.5 group-hover/item:scale-110 transition-transform"}),g.jsx("span",{className:"ml-3 text-gray-600",children:i})]},e))}),g.jsx(L0,{plan:"free"})]})]}),g.jsxs("div",{className:"group relative bg-gradient-to-br from-blue-600 to-indigo-600 rounded-2xl shadow-xl overflow-hidden transform hover:scale-[1.02] transition-all duration-300",children:[g.jsx("div",{className:"absolute inset-0 bg-[url('/grid.svg')] opacity-10"}),g.jsxs("div",{className:"relative p-8",children:[g.jsx("h3",{className:"text-2xl font-bold text-white text-center mb-2",children:jn.PRO.name}),g.jsx("p",{className:"text-center text-blue-100 mb-6",children:"For serious recruiters"}),g.jsxs("div",{className:"text-center mb-8",children:[g.jsxs("span",{className:"text-5xl font-bold text-white",children:["$",jn.PRO.price]}),g.jsx("span",{className:"text-blue-100",children:"/month"}),g.jsxs("p",{className:"text-sm text-blue-100 mt-2",children:[jn.PRO.analysisLimit," analyses per month"]})]}),g.jsx("ul",{className:"space-y-4 mb-8",children:jn.PRO.features.map((i,e)=>g.jsxs("li",{className:"flex items-start group/item",children:[g.jsx(du,{className:"h-5 w-5 text-white flex-shrink-0 mt-0.5 group-hover/item:scale-110 transition-transform"}),g.jsx("span",{className:"ml-3 text-white",children:i})]},e))}),g.jsx(L0,{plan:"pro"})]})]})]})]})]})}function tk(){const{session:i,loading:e}=$u();return e?g.jsx("div",{className:"min-h-screen flex items-center justify-center",children:g.jsx(mr,{size:"lg"})}):g.jsxs(j0,{children:[g.jsx(ha,{path:"/",element:i?g.jsx(Cl,{to:"/dashboard"}):g.jsx(Jv,{})}),g.jsx(ha,{path:"/login",element:i?g.jsx(Cl,{to:"/dashboard"}):g.jsx(ox,{})}),g.jsx(ha,{path:"/signup",element:i?g.jsx(Cl,{to:"/dashboard"}):g.jsx(cx,{})}),g.jsx(ha,{path:"/pricing",element:g.jsx(ek,{})}),g.jsx(ha,{path:"/dashboard/*",element:i?g.jsx(XE,{}):g.jsx(Cl,{to:"/login"})}),g.jsx(ha,{path:"*",element:g.jsx(Cl,{to:"/"})})]})}kf.createRoot(document.getElementById("root")).render(g.jsx(Py.StrictMode,{children:g.jsx(Ly,{children:g.jsx(tk,{})})}));export{Bt as _};
//# sourceMappingURL=index-weu9w_U1.js.map
